{"created_by":"Tampermonkey","version":"1","scripts":[{"name":"Pixiv Previewer","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["*://www.pixiv.net/*"],"orig_noframes":null,"orig_run_at":"document-idle","orig_run_in":[],"orig_tags":[],"use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"run_in":null,"sandbox":null,"tags":[],"unwrap":null,"user_modified":null},"storage":{"ts":1770962063150,"data":{}},"enabled":true,"position":1,"file_url":"https://update.greasyfork.org/scripts/30766/Pixiv%20Previewer.user.js","uuid":"be4e9b0e-2fa3-4475-89d0-b291bf8f9b6d","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgICAgUGl4aXYgUHJldmlld2VyCi8vIEBuYW1lOmphICAgICAgICAgICAgIFBpeGl2IFByZXZpZXdlcgovLyBAbmFtZTpydSAgICAgICAgICAgICBQaXhpdiBQcmV2aWV3ZXIKLy8gQG5hbWU6emgtQ04gICAgICAgICAgUGl4aXYgUHJldmlld2VyCi8vIEBuYW1lOnpoLVRXICAgICAgICAgIFBpeGl2IFByZXZpZXdlcgovLyBAbmFtZXNwYWNlICAgICAgICAgICBodHRwczovL2dpdGh1Yi5jb20vT2Nyb3NvZnQvUGl4aXZQcmV2aWV3ZXIKLy8gQHZlcnNpb24gICAgICAgICAgICAgMy44LjQKLy8gQGRlc2NyaXB0aW9uICAgICAgICAgRGlzcGxheSBwcmV2aWV3IGltYWdlcyAoc3VwcG9ydCBzaW5nbGUgaW1hZ2UsIG11bHRpcGxlIGltYWdlcywgbW92aW5nIGltYWdlcyk7IERvd25sb2FkIGFuaW1hdGlvbiguemlwKTsgU29ydGluZyB0aGUgc2VhcmNoIHBhZ2UgYnkgZmF2b3JpdGUgY291bnQoYW5kIGRpc3BsYXkgaXQpLgovLyBAZGVzY3JpcHRpb246emgtQ04gICDmmL7npLrpooTop4jlm77vvIjmlK/mjIHljZXlm77vvIzlpJrlm77vvIzliqjlm77vvInvvJvliqjlm77ljovnvKnljIXkuIvovb3vvJvmkJzntKLpobXmjInng63pl6jluqbvvIjmlLbol4/mlbDvvInmjpLluo/lubbmmL7npLrmlLbol4/mlbDjgIIKLy8gQGRlc2NyaXB0aW9uOmphICAgICAg44OX44Os44OT44Ol44O855S75YOP44Gu6KGo56S677yI5Y2Y5LiA55S75YOP44CB6KSH5pWw55S75YOP44CB5YuV55S744Gu44K144Od44O844OI77yJOyDjgqLjg4vjg6Hjg7zjgrfjg6fjg7Pjga7jg4Djgqbjg7Pjg63jg7zjg4nvvIguemlw77yJOyDjgYrmsJfjgavlhaXjgorjga7mlbDjgafmpJzntKLjg5rjg7zjgrjjgpLjgr3jg7zjg4jjgZfjgb7jgZnvvIjjgZ3jgZfjgabooajnpLrjgZfjgb7jgZnvvInjgIIKLy8gQGRlc2NyaXB0aW9uOnpoLVRXICAg6aGv56S66aCQ6Ka95ZyW5YOP77yI5pSv5oyB5Zau5bmF5ZyW5YOP77yM5aSa5bmF5ZyW5YOP77yM6YGL5YuV5ZyW5YOP77yJ77ybIOS4i+i8ieWLleeVq++8iC56aXDvvIk7IOaMieaUtuiXj+WkvuaVuOWwjeaQnOe0oumggemAsuihjOaOkuW6j++8iOS4pumhr+ekuu+8ieOAggovLyBAZGVzY3JpcHRpb246cnUgICAgICDQntGC0L7QsdGA0LDQttC10L3QuNC1INC/0YDQtdCy0YzRjiDQuNC30L7QsdGA0LDQttC10L3QuNC5ICjQv9C+0LTQtNC10YDQttC60LAg0L7QtNC40L3QvtGH0L3Ri9GFLCDQvNC90L7QttC10YHRgtCy0LXQvdC90YvRhSDQuCDQsNC90LjQvNC40YDQvtCy0LDQvdC90YvRhSDQuNC30L7QsdGA0LDQttC10L3QuNC5KTsg0KHQutCw0YfQuNCy0LDQvdC40LUg0LDQvdC40LzQsNGG0LjQuSAoLnppcCk7INCh0L7RgNGC0LjRgNC+0LLQutCwINGB0YLRgNCw0L3QuNGG0Ysg0L/QvtC40YHQutCwINC/0L4g0LrQvtC70LjRh9C10YHRgtCy0YMg0LTQvtCx0LDQstC70LXQvdC40Lkg0LIg0LfQsNC60LvQsNC00LrQuCAo0YEg0L7RgtC+0LHRgNCw0LbQtdC90LjQtdC8INC60L7Qu9C40YfQtdGB0YLQstCwKS4KLy8gQGF1dGhvciAgICAgICAgICAgICAgT2Nyb3NvZnQKLy8gQG1hdGNoICAgICAgICAgICAgICAgKjovL3d3dy5waXhpdi5uZXQvKgovLyBAZ3JhbnQgICAgICAgICAgICAgICB1bnNhZmVXaW5kb3cKLy8gQGdyYW50ICAgICAgICAgICAgICAgR00ueG1sSHR0cFJlcXVlc3QKLy8gQGdyYW50ICAgICAgICAgICAgICAgR01feG1saHR0cFJlcXVlc3QKLy8gQGxpY2Vuc2UgICAgICAgICAgICAgR1BMdjMKLy8gQGljb24gICAgICAgICAgICAgICAgaHR0cHM6Ly90MC5nc3RhdGljLmNvbS9mYXZpY29uVjI/Y2xpZW50PVNPQ0lBTCZ0eXBlPUZBVklDT04mZmFsbGJhY2tfb3B0cz1UWVBFLFNJWkUsVVJMJnNpemU9MzImdXJsPWh0dHBzOi8vd3d3LnBpeGl2Lm5ldAovLyBAaWNvbjY0ICAgICAgICAgICAgICBodHRwczovL3QwLmdzdGF0aWMuY29tL2Zhdmljb25WMj9jbGllbnQ9U09DSUFMJnR5cGU9RkFWSUNPTiZmYWxsYmFja19vcHRzPVRZUEUsU0laRSxVUkwmc2l6ZT02NCZ1cmw9aHR0cHM6Ly93d3cucGl4aXYubmV0Ci8vIEByZXF1aXJlICAgICAgICAgICAgIGh0dHBzOi8vdXBkYXRlLmdyZWFzeWZvcmsub3JnL3NjcmlwdHMvNTE1OTk0LzE0Nzg1MDcvZ2hfMjIxNV9tYWtlX0dNX3hocl9tb3JlX3BhcmFsbGVsX2FnYWluLmpzCi8vIEByZXF1aXJlICAgICAgICAgICAgIGh0dHBzOi8vb3BlbnVzZXJqcy5vcmcvc3JjL2xpYnMvc2l6emxlL0dNX2NvbmZpZy5qcwovLyBAZG93bmxvYWRVUkwgaHR0cHM6Ly91cGRhdGUuZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy8zMDc2Ni9QaXhpdiUyMFByZXZpZXdlci51c2VyLmpzCi8vIEB1cGRhdGVVUkwgaHR0cHM6Ly91cGRhdGUuZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy8zMDc2Ni9QaXhpdiUyMFByZXZpZXdlci5tZXRhLmpzCi8vID09L1VzZXJTY3JpcHQ9PQoKLy8gaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzQxNzc2MS1pbG9nCmZ1bmN0aW9uIElMb2coKSB7CiAgICB0aGlzLnByZWZpeCA9ICcnOwoKICAgIHRoaXMudiA9IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICAgIGlmIChsZXZlbCA8PSB0aGlzLkxvZ0xldmVsLlZlcmJvc2UpIHsKICAgICAgICAgICAgY29uc29sZS5sb2codGhpcy5wcmVmaXggKyB2YWx1ZSk7CiAgICAgICAgfQogICAgfQoKICAgIHRoaXMuaSA9IGZ1bmN0aW9uIChpbmZvKSB7CiAgICAgICAgaWYgKGxldmVsIDw9IHRoaXMuTG9nTGV2ZWwuSW5mbykgewogICAgICAgICAgICBjb25zb2xlLmluZm8odGhpcy5wcmVmaXggKyBpbmZvKTsKICAgICAgICB9CiAgICB9CgogICAgdGhpcy53ID0gZnVuY3Rpb24gKHdhcm5pbmcpIHsKICAgICAgICBpZiAobGV2ZWwgPD0gdGhpcy5Mb2dMZXZlbC5XYXJuaW5nKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2Fybih0aGlzLnByZWZpeCArIHdhcm5pbmcpOwogICAgICAgIH0KICAgIH0KCiAgICB0aGlzLmUgPSBmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBpZiAobGV2ZWwgPD0gdGhpcy5Mb2dMZXZlbC5FcnJvcikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKHRoaXMucHJlZml4ICsgZXJyb3IpOwogICAgICAgIH0KICAgIH0KCiAgICB0aGlzLmQgPSBmdW5jdGlvbiAoZWxlbWVudCkgewogICAgICAgIGlmIChsZXZlbCA8PSB0aGlzLkxvZ0xldmVsLlZlcmJvc2UpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coZWxlbWVudCk7CiAgICAgICAgfQogICAgfQoKICAgIHRoaXMuc2V0TG9nTGV2ZWwgPSBmdW5jdGlvbiAobG9nTGV2ZWwpIHsKICAgICAgICBsZXZlbCA9IGxvZ0xldmVsOwogICAgfQoKICAgIHRoaXMuTG9nTGV2ZWwgPSB7CiAgICAgICAgVmVyYm9zZTogMCwKICAgICAgICBJbmZvOiAxLAogICAgICAgIFdhcm5pbmc6IDIsCiAgICAgICAgRXJyb3I6IDMsCiAgICB9OwoKICAgIGxldCBsZXZlbCA9IHRoaXMuTG9nTGV2ZWwuV2FybmluZzsKfQp2YXIgaUxvZyA9IG5ldyBJTG9nKCk7Cgp2YXIgR01fX3htbEh0dHBSZXF1ZXN0OwppZiAoInVuZGVmaW5lZCIgIT0gdHlwZW9mIChHTV94bWxodHRwUmVxdWVzdCkpIHsKICAgIEdNX194bWxIdHRwUmVxdWVzdCA9IEdNX3htbGh0dHBSZXF1ZXN0Owp9IGVsc2UgewogICAgR01fX3htbEh0dHBSZXF1ZXN0ID0gR00ueG1sSHR0cFJlcXVlc3Q7Cn0KCi8vCi8vIFJlcXVpcmVkIGZvciBpT1MgPDYsIHdoZXJlIEJsb2IgVVJMcyBhcmUgbm90IGF2YWlsYWJsZS4gVGhpcyBpcyBzbG93Li4uCi8vIFNvdXJjZTogaHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vam9ubGVpZ2h0b24vOTU4ODQxCmZ1bmN0aW9uIGJhc2U2NEFycmF5QnVmZmVyKGFycmF5QnVmZmVyLCBvZmYsIGJ5dGVMZW5ndGgpIHsKICAgIHZhciBiYXNlNjQgPSAnJzsKICAgIHZhciBlbmNvZGluZ3MgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICB2YXIgYnl0ZXMgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlcik7CiAgICB2YXIgYnl0ZVJlbWFpbmRlciA9IGJ5dGVMZW5ndGggJSAzOwogICAgdmFyIG1haW5MZW5ndGggPSBvZmYgKyBieXRlTGVuZ3RoIC0gYnl0ZVJlbWFpbmRlcjsKICAgIHZhciBhLCBiLCBjLCBkOwogICAgdmFyIGNodW5rOwogICAgLy8gTWFpbiBsb29wIGRlYWxzIHdpdGggYnl0ZXMgaW4gY2h1bmtzIG9mIDMKICAgIGZvciAodmFyIGkgPSBvZmY7IGkgPCBtYWluTGVuZ3RoOyBpID0gaSArIDMpIHsKICAgICAgICAvLyBDb21iaW5lIHRoZSB0aHJlZSBieXRlcyBpbnRvIGEgc2luZ2xlIGludGVnZXIKICAgICAgICBjaHVuayA9IChieXRlc1tpXSA8PCAxNikgfCAoYnl0ZXNbaSArIDFdIDw8IDgpIHwgYnl0ZXNbaSArIDJdOwoKICAgICAgICAvLyBVc2UgYml0bWFza3MgdG8gZXh0cmFjdCA2LWJpdCBzZWdtZW50cyBmcm9tIHRoZSB0cmlwbGV0CiAgICAgICAgYSA9IChjaHVuayAmIDE2NTE1MDcyKSA+PiAxODsgLy8gMTY1MTUwNzIgPSAoMl42IC0gMSkgPDwgMTgKICAgICAgICBiID0gKGNodW5rICYgMjU4MDQ4KSA+PiAxMjsgLy8gMjU4MDQ4ICAgPSAoMl42IC0gMSkgPDwgMTIKICAgICAgICBjID0gKGNodW5rICYgNDAzMikgPj4gNjsgLy8gNDAzMiAgICAgPSAoMl42IC0gMSkgPDwgNgogICAgICAgIGQgPSBjaHVuayAmIDYzOyAgICAgICAgICAgICAgIC8vIDYzICAgICAgID0gMl42IC0gMQoKICAgICAgICAvLyBDb252ZXJ0IHRoZSByYXcgYmluYXJ5IHNlZ21lbnRzIHRvIHRoZSBhcHByb3ByaWF0ZSBBU0NJSSBlbmNvZGluZwogICAgICAgIGJhc2U2NCArPSBlbmNvZGluZ3NbYV0gKyBlbmNvZGluZ3NbYl0gKyBlbmNvZGluZ3NbY10gKyBlbmNvZGluZ3NbZF07CiAgICB9CgogICAgLy8gRGVhbCB3aXRoIHRoZSByZW1haW5pbmcgYnl0ZXMgYW5kIHBhZGRpbmcKICAgIGlmIChieXRlUmVtYWluZGVyID09IDEpIHsKICAgICAgICBjaHVuayA9IGJ5dGVzW21haW5MZW5ndGhdOwoKICAgICAgICBhID0gKGNodW5rICYgMjUyKSA+PiAyOyAvLyAyNTIgPSAoMl42IC0gMSkgPDwgMgoKICAgICAgICAvLyBTZXQgdGhlIDQgbGVhc3Qgc2lnbmlmaWNhbnQgYml0cyB0byB6ZXJvCiAgICAgICAgYiA9IChjaHVuayAmIDMpIDw8IDQ7IC8vIDMgICA9IDJeMiAtIDEKCiAgICAgICAgYmFzZTY0ICs9IGVuY29kaW5nc1thXSArIGVuY29kaW5nc1tiXSArICc9PSc7CiAgICB9IGVsc2UgaWYgKGJ5dGVSZW1haW5kZXIgPT0gMikgewogICAgICAgIGNodW5rID0gKGJ5dGVzW21haW5MZW5ndGhdIDw8IDgpIHwgYnl0ZXNbbWFpbkxlbmd0aCArIDFdOwoKICAgICAgICBhID0gKGNodW5rICYgNjQ1MTIpID4+IDEwOyAvLyA2NDUxMiA9ICgyXjYgLSAxKSA8PCAxMAogICAgICAgIGIgPSAoY2h1bmsgJiAxMDA4KSA+PiA0OyAvLyAxMDA4ICA9ICgyXjYgLSAxKSA8PCA0CgogICAgICAgIC8vIFNldCB0aGUgMiBsZWFzdCBzaWduaWZpY2FudCBiaXRzIHRvIHplcm8KICAgICAgICBjID0gKGNodW5rICYgMTUpIDw8IDI7IC8vIDE1ICAgID0gMl40IC0gMQoKICAgICAgICBiYXNlNjQgKz0gZW5jb2RpbmdzW2FdICsgZW5jb2RpbmdzW2JdICsgZW5jb2RpbmdzW2NdICsgJz0nOwogICAgfQoKICAgIHJldHVybiBiYXNlNjQ7Cn0KCmZ1bmN0aW9uIFppcEltYWdlUGxheWVyKG9wdGlvbnMpIHsKICAgIHRoaXMub3AgPSBvcHRpb25zOwogICAgdGhpcy5fVVJMID0gKHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTCB8fCB3aW5kb3cuTW96VVJMCiAgICAgICAgfHwgd2luZG93Lk1TVVJMKTsKICAgIHRoaXMuX0Jsb2IgPSAod2luZG93LkJsb2IgfHwgd2luZG93LldlYktpdEJsb2IgfHwgd2luZG93Lk1vekJsb2IKICAgICAgICB8fCB3aW5kb3cuTVNCbG9iKTsKICAgIHRoaXMuX0Jsb2JCdWlsZGVyID0gKHdpbmRvdy5CbG9iQnVpbGRlciB8fCB3aW5kb3cuV2ViS2l0QmxvYkJ1aWxkZXIKICAgICAgICB8fCB3aW5kb3cuTW96QmxvYkJ1aWxkZXIgfHwgd2luZG93Lk1TQmxvYkJ1aWxkZXIpOwogICAgdGhpcy5fVWludDhBcnJheSA9ICh3aW5kb3cuVWludDhBcnJheSB8fCB3aW5kb3cuV2ViS2l0VWludDhBcnJheQogICAgICAgIHx8IHdpbmRvdy5Nb3pVaW50OEFycmF5IHx8IHdpbmRvdy5NU1VpbnQ4QXJyYXkpOwogICAgdGhpcy5fRGF0YVZpZXcgPSAod2luZG93LkRhdGFWaWV3IHx8IHdpbmRvdy5XZWJLaXREYXRhVmlldwogICAgICAgIHx8IHdpbmRvdy5Nb3pEYXRhVmlldyB8fCB3aW5kb3cuTVNEYXRhVmlldyk7CiAgICB0aGlzLl9BcnJheUJ1ZmZlciA9ICh3aW5kb3cuQXJyYXlCdWZmZXIgfHwgd2luZG93LldlYktpdEFycmF5QnVmZmVyCiAgICAgICAgfHwgd2luZG93Lk1vekFycmF5QnVmZmVyIHx8IHdpbmRvdy5NU0FycmF5QnVmZmVyKTsKICAgIHRoaXMuX21heExvYWRBaGVhZCA9IDA7CiAgICBpZiAoIXRoaXMuX1VSTCkgewogICAgICAgIHRoaXMuX2RlYnVnTG9nKCJObyBVUkwgc3VwcG9ydCEgV2lsbCB1c2Ugc2xvd2VyIGRhdGE6IFVSTHMuIik7CiAgICAgICAgLy8gVGhyb3R0bGUgbG9hZGluZyB0byBhdm9pZCBtYWtpbmcgcGxheWJhY2sgc3RhbGxpbmcgY29tcGxldGVseSB3aGlsZQogICAgICAgIC8vIGxvYWRpbmcgaW1hZ2VzLi4uCiAgICAgICAgdGhpcy5fbWF4TG9hZEFoZWFkID0gMTA7CiAgICB9CiAgICBpZiAoIXRoaXMuX0Jsb2IpIHsKICAgICAgICB0aGlzLl9lcnJvcigiTm8gQmxvYiBzdXBwb3J0Iik7CiAgICB9CiAgICBpZiAoIXRoaXMuX1VpbnQ4QXJyYXkpIHsKICAgICAgICB0aGlzLl9lcnJvcigiTm8gVWludDhBcnJheSBzdXBwb3J0Iik7CiAgICB9CiAgICBpZiAoIXRoaXMuX0RhdGFWaWV3KSB7CiAgICAgICAgdGhpcy5fZXJyb3IoIk5vIERhdGFWaWV3IHN1cHBvcnQiKTsKICAgIH0KICAgIGlmICghdGhpcy5fQXJyYXlCdWZmZXIpIHsKICAgICAgICB0aGlzLl9lcnJvcigiTm8gQXJyYXlCdWZmZXIgc3VwcG9ydCIpOwogICAgfQogICAgdGhpcy5faXNTYWZhcmkgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoCiAgICAgICAgd2luZG93LkhUTUxFbGVtZW50KS5pbmRleE9mKCdDb25zdHJ1Y3RvcicpID4gMDsKICAgIHRoaXMuX2xvYWRpbmdTdGF0ZSA9IDA7CiAgICB0aGlzLl9kZWFkID0gZmFsc2U7CiAgICB0aGlzLl9jb250ZXh0ID0gb3B0aW9ucy5jYW52YXMuZ2V0Q29udGV4dCgiMmQiKTsKICAgIHRoaXMuX2ZpbGVzID0ge307CiAgICB0aGlzLl9mcmFtZUNvdW50ID0gdGhpcy5vcC5tZXRhZGF0YS5mcmFtZXMubGVuZ3RoOwogICAgdGhpcy5fZGVidWdMb2coIkZyYW1lIGNvdW50OiAiICsgdGhpcy5fZnJhbWVDb3VudCk7CiAgICB0aGlzLl9mcmFtZSA9IDA7CiAgICB0aGlzLl9sb2FkRnJhbWUgPSAwOwogICAgdGhpcy5fZnJhbWVJbWFnZXMgPSBbXTsKICAgIHRoaXMuX3BhdXNlZCA9IGZhbHNlOwogICAgdGhpcy5fbG9hZFRpbWVyID0gbnVsbDsKICAgIHRoaXMuX3N0YXJ0TG9hZCgpOwogICAgaWYgKHRoaXMub3AuYXV0b1N0YXJ0KSB7CiAgICAgICAgdGhpcy5wbGF5KCk7CiAgICB9IGVsc2UgewogICAgICAgIHRoaXMuX3BhdXNlZCA9IHRydWU7CiAgICB9Cn0KClppcEltYWdlUGxheWVyLnByb3RvdHlwZSA9IHsKICAgIF90cmFpbGVyQnl0ZXM6IDMwMDAwLAogICAgX2ZhaWxlZDogZmFsc2UsCiAgICBfbWtlcnI6IGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIF90aGlzLl9lcnJvcihtc2cpOwogICAgICAgIH0KICAgIH0sCiAgICBfZXJyb3I6IGZ1bmN0aW9uIChtc2cpIHsKICAgICAgICB0aGlzLl9mYWlsZWQgPSB0cnVlOwogICAgICAgIHRocm93IEVycm9yKCJaaXBJbWFnZVBsYXllciBlcnJvcjogIiArIG1zZyk7CiAgICB9LAogICAgX2RlYnVnTG9nOiBmdW5jdGlvbiAobXNnKSB7CiAgICAgICAgaWYgKHRoaXMub3AuZGVidWcpIHsKICAgICAgICAgICAgY29uc29sZS5sb2cobXNnKTsKICAgICAgICB9CiAgICB9LAogICAgX2xvYWQ6IGZ1bmN0aW9uIChvZmZzZXQsIGxlbmd0aCwgY2FsbGJhY2spIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgIC8vIFVuZm9ydHVuYXRlbHkgSlF1ZXJ5IGRvZXNuJ3Qgc3VwcG9ydCBBcnJheUJ1ZmZlciBYSFIKICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLCBmdW5jdGlvbiAoZXYpIHsKICAgICAgICAgICAgaWYgKF90aGlzLl9kZWFkKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3RoaXMuX2RlYnVnTG9nKCJMb2FkOiAiICsgb2Zmc2V0ICsgIiAiICsgbGVuZ3RoICsgIiBzdGF0dXM9IiArCiAgICAgICAgICAgICAgICB4aHIuc3RhdHVzKTsKICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5fZGVidWdMb2coIlJhbmdlIGRpc2FibGVkIG9yIHVuc3VwcG9ydGVkLCBjb21wbGV0ZSBsb2FkIik7CiAgICAgICAgICAgICAgICBvZmZzZXQgPSAwOwogICAgICAgICAgICAgICAgbGVuZ3RoID0geGhyLnJlc3BvbnNlLmJ5dGVMZW5ndGg7CiAgICAgICAgICAgICAgICBfdGhpcy5fbGVuID0gbGVuZ3RoOwogICAgICAgICAgICAgICAgX3RoaXMuX2J1ZiA9IHhoci5yZXNwb25zZTsKICAgICAgICAgICAgICAgIF90aGlzLl9ieXRlcyA9IG5ldyBfdGhpcy5fVWludDhBcnJheShfdGhpcy5fYnVmKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzICE9IDIwNikgewogICAgICAgICAgICAgICAgICAgIF90aGlzLl9lcnJvcigiVW5leHBlY3RlZCBIVFRQIHN0YXR1cyAiICsgeGhyLnN0YXR1cyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlLmJ5dGVMZW5ndGggIT0gbGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2Vycm9yKCJVbmV4cGVjdGVkIGxlbmd0aCAiICsKICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnJlc3BvbnNlLmJ5dGVMZW5ndGggKwogICAgICAgICAgICAgICAgICAgICAgICAiIChleHBlY3RlZCAiICsgbGVuZ3RoICsgIikiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF90aGlzLl9ieXRlcy5zZXQobmV3IF90aGlzLl9VaW50OEFycmF5KHhoci5yZXNwb25zZSksIG9mZnNldCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7CiAgICAgICAgICAgICAgICBjYWxsYmFjay5hcHBseShfdGhpcywgW29mZnNldCwgbGVuZ3RoXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCBmYWxzZSk7CiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoImVycm9yIiwgdGhpcy5fbWtlcnIoIkZldGNoIGZhaWxlZCIpLCBmYWxzZSk7CiAgICAgICAgeGhyLm9wZW4oIkdFVCIsIHRoaXMub3Auc291cmNlKTsKICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gImFycmF5YnVmZmVyIjsKICAgICAgICBpZiAob2Zmc2V0ICE9IG51bGwgJiYgbGVuZ3RoICE9IG51bGwpIHsKICAgICAgICAgICAgdmFyIGVuZCA9IG9mZnNldCArIGxlbmd0aDsKICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoIlJhbmdlIiwgImJ5dGVzPSIgKyBvZmZzZXQgKyAiLSIgKyAoZW5kIC0gMSkpOwogICAgICAgICAgICBpZiAodGhpcy5faXNTYWZhcmkpIHsKICAgICAgICAgICAgICAgIC8vIFJhbmdlIHJlcXVlc3QgY2FjaGluZyBpcyBicm9rZW4gaW4gU2FmYXJpCiAgICAgICAgICAgICAgICAvLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9ODI2NzIKICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCJDYWNoZS1jb250cm9sIiwgIm5vLWNhY2hlIik7CiAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcigiSWYtTm9uZS1NYXRjaCIsIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLyp0aGlzLl9kZWJ1Z0xvZygiTG9hZDogIiArIG9mZnNldCArICIgIiArIGxlbmd0aCk7Ki8KICAgICAgICB4aHIuc2VuZCgpOwogICAgfSwKICAgIF9zdGFydExvYWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICAgIGlmICghdGhpcy5vcC5zb3VyY2UpIHsKICAgICAgICAgICAgLy8gVW5wYWNrZWQgbW9kZSAoaW5kaXZpZGl1YWwgZnJhbWUgVVJMcykgLSBqdXN0IGxvYWQgdGhlIGZyYW1lcy4KICAgICAgICAgICAgdGhpcy5fbG9hZE5leHRGcmFtZSgpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHVybDogdGhpcy5vcC5zb3VyY2UsCiAgICAgICAgICAgIHR5cGU6ICJIRUFEIgogICAgICAgIH0pLmRvbmUoZnVuY3Rpb24gKGRhdGEsIHN0YXR1cywgeGhyKSB7CiAgICAgICAgICAgIGlmIChfdGhpcy5fZGVhZCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIF90aGlzLl9wSGVhZCA9IDA7CiAgICAgICAgICAgIF90aGlzLl9wTmV4dEhlYWQgPSAwOwogICAgICAgICAgICBfdGhpcy5fcEZldGNoID0gMDsKICAgICAgICAgICAgdmFyIGxlbiA9IHBhcnNlSW50KHhoci5nZXRSZXNwb25zZUhlYWRlcigiQ29udGVudC1MZW5ndGgiKSk7CiAgICAgICAgICAgIGlmICghbGVuKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5fZGVidWdMb2coIkhFQUQgcmVxdWVzdCBmYWlsZWQ6IGludmFsaWQgZmlsZSBsZW5ndGguIik7CiAgICAgICAgICAgICAgICBfdGhpcy5fZGVidWdMb2coIkZhbGxpbmcgYmFjayB0byBmdWxsIGZpbGUgbW9kZS4iKTsKICAgICAgICAgICAgICAgIF90aGlzLl9sb2FkKG51bGwsIG51bGwsIGZ1bmN0aW9uIChvZmYsIGxlbikgewogICAgICAgICAgICAgICAgICAgIF90aGlzLl9wVGFpbCA9IDA7CiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX3BIZWFkID0gbGVuOwogICAgICAgICAgICAgICAgICAgIF90aGlzLl9maW5kQ2VudHJhbERpcmVjdG9yeSgpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3RoaXMuX2RlYnVnTG9nKCJMZW46ICIgKyBsZW4pOwogICAgICAgICAgICBfdGhpcy5fbGVuID0gbGVuOwogICAgICAgICAgICBfdGhpcy5fYnVmID0gbmV3IF90aGlzLl9BcnJheUJ1ZmZlcihsZW4pOwogICAgICAgICAgICBfdGhpcy5fYnl0ZXMgPSBuZXcgX3RoaXMuX1VpbnQ4QXJyYXkoX3RoaXMuX2J1Zik7CiAgICAgICAgICAgIHZhciBvZmYgPSBsZW4gLSBfdGhpcy5fdHJhaWxlckJ5dGVzOwogICAgICAgICAgICBpZiAob2ZmIDwgMCkgewogICAgICAgICAgICAgICAgb2ZmID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBfdGhpcy5fcFRhaWwgPSBsZW47CiAgICAgICAgICAgIF90aGlzLl9sb2FkKG9mZiwgbGVuIC0gb2ZmLCBmdW5jdGlvbiAob2ZmLCBsZW4pIHsKICAgICAgICAgICAgICAgIF90aGlzLl9wVGFpbCA9IG9mZjsKICAgICAgICAgICAgICAgIF90aGlzLl9maW5kQ2VudHJhbERpcmVjdG9yeSgpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KS5mYWlsKHRoaXMuX21rZXJyKCJMZW5ndGggZmV0Y2ggZmFpbGVkIikpOwogICAgfSwKICAgIF9maW5kQ2VudHJhbERpcmVjdG9yeTogZnVuY3Rpb24gKCkgewogICAgICAgIC8vIE5vIHN1cHBvcnQgZm9yIFpJUCBmaWxlIGNvbW1lbnQKICAgICAgICB2YXIgZHYgPSBuZXcgdGhpcy5fRGF0YVZpZXcodGhpcy5fYnVmLCB0aGlzLl9sZW4gLSAyMiwgMjIpOwogICAgICAgIGlmIChkdi5nZXRVaW50MzIoMCwgdHJ1ZSkgIT0gMHgwNjA1NGI1MCkgewogICAgICAgICAgICB0aGlzLl9lcnJvcigiRW5kIG9mIENlbnRyYWwgRGlyZWN0b3J5IHNpZ25hdHVyZSBub3QgZm91bmQiKTsKICAgICAgICB9CiAgICAgICAgdmFyIGNkX2NvdW50ID0gZHYuZ2V0VWludDE2KDEwLCB0cnVlKTsKICAgICAgICB2YXIgY2Rfc2l6ZSA9IGR2LmdldFVpbnQzMigxMiwgdHJ1ZSk7CiAgICAgICAgdmFyIGNkX29mZiA9IGR2LmdldFVpbnQzMigxNiwgdHJ1ZSk7CiAgICAgICAgaWYgKGNkX29mZiA8IHRoaXMuX3BUYWlsKSB7CiAgICAgICAgICAgIHRoaXMuX2xvYWQoY2Rfb2ZmLCB0aGlzLl9wVGFpbCAtIGNkX29mZiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdGhpcy5fcFRhaWwgPSBjZF9vZmY7CiAgICAgICAgICAgICAgICB0aGlzLl9yZWFkQ2VudHJhbERpcmVjdG9yeShjZF9vZmYsIGNkX3NpemUsIGNkX2NvdW50KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5fcmVhZENlbnRyYWxEaXJlY3RvcnkoY2Rfb2ZmLCBjZF9zaXplLCBjZF9jb3VudCk7CiAgICAgICAgfQogICAgfSwKICAgIF9yZWFkQ2VudHJhbERpcmVjdG9yeTogZnVuY3Rpb24gKG9mZnNldCwgc2l6ZSwgY291bnQpIHsKICAgICAgICB2YXIgZHYgPSBuZXcgdGhpcy5fRGF0YVZpZXcodGhpcy5fYnVmLCBvZmZzZXQsIHNpemUpOwogICAgICAgIHZhciBwID0gMDsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKICAgICAgICAgICAgaWYgKGR2LmdldFVpbnQzMihwLCB0cnVlKSAhPSAweDAyMDE0YjUwKSB7CiAgICAgICAgICAgICAgICB0aGlzLl9lcnJvcigiSW52YWxpZCBDZW50cmFsIERpcmVjdG9yeSBzaWduYXR1cmUiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgY29tcE1ldGhvZCA9IGR2LmdldFVpbnQxNihwICsgMTAsIHRydWUpOwogICAgICAgICAgICB2YXIgdW5jb21wU2l6ZSA9IGR2LmdldFVpbnQzMihwICsgMjQsIHRydWUpOwogICAgICAgICAgICB2YXIgbmFtZUxlbiA9IGR2LmdldFVpbnQxNihwICsgMjgsIHRydWUpOwogICAgICAgICAgICB2YXIgZXh0cmFMZW4gPSBkdi5nZXRVaW50MTYocCArIDMwLCB0cnVlKTsKICAgICAgICAgICAgdmFyIGNtdExlbiA9IGR2LmdldFVpbnQxNihwICsgMzIsIHRydWUpOwogICAgICAgICAgICB2YXIgb2ZmID0gZHYuZ2V0VWludDMyKHAgKyA0MiwgdHJ1ZSk7CiAgICAgICAgICAgIGlmIChjb21wTWV0aG9kICE9IDApIHsKICAgICAgICAgICAgICAgIHRoaXMuX2Vycm9yKCJVbnN1cHBvcnRlZCBjb21wcmVzc2lvbiBtZXRob2QiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBwICs9IDQ2OwogICAgICAgICAgICB2YXIgbmFtZVZpZXcgPSBuZXcgdGhpcy5fVWludDhBcnJheSh0aGlzLl9idWYsIG9mZnNldCArIHAsIG5hbWVMZW4pOwogICAgICAgICAgICB2YXIgbmFtZSA9ICIiOwogICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG5hbWVMZW47IGorKykgewogICAgICAgICAgICAgICAgbmFtZSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKG5hbWVWaWV3W2pdKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBwICs9IG5hbWVMZW4gKyBleHRyYUxlbiArIGNtdExlbjsKICAgICAgICAgICAgLyp0aGlzLl9kZWJ1Z0xvZygiRmlsZTogIiArIG5hbWUgKyAiICgiICsgdW5jb21wU2l6ZSArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICIgYnl0ZXMgQCAiICsgb2ZmICsgIikiKTsqLwogICAgICAgICAgICB0aGlzLl9maWxlc1tuYW1lXSA9IHsgb2ZmOiBvZmYsIGxlbjogdW5jb21wU2l6ZSB9OwogICAgICAgIH0KICAgICAgICAvLyBUd28gb3V0c3RhbmRpbmcgZmV0Y2hlcyBhdCBhbnkgZ2l2ZW4gdGltZS4KICAgICAgICAvLyBOb3RlOiB0aGUgaW1wbGVtZW50YXRpb24gZG9lcyBub3Qgc3VwcG9ydCBtb3JlIHRoYW4gdHdvLgogICAgICAgIGlmICh0aGlzLl9wSGVhZCA+PSB0aGlzLl9wVGFpbCkgewogICAgICAgICAgICB0aGlzLl9wSGVhZCA9IHRoaXMuX2xlbjsKICAgICAgICAgICAgJCh0aGlzKS50cmlnZ2VySGFuZGxlcigibG9hZFByb2dyZXNzIiwgW3RoaXMuX3BIZWFkIC8gdGhpcy5fbGVuXSk7CiAgICAgICAgICAgIHRoaXMuX2xvYWROZXh0RnJhbWUoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLl9sb2FkTmV4dENodW5rKCk7CiAgICAgICAgICAgIHRoaXMuX2xvYWROZXh0Q2h1bmsoKTsKICAgICAgICB9CiAgICB9LAogICAgX2xvYWROZXh0Q2h1bms6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5fcEZldGNoID49IHRoaXMuX3BUYWlsKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdmFyIG9mZiA9IHRoaXMuX3BGZXRjaDsKICAgICAgICB2YXIgbGVuID0gdGhpcy5vcC5jaHVua1NpemU7CiAgICAgICAgaWYgKHRoaXMuX3BGZXRjaCArIGxlbiA+IHRoaXMuX3BUYWlsKSB7CiAgICAgICAgICAgIGxlbiA9IHRoaXMuX3BUYWlsIC0gdGhpcy5fcEZldGNoOwogICAgICAgIH0KICAgICAgICB0aGlzLl9wRmV0Y2ggKz0gbGVuOwogICAgICAgIHRoaXMuX2xvYWQob2ZmLCBsZW4sIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKG9mZiA9PSB0aGlzLl9wSGVhZCkgewogICAgICAgICAgICAgICAgaWYgKHRoaXMuX3BOZXh0SGVhZCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuX3BIZWFkID0gdGhpcy5fcE5leHRIZWFkOwogICAgICAgICAgICAgICAgICAgIHRoaXMuX3BOZXh0SGVhZCA9IDA7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuX3BIZWFkID0gb2ZmICsgbGVuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHRoaXMuX3BIZWFkID49IHRoaXMuX3BUYWlsKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcEhlYWQgPSB0aGlzLl9sZW47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvKnRoaXMuX2RlYnVnTG9nKCJOZXcgcEhlYWQ6ICIgKyB0aGlzLl9wSGVhZCk7Ki8KICAgICAgICAgICAgICAgICQodGhpcykudHJpZ2dlckhhbmRsZXIoImxvYWRQcm9ncmVzcyIsCiAgICAgICAgICAgICAgICAgICAgW3RoaXMuX3BIZWFkIC8gdGhpcy5fbGVuXSk7CiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2xvYWRUaW1lcikgewogICAgICAgICAgICAgICAgICAgIHRoaXMuX2xvYWROZXh0RnJhbWUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuX3BOZXh0SGVhZCA9IG9mZiArIGxlbjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLl9sb2FkTmV4dENodW5rKCk7CiAgICAgICAgfSk7CiAgICB9LAogICAgX2ZpbGVEYXRhU3RhcnQ6IGZ1bmN0aW9uIChvZmZzZXQpIHsKICAgICAgICB2YXIgZHYgPSBuZXcgRGF0YVZpZXcodGhpcy5fYnVmLCBvZmZzZXQsIDMwKTsKICAgICAgICB2YXIgbmFtZUxlbiA9IGR2LmdldFVpbnQxNigyNiwgdHJ1ZSk7CiAgICAgICAgdmFyIGV4dHJhTGVuID0gZHYuZ2V0VWludDE2KDI4LCB0cnVlKTsKICAgICAgICByZXR1cm4gb2Zmc2V0ICsgMzAgKyBuYW1lTGVuICsgZXh0cmFMZW47CiAgICB9LAogICAgX2lzRmlsZUF2YWlsYWJsZTogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICB2YXIgaW5mbyA9IHRoaXMuX2ZpbGVzW25hbWVdOwogICAgICAgIGlmICghaW5mbykgewogICAgICAgICAgICB0aGlzLl9lcnJvcigiRmlsZSAiICsgbmFtZSArICIgbm90IGZvdW5kIGluIFpJUCIpOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5fcEhlYWQgPCAoaW5mby5vZmYgKyAzMCkpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpcy5fcEhlYWQgPj0gKHRoaXMuX2ZpbGVEYXRhU3RhcnQoaW5mby5vZmYpICsgaW5mby5sZW4pOwogICAgfSwKICAgIF9sb2FkTmV4dEZyYW1lOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMuX2RlYWQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB2YXIgZnJhbWUgPSB0aGlzLl9sb2FkRnJhbWU7CiAgICAgICAgaWYgKGZyYW1lID49IHRoaXMuX2ZyYW1lQ291bnQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB2YXIgbWV0YSA9IHRoaXMub3AubWV0YWRhdGEuZnJhbWVzW2ZyYW1lXTsKICAgICAgICBpZiAoIXRoaXMub3Auc291cmNlKSB7CiAgICAgICAgICAgIC8vIFVucGFja2VkIG1vZGUgKGluZGl2aWRpdWFsIGZyYW1lIFVSTHMpCiAgICAgICAgICAgIHRoaXMuX2xvYWRGcmFtZSArPSAxOwogICAgICAgICAgICB0aGlzLl9sb2FkSW1hZ2UoZnJhbWUsIG1ldGEuZmlsZSwgZmFsc2UpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICghdGhpcy5faXNGaWxlQXZhaWxhYmxlKG1ldGEuZmlsZSkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLl9sb2FkRnJhbWUgKz0gMTsKICAgICAgICB2YXIgb2ZmID0gdGhpcy5fZmlsZURhdGFTdGFydCh0aGlzLl9maWxlc1ttZXRhLmZpbGVdLm9mZik7CiAgICAgICAgdmFyIGVuZCA9IG9mZiArIHRoaXMuX2ZpbGVzW21ldGEuZmlsZV0ubGVuOwogICAgICAgIHZhciB1cmw7CiAgICAgICAgdmFyIG1pbWVfdHlwZSA9IHRoaXMub3AubWV0YWRhdGEubWltZV90eXBlIHx8ICJpbWFnZS9wbmciOwogICAgICAgIGlmICh0aGlzLl9VUkwpIHsKICAgICAgICAgICAgdmFyIHNsaWNlOwogICAgICAgICAgICBpZiAoIXRoaXMuX2J1Zi5zbGljZSkgewogICAgICAgICAgICAgICAgc2xpY2UgPSBuZXcgdGhpcy5fQXJyYXlCdWZmZXIodGhpcy5fZmlsZXNbbWV0YS5maWxlXS5sZW4pOwogICAgICAgICAgICAgICAgdmFyIHZpZXcgPSBuZXcgdGhpcy5fVWludDhBcnJheShzbGljZSk7CiAgICAgICAgICAgICAgICB2aWV3LnNldCh0aGlzLl9ieXRlcy5zdWJhcnJheShvZmYsIGVuZCkpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgc2xpY2UgPSB0aGlzLl9idWYuc2xpY2Uob2ZmLCBlbmQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBibG9iOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgYmxvYiA9IG5ldyB0aGlzLl9CbG9iKFtzbGljZV0sIHsgdHlwZTogbWltZV90eXBlIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIHRoaXMuX2RlYnVnTG9nKCJCbG9iIGNvbnN0cnVjdG9yIGZhaWxlZC4gVHJ5aW5nIEJsb2JCdWlsZGVyLi4uIgogICAgICAgICAgICAgICAgICAgICsgIiAoIiArIGVyci5tZXNzYWdlICsgIikiKTsKICAgICAgICAgICAgICAgIHZhciBiYiA9IG5ldyB0aGlzLl9CbG9iQnVpbGRlcigpOwogICAgICAgICAgICAgICAgYmIuYXBwZW5kKHNsaWNlKTsKICAgICAgICAgICAgICAgIGJsb2IgPSBiYi5nZXRCbG9iKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLypfdGhpcy5fZGVidWdMb2coIkxvYWRpbmcgIiArIG1ldGEuZmlsZSArICIgdG8gZnJhbWUgIiArIGZyYW1lKTsqLwogICAgICAgICAgICB1cmwgPSB0aGlzLl9VUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICB0aGlzLl9sb2FkSW1hZ2UoZnJhbWUsIHVybCwgdHJ1ZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdXJsID0gKCJkYXRhOiIgKyBtaW1lX3R5cGUgKyAiO2Jhc2U2NCwiCiAgICAgICAgICAgICAgICArIGJhc2U2NEFycmF5QnVmZmVyKHRoaXMuX2J1Ziwgb2ZmLCBlbmQgLSBvZmYpKTsKICAgICAgICAgICAgdGhpcy5fbG9hZEltYWdlKGZyYW1lLCB1cmwsIGZhbHNlKTsKICAgICAgICB9CiAgICB9LAogICAgX2xvYWRJbWFnZTogZnVuY3Rpb24gKGZyYW1lLCB1cmwsIGlzQmxvYikgewogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgdmFyIGltYWdlID0gbmV3IEltYWdlKCk7CiAgICAgICAgdmFyIG1ldGEgPSB0aGlzLm9wLm1ldGFkYXRhLmZyYW1lc1tmcmFtZV07CiAgICAgICAgaW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXMuX2RlYnVnTG9nKCJMb2FkZWQgIiArIG1ldGEuZmlsZSArICIgdG8gZnJhbWUgIiArIGZyYW1lKTsKICAgICAgICAgICAgaWYgKGlzQmxvYikgewogICAgICAgICAgICAgICAgX3RoaXMuX1VSTC5yZXZva2VPYmplY3RVUkwodXJsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoX3RoaXMuX2RlYWQpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBfdGhpcy5fZnJhbWVJbWFnZXNbZnJhbWVdID0gaW1hZ2U7CiAgICAgICAgICAgICQoX3RoaXMpLnRyaWdnZXJIYW5kbGVyKCJmcmFtZUxvYWRlZCIsIGZyYW1lKTsKICAgICAgICAgICAgaWYgKF90aGlzLl9sb2FkaW5nU3RhdGUgPT0gMCkgewogICAgICAgICAgICAgICAgX3RoaXMuX2Rpc3BsYXlGcmFtZS5hcHBseShfdGhpcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGZyYW1lID49IChfdGhpcy5fZnJhbWVDb3VudCAtIDEpKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5fc2V0TG9hZGluZ1N0YXRlKDIpOwogICAgICAgICAgICAgICAgX3RoaXMuX2J1ZiA9IG51bGw7CiAgICAgICAgICAgICAgICBfdGhpcy5fYnl0ZXMgPSBudWxsOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaWYgKCFfdGhpcy5fbWF4TG9hZEFoZWFkIHx8CiAgICAgICAgICAgICAgICAgICAgKGZyYW1lIC0gX3RoaXMuX2ZyYW1lKSA8IF90aGlzLl9tYXhMb2FkQWhlYWQpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpcy5fbG9hZE5leHRGcmFtZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICghX3RoaXMuX2xvYWRUaW1lcikgewogICAgICAgICAgICAgICAgICAgIF90aGlzLl9sb2FkVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2xvYWRUaW1lciA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9sb2FkTmV4dEZyYW1lKCk7CiAgICAgICAgICAgICAgICAgICAgfSwgMjAwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIGltYWdlLnNyYyA9IHVybDsKICAgIH0sCiAgICBfc2V0TG9hZGluZ1N0YXRlOiBmdW5jdGlvbiAoc3RhdGUpIHsKICAgICAgICBpZiAodGhpcy5fbG9hZGluZ1N0YXRlICE9IHN0YXRlKSB7CiAgICAgICAgICAgIHRoaXMuX2xvYWRpbmdTdGF0ZSA9IHN0YXRlOwogICAgICAgICAgICAkKHRoaXMpLnRyaWdnZXJIYW5kbGVyKCJsb2FkaW5nU3RhdGVDaGFuZ2VkIiwgW3N0YXRlXSk7CiAgICAgICAgfQogICAgfSwKICAgIF9kaXNwbGF5RnJhbWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5fZGVhZCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CiAgICAgICAgdmFyIG1ldGEgPSB0aGlzLm9wLm1ldGFkYXRhLmZyYW1lc1t0aGlzLl9mcmFtZV07CiAgICAgICAgdGhpcy5fZGVidWdMb2coIkRpc3BsYXlpbmcgZnJhbWU6ICIgKyB0aGlzLl9mcmFtZSArICIgIiArIG1ldGEuZmlsZSk7CiAgICAgICAgdmFyIGltYWdlID0gdGhpcy5fZnJhbWVJbWFnZXNbdGhpcy5fZnJhbWVdOwogICAgICAgIGlmICghaW1hZ2UpIHsKICAgICAgICAgICAgdGhpcy5fZGVidWdMb2coIkltYWdlIG5vdCBhdmFpbGFibGUhIik7CiAgICAgICAgICAgIHRoaXMuX3NldExvYWRpbmdTdGF0ZSgwKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5fbG9hZGluZ1N0YXRlICE9IDIpIHsKICAgICAgICAgICAgdGhpcy5fc2V0TG9hZGluZ1N0YXRlKDEpOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5vcC5hdXRvc2l6ZSkgewogICAgICAgICAgICBpZiAodGhpcy5fY29udGV4dC5jYW52YXMud2lkdGggIT0gaW1hZ2Uud2lkdGggfHwgdGhpcy5fY29udGV4dC5jYW52YXMuaGVpZ2h0ICE9IGltYWdlLmhlaWdodCkgewogICAgICAgICAgICAgICAgLy8gbWFrZSB0aGUgY2FudmFzIGF1dG9zaXplIGl0c2VsZiBhY2NvcmRpbmcgdG8gdGhlIGltYWdlcyBkcmF3biBvbiBpdAogICAgICAgICAgICAgICAgLy8gc2hvdWxkIHNldCBpdCBvbmNlLCBzaW5jZSB3ZSBkb24ndCBoYXZlIHZhcmlhYmxlIHNpemVkIGZyYW1lcwogICAgICAgICAgICAgICAgdGhpcy5fY29udGV4dC5jYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDsKICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRleHQuY2FudmFzLmhlaWdodCA9IGltYWdlLmhlaWdodDsKICAgICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgdGhpcy5fY29udGV4dC5jbGVhclJlY3QoMCwgMCwgdGhpcy5vcC5jYW52YXMud2lkdGgsCiAgICAgICAgICAgIHRoaXMub3AuY2FudmFzLmhlaWdodCk7CiAgICAgICAgdGhpcy5fY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDApOwogICAgICAgICQodGhpcykudHJpZ2dlckhhbmRsZXIoImZyYW1lIiwgdGhpcy5fZnJhbWUpOwogICAgICAgIGlmICghdGhpcy5fcGF1c2VkKSB7CiAgICAgICAgICAgIHRoaXMuX3RpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5fdGltZXIgPSBudWxsOwogICAgICAgICAgICAgICAgX3RoaXMuX25leHRGcmFtZS5hcHBseShfdGhpcyk7CiAgICAgICAgICAgIH0sIG1ldGEuZGVsYXkpOwogICAgICAgIH0KICAgIH0sCiAgICBfbmV4dEZyYW1lOiBmdW5jdGlvbiAoZnJhbWUpIHsKICAgICAgICBpZiAodGhpcy5fZnJhbWUgPj0gKHRoaXMuX2ZyYW1lQ291bnQgLSAxKSkgewogICAgICAgICAgICBpZiAodGhpcy5vcC5sb29wKSB7CiAgICAgICAgICAgICAgICB0aGlzLl9mcmFtZSA9IDA7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLnBhdXNlKCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLl9mcmFtZSArPSAxOwogICAgICAgIH0KICAgICAgICB0aGlzLl9kaXNwbGF5RnJhbWUoKTsKICAgIH0sCiAgICBwbGF5OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMuX2RlYWQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAodGhpcy5fcGF1c2VkKSB7CiAgICAgICAgICAgICQodGhpcykudHJpZ2dlckhhbmRsZXIoInBsYXkiLCBbdGhpcy5fZnJhbWVdKTsKICAgICAgICAgICAgdGhpcy5fcGF1c2VkID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuX2Rpc3BsYXlGcmFtZSgpOwogICAgICAgIH0KICAgIH0sCiAgICBwYXVzZTogZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLl9kZWFkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCF0aGlzLl9wYXVzZWQpIHsKICAgICAgICAgICAgaWYgKHRoaXMuX3RpbWVyKSB7CiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZXIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuX3BhdXNlZCA9IHRydWU7CiAgICAgICAgICAgICQodGhpcykudHJpZ2dlckhhbmRsZXIoInBhdXNlIiwgW3RoaXMuX2ZyYW1lXSk7CiAgICAgICAgfQogICAgfSwKICAgIHJld2luZDogZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLl9kZWFkKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5fZnJhbWUgPSAwOwogICAgICAgIGlmICh0aGlzLl90aW1lcikgewogICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5fdGltZXIpOwogICAgICAgIH0KICAgICAgICB0aGlzLl9kaXNwbGF5RnJhbWUoKTsKICAgIH0sCiAgICBzdG9wOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5fZGVidWdMb2coIlN0b3BwZWQhIik7CiAgICAgICAgdGhpcy5fZGVhZCA9IHRydWU7CiAgICAgICAgaWYgKHRoaXMuX3RpbWVyKSB7CiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl90aW1lcik7CiAgICAgICAgfQogICAgICAgIGlmICh0aGlzLl9sb2FkVGltZXIpIHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX2xvYWRUaW1lcik7CiAgICAgICAgfQogICAgICAgIHRoaXMuX2ZyYW1lSW1hZ2VzID0gbnVsbDsKICAgICAgICB0aGlzLl9idWYgPSBudWxsOwogICAgICAgIHRoaXMuX2J5dGVzID0gbnVsbDsKICAgICAgICAkKHRoaXMpLnRyaWdnZXJIYW5kbGVyKCJzdG9wIik7CiAgICB9LAogICAgZ2V0Q3VycmVudEZyYW1lOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX2ZyYW1lOwogICAgfSwKICAgIGdldExvYWRlZEZyYW1lczogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzLl9mcmFtZUltYWdlcy5sZW5ndGg7CiAgICB9LAogICAgZ2V0RnJhbWVDb3VudDogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB0aGlzLl9mcmFtZUNvdW50OwogICAgfSwKICAgIGhhc0Vycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuX2ZhaWxlZDsKICAgIH0KfQoKLy8gaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzQxNzc2MC1jaGVja2pxdWVyeQp2YXIgY2hlY2tKUXVlcnkgPSBmdW5jdGlvbiAoKSB7CiAgICBsZXQganF1ZXJ5Q2RucyA9IFsKICAgICAgICAnaHR0cDovL2NvZGUuanF1ZXJ5LmNvbS9qcXVlcnktMi4xLjQubWluLmpzJywKICAgICAgICAnaHR0cHM6Ly9hamF4LmFzcG5ldGNkbi5jb20vYWpheC9qcXVlcnkvanF1ZXJ5LTIuMS40Lm1pbi5qcycsCiAgICAgICAgJ2h0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzIuMS40L2pxdWVyeS5taW4uanMnLAogICAgICAgICdodHRwczovL2Nkbi5zdGF0aWNmaWxlLm9yZy9qcXVlcnkvMi4xLjQvanF1ZXJ5Lm1pbi5qcycsCiAgICAgICAgJ2h0dHBzOi8vYXBwcy5iZGltZy5jb20vbGlicy9qcXVlcnkvMi4xLjQvanF1ZXJ5Lm1pbi5qcycsCiAgICBdOwogICAgZnVuY3Rpb24gaXNKUXVlcnlWYWxpZCgpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICBsZXQgd2QgPSB1bnNhZmVXaW5kb3c7CiAgICAgICAgICAgIGlmICh3ZC5qUXVlcnkgJiYgIXdkLiQpIHsKICAgICAgICAgICAgICAgIHdkLiQgPSB3ZC5qUXVlcnk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJCgpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9IGNhdGNoIChleGNlcHRpb24pIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIGluc2VydEpRdWVyeSh1cmwpIHsKICAgICAgICBsZXQgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgICAgc2NyaXB0LnNyYyA9IHVybDsKICAgICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHNjcmlwdCk7CiAgICAgICAgcmV0dXJuIHNjcmlwdDsKICAgIH0KICAgIGZ1bmN0aW9uIGNvbnZlclByb3RvY29sSWZOZWVkZWQodXJsKSB7CiAgICAgICAgbGV0IGlzSHR0cHMgPSBsb2NhdGlvbi5ocmVmLmluZGV4T2YoJ2h0dHBzOi8vJykgIT0gLTE7CiAgICAgICAgbGV0IHVybElzSHR0cHMgPSB1cmwuaW5kZXhPZignaHR0cHM6Ly8nKSAhPSAtMTsKCiAgICAgICAgaWYgKGlzSHR0cHMgJiYgIXVybElzSHR0cHMpIHsKICAgICAgICAgICAgcmV0dXJuIHVybC5yZXBsYWNlKCdodHRwOi8vJywgJ2h0dHBzOi8vJyk7CiAgICAgICAgfSBlbHNlIGlmICghaXNIdHRwcyAmJiB1cmxJc0h0dHBzKSB7CiAgICAgICAgICAgIHJldHVybiB1cmwucmVwbGFjZSgnaHR0cHM6Ly8nLCAnaHR0cDovLycpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdXJsOwogICAgfQogICAgZnVuY3Rpb24gd2FpdEFuZENoZWNrSlF1ZXJ5KGNkbkluZGV4LCByZXNvbHZlKSB7CiAgICAgICAgaWYgKGNkbkluZGV4ID49IGpxdWVyeUNkbnMubGVuZ3RoKSB7CiAgICAgICAgICAgIGlMb2cuZSgn5peg5rOV5Yqg6L29IEpRdWVyee+8jOato+WcqOmAgOWHuuOAgicpOwogICAgICAgICAgICByZXNvbHZlKGZhbHNlKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsZXQgdXJsID0gY29udmVyUHJvdG9jb2xJZk5lZWRlZChqcXVlcnlDZG5zW2NkbkluZGV4XSk7CiAgICAgICAgaUxvZy5pKCflsJ3or5XnrKwgJyArIChjZG5JbmRleCArIDEpICsgJyDkuKogSlF1ZXJ5IENETu+8micgKyB1cmwgKyAn44CCJyk7CiAgICAgICAgbGV0IHNjcmlwdCA9IGluc2VydEpRdWVyeSh1cmwpOwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBpZiAoaXNKUXVlcnlWYWxpZCgpKSB7CiAgICAgICAgICAgICAgICBpTG9nLmkoJ+W3suWKoOi9vSBKUXVlcnnjgIInKTsKICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpTG9nLncoJ+aXoOazleiuv+mXruOAgicpOwogICAgICAgICAgICAgICAgc2NyaXB0LnJlbW92ZSgpOwogICAgICAgICAgICAgICAgd2FpdEFuZENoZWNrSlF1ZXJ5KGNkbkluZGV4ICsgMSwgcmVzb2x2ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LCAxMDApOwogICAgfQogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgaWYgKGlzSlF1ZXJ5VmFsaWQoKSkgewogICAgICAgICAgICBpTG9nLmkoJ+W3suWKoOi9vSBqUXVlcnnjgIInKTsKICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpTG9nLmkoJ+acquWPkeeOsCBKUXVlcnnvvIzlsJ3or5XliqDovb3jgIInKTsKICAgICAgICAgICAgd2FpdEFuZENoZWNrSlF1ZXJ5KDAsIHJlc29sdmUpOwogICAgICAgIH0KICAgIH0pOwp9CgpsZXQgTGFuZyA9IHsKICAgIC8vIOiHquWKqOmAieaLqQogICAgYXV0bzogLTEsCiAgICAvLyDkuK3mloct5Lit5Zu95aSn6ZmGCiAgICB6aF9DTjogMCwKICAgIC8vIOiLseivrS3nvo7lm70KICAgIGVuX1VTOiAxLAogICAgLy8g5L+E6K+tLeS/hOe9l+aWrwogICAgcnVfUlU6IDIsCiAgICAvLyDml6XmnKzoqp4t5pel5pysCiAgICBqYV9KUDogMywKfTsKbGV0IFRleHRzID0ge307ClRleHRzW0xhbmcuemhfQ05dID0gewogICAgLy8g5a6J6KOF5oiW5pu05paw5ZCO5by55Ye655qE5o+Q56S6CiAgICBpbnN0YWxsX3RpdGxlOiAn5qyi6L+O5L2/55SoIFBpeGl2UHJldmlld2VyJywKICAgIGluc3RhbGxfYm9keTogJzxkaXYgc3R5bGU9InBvc2l0aW9uOiBhYnNvbHV0ZTtsZWZ0OiA1MCU7dG9wOiAzMCU7Zm9udC1zaXplOiAyMHB4OyBjb2xvcjogd2hpdGU7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtNTAlLDApOyI+PHAgc3R5bGU9InRleHQtaW5kZW50OiAyZW07Ij7mrKLov47lj43ppojpl67popjlkozmj5Dlh7rlu7rorq7vvIEg4piePGEgc3R5bGU9ImNvbG9yOiBncmVlbjsiIGhyZWY9Imh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvemgtQ04vc2NyaXB0cy8zMDc2Ni1waXhpdi1wcmV2aWV3ZXIvZmVlZGJhY2siIHRhcmdldD0iX2JsYW5rIj7lj43ppojpobXpnaI8L2E+PC9wPjxicj48cCBzdHlsZT0idGV4dC1pbmRlbnQ6IDJlbTsiPuWmguaenOaCqOaYr+esrOS4gOasoeS9v+eUqO+8jOaOqOiNkOWIsCDimJ48YSBzdHlsZT0iY29sb3I6IGdyZWVuOyIgaHJlZj0iaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzMwNzY2LXBpeGl2LXByZXZpZXdlciIgdGFyZ2V0PSJfYmxhbmsiPuivpuaDhemhtTwvYT4g5p+l55yL6ISa5pys5LuL57uN44CCPC9wPjwvZGl2PicsCiAgICB1cGdyYWRlX2JvZHk6ICc8aDM+5paw55qE6K6+572u6I+c5Y2VITwvaDM+Jm5ic3AmbmJzcDxwIHN0eWxlPSJ0ZXh0LWluZGVudDogMmVtOyI+5oSf6LCi5ZCE5L2N5L2/55SoIFBpeGl2IFByZXZpZXdlcizmnKzmrKHmm7TmlrDosIPmlbTkuoborr7nva7oj5zljZXnmoTop4bop4nmlYjmnpws5qyi6L+O5Y+N6aaI6Zeu6aKY5ZKM5o+Q5Ye65bu66K6uISDimJ48YSBzdHlsZT0iY29sb3I6IGdyZWVuOyIgaHJlZj0iaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzMwNzY2LXBpeGl2LXByZXZpZXdlci9mZWVkYmFjayIgdGFyZ2V0PSJfYmxhbmsiPuWPjemmiOmhtemdojwvYT48L3A+JywKICAgIC8vIOiuvue9rumhuQogICAgc2V0dGluZ19zZXR0aW5nU2VjdGlvbjogJ+iuvue9ricsCiAgICBzZXR0aW5nX2xhbmd1YWdlOiAn6K+t6KiAJywKICAgIHNldHRpbmdfcHJldmlldzogJ+mihOiniCcsCiAgICBzZXR0aW5nX2FuaW1lUHJldmlldzogJ+WKqOWbvumihOiniCcsCiAgICBzZXR0aW5nX3NvcnRTZWN0aW9uOiAn5o6S5bqPJywKICAgIHNldHRpbmdfc29ydDogJ+aOkuW6j++8iOS7heaQnOe0oumhteeUn+aViO+8iScsCiAgICBzZXR0aW5nX2FuaW1lOiAn5Yqo5Zu+5LiL6L2977yI5Yqo5Zu+6aKE6KeI5Y+K6K+m5oOF6aG155Sf5pWI77yJJywKICAgIHNldHRpbmdfb3JpZ2luOiAn6aKE6KeI5pe25LyY5YWI5pi+56S65Y6f5Zu+77yI5oWi77yJJywKICAgIHNldHRpbmdfcHJldmlld0RlbGF5OiAn5bu26L+f5pi+56S66aKE6KeI5Zu+77yI5q+r56eS77yJJywKICAgIHNldHRpbmdfcHJldmlld0J5S2V5OiAn5L2/55So5oyJ6ZSu5o6n5Yi26aKE6KeI5Zu+5bGV56S677yIQ3RybO+8iScsCiAgICBzZXR0aW5nX3ByZXZpZXdCeUtleUhlbHA6ICflvIDlkK/lkI7pvKDmoIfnp7vliqjliLDlm77niYfkuIrkuI3lho3lsZXnpLrpooTop4jlm77vvIzmjInkuItDdHJs6ZSu5omN5bGV56S677yM5ZCM5pe24oCc5bu26L+f5pi+56S66aKE6KeI4oCd6K6+572u6aG55LiN55Sf5pWI44CCJywKICAgIHNldHRpbmdfbWF4UGFnZTogJ+avj+asoeaOkuW6j+aXtue7n+iuoeeahOacgOWkp+mhteaVsCcsCiAgICBzZXR0aW5nX2hpZGVXb3JrOiAn6ZqQ6JeP5pS26JeP5pWw5bCR5LqO6K6+5a6a5YC855qE5L2c5ZOBJywKICAgIHNldHRpbmdfaGlkZUFpV29yazogJ+makOiXjyBBSSDnlJ/miJDkvZzlk4EnLAogICAgc2V0dGluZ19vbmx5QWlXb3JrOiAn5Y+q5pi+56S6IEFJIOeUn+aIkOS9nOWTgScsCiAgICBzZXR0aW5nX2hpZGVGYXY6ICfmjpLluo/ml7bpmpDol4/lt7LmlLbol4/nmoTkvZzlk4EnLAogICAgc2V0dGluZ19oaWRlRm9sbG93ZWQ6ICfmjpLluo/ml7bpmpDol4/lt7LlhbPms6jnlLvluIjkvZzlk4EnLAogICAgc2V0dGluZ19oaWRlQnlUYWc6ICfmjpLluo/ml7bpmpDol4/mjIflrprmoIfnrb7nmoTkvZzlk4EnLAogICAgc2V0dGluZ19oaWRlQnlUYWdQbGFjZWhvbGRlcjogJ+i+k+WFpeagh+etvuWQje+8jOWmgiAidGFnMXx0YWcyIu+8jOaUr+aMgeato+WImScsCiAgICBzZXR0aW5nX2hpZGVCeVVzZXI6ICfmjpLluo/ml7bpmpDol4/mjIflrprnlKjmiLfnmoTkvZzlk4EnLAogICAgc2V0dGluZ19oaWRlQnlVc2VyUGxhY2Vob2xkZXI6ICfovpPlhaXnlKjmiLdJRO+8jOWmgiAiMTIzNDV8Njc4OTAiJywKICAgIHNldHRpbmdfY2xlYXJGb2xsb3dpbmdDYWNoZTogJ+a4hemZpOe8k+WtmCcsCiAgICBzZXR0aW5nX2NsZWFyRm9sbG93aW5nQ2FjaGVIZWxwOiAn5YWz5rOo55S75biI5L+h5oGv5Lya5Zyo5pys5Zyw5L+d5a2Y5LiA5aSp77yM5aaC5p6c5biM5pyb56uL5Y2z5pu05paw77yM6K+354K55Ye75riF6Zmk57yT5a2YJywKICAgIHNldHRpbmdfZm9sbG93aW5nQ2FjaGVDbGVhcmVkOiAn5bey5riF6Zmk57yT5a2Y77yM6K+35Yi35paw6aG16Z2i44CCJywKICAgIHNldHRpbmdfYmxhbms6ICfkvb/nlKjmlrDmoIfnrb7pobXmiZPlvIDkvZzlk4Hor6bmg4XpobUnLAogICAgc2V0dGluZ190dXJuUGFnZTogJ+S9v+eUqOmUruebmOKGkOKGkui/m+ihjOe/u+mhte+8iOaOkuW6j+WQjueahOaQnOe0oumhte+8iScsCiAgICBzZXR0aW5nX3NhdmU6ICfkv53lrZjorr7nva4nLAogICAgc2V0dGluZ19yZXNldDogJ+mHjee9ruiEmuacrCcsCiAgICBzZXR0aW5nX3Jlc2V0SGludDogJ+i/meS8muWIoOmZpOaJgOacieiuvue9ru+8jOebuOW9k+S6jumHjeaWsOWuieijheiEmuacrO+8jOehruWumuimgemHjee9ruWQl++8nycsCiAgICBzZXR0aW5nX25vdmVsU29ydDogJ+Wwj+ivtOaOkuW6jycsCiAgICBzZXR0aW5nX25vdmVsTWF4UGFnZTogJ+Wwj+ivtOaOkuW6j+aXtue7n+iuoeeahOacgOWkp+mhteaVsCcsCiAgICBzZXR0aW5nX25vdmVsSGlkZVdvcms6ICfpmpDol4/mlLbol4/mlbDlsJHkuo7orr7lrprlgLznmoTkvZzlk4EnLAogICAgc2V0dGluZ19ub3ZlbEhpZGVGYXY6ICfmjpLluo/ml7bpmpDol4/lt7LmlLbol4/nmoTkvZzlk4EnLAogICAgc2V0dGluZ19wcmV2aWV3RnVsbFNjcmVlbjogJ+WFqOWxj+mihOiniCcsCiAgICBzZXR0aW5nX3Njcm9sbExvY2tXaGVuUHJldmlldzogJ+mihOiniOaXtumYu+atoumhtemdoua7muWKqCcsCiAgICBzZXR0aW5nX2xvZ0xldmVsOiAn5pel5b+X562J57qnJywKICAgIHNldHRpbmdfbm92ZWxTZWN0aW9uOiAn5bCP6K+05o6S5bqPJywKICAgIHNldHRpbmdfY2xvc2U6ICflhbPpl60nLAogICAgc2V0dGluZ19tYXhYaHI6ICfmlLbol4/mlbDlubblj5HvvIjmjqjojZAgNjTvvIknLAogICAgc2V0dGluZ19oaWRlQnlDb3VudExlc3NUaGFuOiAn6ZqQ6JeP5Zu+54mH5byg5pWw5bCR5LqO6K6+5a6a5YC855qE5L2c5ZOBJywKICAgIHNldHRpbmdfaGlkZUJ5Q291bnRNb3JlVGhhbjogJ+makOiXj+WbvueJh+W8oOaVsOWkmuS6juiuvuWumuWAvOeahOS9nOWTgScsCiAgICAvLyDmkJzntKLml7bov4fmu6TlgLzlpKrpq5gKICAgIHNvcnRfbm9Xb3JrOiAn5rKh5pyJ5Y+v5Lul5pi+56S655qE5L2c5ZOB77yI6ZqQ6JeP5LqGICUxIOS4quS9nOWTge+8iScsCiAgICBzb3J0X2dldFdvcmtzOiAn5q2j5Zyo6I635Y+W56ysJTEvJTLpobXkvZzlk4EnLAogICAgc29ydF9nZXRCb29rbWFya0NvdW50OiAn6I635Y+W5pS26JeP5pWw77yaJTEvJTInLAogICAgc29ydF9nZXRQdWJsaWNGb2xsb3dpbmc6ICfojrflj5blhazlvIDlhbPms6jnlLvluIgnLAogICAgc29ydF9nZXRQcml2YXRlRm9sbG93aW5nOiAn6I635Y+W56eB5pyJ5YWz5rOo55S75biIJywKICAgIHNvcnRfZmlsdGVyaW5nOiAn6L+H5rukJTHmlLbol4/ph4/kvY7kuo4lMueahOS9nOWTgScsCiAgICBzb3J0X2ZpbHRlcmluZ0hpZGVGYXZvcml0ZTogJ+W3suaUtuiXj+WSjCcsCiAgICBzb3J0X2Z1bGxTaXplVGh1bWI6ICflhajlsLrlr7jnvKnnlaXlm77vvIjmkJzntKLpobXjgIHnlKjmiLfpobXvvIknLAogICAgc29ydF9zb3J0QnlCb29rbWFyazogJ+aMieKdpO+4j+aOkuW6jycsCiAgICBzb3J0X3NvcnRCeUxpa2U6ICfmjInwn5GN5o6S5bqPJywKICAgIHNvcnRfc29ydEJ5VmlldzogJ+aMifCfkYDmjpLluo8nLAogICAgLy8g5bCP6K+05o6S5bqPCiAgICBuc29ydF9nZXRXb3JrczogJ+ato+WcqOiOt+WPluesrDElLzIl6aG15L2c5ZOBJywKICAgIG5zb3J0X3NvcnRpbmc6ICfmraPlnKjmjInmlLbol4/ph4/mjpLluo8nLAogICAgbnNvcnRfaGlkZUZhdjogJ+aOkuW6j+aXtumakOiXj+W3suaUtuiXj+eahOS9nOWTgScsCiAgICBuc29ydF9oaWRlRm9sbG93ZWQ6ICfmjpLluo/ml7bpmpDol4/lt7LlhbPms6jkvZzogIXkvZzlk4EnLAogICAgdGV4dF9zb3J0OiAn5o6S5bqPJwp9OwovLyB0cmFuc2xhdGUgYnkgZ29vZ2xlClRleHRzW0xhbmcuZW5fVVNdID0gewogICAgaW5zdGFsbF90aXRsZTogJ1dlbGNvbWUgdG8gUGl4aXZQcmV2aWV3ZXInLAogICAgaW5zdGFsbF9ib2R5OiAnPGRpdiBzdHlsZT0icG9zaXRpb246IGFic29sdXRlO2xlZnQ6IDUwJTt0b3A6IDMwJTtmb250LXNpemU6IDIwcHg7IGNvbG9yOiB3aGl0ZTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsMCk7Ij48cCBzdHlsZT0idGV4dC1pbmRlbnQ6IDJlbTsiPkZlZWRiYWNrIHF1ZXN0aW9ucyBhbmQgc3VnZ2VzdGlvbnMgYXJlIHdlbGNvbWUhIOKYnjxhIHN0eWxlPSJjb2xvcjogZ3JlZW47IiBocmVmPSJodHRwczovL2dyZWFzeWZvcmsub3JnL3poLUNOL3NjcmlwdHMvMzA3NjYtcGl4aXYtcHJldmlld2VyL2ZlZWRiYWNrIiB0YXJnZXQ9Il9ibGFuayI+RmVlZGJhY2sgUGFnZTwvYT48L3A+PGJyPjxwIHN0eWxlPSJ0ZXh0LWluZGVudDogMmVtOyI+SWYgeW91IGFyZSB1c2luZyBpdCBmb3IgdGhlIGZpcnN0IHRpbWUsIGl0IGlzIHJlY29tbWVuZGVkIHRvIGdvIHRvIHRoZSDimJ48YSBzdHlsZT0iY29sb3I6IGdyZWVuOyIgaHJlZj0iaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzMwNzY2LXBpeGl2LXByZXZpZXdlciIgdGFyZ2V0PSJfYmxhbmsiPkRldGFpbHMgUGFnZTwvYT4gdG8gc2VlIHRoZSBzY3JpcHQgaW50cm9kdWN0aW9uLjwvcD48L2Rpdj4nLAogICAgdXBncmFkZV9ib2R5OiAnPGgzPk5ldyBzZXR0aW5ncyBtZW51ITwvaDM+Jm5ic3AmbmJzcDxwIHN0eWxlPSJ0ZXh0LWluZGVudDogMmVtOyI+VGhhbmtzIHRvIGFsbCBQaXhpdiBQcmV2aWV3ZXIgdXNlcnMsIHRoaXMgdXBkYXRlIGFkanVzdHMgdGhlIHZpc3VhbCBlZmZlY3Qgb2YgdGhlIHNldHRpbmdzIG1lbnUsIGFuZCBmZWVkYmFjayBxdWVzdGlvbnMgYW5kIHN1Z2dlc3Rpb25zIGFyZSB3ZWxjb21lISDimJ48YSBzdHlsZT0iY29sb3I6IGdyZWVuOyIgaHJlZj0iaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzMwNzY2LXBpeGl2LXByZXZpZXdlci9mZWVkYmFjayIgdGFyZ2V0PSJfYmxhbmsiPkZlZWRiYWNrIFBhZ2U8L2E+PC9wPicsCiAgICBzZXR0aW5nX3NldHRpbmdTZWN0aW9uOiAnU2V0dGluZ3MnLAogICAgc2V0dGluZ19sYW5ndWFnZTogJ0xhbmd1YWdlJywKICAgIHNldHRpbmdfcHJldmlldzogJ1ByZXZpZXcnLAogICAgc2V0dGluZ19hbmltZVByZXZpZXc6ICdBbmltYXRpb24gcHJldmlldycsCiAgICBzZXR0aW5nX3NvcnRTZWN0aW9uOiAnU29ydGluZycsCiAgICBzZXR0aW5nX3NvcnQ6ICdTb3J0aW5nIChTZWFyY2ggcGFnZSknLAogICAgc2V0dGluZ19hbmltZTogJ0FuaW1hdGlvbiBkb3dubG9hZCAoUHJldmlldyBhbmQgQXJ0d29yayBwYWdlKScsCiAgICBzZXR0aW5nX29yaWdpbjogJ0Rpc3BsYXkgb3JpZ2luYWwgaW1hZ2Ugd2hlbiBwcmV2aWV3IChzbG93KScsCiAgICBzZXR0aW5nX3ByZXZpZXdEZWxheTogJ0RlbGF5IG9mIGRpc3BsYXkgcHJldmlldyBpbWFnZShNaWxsaW9uIHNlY29uZHMpJywKICAgIHNldHRpbmdfcHJldmlld0J5S2V5OiAnVXNlIGtleXMgdG8gY29udHJvbCB0aGUgcHJldmlldyBpbWFnZSBkaXNwbGF5IChDdHJsKScsCiAgICBzZXR0aW5nX3ByZXZpZXdCeUtleUhlbHA6ICdBZnRlciBlbmFibGluZyBpdCwgbW92ZSB0aGUgbW91c2UgdG8gdGhlIHBpY3R1cmUgYW5kIG5vIGxvbmdlciBkaXNwbGF5IHRoZSBwcmV2aWV3IGltYWdlLiBQcmVzcyB0aGUgQ3RybCBrZXkgdG8gZGlzcGxheSBpdCwgYW5kIHRoZSAiRGVsYXllZCBEaXNwbGF5IFByZXZpZXciIHNldHRpbmcgaXRlbSBkb2VzIG5vdCB0YWtlIGVmZmVjdC4nLAogICAgc2V0dGluZ19tYXhQYWdlOiAnTWF4aW11bSBudW1iZXIgb2YgcGFnZXMgY291bnRlZCBwZXIgc29ydCcsCiAgICBzZXR0aW5nX2hpZGVXb3JrOiAnSGlkZSB3b3JrcyB3aXRoIGJvb2ttYXJrIGNvdW50IGxlc3MgdGhhbiBzZXQgdmFsdWUnLAogICAgc2V0dGluZ19oaWRlQWlXb3JrOiAnSGlkZSBBSSB3b3JrcycsCiAgICBzZXR0aW5nX29ubHlBaVdvcms6ICdTaG93IG9ubHkgQUktZ2VuZXJhdGVkIHdvcmtzJywKICAgIHNldHRpbmdfaGlkZUZhdjogJ0hpZGUgZmF2b3JpdGVzIHdoZW4gc29ydGluZycsCiAgICBzZXR0aW5nX2hpZGVGb2xsb3dlZDogJ0hpZGUgYXJ0d29ya3Mgb2YgZm9sbG93ZWQgYXJ0aXN0cyB3aGVuIHNvcnRpbmcnLAogICAgc2V0dGluZ19oaWRlQnlUYWc6ICdIaWRlIGFydHdvcmtzIGJ5IHRhZycsCiAgICBzZXR0aW5nX2hpZGVCeVRhZ1BsYWNlaG9sZGVyOiAnSW5wdXQgdGFnIG5hbWUsIGUuZy4gInRhZzF8dGFnMiIsIHJlZ3VsYXIgZXhwcmVzc2lvbnMgc3VwcG9ydGVkJywKICAgIHNldHRpbmdfaGlkZUJ5VXNlcjogJ0hpZGUgYXJ0d29ya3MgYnkgdXNlcicsCiAgICBzZXR0aW5nX2hpZGVCeVVzZXJQbGFjZWhvbGRlcjogJ0lucHV0IHVzZXIgSUQsIGUuZy4gIjEyMzQ1fDY3ODkwIicsCiAgICBzZXR0aW5nX2NsZWFyRm9sbG93aW5nQ2FjaGU6ICdDbGVhciBDYWNoZScsCiAgICBzZXR0aW5nX2NsZWFyRm9sbG93aW5nQ2FjaGVIZWxwOiAnVGhlIGZvbGxvaW5nIGFydGlzdHMgaW5mby4gd2lsbCBiZSBzYXZlZCBsb2NhbGx5IGZvciBvbmUgZGF5LCBpZiB5b3Ugd2FudCB0byB1cGRhdGUgaW1tZWRpYXRlbHksIHBsZWFzZSBjbGljayB0aGlzIHRvIGNsZWFyIGNhY2hlJywKICAgIHNldHRpbmdfZm9sbG93aW5nQ2FjaGVDbGVhcmVkOiAnU3VjY2VzcywgcGxlYXNlIHJlZnJlc2ggdGhlIHBhZ2UuJywKICAgIHNldHRpbmdfYmxhbms6ICdPcGVuIHdvcmtzXCcgZGV0YWlscyBwYWdlIGluIG5ldyB0YWInLAogICAgc2V0dGluZ190dXJuUGFnZTogJ1VzZSDihpAg4oaSIHRvIHR1cm4gcGFnZXMgKFNlYXJjaCBwYWdlKScsCiAgICBzZXR0aW5nX3NhdmU6ICdTYXZlJywKICAgIHNldHRpbmdfcmVzZXQ6ICdSZXNldCcsCiAgICBzZXR0aW5nX3Jlc2V0SGludDogJ1RoaXMgd2lsbCBkZWxldGUgYWxsIHNldHRpbmdzIGFuZCBzZXQgaXQgdG8gZGVmYXVsdC4gQXJlIHlvdSBzdXJlPycsCiAgICBzZXR0aW5nX25vdmVsU29ydDogJ1NvcnRpbmcgKE5vdmVsKScsCiAgICBzZXR0aW5nX25vdmVsTWF4UGFnZTogJ01heGltdW0gbnVtYmVyIG9mIHBhZ2VzIGNvdW50ZWQgZm9yIG5vdmVsIHNvcnRpbmcnLAogICAgc2V0dGluZ19ub3ZlbEhpZGVXb3JrOiAnSGlkZSB3b3JrcyB3aXRoIGJvb2ttYXJrIGNvdW50IGxlc3MgdGhhbiBzZXQgdmFsdWUnLAogICAgc2V0dGluZ19ub3ZlbEhpZGVGYXY6ICdIaWRlIGZhdm9yaXRlcyB3aGVuIHNvcnRpbmcnLAogICAgc2V0dGluZ19wcmV2aWV3RnVsbFNjcmVlbjogJ0Z1bGwgc2NyZWVuIHByZXZpZXcnLAogICAgc2V0dGluZ19zY3JvbGxMb2NrV2hlblByZXZpZXc6ICdQcmV2ZW50IHBhZ2Ugc2Nyb2xsaW5nIGR1cmluZyBwcmV2aWV3JywKICAgIHNldHRpbmdfbG9nTGV2ZWw6ICdMb2cgTGV2ZWwnLAogICAgc2V0dGluZ19ub3ZlbFNlY3Rpb246ICdOb3ZlbCBTb3J0aW5nJywKICAgIHNldHRpbmdfY2xvc2U6ICdDbG9zZScsCiAgICBzZXR0aW5nX21heFhocjogJ0Jvb2ttYXJrIGNvdW50IGNvbmN1cnJlbmN5IChyZWNvbW1lbmRlZCA2NCknLAogICAgc2V0dGluZ19oaWRlQnlDb3VudExlc3NUaGFuOiAnSGlkZSB3b3JrcyB3aXRoIGltYWdlIGNvdW50IGxlc3MgdGhhbiBzZXQgdmFsdWUnLAogICAgc2V0dGluZ19oaWRlQnlDb3VudE1vcmVUaGFuOiAnSGlkZSB3b3JrcyB3aXRoIGltYWdlIGNvdW50IG1vcmUgdGhhbiBzZXQgdmFsdWUnLAogICAgc29ydF9ub1dvcms6ICdObyB3b3JrcyB0byBkaXNwbGF5ICglMSB3b3JrcyBoaWRlZW4pJywKICAgIHNvcnRfZ2V0V29ya3M6ICdHZXR0aW5nIGFydHdvcmtzIG9mIHBhZ2U6ICUxIG9mICUyJywKICAgIHNvcnRfZ2V0Qm9va21hcmtDb3VudDogJ0dldHRpbmcgYm9va21hcmsgY291bnQgb2YgYXJ0d29ya3PvvJolMSBvZiAlMicsCiAgICBzb3J0X2dldFB1YmxpY0ZvbGxvd2luZzogJ0dldHRpbmcgcHVibGljIGZvbGxvd2luZyBsaXN0JywKICAgIHNvcnRfZ2V0UHJpdmF0ZUZvbGxvd2luZzogJ0dldHRpbmcgcHJpdmF0ZSBmb2xsb3dpbmcgbGlzdCcsCiAgICBzb3J0X2ZpbHRlcmluZzogJ0ZpbHRlcmluZyUxd29ya3Mgd2l0aCBib29rbWFyayBjb3VudCBsZXNzIHRoYW4gJTInLAogICAgc29ydF9maWx0ZXJpbmdIaWRlRmF2b3JpdGU6ICcgZmF2b3JpdGVkIHdvcmtzIGFuZCAnLAogICAgc29ydF9mdWxsU2l6ZVRodW1iOiAnRGlzcGxheSBub3QgY3JvcHBlZCBpbWFnZXMuKFNlYXJjaCBwYWdlIGFuZCBVc2VyIHBhZ2Ugb25seS4pJywKICAgIHNvcnRfc29ydEJ5Qm9va21hcms6ICdTb3J0IGJ5IOKdpO+4jycsCiAgICBzb3J0X3NvcnRCeUxpa2U6ICdTb3J0IGJ5IPCfkY0nLAogICAgc29ydF9zb3J0QnlWaWV3OiAnU29ydCBieSDwn5GAJywKICAgIG5zb3J0X2dldFdvcmtzOiAnR2V0dGluZyBub3ZlbHMgb2YgcGFnZTogMSUgb2YgMiUnLAogICAgbnNvcnRfc29ydGluZzogJ1NvcnRpbmcgYnkgYm9va21hcmsgY291bmQnLAogICAgbnNvcnRfaGlkZUZhdjogJ0hpZGUgZmF2b3JpdGVzIHdoZW4gc29ydGluZycsCiAgICBuc29ydF9oaWRlRm9sbG93ZWQ6ICdIaWRlIGFydHdvcmtzIG9mIGZvbGxvd2VkIGF1dGhvcnMgd2hlbiBzb3J0aW5nJywKICAgIHRleHRfc29ydDogJ3NvcnQnLAp9OwovLyBSVTog0L/QtdGA0LXQstC+0LQg0L7RgiAgdmFuamEtc2FuClRleHRzW0xhbmcucnVfUlVdID0gewogICAgaW5zdGFsbF90aXRsZTogJ9CU0L7QsdGA0L4g0L/QvtC20LDQu9C+0LLQsNGC0Ywg0LIgUGl4aXZQcmV2aWV3ZXInLAogICAgaW5zdGFsbF9ib2R5OiAnPGRpdiBzdHlsZT0icG9zaXRpb246IGFic29sdXRlO2xlZnQ6IDUwJTt0b3A6IDMwJTtmb250LXNpemU6IDIwcHg7IGNvbG9yOiB3aGl0ZTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsMCk7Ij48cCBzdHlsZT0idGV4dC1pbmRlbnQ6IDJlbTsiPtCS0L7Qv9GA0L7RgdGLINC4INC/0YDQtdC00LvQvtC20LXQvdC40Y8g0L/RgNC40LLQtdGC0YHRgtCy0YPRjtGC0YHRjyEg4piePGEgc3R5bGU9ImNvbG9yOiBncmVlbjsiIGhyZWY9Imh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvemgtQ04vc2NyaXB0cy8zMDc2Ni1waXhpdi1wcmV2aWV3ZXIvZmVlZGJhY2siIHRhcmdldD0iX2JsYW5rIj7QodGC0YDQsNC90LjRhtCwINC+0LHRgNCw0YLQvdC+0Lkg0YHQstGP0LfQuDwvYT48L3A+PGJyPjxwIHN0eWxlPSJ0ZXh0LWluZGVudDogMmVtOyI+0JXRgdC70Lgg0LLRiyDQuNGB0L/QvtC70YzQt9GD0LXRgtC1INGN0YLQviDQstC/0LXRgNCy0YvQtSwg0YDQtdC60L7QvNC10L3QtNGD0LXRgtGB0Y8g0L/QtdGA0LXQudGC0Lgg0Log4piePGEgc3R5bGU9ImNvbG9yOiBncmVlbjsiIGhyZWY9Imh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvemgtQ04vc2NyaXB0cy8zMDc2Ni1waXhpdi1wcmV2aWV3ZXIiIHRhcmdldD0iX2JsYW5rIj7QodGC0YDQsNC90LjRhtC1INC/0L7QtNGA0L7QsdC90L7RgdGC0LXQuTwvYT4sINGH0YLQvtCx0Ysg0L/QvtGB0LzQvtGC0YDQtdGC0Ywg0LLQstC10LTQtdC90LjQtSDQsiDRgdC60YDQuNC/0YIuPC9wPjwvZGl2PicsCiAgICB1cGdyYWRlX2JvZHk6ICc8aDM+0J3QvtCy0L7QtSDQvNC10L3RjiDQvdCw0YHRgtGA0L7QtdC6ITwvaDM+Jm5ic3AmbmJzcDxwIHN0eWxlPSJ0ZXh0LWluZGVudDogMmVtOyI+0KHQv9Cw0YHQuNCx0L4g0LLRgdC10Lwg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GP0LwgUGl4aXYgUHJldmlld2VyLCDRjdGC0L4g0L7QsdC90L7QstC70LXQvdC40LUg0LjQt9C80LXQvdC40LvQviDQstC40LfRg9Cw0LvRjNC90YvQuSDRjdGE0YTQtdC60YIg0LzQtdC90Y4g0L3QsNGB0YLRgNC+0LXQuiwg0LLQvtC/0YDQvtGB0Ysg0Lgg0L/RgNC10LTQu9C+0LbQtdC90LjRjyDQv9GA0LjQstC10YLRgdGC0LLRg9GO0YLRgdGPISDimJ48YSBzdHlsZT0iY29sb3I6IGdyZWVuOyIgaHJlZj0iaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy96aC1DTi9zY3JpcHRzLzMwNzY2LXBpeGl2LXByZXZpZXdlci9mZWVkYmFjayIgdGFyZ2V0PSJfYmxhbmsiPtCh0YLRgNCw0L3QuNGG0LAg0L7QsdGA0LDRgtC90L7QuSDRgdCy0Y/Qt9C4PC9hPjwvcD4nLAogICAgc2V0dGluZ19zZXR0aW5nU2VjdGlvbjogJ9Cd0LDRgdGC0YDQvtC50LrQuCcsCiAgICBzZXR0aW5nX2xhbmd1YWdlOiAn0K/Qt9GL0LonLAogICAgc2V0dGluZ19wcmV2aWV3OiAn0J/RgNC10LTQv9GA0L7RgdC80L7RgtGAJywKICAgIHNldHRpbmdfYW5pbWVQcmV2aWV3OiAn0JDQvdC40LzQsNGG0LjRjyDQv9GA0LXQtNC/0YDQvtGB0LzQvtGC0YDQsCcsCiAgICBzZXR0aW5nX3NvcnRTZWN0aW9uOiAn0KHQvtGA0YLQuNGA0L7QstC60LAnLAogICAgc2V0dGluZ19zb3J0OiAn0KHQvtGA0YLQuNGA0L7QstC60LAgKNCh0YLRgNCw0L3QuNGG0LAg0L/QvtC40YHQutCwKScsCiAgICBzZXR0aW5nX2FuaW1lOiAn0JDQvdC40LzQsNGG0LjRjyDRgdC60LDRh9C40LLQsNC90LjRjyAo0KHRgtGA0LDQvdC40YbRiyDQv9GA0LXQtNC/0YDQvtGB0LzQvtGC0YDQsCDQuCBBcnR3b3JrKScsCiAgICBzZXR0aW5nX29yaWdpbjogJ9Cf0YDQuCDQv9GA0LXQtNC/0YDQvtGB0LzQvtGC0YDQtSwg0L/QvtC60LDQt9GL0LLQsNGC0Ywg0LjQt9C+0LHRgNCw0LbQtdC90LjRjyDRgSDQvtGA0LjQs9C40L3QsNC70YzQvdGL0Lwg0LrQsNGH0LXRgdGC0LLQvtC8ICjQvNC10LTQu9C10L3QvdC+KScsCiAgICBzZXR0aW5nX3ByZXZpZXdEZWxheTogJ9CX0LDQtNC10YDQttC60LAg0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDQv9GA0LXQtNC/0YDQvtGB0LzQvtGC0YDQsCDQuNC30L7QsdGA0LDQttC10L3QuNGPICjQnNC40LvQu9C40L7QvSDRgdC10LrRg9C90LQpJywKICAgIHNldHRpbmdfcHJldmlld0J5S2V5OiAn0JjRgdC/0L7Qu9GM0LfQvtCy0LDRgtGMINC60LvQsNCy0LjRiNC4INC00LvRjyDRg9C/0YDQsNCy0LvQtdC90LjRjyDQvtGC0L7QsdGA0LDQttC10L3QuNC10Lwg0L/RgNC10LTQv9GA0L7RgdC80L7RgtGA0LAg0LjQt9C+0LHRgNCw0LbQtdC90LjRjyAoQ3RybCknLAogICAgc2V0dGluZ19wcmV2aWV3QnlLZXlIZWxwOiAn0J/QvtGB0LvQtSDQstC60LvRjtGH0LXQvdC40Y8sINC/0LXRgNC10LzQtdGJ0LXQvdC40LUg0LzRi9GI0Lgg0Log0LjQt9C+0LHRgNCw0LbQtdC90LjRjiDQsdC+0LvRjNGI0LUg0L3QtSDQvtGC0L7QsdGA0LDQttCw0LXRgiDQv9GA0LXQtNC/0YDQvtGB0LzQvtGC0YAg0LjQt9C+0LHRgNCw0LbQtdC90LjRjy4g0J3QsNC20LzQuNGC0LUg0LrQu9Cw0LLQuNGI0YMgQ3RybCwg0YfRgtC+0LHRiyDQvtGC0L7QsdGA0LDQt9C40YLRjCDQtdCz0L4sINC4INC/0LDRgNCw0LzQtdGC0YAgItCX0LDQtNC10YDQttC60LAg0L7RgtC+0LHRgNCw0LbQtdC90LjRjyDQv9GA0LXQtNC/0YDQvtGB0LzQvtGC0YDQsCIg0L3QtSDQsdGD0LTQtdGCINC00LXQudGB0YLQstC+0LLQsNGC0YwuJywKICAgIHNldHRpbmdfbWF4UGFnZTogJ9Cc0LDQutGB0LjQvNCw0LvRjNC90L7QtSDQutC+0LvQuNGH0LXRgdGC0LLQviDRgdGC0YDQsNC90LjRhiwg0L/QvtC00YHRh9C40YLQsNC90L3Ri9GFINC30LAg0YHQvtGA0YLQuNGA0L7QstC60YMnLAogICAgc2V0dGluZ19oaWRlV29yazogJ9Ch0LrRgNGL0YLRjCDRgNCw0LHQvtGC0Ysg0YEg0LrQvtC70LjRh9C10YHRgtCy0L7QvCDQt9Cw0LrQu9Cw0LTQvtC6INC80LXQvdGM0YjQtSDRg9GB0YLQsNC90L7QstC70LXQvdC90L7Qs9C+INC30L3QsNGH0LXQvdC40Y8nLAogICAgc2V0dGluZ19oaWRlQWlXb3JrOiAn0KHQutGA0YvRgtGMINGA0LDQsdC+0YLRiywg0YHQvtC30LTQsNC90L3Ri9C1INCY0JgnLAogICAgc2V0dGluZ19vbmx5QWlXb3JrOiAn0J/QvtC60LDQt9GL0LLQsNGC0Ywg0YLQvtC70YzQutC+INGA0LDQsdC+0YLRiywg0YHQvtC30LTQsNC90L3Ri9C1INCY0JgnLAogICAgc2V0dGluZ19oaWRlRmF2OiAn0J/RgNC4INGB0L7RgNGC0LjRgNC+0LLQutC1LCDRgdC60YDRi9GC0Ywg0LjQt9Cx0YDQsNC90L3QvtC1JywKICAgIHNldHRpbmdfaGlkZUZvbGxvd2VkOiAn0J/RgNC4INGB0L7RgNGC0LjRgNC+0LLQutC1LCDRgdC60YDRi9GC0Ywg0YDQsNCx0L7RgtGLINGF0YPQtNC+0LbQvdC40LrQvtCyINC90LAg0LrQvtGC0L7RgNGL0YUg0L/QvtC00L/QuNGB0LDQvdGLJywKICAgIHNldHRpbmdfaGlkZUJ5VGFnOiAn0J/RgNC4INGB0L7RgNGC0LjRgNC+0LLQutC1LCDRgdC60YDRi9GC0Ywg0YDQsNCx0L7RgtGLINGBINGD0LrQsNC30LDQvdC90YvQvCDRgtC10LPQvtC8JywKICAgIHNldHRpbmdfaGlkZUJ5VGFnUGxhY2Vob2xkZXI6ICfQktCy0LXQtNC40YLQtSDQuNC80Y8g0YLQtdCz0LAsINC90LDQv9GA0LjQvNC10YAgInRhZzF8dGFnMiIsINC/0L7QtNC00LXRgNC20LjQstCw0LXRgtGB0Y8g0YDQtdCz0YPQu9GP0YDQvdC+0LUg0LLRi9GA0LDQttC10L3QuNC1JywKICAgIHNldHRpbmdfaGlkZUJ5VXNlcjogJ9Cf0YDQuCDRgdC+0YDRgtC40YDQvtCy0LrQtSwg0YHQutGA0YvRgtGMINGA0LDQsdC+0YLRiyDQvtGCINGD0LrQsNC30LDQvdC90L7Qs9C+INC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjycsCiAgICBzZXR0aW5nX2hpZGVCeVVzZXJQbGFjZWhvbGRlcjogJ9CS0LLQtdC00LjRgtC1IElEINC/0L7Qu9GM0LfQvtCy0LDRgtC10LvRjywg0L3QsNC/0YDQuNC80LXRgCAiMTIzNDV8Njc4OTAiJywKICAgIHNldHRpbmdfY2xlYXJGb2xsb3dpbmdDYWNoZTogJ9Ce0YfQuNGB0YLQuNGC0Ywg0LrRjdGIJywKICAgIHNldHRpbmdfY2xlYXJGb2xsb3dpbmdDYWNoZUhlbHA6ICfQodC70LXQtNGD0Y7RidCw0Y8g0LjQvdGE0L7RgNC80LDRhtC40Y8g0L4g0YXRg9C00L7QttC90LjQutCw0YUg0LHRg9C00LXRgiDRgdC+0YXRgNCw0L3QtdC90LAg0LvQvtC60LDQu9GM0L3QviDQsiDRgtC10YfQtdC90LjQtSDQvtC00L3QvtCz0L4g0LTQvdGPLCDQtdGB0LvQuCDQstGLINGF0L7RgtC40YLQtSDQvtCx0L3QvtCy0LjRgtGMINC10ZEg0L3QtdC80LXQtNC70LXQvdC90L4sINC90LDQttC80LjRgtC1INC90LAg0Y3RgtGDINC60L3QvtC/0LrRgywg0YfRgtC+0LHRiyDQvtGH0LjRgdGC0LjRgtGMINC60Y3RiCcsCiAgICBzZXR0aW5nX2ZvbGxvd2luZ0NhY2hlQ2xlYXJlZDogJ9CT0L7RgtC+0LLQviwg0L7QsdC90L7QstC40YLQtSDRgdGC0YDQsNC90LjRhtGDLicsCiAgICBzZXR0aW5nX2JsYW5rOiAn0J7RgtC60YDRi9Cy0LDRgtGMINGB0YLRgNCw0L3QuNGG0YMg0YEg0L7Qv9C40YHQsNC90LjQtdC8INGA0LDQsdC+0YLRiyDQvdCwINC90L7QstC+0Lkg0LLQutC70LDQtNC60LUnLAogICAgc2V0dGluZ190dXJuUGFnZTogJ9CY0YHQv9C+0LvRjNC30L7QstCw0YLRjCDihpAg4oaSINC00LvRjyDQv9C10YDQtdC70LjRgdGC0YvQstCw0L3QuNGPINGB0YLRgNCw0L3QuNGGICjQodGC0YDQsNC90LjRhtCwINC/0L7QuNGB0LrQsCknLAogICAgc2V0dGluZ19zYXZlOiAn0KHQvtGF0YDQsNC90LjRgtGMJywKICAgIHNldHRpbmdfcmVzZXQ6ICfQodCx0YDQvtGB0LjRgtGMJywKICAgIHNldHRpbmdfcmVzZXRIaW50OiAn0K3RgtC+INGD0LTQsNC70LjRgiDQstGB0LUg0L3QsNGB0YLRgNC+0LnQutC4INC4INGD0YHRgtCw0L3QvtCy0LjRgiDQuNGFINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOLiDQn9GA0L7QtNC+0LvQttC40YLRjD8nLAogICAgc2V0dGluZ19ub3ZlbFNvcnQ6ICfQodC+0YDRgtC40YDQvtCy0LrQsCAo0KDQvtC80LDQvSknLAogICAgc2V0dGluZ19ub3ZlbE1heFBhZ2U6ICfQnNCw0LrRgdC40LzQsNC70YzQvdC+0LUg0LrQvtC70LjRh9C10YHRgtCy0L4g0YHRgtGA0LDQvdC40YYsINC/0L7QtNGB0YfQuNGC0LDQvdC90YvRhSDQt9CwINGB0L7RgNGC0LjRgNC+0LLQutGDINGA0L7QvNCw0L3QsCcsCiAgICBzZXR0aW5nX25vdmVsSGlkZVdvcms6ICfQodC60YDRi9GC0Ywg0YDQsNCx0L7RgtGLINGBINC60L7Qu9C40YfQtdGB0YLQstC+0Lwg0LfQsNC60LvQsNC00L7QuiDQvNC10L3RjNGI0LUg0YPRgdGC0LDQvdC+0LLQu9C10L3QvdC+0LPQviDQt9C90LDRh9C10L3QuNGPJywKICAgIHNldHRpbmdfbm92ZWxIaWRlRmF2OiAn0J/RgNC4INGB0L7RgNGC0LjRgNC+0LLQutC1LCDRgdC60YDRi9GC0Ywg0LjQt9Cx0YDQsNC90L3QvtC1JywKICAgIHNldHRpbmdfcHJldmlld0Z1bGxTY3JlZW46ICfQn9GA0LXQtNC/0YDQvtGB0LzQvtGC0YAg0LIg0L/QvtC70L3QvtGN0LrRgNCw0L3QvdC+0Lwg0YDQtdC20LjQvNC1JywKICAgIHNldHRpbmdfc2Nyb2xsTG9ja1doZW5QcmV2aWV3OiAn0JHQu9C+0LrQuNGA0L7QstCw0YLRjCDQv9GA0L7QutGA0YPRgtC60YMg0YHRgtGA0LDQvdC40YbRiyDQv9GA0Lgg0L/RgNC10LTQv9GA0L7RgdC80L7RgtGA0LUnLAogICAgc2V0dGluZ19ub3ZlbFNlY3Rpb246ICfQodC+0YDRgtC40YDQvtCy0LrQsCAo0KDQvtC80LDQvSknLAogICAgc2V0dGluZ19jbG9zZTogJ9CX0LDQutGA0YvRgtGMJywKICAgIHNldHRpbmdfbWF4WGhyOiAn0JrQvtC70LjRh9C10YHRgtCy0L4g0LfQsNC60LvQsNC00L7QuiAo0YDQtdC60L7QvNC10L3QtNGD0LXRgtGB0Y8gNjQpJywKICAgIHNldHRpbmdfaGlkZUJ5Q291bnRMZXNzVGhhbjogJ9Ch0LrRgNGL0YLRjCDRgNCw0LHQvtGC0Ysg0YEg0LrQvtC70LjRh9C10YHRgtCy0L7QvCDQuNC30L7QsdGA0LDQttC10L3QuNC5INC80LXQvdGM0YjQtSDRg9GB0YLQsNC90L7QstC70LXQvdC90L7Qs9C+INC30L3QsNGH0LXQvdC40Y8nLAogICAgc2V0dGluZ19oaWRlQnlDb3VudE1vcmVUaGFuOiAn0KHQutGA0YvRgtGMINGA0LDQsdC+0YLRiyDRgSDQutC+0LvQuNGH0LXRgdGC0LLQvtC8INC40LfQvtCx0YDQsNC20LXQvdC40Lkg0LHQvtC70YzRiNC1INGD0YHRgtCw0L3QvtCy0LvQtdC90L3QvtCz0L4g0LfQvdCw0YfQtdC90LjRjycsCiAgICBzb3J0X25vV29yazogJ9Cd0LXRgiDRgNCw0LHQvtGCINC00LvRjyDQvtGC0L7QsdGA0LDQttC10L3QuNGPICglMSB3b3JrcyBoaWRkZW4pJywKICAgIHNvcnRfZ2V0V29ya3M6ICfQn9C+0LvRg9GH0LXQvdC40LUg0LjQu9C70Y7RgdGC0YDQsNGG0LjQuSDRgdGC0YDQsNC90LjRhtGLOiAlMSDQuNC3ICUyJywKICAgIHNvcnRfZ2V0Qm9va21hcmtDb3VudDogJ9Cf0L7Qu9GD0YfQtdC90LjQtSDQutC+0LvQuNGH0LXRgdGC0LLQsCDQt9Cw0LrQu9Cw0LTQvtC6IGFydHdvcmtz77yaJTEg0LjQtyAlMicsCiAgICBzb3J0X2dldFB1YmxpY0ZvbGxvd2luZzogJ9Cf0L7Qu9GD0YfQtdC90LjQtSDQv9GD0LHQu9C40YfQvdC+0LPQviDRgdC/0LjRgdC60LAg0L/QvtC00L/QuNGB0L7QuicsCiAgICBzb3J0X2dldFByaXZhdGVGb2xsb3dpbmc6ICfQn9C+0LvRg9GH0LXQvdC40LUg0L/RgNC40LLQsNGC0L3QvtCz0L4g0YHQv9C40YHQutCwINC/0L7QtNC/0LjRgdC+0LonLAogICAgc29ydF9maWx0ZXJpbmc6ICfQpNC40LvRjNGC0YDQsNGG0LjRjyAlMSDRgNCw0LHQvtGCINGBINC60L7Qu9C40YfQtdGB0YLQstC+0Lwg0LfQsNC60LvQsNC00L7QuiDQvNC10L3RjNGI0LUg0YfQtdC8ICUyJywKICAgIHNvcnRfZmlsdGVyaW5nSGlkZUZhdm9yaXRlOiAnINC40LfQsdGA0LDQvdC90YvQtSDRgNCw0LHQvtGC0Ysg0LggJywKICAgIHNvcnRfZnVsbFNpemVUaHVtYjogJ9Cf0L7QutCw0LfQsNGC0Ywg0L3QtdC+0YLRgNC10LTQsNC60YLQuNGA0L7QstCw0L3QvdC+0LUg0LjQt9C+0LHRgNCw0LbQtdC90LjQtSAo0KHRgtGA0LDQvdC40YbRiyDQv9C+0LjRgdC60LAg0LggQXJ0d29yayknLAogICAgc29ydF9zb3J0QnlCb29rbWFyazogJ9Ch0L7RgNGC0LjRgNC+0LLQsNGC0Ywg0L/QviDinaTvuI8nLAogICAgc29ydF9zb3J0QnlMaWtlOiAn0KHQvtGA0YLQuNGA0L7QstCw0YLRjCDQv9C+IPCfkY0nLAogICAgc29ydF9zb3J0QnlWaWV3OiAn0KHQvtGA0YLQuNGA0L7QstCw0YLRjCDQv9C+IPCfkYAnLAogICAgbnNvcnRfZ2V0V29ya3M6ICfQn9C+0LvRg9GH0LXQvdC40LUg0YDQvtC80LDQvdC+0LIg0YHRgtGA0LDQvdC40YbRizogMSUg0LjQtyAyJScsCiAgICBuc29ydF9zb3J0aW5nOiAn0KHQvtGA0YLQuNGA0L7QstC60LAg0L/QviDQutC+0LvQuNGH0LXRgdGC0LLRgyDQt9Cw0LrQu9Cw0LTQvtC6JywKICAgIG5zb3J0X2hpZGVGYXY6ICfQn9GA0Lgg0YHQvtGA0YLQuNGA0L7QstC60LUsINGB0LrRgNGL0YLRjCDQuNC30LHRgNCw0L3QvdC+0LUnLAogICAgbnNvcnRfaGlkZUZvbGxvd2VkOiAn0J/RgNC4INGB0L7RgNGC0LjRgNC+0LLQutC1LCDRgdC60YDRi9GC0Ywg0YDQsNCx0L7RgtGLINGF0YPQtNC+0LbQvdC40LrQvtCyINC90LAg0LrQvtGC0L7RgNGL0YUg0L/QvtC00L/QuNGB0LDQvdGLJywKICAgIHRleHRfc29ydDogJ9Ch0L7RgNGC0LjRgNC+0LLQsNGC0YwnCn07ClRleHRzW0xhbmcuamFfSlBdID0gewogICAgaW5zdGFsbF90aXRsZTogJ1dlbGNvbWUgdG8gUGl4aXZQcmV2aWV3ZXInLAogICAgaW5zdGFsbF9ib2R5OiAnPGRpdiBzdHlsZT0icG9zaXRpb246IGFic29sdXRlO2xlZnQ6IDUwJTt0b3A6IDMwJTtmb250LXNpemU6IDIwcHg7IGNvbG9yOiB3aGl0ZTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsMCk7Ij48cCBzdHlsZT0idGV4dC1pbmRlbnQ6IDJlbTsiPuOBlOaEj+imi+OChOaPkOahiOOBr+Wkp+atk+i/juOBp+OBmSEg4piePGEgc3R5bGU9ImNvbG9yOiBncmVlbjsiIGhyZWY9Imh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvamEvc2NyaXB0cy8zMDc2Ni1waXhpdi1wcmV2aWV3ZXIvZmVlZGJhY2siIHRhcmdldD0iX2JsYW5rIj7jg5XjgqPjg7zjg4njg5Djg4Pjgq/jg5rjg7zjgrg8L2E+PC9wPjxicj48cCBzdHlsZT0idGV4dC1pbmRlbnQ6IDJlbTsiPuWIneOCgeOBpuS9v+OBhuWgtOWQiOOBr+OAgeKYnjxhIHN0eWxlPSJjb2xvcjogZ3JlZW47IiBocmVmPSJodHRwczovL2dyZWFzeWZvcmsub3JnL2phL3NjcmlwdHMvMzA3NjYtcGl4aXYtcHJldmlld2VyIiB0YXJnZXQ9Il9ibGFuayI+6Kmz57Sw44Oa44O844K4PC9hPiDjgafjgrnjgq/jg6rjg5fjg4jjga7ntLnku4vjgpLopovjgovjgZPjgajjgpLjgYrli6fjgoHjgZfjgb7jgZnjgII8L3A+PC9kaXY+JywKICAgIHVwZ3JhZGVfYm9keTogJzxoMz7mlrDjgZfjgYToqK3lrprjg6Hjg4vjg6Xjg7whPC9oMz4mbmJzcCZuYnNwPHAgc3R5bGU9InRleHQtaW5kZW50OiAyZW07Ij5QaXhpdiBQcmV2aWV3ZXLjgpLjgZTliKnnlKjjgYTjgZ/jgaDjgY3jgYLjgorjgYzjgajjgYbjgZTjgZbjgYTjgb7jgZnjgILjgZPjga7jgqLjg4Pjg5fjg4fjg7zjg4jjgafjga/jgIHoqK3lrprjg6Hjg4vjg6Xjg7zjga7jg5Pjgrjjg6XjgqLjg6vjgqjjg5Xjgqfjgq/jg4jjgYzoqr/mlbTjgZXjgozjgb7jgZfjgZ/jgILllY/poYzjgoTmj5DmoYjjgpLjgYrlvoXjgaHjgZfjgabjgYrjgorjgb7jgZkhIOKYnjxhIHN0eWxlPSJjb2xvcjogZ3JlZW47IiBocmVmPSJodHRwczovL2dyZWFzeWZvcmsub3JnL2phL3NjcmlwdHMvMzA3NjYtcGl4aXYtcHJldmlld2VyL2ZlZWRiYWNrIiB0YXJnZXQ9Il9ibGFuayI+44OV44Kj44O844OJ44OQ44OD44Kv44Oa44O844K4PC9hPjwvcD4nLAogICAgc2V0dGluZ19zZXR0aW5nU2VjdGlvbjogJ+ioreWumicsCiAgICBzZXR0aW5nX2xhbmd1YWdlOiAn6KiA6KqeJywKICAgIHNldHRpbmdfcHJldmlldzogJ+ODl+ODrOODk+ODpeODvOapn+iDvScsCiAgICBzZXR0aW5nX2FuaW1lUHJldmlldzogJ+OBhuOBlOOCpOODqeODl+ODrOODk+ODpeODvCcsCiAgICBzZXR0aW5nX3NvcnRTZWN0aW9uOiAn44K944O844OIJywKICAgIHNldHRpbmdfc29ydDogJ+OCveODvOODiCcsCiAgICBzZXR0aW5nX2FuaW1lOiAn44GG44GU44Kk44Op44OA44Km44Oz44Ot44O844OJJywKICAgIHNldHRpbmdfb3JpZ2luOiAn5pyA5aSn44K144Kk44K644Gu55S75YOP44KS6KGo56S644GZ44KLKOmBheOBj+OBquOCi+WPr+iDveaAp+OBjOOBguOCiyknLAogICAgc2V0dGluZ19wcmV2aWV3RGVsYXk6ICfjgqvjg7zjgr3jg6vjgpLph43jga3jgabjgYvjgonjg5fjg6zjg5Pjg6Xjg7zjgZnjgovjgb7jgafjga7pgYXlu7Yo44Of44Oq56eSKScsCiAgICBzZXR0aW5nX3ByZXZpZXdCeUtleTogJ+OCreODvOOBp+ODl+ODrOODk+ODpeODvOeUu+WDj+OBruihqOekuuOCkuWItuW+oeOBmeOCiyAoQ3RybCknLAogICAgc2V0dGluZ19wcmV2aWV3QnlLZXlIZWxwOiAn44GT44KM44KS5pyJ5Yq544Gr44GZ44KL44Go44CB55S75YOP44Gr44Oe44Km44K544KS56e75YuV44GX44Gm44KC44OX44Os44OT44Ol44O855S75YOP44GM6KGo56S644GV44KM44Gq44GP44Gq44KK44G+44GZ44CCQ3RybOOCreODvOOCkuaKvOOBmeOBqOihqOekuuOBleOCjOOAgSBcIumBheW7tuihqOekuuODl+ODrOODk+ODpeODvFwiIOOBruioreWumumgheebruOBr+eEoeWKueOBq+OBquOCiuOBvuOBmeOAgicsCiAgICBzZXR0aW5nX21heFBhZ2U6ICfjgr3jg7zjg4jjgZnjgovjgajjgY3jgavlj5blvpfjgZnjgovmnIDlpKfjg5rjg7zjgrjmlbAnLAogICAgc2V0dGluZ19oaWRlV29yazogJ+S4gOWumuS7peS4i+OBruODluOCr+ODnuODvOOCr+aVsOOBruS9nOWTgeOCkumdnuihqOekuuOBq+OBmeOCiycsCiAgICBzZXR0aW5nX2hpZGVBaVdvcms6ICdBSeOBruS9nOWTgeOCkumdnuihqOekuuOBq+OBmeOCiycsCiAgICBzZXR0aW5nX29ubHlBaVdvcms6ICdBSeeUn+aIkOS9nOWTgeOBruOBv+ihqOekuicsCiAgICBzZXR0aW5nX2hpZGVGYXY6ICfjg5bjg4Pjgq/jg57jg7zjgq/mlbDjgpLjgr3jg7zjg4jmmYLjgavpnZ7ooajnpLrjgavjgZnjgosnLAogICAgc2V0dGluZ19oaWRlRm9sbG93ZWQ6ICfjgr3jg7zjg4jmmYLjgavjg5Xjgqnjg63jg7zjgZfjgabjgYTjgovjgqLjg7zjg4bjgqPjgrnjg4jjga7kvZzlk4HjgpLpnZ7ooajnpLonLAogICAgc2V0dGluZ19oaWRlQnlUYWc6ICfjgr3jg7zjg4jmmYLjgavmjIflrprjgZfjgZ/jgr/jgrDjga7kvZzlk4HjgpLpnZ7ooajnpLonLAogICAgc2V0dGluZ19oaWRlQnlUYWdQbGFjZWhvbGRlcjogJ+OCv+OCsOWQjeOCkuWFpeWKm+OBl+OBpuOBj+OBoOOBleOBhO+8iOS+i++8miJ0YWcxfHRhZzIi44CB5q2j6KaP6KGo54++5a++5b+c77yJJywKICAgIHNldHRpbmdfaGlkZUJ5VXNlcjogJ+OCveODvOODiOaZguOBq+aMh+WumuOBl+OBn+ODpuODvOOCtuODvOOBruS9nOWTgeOCkumdnuihqOekuicsCiAgICBzZXR0aW5nX2hpZGVCeVVzZXJQbGFjZWhvbGRlcjogJ+ODpuODvOOCtuODvElE44KS5YWl5Yqb44GX44Gm44GP44Gg44GV44GE77yI5L6L77yaIjEyMzQ1fDY3ODkwIu+8iScsCiAgICBzZXR0aW5nX2NsZWFyRm9sbG93aW5nQ2FjaGU6ICfjgq3jg6Pjg4Pjgrfjg6XjgpLjgq/jg6rjgqInLAogICAgc2V0dGluZ19jbGVhckZvbGxvd2luZ0NhY2hlSGVscDogJ+ODleOCqeODreODvOOBl+OBpuOBhOOCi+OCouODvOODhuOCo+OCueODiOOBruaDheWgseOBjOODreODvOOCq+ODq+OBqzHml6Xkv53lrZjjgZXjgozjgb7jgZnjgILjgZnjgZDjgavmm7TmlrDjgZfjgZ/jgYTloLTlkIjjga/jgIHjgZPjga7jgq3jg6Pjg4Pjgrfjg6XjgpLjgq/jg6rjgqLjgZfjgabjgY/jgaDjgZXjgYTjgIInLAogICAgc2V0dGluZ19mb2xsb3dpbmdDYWNoZUNsZWFyZWQ6ICfmiJDlip/jgZfjgb7jgZfjgZ/jgILjg5rjg7zjgrjjgpLmm7TmlrDjgZfjgabjgY/jgaDjgZXjgYTjgIInLAogICAgc2V0dGluZ19ibGFuazogJ+S9nOWTgeOBruips+e0sOODmuODvOOCuOOCkuaWsOOBl+OBhOOCv+ODluOBp+mWi+OBjycsCiAgICBzZXR0aW5nX3R1cm5QYWdlOiAn4oaQIOKGkiDjgpLkvb/nlKjjgZfjgabjg5rjg7zjgrjjgpLjgoHjgY/jgovvvIjmpJzntKLjg5rjg7zjgrjvvIknLAogICAgc2V0dGluZ19zYXZlOiAnU2F2ZScsCiAgICBzZXR0aW5nX3Jlc2V0OiAnUmVzZXQnLAogICAgc2V0dGluZ19yZXNldEhpbnQ6ICfjgZPjgozjgavjgojjgorjgIHjgZnjgbnjgabjga7oqK3lrprjgYzliYrpmaTjgZXjgozjgIHjg4fjg5Xjgqnjg6vjg4jjgavoqK3lrprjgZXjgozjgb7jgZnjgILjgojjgo3jgZfjgYTjgafjgZnjgYvvvJ8nLAogICAgc2V0dGluZ19ub3ZlbFNvcnQ6ICfjgr3jg7zjg4jvvIjlsI/oqqzvvIknLAogICAgc2V0dGluZ19ub3ZlbE1heFBhZ2U6ICflsI/oqqzjga7jgr3jg7zjg4jjga7jg5rjg7zjgrjmlbDjga7mnIDlpKflgKQnLAogICAgc2V0dGluZ19ub3ZlbEhpZGVXb3JrOiAn6Kit5a6a5YCk5pyq5rqA44Gu44OW44OD44Kv44Oe44O844Kv5pWw44Gu5L2c5ZOB44KS6Z2e6KGo56S6JywKICAgIHNldHRpbmdfbm92ZWxIaWRlRmF2OiAn44K944O844OI5pmC44Gr44GK5rCX44Gr5YWl44KK44KS6Z2e6KGo56S6JywKICAgIHNldHRpbmdfcHJldmlld0Z1bGxTY3JlZW46ICflhajnlLvpnaLjg5fjg6zjg5Pjg6Xjg7wnLAogICAgc2V0dGluZ19zY3JvbGxMb2NrV2hlblByZXZpZXc6ICfjg5fjg6zjg5Pjg6Xjg7zmmYLjgavjg5rjg7zjgrjjga7jgrnjgq/jg63jg7zjg6vjgpLjg63jg4Pjgq/jgZnjgosnLAogICAgc2V0dGluZ19ub3ZlbFNlY3Rpb246ICfjgr3jg7zjg4jvvIjlsI/oqqzvvIknLAogICAgc2V0dGluZ19jbG9zZTogJ+mWieOBmOOCiycsCiAgICBzZXR0aW5nX21heFhocjogJ+ODluODg+OCr+ODnuODvOOCr+aVsOOBruWQjOaZguODquOCr+OCqOOCueODiOaVsO+8iOaOqOWlqDY077yJJywKICAgIHNldHRpbmdfaGlkZUJ5Q291bnRMZXNzVGhhbjogJ+eUu+WDj+aVsOOBjOioreWumuWApOacqua6gOOBruS9nOWTgeOCkumdnuihqOekuicsCiAgICBzZXR0aW5nX2hpZGVCeUNvdW50TW9yZVRoYW46ICfnlLvlg4/mlbDjgYzoqK3lrprlgKTjgpLotoXjgYjjgovkvZzlk4HjgpLpnZ7ooajnpLonLAogICAgc29ydF9ub1dvcms6ICfooajnpLrjgZnjgovkvZzlk4HjgYzjgYLjgorjgb7jgZvjgpPvvIglMSDkvZzlk4HjgYzpnZ7ooajnpLrvvIknLAogICAgc29ydF9nZXRXb3JrczogJ+ODmuODvOOCuOOBruS9nOWTgeOCkuWPluW+l+S4re+8miUxIC8gJTInLAogICAgc29ydF9nZXRCb29rbWFya0NvdW50OiAn5L2c5ZOB44Gu44OW44OD44Kv44Oe44O844Kv5pWw44KS5Y+W5b6X5Lit77yaJTEgLyAlMicsCiAgICBzb3J0X2dldFB1YmxpY0ZvbGxvd2luZzogJ+WFrOmWi+ODleOCqeODreODvOS4gOimp+OCkuWPluW+l+S4rScsCiAgICBzb3J0X2dldFByaXZhdGVGb2xsb3dpbmc6ICfpnZ7lhazplovjg5Xjgqnjg63jg7zkuIDopqfjgpLlj5blvpfkuK0nLAogICAgc29ydF9maWx0ZXJpbmc6ICfjg5bjg4Pjgq/jg57jg7zjgq/mlbDjgYwlMuacqua6gOOBruS9nOWTgSUx5Lu244KS44OV44Kj44Or44K/44Oq44Oz44KwJywKICAgIHNvcnRfZmlsdGVyaW5nSGlkZUZhdm9yaXRlOiAnIOOBiuawl+OBq+WFpeOCiueZu+mMsua4iOOBv+OBruS9nOWTgeOBiuOCiOOBsyAgJywKICAgIHNvcnRfZnVsbFNpemVUaHVtYjogJ+ODiOODquODn+ODs+OCsOOBleOCjOOBpuOBhOOBquOBhOeUu+WDj+OCkuihqOekuu+8iOaknOe0ouODmuODvOOCuOOBiuOCiOOBs+ODpuODvOOCtuODvOODmuODvOOCuOOBruOBv++8ieOAgicsCiAgICBzb3J0X3NvcnRCeUJvb2ttYXJrOiAn4p2k77iPIOOBp+OCveODvOODiCcsCiAgICBzb3J0X3NvcnRCeUxpa2U6ICfwn5GNIOOBp+OCveODvOODiCcsCiAgICBzb3J0X3NvcnRCeVZpZXc6ICfwn5GAIOOBp+OCveODvOODiCcsCiAgICBuc29ydF9nZXRXb3JrczogJ+Wwj+iqrOOBruODmuODvOOCuOOCkuWPluW+l+S4re+8mjElIC8gMiUnLAogICAgbnNvcnRfc29ydGluZzogJ+ODluODg+OCr+ODnuODvOOCr+aVsOOBp+S4puOBueabv+OBiCcsCiAgICBuc29ydF9oaWRlRmF2OiAn44K944O844OI5pmC44Gr44GK5rCX44Gr5YWl44KK44KS6Z2e6KGo56S6JywKICAgIG5zb3J0X2hpZGVGb2xsb3dlZDogJ+OCveODvOODiOaZguOBq+ODleOCqeODreODvOa4iOOBv+S9nOiAheOBruS9nOWTgeOCkumdnuihqOekuicsCiAgICB0ZXh0X3NvcnQ6ICfjgr3jg7zjg4gnCn07CgovLyDor63oqIAKbGV0IGdfbGFuZ3VhZ2UgPSBMYW5nLmF1dG87Ci8vIOeJiOacrOWPt++8jOesrOS4ieS9jeS4jemcgOimgei3n+iEmuacrOeahOeJiOacrOWPt+WvueS4iu+8jOesrOS4ieS9jeabtOaWsOWPquaciemcgOimgeW8ueabtOaWsOaPkOekuueahOaXtuWAmeaJjemcgOimgeabtOaWsOi/memHjApsZXQgZ192ZXJzaW9uID0gJzMuNy4zNyc7Ci8vIOa3u+WKoOaUtuiXj+mcgOimgei/meS4qgpsZXQgZ19jc3JmVG9rZW4gPSAnJzsKLy8g5omT55qE5pel5b+X5pWw6YeP77yM6LaF6L+H5LiA5a6a5pWw5YC85riF56m65o6n5Yi25Y+wCmxldCBnX2xvZ0NvdW50ID0gMDsKLy8g5b2T5YmN6aG16Z2i57G75Z6LCmxldCBnX3BhZ2VUeXBlID0gLTE7Ci8vIOWbvueJh+ivpuaDhemhteeahOmTvuaOpe+8jOS9v+eUqOaXtuabv+aNoiAjaWQjCmxldCBnX2FydHdvcmtVcmwgPSAnL2FydHdvcmtzLyNpZCMnOwovLyDojrflj5blm77niYfpk77mjqXnmoTpk77mjqUKbGV0IGdfZ2V0QXJ0d29ya1VybCA9ICcvYWpheC9pbGx1c3QvI2lkIy9wYWdlcyc7Ci8vIOiOt+WPluWKqOWbvuS4i+i9vemTvuaOpeeahOmTvuaOpQpsZXQgZ19nZXRVZ29pcmFVcmwgPSAnL2FqYXgvaWxsdXN0LyNpZCMvdWdvaXJhX21ldGEnOwovLyDojrflj5blsI/or7TliJfooajnmoTpk77mjqUKbGV0IGdfZ2V0Tm92ZWxVcmwgPSAnL2FqYXgvc2VhcmNoL25vdmVscy8ja2V5Iz93b3JkPSNrZXkjJnA9I3BhZ2UjJwovLyDpvKDmoIfkvY3nva4KbGV0IGdfbW91c2VQb3MgPSB7IHg6IDAsIHk6IDAgfTsKLy8g5Yqg6L295Lit5Zu+54mHCmxldCBnX2xvYWRpbmdJbWFnZSA9ICdodHRwczovL3BwLTEyNTIwODkxNzIuY29zLmFwLWNoZW5nZHUubXlxY2xvdWQuY29tL2xvYWRpbmcuZ2lmJzsKLy8g6aG16Z2i5omT5byA5pe255qEIHVybApsZXQgaW5pdGlhbFVybCA9IGxvY2F0aW9uLmhyZWY7Ci8vIOiuvue9rgpsZXQgZ19zZXR0aW5nczsKLy8g5o6S5bqP5pe25ZCM5pe26K+35rGC5pS26JeP6YeP55qEIFJlcXVlc3Qg5pWw6YeP77yM5rKh5b+F6KaB5aSq5aSa77yM5bm25LiN5Lya5Yqg5b+r6YCf5bqmCmxldCBnX21heFhociA9IDY0OwovLyDmjpLluo/mmK/lkKblrozmiJDvvIjlpoLmnpzmjpLluo/ml7bpobXpnaLlh7rnjrDkuobpnZ7liLfmlrDliIfmjaLvvIzlvLrliLbliLfmlrDvvIkKbGV0IGdfc29ydENvbXBsZXRlID0gdHJ1ZTsKCi8vIOmhtemdouebuOWFs+eahOS4gOS6m+mihOWumuS5ie+8jOWMheaLrOWkhOeQhumhtemdouWFg+e0oOetiQpsZXQgUGFnZVR5cGUgPSB7CiAgICAvLyDmkJzntKLvvIjkuI3ljIXlkKvlsI/or7TmkJzntKLvvIkKICAgIFNlYXJjaDogMCwKICAgIC8vIOWFs+azqOeahOaWsOS9nOWTgQogICAgQm9va01hcmtOZXc6IDEsCiAgICAvLyDlj5HnjrAKICAgIERpc2NvdmVyeTogMiwKICAgIC8vIOeUqOaIt+S4u+mhtQogICAgTWVtYmVyOiAzLAogICAgLy8g6aaW6aG1CiAgICBIb21lOiA0LAogICAgLy8g5o6S6KGM5qacCiAgICBSYW5raW5nOiA1LAogICAgLy8g5aSn5a6255qE5paw5L2c5ZOBCiAgICBOZXdJbGx1c3Q6IDYsCiAgICAvLyBSMTgKICAgIFIxODogNywKICAgIC8vIOiHquW3seeahOaUtuiXj+mhtQogICAgQm9va01hcms6IDgsCiAgICAvLyDliqjmgIEKICAgIFN0YWNjOiA5LAogICAgLy8g5L2c5ZOB6K+m5oOF6aG177yI5aSE55CG5Yqo5Zu+6aKE6KeI5Y+K5LiL6L2977yJCiAgICBBcnR3b3JrOiAxMCwKICAgIC8vIOWwj+ivtOmhtQogICAgTm92ZWxTZWFyY2g6IDExLAogICAgLy8g5pCc57Si6aG26YOoIHRhYgogICAgU2VhcmNoVG9wOiAxMiwKCiAgICAvLyDmgLvmlbAKICAgIFBhZ2VUeXBlQ291bnQ6IDEzLAp9OwpsZXQgUGFnZXMgPSB7fTsKLyogUGFnZXMg5b+F6aG75a6e546w55qE5Ye95pWwCiAqIFBhZ2VUeXBlU3RyaW5nOiBzdHJpbmfvvIzlrZfnrKbkuLLlvaLlvI/nmoQgUGFnZVR5cGUKICogYm9vbCBDaGVja1VybDogZnVuY3Rpb24oc3RyaW5nIHVybCnvvIznlKjkuo7mo4Dmn6XkuIDkuKogdXJsIOaYr+WQpuaYr+W9k+WJjemhtemdoueahOebruaghyB1cmwKICogUmV0dXJuTWFwIFByb2Nlc3NQYWdlRWxlbWVudHM6IGZ1bmN0aW9uKCnvvIzlpITnkIbpobXpnaLvvIjlr7vmib7lm77niYflhYPntKDjgIHmt7vliqDlsZ7mgKfnrYnvvInvvIzov5Tlm54gUmV0dXJuTWFwCiAqIFJldHVybk1hcCBHZXRQcm9jZXNzZWRQYWdlRWxlbWVudHM6IGZ1bmN0aW9uKCksIOi/lOWbnuS4iuS4gOasoSBQcm9jZXNzUGFnZUVsZW1lbnRzIOeahOi/lOWbnuWAvO+8iOWmguaenOayoeacieS4iuasoeiwg+eUqOWImeiwg+eUqOS4gOasoe+8iQogKiBPYmplY3QgR2V0VG9vbEJhcjogZnVuY3Rpb24oKSwg6L+U5Zue5bel5YW35qCP5YWD57Sg77yI5Y+z5LiL6KeS6YKj5Liq77yM55So5p2l5pS+6K6+572u5oyJ6ZKu77yJCiAqIEhhc0F1dG9Mb2FkOiBib29s77yM6KGo56S66L+Z5Liq6aG16Z2i5piv5ZCm5pyJ6Ieq5Yqo5Yqg6L295Yqf6IO9CiAqLwpsZXQgUmV0dXJuTWFwU2FtcGxlID0gewogICAgLy8g6aG16Z2i5piv5ZCm5Yqg6L295a6M5oiQ77yMZmFsc2Ug5oSP5ZGz552A5ZCO6Z2i55qE5oiQ5ZGY5peg5pWICiAgICBsb2FkaW5nQ29tcGxldGU6IGZhbHNlLAogICAgLy8g5o6n5Yi25YWD57Sg77yM5q+P5Liq5Zu+54mH55qE6byg5qCH5ZON5bqU5YWD57SgCiAgICBjb250cm9sRWxlbWVudHM6IFtdLAogICAgLy8g5Y+v5pyJ5Y+v5peg77yM5aaC5p6c5Li6IHRydWXvvIzlvLrliLbph43mlrDliLfmlrDpooTop4jlip/og70KICAgIGZvcmNlVXBkYXRlOiBmYWxzZSwKfTsKbGV0IENvbnRyb2xFbGVtZW50c0F0dHJpYnV0ZXNTYW1wbGUgPSB7CiAgICAvLyDlm77niYfkv6Hmga/vvIzlhoXlrrnlpoLkuIvvvJoKICAgIC8vIFvlv4XpnIBdIOWbvueJhyBpZAogICAgaWxsdXN0SWQ6IDAsCiAgICAvLyBb5b+F6ZyAXSDlm77niYfnsbvlnovvvIgw77ya5pmu6YCa5Zu+54mH77yMMu+8muWKqOWbvu+8iQogICAgaWxsdXN0VHlwZTogMCwKICAgIC8vIFvlv4XpnIBdIOmhteaVsAogICAgcGFnZUNvdW50OiAxLAogICAgLy8gW+WPr+mAiV0g5qCH6aKYCiAgICB0aXRsZTogJycsCiAgICAvLyBb5Y+v6YCJXSDkvZzogIUgaWQKICAgIHVzZXJJZDogMCwKICAgIC8vIFvlj6/pgIldIOS9nOiAheaYteensAogICAgdXNlck5hbWU6ICcnLAogICAgLy8gW+WPr+mAiV0g5pS26JeP5pWwCiAgICBib29rbWFya0NvdW50OiAwLAp9OwoKZnVuY3Rpb24gZmluZFRvb2xiYXJDb21tb24oKSB7CiAgICBsZXQgdG9vbGJhciA9ICQoJyNwcC10b29sYmFyJyk7CiAgICBpZiAodG9vbGJhci5sZW5ndGggPiAwKSB7CiAgICAgICAgcmV0dXJuIHRvb2xiYXIuZ2V0KDApOwogICAgfQogICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBpZD0icHAtdG9vbGJhciIgc3R5bGU9InBvc2l0aW9uOmZpeGVkO3JpZ2h0OjI4cHg7Ym90dG9tOjE2MHB4OyI+PC9kaXY+JykKICAgIHJldHVybiAkKCcjcHAtdG9vbGJhcicpLmdldCgwKTsKfQpmdW5jdGlvbiBmaW5kVG9vbGJhck9sZCgpIHsKICAgIHJldHVybiAkKCcuX3Rvb2xtZW51JykuZ2V0KDApOwp9CmZ1bmN0aW9uIGNvbnZlcnRUaHVtYlVybFRvU21hbGwodGh1bWJVcmwpIHsKICAgIC8vIOebruWJjeWPkeeOsOacieS7peS4i+S4pOenjeagvOW8j+eahOe8qeeVpeWbvgogICAgLy8gaHR0cHM6Ly9pLnB4aW1nLm5ldC9jLzEyOHgxMjgvY3VzdG9tLXRodW1iL2ltZy8yMDIxLzAxLzMxLzIwLzM1LzUzLzg3NDI2NzE4X3AwX2N1c3RvbTEyMDAuanBnCiAgICAvLyBodHRwczovL2kucHhpbWcubmV0L2MvMTI4eDEyOC9pbWctbWFzdGVyL2ltZy8yMDIxLzAxLzMxLzEwLzU3LzA2Lzg3NDI1MDgyX3AwX3NxdWFyZTEyMDAuanBnCiAgICBsZXQgcmVwbGFjZTEgPSAnYy81NDB4NTQwXzcwL2ltZy1tYXN0ZXInOwogICAgLy9sZXQgcmVwbGFjZTEgPSAnaW1nLW1hc3Rlcic7IC8vIOi/meS4quaYr+i9rOWIsHJlZ3VsYXLnmoTvvIzmr5RzbWFsbOeahOWkp+WkmuS6hu+8jOS8muW+iOaFogogICAgbGV0IHJlcGxhY2UyID0gJ19tYXN0ZXInOwogICAgcmV0dXJuIHRodW1iVXJsLnJlcGxhY2UoL2NcLy4qXC9jdXN0b20tdGh1bWIvLCByZXBsYWNlMSkucmVwbGFjZSgnX2N1c3RvbScsIHJlcGxhY2UyKQogICAgICAgIC5yZXBsYWNlKC9jXC8uKlwvaW1nLW1hc3Rlci8sIHJlcGxhY2UxKS5yZXBsYWNlKCdfc3F1YXJlJywgcmVwbGFjZTIpOwp9CmZ1bmN0aW9uIHByb2Nlc3NFbGVtZW50TGlzdENvbW1vbihsaXMsIGNvbnRyb2xGaW5kZXIpIHsKICAgICQuZWFjaChsaXMsIGZ1bmN0aW9uIChpLCBlKSB7CiAgICAgICAgbGV0IGxpID0gJChlKTsKCiAgICAgICAgLy8g5Y+q5aGr5YWF5b+F6aG755qE5Yeg5Liq77yM5YW25LuW55qE55uu5YmN55So5LiN552ACiAgICAgICAgbGV0IGN0bEF0dHJzID0gewogICAgICAgICAgICBpbGx1c3RJZDogMCwKICAgICAgICAgICAgaWxsdXN0VHlwZTogMCwKICAgICAgICAgICAgcGFnZUNvdW50OiAxLAogICAgICAgIH07CgogICAgICAgIGxldCBsaW5rcyA9IGxpLmZpbmQoJ2EnKTsKICAgICAgICBsZXQgaW1hZ2VMaW5rID0gbnVsbDsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmtzLmxlbmd0aDsgKytpKSB7CiAgICAgICAgICAgIGltYWdlTGluayA9ICQobGlua3NbaV0pOwogICAgICAgICAgICBsZXQgbGluayA9IGltYWdlTGluay5hdHRyKCdocmVmJyk7CiAgICAgICAgICAgIGlmIChsaW5rID09IG51bGwpIHsKICAgICAgICAgICAgICAgIGlMb2cudygnSW52YWxpZCBocmVmLCBza2lwIHRoaXMuJyk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgbGlua01hdGNoZWQgPSBsaW5rLm1hdGNoKC9hcnR3b3Jrc1wvKFxkKykvKTsKICAgICAgICAgICAgaWYgKGxpbmtNYXRjaGVkKSB7CiAgICAgICAgICAgICAgICBjdGxBdHRycy5pbGx1c3RJZCA9IGxpbmtNYXRjaGVkWzFdOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpTG9nLmUoJ0dldCBpbGx1c3RJZCBmYWlsZWQsIHNraXAgdGhpcyBsaXN0IGl0ZW0hJyk7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoaW1hZ2VMaW5rID09IG51bGwpIHsKICAgICAgICAgICAgaUxvZy53KCdDYW4gbm90IGZvdW5kIGltZyBvciBpbWFnZUxpbmssIHNraXAgdGhpcy4nKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgbGV0IGFuaW1hdGlvblN2ZyA9IGltYWdlTGluay5jaGlsZHJlbignZGl2OmZpcnN0JykuZmluZCgnc3ZnOmZpcnN0Jyk7CiAgICAgICAgbGV0IHBhZ2VDb3VudFNwYW4gPSBpbWFnZUxpbmsuY2hpbGRyZW4oJ2RpdjpsYXN0JykuZmluZCgnc3BhbjpsYXN0Jyk7CgogICAgICAgIGlmIChhbmltYXRpb25TdmcubGVuZ3RoID4gMCkgewogICAgICAgICAgICBjdGxBdHRycy5pbGx1c3RUeXBlID0gMjsKICAgICAgICB9CiAgICAgICAgaWYgKHBhZ2VDb3VudFNwYW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICBjdGxBdHRycy5wYWdlQ291bnQgPSBwYXJzZUludChwYWdlQ291bnRTcGFuLnRleHQoKSk7CiAgICAgICAgfQoKICAgICAgICAvLyDmt7vliqAgYXR0cgogICAgICAgIGxldCBjb250cm9sOwogICAgICAgIGlmIChjb250cm9sRmluZGVyKSB7CiAgICAgICAgICAgIGNvbnRyb2wgPSBjb250cm9sRmluZGVyKGxpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb250cm9sID0gbGkuZmluZCgnZGl2OmZpcnN0PmRpdjpmaXJzdCcpOwogICAgICAgIH0KICAgICAgICAvLyDlhZzlupXpg6jliIbpobXpnaLvvIzlpoIgaG92ZXIg5L2c6ICF5aS05YOP5by55Ye655qE5L2c5ZOB6aKE6KeICiAgICAgICAgaWYgKGNvbnRyb2wubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgY29udHJvbCA9IGxpOwogICAgICAgIH0KICAgICAgICBjb250cm9sLmF0dHIoewogICAgICAgICAgICAnaWxsdXN0SWQnOiBjdGxBdHRycy5pbGx1c3RJZCwKICAgICAgICAgICAgJ2lsbHVzdFR5cGUnOiBjdGxBdHRycy5pbGx1c3RUeXBlLAogICAgICAgICAgICAncGFnZUNvdW50JzogY3RsQXR0cnMucGFnZUNvdW50CiAgICAgICAgfSk7CiAgICAgICAgY29udHJvbC5hZGRDbGFzcygncHAtY29udHJvbCcpOwogICAgfSk7Cn0KZnVuY3Rpb24gcmVwbGFjZVRodW1iQ29tbW9uKGVsZW1lbnRzKSB7CiAgICAkLmVhY2goZWxlbWVudHMsIChpLCBlKSA9PiB7CiAgICAgICAgZSA9ICQoZSk7CiAgICAgICAgbGV0IGltZyA9IGUuZmluZCgnaW1nJyk7CiAgICAgICAgaWYgKGltZy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICBpTG9nLncoJ05vIGltZyBpbiB0aGUgY29udHJvbCBlbGVtZW50LicpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgbGV0IHNyYyA9IGltZy5hdHRyKCdzcmMnKTsKICAgICAgICBsZXQgZnVsbFNpemVTcmMgPSBjb252ZXJ0VGh1bWJVcmxUb1NtYWxsKHNyYyk7CiAgICAgICAgaWYgKHNyYyAhPSBmdWxsU2l6ZVNyYykgewogICAgICAgICAgICBpbWcuYXR0cignc3JjJywgZnVsbFNpemVTcmMpLmNzcygnb2JqZWN0LWZpdCcsICdjb250YWluJyk7CiAgICAgICAgfQogICAgfSk7Cn0KZnVuY3Rpb24gZmluZExpQnlJbWdUYWcoKSB7CiAgICBsZXQgbGlzID0gW107CiAgICAkLmVhY2goJCgnaW1nJyksIChpLCBlKSA9PiB7CiAgICAgICAgbGV0IGVsID0gJChlKTsKICAgICAgICBsZXQgcCA9IGVsOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMzsgKytpKSB7CiAgICAgICAgICAgIHAgPSBwLnBhcmVudCgpOwogICAgICAgICAgICBpZiAocC5sZW5ndGggPT0gMCkgYnJlYWs7CiAgICAgICAgICAgIGlmIChwLmF0dHIoJ2RhdGEtZ3RtLXZhbHVlJykgPT0gJycpIGNvbnRpbnVlOwogICAgICAgICAgICBsZXQgaHJlZiA9IHAuYXR0cignaHJlZicpOwogICAgICAgICAgICBpZiAodW5kZWZpbmVkID09IGhyZWYgfHwgaHJlZiA9PSAnJykgY29udGludWU7CiAgICAgICAgICAgIGlmIChocmVmLmluZGV4T2YoJy9hcnR3b3JrJykgPT0gLTEpIGNvbnRpbnVlOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyArK2kpIHsKICAgICAgICAgICAgICAgIGVsID0gZWwucGFyZW50KCk7CiAgICAgICAgICAgICAgICBpZiAoZWwubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIOW4uOeUqOeahCA8bGk+CiAgICAgICAgICAgICAgICBpZiAoZWwuZ2V0KDApLnRhZ05hbWUgPT0gJ0xJJykgewogICAgICAgICAgICAgICAgICAgIGxpcy5wdXNoKGVsKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIDx1bD4g5aWXIDxkaXY+77yI5b2TIHVsIOeUqO+8iSDlho3lpZcgPGRpdj4KICAgICAgICAgICAgICAgIC8vIOS9nOWTgemhteaUtuiXj+WQjuW8ueWHuueahOaOqOiNkOS9nOWTgQogICAgICAgICAgICAgICAgLy8gPHVsPgogICAgICAgICAgICAgICAgLy8gIDxkaXY+CiAgICAgICAgICAgICAgICAvLyAgICA8ZGl2PjwvZGl2PgogICAgICAgICAgICAgICAgLy8gICAgPGRpdj48L2Rpdj4KICAgICAgICAgICAgICAgIC8vICA8L2Rpdj4KICAgICAgICAgICAgICAgIC8vIDwvdWw+CiAgICAgICAgICAgICAgICBpZiAoZWwucGFyZW50KCkucGFyZW50KCkubGVuZ3RoID4gMCAmJgogICAgICAgICAgICAgICAgICAgIGVsLnBhcmVudCgpLnBhcmVudCgpLmdldCgwKS50YWdOYW1lID09ICdVTCcgJiYKICAgICAgICAgICAgICAgICAgICBlbC5wYXJlbnQoKS5wYXJlbnQoKS5jaGlsZHJlbigpLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgbGlzLnB1c2goZWwpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gPHVsPiDlpZcgPGRpdj4KICAgICAgICAgICAgICAgIC8vIDx1bD4KICAgICAgICAgICAgICAgIC8vICA8ZGl2PjwvZGl2PgogICAgICAgICAgICAgICAgLy8gIDxkaXY+PC9kaXY+CiAgICAgICAgICAgICAgICAvLyA8L3VsPgogICAgICAgICAgICAgICAgaWYgKGVsLnBhcmVudCgpLmxlbmd0aCA+IDAgJiYKICAgICAgICAgICAgICAgICAgICBlbC5wYXJlbnQoKS5nZXQoMCkudGFnTmFtZSA9PSAnVUwnICYmCiAgICAgICAgICAgICAgICAgICAgZWwucGFyZW50KCkuY2hpbGRyZW4oKS5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgbGlzLnB1c2goZWwpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8g5Li76aG144CB5L2c5ZOB6aG155qE57+76aG15YiX6KGoCiAgICAgICAgICAgICAgICBpZiAoZWwucGFyZW50KCkucGFyZW50KCkubGVuZ3RoID4gMCAmJiBlbC5wYXJlbnQoKS5wYXJlbnQoKS5nZXQoMCkudGFnTmFtZSA9PSAnTkFWJykgewogICAgICAgICAgICAgICAgICAgIGxpcy5wdXNoKGVsKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIOaOqOiNkOeUqOaIt+WIl+ihqAogICAgICAgICAgICAgICAgaWYgKGVsLmdldCgwKS50YWdOYW1lID09ICdESVYnICYmIGVsLmF0dHIoJ3R5cGUnKSA9PSAnaWxsdXN0JykgewogICAgICAgICAgICAgICAgICAgIGxpcy5wdXNoKGVsKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwogICAgcmV0dXJuIGxpczsKfQoKLy8gUmVwbGFjZXMgZGVsZXRlZCBhcnR3b3JrIGluZGljYXRvcnMgd2l0aCBzZWFyY2ggZW5naW5lIGxpbmtzLgpmdW5jdGlvbiBzaG93U2VhcmNoTGlua3NGb3JEZWxldGVkQXJ0d29ya3MoKSB7CiAgICAvLyBBcnJheSBvZiBzZWFyY2ggZW5naW5lcy4KICAgIGNvbnN0IHNlYXJjaEVuZ2luZXMgPSBbCiAgICAgICAgeyBuYW1lOiAnR29vZ2xlJywgdXJsOiAnaHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS9zZWFyY2g/cT0nIH0sCiAgICAgICAgeyBuYW1lOiAnQmluZycsIHVybDogJ2h0dHBzOi8vd3d3LmJpbmcuY29tL3NlYXJjaD9xPScgfSwKICAgICAgICB7IG5hbWU6ICdCYWlkdScsIHVybDogJ2h0dHBzOi8vd3d3LmJhaWR1LmNvbS9zP3dkPScgfQogICAgXTsKICAgIC8vIEZpbmQgYWxsIDxzcGFuPiBlbGVtZW50cyB3aXRoIGEgInRvIiBhdHRyaWJ1dGUuCiAgICBjb25zdCBzcGFucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3NwYW5bdG9dJyk7CiAgICBzcGFucy5mb3JFYWNoKHNwYW4gPT4gewogICAgICAgIGNvbnN0IGFydHdvcmtQYXRoID0gc3Bhbi5nZXRBdHRyaWJ1dGUoJ3RvJyk7CiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHNwYW4gaW5kaWNhdGVzIHRoYXQgaXQgaXMgYSBkZWxldGVkIGFydHdvcmsKICAgICAgICBpZiAoc3Bhbi50ZXh0Q29udGVudC50cmltKCkgPT09ICItLS0tLSIgJiYgYXJ0d29ya1BhdGguc3RhcnRzV2l0aCgiL2FydHdvcmtzLyIpKSB7CiAgICAgICAgICAgIC8vIEV4dHJhY3QgSUQgZnJvbSBhcnR3b3JrUGF0aCBieSBzbGljaW5nIG9mZiAiL2FydHdvcmtzLyIuCiAgICAgICAgICAgIGNvbnN0IGtleXdvcmQgPSBgcGl4aXYgIiR7YXJ0d29ya1BhdGguc2xpY2UoMTApfSJgCiAgICAgICAgICAgIC8vIENyZWF0ZSBhIGNvbnRhaW5lciBlbGVtZW50IHRvIGhvbGQgdGhlIGxpbmtzLgogICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgIGNvbnRhaW5lci5jbGFzc05hbWUgPSBzcGFuLmNsYXNzTmFtZTsKICAgICAgICAgICAgLy8gRm9yIGVhY2ggc2VhcmNoIGVuZ2luZSwgY3JlYXRlIGFuIDxhPiBlbGVtZW50IGFuZCBhcHBlbmQgaXQgdG8gdGhlIGNvbnRhaW5lci4KICAgICAgICAgICAgc2VhcmNoRW5naW5lcy5mb3JFYWNoKChlbmdpbmUsIGkpID0+IHsKICAgICAgICAgICAgICAgIGNvbnN0IGxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICAgICAgICBsaW5rLmhyZWYgPSBlbmdpbmUudXJsICsgZW5jb2RlVVJJQ29tcG9uZW50KGtleXdvcmQpOwogICAgICAgICAgICAgICAgbGluay50ZXh0Q29udGVudCA9IGVuZ2luZS5uYW1lOyAvLyBEaXNwbGF5IHRoZSBzZWFyY2ggZW5naW5lJ3MgbmFtZS4KICAgICAgICAgICAgICAgIGxpbmsudGFyZ2V0ID0gIl9ibGFuayI7IC8vIE9wZW4gaW4gYSBuZXcgdGFiLgogICAgICAgICAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKGxpbmspOwogICAgICAgICAgICAgICAgLy8gQXBwZW5kIGEgc2VwYXJhdG9yIGJldHdlZW4gbGlua3MsIGV4Y2VwdCBhZnRlciB0aGUgbGFzdCBvbmUuCiAgICAgICAgICAgICAgICBpZiAoaSA8IHNlYXJjaEVuZ2luZXMubGVuZ3RoIC0gMSkgewogICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnIHwgJykpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8gUmVwbGFjZSB0aGUgb3JpZ2luYWwgPHNwYW4+IHdpdGggdGhlIGNvbnRhaW5lciBob2xkaW5nIHRoZSBsaW5rcy4KICAgICAgICAgICAgc3Bhbi5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChjb250YWluZXIsIHNwYW4pOwogICAgICAgIH0KICAgIH0pOwp9CgpQYWdlc1tQYWdlVHlwZS5TZWFyY2hdID0gewogICAgUGFnZVR5cGVTdHJpbmc6ICdTZWFyY2hQYWdlJywKICAgIENoZWNrVXJsOiBmdW5jdGlvbiAodXJsKSB7CiAgICAgICAgLy8g5rKh5pyJIC9hcnR3b3JrcyDnmoTpobXpnaLkuI3mlK/mjIEKICAgICAgICByZXR1cm4gL15odHRwcz86XC9cL3d3dy5waXhpdi5uZXRcL3RhZ3NcLy4qXC8oYXJ0d29ya3N8aWxsdXN0cmF0aW9uc3xtYW5nYSkvLnRlc3QodXJsKSB8fAogICAgICAgICAgICAvXmh0dHBzPzpcL1wvd3d3LnBpeGl2Lm5ldFwvZW5cL3RhZ3NcLy4qXC8oYXJ0d29ya3N8aWxsdXN0cmF0aW9uc3xtYW5nYSkvLnRlc3QodXJsKTsKICAgIH0sCiAgICBQcm9jZXNzUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgbGV0IHJldHVybk1hcCA9IHsKICAgICAgICAgICAgbG9hZGluZ0NvbXBsZXRlOiBmYWxzZSwKICAgICAgICAgICAgY29udHJvbEVsZW1lbnRzOiBbXSwKICAgICAgICB9OwoKICAgICAgICBsZXQgc2VjdGlvbnMgPSAkKCdzZWN0aW9uJyk7CiAgICAgICAgaUxvZy5kKCdQYWdlIGhhcyAnICsgc2VjdGlvbnMubGVuZ3RoICsgJyA8c2VjdGlvbj4uJyk7CiAgICAgICAgaUxvZy5kKHNlY3Rpb25zKTsKCiAgICAgICAgbGV0IHByZW1pdW1TZWN0aW9uSW5kZXggPSAtMTsKICAgICAgICBsZXQgcmVzdWx0U2VjdGlvbkluZGV4ID0gMDsKICAgICAgICBpZiAoc2VjdGlvbnMubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgaUxvZy5lKCdObyBzdWl0YWJsZSA8c2VjdGlvbj4hJyk7CiAgICAgICAgICAgIHJldHVybiByZXR1cm5NYXA7CiAgICAgICAgfQoKICAgICAgICAkLmVhY2goc2VjdGlvbnMsIChpLCBlKSA9PiB7CiAgICAgICAgICAgIGlmICgkKGUpLmZpbmQoJ2FzaWRlJykubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgcHJlbWl1bVNlY3Rpb25JbmRleCA9IGk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXN1bHRTZWN0aW9uSW5kZXggPSBpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGlMb2cudigncHJlbWl1bTogJyArIHByZW1pdW1TZWN0aW9uSW5kZXgpOwogICAgICAgIGlMb2cudigncmVzdWx0OiAnICsgcmVzdWx0U2VjdGlvbkluZGV4KTsKCiAgICAgICAgbGV0IHVsID0gJChzZWN0aW9uc1tyZXN1bHRTZWN0aW9uSW5kZXhdKS5maW5kKCd1bCcpOwogICAgICAgIGxldCBsaXMgPSB1bC5maW5kKCdsaScpLnRvQXJyYXkoKTsKICAgICAgICBpZiAocHJlbWl1bVNlY3Rpb25JbmRleCAhPSAtMSkgewogICAgICAgICAgICBsZXQgbGlzMiA9ICQoc2VjdGlvbnNbcHJlbWl1bVNlY3Rpb25JbmRleF0pLmZpbmQoJ3VsJykuZmluZCgnbGknKTsKICAgICAgICAgICAgbGlzID0gbGlzLmNvbmNhdChsaXMyLnRvQXJyYXkoKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAocHJlbWl1bVNlY3Rpb25JbmRleCAhPSAtMSkgewogICAgICAgICAgICBsZXQgYXNpZGUgPSAkKHNlY3Rpb25zW3ByZW1pdW1TZWN0aW9uSW5kZXhdKS5maW5kKCdhc2lkZScpOwogICAgICAgICAgICAkLmVhY2goYXNpZGUuY2hpbGRyZW4oKSwgKGksIGUpID0+IHsKICAgICAgICAgICAgICAgIGlmIChlLnRhZ05hbWUudG9Mb3dlckNhc2UoKSAhPSAndWwnKSB7CiAgICAgICAgICAgICAgICAgICAgZS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJChlKS5jc3MoJy13ZWJraXQtbWFzaycsICcwJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhc2lkZS5uZXh0KCkucmVtb3ZlKCk7CiAgICAgICAgfQoKICAgICAgICBwcm9jZXNzRWxlbWVudExpc3RDb21tb24obGlzKTsKICAgICAgICByZXR1cm5NYXAuY29udHJvbEVsZW1lbnRzID0gJCgnLnBwLWNvbnRyb2wnKTsKICAgICAgICB0aGlzLnByaXZhdGUucGFnZVNlbGVjdG9yID0gdWwubmV4dCgpLmdldCgwKTsKICAgICAgICAvLyBmaXg6IOmZpOS6huKAnOmhtumDqOKAne+8jOKAnOaPkueUu+KAneOAgeKAnOa8q+eUu+KAneeahOmhtemAieaLqeWZqOaMquWIsOS6huWklumdou+8jOWFvOWuuei/meenjeaDheWGtQogICAgICAgIGlmICh0aGlzLnByaXZhdGUucGFnZVNlbGVjdG9yID09IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5wcml2YXRlLnBhZ2VTZWxlY3RvciA9IHVsLnBhcmVudCgpLm5leHQoKS5nZXQoMCk7CiAgICAgICAgfQogICAgICAgIHJldHVybk1hcC5sb2FkaW5nQ29tcGxldGUgPSB0cnVlOwogICAgICAgIHRoaXMucHJpdmF0ZS5pbWFnZUxpc3RDb25yYWluZXIgPSB1bC5nZXQoMCk7CgogICAgICAgIGlMb2cuZCgnUHJvY2VzcyBwYWdlIGVsZW1lbnRzIGNvbXBsZXRlLicpOwogICAgICAgIGlMb2cuZChyZXR1cm5NYXApOwoKICAgICAgICB0aGlzLnByaXZhdGUucmV0dXJuTWFwID0gcmV0dXJuTWFwOwogICAgICAgIHJldHVybiByZXR1cm5NYXA7CiAgICB9LAogICAgR2V0UHJvY2Vzc2VkUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5Qcm9jZXNzUGFnZUVsZW1lbnRzKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLnByaXZhdGUucmV0dXJuTWFwOwogICAgfSwKICAgIEdldFRvb2xCYXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZmluZFRvb2xiYXJDb21tb24oKTsKICAgIH0sCiAgICAvLyDmkJzntKLpobXmnIkgbGF6eWxvYWTvvIzkuI3lvIDmjpLluo/nmoTmg4XlhrXkuIvvvIzmnIDlkI7lh6DlvKDlm77niYflj6/og73kvJrml6Dms5XpooTop4jjgILov5nph4zmiorlroPlvZPlgZroh6rliqjliqDovb3lpITnkIYKICAgIEhhc0F1dG9Mb2FkOiB0cnVlLAogICAgR2V0SW1hZ2VMaXN0Q29udGFpbmVyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucHJpdmF0ZS5pbWFnZUxpc3RDb25yYWluZXI7CiAgICB9LAogICAgR2V0Rmlyc3RJbWFnZUVsZW1lbnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gJCh0aGlzLnByaXZhdGUuaW1hZ2VMaXN0Q29ucmFpbmVyKS5maW5kKCdsaScpLmdldCgwKTsKICAgIH0sCiAgICBHZXRQYWdlU2VsZWN0b3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcy5wcml2YXRlLnBhZ2VTZWxlY3RvcjsKICAgIH0sCiAgICBwcml2YXRlOiB7CiAgICAgICAgaW1hZ2VMaXN0Q29udGFpbmVyOiBudWxsLAogICAgICAgIHBhZ2VTZWxlY3RvcjogbnVsbCwKICAgICAgICByZXR1cm5NYXA6IG51bGwsCiAgICB9LAp9OwpQYWdlc1tQYWdlVHlwZS5Cb29rTWFya05ld10gPSB7CiAgICBQYWdlVHlwZVN0cmluZzogJ0Jvb2tNYXJrTmV3UGFnZScsCiAgICBDaGVja1VybDogZnVuY3Rpb24gKHVybCkgewogICAgICAgIHJldHVybiAvXmh0dHBzOlwvXC93d3cucGl4aXYubmV0XC9ib29rbWFya19uZXdfaWxsdXN0LnBocC4qLy50ZXN0KHVybCkgfHwKICAgICAgICAgICAgL15odHRwczpcL1wvd3d3LnBpeGl2Lm5ldFwvYm9va21hcmtfbmV3X2lsbHVzdF9yMTgucGhwLiovLnRlc3QodXJsKTsKICAgIH0sCiAgICBQcm9jZXNzUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgbGV0IHJldHVybk1hcCA9IHsKICAgICAgICAgICAgbG9hZGluZ0NvbXBsZXRlOiBmYWxzZSwKICAgICAgICAgICAgY29udHJvbEVsZW1lbnRzOiBbXSwKICAgICAgICB9OwoKICAgICAgICBsZXQgc2VjdGlvbnMgPSAkKCdzZWN0aW9uJyk7CiAgICAgICAgaUxvZy5kKCdQYWdlIGhhcyAnICsgc2VjdGlvbnMubGVuZ3RoICsgJyA8c2VjdGlvbj4uJyk7CiAgICAgICAgaUxvZy5kKHNlY3Rpb25zKTsKCiAgICAgICAgbGV0IGxpcyA9IHNlY3Rpb25zLmZpbmQoJ3VsJykuZmluZCgnbGknKTsKICAgICAgICBwcm9jZXNzRWxlbWVudExpc3RDb21tb24obGlzKTsKICAgICAgICByZXR1cm5NYXAuY29udHJvbEVsZW1lbnRzID0gJCgnLnBwLWNvbnRyb2wnKTsKICAgICAgICByZXR1cm5NYXAubG9hZGluZ0NvbXBsZXRlID0gdHJ1ZTsKCiAgICAgICAgaUxvZy5kKCdQcm9jZXNzIHBhZ2UgZWxlbWVudHMgY29tcGxldGUuJyk7CiAgICAgICAgaUxvZy5kKHJldHVybk1hcCk7CgogICAgICAgIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPSByZXR1cm5NYXA7CgogICAgICAgIC8vIOWFqOWwuuWvuOe8qeeVpeWbvgogICAgICAgIGlmIChnX3NldHRpbmdzLmZ1bGxTaXplVGh1bWIpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZhdGUucmV0dXJuTWFwLmxvYWRpbmdDb21wbGV0ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlcGxhY2VUaHVtYkNvbW1vbih0aGlzLnByaXZhdGUucmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmV0dXJuTWFwOwogICAgfSwKICAgIEdldFByb2Nlc3NlZFBhZ2VFbGVtZW50czogZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLnByaXZhdGUucmV0dXJuTWFwID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuUHJvY2Vzc1BhZ2VFbGVtZW50cygpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpcy5wcml2YXRlLnJldHVybk1hcDsKICAgIH0sCiAgICBHZXRUb29sQmFyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGZpbmRUb29sYmFyQ29tbW9uKCk7CiAgICB9LAogICAgSGFzQXV0b0xvYWQ6IHRydWUsCiAgICBwcml2YXRlOiB7CiAgICAgICAgcmV0dXJuTWFwOiBudWxsLAogICAgfSwKfTsKUGFnZXNbUGFnZVR5cGUuRGlzY292ZXJ5XSA9IHsKICAgIFBhZ2VUeXBlU3RyaW5nOiAnRGlzY292ZXJ5UGFnZScsCiAgICBDaGVja1VybDogZnVuY3Rpb24gKHVybCkgewogICAgICAgIHJldHVybiAvXmh0dHBzPzpcL1wvd3d3LnBpeGl2Lm5ldFwvZGlzY292ZXJ5LiovLnRlc3QodXJsKTsKICAgIH0sCiAgICBQcm9jZXNzUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgbGV0IHJldHVybk1hcCA9IHsKICAgICAgICAgICAgbG9hZGluZ0NvbXBsZXRlOiBmYWxzZSwKICAgICAgICAgICAgY29udHJvbEVsZW1lbnRzOiBbXSwKICAgICAgICB9OwoKICAgICAgICBsZXQgY29udGFpbmVyRGl2ID0gJCgnLmd0bS1pbGx1c3QtcmVjb21tZW5kLXpvbmUnKTsKICAgICAgICBpZiAoY29udGFpbmVyRGl2Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgaUxvZy5kKCdGb3VuZCBjb250YWluZXIgZGl2LicpOwogICAgICAgICAgICBpTG9nLmQoY29udGFpbmVyRGl2KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpTG9nLmUoJ0NhbiBub3QgZm91bmQgY29udGFpbmVyIGRpdi4nKTsKICAgICAgICAgICAgcmV0dXJuIHJldHVybk1hcDsKICAgICAgICB9CgogICAgICAgIGxldCBsaXMgPSBjb250YWluZXJEaXYuZmluZCgndWwnKS5jaGlsZHJlbignbGknKTsKICAgICAgICBwcm9jZXNzRWxlbWVudExpc3RDb21tb24obGlzKTsKICAgICAgICByZXR1cm5NYXAuY29udHJvbEVsZW1lbnRzID0gJCgnLnBwLWNvbnRyb2wnKTsKICAgICAgICByZXR1cm5NYXAubG9hZGluZ0NvbXBsZXRlID0gdHJ1ZTsKCiAgICAgICAgaUxvZy5kKCdQcm9jZXNzIHBhZ2UgZWxlbWVudHMgY29tcGxldGUuJyk7CiAgICAgICAgaUxvZy5kKHJldHVybk1hcCk7CgogICAgICAgIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPSByZXR1cm5NYXA7CiAgICAgICAgcmV0dXJuIHJldHVybk1hcDsKICAgIH0sCiAgICBHZXRQcm9jZXNzZWRQYWdlRWxlbWVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5wcml2YXRlLnJldHVybk1hcCA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLlByb2Nlc3NQYWdlRWxlbWVudHMoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXA7CiAgICB9LAogICAgR2V0VG9vbEJhcjogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBmaW5kVG9vbGJhckNvbW1vbigpOwogICAgfSwKICAgIEhhc0F1dG9Mb2FkOiB0cnVlLAogICAgcHJpdmF0ZTogewogICAgICAgIHJldHVybk1hcDogbnVsbCwKICAgIH0sCn07ClBhZ2VzW1BhZ2VUeXBlLk1lbWJlcl0gPSB7CiAgICBQYWdlVHlwZVN0cmluZzogJ01lbWJlclBhZ2UvTWVtYmVySWxsdXN0UGFnZS9NZW1iZXJCb29rTWFyaycsCiAgICBDaGVja1VybDogZnVuY3Rpb24gKHVybCkgewogICAgICAgIHJldHVybiAvXmh0dHBzPzpcL1wvd3d3LnBpeGl2Lm5ldFwvKGVuXC8pP3VzZXJzXC9cZCsvLnRlc3QodXJsKQogICAgfSwKICAgIFByb2Nlc3NQYWdlRWxlbWVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBzaG93U2VhcmNoTGlua3NGb3JEZWxldGVkQXJ0d29ya3MoKTsKICAgICAgICBsZXQgcmV0dXJuTWFwID0gewogICAgICAgICAgICBsb2FkaW5nQ29tcGxldGU6IGZhbHNlLAogICAgICAgICAgICBjb250cm9sRWxlbWVudHM6IFtdLAogICAgICAgIH07CgogICAgICAgIGxldCBsaXMgPSBmaW5kTGlCeUltZ1RhZygpOwogICAgICAgIGlMb2cuZChsaXMpOwoKICAgICAgICBsZXQgc2VjdGlvbnMgPSAkKCdzZWN0aW9uJyk7CiAgICAgICAgaUxvZy5kKCdQYWdlIGhhcyAnICsgc2VjdGlvbnMubGVuZ3RoICsgJyA8c2VjdGlvbj4uJyk7CiAgICAgICAgaUxvZy5kKHNlY3Rpb25zKTsKCiAgICAgICAgcHJvY2Vzc0VsZW1lbnRMaXN0Q29tbW9uKGxpcyk7CiAgICAgICAgcmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cyA9ICQoJy5wcC1jb250cm9sJyk7CiAgICAgICAgcmV0dXJuTWFwLmxvYWRpbmdDb21wbGV0ZSA9IHRydWU7CgogICAgICAgIGlMb2cuZCgnUHJvY2VzcyBwYWdlIGVsZW1lbnRzIGNvbXBsZXRlLicpOwogICAgICAgIGlMb2cuZChyZXR1cm5NYXApOwoKICAgICAgICB0aGlzLnByaXZhdGUucmV0dXJuTWFwID0gcmV0dXJuTWFwOwoKICAgICAgICAvLyDlhajlsLrlr7jnvKnnlaXlm74KICAgICAgICBpZiAoZ19zZXR0aW5ncy5mdWxsU2l6ZVRodW1iKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5wcml2YXRlLnJldHVybk1hcC5sb2FkaW5nQ29tcGxldGUpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXBsYWNlVGh1bWJDb21tb24odGhpcy5wcml2YXRlLnJldHVybk1hcC5jb250cm9sRWxlbWVudHMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJldHVybk1hcDsKICAgIH0sCiAgICBHZXRQcm9jZXNzZWRQYWdlRWxlbWVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5wcml2YXRlLnJldHVybk1hcCA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLlByb2Nlc3NQYWdlRWxlbWVudHMoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXA7CiAgICB9LAogICAgR2V0VG9vbEJhcjogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBmaW5kVG9vbGJhckNvbW1vbigpOwogICAgfSwKICAgIC8vIOi3n+aQnOe0oumhteS4gOagt+eahOaDheWGtQogICAgSGFzQXV0b0xvYWQ6IHRydWUsCiAgICBwcml2YXRlOiB7CiAgICAgICAgcmV0dXJuTWFwOiBudWxsLAogICAgfSwKfTsKUGFnZXNbUGFnZVR5cGUuSG9tZV0gPSB7CiAgICBQYWdlVHlwZVN0cmluZzogJ0hvbWVQYWdlJywKICAgIENoZWNrVXJsOiBmdW5jdGlvbiAodXJsKSB7CiAgICAgICAgcmV0dXJuIC9odHRwcz86XC9cL3d3dy5waXhpdi5uZXRcLz8kLy50ZXN0KHVybCkgfHwKICAgICAgICAgICAgL2h0dHBzPzpcL1wvd3d3LnBpeGl2Lm5ldFwvZW5cLz8kLy50ZXN0KHVybCkgfHwKICAgICAgICAgICAgL2h0dHBzPzpcL1wvd3d3LnBpeGl2Lm5ldFwvaWxsdXN0cmF0aW9uXC8/JC8udGVzdCh1cmwpIHx8CiAgICAgICAgICAgIC9odHRwcz86XC9cL3d3dy5waXhpdi5uZXRcL21hbmdhXC8/JC8udGVzdCh1cmwpIHx8CiAgICAgICAgICAgIC9odHRwcz86XC9cL3d3dy5waXhpdi5uZXRcL2NhdGVfcjE4XC5waHAkLy50ZXN0KHVybCkgfHwKICAgICAgICAgICAgL2h0dHBzPzpcL1wvd3d3LnBpeGl2Lm5ldFwvZW5cL2NhdGVfcjE4XC5waHAkLy50ZXN0KHVybCk7CiAgICB9LAogICAgUHJvY2Vzc1BhZ2VFbGVtZW50czogZnVuY3Rpb24gKCkgewogICAgICAgIGxldCByZXR1cm5NYXAgPSB7CiAgICAgICAgICAgIGxvYWRpbmdDb21wbGV0ZTogZmFsc2UsCiAgICAgICAgICAgIGNvbnRyb2xFbGVtZW50czogW10sCiAgICAgICAgfTsKCiAgICAgICAgbGV0IGxpcyA9IGZpbmRMaUJ5SW1nVGFnKCk7CgogICAgICAgIHByb2Nlc3NFbGVtZW50TGlzdENvbW1vbihsaXMpOwogICAgICAgIHJldHVybk1hcC5jb250cm9sRWxlbWVudHMgPSAkKCcucHAtY29udHJvbCcpOwogICAgICAgIHJldHVybk1hcC5sb2FkaW5nQ29tcGxldGUgPSB0cnVlOwoKICAgICAgICBpTG9nLmQoJ1Byb2Nlc3MgcGFnZSBlbGVtZW50cyBjb21wbGV0ZS4nKTsKICAgICAgICBpTG9nLmQocmV0dXJuTWFwKTsKCiAgICAgICAgaWYgKHRoaXMucHJpdmF0ZS5yZXR1cm5NYXApIHsKICAgICAgICAgICAgbGV0IG9sZElkcyA9IG5ldyBTZXQoKTsKICAgICAgICAgICAgJC5lYWNoKHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAuY29udHJvbEVsZW1lbnRzLCAoaSwgZSkgPT4gewogICAgICAgICAgICAgICAgb2xkSWRzLmFkZCgkKGUpLmF0dHIoJ2lsbHVzdElkJykpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgJC5lYWNoKHJldHVybk1hcC5jb250cm9sRWxlbWVudHMsIChpLCBlKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoIW9sZElkcy5oYXMoJChlKS5hdHRyKCdpbGx1c3RJZCcpKSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybk1hcC5mb3JjZVVwZGF0ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPSByZXR1cm5NYXA7CgogICAgICAgIC8vIOWFqOWwuuWvuOe8qeeVpeWbvgogICAgICAgIGlmIChnX3NldHRpbmdzLmZ1bGxTaXplVGh1bWIpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLnByaXZhdGUucmV0dXJuTWFwLmxvYWRpbmdDb21wbGV0ZSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlcGxhY2VUaHVtYkNvbW1vbih0aGlzLnByaXZhdGUucmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cyk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmV0dXJuTWFwOwogICAgfSwKICAgIEdldFByb2Nlc3NlZFBhZ2VFbGVtZW50czogZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzLnByaXZhdGUucmV0dXJuTWFwID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuUHJvY2Vzc1BhZ2VFbGVtZW50cygpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGhpcy5wcml2YXRlLnJldHVybk1hcDsKICAgIH0sCiAgICBHZXRUb29sQmFyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGZpbmRUb29sYmFyQ29tbW9uKCk7CiAgICB9LAogICAgSGFzQXV0b0xvYWQ6IHRydWUsCiAgICBwcml2YXRlOiB7CiAgICAgICAgcmV0dXJuTWFwOiBudWxsLAogICAgfSwKfTsKUGFnZXNbUGFnZVR5cGUuUmFua2luZ10gPSB7CiAgICBQYWdlVHlwZVN0cmluZzogJ1JhbmtpbmdQYWdlJywKICAgIENoZWNrVXJsOiBmdW5jdGlvbiAodXJsKSB7CiAgICAgICAgcmV0dXJuIC9eaHR0cHM/OlwvXC93d3cucGl4aXYubmV0XC9yYW5raW5nLnBocC4qLy50ZXN0KHVybCk7CiAgICB9LAogICAgUHJvY2Vzc1BhZ2VFbGVtZW50czogZnVuY3Rpb24gKCkgewogICAgICAgIGxldCByZXR1cm5NYXAgPSB7CiAgICAgICAgICAgIGxvYWRpbmdDb21wbGV0ZTogZmFsc2UsCiAgICAgICAgICAgIGNvbnRyb2xFbGVtZW50czogW10sCiAgICAgICAgfTsKCiAgICAgICAgbGV0IGxpcyA9IGZpbmRMaUJ5SW1nVGFnKCk7CgogICAgICAgIHByb2Nlc3NFbGVtZW50TGlzdENvbW1vbihsaXMsIChlKSA9PiAkKGUuY2hpbGRyZW4oKS5nZXQoMSkpKTsKICAgICAgICByZXR1cm5NYXAuY29udHJvbEVsZW1lbnRzID0gJCgnLnBwLWNvbnRyb2wnKTsKICAgICAgICByZXR1cm5NYXAubG9hZGluZ0NvbXBsZXRlID0gdHJ1ZTsKCiAgICAgICAgaUxvZy5kKCdQcm9jZXNzIHBhZ2UgZWxlbWVudHMgY29tcGxldGUuJyk7CiAgICAgICAgaUxvZy5kKHJldHVybk1hcCk7CgogICAgICAgIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPSByZXR1cm5NYXA7CiAgICAgICAgcmV0dXJuIHJldHVybk1hcDsKICAgIH0sCiAgICBHZXRQcm9jZXNzZWRQYWdlRWxlbWVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5wcml2YXRlLnJldHVybk1hcCA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLlByb2Nlc3NQYWdlRWxlbWVudHMoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXA7CiAgICB9LAogICAgR2V0VG9vbEJhcjogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBmaW5kVG9vbGJhckNvbW1vbigpOwogICAgfSwKICAgIEhhc0F1dG9Mb2FkOiB0cnVlLAogICAgcHJpdmF0ZTogewogICAgICAgIHJldHVybk1hcDogbnVsbCwKICAgIH0sCn07ClBhZ2VzW1BhZ2VUeXBlLk5ld0lsbHVzdF0gPSB7CiAgICBQYWdlVHlwZVN0cmluZzogJ05ld0lsbHVzdFBhZ2UnLAogICAgQ2hlY2tVcmw6IGZ1bmN0aW9uICh1cmwpIHsKICAgICAgICByZXR1cm4gL15odHRwcz86XC9cL3d3dy5waXhpdi5uZXRcL25ld19pbGx1c3QucGhwLiovLnRlc3QodXJsKTsKICAgIH0sCiAgICBQcm9jZXNzUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgbGV0IHJldHVybk1hcCA9IHsKICAgICAgICAgICAgbG9hZGluZ0NvbXBsZXRlOiBmYWxzZSwKICAgICAgICAgICAgY29udHJvbEVsZW1lbnRzOiBbXSwKICAgICAgICB9OwoKICAgICAgICBsZXQgbGlzID0gZmluZExpQnlJbWdUYWcoKTsKCiAgICAgICAgcHJvY2Vzc0VsZW1lbnRMaXN0Q29tbW9uKGxpcyk7CiAgICAgICAgcmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cyA9ICQoJy5wcC1jb250cm9sJyk7CiAgICAgICAgcmV0dXJuTWFwLmxvYWRpbmdDb21wbGV0ZSA9IHRydWU7CgogICAgICAgIGlMb2cuZCgnUHJvY2VzcyBwYWdlIGVsZW1lbnRzIGNvbXBsZXRlLicpOwogICAgICAgIGlMb2cuZChyZXR1cm5NYXApOwoKICAgICAgICB0aGlzLnByaXZhdGUucmV0dXJuTWFwID0gcmV0dXJuTWFwOwoKICAgICAgICAvLyDlhajlsLrlr7jnvKnnlaXlm74KICAgICAgICBpZiAoZ19zZXR0aW5ncy5mdWxsU2l6ZVRodW1iKSB7CiAgICAgICAgICAgIGlmICghdGhpcy5wcml2YXRlLnJldHVybk1hcC5sb2FkaW5nQ29tcGxldGUpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXBsYWNlVGh1bWJDb21tb24odGhpcy5wcml2YXRlLnJldHVybk1hcC5jb250cm9sRWxlbWVudHMpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJldHVybk1hcDsKICAgIH0sCiAgICBHZXRQcm9jZXNzZWRQYWdlRWxlbWVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5wcml2YXRlLnJldHVybk1hcCA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLlByb2Nlc3NQYWdlRWxlbWVudHMoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXA7CiAgICB9LAogICAgR2V0VG9vbEJhcjogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBmaW5kVG9vbGJhckNvbW1vbigpOwogICAgfSwKICAgIEhhc0F1dG9Mb2FkOiB0cnVlLAogICAgcHJpdmF0ZTogewogICAgICAgIHJldHVybk1hcDogbnVsbCwKICAgIH0sCn07ClBhZ2VzW1BhZ2VUeXBlLlIxOF0gPSB7CiAgICBQYWdlVHlwZVN0cmluZzogJ1IxOFBhZ2UnLAogICAgQ2hlY2tVcmw6IGZ1bmN0aW9uICh1cmwpIHsKICAgICAgICByZXR1cm4gL15odHRwcz86XC9cL3d3dy5waXhpdi5uZXRcL2NhdGVfcjE4LnBocC4qLy50ZXN0KHVybCk7CiAgICB9LAogICAgUHJvY2Vzc1BhZ2VFbGVtZW50czogZnVuY3Rpb24gKCkgewogICAgICAgIC8vCiAgICB9LAogICAgR2V0VG9vbEJhcjogZnVuY3Rpb24gKCkgewogICAgICAgIC8vCiAgICB9LAogICAgSGFzQXV0b0xvYWQ6IGZhbHNlLAp9OwpQYWdlc1tQYWdlVHlwZS5Cb29rTWFya10gPSB7CiAgICBQYWdlVHlwZVN0cmluZzogJ0Jvb2tNYXJrUGFnZScsCiAgICBDaGVja1VybDogZnVuY3Rpb24gKHVybCkgewogICAgICAgIHJldHVybiAvXmh0dHBzOlwvXC93d3cucGl4aXYubmV0XC9ib29rbWFyay5waHBcLz8kLy50ZXN0KHVybCk7CiAgICB9LAogICAgUHJvY2Vzc1BhZ2VFbGVtZW50czogZnVuY3Rpb24gKCkgewogICAgICAgIGxldCByZXR1cm5NYXAgPSB7CiAgICAgICAgICAgIGxvYWRpbmdDb21wbGV0ZTogZmFsc2UsCiAgICAgICAgICAgIGNvbnRyb2xFbGVtZW50czogW10sCiAgICAgICAgfTsKCiAgICAgICAgbGV0IGltYWdlcyA9ICQoJy5pbWFnZS1pdGVtJyk7CiAgICAgICAgaUxvZy5kKCdGb3VuZCBpbWFnZXMsIGxlbmd0aDogJyArIGltYWdlcy5sZW5ndGgpOwogICAgICAgIGlMb2cuZChpbWFnZXMpOwoKICAgICAgICBpbWFnZXMuZWFjaChmdW5jdGlvbiAoaSwgZSkgewogICAgICAgICAgICBsZXQgX3RoaXMgPSAkKGUpOwoKICAgICAgICAgICAgbGV0IHdvcmsgPSBfdGhpcy5maW5kKCcuX3dvcmsnKTsKICAgICAgICAgICAgaWYgKHdvcmsubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICBpTG9nLncoJ0NhbiBub3QgZm91bmQgLl93b3JrLCBza2lwIHRoaXMuJyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBjdGxBdHRycyA9IHsKICAgICAgICAgICAgICAgIGlsbHVzdElkOiAwLAogICAgICAgICAgICAgICAgaWxsdXN0VHlwZTogMCwKICAgICAgICAgICAgICAgIHBhZ2VDb3VudDogMSwKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGxldCBocmVmID0gd29yay5hdHRyKCdocmVmJyk7CiAgICAgICAgICAgIGlmIChocmVmID09IG51bGwgfHwgaHJlZiA9PT0gJycpIHsKICAgICAgICAgICAgICAgIGlMb2cudygnQ2FuIG5vdCBmb3VuZCBpbGx1c3QgaWQsIHNraXAgdGhpcy4nKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IG1hdGNoZWQgPSBocmVmLm1hdGNoKC9hcnR3b3Jrc1wvKFxkKykvKTsKICAgICAgICAgICAgaWYgKG1hdGNoZWQpIHsKICAgICAgICAgICAgICAgIGN0bEF0dHJzLmlsbHVzdElkID0gbWF0Y2hlZFsxXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlMb2cudygnQ2FuIG5vdCBmb3VuZCBpbGx1c3QgaWQsIHNraXAgdGhpcy4nKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHdvcmsuaGFzQ2xhc3MoJ211bHRpcGxlJykpIHsKICAgICAgICAgICAgICAgIGN0bEF0dHJzLnBhZ2VDb3VudCA9IF90aGlzLmZpbmQoJy5wYWdlLWNvdW50JykuZmluZCgnc3BhbicpLnRleHQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKHdvcmsuaGFzQ2xhc3MoJ3Vnb2t1LWlsbHVzdCcpKSB7CiAgICAgICAgICAgICAgICBjdGxBdHRycy5pbGx1c3RUeXBlID0gMjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g5re75YqgIGF0dHIKICAgICAgICAgICAgbGV0IGNvbnRyb2wgPSBfdGhpcy5jaGlsZHJlbignYTpmaXJzdCcpOwogICAgICAgICAgICBjb250cm9sLmF0dHIoewogICAgICAgICAgICAgICAgJ2lsbHVzdElkJzogY3RsQXR0cnMuaWxsdXN0SWQsCiAgICAgICAgICAgICAgICAnaWxsdXN0VHlwZSc6IGN0bEF0dHJzLmlsbHVzdFR5cGUsCiAgICAgICAgICAgICAgICAncGFnZUNvdW50JzogY3RsQXR0cnMucGFnZUNvdW50CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cy5wdXNoKGNvbnRyb2wuZ2V0KDApKTsKICAgICAgICB9KTsKCiAgICAgICAgcmV0dXJuTWFwLmxvYWRpbmdDb21wbGV0ZSA9IHRydWU7CgogICAgICAgIGlMb2cuZCgnUHJvY2VzcyBwYWdlIGVsZW1lbnRzIGNvbXBsZXRlLicpOwogICAgICAgIGlMb2cuZChyZXR1cm5NYXApOwoKICAgICAgICB0aGlzLnByaXZhdGUucmV0dXJuTWFwID0gcmV0dXJuTWFwOwogICAgICAgIHJldHVybiByZXR1cm5NYXA7CiAgICB9LAogICAgR2V0UHJvY2Vzc2VkUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5Qcm9jZXNzUGFnZUVsZW1lbnRzKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLnByaXZhdGUucmV0dXJuTWFwOwogICAgfSwKICAgIEdldFRvb2xCYXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZmluZFRvb2xiYXJPbGQoKTsKICAgIH0sCiAgICBIYXNBdXRvTG9hZDogZmFsc2UsCiAgICBwcml2YXRlOiB7CiAgICAgICAgcmV0dXJuTWFwOiBudWxsLAogICAgfSwKfTsKUGFnZXNbUGFnZVR5cGUuU3RhY2NdID0gewogICAgUGFnZVR5cGVTdHJpbmc6ICdTdGFjY1BhZ2UnLAogICAgQ2hlY2tVcmw6IGZ1bmN0aW9uICh1cmwpIHsKICAgICAgICByZXR1cm4gL15odHRwczpcL1wvd3d3LnBpeGl2Lm5ldFwvc3RhY2MuKi8udGVzdCh1cmwpOwogICAgfSwKICAgIFByb2Nlc3NQYWdlRWxlbWVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBsZXQgcmV0dXJuTWFwID0gewogICAgICAgICAgICBsb2FkaW5nQ29tcGxldGU6IGZhbHNlLAogICAgICAgICAgICBjb250cm9sRWxlbWVudHM6IFtdLAogICAgICAgIH07CgogICAgICAgIGxldCB3b3JrcyA9ICQoJy5fd29yaycpOwoKICAgICAgICBpTG9nLmQoJ0ZvdW5kIC53b3JrLCBsZW5ndGg6ICcgKyB3b3Jrcy5sZW5ndGgpOwogICAgICAgIGlMb2cuZCh3b3Jrcyk7CgogICAgICAgIHdvcmtzLmVhY2goZnVuY3Rpb24gKGksIGUpIHsKICAgICAgICAgICAgbGV0IF90aGlzID0gJChlKTsKCiAgICAgICAgICAgIGxldCBjdGxBdHRycyA9IHsKICAgICAgICAgICAgICAgIGlsbHVzdElkOiAwLAogICAgICAgICAgICAgICAgaWxsdXN0VHlwZTogMCwKICAgICAgICAgICAgICAgIHBhZ2VDb3VudDogMSwKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGxldCBocmVmID0gX3RoaXMuYXR0cignaHJlZicpOwoKICAgICAgICAgICAgaWYgKGhyZWYgPT0gbnVsbCB8fCBocmVmID09PSAnJykgewogICAgICAgICAgICAgICAgaUxvZy53KCdDYW4gbm90IGZvdW5kIGlsbHVzdCBpZCwgc2tpcCB0aGlzLicpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgbWF0Y2hlZCA9IGhyZWYubWF0Y2goL2lsbHVzdF9pZD0oXGQrKS8pOwogICAgICAgICAgICBpZiAobWF0Y2hlZCkgewogICAgICAgICAgICAgICAgY3RsQXR0cnMuaWxsdXN0SWQgPSBtYXRjaGVkWzFdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaUxvZy53KCdDYW4gbm90IGZvdW5kIGlsbHVzdCBpZCwgc2tpcCB0aGlzLicpOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoX3RoaXMuaGFzQ2xhc3MoJ211bHRpcGxlJykpIHsKICAgICAgICAgICAgICAgIGN0bEF0dHJzLnBhZ2VDb3VudCA9IF90aGlzLmZpbmQoJy5wYWdlLWNvdW50JykuZmluZCgnc3BhbicpLnRleHQoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKF90aGlzLmhhc0NsYXNzKCd1Z29rdS1pbGx1c3QnKSkgewogICAgICAgICAgICAgICAgY3RsQXR0cnMuaWxsdXN0VHlwZSA9IDI7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIOa3u+WKoCBhdHRyCiAgICAgICAgICAgIF90aGlzLmF0dHIoewogICAgICAgICAgICAgICAgJ2lsbHVzdElkJzogY3RsQXR0cnMuaWxsdXN0SWQsCiAgICAgICAgICAgICAgICAnaWxsdXN0VHlwZSc6IGN0bEF0dHJzLmlsbHVzdFR5cGUsCiAgICAgICAgICAgICAgICAncGFnZUNvdW50JzogY3RsQXR0cnMucGFnZUNvdW50CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgcmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cy5wdXNoKGUpOwogICAgICAgIH0pOwoKICAgICAgICByZXR1cm5NYXAubG9hZGluZ0NvbXBsZXRlID0gdHJ1ZTsKCiAgICAgICAgaUxvZy5kKCdQcm9jZXNzIHBhZ2UgZWxlbWVudHMgY29tcGxldGUuJyk7CiAgICAgICAgaUxvZy5kKHJldHVybk1hcCk7CgogICAgICAgIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPSByZXR1cm5NYXA7CiAgICAgICAgcmV0dXJuIHJldHVybk1hcDsKICAgIH0sCiAgICBHZXRQcm9jZXNzZWRQYWdlRWxlbWVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5wcml2YXRlLnJldHVybk1hcCA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLlByb2Nlc3NQYWdlRWxlbWVudHMoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXA7CiAgICB9LAogICAgR2V0VG9vbEJhcjogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBmaW5kVG9vbGJhck9sZCgpOwogICAgfSwKICAgIEhhc0F1dG9Mb2FkOiB0cnVlLAogICAgcHJpdmF0ZTogewogICAgICAgIHJldHVybk1hcDogbnVsbCwKICAgIH0sCn07ClBhZ2VzW1BhZ2VUeXBlLkFydHdvcmtdID0gewogICAgUGFnZVR5cGVTdHJpbmc6ICdBcnR3b3JrUGFnZScsCiAgICBDaGVja1VybDogZnVuY3Rpb24gKHVybCkgewogICAgICAgIHJldHVybiAvXmh0dHBzOlwvXC93d3cucGl4aXYubmV0XC9hcnR3b3Jrc1wvLiovLnRlc3QodXJsKSB8fAogICAgICAgICAgICAvXmh0dHBzOlwvXC93d3cucGl4aXYubmV0XC9lblwvYXJ0d29ya3NcLy4qLy50ZXN0KHVybCkKICAgIH0sCiAgICBQcm9jZXNzUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgbGV0IGNhbnZhcyA9ICQoJ21haW4nKS5maW5kKCdmaWd1cmUnKS5maW5kKCdjYW52YXMnKTsKICAgICAgICBpZiAoJCgnbWFpbicpLmZpbmQoJ2ZpZ3VyZScpLmZpbmQoJ2NhbnZhcycpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgdGhpcy5wcml2YXRlLm5lZWRQcm9jZXNzID0gdHJ1ZTsKICAgICAgICAgICAgY2FudmFzLmFkZENsYXNzKCdwcC1jYW52YXMnKTsKICAgICAgICB9CgogICAgICAgIGxldCByZXR1cm5NYXAgPSB7CiAgICAgICAgICAgIGxvYWRpbmdDb21wbGV0ZTogZmFsc2UsCiAgICAgICAgICAgIGNvbnRyb2xFbGVtZW50czogW10sCiAgICAgICAgfTsKCiAgICAgICAgbGV0IGxpcyA9IGZpbmRMaUJ5SW1nVGFnKCk7CgogICAgICAgIHByb2Nlc3NFbGVtZW50TGlzdENvbW1vbihsaXMpOwogICAgICAgIHJldHVybk1hcC5jb250cm9sRWxlbWVudHMgPSAkKCcucHAtY29udHJvbCcpOwogICAgICAgIHJldHVybk1hcC5sb2FkaW5nQ29tcGxldGUgPSB0cnVlOwoKICAgICAgICBpTG9nLmQoJ1Byb2Nlc3MgcGFnZSBlbGVtZW50cyBjb21wbGV0ZS4nKTsKICAgICAgICBpTG9nLmQocmV0dXJuTWFwKTsKCiAgICAgICAgdGhpcy5wcml2YXRlLnJldHVybk1hcCA9IHJldHVybk1hcDsKCiAgICAgICAgLy8g5YWo5bC65a+457yp55Wl5Zu+CiAgICAgICAgaWYgKGdfc2V0dGluZ3MuZnVsbFNpemVUaHVtYikgewogICAgICAgICAgICBpZiAoIXRoaXMucHJpdmF0ZS5yZXR1cm5NYXAubG9hZGluZ0NvbXBsZXRlKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVwbGFjZVRodW1iQ29tbW9uKHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAuY29udHJvbEVsZW1lbnRzKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiByZXR1cm5NYXA7CiAgICB9LAogICAgR2V0UHJvY2Vzc2VkUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5Qcm9jZXNzUGFnZUVsZW1lbnRzKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLnByaXZhdGUucmV0dXJuTWFwOwogICAgfSwKICAgIEdldFRvb2xCYXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZmluZFRvb2xiYXJDb21tb24oKTsKICAgIH0sCiAgICBIYXNBdXRvTG9hZDogdHJ1ZSwKICAgIFdvcms6IGZ1bmN0aW9uICgpIHsKICAgICAgICBmdW5jdGlvbiBBZGREb3dubG9hZEJ1dHRvbihidXR0b24sIG9mZnNldFRvT2Zmc2V0VG9wKSB7CiAgICAgICAgICAgIGlmICghZ19zZXR0aW5ncy5lbmFibGVBbmltZURvd25sb2FkKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGxldCBjbG9uZUJ1dHRvbiA9IGJ1dHRvbi5jbG9uZSgpLmNzcyh7ICdib3R0b20nOiAnNTBweCcsICdwYWRkaW5nJzogMCwgJ3dpZHRoJzogJzQ4cHgnLCAnaGVpZ2h0JzogJzQ4cHgnLCAnb3BhY2l0eSc6ICcwLjQnLCAnY3Vyc29yJzogJ3BvaW50ZXInIH0pOwogICAgICAgICAgICBjbG9uZUJ1dHRvbi5nZXQoMCkuaW5uZXJIVE1MID0gJzxzdmcgdmlld0JveD0iMCAwIDEyMCAxMjAiIHN0eWxlPSJ3aWR0aDogNDBweDsgaGVpZ2h0OiA0MHB4OyBzdHJva2Utd2lkdGg6IDEwOyBzdHJva2UtbGluZWNhcDogcm91bmQ7IHN0cm9rZS1saW5lam9pbjogcm91bmQ7IGJvcmRlci1yYWRpdXM6IDI0cHg7IGJhY2tncm91bmQtY29sb3I6IGJsYWNrOyBzdHJva2U6IGxpbWVncmVlbjsgZmlsbDogbm9uZTsiIGNsYXNzPSJfM0ZvMEhqZyI+PHBvbHlsaW5lIHBvaW50cz0iNjAsMzAgNjAsOTAiPjwvcG9seWxpbmU+PHBvbHlsaW5lIHBvaW50cz0iMzAsNjAgNjAsOTAgOTAsNjAiPjwvcG9seWxpbmU+PC9zdmc+PC9idXR0b24+JzsKCiAgICAgICAgICAgIGZ1bmN0aW9uIE1vdmVCdXR0b24oKSB7CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRPZmZzZXQoZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChlLm9mZnNldFBhcmVudCkgewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgb2Zmc2V0ID0gZ2V0T2Zmc2V0KGUub2Zmc2V0UGFyZW50KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldFRvcDogZS5vZmZzZXRUb3AgKyBvZmZzZXQub2Zmc2V0VG9wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0TGVmdDogZS5vZmZzZXRMZWZ0ICsgb2Zmc2V0Lm9mZnNldExlZnQsCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldFRvcDogZS5vZmZzZXRUb3AsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRMZWZ0OiBlLm9mZnNldExlZnQsCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8qbGV0IG9mZnNldCA9IGdldE9mZnNldChidXR0b24uZ2V0KDApKTsKICAgICAgICAgICAgICAgIGlMb2cuaSgnb2Zmc2V0IG9mIGRvd25sb2FkIGJ1dHRvbjogJyArIG9mZnNldC5vZmZzZXRUb3AgKyAnLCAnICsgb2Zmc2V0Lm9mZnNldExlZnQpOwogICAgICAgICAgICAgICAgaUxvZy5kKG9mZnNldCk7CgogICAgICAgICAgICAgICAgY2xvbmVCdXR0b24uY3NzKHsgJ3Bvc2l0aW9uJzogJ2Fic29sdXRlJyB9KS5zaG93KCk7Ki8KICAgICAgICAgICAgfQoKICAgICAgICAgICAgTW92ZUJ1dHRvbigpOwogICAgICAgICAgICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIE1vdmVCdXR0b24pOwogICAgICAgICAgICBidXR0b24uYWZ0ZXIoY2xvbmVCdXR0b24pOwoKICAgICAgICAgICAgY2xvbmVCdXR0b24ubW91c2VvdmVyKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICQodGhpcykuY3NzKCdvcGFjaXR5JywgJzAuMicpOwogICAgICAgICAgICB9KS5tb3VzZWxlYXZlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICQodGhpcykuY3NzKCdvcGFjaXR5JywgJzAuNCcpOwogICAgICAgICAgICB9KS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBsZXQgaWxsdXN0SWQgPSAnJzsKCiAgICAgICAgICAgICAgICBsZXQgbWF0Y2hlZCA9IGxvY2F0aW9uLmhyZWYubWF0Y2goL2FydHdvcmtzXC8oXGQrKS8pOwogICAgICAgICAgICAgICAgaWYgKG1hdGNoZWQpIHsKICAgICAgICAgICAgICAgICAgICBpbGx1c3RJZCA9IG1hdGNoZWRbMV07CiAgICAgICAgICAgICAgICAgICAgaUxvZy5pKCdJbGx1c3RJZD0nICsgaWxsdXN0SWQpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpTG9nLmUoJ0NhbiBub3QgZm91bmQgaWxsdXN0IGlkIScpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkLmFqYXgoZ19nZXRVZ29pcmFVcmwucmVwbGFjZSgnI2lkIycsIGlsbHVzdElkKSwgewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5kKGpzb24pOwoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGpzb24uZXJyb3IgPT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5lKCdTZXJ2ZXIgcmVzcG9uc2UgYW4gZXJyb3I6ICcgKyBqc29uLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAvLyDlm6DkuLrmtY/op4jlmajkvJrmi6bmiKrkuI3lkIzln5/nmoQgb3BlbiDmk43kvZzvvIznu5XkuIDkuIsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5ld1dpbmRvdyA9IHdpbmRvdy5vcGVuKCdfYmxhbmsnKTsKICAgICAgICAgICAgICAgICAgICAgICAgbmV3V2luZG93LmxvY2F0aW9uID0ganNvbi5ib2R5Lm9yaWdpbmFsU3JjOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5lKCdSZXF1ZXN0IHppcCBmaWxlIGZhaWxlZCEnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5wcml2YXRlLm5lZWRQcm9jZXNzKSB7CiAgICAgICAgICAgIGxldCBjYW52YXMgPSAkKCcucHAtY2FudmFzJyk7CiAgICAgICAgICAgIC8vIOaZrumAmuaooeW8j++8jOWPqumcgOimgea3u+WKoOS4i+i9veaMiemSruWIsOWGheW1jOaooeW8j+eahCBkaXYg6YeMCiAgICAgICAgICAgIGxldCBkaXYgPSAkKCdkaXZbcm9sZT0icHJlc2VudGF0aW9uIl06bGFzdCcpOwogICAgICAgICAgICBsZXQgYnV0dG9uID0gZGl2LmZpbmQoJ2J1dHRvbicpOwoKICAgICAgICAgICAgbGV0IGhlYWRlclJlYWxIZWlnaHQgPSBwYXJzZUludCgkKCdoZWFkZXInKS5jc3MoJ2hlaWdodCcpKSArCiAgICAgICAgICAgICAgICBwYXJzZUludCgkKCdoZWFkZXInKS5jc3MoJ3BhZGRpbmctdG9wJykpICsgcGFyc2VJbnQoJCgnaGVhZGVyJykuY3NzKCdwYWRkaW5nLWJvdHRvbScpKSArCiAgICAgICAgICAgICAgICBwYXJzZUludCgkKCdoZWFkZXInKS5jc3MoJ21hcmdpbi10b3AnKSkgKyBwYXJzZUludCgkKCdoZWFkZXInKS5jc3MoJ21hcmdpbi1ib3R0b20nKSkgKwogICAgICAgICAgICAgICAgcGFyc2VJbnQoJCgnaGVhZGVyJykuY3NzKCdib3JkZXItYm90dG9tLXdpZHRoJykpICsgcGFyc2VJbnQoJCgnaGVhZGVyJykuY3NzKCdib3JkZXItdG9wLXdpZHRoJykpOwoKICAgICAgICAgICAgQWRkRG93bmxvYWRCdXR0b24oYnV0dG9uLCBoZWFkZXJSZWFsSGVpZ2h0KTsKICAgICAgICB9CiAgICB9LAogICAgcHJpdmF0ZTogewogICAgICAgIG5lZWRQcm9jZXNzOiBmYWxzZSwKICAgICAgICByZXR1cm5NYXA6IG51bGwsCiAgICB9LAp9OwpQYWdlc1tQYWdlVHlwZS5Ob3ZlbFNlYXJjaF0gPSB7CiAgICBQYWdlVHlwZVN0cmluZzogJ05vdmVsU2VhcmNoUGFnZScsCiAgICBDaGVja1VybDogZnVuY3Rpb24gKHVybCkgewogICAgICAgIHJldHVybiAvXmh0dHBzOlwvXC93d3cucGl4aXYubmV0XC90YWdzXC8uKlwvbm92ZWxzLy50ZXN0KHVybCkgfHwKICAgICAgICAgICAgL15odHRwczpcL1wvd3d3LnBpeGl2Lm5ldFwvZW5cL3RhZ3NcLy4qXC9ub3ZlbHMvLnRlc3QodXJsKTsKICAgIH0sCiAgICBQcm9jZXNzUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgbGV0IHJldHVybk1hcCA9IHsKICAgICAgICAgICAgbG9hZGluZ0NvbXBsZXRlOiBmYWxzZSwKICAgICAgICAgICAgY29udHJvbEVsZW1lbnRzOiBbXSwKICAgICAgICB9OwogICAgICAgIGxldCB1bCA9ICQoJ3NlY3Rpb246Zmlyc3QnKS5maW5kKCd1bDpmaXJzdCcpOwogICAgICAgIGlmICh1bC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHJldHVybk1hcC5sb2FkaW5nQ29tcGxldGUgPSB0cnVlOwogICAgICAgIH0KICAgICAgICB0aGlzLnByaXZhdGUucmV0dXJuTWFwID0gcmV0dXJuTWFwOwogICAgICAgIHJldHVybiByZXR1cm5NYXA7CiAgICB9LAogICAgR2V0UHJvY2Vzc2VkUGFnZUVsZW1lbnRzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5Qcm9jZXNzUGFnZUVsZW1lbnRzKCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0aGlzLnByaXZhdGUucmV0dXJuTWFwOwogICAgfSwKICAgIEdldFRvb2xCYXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gZmluZFRvb2xiYXJDb21tb24oKTsKICAgIH0sCiAgICBHZXRQYWdlU2VsZWN0b3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gJCgnc2VjdGlvbjpmaXJzdCcpLmZpbmQoJ25hdjpmaXJzdCcpOwogICAgfSwKICAgIEhhc0F1dG9Mb2FkOiBmYWxzZSwKICAgIHByaXZhdGU6IHsKICAgICAgICByZXR1cm5NYXA6IG51bGwsCiAgICB9LAp9ClBhZ2VzW1BhZ2VUeXBlLlNlYXJjaFRvcF0gPSB7CiAgICBQYWdlVHlwZVN0cmluZzogJ1NlYXJjaFRvcFBhZ2UnLAogICAgQ2hlY2tVcmw6IGZ1bmN0aW9uICh1cmwpIHsKICAgICAgICByZXR1cm4gL15odHRwcz86XC9cL3d3dy5waXhpdi5uZXQoXC9lbik/XC90YWdzXC9bXi8qXS8udGVzdCh1cmwpOwogICAgfSwKICAgIFByb2Nlc3NQYWdlRWxlbWVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBsZXQgcmV0dXJuTWFwID0gewogICAgICAgICAgICBsb2FkaW5nQ29tcGxldGU6IGZhbHNlLAogICAgICAgICAgICBjb250cm9sRWxlbWVudHM6IFtdLAogICAgICAgIH07CgogICAgICAgIGxldCBzZWN0aW9ucyA9ICQoJ3NlY3Rpb24nKTsKICAgICAgICBpTG9nLmQoJ1BhZ2UgaGFzICcgKyBzZWN0aW9ucy5sZW5ndGggKyAnIDxzZWN0aW9uPi4nKTsKICAgICAgICBpTG9nLmQoc2VjdGlvbnMpOwoKICAgICAgICBsZXQgcHJlbWl1bVNlY3Rpb25JbmRleCA9IC0xOwogICAgICAgIGxldCByZXN1bHRTZWN0aW9uSW5kZXggPSAwOwogICAgICAgIGlmIChzZWN0aW9ucy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICBpTG9nLmUoJ05vIHN1aXRhYmxlIDxzZWN0aW9uPiEnKTsKICAgICAgICAgICAgcmV0dXJuIHJldHVybk1hcDsKICAgICAgICB9CgogICAgICAgIGlmIChzZWN0aW9ucy5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgIHByZW1pdW1TZWN0aW9uSW5kZXggPSAwOwogICAgICAgICAgICByZXN1bHRTZWN0aW9uSW5kZXggPSAxOwogICAgICAgIH0KCiAgICAgICAgaUxvZy52KCdwcmVtaXVtOiAnICsgcHJlbWl1bVNlY3Rpb25JbmRleCk7CiAgICAgICAgaUxvZy52KCdyZXN1bHQ6ICcgKyByZXN1bHRTZWN0aW9uSW5kZXgpOwoKICAgICAgICBsZXQgdWwgPSAkKHNlY3Rpb25zW3Jlc3VsdFNlY3Rpb25JbmRleF0pLmZpbmQoJ3VsJyk7CiAgICAgICAgbGV0IGxpcyA9IHVsLmZpbmQoJ2xpJykudG9BcnJheSgpOwogICAgICAgIGlmIChwcmVtaXVtU2VjdGlvbkluZGV4ICE9IC0xKSB7CiAgICAgICAgICAgIGxldCBsaXMyID0gJChzZWN0aW9uc1twcmVtaXVtU2VjdGlvbkluZGV4XSkuZmluZCgndWwnKS5maW5kKCdsaScpOwogICAgICAgICAgICBsaXMgPSBsaXMuY29uY2F0KGxpczIudG9BcnJheSgpKTsKICAgICAgICB9CgogICAgICAgIGlmIChwcmVtaXVtU2VjdGlvbkluZGV4ICE9IC0xKSB7CiAgICAgICAgICAgIGxldCBhc2lkZSA9ICQoc2VjdGlvbnNbcHJlbWl1bVNlY3Rpb25JbmRleF0pLmZpbmQoJ2FzaWRlJyk7CiAgICAgICAgICAgICQuZWFjaChhc2lkZS5jaGlsZHJlbigpLCAoaSwgZSkgPT4gewogICAgICAgICAgICAgICAgaWYgKGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9ICd1bCcpIHsKICAgICAgICAgICAgICAgICAgICBlLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkKGUpLmNzcygnLXdlYmtpdC1tYXNrJywgJzAnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGFzaWRlLm5leHQoKS5yZW1vdmUoKTsKICAgICAgICB9CgogICAgICAgIHByb2Nlc3NFbGVtZW50TGlzdENvbW1vbihsaXMpOwogICAgICAgIHJldHVybk1hcC5jb250cm9sRWxlbWVudHMgPSAkKCcucHAtY29udHJvbCcpOwogICAgICAgIHRoaXMucHJpdmF0ZS5wYWdlU2VsZWN0b3IgPSB1bC5uZXh0KCkuZ2V0KDApOwogICAgICAgIC8vIGZpeDog6Zmk5LqG4oCc6aG26YOo4oCd77yM4oCc5o+S55S74oCd44CB4oCc5ryr55S74oCd55qE6aG16YCJ5oup5Zmo5oyq5Yiw5LqG5aSW6Z2i77yM5YW85a656L+Z56eN5oOF5Ya1CiAgICAgICAgaWYgKHRoaXMucHJpdmF0ZS5wYWdlU2VsZWN0b3IgPT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLnByaXZhdGUucGFnZVNlbGVjdG9yID0gdWwucGFyZW50KCkubmV4dCgpLmdldCgwKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuTWFwLmxvYWRpbmdDb21wbGV0ZSA9IHRydWU7CiAgICAgICAgdGhpcy5wcml2YXRlLmltYWdlTGlzdENvbnJhaW5lciA9IHVsLmdldCgwKTsKCiAgICAgICAgaUxvZy5kKCdQcm9jZXNzIHBhZ2UgZWxlbWVudHMgY29tcGxldGUuJyk7CiAgICAgICAgaUxvZy5kKHJldHVybk1hcCk7CgogICAgICAgIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXAgPSByZXR1cm5NYXA7CiAgICAgICAgcmV0dXJuIHJldHVybk1hcDsKICAgIH0sCiAgICBHZXRQcm9jZXNzZWRQYWdlRWxlbWVudHM6IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGhpcy5wcml2YXRlLnJldHVybk1hcCA9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiB0aGlzLlByb2Nlc3NQYWdlRWxlbWVudHMoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRoaXMucHJpdmF0ZS5yZXR1cm5NYXA7CiAgICB9LAogICAgR2V0VG9vbEJhcjogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBmaW5kVG9vbGJhckNvbW1vbigpOwogICAgfSwKICAgIC8vIOaQnOe0oumhteaciSBsYXp5bG9hZO+8jOS4jeW8gOaOkuW6j+eahOaDheWGteS4i++8jOacgOWQjuWHoOW8oOWbvueJh+WPr+iDveS8muaXoOazlemihOiniOOAgui/memHjOaKiuWug+W9k+WBmuiHquWKqOWKoOi9veWkhOeQhgogICAgSGFzQXV0b0xvYWQ6IGZhbHNlLAogICAgR2V0SW1hZ2VMaXN0Q29udGFpbmVyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHRoaXMucHJpdmF0ZS5pbWFnZUxpc3RDb25yYWluZXI7CiAgICB9LAogICAgR2V0Rmlyc3RJbWFnZUVsZW1lbnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gJCh0aGlzLnByaXZhdGUuaW1hZ2VMaXN0Q29ucmFpbmVyKS5maW5kKCdsaScpLmdldCgwKTsKICAgIH0sCiAgICBHZXRQYWdlU2VsZWN0b3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gdGhpcy5wcml2YXRlLnBhZ2VTZWxlY3RvcjsKICAgIH0sCiAgICBwcml2YXRlOiB7CiAgICAgICAgaW1hZ2VMaXN0Q29udGFpbmVyOiBudWxsLAogICAgICAgIHBhZ2VTZWxlY3RvcjogbnVsbCwKICAgICAgICByZXR1cm5NYXA6IG51bGwsCiAgICB9LAp9OwoKZnVuY3Rpb24gQ2hlY2tVcmxUZXN0KCkgewogICAgbGV0IHVybHMgPSBbCiAgICAgICAgJ2h0dHA6Ly93d3cucGl4aXYubmV0JywKICAgICAgICAnaHR0cDovL3d3dy5waXhpdi5uZXQnLAogICAgICAgICdodHRwczovL3d3dy5waXhpdi5uZXQnLAogICAgICAgICdodHRwczovL3d3dy5waXhpdi5uZXQvJywKICAgICAgICAnaHR0cHM6Ly93d3cucGl4aXYubmV0Lz9sYW5nPWVuJywKICAgICAgICAnaHR0cHM6Ly93d3cucGl4aXYubmV0L3NlYXJjaC5waHA/c19tb2RlPXNfdGFnJndvcmQ9bWlrdScsCiAgICAgICAgJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC9zZWFyY2gucGhwP3dvcmQ9Vk9DQUxPSUQmc19tb2RlPXNfdGFnX2Z1bGwnLAogICAgICAgICdodHRwczovL3d3dy5waXhpdi5uZXQvZGlzY292ZXJ5JywKICAgICAgICAnaHR0cHM6Ly93d3cucGl4aXYubmV0L2Rpc2NvdmVyeT94PTEnLAogICAgICAgICdodHRwczovL3d3dy5waXhpdi5uZXQvbWVtYmVyLnBocD9pZD0zMjA3MzUwJywKICAgICAgICAnaHR0cHM6Ly93d3cucGl4aXYubmV0L21lbWJlcl9pbGx1c3QucGhwP2lkPTMyMDczNTAmdHlwZT1pbGx1c3QnLAogICAgICAgICdodHRwczovL3d3dy5waXhpdi5uZXQvYm9va21hcmsucGhwP2lkPTMyMDczNTAmcmVzdD1zaG93JywKICAgICAgICAnaHR0cHM6Ly93d3cucGl4aXYubmV0L3JhbmtpbmcucGhwP21vZGU9ZGFpbHkmY29udGVudD11Z29pcmEnLAogICAgICAgICdodHRwczovL3d3dy5waXhpdi5uZXQvcmFua2luZy5waHA/bW9kZT1kYWlseScsCiAgICAgICAgJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC9uZXdfaWxsdXN0LnBocCcsCiAgICAgICAgJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC9uZXdfaWxsdXN0LnBocD94PTEnLAogICAgICAgICdodHRwczovL3d3dy5waXhpdi5uZXQvY2F0ZV9yMTgucGhwJywKICAgICAgICAnaHR0cHM6Ly93d3cucGl4aXYubmV0L2NhdGVfcjE4LnBocD94PTEnLAogICAgICAgICdodHRwczovL3d3dy5waXhpdi5uZXQvYm9va21hcmsucGhwJywKICAgICAgICAnaHR0cHM6Ly93d3cucGl4aXYubmV0L2Jvb2ttYXJrLnBocD94PTEnLAogICAgICAgICdodHRwczovL3d3dy5waXhpdi5uZXQvc3RhY2M/bW9kZT11bmlmeScsCiAgICAgICAgJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC9hcnR3b3Jrcy83Nzk5Njc3MycsCiAgICAgICAgJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC9hcnR3b3Jrcy83Nzk5Njc3MyNwcmV2aWV3JywKICAgICAgICAnaHR0cHM6Ly93d3cucGl4aXYubmV0L3RhZ3MvbWlrdS9ub3ZlbHMnLAogICAgXTsKCiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHVybHMubGVuZ3RoOyBqKyspIHsKICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IFBhZ2VUeXBlLlBhZ2VUeXBlQ291bnQ7IGkrKykgewogICAgICAgICAgICBpZiAoUGFnZXNbaV0uQ2hlY2tVcmwodXJsc1tqXSkpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHVybHNbal0pOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1snICsgaiArICddIGlzICcgKyBQYWdlc1tpXS5QYWdlVHlwZVN0cmluZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBzY3JvbGxfbG9jayAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCmZ1bmN0aW9uIHByZXZlbnREZWZhdWx0KGUpIHsKICAgIGUucHJldmVudERlZmF1bHQoKTsKfQoKY29uc3Qgd2hlZWxPcHQgPSB7IHBhc3NpdmU6IGZhbHNlIH07CmNvbnN0IHdoZWVsRXZlbnQgPSAnb253aGVlbCcgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykgPyAnd2hlZWwnIDogJ21vdXNld2hlZWwnOwoKZnVuY3Rpb24gZGlzYWJsZVNjcm9sbCgpIHsKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKHdoZWVsRXZlbnQsIHByZXZlbnREZWZhdWx0LCB3aGVlbE9wdCk7Cn0KZnVuY3Rpb24gZW5hYmxlU2Nyb2xsKCkgewogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIod2hlZWxFdmVudCwgcHJldmVudERlZmF1bHQsIHdoZWVsT3B0KTsKfQoKLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSDphY3nva4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwpmdW5jdGlvbiBnbWNCdWlsZEZyYW1lKCkgewogICAgaUxvZy5kKCdnbWNCdWlsZEZyYW1lKCknKTsKCiAgICBsZXQgZGl2ID0gJCgnPGRpdiBpZD0iZ21jIiBjbGFzcz0iaGlkZGVuIj48L2Rpdj4nKTsKICAgIGxldCBmcmFtZSA9ICQoJzxkaXYgaWQ9ImdtYy1mcmFtZSI+PC9kaXY+Jyk7CiAgICBkaXYuYXBwZW5kKGZyYW1lKTsKICAgICQoJ2JvZHknKS5hcHBlbmQoZGl2KTsKCiAgICBnbWNCdWlsZFN0eWxlKCk7CgogICAgcmV0dXJuIGZyYW1lLmdldCgwKTsKfQpmdW5jdGlvbiBnbWNCdWlsZFN0eWxlKCkgewogICAgaUxvZy5kKCdnbWNCdWlsZFN0eWxlKCknKTsKCiAgICBjb25zdCBnbWNGcmFtZVN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgIGdtY0ZyYW1lU3R5bGUudGV4dENvbnRlbnQgKz0gYAogICAgICAvKiBNb2RhbCAqLwoKICAgICAgI2dtYwogICAgICB7CiAgICAgICAgZGlzcGxheTogaW5saW5lLWZsZXggIWltcG9ydGFudDsKICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlciAhaW1wb3J0YW50OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIgIWltcG9ydGFudDsKICAgICAgICBwb3NpdGlvbjogZml4ZWQgIWltcG9ydGFudDsKICAgICAgICB0b3A6IDAgIWltcG9ydGFudDsKICAgICAgICBsZWZ0OiAwICFpbXBvcnRhbnQ7CiAgICAgICAgd2lkdGg6IDEwMHZ3ICFpbXBvcnRhbnQ7CiAgICAgICAgaGVpZ2h0OiAxMDB2aCAhaW1wb3J0YW50OwogICAgICAgIHotaW5kZXg6IDk5OTk7CiAgICAgICAgYmFja2dyb3VuZDogbm9uZSAhaW1wb3J0YW50OwoKICAgICAgICBwb2ludGVyLWV2ZW50czogbm9uZTsKICAgICAgfQoKICAgICAgI2dtYy5oaWRkZW4KICAgICAgewogICAgICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZQogICAgICB7CiAgICAgICAgZm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sQmxpbmtNYWNTeXN0ZW1Gb250LCJTZWdvZSBVSSIsIk5vdG8gU2FucyIsSGVsdmV0aWNhLEFyaWFsLHNhbnMtc2VyaWYsIkFwcGxlIENvbG9yIEVtb2ppIiwiU2Vnb2UgVUkgRW1vamkiOwogICAgICAgIHRleHQtYWxpZ246IGxlZnQ7CgogICAgICAgIGluc2V0OiBpbml0aWFsICFpbXBvcnRhbnQ7CiAgICAgICAgYm9yZGVyOiBub25lICFpbXBvcnRhbnQ7CiAgICAgICAgbWF4LWhlaWdodDogaW5pdGlhbCAhaW1wb3J0YW50OwogICAgICAgIG1heC13aWR0aDogaW5pdGlhbCAhaW1wb3J0YW50OwogICAgICAgIG9wYWNpdHk6IDEgIWltcG9ydGFudDsKICAgICAgICBwb3NpdGlvbjogc3RhdGljICFpbXBvcnRhbnQ7CiAgICAgICAgei1pbmRleDogaW5pdGlhbCAhaW1wb3J0YW50OwoKICAgICAgICB3aWR0aDogODUlICFpbXBvcnRhbnQ7CiAgICAgICAgaGVpZ2h0OiA3NSUgIWltcG9ydGFudDsKICAgICAgICBvdmVyZmxvdy15OiBhdXRvICFpbXBvcnRhbnQ7CgogICAgICAgIGJvcmRlcjogbm9uZSAhaW1wb3J0YW50OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDAuMzc1cmVtICFpbXBvcnRhbnQ7CgogICAgICAgIHBvaW50ZXItZXZlbnRzOiBhdXRvOwogICAgICB9CgogICAgICAjZ21jLWZyYW1lX3dyYXBwZXIKICAgICAgewogICAgICAgIGRpc3BsYXk6IGZsb3ctcm9vdCAhaW1wb3J0YW50OwogICAgICAgIHBhZGRpbmc6IDJyZW0gIWltcG9ydGFudDsKICAgICAgfQoKICAgICAgLyogU2VjdGlvbnMgKi8KCiAgICAgICNnbWMtZnJhbWUgI2dtYy1mcmFtZV9zZWN0aW9uXzAKICAgICAgewogICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDsKICAgICAgICBkaXNwbGF5OiB0YWJsZTsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NlY3Rpb25fMSwKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NlY3Rpb25fMiwKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NlY3Rpb25fMywKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NlY3Rpb25fNAogICAgICB7CiAgICAgICAgbWFyZ2luLXRvcDogMnJlbTsKICAgICAgICB3aWR0aDogNDklOwogICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgI2dtYy1mcmFtZV9zZWN0aW9uXzEKICAgICAgewogICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDsKICAgICAgICBmbG9hdDogbGVmdDsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NlY3Rpb25fMgogICAgICB7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgIGZsb2F0OiByaWdodDsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NlY3Rpb25fMwogICAgICB7CiAgICAgICAgd2lkdGg6IDQ5JTsKICAgICAgICBtYXJnaW4tdG9wOiAycmVtOwogICAgICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICAgIGZsb2F0OiBsZWZ0OwogICAgICB9CgogICAgICAjZ21jLWZyYW1lICNnbWMtZnJhbWVfc2VjdGlvbl80CiAgICAgIHsKICAgICAgICBkaXNwbGF5OiBpbmxpbmUtZ3JpZDsKICAgICAgICB3aWR0aDogNDklOwogICAgICAgIG1hcmdpbi10b3A6IDJyZW07CiAgICAgICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICAgICAgZmxvYXQ6IHJpZ2h0CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgI2dtYy1mcmFtZV9zZWN0aW9uXzMgLmNvbmZpZ192YXI6bm90KDpsYXN0LWNoaWxkKSwKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NlY3Rpb25fNCAuY29uZmlnX3Zhcjpub3QoOmxhc3QtY2hpbGQpCiAgICAgIHsKICAgICAgICBwYWRkaW5nLWJvdHRvbTogMXJlbTsKICAgICAgfQoKICAgICAgLyogRmllbGRzICovCgogICAgICAjZ21jLWZyYW1lIC5jb25maWdfaGVhZGVyCiAgICAgIHsKICAgICAgICBmb250LXNpemU6IDJlbTsKICAgICAgICBmb250LXdlaWdodDogNDAwOwogICAgICAgIGxpbmUtaGVpZ2h0OiAxLjI1OwoKICAgICAgICBwYWRkaW5nLWJvdHRvbTogMC4zZW07CiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTZweDsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3R5cGVfdmFyCiAgICAgIHsKICAgICAgICBkaXNwbGF5OiBpbmxpbmUtZmxleDsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAuc2VjdGlvbl9oZWFkZXIKICAgICAgewogICAgICAgIGZvbnQtc2l6ZTogMS41ZW07CiAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICBsaW5lLWhlaWdodDogMS4yNTsKCiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTZweDsKICAgICAgICBwYWRkaW5nOiAxcmVtIDEuNXJlbTsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAuc2VjdGlvbl9kZXNjLAogICAgICAjZ21jLWZyYW1lIGgzCiAgICAgIHsKICAgICAgICBiYWNrZ3JvdW5kOiBub25lOwogICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICBmb250LXNpemU6IDEuMjVlbTsKCiAgICAgICAgbWFyZ2luLWJvdHRvbTogMTZweDsKICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgIGxpbmUtaGVpZ2h0OiAxLjI1OwogICAgICAgIHRleHQtYWxpZ246IGxlZnQ7CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgLmNvbmZpZ192YXIKICAgICAgewogICAgICAgIHBhZGRpbmc6IDByZW0gMS41cmVtOwogICAgICAgIG1hcmdpbi1ib3R0b206IDFyZW07CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAuY29uZmlnX3ZhcltpZCo9J2ZsaXBDcmVhdGVJbmJveF92YXInXSwKICAgICAgI2dtYy1mcmFtZSAuY29uZmlnX3ZhcltpZCo9J2ZsaXBJc3N1ZXNQdWxsUmVxdWVzdHNfdmFyJ10KICAgICAgewogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgLmZpZWxkX2xhYmVsCiAgICAgIHsKICAgICAgICBmb250LXdlaWdodDogNjAwOwogICAgICAgIG1hcmdpbi1yaWdodDogMC41cmVtOwogICAgICB9CgogICAgICAjZ21jLWZyYW1lIC5maWVsZF9sYWJlbCwKICAgICAgI2dtYy1mcmFtZSAuZ21jLWxhYmVsCiAgICAgIHsKICAgICAgICB3aWR0aDogMTV2dzsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAucmFkaW9fbGFiZWw6bm90KDpsYXN0LWNoaWxkKQogICAgICB7CiAgICAgICAgbWFyZ2luLXJpZ2h0OiA0cmVtOwogICAgICB9CgogICAgICAjZ21jLWZyYW1lIC5yYWRpb19sYWJlbAogICAgICB7CiAgICAgICAgbGluZS1oZWlnaHQ6IDE3cHg7CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgLmdtYy1sYWJlbAogICAgICB7CiAgICAgICAgZGlzcGxheTogdGFibGUtY2FwdGlvbjsKICAgICAgICBsaW5lLWhlaWdodDogMTdweDsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSBpbnB1dFt0eXBlPSJyYWRpbyJdCiAgICAgIHsKICAgICAgICBhcHBlYXJhbmNlOiBub25lOwogICAgICAgIGJvcmRlci1zdHlsZTogc29saWQ7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIGhlaWdodDogMXJlbTsKICAgICAgICBwbGFjZS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgIHdpZHRoOiAxcmVtOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDYyNHJlbTsKICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDBzIGVhc2UgMHMsIGJvcmRlci1jb2xvciA4MG1zIGN1YmljLWJlemllcigwLjMzLCAxLCAwLjY4LCAxKSAwczsKICAgICAgICBtYXJnaW4tcmlnaHQ6IDAuNXJlbTsKICAgICAgICBmbGV4OiBub25lOwogICAgICB9CgogICAgICAjZ21jLWZyYW1lIGlucHV0W3R5cGU9ImNoZWNrYm94Il0KICAgICAgewogICAgICAgIGFwcGVhcmFuY2U6IG5vbmU7CiAgICAgICAgYm9yZGVyLXN0eWxlOiBzb2xpZDsKICAgICAgICBib3JkZXItd2lkdGg6IDFweDsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgcGxhY2UtY29udGVudDogY2VudGVyOwogICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICBoZWlnaHQ6IDE3cHg7CiAgICAgICAgd2lkdGg6IDE3cHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogM3B4OwogICAgICAgIHRyYW5zaXRpb246IGJhY2tncm91bmQtY29sb3IgMHMgZWFzZSAwcywgYm9yZGVyLWNvbG9yIDgwbXMgY3ViaWMtYmV6aWVyKDAuMzMsIDEsIDAuNjgsIDEpIDBzOwogICAgICB9CgogICAgICAjZ21jLWZyYW1lICNnbWMtZnJhbWVfZmllbGRfdHlwZQogICAgICB7CiAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSBpbnB1dFt0eXBlPSJyYWRpbyJdOmNoZWNrZWQKICAgICAgewogICAgICAgIGJvcmRlci13aWR0aDogMC4yNXJlbTsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSBpbnB1dFt0eXBlPSJyYWRpbyJdOmNoZWNrZWQsCiAgICAgICNnbWMtZnJhbWUgLmdtYy1jaGVja2JveDpjaGVja2VkCiAgICAgIHsKICAgICAgICBib3JkZXItY29sb3I6ICMyZjgxZjc7CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgLmdtYy1jaGVja2JveDpjaGVja2VkCiAgICAgIHsKICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMmY4MWY3OwogICAgICB9CgogICAgICAjZ21jLWZyYW1lIC5nbWMtY2hlY2tib3g6Y2hlY2tlZDo6YmVmb3JlCiAgICAgIHsKICAgICAgICB2aXNpYmlsaXR5OiB2aXNpYmxlOwogICAgICAgIHRyYW5zaXRpb246IHZpc2liaWxpdHkgMHMgbGluZWFyIDBzOwogICAgICB9CgogICAgICAjZ21jLWZyYW1lIC5nbWMtY2hlY2tib3g6OmJlZm9yZSwKICAgICAgI2dtYy1mcmFtZSAuZ21jLWNoZWNrYm94OmluZGV0ZXJtaW5hdGU6OmJlZm9yZQogICAgICB7CiAgICAgICAgYW5pbWF0aW9uOiA4MG1zIGN1YmljLWJlemllcigwLjY1LCAwLCAwLjM1LCAxKSA4MG1zIDEgbm9ybWFsIGZvcndhcmRzIHJ1bm5pbmcgY2hlY2ttYXJrSW47CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgLmdtYy1jaGVja2JveDo6YmVmb3JlCiAgICAgIHsKICAgICAgICB3aWR0aDogMXJlbTsKICAgICAgICBoZWlnaHQ6IDFyZW07CiAgICAgICAgdmlzaWJpbGl0eTogaGlkZGVuOwogICAgICAgIGNvbnRlbnQ6ICIiOwogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGRkZGRkY7CiAgICAgICAgY2xpcC1wYXRoOiBpbnNldCgwKTsKICAgICAgICAtd2Via2l0LW1hc2staW1hZ2U6IHVybCgiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCM2FXUjBhRDBpTVRJaUlHaGxhV2RvZEQwaU9TSWdkbWxsZDBKdmVEMGlNQ0F3SURFeUlEa2lJR1pwYkd3OUltNXZibVVpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrQ2p4d1lYUm9JR1pwYkd3dGNuVnNaVDBpWlhabGJtOWtaQ0lnWTJ4cGNDMXlkV3hsUFNKbGRtVnViMlJrSWlCa1BTSk5NVEV1Tnpnd015QXdMakl4T1RZeU5VTXhNUzQ1TWpFZ01DNHpOakEwTWpjZ01USWdNQzQxTlRFek1EVWdNVElnTUM0M05UQXpNVE5ETVRJZ01DNDVORGt6TWpFZ01URXVPVEl4SURFdU1UUXdNVGtnTVRFdU56Z3dNeUF4TGpJNE1VdzBMalV4T0RZZ09DNDFOREEwTWtNMExqTTNOemMxSURndU5qZ3hJRFF1TVRnMk9ESWdPQzQzTmlBekxqazROemMwSURndU56WkRNeTQzT0RnMk55QTRMamMySURNdU5UazNOek1nT0M0Mk9ERWdNeTQwTlRZNE9TQTRMalUwTURReVREQXVNakF4TmpJeUlEVXVNamcyTWtNd0xqQTJPRGt5TnpjZ05TNHhORE00TXlBdE1DNHdNRE16TURrd05TQTBMamsxTlRVMUlEQXVNREF3TVRFMk5Ea3pJRFF1TnpZd09UaERNQzR3TURNMU5USXdOU0EwTGpVMk5qUXpJREF1TURneU16ZzVOQ0EwTGpNNE1EZ3hJREF1TWpJd01ETXlJRFF1TWpRek1qRkRNQzR6TlRjMk5qVWdOQzR4TURVMk1pQXdMalUwTXpNMU5TQTBMakF5TmpneElEQXVOek0zT1RjZ05DNHdNak16T0VNd0xqa3pNalU0TkNBMExqQXhPVGswSURFdU1USXdPVE1nTkM0d09USXhOeUF4TGpJMk16TTBJRFF1TWpJME9ESk1NeTQ1T0RjM05DQTJMamswT0RNMVRERXdMamN4T0RZZ01DNHlNVGsyTWpWRE1UQXVPRFU1TlNBd0xqQTNPRGs1TWpNZ01URXVNRFV3TkNBd0lERXhMakkwT1RVZ01FTXhNUzQwTkRnMUlEQWdNVEV1TmpNNU5TQXdMakEzT0RrNU1qTWdNVEV1Tnpnd015QXdMakl4T1RZeU5Wb2lJR1pwYkd3OUluZG9hWFJsSWk4K0Nqd3ZjM1puUGdvPSIpOwogICAgICAgIC13ZWJraXQtbWFzay1zaXplOiA3NSU7CiAgICAgICAgLXdlYmtpdC1tYXNrLXJlcGVhdDogbm8tcmVwZWF0OwogICAgICAgIC13ZWJraXQtbWFzay1wb3NpdGlvbjogY2VudGVyIGNlbnRlcjsKICAgICAgICBkaXNwbGF5OiBibG9jazsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAuZ21jLWNoZWNrYm94CiAgICAgIHsKICAgICAgICBhcHBlYXJhbmNlOiBub25lOwogICAgICAgIGJvcmRlci1zdHlsZTogc29saWQ7CiAgICAgICAgYm9yZGVyLXdpZHRoOiAxcHg7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwoKICAgICAgICBoZWlnaHQ6IHZhcigtLWJhc2Utc2l6ZS0xNiwxNnB4KTsKICAgICAgICBtYXJnaW46IDAuMTI1cmVtIDBweCAwcHg7CiAgICAgICAgcGxhY2UtY29udGVudDogY2VudGVyOwogICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKICAgICAgICB3aWR0aDogdmFyKC0tYmFzZS1zaXplLTE2LDE2cHgpOwogICAgICAgIGJvcmRlci1yYWRpdXM6IDNweDsKICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDBzIGVhc2UgMHMsIGJvcmRlci1jb2xvciA4MG1zIGN1YmljLWJlemllcigwLjMzLCAxLCAwLjY4LCAxKSAwczsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSBpbnB1dAogICAgICB7CiAgICAgICAgY29sb3I6IGZpZWxkdGV4dDsKICAgICAgICBsZXR0ZXItc3BhY2luZzogbm9ybWFsOwogICAgICAgIHdvcmQtc3BhY2luZzogbm9ybWFsOwogICAgICAgIHRleHQtdHJhbnNmb3JtOiBub25lOwogICAgICAgIHRleHQtaW5kZW50OiAwcHg7CiAgICAgICAgdGV4dC1zaGFkb3c6IG5vbmU7CiAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgICAgIHRleHQtYWxpZ246IHN0YXJ0OwogICAgICAgIGFwcGVhcmFuY2U6IGF1dG87CiAgICAgICAgLXdlYmtpdC1ydGwtb3JkZXJpbmc6IGxvZ2ljYWw7CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgLmdtYy1jaGVja2JveDpjaGVja2VkCiAgICAgIHsKICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDBzIGVhc2UgMHMsIGJvcmRlci1jb2xvciA4MG1zIGN1YmljLWJlemllcigwLjMyLCAwLCAwLjY3LCAwKSAwbXM7CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgaW5wdXRbdHlwZT0idGV4dCJdLAogICAgICAjZ21jLWZyYW1lIHRleHRhcmVhLAogICAgICAjZ21jLWZyYW1lIHNlbGVjdAogICAgICB7CiAgICAgICAgcGFkZGluZzogNXB4IDEycHg7CiAgICAgICAgYm9yZGVyLXJhZGl1czogNnB4OwogICAgICB9CgogICAgICAjZ21jLWZyYW1lIGlucHV0W3R5cGU9InRleHQiXTpmb2N1cywKICAgICAgI2dtYy1mcmFtZSB0ZXh0YXJlYTpmb2N1cywKICAgICAgI2dtYy1mcmFtZSBzZWxlY3Q6Zm9jdXMKICAgICAgewogICAgICAgIGJvcmRlci1jb2xvcjogIzJmODFmNzsKICAgICAgICBvdXRsaW5lOiAxcHggc29saWQgIzJmODFmNzsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSBzdmcKICAgICAgewogICAgICAgIGhlaWdodDogMTdweDsKICAgICAgICB3aWR0aDogMTdweDsKICAgICAgICBtYXJnaW4tbGVmdDogMC41cmVtOwogICAgICB9CgogICAgICAjZ21jIHNtYWxsCiAgICAgIHsKICAgICAgICBmb250LXNpemU6IHgtc21hbGw7CiAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDsKICAgICAgICBtYXJnaW4tbGVmdDogM3B4OwogICAgICB9CgogICAgICAvKiBCdXR0b24gYmFyICovCgogICAgICAjZ21jLWZyYW1lICNnbWMtZnJhbWVfYnV0dG9uc19ob2xkZXIKICAgICAgewogICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICB3aWR0aDogODUlOwogICAgICAgIHRleHQtYWxpZ246IHJpZ2h0OwoKICAgICAgICBsZWZ0OiA1MCU7CiAgICAgICAgYm90dG9tOiAyJTsKICAgICAgICB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAwJSk7CiAgICAgICAgcGFkZGluZzogMXJlbTsKCiAgICAgICAgYm9yZGVyLXJhZGl1czogMC4zNzVyZW07CgogICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX2J1dHRvbnNfaG9sZGVyIC5sZWZ0LWFsaWduZWQKICAgICAgewogICAgICAgIG9yZGVyOiAxOwogICAgICAgIG1hcmdpbi1yaWdodDogYXV0bzsKICAgICAgfQoKICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX2J1dHRvbnNfaG9sZGVyID4gKgogICAgICB7CiAgICAgICAgb3JkZXI6IDI7CiAgICAgIH0KCiAgICAgICNnbWMtZnJhbWUgLnNhdmVjbG9zZV9idXR0b25zCiAgICAgIHsKICAgICAgICBtYXJnaW4tbGVmdDogMC41cmVtOwogICAgICB9CgogICAgICAjZ21jLWZyYW1lIFt0eXBlPWJ1dHRvbl0sCiAgICAgICNnbWMtZnJhbWUgLnNhdmVjbG9zZV9idXR0b25zCiAgICAgIHsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrOwogICAgICAgIHBhZGRpbmc6IDVweCAxNnB4OwogICAgICAgIGZvbnQtc2l6ZTogMTRweDsKICAgICAgICBmb250LXdlaWdodDogNTAwOwogICAgICAgIGxpbmUtaGVpZ2h0OiAyMHB4OwogICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7CiAgICAgICAgdmVydGljYWwtYWxpZ246IG1pZGRsZTsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgLXdlYmtpdC11c2VyLXNlbGVjdDogbm9uZTsKICAgICAgICB1c2VyLXNlbGVjdDogbm9uZTsKICAgICAgICBib3JkZXI6IDFweCBzb2xpZDsKICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7CiAgICAgICAgLXdlYmtpdC1hcHBlYXJhbmNlOiBub25lOwogICAgICAgIGFwcGVhcmFuY2U6IG5vbmU7CgogICAgICAgIGZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLEJsaW5rTWFjU3lzdGVtRm9udCwiU2Vnb2UgVUkiLCJOb3RvIFNhbnMiLEhlbHZldGljYSxBcmlhbCxzYW5zLXNlcmlmLCJBcHBsZSBDb2xvciBFbW9qaSIsIlNlZ29lIFVJIEVtb2ppIjsKICAgICAgfQoKICAgICAgQGtleWZyYW1lcyBmYWRlT3V0CiAgICAgIHsKICAgICAgICBmcm9tIHsKICAgICAgICAgIG9wYWNpdHk6IDE7CiAgICAgICAgfQogICAgICAgIHRvIHsKICAgICAgICAgIG9wYWNpdHk6IDA7CiAgICAgICAgfQogICAgICB9CgogICAgICAjZ21jLXNhdmVkCiAgICAgIHsKICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIG1hcmdpbi1yaWdodDogMTBweDsKICAgICAgICBhbmltYXRpb246IGZhZGVPdXQgMC43NXMgZWFzZSAycyBmb3J3YXJkczsKICAgICAgfQoKICAgICAgICAjZ21jLWZyYW1lCiAgICAgICAgewogICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0Y2RjhGQTsKICAgICAgICAgIGNvbG9yOiAjMUYyMzI4OwogICAgICAgICAgYm94LXNoYWRvdzogMCAwIDAgMXB4ICNEMEQ3REUsIDAgMTZweCAzMnB4IHJnYmEoMSw0LDksMC4yKSAhaW1wb3J0YW50OwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSAuc2VjdGlvbl9oZWFkZXJfaG9sZGVyCiAgICAgICAgewogICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0ZGRkZGRjsKICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkICNEMEQ3REU7CiAgICAgICAgfQoKICAgICAgICAjZ21jLWZyYW1lX2J1dHRvbnNfaG9sZGVyCiAgICAgICAgewogICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0ZGRkZGRjsKICAgICAgICAgIGJveC1zaGFkb3c6IDAgMCAwIDFweCAjRDBEN0RFLCAwIDE2cHggMzJweCByZ2JhKDEsNCw5LDAuMikgIWltcG9ydGFudDsKICAgICAgICB9CgogICAgICAgICNnbWMtZnJhbWUgaW5wdXRbdHlwZT0idGV4dCJdLAogICAgICAgICNnbWMtZnJhbWUgdGV4dGFyZWEsCiAgICAgICAgI2dtYy1mcmFtZSBzZWxlY3QKICAgICAgICB7CiAgICAgICAgICBib3JkZXI6IDFweCBzb2xpZCAjRDBEN0RFOwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSBzZWxlY3QKICAgICAgICB7CiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRjZGOEZBOwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSBzZWxlY3Q6aG92ZXIKICAgICAgICB7CiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRjNGNEY2OwogICAgICAgICAgYm9yZGVyLWNvbG9yOiAjMUYyMzI4MjY7CiAgICAgICAgfQoKICAgICAgICAjZ21jLWZyYW1lIGlucHV0W3R5cGU9InRleHQiXSwKICAgICAgICAjZ21jLWZyYW1lIHRleHRhcmVhCiAgICAgICAgewogICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0Y2RjhGQTsKICAgICAgICAgIGNvbG9yOiAjMUYyMzI4OwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSBpbnB1dFt0eXBlPSJ0ZXh0Il06Zm9jdXMsCiAgICAgICAgI2dtYy1mcmFtZSB0ZXh0YXJlYTpmb2N1cwogICAgICAgIHsKICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGRkZGRkY7CiAgICAgICAgfQoKICAgICAgICAjZ21jLWZyYW1lIFt0eXBlPWJ1dHRvbl0sCiAgICAgICAgI2dtYy1mcmFtZSAuc2F2ZWNsb3NlX2J1dHRvbnMKICAgICAgICB7CiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjZmOGZhOwogICAgICAgICAgYm9yZGVyLWNvbG9yOiAjMWYyMzI4MjY7CiAgICAgICAgICBib3gtc2hhZG93OiAwIDFweCAwIHJnYmEoMzEsMzUsNDAsMC4wNCksIGluc2V0IDAgMXB4IDAgcmdiYSgyNTUsMjU1LDI1NSwwLjI1KTsKICAgICAgICAgIGNvbG9yOiAjMjQyOTJmOwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSBbdHlwZT1idXR0b25dOmhvdmVyLAogICAgICAgICNnbWMtZnJhbWUgLnNhdmVjbG9zZV9idXR0b25zOmhvdmVyCiAgICAgICAgewogICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2YzZjRmNjsKICAgICAgICAgIGJvcmRlci1jb2xvcjogIzFmMjMyODI2OwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSAuZ21jLWNoZWNrYm94CiAgICAgICAgewogICAgICAgICAgYm9yZGVyLWNvbG9yOiAjNkU3NzgxOwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSBpbnB1dFt0eXBlPSJyYWRpbyJdCiAgICAgICAgewogICAgICAgICAgY29sb3I6ICM2RTc3ODE7CiAgICAgICAgfQoKICAgICAgICAjZ21jLWZyYW1lIHN2ZwogICAgICAgIHsKICAgICAgICAgIGZpbGw6ICMwMDAwMDA7CiAgICAgICAgfQoKICAgICAgICAjZ21jLWZyYW1lIC5zZWN0aW9uX2hlYWRlcgogICAgICAgIHsKICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjRDBEN0RFOwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NlY3Rpb25fMyAuY29uZmlnX3Zhcjpub3QoOmxhc3QtY2hpbGQpLAogICAgICAgICNnbWMtZnJhbWUgI2dtYy1mcmFtZV9zZWN0aW9uXzQgLmNvbmZpZ192YXI6bm90KDpsYXN0LWNoaWxkKQogICAgICAgIHsKICAgICAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjRDBEN0RFOwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NhdmVCdG4KICAgICAgICB7CiAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMUY4ODNEOwogICAgICAgICAgYm9yZGVyLWNvbG9yOiByZ2JhKDMxLCAzNSwgNDAsIDAuMTUpOwogICAgICAgICAgYm94LXNoYWRvdzogcmdiYSgzMSwgMzUsIDQwLCAwLjEpIDBweCAxcHggMHB4OwogICAgICAgICAgY29sb3I6ICNGRkZGRkY7CiAgICAgICAgfQoKICAgICAgICAjZ21jLWZyYW1lICNnbWMtZnJhbWVfc2F2ZUJ0bjpob3ZlcgogICAgICAgIHsKICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyNiwgMTI3LCA1NSk7CiAgICAgICAgfQoKICAgICAgICAjZ21jLWZyYW1lICNnbWMtZnJhbWVfc2VjdGlvbl80CiAgICAgICAgewogICAgICAgICAgYm9yZGVyOiAxcHggc29saWQgI0ZGODE4MjY2OwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZSAjZ21jLWZyYW1lX3NlY3Rpb25fNCBpbnB1dAogICAgICAgIHsKICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNGNkY4RkE7CiAgICAgICAgICBib3JkZXItY29sb3I6ICMxRjIzMjgyNjsKICAgICAgICAgIGJveC1zaGFkb3c6IDAgMXB4IDAgcmdiYSgzMSwzNSw0MCwwLjA0KSwgaW5zZXQgMCAxcHggMCByZ2JhKDI1NSwyNTUsMjU1LDAuMjUpOwogICAgICAgICAgY29sb3I6ICNDRjIyMkU7CiAgICAgICAgfQoKICAgICAgICAjZ21jLWZyYW1lICNnbWMtZnJhbWVfc2VjdGlvbl80IGlucHV0OmhvdmVyCiAgICAgICAgewogICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI0E0MEUyNjsKICAgICAgICAgIGJvcmRlci1jb2xvcjogIzFGMjMyODI2OwogICAgICAgICAgYm94LXNoYWRvdzogMCAxcHggMCByZ2JhKDMxLDM1LDQwLDAuMDQpOwogICAgICAgICAgY29sb3I6ICNmZmZmZmY7CiAgICAgICAgfQoKICAgICAgICAjZ21jLXNhdmVkCiAgICAgICAgewogICAgICAgICAgY29sb3I6ICMxYTdmMzc7CiAgICAgICAgfQoKICAgICAgICAjZ21jLXNhdmVkIHN2ZyBwYXRoCiAgICAgICAgewogICAgICAgICAgZmlsbDogIzFhN2YzNzsKICAgICAgICB9CgogICAgICAgICNnbWMtZnJhbWUgLnJlc2V0X2hvbGRlciB7CiAgICAgICAgICBkaXNwbGF5OiBub25lOwogICAgICAgIH0KCiAgICAgICAgI2dtYy1mcmFtZV9oaWRlQnlUYWdMaXN0X3ZhciB7CiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDsKICAgICAgICB9CiAgICAgIGA7CiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKGdtY0ZyYW1lU3R5bGUpOwp9CmZ1bmN0aW9uIGdtY0luaXRpYWxpemVkKCkgewogICAgaUxvZy5kKCdnbWNJbml0aWFsaXplZCgpJyk7CgogICAgR01DLmNzcy5iYXNpYyA9ICcnOwoKICAgIFVwZGF0ZUxvZ0xldmVsKCk7CiAgICBTdGFydExvYWQoKTsKfQpmdW5jdGlvbiBnbWNPcGVuZWQoKSB7CiAgICBpTG9nLmQoJ2dtY09wZW5lZCgpJyk7CgogICAgJCgnI2dtYycpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTsKICAgICQoJyNnbWMtZnJhbWVfc2F2ZUJ0bicpLnRleHQoVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19zYXZlKTsKICAgICQoJyNnbWMtZnJhbWVfY2xvc2VCdG4nKS50ZXh0KFRleHRzW2dfbGFuZ3VhZ2VdLnNldHRpbmdfY2xvc2UpOwoKICAgIGZ1bmN0aW9uIHVwZGF0ZUNoZWNrYm94ZXMoKSB7CiAgICAgICAgaUxvZy5kKCd1cGRhdGVDaGVja2JveGVzKCknKTsKCiAgICAgICAgY29uc3QgY2hlY2tib3hlcyA9ICQoJyNnbWMtZnJhbWUgaW5wdXRbdHlwZT0iY2hlY2tib3giXScpOwoKICAgICAgICBpZiAoY2hlY2tib3hlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGNoZWNrYm94ZXMuYWRkQ2xhc3MoJ2dtYy1jaGVja2JveCcpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldFRpbWVvdXQodXBkYXRlQ2hlY2tib3hlcywgMTAwKTsKICAgICAgICB9CiAgICB9CgogICAgdXBkYXRlQ2hlY2tib3hlcygpOwp9CmZ1bmN0aW9uIGdtY1NhdmVkKCkgewogICAgaUxvZy5kKCdnbWNTYXZlZCgpJyk7CgogICAgLy8gbGFuZwogICAgbGV0IGxhbmcgPSBHTUMuZ2V0KCdsYW5nJyk7CiAgICBsZXQgc2V0dGluZ3NMYW5nOwogICAgaWYgKGxhbmcgPT0gJ0F1dG8nKSB7CiAgICAgICAgc2V0dGluZ3NMYW5nID0gTGFuZy5hdXRvOwogICAgfSBlbHNlIGlmIChsYW5nID09ICfnroDkvZPkuK3mlocnKSB7CiAgICAgICAgc2V0dGluZ3NMYW5nID0gTGFuZy56aF9DTjsKICAgIH0gZWxzZSBpZiAobGFuZyA9PSAnRW5nbGlzaCcpIHsKICAgICAgICBzZXR0aW5nc0xhbmcgPSBMYW5nLmVuX1VTOwogICAgfSBlbHNlIGlmIChsYW5nID09ICfQoNGD0YHRgdC60LjQuSDRj9C30YvQuicpIHsKICAgICAgICBzZXR0aW5nc0xhbmcgPSBMYW5nLnJ1X1JVOwogICAgfSBlbHNlIGlmIChsYW5nID09ICfml6XmnKzoqp4nKSB7CiAgICAgICAgc2V0dGluZ3NMYW5nID0gTGFuZy5qYV9KUDsKICAgIH0KICAgIFNldExvY2FsU3RvcmFnZSgnUGl4aXZQcmV2aWV3TGFuZycsIHNldHRpbmdzTGFuZyk7CgogICAgbG9jYXRpb24uaHJlZiA9IGxvY2F0aW9uLmhyZWY7Cn0KZnVuY3Rpb24gZ21jQ2xvc2VkKCkgewogICAgaUxvZy5kKCdnbWNDbG9zZWQoKScpOwp9CnZhciBHTUM7CmZ1bmN0aW9uIGdtY0luaXQoKSB7CiAgICBpTG9nLmQoJ2dtY0luaXQoKScpOwoKICAgIEdNQyA9IG5ldyBHTV9jb25maWcoewogICAgICAgIGlkOiAnZ21jLWZyYW1lJywKICAgICAgICB0aXRsZTogJ1BpeGl2IFByZXZpZXdlcicsCiAgICAgICAgZXZlbnRzOiB7CiAgICAgICAgICAgIGluaXQ6IGdtY0luaXRpYWxpemVkLAogICAgICAgICAgICBvcGVuOiBnbWNPcGVuZWQsCiAgICAgICAgICAgIHNhdmU6IGdtY1NhdmVkLAogICAgICAgICAgICBjbG9zZTogZ21jQ2xvc2VkLAogICAgICAgIH0sCiAgICAgICAgZnJhbWU6IGdtY0J1aWxkRnJhbWUoKSwKICAgICAgICBmaWVsZHM6IHsKICAgICAgICAgICAgbGFuZzogewogICAgICAgICAgICAgICAgbGFiZWw6IFRleHRzW2dfbGFuZ3VhZ2VdLnNldHRpbmdfbGFuZ3VhZ2UsCiAgICAgICAgICAgICAgICBzZWN0aW9uOiBbCiAgICAgICAgICAgICAgICAgICAgVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19zZXR0aW5nU2VjdGlvbiwKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB0eXBlOiAnc2VsZWN0JywKICAgICAgICAgICAgICAgIG9wdGlvbnM6IFsKICAgICAgICAgICAgICAgICAgICAnQXV0bycsCiAgICAgICAgICAgICAgICAgICAgJ+eugOS9k+S4reaWhycsCiAgICAgICAgICAgICAgICAgICAgJ0VuZ2xpc2gnLAogICAgICAgICAgICAgICAgICAgICfQoNGD0YHRgdC60LjQuSDRj9C30YvQuicsCiAgICAgICAgICAgICAgICAgICAgJ+aXpeacrOiqnicsCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgZGVmYXVsdDogJ0F1dG8nLAogICAgICAgICAgICB9LAogICAgICAgICAgICBmdWxsU2l6ZVRodW1iOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc29ydF9mdWxsU2l6ZVRodW1iLAogICAgICAgICAgICAgICAgdHlwZTogJ2NoZWNrYm94JywKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgICAgICB9LAogICAgICAgICAgICBsaW5rQmxhbms6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX2JsYW5rLAogICAgICAgICAgICAgICAgdHlwZTogJ2NoZWNrYm94JywKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHRydWUsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVuYWJsZUFuaW1lRG93bmxvYWQ6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX2FuaW1lLAogICAgICAgICAgICAgICAgdHlwZTogJ2NoZWNrYm94JywKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHRydWUsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGxvZ0xldmVsOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19sb2dMZXZlbCwKICAgICAgICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLAogICAgICAgICAgICAgICAgb3B0aW9uczogWwogICAgICAgICAgICAgICAgICAgICdlcnJvcicsCiAgICAgICAgICAgICAgICAgICAgJ3dhcm5pbmcnLAogICAgICAgICAgICAgICAgICAgICdpbmZvJywKICAgICAgICAgICAgICAgICAgICAnZGVidWcnLAogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICdpbmZvJywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2xlYXJTZXR0aW5nczogewogICAgICAgICAgICAgICAgbGFiZWw6IFRleHRzW2dfbGFuZ3VhZ2VdLnNldHRpbmdfcmVzZXQsCiAgICAgICAgICAgICAgICB0eXBlOiAnYnV0dG9uJywKICAgICAgICAgICAgICAgIGNsaWNrOiAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0oVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19yZXNldEhpbnQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgU2V0TG9jYWxTdG9yYWdlKCdnbWMtZnJhbWUnLCAnJyk7CiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IGxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICBjbGVhckZvbGxvd2VkVXNlckNhY2hlOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19jbGVhckZvbGxvd2luZ0NhY2hlLAogICAgICAgICAgICAgICAgdHlwZTogJ2J1dHRvbicsCiAgICAgICAgICAgICAgICBjbGljazogKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGxldCB1c2VyX2lkID0gZGF0YUxheWVyWzBdLnVzZXJfaWQ7CiAgICAgICAgICAgICAgICAgICAgU2V0TG9jYWxTdG9yYWdlKCdmb2xsb3dpbmdPZlVpZC0nICsgdXNlcl9pZCwgbnVsbCwgLTEpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIGVuYWJsZVByZXZpZXc6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX3ByZXZpZXcsCiAgICAgICAgICAgICAgICBzZWN0aW9uOiBbCiAgICAgICAgICAgICAgICAgICAgVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19wcmV2aWV3LAogICAgICAgICAgICAgICAgXSwKICAgICAgICAgICAgICAgIHR5cGU6ICdjaGVja2JveCcsCiAgICAgICAgICAgICAgICBkZWZhdWx0OiB0cnVlLAogICAgICAgICAgICB9LAogICAgICAgICAgICBlbmFibGVBbmltZVByZXZpZXc6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX2FuaW1lUHJldmlldywKICAgICAgICAgICAgICAgIHR5cGU6ICdjaGVja2JveCcsCiAgICAgICAgICAgICAgICBkZWZhdWx0OiB0cnVlLAogICAgICAgICAgICB9LAogICAgICAgICAgICBvcmlnaW5hbDogewogICAgICAgICAgICAgICAgbGFiZWw6IFRleHRzW2dfbGFuZ3VhZ2VdLnNldHRpbmdfb3JpZ2luLAogICAgICAgICAgICAgICAgdHlwZTogJ2NoZWNrYm94JywKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgICAgICB9LAogICAgICAgICAgICBwcmV2aWV3RGVsYXk6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX3ByZXZpZXdEZWxheSwKICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDIwMCwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcHJldmlld0J5S2V5OiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19wcmV2aWV3QnlLZXksCiAgICAgICAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnLAogICAgICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHByZXZpZXdGdWxsU2NyZWVuOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19wcmV2aWV3RnVsbFNjcmVlbiwKICAgICAgICAgICAgICAgIHR5cGU6ICdjaGVja2JveCcsCiAgICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2Nyb2xsTG9ja1doZW5QcmV2aWV3OiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19zY3JvbGxMb2NrV2hlblByZXZpZXcsCiAgICAgICAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnLAogICAgICAgICAgICAgICAgZGVmYXVsdDogdHJ1ZSwKICAgICAgICAgICAgfSwKCiAgICAgICAgICAgIGVuYWJsZVNvcnQ6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX3NvcnQsCiAgICAgICAgICAgICAgICBzZWN0aW9uOiBbCiAgICAgICAgICAgICAgICAgICAgVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19zb3J0U2VjdGlvbiwKICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICB0eXBlOiAnY2hlY2tib3gnLAogICAgICAgICAgICAgICAgZGVmYXVsdDogdHJ1ZSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcGFnZUNvdW50OiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19tYXhQYWdlLAogICAgICAgICAgICAgICAgdHlwZTogJ3RleHQnLAogICAgICAgICAgICAgICAgZGVmYXVsdDogMywKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZmF2RmlsdGVyOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19oaWRlV29yaywKICAgICAgICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGFpRmlsdGVyOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19oaWRlQWlXb3JrLAogICAgICAgICAgICAgICAgdHlwZTogImNoZWNrYm94IiwKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgICAgICB9LAogICAgICAgICAgICBhaU9ubHk6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX29ubHlBaVdvcmssCiAgICAgICAgICAgICAgICB0eXBlOiAiY2hlY2tib3giLAogICAgICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGhpZGVGYXZvcml0ZTogewogICAgICAgICAgICAgICAgbGFiZWw6IFRleHRzW2dfbGFuZ3VhZ2VdLnNldHRpbmdfaGlkZUZhdiwKICAgICAgICAgICAgICAgIHR5cGU6ICJjaGVja2JveCIsCiAgICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaGlkZUZvbGxvd2VkOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19oaWRlRm9sbG93ZWQsCiAgICAgICAgICAgICAgICB0eXBlOiAiY2hlY2tib3giLAogICAgICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGhpZGVCeVRhZzogewogICAgICAgICAgICAgICAgbGFiZWw6IFRleHRzW2dfbGFuZ3VhZ2VdLnNldHRpbmdfaGlkZUJ5VGFnLAogICAgICAgICAgICAgICAgdHlwZTogImNoZWNrYm94IiwKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgICAgICB9LAogICAgICAgICAgICBoaWRlQnlUYWdMaXN0OiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19oaWRlQnlUYWdQbGFjZWhvbGRlciwKICAgICAgICAgICAgICAgIHR5cGU6ICJoaWRkZW4iLAogICAgICAgICAgICAgICAgZGVmYXVsdDogIiIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGhpZGVCeVRhZ1JlZ2V4OiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19oaWRlQnlUYWdQbGFjZWhvbGRlciwKICAgICAgICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgICAgICAgIGRlZmF1bHQ6ICIiLAogICAgICAgICAgICB9LAogICAgICAgICAgICBoaWRlQnlVc2VyOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19oaWRlQnlVc2VyLAogICAgICAgICAgICAgICAgdHlwZTogImNoZWNrYm94IiwKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgICAgICB9LAogICAgICAgICAgICBoaWRlQnlVc2VyTGlzdDogewogICAgICAgICAgICAgICAgbGFiZWw6IFRleHRzW2dfbGFuZ3VhZ2VdLnNldHRpbmdfaGlkZUJ5VXNlclBsYWNlaG9sZGVyLAogICAgICAgICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAgICAgICAgICAgZGVmYXVsdDogIiIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGhpZGVDb3VudExlc3NUaGFuOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19oaWRlQnlDb3VudExlc3NUaGFuLAogICAgICAgICAgICAgICAgdHlwZTogInRleHQiLAogICAgICAgICAgICAgICAgZGVmYXVsdDogMCwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaGlkZUNvdW50TW9yZVRoYW46IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX2hpZGVCeUNvdW50TW9yZVRoYW4sCiAgICAgICAgICAgICAgICB0eXBlOiAidGV4dCIsCiAgICAgICAgICAgICAgICBkZWZhdWx0OiAwLAogICAgICAgICAgICB9LAogICAgICAgICAgICBwYWdlQnlLZXk6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX3R1cm5QYWdlLAogICAgICAgICAgICAgICAgdHlwZTogJ2NoZWNrYm94JywKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLAogICAgICAgICAgICB9LAogICAgICAgICAgICBtYXhYaHI6IHsKICAgICAgICAgICAgICAgIGxhYmVsOiBUZXh0c1tnX2xhbmd1YWdlXS5zZXR0aW5nX21heFhociwKICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDY0LAogICAgICAgICAgICB9LAoKICAgICAgICAgICAgZW5hYmxlTm92ZWxTb3J0OiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19ub3ZlbFNvcnQsCiAgICAgICAgICAgICAgICBzZWN0aW9uOiBbCiAgICAgICAgICAgICAgICAgICAgVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19ub3ZlbFNlY3Rpb24sCiAgICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgICAgdHlwZTogJ2NoZWNrYm94JywKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHRydWUsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5vdmVsUGFnZUNvdW50OiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19ub3ZlbE1heFBhZ2UsCiAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsCiAgICAgICAgICAgICAgICBkZWZhdWx0OiAzLAogICAgICAgICAgICB9LAogICAgICAgICAgICBub3ZlbEZhdkZpbHRlcjogewogICAgICAgICAgICAgICAgbGFiZWw6IFRleHRzW2dfbGFuZ3VhZ2VdLnNldHRpbmdfbm92ZWxIaWRlV29yaywKICAgICAgICAgICAgICAgIHR5cGU6ICJ0ZXh0IiwKICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDAsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5vdmVsSGlkZUZhdm9yaXRlOiB7CiAgICAgICAgICAgICAgICBsYWJlbDogVGV4dHNbZ19sYW5ndWFnZV0uc2V0dGluZ19ub3ZlbEhpZGVGYXYsCiAgICAgICAgICAgICAgICB0eXBlOiAiY2hlY2tib3giLAogICAgICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsCiAgICAgICAgICAgIH0sCiAgICAgICAgfSwKICAgIH0pOwp9CgovKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIOmihOiniCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCmxldCBhdXRvTG9hZEludGVydmFsID0gbnVsbDsKZnVuY3Rpb24gUGl4aXZQcmV2aWV3KCkgewogICAgLy8g5pyA57uI6ZyA6KaB5pi+56S655qE6aKE6KeI5Zu+SUTvvIznlKjkuo7pgb/lhY3pvKDmoIfmu5Hov4flpJrlvKDlm77niYfml7bvvIzmnIDnu4jmmL7npLrnmoTlm77niYfplJnor68KICAgIGxldCBwcmV2aWV3VGFyZ2V0SWxsdXN0SWQgPSAnJzsKCiAgICBmdW5jdGlvbiBjcmVhdGVQbGF5ZXIob3B0cykgewogICAgICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTsKICAgICAgICB2YXIgb3B0aW9ucyA9IHsKICAgICAgICAgICAgY2FudmFzOiBjYW52YXMsCiAgICAgICAgICAgIGNodW5rU2l6ZTogMzAwMDAwLAogICAgICAgICAgICBsb29wOiB0cnVlLAogICAgICAgICAgICBhdXRvU3RhcnQ6IHRydWUsCiAgICAgICAgICAgIGRlYnVnOiBmYWxzZSwKICAgICAgICB9CiAgICAgICAgaWYgKG9wdHMpIHsKICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBvcHRzKSB7CiAgICAgICAgICAgICAgICBvcHRpb25zW25hbWVdID0gb3B0c1tuYW1lXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB2YXIgcCA9IG5ldyBaaXBJbWFnZVBsYXllcihvcHRpb25zKTsKICAgICAgICBwLmNhbnZhcyA9IGNhbnZhczsKICAgICAgICByZXR1cm4gcDsKICAgIH0KCiAgICAvLyDlvIDlkK/pooTop4jlip/og70KICAgIGZ1bmN0aW9uIEFjdGl2ZVByZXZpZXcoKSB7CiAgICAgICAgbGV0IHJldHVybk1hcCA9IFBhZ2VzW2dfcGFnZVR5cGVdLkdldFByb2Nlc3NlZFBhZ2VFbGVtZW50cygpOwogICAgICAgIGlmICghcmV0dXJuTWFwLmxvYWRpbmdDb21wbGV0ZSkgewogICAgICAgICAgICBpTG9nLmUoJ1BhZ2Ugbm90IGxvYWQsIHNob3VsZCBub3QgY2FsbCBQcmV2aWV3IScpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiB0b2dnbGVQcmV2aWV3RGl2KCkgewogICAgICAgICAgICBsZXQgZGl2ID0gJCgnLnBwLW1haW4nKTsKICAgICAgICAgICAgaWYgKGRpdi5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChkaXYuY3NzKCdkaXNwbGF5JykgPT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgICBpTG9nLmQoJ1Nob3cgbWFpbi4nKTsKICAgICAgICAgICAgICAgIEFkanVzdERpdlBvc2l0aW9uKCk7CiAgICAgICAgICAgICAgICBkaXYuc2hvdygpOwogICAgICAgICAgICAgICAgaWYgKGdfc2V0dGluZ3MucHJldmlld0Z1bGxTY3JlZW4pIHsKICAgICAgICAgICAgICAgICAgICBkaXNhYmxlU2Nyb2xsKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBpTG9nLmQoJ0hpZGUgbWFpbi4nKTsKICAgICAgICAgICAgICAgIGRpdi5oaWRlKCk7CiAgICAgICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5wcmV2aWV3RnVsbFNjcmVlbikgewogICAgICAgICAgICAgICAgICAgIGVuYWJsZVNjcm9sbCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGZ1bmN0aW9uIHNob3dQcmV2aWV3RGl2KCkgewogICAgICAgICAgICBsZXQgZGl2ID0gJCgnLnBwLW1haW4nKTsKICAgICAgICAgICAgaWYgKGRpdi5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChkaXYuY3NzKCdkaXNwbGF5JykgPT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgICBpTG9nLmQoJ1Nob3cgbWFpbi4nKTsKICAgICAgICAgICAgICAgIEFkanVzdERpdlBvc2l0aW9uKCk7CiAgICAgICAgICAgICAgICBkaXYuc2hvdygpOwogICAgICAgICAgICAgICAgaWYgKGdfc2V0dGluZ3Muc2Nyb2xsTG9ja1doZW5QcmV2aWV3KSB7CiAgICAgICAgICAgICAgICAgICAgZGlzYWJsZVNjcm9sbCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoZ19zZXR0aW5ncy5wcmV2aWV3QnlLZXkpIHsKICAgICAgICAgICAgJChkb2N1bWVudCkudW5iaW5kKCdrZXlkb3duJyk7CiAgICAgICAgICAgICQoZG9jdW1lbnQpLmtleWRvd24oKGUpID0+IHsKICAgICAgICAgICAgICAgIGlmIChlLmtleUNvZGUgIT0gZ19zZXR0aW5ncy5wcmV2aWV3S2V5KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdG9nZ2xlUHJldmlld0RpdigpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIC8vIOm8oOagh+i/m+WFpQogICAgICAgICQocmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cykubW91c2VlbnRlcihmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAvLyDmjInkvY8gQ3RybOmUriDkuI3mmL7npLrpooTop4jlm74KICAgICAgICAgICAgaWYgKGUuY3RybEtleSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsZXQgc3RhcnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICAgICAgICAgIGxldCBkZWxheSA9IHBhcnNlSW50KGdfc2V0dGluZ3MucHJldmlld0RlbGF5KTsKCiAgICAgICAgICAgIGxldCBfdGhpcyA9ICQodGhpcyk7CiAgICAgICAgICAgIGxldCBpbGx1c3RJZCA9IF90aGlzLmF0dHIoJ2lsbHVzdElkJyk7CiAgICAgICAgICAgIGxldCBpbGx1c3RUeXBlID0gX3RoaXMuYXR0cignaWxsdXN0VHlwZScpOwogICAgICAgICAgICBsZXQgcGFnZUNvdW50ID0gX3RoaXMuYXR0cigncGFnZUNvdW50Jyk7CgogICAgICAgICAgICBpZiAoaWxsdXN0SWQgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgaUxvZy5lKCdDYW4gbm90IGZvdW5kIGlsbHVzdElkIGluIHRoaXMgZWxlbWVudFwncyBhdHRyYnV0ZXMuJyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGlsbHVzdFR5cGUgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgaUxvZy5lKCdDYW4gbm90IGZvdW5kIGlsbHVzdFR5cGUgaW4gdGhpcyBlbGVtZW50XCdzIGF0dHJidXRlcy4nKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocGFnZUNvdW50ID09IG51bGwpIHsKICAgICAgICAgICAgICAgIGlMb2cuZSgnQ2FuIG5vdCBmb3VuZCBwYWdlQ291bnQgaW4gdGhpcyBlbGVtZW50XCdzIGF0dHJidXRlcy4nKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBwcmV2aWV3VGFyZ2V0SWxsdXN0SWQgPSBpbGx1c3RJZDsKCiAgICAgICAgICAgIGlmIChpbGx1c3RUeXBlID09IDIgJiYgIWdfc2V0dGluZ3MuZW5hYmxlQW5pbWVQcmV2aWV3KSB7CiAgICAgICAgICAgICAgICBpTG9nLmQoJ0FuaW1lIHByZXZpZXcgZGlzYWJsZWQuJyk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIOm8oOagh+S9jee9rgogICAgICAgICAgICBnX21vdXNlUG9zID0geyB4OiBlLnBhZ2VYLCB5OiBlLnBhZ2VZIH07CiAgICAgICAgICAgIC8vIOmihOiniCBEaXYKICAgICAgICAgICAgbGV0IHByZXZpZXdEaXYgPSAkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpKS5hZGRDbGFzcygncHAtbWFpbicpLmF0dHIoJ2lsbHVzdElkJywgaWxsdXN0SWQpCiAgICAgICAgICAgICAgICAuY3NzKHsKICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOiAnYWJzb2x1dGUnLCAnei1pbmRleCc6ICc5OTk5OTknLCAnbGVmdCc6IGdfbW91c2VQb3MueCArICdweCcsICd0b3AnOiBnX21vdXNlUG9zLnkgKyAncHgnLAogICAgICAgICAgICAgICAgICAgICdib3JkZXItc3R5bGUnOiAnc29saWQnLCAnYm9yZGVyLWNvbG9yJzogJyM2NDk1ZWQnLCAnYm9yZGVyLXdpZHRoJzogJzJweCcsICdib3JkZXItcmFkaXVzJzogJzIwcHgnLAogICAgICAgICAgICAgICAgICAgICd3aWR0aCc6ICc0OHB4JywgJ2hlaWdodCc6ICc0OHB4JywKICAgICAgICAgICAgICAgICAgICAnYmFja2dyb3VuZC1pbWFnZSc6ICd1cmwoaHR0cHM6Ly9wcC0xMjUyMDg5MTcyLmNvcy5hcC1jaGVuZ2R1Lm15cWNsb3VkLmNvbS90cmFuc3BhcmVudC5wbmcpJywKICAgICAgICAgICAgICAgICAgICAnZGlzcGxheSc6ICdub25lJywgJ3RleHQtYWxpZ24nOiAnY2VudGVyJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIC8vIOa3u+WKoOWIsCBib2R5CiAgICAgICAgICAgICQoJy5wcC1tYWluJykucmVtb3ZlKCk7CiAgICAgICAgICAgICQoJ2JvZHknKS5hcHBlbmQocHJldmlld0Rpdik7CgogICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5wcmV2aWV3RnVsbFNjcmVlbikgewogICAgICAgICAgICAgICAgcHJldmlld0Rpdi5jc3MoeyAnYmFja2dyb3VuZCc6ICcjZmZmZmZmODAnLCAncG9zaXRpb24nOiAnZml4ZWQnIH0pOwogICAgICAgICAgICAgICAgcHJldmlld0Rpdi5jbGljaygoZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICgkKGUudGFyZ2V0KS5oYXNDbGFzcygncHAtaW1hZ2UnKSkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRvZ2dsZVByZXZpZXdEaXYoKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoIWdfc2V0dGluZ3MucHJldmlld0J5S2V5KSB7CiAgICAgICAgICAgICAgICBsZXQgd2FpdFRpbWUgPSBkZWxheSAtIChuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHN0YXJ0VGltZSk7CiAgICAgICAgICAgICAgICBpZiAod2FpdFRpbWUgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChzaG93UHJldmlld0Rpdiwgd2FpdFRpbWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBzaG93UHJldmlld0RpdigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyDliqDovb3kuK3lm77niYcKICAgICAgICAgICAgbGV0IGxvYWRpbmdJbWcgPSAkKG5ldyBJbWFnZSgpKS5hZGRDbGFzcygncHAtbG9hZGluZycpLmF0dHIoJ3NyYycsIGdfbG9hZGluZ0ltYWdlKS5jc3MoewogICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzogJ2Fic29sdXRlJywgJ2JvcmRlci1yYWRpdXMnOiAnMjBweCcsICdsZWZ0JzogJzBweCcsICd0b3AnOiAnMHB4JwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcHJldmlld0Rpdi5hcHBlbmQobG9hZGluZ0ltZyk7CgogICAgICAgICAgICAvLyDopoHmmL7npLrnmoTpooTop4jlm77oioLngrkKICAgICAgICAgICAgbGV0IGxvYWRJbWcgPSAkKG5ldyBJbWFnZSgpKS5hZGRDbGFzcygncHAtaW1hZ2UnKS5jc3MoeyAnaGVpZ2h0JzogJzBweCcsICd3aWR0aCc6ICcwcHgnLCAnZGlzcGxheSc6ICdub25lJywgJ2JvcmRlci1yYWRpdXMnOiAnMjBweCcgfSk7CiAgICAgICAgICAgIHByZXZpZXdEaXYuYXBwZW5kKGxvYWRJbWcpOwoKICAgICAgICAgICAgLy8g5Y6f5Zu+77yI56yR6IS477yJ5Zu+5qCHCiAgICAgICAgICAgIGxldCBvcmlnaW5JY29uID0gJChuZXcgSW1hZ2UoKSkuYWRkQ2xhc3MoJ3BwLW9yaWdpbmFsJykuYXR0cignc3JjJywgJ2h0dHBzOi8vc291cmNlLnBpeGl2Lm5ldC93d3cvaW1hZ2VzL3BpeGl2Y29taWMtZmF2b3JpdGUucG5nJykKICAgICAgICAgICAgICAgIC5jc3MoeyAncG9zaXRpb24nOiAnYWJzb2x1dGUnLCAnYm90dG9tJzogJzVweCcsICdyaWdodCc6ICc1cHgnLCAnZGlzcGxheSc6ICdub25lJyB9KTsKICAgICAgICAgICAgcHJldmlld0Rpdi5hcHBlbmQob3JpZ2luSWNvbik7CgogICAgICAgICAgICAvLyDngrnlh7vlm77moIfmlrDnvZHpobXmiZPlvIDljp/lm74KICAgICAgICAgICAgb3JpZ2luSWNvbi5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB3aW5kb3cub3BlbigkKHByZXZpZXdEaXYpLmNoaWxkcmVuKCdpbWcnKVsxXS5zcmMpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIC8vIOWPs+S4iuinkuW8oOaVsOagh+iusAogICAgICAgICAgICBsZXQgcGFnZUNvdW50SFRNTCA9ICc8ZGl2IGNsYXNzPSJwcC1wYWdlQ291bnQiIHN0eWxlPSJkaXNwbGF5OiBmbGV4Oy13ZWJraXQtYm94LWFsaWduOiBjZW50ZXI7YWxpZ24taXRlbXM6IGNlbnRlcjtib3gtc2l6aW5nOiBib3JkZXItYm94O21hcmdpbi1sZWZ0OiBhdXRvO2hlaWdodDogMjBweDtjb2xvcjogcmdiKDI1NSwgMjU1LCAyNTUpO2ZvbnQtc2l6ZTogMTBweDtsaW5lLWhlaWdodDogMTJweDtmb250LXdlaWdodDogYm9sZDtmbGV4OiAwIDAgYXV0bztwYWRkaW5nOiA0cHggNnB4O2JhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4zMik7Ym9yZGVyLXJhZGl1czogMTBweDttYXJnaW4tdG9wOjVweDttYXJnaW4tcmlnaHQ6NXB4OyI+XDxzdmcgdmlld0JveD0iMCAwIDkgMTAiIHdpZHRoPSI5IiBoZWlnaHQ9IjEwIiBzdHlsZT0ic3Ryb2tlOiBub25lO2xpbmUtaGVpZ2h0OiAwO2ZvbnQtc2l6ZTogMHB4O2ZpbGw6IGN1cnJlbnRjb2xvcjsiPjxwYXRoIGQ9Ik04LDMgQzguNTUyMjg0NzUsMyA5LDMuNDQ3NzE1MjUgOSw0IEw5LDkgQzksOS41NTIyODQ3NSA4LjU1MjI4NDc1LDEwIDgsMTAgTDMsMTAgQzIuNDQ3NzE1MjUsMTAgMiw5LjU1MjI4NDc1IDIsOSBMNiw5IEM3LjEwNDU2OTUsOSA4LDguMTA0NTY5NSA4LDcgTDgsMyBaIE0xLDEgTDYsMSBDNi41NTIyODQ3NSwxIDcsMS40NDc3MTUyNSA3LDIgTDcsNyBDNyw3LjU1MjI4NDc1IDYuNTUyMjg0NzUsOCA2LDggTDEsOCBDMC40NDc3MTUyNSw4IDAsNy41NTIyODQ3NSAwLDcgTDAsMiBDMCwxLjQ0NzcxNTI1IDAuNDQ3NzE1MjUsMSAxLDEgWiI+PC9wYXRoPjwvc3ZnPjxzcGFuIHN0eWxlPSJtYXJnaW4tbGVmdDoycHg7IiBjbGFzcz0icHAtcGFnZSI+MC8wPC9zcGFuPjwvZGl2Pic7CiAgICAgICAgICAgIGxldCBwYWdlQ291bnREaXYgPSAkKHBhZ2VDb3VudEhUTUwpCiAgICAgICAgICAgICAgICAuY3NzKHsgJ3Bvc2l0aW9uJzogJ2Fic29sdXRlJywgJ3RvcCc6ICcwcHgnLCAnZGlzcGxheSc6ICdub25lJywgJ3JpZ2h0JzogJzBweCcsICdkaXNwbGF5JzogJ25vbmUnIH0pOwogICAgICAgICAgICBwcmV2aWV3RGl2LmFwcGVuZChwYWdlQ291bnREaXYpOwoKICAgICAgICAgICAgJCgnLnBwLW1haW4nKS5tb3VzZWxlYXZlKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5wcmV2aWV3RnVsbFNjcmVlbikgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlKCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgbGV0IHVybCA9ICcnOwogICAgICAgICAgICBpZiAodHJ1ZSkgewogICAgICAgICAgICAgICAgaWYgKGlsbHVzdFR5cGUgPT0gMikgewogICAgICAgICAgICAgICAgICAgIHVybCA9IGdfZ2V0VWdvaXJhVXJsLnJlcGxhY2UoJyNpZCMnLCBpbGx1c3RJZCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHVybCA9IGdfZ2V0QXJ0d29ya1VybC5yZXBsYWNlKCcjaWQjJywgaWxsdXN0SWQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIOiOt+WPluWbvueJh+mTvuaOpQogICAgICAgICAgICAgICAgJC5hamF4KHVybCwgewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGpzb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5kKCdHb3QgYXJ0d29yayB1cmxzOicpOwogICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmQoanNvbik7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoanNvbi5lcnJvciA9PT0gdHJ1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5lKCdTZXJ2ZXIgcmVzcG9uc2VkIGFuIGVycm9yOiAnICsganNvbi5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgLy8g5bey57uP5LiN6ZyA6KaB5pi+56S66L+Z5Liq6aKE6KeI5Zu+5LqG77yM55u05o6l5Lii5byDCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbGx1c3RJZCAhPSBwcmV2aWV3VGFyZ2V0SWxsdXN0SWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlMb2cuZCgnRHJvcCB0aGlzIHByZXZpZXcgcmVxdWVzdC4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlsbHVzdFR5cGUgPT0gMikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlZ3VsYXIgPSBqc29uLmJvZHkuc3JjOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9yaWdpbmFsID0ganNvbi5ib2R5Lm9yaWdpbmFsU3JjOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1pbWUgPSBqc29uLmJvZHkubWltZV90eXBlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZyYW1lcyA9IGpzb24uYm9keS5mcmFtZXM7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5kKCdQcm9jZXNzIHVybHMgY29tcGxldGUuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmQocmVndWxhcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmQob3JpZ2luYWwpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdVZ29pcmEocmVndWxhciwgb3JpZ2luYWwsIG1pbWUsIGZyYW1lcywgZ19zZXR0aW5ncy5vcmlnaW5hbCwgaWxsdXN0SWQpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlZ3VsYXIgPSBbXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBvcmlnaW5hbCA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBqc29uLmJvZHkubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWd1bGFyLnB1c2goanNvbi5ib2R5W2ldLnVybHMucmVndWxhcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWwucHVzaChqc29uLmJvZHlbaV0udXJscy5vcmlnaW5hbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5kKCdQcm9jZXNzIHVybHMgY29tcGxldGUuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmQocmVndWxhcik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmQob3JpZ2luYWwpOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFZpZXdJbWFnZXMocmVndWxhciwgMCwgb3JpZ2luYWwsIGdfc2V0dGluZ3Mub3JpZ2luYWwsIGlsbHVzdElkKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlMb2cuZSgnUmVxdWVzdCBpbWFnZSB1cmxzIGZhaWxlZCEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlMb2cuZChkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIC8vIOm8oOagh+enu+WHuuWbvueJhwogICAgICAgICQocmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cykubW91c2VsZWF2ZShmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5wcmV2aWV3QnlLZXkpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IF90aGlzID0gJCh0aGlzKTsKICAgICAgICAgICAgbGV0IGlsbHVzdElkID0gX3RoaXMuYXR0cignaWxsdXN0SWQnKTsKICAgICAgICAgICAgbGV0IGlsbHVzdFR5cGUgPSBfdGhpcy5hdHRyKCdpbGx1c3RUeXBlJyk7CiAgICAgICAgICAgIGxldCBwYWdlQ291bnQgPSBfdGhpcy5hdHRyKCdwYWdlQ291bnQnKTsKCiAgICAgICAgICAgIGxldCBtb3ZlVG9FbGVtZW50ID0gJChlLnJlbGF0ZWRUYXJnZXQpOwogICAgICAgICAgICBsZXQgaXNNb3ZlVG9QcmV2aWV3RWxlbWVudCA9IGZhbHNlOwogICAgICAgICAgICAvLyDpvKDmoIfnp7vliqjliLDpooTop4jlm77kuIoKICAgICAgICAgICAgd2hpbGUgKHRydWUpIHsKICAgICAgICAgICAgICAgIGlmIChtb3ZlVG9FbGVtZW50Lmhhc0NsYXNzKCdwcC1tYWluJykgJiYgbW92ZVRvRWxlbWVudC5hdHRyKCdpbGx1c3RJZCcpID09IGlsbHVzdElkKSB7CiAgICAgICAgICAgICAgICAgICAgaXNNb3ZlVG9QcmV2aWV3RWxlbWVudCA9IHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKG1vdmVUb0VsZW1lbnQucGFyZW50KCkubGVuZ3RoIDwgMSkgewogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIG1vdmVUb0VsZW1lbnQgPSBtb3ZlVG9FbGVtZW50LnBhcmVudCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghaXNNb3ZlVG9QcmV2aWV3RWxlbWVudCkgewogICAgICAgICAgICAgICAgLy8g6Z2e6aKE6KeI5Zu+5LiKCiAgICAgICAgICAgICAgICAkKCcucHAtbWFpbicpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgaWYgKGdfc2V0dGluZ3Muc2Nyb2xsTG9ja1doZW5QcmV2aWV3KSB7CiAgICAgICAgICAgICAgICAgICAgZW5hYmxlU2Nyb2xsKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgLy8g6byg5qCH56e75Yqo77yM6LCD5pW05L2N572uCiAgICAgICAgJChyZXR1cm5NYXAuY29udHJvbEVsZW1lbnRzKS5tb3VzZW1vdmUoZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgLy8gQ3RybCDlkowg5Lit6ZSuIOmDveWPr+S7peemgeatoumihOiniOWbvuenu+WKqO+8jOi/meagt+WwseWPr+S7peWNleaJi+aTjeS9nOS6hgogICAgICAgICAgICBpZiAoZS5jdHJsS2V5IHx8IGUuYnV0dG9ucyAmIDQpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBnX21vdXNlUG9zLnggPSBlLnBhZ2VYOyBnX21vdXNlUG9zLnkgPSBlLnBhZ2VZOwoKICAgICAgICAgICAgLy8g5ZCv55So5oyJ6ZSu5byA5ZCv5YWz6Zet6aKE6KeI5Yqf6IO95pe277yM5LiN6Lef6ZqP6byg5qCH56e75YqoCiAgICAgICAgICAgIGlmICghKGdfc2V0dGluZ3MucHJldmlld0J5S2V5ICYmICQoJy5wcC1tYWluJykuY3NzKCdkaXNwbGF5JykgIT0gJ25vbmUnKSkgewogICAgICAgICAgICAgICAgQWRqdXN0RGl2UG9zaXRpb24oKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvLyDlj6rmnInpobXpnaLkuI3mu5rliqjnmoTml7blgJnmiY3og73mlK/mjIEKICAgICAgICBpZiAoZ19zZXR0aW5ncy5zY3JvbGxMb2NrV2hlblByZXZpZXcpIHsKICAgICAgICAgICAgJChyZXR1cm5NYXAuY29udHJvbEVsZW1lbnRzKS5iaW5kKCdvbndoZWVsJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSA/ICd3aGVlbCcgOiAnbW91c2V3aGVlbCcsIGZ1bmN0aW9uIChldikgewogICAgICAgICAgICAgICAgJCgnLnBwLWltYWdlJykudHJpZ2dlcihldik7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgLy8g6L+Z5Liq6aG16Z2i5pyJ6Ieq5Yqo5Yqg6L29CiAgICAgICAgaWYgKFBhZ2VzW2dfcGFnZVR5cGVdLkhhc0F1dG9Mb2FkICYmIGF1dG9Mb2FkSW50ZXJ2YWwgPT0gbnVsbCkgewogICAgICAgICAgICBhdXRvTG9hZEludGVydmFsID0gc2V0SW50ZXJ2YWwoUHJvY2Vzc0F1dG9Mb2FkLCAxMDAwKTsKICAgICAgICAgICAgaUxvZy5kKCdBdXRvIGxvYWQgaW50ZXJ2YWwgc2V0LicpOwogICAgICAgIH0KCiAgICAgICAgLy8g5o+S5LiA5q615Zue6LCD5Ye95pWwCiAgICAgICAgdW5zYWZlV2luZG93LlByZXZpZXdDYWxsYmFjayA9IFByZXZpZXdDYWxsYmFjazsKICAgICAgICBpTG9nLmQoJ0NhbGxiYWNrIGZ1bmN0aW9uIHdhcyBpbnNlcnRlZC4nKTsKICAgICAgICBpTG9nLmQodW5zYWZlV2luZG93LlByZXZpZXdDYWxsYmFjayk7CgogICAgICAgIGlMb2cuaSgnUHJldmlldyBlbmFibGUgc3VjY2VlZCEnKTsKICAgIH0KCiAgICAvLyDlhbPpl63pooTop4jlip/og73vvIzkuI3mmK/nu5nlpJbpg6jnlKjnmoQKICAgIGZ1bmN0aW9uIERlYWN0aXZlUHJldmlldygpIHsKICAgICAgICBsZXQgcmV0dXJuTWFwID0gUGFnZXNbZ19wYWdlVHlwZV0uR2V0UHJvY2Vzc2VkUGFnZUVsZW1lbnRzKCk7CiAgICAgICAgaWYgKCFyZXR1cm5NYXAubG9hZGluZ0NvbXBsZXRlKSB7CiAgICAgICAgICAgIGlMb2cuZSgnUGFnZSBub3QgbG9hZCwgc2hvdWxkIG5vdCBjYWxsIFByZXZpZXchJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIOWPqumcgOimgeWPlua2iOe7keWumuS6i+S7tu+8jCBhdHRycyDku6Xlj4rlm57osIPpg73kuI3pnIDopoHliKDpmaQKICAgICAgICAkKHJldHVybk1hcC5jb250cm9sRWxlbWVudHMpLnVuYmluZCgnbW91c2VlbnRlcicpLnVuYmluZCgnbW91c2VsZWF2ZScpLnVuYmluZCgnbW91c2Vtb3ZlJyk7CgogICAgICAgIGlmIChhdXRvTG9hZEludGVydmFsKSB7CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYXV0b0xvYWRJbnRlcnZhbCk7CiAgICAgICAgICAgIGF1dG9Mb2FkSW50ZXJ2YWwgPSBudWxsOwogICAgICAgIH0KCiAgICAgICAgaUxvZy5pKCdQcmV2aWV3IGRpc2FibGUgc3VjY2VlZCEnKTsKICAgIH0KCiAgICAvLyBpZnJhbWUg55qE5Zue6LCD5Ye95pWwCiAgICBmdW5jdGlvbiBQcmV2aWV3Q2FsbGJhY2soY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodCkgewogICAgICAgIGlMb2cuZCgnaWZyYW1lIGNhbGxiYWNrLCB3aWR0aDogJyArIGNhbnZhc1dpZHRoICsgJywgaGVpZ2h0OiAnICsgY2FudmFzSGVpZ2h0KTsKCiAgICAgICAgbGV0IHNpemUgPSBBZGp1c3REaXZQb3NpdGlvbigpOwoKICAgICAgICAkKCcucHAtbG9hZGluZycpLmhpZGUoKTsKICAgICAgICAkKCcucHAtaWZyYW1lJykuY3NzKHsgJ3dpZHRoJzogc2l6ZS53aWR0aCwgJ2hlaWdodCc6IHNpemUuaGVpZ2h0IH0pLnNob3coKTsKICAgIH0KCiAgICAvLyDosIPmlbTpooTop4ggRGl2IOeahOS9jee9rgogICAgZnVuY3Rpb24gQWRqdXN0RGl2UG9zaXRpb24oKSB7CiAgICAgICAgLy8g6byg5qCH5Yiw6aKE6KeI5Zu+55qE6Led56a7CiAgICAgICAgbGV0IGZyb21Nb3VzZVRvRGl2ID0gMzA7CgogICAgICAgIGxldCBzY3JlZW5XaWR0aCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDsKICAgICAgICBsZXQgc2NyZWVuSGVpZ2h0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDsKICAgICAgICBsZXQgbGVmdCA9IDA7CiAgICAgICAgbGV0IHRvcCA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDsKCiAgICAgICAgbGV0IHdpZHRoID0gMCwgaGVpZ2h0ID0gMDsKICAgICAgICBsZXQgdWdvaXJhID0gJCgnLnBwLW1haW4nKS5maW5kKCdjYW52YXMnKS5sZW5ndGggPiAwOwogICAgICAgIGlmICh1Z29pcmEpIHsKICAgICAgICAgICAgd2lkdGggPSAkKCcucHAtaW1hZ2UnKS5nZXQoMCkgPT0gbnVsbCA/IDAgOiAkKCcucHAtaW1hZ2UnKS5nZXQoMCkud2lkdGg7CiAgICAgICAgICAgIGhlaWdodCA9ICQoJy5wcC1pbWFnZScpLmdldCgwKSA9PSBudWxsID8gMCA6ICQoJy5wcC1pbWFnZScpLmdldCgwKS5oZWlnaHQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJCgnLnBwLWltYWdlJykuY3NzKHsgJ3dpZHRoJzogJycsICdoZWlnaHQnOiAnJyB9KTsKICAgICAgICAgICAgd2lkdGggPSAkKCcucHAtaW1hZ2UnKS5nZXQoMCkgPT0gbnVsbCA/IDAgOiAkKCcucHAtaW1hZ2UnKS5nZXQoMCkud2lkdGg7CiAgICAgICAgICAgIGhlaWdodCA9ICQoJy5wcC1pbWFnZScpLmdldCgwKSA9PSBudWxsID8gMCA6ICQoJy5wcC1pbWFnZScpLmdldCgwKS5oZWlnaHQ7CiAgICAgICAgfQoKICAgICAgICBsZXQgbmV3V2lkdGggPSA0OCwgbmV3SGVpZ2h0ID0gNDg7CiAgICAgICAgaWYgKGdfc2V0dGluZ3MucHJldmlld0Z1bGxTY3JlZW4pIHsKICAgICAgICAgICAgbmV3V2lkdGggPSBzY3JlZW5XaWR0aDsKICAgICAgICAgICAgbmV3SGVpZ2h0ID0gaGVpZ2h0IC8gd2lkdGggKiBuZXdXaWR0aDsKICAgICAgICAgICAgaWYgKG5ld0hlaWdodCA+IHNjcmVlbkhlaWdodCkgewogICAgICAgICAgICAgICAgbmV3SGVpZ2h0ID0gc2NyZWVuSGVpZ2h0OwogICAgICAgICAgICAgICAgbmV3V2lkdGggPSBuZXdIZWlnaHQgLyBoZWlnaHQgKiB3aWR0aDsKICAgICAgICAgICAgfQogICAgICAgICAgICBuZXdIZWlnaHQgLT0gNTsKICAgICAgICAgICAgbmV3V2lkdGggLT0gNTsKICAgICAgICAgICAgJCgnLnBwLWltYWdlJykuY3NzKHsgJ2hlaWdodCc6IG5ld0hlaWdodCArICdweCcsICd3aWR0aCc6IG5ld1dpZHRoICsgJ3B4JyB9KTsKICAgICAgICAgICAgJCgnLnBwLW1haW4nKS5jc3MoeyAnbGVmdCc6ICcwcHgnLCAndG9wJzogJzBweCcsICd3aWR0aCc6IHNjcmVlbldpZHRoIC0gNSwgJ2hlaWdodCc6IHNjcmVlbkhlaWdodCAtIDUgfSk7CgogICAgICAgICAgICAvLyDov5Tlm57mlrDnmoTlrr3pq5gKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIHdpZHRoOiBuZXdXaWR0aCwKICAgICAgICAgICAgICAgIGhlaWdodDogbmV3SGVpZ2h0LAogICAgICAgICAgICB9OwogICAgICAgIH0KCiAgICAgICAgbGV0IGlzU2hvd09uTGVmdCA9IGdfbW91c2VQb3MueCA+IHNjcmVlbldpZHRoIC8gMjsKICAgICAgICBpZiAod2lkdGggPiAwICYmIGhlaWdodCA+IDApIHsKICAgICAgICAgICAgbmV3V2lkdGggPSBpc1Nob3dPbkxlZnQgPyBnX21vdXNlUG9zLnggLSBmcm9tTW91c2VUb0RpdiA6IHNjcmVlbldpZHRoIC0gZ19tb3VzZVBvcy54IC0gZnJvbU1vdXNlVG9EaXY7CiAgICAgICAgICAgIG5ld0hlaWdodCA9IGhlaWdodCAvIHdpZHRoICogbmV3V2lkdGg7CiAgICAgICAgICAgIC8vIOmrmOW6puS4jei2s+S7peWujOaVtOaYvuekuu+8jOWPquiDveiuqeS4pOS+p+eVmeepuuS6hgogICAgICAgICAgICBpZiAobmV3SGVpZ2h0ID4gc2NyZWVuSGVpZ2h0KSB7CiAgICAgICAgICAgICAgICBuZXdIZWlnaHQgPSBzY3JlZW5IZWlnaHQ7CiAgICAgICAgICAgICAgICBuZXdXaWR0aCA9IG5ld0hlaWdodCAvIGhlaWdodCAqIHdpZHRoOwogICAgICAgICAgICB9CiAgICAgICAgICAgIG5ld1dpZHRoIC09IDU7CiAgICAgICAgICAgIG5ld0hlaWdodCAtPSA1OwoKICAgICAgICAgICAgLy8g6K6+572u5paw55qE5a696auYCiAgICAgICAgICAgICQoJy5wcC1pbWFnZScpLmNzcyh7ICdoZWlnaHQnOiBuZXdIZWlnaHQgKyAncHgnLCAnd2lkdGgnOiBuZXdXaWR0aCArICdweCcgfSk7CgogICAgICAgICAgICAvLyDosIPmlbTkuIvkuIDmrKEgbG9hZGluZyDlh7rnjrDnmoTkvY3nva4KICAgICAgICAgICAgJCgnLnBwLWxvYWRpbmcnKS5jc3MoeyAnbGVmdCc6IG5ld1dpZHRoIC8gMiAtIDI0ICsgJ3B4JywgJ3RvcCc6IG5ld0hlaWdodCAvIDIgLSAyNCArICdweCcgfSk7CiAgICAgICAgfQoKICAgICAgICAvLyDlm77niYflrr3luqblpKfkuo7pq5jluqblvojlpJrml7bvvIzkvJrmmL7npLrlnKjpobXpnaLpobbpg6jvvIzpvKDmoIfnorDkuI3liLDvvIzmiorlroPnp7vliqjliLDkuIvpnaIKICAgICAgICBpZiAodG9wICsgbmV3SGVpZ2h0IDw9IGdfbW91c2VQb3MueSkgewogICAgICAgICAgICB0b3AgPSAoZ19tb3VzZVBvcy55IC0gbmV3SGVpZ2h0IC0gZnJvbU1vdXNlVG9EaXYpOwogICAgICAgIH0KICAgICAgICAvLyDosIPmlbRESVbnmoTkvY3nva4KICAgICAgICBsZWZ0ID0gaXNTaG93T25MZWZ0ID8gZ19tb3VzZVBvcy54IC0gbmV3V2lkdGggLSBmcm9tTW91c2VUb0RpdiA6IGdfbW91c2VQb3MueCArIGZyb21Nb3VzZVRvRGl2OwoKICAgICAgICAkKCcucHAtbWFpbicpLmNzcyh7ICdsZWZ0JzogbGVmdCArICdweCcsICd0b3AnOiB0b3AgKyAncHgnLCAnd2lkdGgnOiBuZXdXaWR0aCwgJ2hlaWdodCc6IG5ld0hlaWdodCB9KTsKCiAgICAgICAgLy8g6L+U5Zue5paw55qE5a696auYCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgd2lkdGg6IG5ld1dpZHRoLAogICAgICAgICAgICBoZWlnaHQ6IG5ld0hlaWdodCwKICAgICAgICB9OwogICAgfQoKICAgIC8vIOivt+axguaYvuekuueahOmihOiniOWbvklECiAgICBsZXQgZGlzcGxheVRhcmdldElsbHVzdElkID0gJyc7CiAgICAvLyDmmL7npLrpooTop4jlm74KICAgIGZ1bmN0aW9uIFZpZXdJbWFnZXMocmVndWxhciwgaW5kZXgsIG9yaWdpbmFsLCBpc1Nob3dPcmlnaW5hbCwgaWxsdXN0SWQpIHsKICAgICAgICBkaXNwbGF5VGFyZ2V0SWxsdXN0SWQgPSBpbGx1c3RJZDsKICAgICAgICBpZiAoIXJlZ3VsYXIgfHwgcmVndWxhci5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgaUxvZy5lKCdSZWd1bGFyIHVybCBhcnJheSBpcyBudWxsLCBjYW4gbm90IHZpZXcgaW1hZ2VzIScpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChpbmRleCA9PSBudWxsIHx8IGluZGV4IDwgMCB8fCBpbmRleCA+PSByZWd1bGFyLmxlbmd0aCkgewogICAgICAgICAgICBpTG9nLmUoJ0luZGV4KCcgKyBpbmRleCArICcpIG91dCBvZiByYW5nZSwgY2FuIG5vdCB2aWV3IGltYWdlcyEnKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAob3JpZ2luYWwgPT0gbnVsbCB8fCBvcmlnaW5hbC5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgaUxvZy53KCdPcmlnaW5hbCBhcnJheSBpcyBudWxsLCByZXBsYWNlIGl0IHdpdGggcmVndWxhciBhcnJheS4nKTsKICAgICAgICAgICAgb3JpZ2luYWwgPSByZWd1bGFyOwogICAgICAgIH0KICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDwgcmVndWxhcikgewogICAgICAgICAgICBpTG9nLncoJ09yaWdpbmFsIGFycmF5XCdzIGxlbmd0aCBpcyBsZXNzIHRoYW4gcmVndWxhciBhcnJheSwgcmVwbGFjZSBpdCB3aXRoIHJlZ3VsYXIgYXJyYXkuJyk7CiAgICAgICAgICAgIG9yaWdpbmFsID0gcmVndWxhcjsKICAgICAgICB9CiAgICAgICAgaWYgKGlzU2hvd09yaWdpbmFsID09IG51bGwpIHsKICAgICAgICAgICAgaXNTaG93T3JpZ2luYWwgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmIChvcmlnaW5hbC5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICQoJy5wcC1wYWdlJykudGV4dCgoaW5kZXggKyAxKSArICcvJyArIHJlZ3VsYXIubGVuZ3RoKTsKICAgICAgICAgICAgJCgnLnBwLXBhZ2VDb3VudCcpLnNob3coKTsKICAgICAgICB9CiAgICAgICAgaWYgKGlzU2hvd09yaWdpbmFsKSB7CiAgICAgICAgICAgICQoJy5wcC1pbWFnZScpLmFkZENsYXNzKCdvcmlnaW5hbCcpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICQoJy5wcC1pbWFnZScpLnJlbW92ZUNsYXNzKCdvcmlnaW5hbCcpOwogICAgICAgIH0KICAgICAgICBnX3NldHRpbmdzLm9yaWdpbmFsID0gaXNTaG93T3JpZ2luYWw7CgogICAgICAgIC8vIOmakOiXj+mhteaVsOWSjOWOn+Wbvuagh+etvgogICAgICAgICQoJy5wcC1vcmlnaW5hbCwgLnBwLXBhZ2VDb3VudCcpLmhpZGUoKTsKCiAgICAgICAgLy8g56ys5LiA5qyh6ZyA6KaB57uR5a6a5LqL5Lu2CiAgICAgICAgaWYgKCQoJy5wcC1pbWFnZScpLmF0dHIoJ2luZGV4JykgPT0gbnVsbCB8fCAkKCcucHAtaW1hZ2UnKS5hdHRyKCdwYWdlQ291bnQnKSAhPSByZWd1bGFyLmxlbmd0aCkgewogICAgICAgICAgICAkKCcucHAtaW1hZ2UnKS5hdHRyKCdwYWdlQ291bnQnLCByZWd1bGFyLmxlbmd0aCk7CgogICAgICAgICAgICAvLyDnu5Hlrprngrnlh7vkuovku7bvvIxDdHJsK+W3pumUriDljZXlh7vliIfmjaLljp/lm74KICAgICAgICAgICAgJCgnLnBwLWltYWdlJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGV2KSB7CiAgICAgICAgICAgICAgICBsZXQgX3RoaXMgPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgbGV0IGlzT3JpZ2luYWwgPSBfdGhpcy5oYXNDbGFzcygnb3JpZ2luYWwnKTsKICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IF90aGlzLmF0dHIoJ2luZGV4Jyk7CiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGluZGV4ID0gMDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaW5kZXggPSBwYXJzZUludChpbmRleCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGV2LmN0cmxLZXkpIHsKICAgICAgICAgICAgICAgICAgICAvLyDmjInkvY8gQ3RybCDmnaXlm57liIfmjaLljp/lm74KICAgICAgICAgICAgICAgICAgICBpc09yaWdpbmFsID0gIWlzT3JpZ2luYWw7CiAgICAgICAgICAgICAgICAgICAgVmlld0ltYWdlcyhyZWd1bGFyLCBpbmRleCwgb3JpZ2luYWwsIGlzT3JpZ2luYWwsIGlsbHVzdElkKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKGV2LnNoaWZ0S2V5KSB7CiAgICAgICAgICAgICAgICAgICAgLy8g5oyJ5L2PIFNoaWZ0IOeCueWHu+WbvueJh+aWsOagh+etvumhteaJk+W8gOWOn+WbvgogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5vcGVuKG9yaWdpbmFsW2luZGV4XSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmIChyZWd1bGFyLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy8g5aaC5p6c5piv5aSa5Zu+77yM54K55Ye75YiH5o2i5LiL5LiA5bygCiAgICAgICAgICAgICAgICAgICAgaWYgKCsraW5kZXggPj0gcmVndWxhci5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXggPSAwOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBWaWV3SW1hZ2VzKHJlZ3VsYXIsIGluZGV4LCBvcmlnaW5hbCwgaXNPcmlnaW5hbCwgaWxsdXN0SWQpOwogICAgICAgICAgICAgICAgICAgIC8vIOmihOWKoOi9vQogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBpbmRleCArIDE7IGkgPCByZWd1bGFyLmxlbmd0aCAmJiBpIDw9IGluZGV4ICsgMzsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbWFnZSA9IG5ldyBJbWFnZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBpbWFnZS5zcmMgPSBpc09yaWdpbmFsID8gb3JpZ2luYWxbaV0gOiByZWd1bGFyW2ldOzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gbW91c2V3aGVlbCBldmVudO+8jOWSjOS4iumdouS4gOaoowogICAgICAgICAgICAkKCcucHAtaW1hZ2UnKS5iaW5kKCdvbndoZWVsJyBpbiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKSA/ICd3aGVlbCcgOiAnbW91c2V3aGVlbCcsIGZ1bmN0aW9uIChldikgewogICAgICAgICAgICAgICAgbGV0IF90aGlzID0gJCh0aGlzKTsKICAgICAgICAgICAgICAgIGxldCBpc09yaWdpbmFsID0gX3RoaXMuaGFzQ2xhc3MoJ29yaWdpbmFsJyk7CiAgICAgICAgICAgICAgICBsZXQgaW5kZXggPSBfdGhpcy5hdHRyKCdpbmRleCcpOwogICAgICAgICAgICAgICAgaWYgKGluZGV4ID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpbmRleCA9IDA7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGluZGV4ID0gcGFyc2VJbnQoaW5kZXgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChyZWd1bGFyLmxlbmd0aCA9PSAxKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8g5aaC5p6c5piv5aSa5Zu+77yM54K55Ye75YiH5o2i5LiL5LiA5bygCiAgICAgICAgICAgICAgICBpZiAoZXYub3JpZ2luYWxFdmVudC53aGVlbERlbHRhIDwgMCkgewogICAgICAgICAgICAgICAgICAgIGlmICgrK2luZGV4ID49IHJlZ3VsYXIubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gMDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmICgtLWluZGV4IDwgMCkgewogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCA9IHJlZ3VsYXIubGVuZ3RoIC0gMTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBWaWV3SW1hZ2VzKHJlZ3VsYXIsIGluZGV4LCBvcmlnaW5hbCwgaXNPcmlnaW5hbCwgaWxsdXN0SWQpOwogICAgICAgICAgICAgICAgLy8g6aKE5Yqg6L29CiAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gaW5kZXggKyAxOyBpIDwgcmVndWxhci5sZW5ndGggJiYgaSA8PSBpbmRleCArIDM7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGxldCBpbWFnZSA9IG5ldyBJbWFnZSgpOwogICAgICAgICAgICAgICAgICAgIGltYWdlLnNyYyA9IGlzT3JpZ2luYWwgPyBvcmlnaW5hbFtpXSA6IHJlZ3VsYXJbaV07OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKGdfc2V0dGluZ3MucHJldmlld0Z1bGxTY3JlZW4pIHsKICAgICAgICAgICAgICAgICQoJy5wcC1tYWluJykuYmluZCgnb253aGVlbCcgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JykgPyAnd2hlZWwnIDogJ21vdXNld2hlZWwnLCBmdW5jdGlvbiAoZXYpIHsKICAgICAgICAgICAgICAgICAgICAkKCcucHAtaW1hZ2UnKS50cmlnZ2VyKGV2KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyAgc2Nyb2xsTG9jawogICAgICAgICAgICBpZiAoIWdfc2V0dGluZ3Muc2Nyb2xsTG9ja1doZW5QcmV2aWV3KSB7CiAgICAgICAgICAgICAgICAkKCcucHAtaW1hZ2UnKS5tb3VzZWVudGVyKGRpc2FibGVTY3JvbGwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgICQoIi5wcC1pbWFnZSIpLm1vdXNlbGVhdmUoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgZW5hYmxlU2Nyb2xsKCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8g5Zu+54mH6aKE5Yqg6L295a6M5oiQCiAgICAgICAgICAgICQoJy5wcC1pbWFnZScpLm9uKCdsb2FkJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgLy8g5pi+56S65Zu+54mH5YmN5Lmf5Yik5pat5LiA5LiL5piv5LiN5piv55uu5qCH5Zu+54mHCiAgICAgICAgICAgICAgICBpZiAoZGlzcGxheVRhcmdldElsbHVzdElkICE9IHByZXZpZXdUYXJnZXRJbGx1c3RJZCkgewogICAgICAgICAgICAgICAgICAgIGlMb2cuaSgnKDIpRHJvcCB0aGlzIHByZXZpZXcgcmVxdWVzdC4nKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8g6LCD5pW05Zu+54mH5L2N572u5ZKM5aSn5bCPCiAgICAgICAgICAgICAgICBsZXQgX3RoaXMgPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgbGV0IHNpemUgPSBBZGp1c3REaXZQb3NpdGlvbigpOwogICAgICAgICAgICAgICAgbGV0IGlzU2hvd09yaWdpbmFsID0gX3RoaXMuaGFzQ2xhc3MoJ29yaWdpbmFsJyk7CgogICAgICAgICAgICAgICAgJCgnLnBwLWxvYWRpbmcnKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpOwogICAgICAgICAgICAgICAgLy8g5pi+56S65Zu+5YOP44CB6aG15pWw44CB5Y6f5Zu+5qCH562+CiAgICAgICAgICAgICAgICAkKCcucHAtaW1hZ2UnKS5jc3MoJ2Rpc3BsYXknLCAnJyk7CiAgICAgICAgICAgICAgICBpZiAocmVndWxhci5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBwLXBhZ2VDb3VudCcpLnNob3coKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChpc1Nob3dPcmlnaW5hbCkgewogICAgICAgICAgICAgICAgICAgICQoJy5wcC1vcmlnaW5hbCcpLnNob3coKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyDpooTliqDovb0KICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBpbmRleCArIDE7IGkgPCByZWd1bGFyLmxlbmd0aCAmJiBpIDw9IGluZGV4ICsgMzsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGltYWdlID0gbmV3IEltYWdlKCk7CiAgICAgICAgICAgICAgICAgICAgaW1hZ2Uuc3JjID0gaXNTaG93T3JpZ2luYWwgPyBvcmlnaW5hbFtpXSA6IHJlZ3VsYXJbaV07OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS5vbignZXJyb3InLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBpTG9nLmUoJ0xvYWQgaW1hZ2UgZmFpbGVkIScpOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgICQoJy5wcC1pbWFnZScpLmF0dHIoJ3NyYycsIGlzU2hvd09yaWdpbmFsID8gb3JpZ2luYWxbaW5kZXhdIDogcmVndWxhcltpbmRleF0pLmF0dHIoJ2luZGV4JywgaW5kZXgpOwogICAgfQogICAgLy8g5pi+56S65Yqo5Zu+CiAgICB2YXIgZ191Z29yaWFQbGF5ZXI7CiAgICBmdW5jdGlvbiBWaWV3VWdvaXJhKHJlZ3VsYXIsIG9yaWdpbmFsLCBtaW1lLCBmcmFtZXMsIGlzU2hvd09yaWdpbmFsLCBpbGx1c3RJZCkgewogICAgICAgIGRpc3BsYXlUYXJnZXRJbGx1c3RJZCA9IGlsbHVzdElkOwogICAgICAgIGlmIChpc1Nob3dPcmlnaW5hbCA9PSBudWxsKSB7CiAgICAgICAgICAgIGlzU2hvd09yaWdpbmFsID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBnX3NldHRpbmdzLm9yaWdpbmFsID0gaXNTaG93T3JpZ2luYWw7CgogICAgICAgIGlmICghZ19zZXR0aW5ncy5wcmV2aWV3RnVsbFNjcmVlbikgewogICAgICAgICAgICAkKCIucHAtaW1hZ2UiKS5tb3VzZWVudGVyKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGRpc2FibGVTY3JvbGwoKQogICAgICAgICAgICB9KS5tb3VzZWxlYXZlKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGVuYWJsZVNjcm9sbCgpCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKGdfdWdvcmlhUGxheWVyKSB7CiAgICAgICAgICAgIGdfdWdvcmlhUGxheWVyLnN0b3AoKTsKICAgICAgICB9CiAgICAgICAgZ191Z29yaWFQbGF5ZXIgPSBjcmVhdGVQbGF5ZXIoewogICAgICAgICAgICBzb3VyY2U6IHJlZ3VsYXIsCiAgICAgICAgICAgIG1ldGFkYXRhOiB7CiAgICAgICAgICAgICAgICBtaW1lX3R5cGU6IG1pbWUsCiAgICAgICAgICAgICAgICBmcmFtZXM6IGZyYW1lcywKICAgICAgICAgICAgfSwKICAgICAgICB9KTsKICAgICAgICAvLyBzY3JvbGxMb2NrCiAgICAgICAgJChnX3Vnb3JpYVBsYXllci5jYW52YXMpLm1vdXNlZW50ZXIoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBkaXNhYmxlU2Nyb2xsKCk7CiAgICAgICAgfSkubW91c2VsZWF2ZShmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGVuYWJsZVNjcm9sbCgpOwogICAgICAgIH0pOwogICAgICAgICQoZ191Z29yaWFQbGF5ZXIpLm9uKCJmcmFtZUxvYWRlZCIsIGZ1bmN0aW9uIChldiwgZnJhbWUpIHsKICAgICAgICAgICAgaWYgKGRpc3BsYXlUYXJnZXRJbGx1c3RJZCAhPSBwcmV2aWV3VGFyZ2V0SWxsdXN0SWQpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoZnJhbWUgIT0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBpbWcgPSAkKCcucHAtaW1hZ2UnKTsKICAgICAgICAgICAgaW1nLmFmdGVyKGdfdWdvcmlhUGxheWVyLmNhbnZhcyk7CiAgICAgICAgICAgIGltZy5yZW1vdmUoKTsKICAgICAgICAgICAgbGV0IGNhbnZhcyA9ICQoZ191Z29yaWFQbGF5ZXIuY2FudmFzKTsKICAgICAgICAgICAgY2FudmFzLmFkZENsYXNzKCdwcC1pbWFnZScpOwogICAgICAgICAgICAkKCcucHAtbG9hZGluZycpLmNzcygnZGlzcGxheScsICdub25lJyk7CiAgICAgICAgICAgIGxldCB3ID0gZXYuY3VycmVudFRhcmdldC5fZnJhbWVJbWFnZXNbMF0ud2lkdGg7CiAgICAgICAgICAgIGxldCBoID0gZXYuY3VycmVudFRhcmdldC5fZnJhbWVJbWFnZXNbMF0uaGVpZ2h0OwogICAgICAgICAgICBjYW52YXMuYXR0cih7ICd3aWR0aCc6IHcsICdoZWlnaHQnOiBoIH0pLmNzcyh7ICdib3JkZXItcmFkaXVzJzogJzIwcHgnIH0pOwogICAgICAgICAgICBjYW52YXMuYXR0cih7ICdvcmlnaW5XaWR0aCc6IHcsICdvcmlnaW5IZWlnaHQnOiBoIH0pOwogICAgICAgICAgICBBZGp1c3REaXZQb3NpdGlvbigpOwogICAgICAgIH0pOwogICAgfQoKICAgIC8vIOWkhOeQhuiHquWKqOWKoOi9vQogICAgZnVuY3Rpb24gUHJvY2Vzc0F1dG9Mb2FkKCkgewogICAgICAgIGlmIChQYWdlc1tnX3BhZ2VUeXBlXS5HZXRQcm9jZXNzZWRQYWdlRWxlbWVudHMoKSA9PSBudWxsKSB7CiAgICAgICAgICAgIGlMb2cuZSgnQ2FsbCBQcm9jZXNzUGFnZUVsZW1lbnRzIGZpcnN0IScpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBsZXQgb2xkUmV0dXJuTWFwID0gUGFnZXNbZ19wYWdlVHlwZV0uR2V0UHJvY2Vzc2VkUGFnZUVsZW1lbnRzKCk7CiAgICAgICAgbGV0IG5ld1JldHVybk1hcCA9IFBhZ2VzW2dfcGFnZVR5cGVdLlByb2Nlc3NQYWdlRWxlbWVudHMoKTsKCiAgICAgICAgaWYgKG5ld1JldHVybk1hcC5sb2FkaW5nQ29tcGxldGUpIHsKICAgICAgICAgICAgaWYgKG9sZFJldHVybk1hcC5jb250cm9sRWxlbWVudHMubGVuZ3RoICE9IG5ld1JldHVybk1hcC5jb250cm9sRWxlbWVudHMubGVuZ3RoIHx8IG5ld1JldHVybk1hcC5mb3JjZVVwZGF0ZSkgewogICAgICAgICAgICAgICAgaUxvZy5pKCdQYWdlIGxvYWRlZCAnICsgKG5ld1JldHVybk1hcC5jb250cm9sRWxlbWVudHMubGVuZ3RoIC0gb2xkUmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cy5sZW5ndGgpICsgJyBuZXcgd29yayhzKS4nKTsKCiAgICAgICAgICAgICAgICBTZXRUYXJnZXRCbGFuayhuZXdSZXR1cm5NYXApOwogICAgICAgICAgICAgICAgRGVhY3RpdmVQcmV2aWV3KCk7CiAgICAgICAgICAgICAgICBBY3RpdmVQcmV2aWV3KCk7CgogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9IGVsc2UgaWYgKG9sZFJldHVybk1hcC5jb250cm9sRWxlbWVudHMubGVuZ3RoID4gbmV3UmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgIGlMb2cudygnd29ya3MgYmVjb21lIGxlc3M/Jyk7CgogICAgICAgICAgICAgICAgUGFnZXNbZ19wYWdlVHlwZV0ucHJpdmF0ZS5yZXR1cm5NYXAgPSBvbGRSZXR1cm5NYXA7CgogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpTG9nLmQoJ1BhZ2Ugbm90IGNoYW5nZS4nKTsKICAgIH0KCiAgICAvLyDlvIDlkK/pooTop4gKICAgIEFjdGl2ZVByZXZpZXcoKTsKfQovKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIOaOkuW6jyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovCmxldCBpbWFnZUVsZW1lbnRUZW1wbGF0ZSA9IG51bGw7CmZ1bmN0aW9uIFBpeGl2U0soY2FsbGJhY2spIHsKICAgIC8vIOS4jeWQiOeQhueahOiuvuWumgogICAgaWYgKGdfc2V0dGluZ3MucGFnZUNvdW50IDwgMSB8fCBnX3NldHRpbmdzLmZhdkZpbHRlciA8IDApIHsKICAgICAgICBnX3NldHRpbmdzLnBhZ2VDb3VudCA9IDM7CiAgICAgICAgZ19zZXR0aW5ncy5mYXZGaWx0ZXIgPSAwOwogICAgfQogICAgLy8g5b2T5YmN5bey57uP5Y+W5b6X55qE6aG16Z2i5pWw6YePCiAgICBsZXQgY3VycmVudEdldHRpbmdQYWdlQ291bnQgPSAwOwogICAgLy8g5b2T5YmN5Yqg6L2955qE6aG16Z2iIFVSTAogICAgbGV0IGN1cnJlbnRVcmwgPSAnaHR0cHM6Ly93d3cucGl4aXYubmV0L2FqYXgvc2VhcmNoLyc7CiAgICAvLyDlvZPliY3liqDovb3nmoTmmK/nrKzlh6DlvKDpobXpnaIKICAgIGxldCBjdXJyZW50UGFnZSA9IDA7CiAgICAvLyDojrflj5bliLDnmoTkvZzlk4EKICAgIGxldCB3b3JrcyA9IFtdOwogICAgLy8g5L2c5ZOB5pWw6YePCiAgICBsZXQgd29ya3NDb3VudCA9IDA7CgogICAgLy8g5LuF5pCc57Si6aG15ZCv55SoCiAgICBpZiAoZ19wYWdlVHlwZSAhPSBQYWdlVHlwZS5TZWFyY2gpIHsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgLy8g6I635Y+W56ysIGN1cnJlbnRQYWdlIOmhteeahOS9nOWTgQogICAgLy8g6L+Z5Liq5pa55rOV6L+Y5piv55So5bimIGNvb2tpZSDnmoTor7fmsYLvvIzpmLLmraLmnKrnmbvlvZXmi4nkuI3liLDmlbDmja4KICAgIGxldCBnZXRXb3JrcyA9IGZ1bmN0aW9uIChvbmxvYWRDYWxsYmFjaykgewogICAgICAgICQoJyNwcm9ncmVzcycpLnRleHQoVGV4dHNbZ19sYW5ndWFnZV0uc29ydF9nZXRXb3Jrcy5yZXBsYWNlKCclMScsIGN1cnJlbnRHZXR0aW5nUGFnZUNvdW50ICsgMSkucmVwbGFjZSgnJTInLCBnX3NldHRpbmdzLnBhZ2VDb3VudCkpOwoKICAgICAgICBsZXQgdXJsID0gY3VycmVudFVybC5yZXBsYWNlKC9wPVxkKy8sICdwPScgKyBjdXJyZW50UGFnZSk7CgogICAgICAgIGlmIChsb2NhdGlvbi5ocmVmLmluZGV4T2YoJz8nKSAhPSAtMSkgewogICAgICAgICAgICBsZXQgcGFyYW0gPSBsb2NhdGlvbi5ocmVmLnNwbGl0KCc/JylbMV07CiAgICAgICAgICAgIHBhcmFtID0gcGFyYW0ucmVwbGFjZSgvXnA9XGQrLywgJycpOwogICAgICAgICAgICBwYXJhbSA9IHBhcmFtLnJlcGxhY2UoLyZwPVxkKy8sICcnKTsKICAgICAgICAgICAgdXJsICs9ICcmJyArIHBhcmFtOwogICAgICAgIH0KCiAgICAgICAgaWYgKHVybC5pbmRleE9mKCdvcmRlcj0nKSA9PSAtMSkgewogICAgICAgICAgICB1cmwgKz0gJyZvcmRlcj1kYXRlX2QnOwogICAgICAgIH0KICAgICAgICBpZiAodXJsLmluZGV4T2YoJ21vZGU9JykgPT0gLTEpIHsKICAgICAgICAgICAgdXJsICs9ICcmbW9kZT1hbGwnOwogICAgICAgIH0KICAgICAgICBpZiAodXJsLmluZGV4T2YoJ3NfbW9kZT0nKSA9PSAtMSkgewogICAgICAgICAgICB1cmwgKz0gJyZzX21vZGU9c190YWdfZnVsbCc7CiAgICAgICAgfQoKICAgICAgICBpTG9nLmkoJ2dldFdvcmtzIHVybDogJyArIHVybCk7CgogICAgICAgIGxldCByZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgICByZXEub3BlbignR0VUJywgdXJsLCB0cnVlKTsKICAgICAgICByZXEub25sb2FkID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICAgICAgICAgIG9ubG9hZENhbGxiYWNrKHJlcSk7CiAgICAgICAgfTsKICAgICAgICByZXEub25lcnJvciA9IGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICBpTG9nLmUoJ1JlcXVlc3Qgc2VhcmNoIHBhZ2UgZXJyb3IhJyk7CiAgICAgICAgfTsKCiAgICAgICAgcmVxLnNlbmQobnVsbCk7CiAgICB9OwoKICAgIGZ1bmN0aW9uIGdldEZvbGxvd2luZ09mVHlwZSh1c2VyX2lkLCB0eXBlLCBvZmZzZXQpIHsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICBpZiAob2Zmc2V0ID09IG51bGwpIHsKICAgICAgICAgICAgICAgIG9mZnNldCA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGxpbWl0ID0gMTAwOwogICAgICAgICAgICBsZXQgZm9sbG93aW5nX3Nob3cgPSBbXTsKICAgICAgICAgICAgJC5hamF4KCdodHRwczovL3d3dy5waXhpdi5uZXQvYWpheC91c2VyLycgKyB1c2VyX2lkICsgJy9mb2xsb3dpbmc/b2Zmc2V0PScgKyBvZmZzZXQgKyAnJmxpbWl0PScgKyBsaW1pdCArICcmcmVzdD0nICsgdHlwZSwgewogICAgICAgICAgICAgICAgYXN5bmM6IHRydWUsCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhID09IG51bGwgfHwgZGF0YS5lcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmUoJ0ZvbGxvd2luZyByZXNwb25zZSBjb250YWlucyBhbiBlcnJvci4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShbXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuYm9keS51c2Vycy5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFtdKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkLmVhY2goZGF0YS5ib2R5LnVzZXJzLCBmdW5jdGlvbiAoaSwgdXNlcikgewogICAgICAgICAgICAgICAgICAgICAgICBmb2xsb3dpbmdfc2hvdy5wdXNoKHVzZXIudXNlcklkKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBnZXRGb2xsb3dpbmdPZlR5cGUodXNlcl9pZCwgdHlwZSwgb2Zmc2V0ICsgbGltaXQpLnRoZW4oZnVuY3Rpb24gKG1lbWJlcnMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmb2xsb3dpbmdfc2hvdy5jb25jYXQobWVtYmVycykpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBpTG9nLmUoJ1JlcXVlc3QgZm9sbG93aW5nIGZhaWxlZC4nKTsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKFtdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Rm9sbG93aW5nT2ZDdXJyZW50VXNlcigpIHsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICBsZXQgdXNlcl9pZCA9ICcnOwoKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHVzZXJfaWQgPSBkYXRhTGF5ZXJbMF0udXNlcl9pZDsKICAgICAgICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAgICAgICAgIGlMb2cuZSgnR2V0IHVzZXIgaWQgZmFpbGVkLicpOwogICAgICAgICAgICAgICAgcmVzb2x2ZShbXSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHNob3cvaGlkZQogICAgICAgICAgICAkKCcjcHJvZ3Jlc3MnKS50ZXh0KFRleHRzW2dfbGFuZ3VhZ2VdLnNvcnRfZ2V0UHVibGljRm9sbG93aW5nKTsKCiAgICAgICAgICAgIGxldCBmb2xsb3dpbmcgPSBHZXRMb2NhbFN0b3JhZ2UoJ2ZvbGxvd2luZ09mVWlkLScgKyB1c2VyX2lkKTsKICAgICAgICAgICAgaWYgKGZvbGxvd2luZyAhPSBudWxsICYmIGZvbGxvd2luZyAhPSAnbnVsbCcpIHsKICAgICAgICAgICAgICAgIHJlc29sdmUoSlNPTi5wYXJzZShmb2xsb3dpbmcpKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZ2V0Rm9sbG93aW5nT2ZUeXBlKHVzZXJfaWQsICdzaG93JykudGhlbihmdW5jdGlvbiAobWVtYmVycykgewogICAgICAgICAgICAgICAgJCgnI3Byb2dyZXNzJykudGV4dChUZXh0c1tnX2xhbmd1YWdlXS5zb3J0X2dldFByaXZhdGVGb2xsb3dpbmcpOwogICAgICAgICAgICAgICAgZ2V0Rm9sbG93aW5nT2ZUeXBlKHVzZXJfaWQsICdoaWRlJykudGhlbihmdW5jdGlvbiAobWVtYmVyczIpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZm9sbG93aW5nID0gbWVtYmVycy5jb25jYXQobWVtYmVyczIpOwogICAgICAgICAgICAgICAgICAgIFNldExvY2FsU3RvcmFnZSgnZm9sbG93aW5nT2ZVaWQtJyArIHVzZXJfaWQsIGZvbGxvd2luZyk7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShmb2xsb3dpbmcpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfQoKICAgIC8vIOetm+mAieW3suWFs+azqOeUu+W4iOS9nOWTgQogICAgbGV0IGZpbHRlckJ5VXNlciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICBpZiAoIWdfc2V0dGluZ3MuaGlkZUZvbGxvd2VkKSB7CiAgICAgICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGdldEZvbGxvd2luZ09mQ3VycmVudFVzZXIoKS50aGVuKGZ1bmN0aW9uIChtZW1iZXJzKSB7CiAgICAgICAgICAgICAgICBsZXQgdGVtcFdvcmtzID0gW107CiAgICAgICAgICAgICAgICBsZXQgaGlkZVdvcmtDb3VudCA9IDA7CiAgICAgICAgICAgICAgICAkKHdvcmtzKS5lYWNoKGZ1bmN0aW9uIChpLCB3b3JrKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGZvdW5kID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZW1iZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtZW1iZXJzW2ldID09IHdvcmsudXNlcklkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoIWZvdW5kKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBXb3Jrcy5wdXNoKHdvcmspOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVXb3JrQ291bnQrKzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHdvcmtzID0gdGVtcFdvcmtzOwoKICAgICAgICAgICAgICAgIGlMb2cuaShoaWRlV29ya0NvdW50ICsgJyB3b3JrcyB3ZXJlIGhpZGUgYnkgZm9sbG93ZWQgdXNlci4nKTsKICAgICAgICAgICAgICAgIGlMb2cuZCh3b3Jrcyk7CiAgICAgICAgICAgICAgICByZXNvbHZlKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfTsKCiAgICAvLyDmjpLluo/lkoznrZvpgIkKICAgIC8vIHNvcnRUeXBlOiAw77ya5pS26JeP77yI5Zac5qyi77yJ77ybMe+8mueCuei1nu+8mzLvvJrmn6XnnIsKICAgIGxldCBmaWx0ZXJBbmRTb3J0ID0gZnVuY3Rpb24gKHNvcnRUeXBlID0gMCkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgIGlMb2cuaSgnU3RhcnQgc29ydC4nKTsKICAgICAgICAgICAgaUxvZy5kKHdvcmtzKTsKCiAgICAgICAgICAgIC8vIOaUtuiXj+mHj+S9juS6jiBGQVZfRklMVEVSIOeahOS9nOWTgeS4jeaYvuekugogICAgICAgICAgICBsZXQgdGV4dCA9IFRleHRzW2dfbGFuZ3VhZ2VdLnNvcnRfZmlsdGVyaW5nLnJlcGxhY2UoJyUyJywgZ19zZXR0aW5ncy5mYXZGaWx0ZXIpOwogICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKCclMScsIChnX3NldHRpbmdzLmhpZGVGYXZvcml0ZSA/IFRleHRzW2dfbGFuZ3VhZ2VdLnNvcnRfZmlsdGVyaW5nSGlkZUZhdm9yaXRlIDogJycpKTsKICAgICAgICAgICAgJCgnI3Byb2dyZXNzJykudGV4dCh0ZXh0KTsgLy8g5a6e6ZmF5LiK6L+Z5Liq5aSq5b+r5a6M5YWo55yL5LiN5YiwCiAgICAgICAgICAgIGxldCB0bXAgPSBbXTsKICAgICAgICAgICAgbGV0IGJvb2ttYXJrRmlsdGVyZWRDb3VudCA9IDA7CiAgICAgICAgICAgIGxldCBhaUZpbHRlcmVkQ291bnQgPSAwOwogICAgICAgICAgICBsZXQgdGFnRmlsdGVyZWRDb3VudCA9IDA7CiAgICAgICAgICAgIGxldCB1c2VyRmlsdGVyZWRDb3VudCA9IDA7CiAgICAgICAgICAgIGxldCBjb3VudEZpbHRlcmVkQ291bnQgPSAwOwogICAgICAgICAgICAkKHdvcmtzKS5lYWNoKGZ1bmN0aW9uIChpLCB3b3JrKSB7CiAgICAgICAgICAgICAgICBsZXQgYm9va21hcmtDb3VudCA9IHdvcmsuYm9va21hcmtDb3VudCA/IHdvcmsuYm9va21hcmtDb3VudCA6IDA7CiAgICAgICAgICAgICAgICBpZiAoYm9va21hcmtDb3VudCA8IGdfc2V0dGluZ3MuZmF2RmlsdGVyKSB7CiAgICAgICAgICAgICAgICAgICAgYm9va21hcmtGaWx0ZXJlZENvdW50Kys7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5oaWRlRmF2b3JpdGUgJiYgd29yay5ib29rbWFya0RhdGEpIHsKICAgICAgICAgICAgICAgICAgICBib29rbWFya0ZpbHRlcmVkQ291bnQrKzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvKiDigJTigJQgQXBwbHkgQUkgYXJ0d29ya3MgZmlsdGVyIGZpcnN0bHksIHRoZW4gY2hlY2sgc2hvdyBBSSBhcnR3b3JrcyBvbmx5IGZsYWcg4oCU4oCUICovCiAgICAgICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5haUZpbHRlciA9PSAxICYmIHdvcmsuYWlUeXBlID09IDIpIHsKICAgICAgICAgICAgICAgICAgICBhaUZpbHRlcmVkQ291bnQrKzsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChnX3NldHRpbmdzLmFpT25seSAmJiB3b3JrLmFpVHlwZSAhPSAyKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGdfc2V0dGluZ3MuaGlkZUJ5VGFnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJlZ2V4ID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5oaWRlQnlUYWdSZWdleCAmJiBnX3NldHRpbmdzLmhpZGVCeVRhZ1JlZ2V4LnRyaW0oKSAhPT0gJycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZ2V4ID0gbmV3IFJlZ0V4cChnX3NldHRpbmdzLmhpZGVCeVRhZ1JlZ2V4KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy53KCdJbnZhbGlkIGhpZGVCeVRhZ1JlZ2V4OiAnICsgZ19zZXR0aW5ncy5oaWRlQnlUYWdSZWdleCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChyZWdleCAmJiByZWdleC50ZXN0KHdvcmsudGFncykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGFnRmlsdGVyZWRDb3VudCsrOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5oaWRlQnlVc2VyKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHVzZXJzID0gbnVsbDsKICAgICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgICAgICB1c2VycyA9IGdfc2V0dGluZ3MuaGlkZUJ5VXNlckxpc3Quc3BsaXQoJ3wnKS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnRyaW0oKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpTG9nLncoJ0ludmFsaWQgaGlkZUJ5VXNlcjogJyArIGdfc2V0dGluZ3MuaGlkZUJ5VXNlckxpc3QpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAodXNlcnMgJiYgdXNlcnMuaW5jbHVkZXMod29yay51c2VySWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXJGaWx0ZXJlZENvdW50Kys7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChnX3NldHRpbmdzLmhpZGVDb3VudExlc3NUaGFuID49IDAgJiYKICAgICAgICAgICAgICAgICAgICBnX3NldHRpbmdzLmhpZGVDb3VudE1vcmVUaGFuID49IDApIHsKICAgICAgICAgICAgICAgICAgICBsZXQgbGVzcyA9IGdfc2V0dGluZ3MuaGlkZUNvdW50TGVzc1RoYW47CiAgICAgICAgICAgICAgICAgICAgbGV0IG1vcmUgPSBnX3NldHRpbmdzLmhpZGVDb3VudE1vcmVUaGFuOwogICAgICAgICAgICAgICAgICAgIGxldCBwYWdlQ291bnQgPSAxOwogICAgICAgICAgICAgICAgICAgIGlmICh3b3JrLnBhZ2VDb3VudCkgewogICAgICAgICAgICAgICAgICAgICAgICBwYWdlQ291bnQgPSB3b3JrLnBhZ2VDb3VudDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGxlc3MgPiAwICYmIHBhZ2VDb3VudCA8IGxlc3MpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY291bnRGaWx0ZXJlZENvdW50Kys7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAobW9yZSA+IDAgJiYgcGFnZUNvdW50ID4gbW9yZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjb3VudEZpbHRlcmVkQ291bnQrKzsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdG1wLnB1c2god29yayk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpTG9nLmkoYm9va21hcmtGaWx0ZXJlZENvdW50ICsgJyB3b3JrcyB3ZXJlIGhpZGUgYnkgYm9va21hcmsgY291bnQuJyk7CiAgICAgICAgICAgIGlMb2cuaShhaUZpbHRlcmVkQ291bnQgKyAnIHdvcmtzIHdlcmUgaGlkZSBieSBBSSB0eXBlLicpOwogICAgICAgICAgICBpTG9nLmkodGFnRmlsdGVyZWRDb3VudCArICcgd29ya3Mgd2VyZSBoaWRlIGJ5IHRhZy4nKTsKICAgICAgICAgICAgaUxvZy5pKHVzZXJGaWx0ZXJlZENvdW50ICsgJyB3b3JrcyB3ZXJlIGhpZGUgYnkgdXNlci4nKTsKICAgICAgICAgICAgaUxvZy5pKGNvdW50RmlsdGVyZWRDb3VudCArICcgd29ya3Mgd2VyZSBoaWRlIGJ5IHBhZ2UgY291bnQuJyk7CiAgICAgICAgICAgIHdvcmtzID0gdG1wOwoKICAgICAgICAgICAgZmlsdGVyQnlVc2VyKCkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAvLyDmjpLluo8KICAgICAgICAgICAgICAgIHdvcmtzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZmF2QSA9IDA7CiAgICAgICAgICAgICAgICAgICAgbGV0IGZhdkIgPSAwOwogICAgICAgICAgICAgICAgICAgIGlmIChzb3J0VHlwZSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZhdkEgPSBhLmJvb2ttYXJrQ291bnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGZhdkIgPSBiLmJvb2ttYXJrQ291bnQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNvcnRUeXBlID09IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmF2QSA9IGEubGlrZUNvdW50OwogICAgICAgICAgICAgICAgICAgICAgICBmYXZCID0gYi5saWtlQ291bnQ7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzb3J0VHlwZSA9PSAyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZhdkEgPSBhLnZpZXdDb3VudDsKICAgICAgICAgICAgICAgICAgICAgICAgZmF2QiA9IGIudmlld0NvdW50OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoIWZhdkEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZmF2QSA9IDA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICghZmF2QikgewogICAgICAgICAgICAgICAgICAgICAgICBmYXZCID0gMDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGZhdkEgPiBmYXZCKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKGZhdkEgPCBmYXZCKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaUxvZy5pKCdTb3J0IGNvbXBsZXRlLicpOwogICAgICAgICAgICAgICAgaUxvZy5kKHdvcmtzKTsKICAgICAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9OwoKICAgIGlmIChjdXJyZW50UGFnZSA9PT0gMCkgewogICAgICAgIGxldCB1cmwgPSBsb2NhdGlvbi5ocmVmOwoKICAgICAgICBpZiAodXJsLmluZGV4T2YoJyZwPScpID09IC0xICYmIHVybC5pbmRleE9mKCc/cD0nKSA9PSAtMSkgewogICAgICAgICAgICBpTG9nLncoJ0NhbiBub3QgZm91bmQgcGFnZSBpbiB1cmwuJyk7CiAgICAgICAgICAgIGlmICh1cmwuaW5kZXhPZignPycpID09IC0xKSB7CiAgICAgICAgICAgICAgICB1cmwgKz0gJz9wPTEnOwogICAgICAgICAgICAgICAgaUxvZy5kKCdBZGQgIj9wPTEiOiAnICsgdXJsKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHVybCArPSAnJnA9MSc7CiAgICAgICAgICAgICAgICBpTG9nLmQoJ0FkZCAiJnA9MSI6ICcgKyB1cmwpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGxldCB3b3JkTWF0Y2ggPSB1cmwubWF0Y2goL1wvdGFnc1wvKFteL10qKVwvLyk7CiAgICAgICAgbGV0IHNlYXJjaFdvcmQgPSAnJzsKICAgICAgICBpZiAod29yZE1hdGNoKSB7CiAgICAgICAgICAgIGlMb2cuaSgnU2VhcmNoIGtleSB3b3JkOiAnICsgc2VhcmNoV29yZCk7CiAgICAgICAgICAgIHNlYXJjaFdvcmQgPSB3b3JkTWF0Y2hbMV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaUxvZy5lKCdDYW4gbm90IGZvdW5kIHNlYXJjaCBrZXkgd29yZCEnKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgLy8gcGFnZQogICAgICAgIGxldCBwYWdlID0gdXJsLm1hdGNoKC9wPShcZCopLylbMV07CiAgICAgICAgY3VycmVudFBhZ2UgPSBwYXJzZUludChwYWdlKTsKICAgICAgICBpTG9nLmkoJ0N1cnJlbnQgcGFnZTogJyArIGN1cnJlbnRQYWdlKTsKCiAgICAgICAgbGV0IHR5cGUgPSB1cmwubWF0Y2goL3RhZ3NcLy4qXC8oLiopWz8kXS8pWzFdOwogICAgICAgIGN1cnJlbnRVcmwgKz0gdHlwZSArICcvJzsKCiAgICAgICAgY3VycmVudFVybCArPSBzZWFyY2hXb3JkICsgJz93b3JkPScgKyBzZWFyY2hXb3JkICsgJyZwPScgKyBjdXJyZW50UGFnZTsKICAgICAgICBpTG9nLmkoJ0N1cnJlbnQgdXJsOiAnICsgY3VycmVudFVybCk7CiAgICB9IGVsc2UgewogICAgICAgIGlMb2cuZSgnPz8/Jyk7CiAgICB9CgogICAgbGV0IGltYWdlQ29udGFpbmVyID0gUGFnZXNbUGFnZVR5cGUuU2VhcmNoXS5HZXRJbWFnZUxpc3RDb250YWluZXIoKTsKICAgIC8vIGxvYWRpbmcKICAgICQoaW1hZ2VDb250YWluZXIpLmhpZGUoKS5iZWZvcmUoJzxkaXYgaWQ9ImxvYWRpbmciIHN0eWxlPSJ3aWR0aDoxMDAlO3RleHQtYWxpZ246Y2VudGVyOyI+PGltZyBzcmM9IicgKyBnX2xvYWRpbmdJbWFnZSArICciIC8+PHAgaWQ9InByb2dyZXNzIiBzdHlsZT0idGV4dC1hbGlnbjogY2VudGVyO2ZvbnQtc2l6ZTogbGFyZ2U7Zm9udC13ZWlnaHQ6IGJvbGQ7cGFkZGluZy10b3A6IDEwcHg7Ij4wJTwvcD48L2Rpdj4nKTsKCiAgICAvLyBwYWdlCiAgICBpZiAodHJ1ZSkgewogICAgICAgIGxldCBwYWdlU2VsZWN0b3JEaXYgPSBQYWdlc1tQYWdlVHlwZS5TZWFyY2hdLkdldFBhZ2VTZWxlY3RvcigpOwogICAgICAgIGlmIChwYWdlU2VsZWN0b3JEaXYgPT0gbnVsbCkgewogICAgICAgICAgICBpTG9nLmUoJ0NhbiBub3QgZm91bmQgcGFnZSBzZWxlY3RvciEnKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCQocGFnZVNlbGVjdG9yRGl2KS5maW5kKCdhJykubGVuZ3RoID4gMikgewogICAgICAgICAgICBsZXQgcGFnZUJ1dHRvbiA9ICQocGFnZVNlbGVjdG9yRGl2KS5maW5kKCdhJykuZ2V0KDEpOwogICAgICAgICAgICBsZXQgbmV3UGFnZUJ1dHRvbnMgPSBbXTsKICAgICAgICAgICAgbGV0IHBhZ2VCdXR0b25TdHJpbmcgPSAnUHJldmlld2VyJzsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgICAgICAgICAgIGxldCBuZXdQYWdlQnV0dG9uID0gcGFnZUJ1dHRvbi5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgICAgICAgICAgICAkKG5ld1BhZ2VCdXR0b24pLmZpbmQoJ3NwYW4nKS50ZXh0KHBhZ2VCdXR0b25TdHJpbmdbaV0pOwogICAgICAgICAgICAgICAgbmV3UGFnZUJ1dHRvbnMucHVzaChuZXdQYWdlQnV0dG9uKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJChwYWdlU2VsZWN0b3JEaXYpLmZpbmQoJ2J1dHRvbicpLnJlbW92ZSgpOwogICAgICAgICAgICB3aGlsZSAoJChwYWdlU2VsZWN0b3JEaXYpLmZpbmQoJ2EnKS5sZW5ndGggPiAyKSB7CiAgICAgICAgICAgICAgICAkKHBhZ2VTZWxlY3RvckRpdikuZmluZCgnYTpmaXJzdCcpLm5leHQoKS5yZW1vdmUoKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA5OyBpKyspIHsKICAgICAgICAgICAgICAgICQocGFnZVNlbGVjdG9yRGl2KS5maW5kKCdhOmxhc3QnKS5iZWZvcmUobmV3UGFnZUJ1dHRvbnNbaV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkKHBhZ2VTZWxlY3RvckRpdikuZmluZCgnYScpLmF0dHIoJ2hyZWYnLCAnamF2YXNjcmlwdDo7Jyk7CgogICAgICAgICAgICBsZXQgcGFnZVVybCA9IGxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgIGlmIChwYWdlVXJsLmluZGV4T2YoJyZwPScpID09IC0xICYmIHBhZ2VVcmwuaW5kZXhPZignP3A9JykgPT0gLTEpIHsKICAgICAgICAgICAgICAgIGlmIChwYWdlVXJsLmluZGV4T2YoJz8nKSA9PSAtMSkgewogICAgICAgICAgICAgICAgICAgIHBhZ2VVcmwgKz0gJz9wPTEnOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBwYWdlVXJsICs9ICcmcD0xJzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgcHJldlBhZ2VVcmwgPSBwYWdlVXJsLnJlcGxhY2UoL3A9XGQrLywgJ3A9JyArIChjdXJyZW50UGFnZSAtIGdfc2V0dGluZ3MucGFnZUNvdW50ID4gMSA/IGN1cnJlbnRQYWdlIC0gZ19zZXR0aW5ncy5wYWdlQ291bnQgOiAxKSk7CiAgICAgICAgICAgIGxldCBuZXh0UGFnZVVybCA9IHBhZ2VVcmwucmVwbGFjZSgvcD1cZCsvLCAncD0nICsgKGN1cnJlbnRQYWdlICsgZ19zZXR0aW5ncy5wYWdlQ291bnQpKTsKICAgICAgICAgICAgaUxvZy5pKCdQcmV2aW91cyBwYWdlIHVybDogJyArIHByZXZQYWdlVXJsKTsKICAgICAgICAgICAgaUxvZy5pKCdOZXh0IHBhZ2UgdXJsOiAnICsgbmV4dFBhZ2VVcmwpOwogICAgICAgICAgICAvLyDph43mlrDmj5LlhaXkuIDpgY3muIXpmaTkuovku7bnu5HlrpoKICAgICAgICAgICAgbGV0IHByZXZCdXR0b24gPSAkKHBhZ2VTZWxlY3RvckRpdikuZmluZCgnYTpmaXJzdCcpOwogICAgICAgICAgICBwcmV2QnV0dG9uLmJlZm9yZShwcmV2QnV0dG9uLmNsb25lKCkpOwogICAgICAgICAgICBwcmV2QnV0dG9uLnJlbW92ZSgpOwogICAgICAgICAgICBsZXQgbmV4dEJ1dHRvbiA9ICQocGFnZVNlbGVjdG9yRGl2KS5maW5kKCdhOmxhc3QnKTsKICAgICAgICAgICAgbmV4dEJ1dHRvbi5iZWZvcmUobmV4dEJ1dHRvbi5jbG9uZSgpKTsKICAgICAgICAgICAgbmV4dEJ1dHRvbi5yZW1vdmUoKTsKICAgICAgICAgICAgJChwYWdlU2VsZWN0b3JEaXYpLmZpbmQoJ2E6Zmlyc3QnKS5hdHRyKCdocmVmJywgcHJldlBhZ2VVcmwpLmFkZENsYXNzKCdwcC1wcmV2UGFnZScpOwogICAgICAgICAgICAkKHBhZ2VTZWxlY3RvckRpdikuZmluZCgnYTpsYXN0JykuYXR0cignaHJlZicsIG5leHRQYWdlVXJsKS5hZGRDbGFzcygncHAtbmV4dFBhZ2UnKTsKICAgICAgICB9CgogICAgICAgIGxldCBvbmxvYWRDYWxsYmFjayA9IGZ1bmN0aW9uIChyZXEpIHsKICAgICAgICAgICAgbGV0IG5vX2FydHdvcmtzX2ZvdW5kID0gZmFsc2U7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGV0IGpzb24gPSBKU09OLnBhcnNlKHJlcS5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgaWYgKGpzb24uaGFzT3duUHJvcGVydHkoJ2Vycm9yJykpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoanNvbi5lcnJvciA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGRhdGE7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChqc29uLmJvZHkuaWxsdXN0TWFuZ2EpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBqc29uLmJvZHkuaWxsdXN0TWFuZ2EuZGF0YTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqc29uLmJvZHkubWFuZ2EpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBqc29uLmJvZHkubWFuZ2EuZGF0YTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqc29uLmJvZHkuaWxsdXN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhID0ganNvbi5ib2R5LmlsbHVzdC5kYXRhOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtzID0gd29ya3MuY29uY2F0KGRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9fYXJ0d29ya3NfZm91bmQgPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5lKCdhamF4IGVycm9yIScpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpTG9nLmUoJ0tleSAiZXJyb3IiIG5vdCBmb3VuZCEnKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGlMb2cuZSgnQSBpbnZhbGlkIGpzb24gc3RyaW5nIScpOwogICAgICAgICAgICAgICAgaUxvZy5pKHJlcS5yZXNwb25zZVRleHQpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjdXJyZW50UGFnZSsrOwogICAgICAgICAgICBjdXJyZW50R2V0dGluZ1BhZ2VDb3VudCsrOwoKICAgICAgICAgICAgLy8g5ZCO6Z2i5bey57uP5rKh5pyJ5L2c5ZOB5LqGCiAgICAgICAgICAgIGlmIChub19hcnR3b3Jrc19mb3VuZCkgewogICAgICAgICAgICAgICAgaUxvZy53KCdObyBhcnR3b3JrcyBmb3VuZCwgaWdub3JlICcgKyAoZ19zZXR0aW5ncy5wYWdlQ291bnQgLSBjdXJyZW50R2V0dGluZ1BhZ2VDb3VudCkgKyAnIHBhZ2VzLicpOwogICAgICAgICAgICAgICAgY3VycmVudFBhZ2UgKz0gZ19zZXR0aW5ncy5wYWdlQ291bnQgLSBjdXJyZW50R2V0dGluZ1BhZ2VDb3VudDsKICAgICAgICAgICAgICAgIGN1cnJlbnRHZXR0aW5nUGFnZUNvdW50ID0gZ19zZXR0aW5ncy5wYWdlQ291bnQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g6K6+5a6a5pWw6YeP55qE6aG16Z2i5Yqg6L295a6M5oiQCiAgICAgICAgICAgIGlmIChjdXJyZW50R2V0dGluZ1BhZ2VDb3VudCA9PSBnX3NldHRpbmdzLnBhZ2VDb3VudCkgewogICAgICAgICAgICAgICAgaUxvZy5pKCdMb2FkIGNvbXBsZXRlLCBzdGFydCB0byBsb2FkIGJvb2ttYXJrIGNvdW50LicpOwogICAgICAgICAgICAgICAgaUxvZy5kKHdvcmtzKTsKCiAgICAgICAgICAgICAgICAvLyDojrflj5bliLDnmoTkvZzlk4Hph4zpnaLlj6/og73mnInlub/lkYrvvIzlhYjliKDmjonvvIzlkKbliJnlkI7pnaLkuIDkupvlpITnkIbpnIDopoHlgZrliKTmlq0KICAgICAgICAgICAgICAgIGxldCB0ZW1wV29ya3MgPSBbXTsKICAgICAgICAgICAgICAgIGxldCB3b3JrSWRzU2V0ID0gbmV3IFNldCgpOwogICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3b3Jrcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgIGlmICh3b3Jrc1tpXS5pZCAmJiAhd29ya0lkc1NldC5oYXMod29ya3NbaV0uaWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBXb3Jrcy5wdXNoKHdvcmtzW2ldKTsKICAgICAgICAgICAgICAgICAgICAgICAgd29ya0lkc1NldC5hZGQod29ya3NbaV0uaWQpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlMb2cudygnaWdub3JlIHdvcms6ICcgKyB3b3Jrc1tpXS5pZCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgd29ya3MgPSB0ZW1wV29ya3M7CiAgICAgICAgICAgICAgICB3b3Jrc0NvdW50ID0gd29ya3MubGVuZ3RoOwogICAgICAgICAgICAgICAgaUxvZy5pKCdDbGVhciBhZCBjb250YWluZXIgY29tcGxldGUuJyk7CiAgICAgICAgICAgICAgICBpTG9nLmQod29ya3MpOwoKICAgICAgICAgICAgICAgIC8vIEdldEJvb2ttYXJrQ291bnQoMCk7CiAgICAgICAgICAgICAgICBHZXRCb29rbWFya0NvdW50VXNpbmdGZXRjaCgwKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGdldFdvcmtzKG9ubG9hZENhbGxiYWNrKTsKICAgICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIGdldFdvcmtzKG9ubG9hZENhbGxiYWNrKTsKICAgIH0KCiAgICBsZXQgY29tcGxldGVDb3VudCA9IDA7CiAgICBsZXQgZmFpbENvdW50ID0gMDsKICAgIGxldCBuZXh0QmF0Y2hJbmRleCA9IDA7CgogICAgbGV0IEdldEJvb2ttYXJrQ291bnRVc2luZ0ZldGNoID0gZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgICAgaWYgKGluZGV4ID49IHdvcmtzLmxlbmd0aCkgewogICAgICAgICAgICBjbGVhckFuZFVwZGF0ZVdvcmtzKCk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgbGV0IGJhdGNoQ291bnQgPSB3b3Jrcy5sZW5ndGggLSBpbmRleDsKICAgICAgICBpZiAoYmF0Y2hDb3VudCA+IGdfbWF4WGhyKSBiYXRjaENvdW50ID0gZ19tYXhYaHI7CiAgICAgICAgbmV4dEJhdGNoSW5kZXggPSBpbmRleCArIGJhdGNoQ291bnQ7CiAgICAgICAgbGV0IGNvbXBsZXRlZCA9IDA7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiYXRjaENvdW50OyBpKyspIHsKICAgICAgICAgICAgbGV0IGogPSBpbmRleCArIGk7CiAgICAgICAgICAgIGxldCBpbGx1c3RJZCA9IHdvcmtzW2pdLmlkOwogICAgICAgICAgICBsZXQgdXJsID0gJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC9hamF4L2lsbHVzdC8nICsgaWxsdXN0SWQ7CiAgICAgICAgICAgIGZldGNoKHVybCwgeyBjcmVkZW50aWFsczogJ29taXQnIH0pCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpCiAgICAgICAgICAgICAgICAudGhlbihqc29uID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoanNvbiAmJiAhanNvbi5lcnJvcikgewogICAgICAgICAgICAgICAgICAgICAgICB3b3Jrc1tqXS5ib29rbWFya0NvdW50ID0ganNvbi5ib2R5LmJvb2ttYXJrQ291bnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtzW2pdLmxpa2VDb3VudCA9IGpzb24uYm9keS5saWtlQ291bnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIHdvcmtzW2pdLnZpZXdDb3VudCA9IGpzb24uYm9keS52aWV3Q291bnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGlMb2cuZCgnSWxsdXN0SWQ6ICcgKyB3b3Jrc1tqXS5pZCArICcsIGJvb2ttYXJrQ291bnQ6ICcgKyB3b3Jrc1tqXS5ib29rbWFya0NvdW50KTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmUoJ1NvbWUgZXJyb3Igb2NjdXJlZDogJyArIChqc29uICYmIGpzb24ubWVzc2FnZSkpOwogICAgICAgICAgICAgICAgICAgICAgICB3b3Jrc1tqXS5ib29rbWFya0NvdW50ID0gMDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICAgICAgICAgICAgaUxvZy5lKCdGZXRjaCBmYWlsZWQgZm9yIGlsbHVzdElkICcgKyBpbGx1c3RJZCArICc6ICcgKyBlcnIpOwogICAgICAgICAgICAgICAgICAgIHdvcmtzW2pdLmJvb2ttYXJrQ291bnQgPSAwOwogICAgICAgICAgICAgICAgICAgICsrZmFpbENvdW50OwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBsZXQgdGV4dCA9IFRleHRzW2dfbGFuZ3VhZ2VdLnNvcnRfZ2V0Qm9va21hcmtDb3VudC5yZXBsYWNlKCclMScsICsrY29tcGxldGVDb3VudCkucmVwbGFjZSgnJTInLCB3b3Jrcy5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgIGlmIChmYWlsQ291bnQgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgKz0gJyAoJyArIGZhaWxDb3VudCArICcgZmFpbGVkKSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICQoJyNsb2FkaW5nJykuZmluZCgnI3Byb2dyZXNzJykudGV4dCh0ZXh0KTsKICAgICAgICAgICAgICAgICAgICBpZiAoKytjb21wbGV0ZWQgPT09IGJhdGNoQ291bnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgR2V0Qm9va21hcmtDb3VudFVzaW5nRmV0Y2gobmV4dEJhdGNoSW5kZXgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0KCiAgICAvKgogICAgbGkKICAgIC1kaXYKICAgIC0tZGl2CiAgICAtLS1kaXYKICAgIC0tLS1kaXYKICAgIC0tLS0tZGl2CiAgICAtLS0tLS1hCiAgICAtLS0tLS0tZGl2OiDlpJrlm77moIfnrb7jgIFSMTjmoIfnrb4KICAgIC0tLS0tLS1kaXY6IOmHjOmdouaYryBpbWcg77yI5Lul5Y+KIHN2ZyDliqjlm77moIfnrb7vvIkKICAgIC0tLS0tLWRpdjog6YeM6Z2i5pivIGxpa2Ug55u45YWz55qE5YWD57SgCiAgICAtLS1hOiDkvZzlk4HmoIfpopjvvIzot7Povazpk77mjqUKICAgIC0tLWRpdjog5L2c6ICF5aS05YOP5ZKM5pi156ewCiAgICAqLwogICAgLy8gc29ydFR5cGU6IDDvvJrmlLbol4/vvIjllpzmrKLvvInvvJsx77ya54K56LWe77ybMu+8muafpeeciwogICAgbGV0IGNsZWFyQW5kVXBkYXRlV29ya3MgPSBmdW5jdGlvbiAoc29ydFR5cGUgPSAwKSB7CiAgICAgICAgZmlsdGVyQW5kU29ydChzb3J0VHlwZSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBQYWdlc1tQYWdlVHlwZS5TZWFyY2hdLkdldEltYWdlTGlzdENvbnRhaW5lcigpOwogICAgICAgICAgICBsZXQgZmlyc3RJbWFnZUVsZW1lbnQgPSBQYWdlc1tQYWdlVHlwZS5TZWFyY2hdLkdldEZpcnN0SW1hZ2VFbGVtZW50KCk7CiAgICAgICAgICAgIC8vIOaOkuW6j+WFvOWuuSBQaXhpdkJhdGNoRG93bmxvYWRlcgogICAgICAgICAgICAkKGZpcnN0SW1hZ2VFbGVtZW50KS5maW5kKCdbZGF0YS1tb3VzZW92ZXJdJykucmVtb3ZlQXR0cignZGF0YS1tb3VzZW92ZXInKTsKICAgICAgICAgICAgaWYgKGltYWdlRWxlbWVudFRlbXBsYXRlID09IG51bGwpIHsKICAgICAgICAgICAgICAgIGltYWdlRWxlbWVudFRlbXBsYXRlID0gZmlyc3RJbWFnZUVsZW1lbnQuY2xvbmVOb2RlKHRydWUpOwogICAgICAgICAgICAgICAgLy9pbWFnZUVsZW1lbnRUZW1wbGF0ZSA9IGZpcnN0SW1hZ2VFbGVtZW50OwoKICAgICAgICAgICAgICAgIC8vIOa4heeQhuaooeadvwogICAgICAgICAgICAgICAgLy8gaW1hZ2UKICAgICAgICAgICAgICAgIGxldCBjb250cm9sID0gJChpbWFnZUVsZW1lbnRUZW1wbGF0ZSkuZmluZCgnLnBwLWNvbnRyb2wnKTsKICAgICAgICAgICAgICAgIGlmIChjb250cm9sID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpTG9nLncoJ0Nhbm5vdCBmb3VuZCBzb21lIGVsZW1lbnRzIScpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxldCBpbWFnZUxpbmsgPSBjb250cm9sLmZpbmQoJ2E6Zmlyc3QnKTsKICAgICAgICAgICAgICAgIGxldCBpbWcgPSBpbWFnZUxpbmsuZmluZCgnaW1nOmZpcnN0Jyk7CiAgICAgICAgICAgICAgICBsZXQgaW1hZ2VEaXYgPSBpbWcucGFyZW50KCk7CiAgICAgICAgICAgICAgICBsZXQgaW1hZ2VMaW5rRGl2ID0gaW1hZ2VMaW5rLnBhcmVudCgpOwogICAgICAgICAgICAgICAgbGV0IHRpdGxlTGlua1BhcmVudCA9IGNvbnRyb2wubmV4dCgpOwogICAgICAgICAgICAgICAgaWYgKGltZyA9PSBudWxsIHx8IGltYWdlRGl2ID09IG51bGwgfHwgaW1hZ2VMaW5rID09IG51bGwgfHwgaW1hZ2VMaW5rRGl2ID09IG51bGwgfHwgdGl0bGVMaW5rUGFyZW50ID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICBpTG9nLmUoJ0NhbiBub3QgZm91bmQgc29tZSBlbGVtZW50cyEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxldCB0aXRsZUxpbmsgPSAkKCc8YT48L2E+Jyk7CiAgICAgICAgICAgICAgICBpZiAodGl0bGVMaW5rUGFyZW50LmNoaWxkcmVuKCkubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgICAgICAgICB0aXRsZUxpbmtQYXJlbnQuYXBwZW5kKHRpdGxlTGluayk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRpdGxlTGluayA9IHRpdGxlTGlua1BhcmVudC5jaGlsZHJlbignYTpmaXJzdCcpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIGF1dGhvcgogICAgICAgICAgICAgICAgbGV0IGF1dGhvckRpdiA9IHRpdGxlTGlua1BhcmVudC5uZXh0KCk7CiAgICAgICAgICAgICAgICBsZXQgYXV0aG9yTGlua1Byb2ZpbGVJbWFnZSA9IGF1dGhvckRpdi5maW5kKCdhOmZpcnN0Jyk7CiAgICAgICAgICAgICAgICBsZXQgYXV0aG9yTGluayA9IGF1dGhvckRpdi5maW5kKCdhOmxhc3QnKTsKICAgICAgICAgICAgICAgIGxldCBhdXRob3JOYW1lID0gYXV0aG9yTGluazsKICAgICAgICAgICAgICAgIGxldCBhdXRob3JJbWFnZSA9ICQoYXV0aG9yRGl2LmZpbmQoJ2ltZycpLmdldCgwKSk7CgogICAgICAgICAgICAgICAgLy8gb3RoZXJzCiAgICAgICAgICAgICAgICBsZXQgYm9va21hcmtEaXYgPSBpbWFnZUxpbmsubmV4dCgpOwogICAgICAgICAgICAgICAgbGV0IGJvb2ttYXJrU3ZnID0gYm9va21hcmtEaXYuZmluZCgnc3ZnJyk7CiAgICAgICAgICAgICAgICBsZXQgYWRkaXRpb25UYWdEaXYgPSBpbWFnZUxpbmsuY2hpbGRyZW4oJ2RpdjpsYXN0Jyk7CgogICAgICAgICAgICAgICAgbGV0IGJvb2ttYXJrQ291bnREaXYgPSBhZGRpdGlvblRhZ0Rpdi5jbG9uZSgpOwogICAgICAgICAgICAgICAgYm9va21hcmtDb3VudERpdi5jc3MoeyAndG9wJzogJ2F1dG8nLCAnYm90dG9tJzogJzBweCcsICd3aWR0aCc6ICc2NSUnIH0pOwogICAgICAgICAgICAgICAgYWRkaXRpb25UYWdEaXYucGFyZW50KCkuYXBwZW5kKGJvb2ttYXJrQ291bnREaXYpOwoKICAgICAgICAgICAgICAgIC8vIOa3u+WKoCBjbGFzc++8jOaWueS+v+WQjumdouS/ruaUueWGheWuuQogICAgICAgICAgICAgICAgaW1nLmFkZENsYXNzKCdwcEltZycpOwogICAgICAgICAgICAgICAgaW1hZ2VMaW5rLmFkZENsYXNzKCdwcEltYWdlTGluaycpOwogICAgICAgICAgICAgICAgdGl0bGVMaW5rLmFkZENsYXNzKCdwcFRpdGxlTGluaycpOwogICAgICAgICAgICAgICAgYXV0aG9yTGlua1Byb2ZpbGVJbWFnZS5hZGRDbGFzcygncHBBdXRob3JMaW5rUHJvZmlsZUltYWdlJyk7CiAgICAgICAgICAgICAgICBhdXRob3JMaW5rLmFkZENsYXNzKCdwcEF1dGhvckxpbmsnKTsKICAgICAgICAgICAgICAgIGF1dGhvck5hbWUuYWRkQ2xhc3MoJ3BwQXV0aG9yTmFtZScpOwogICAgICAgICAgICAgICAgYXV0aG9ySW1hZ2UuYWRkQ2xhc3MoJ3BwQXV0aG9ySW1hZ2UnKTsKICAgICAgICAgICAgICAgIGJvb2ttYXJrU3ZnLmF0dHIoJ2NsYXNzJywgYm9va21hcmtTdmcuYXR0cignY2xhc3MnKSArICcgcHBCb29rbWFya1N2ZycpOwogICAgICAgICAgICAgICAgYWRkaXRpb25UYWdEaXYuYWRkQ2xhc3MoJ3BwQWRkaXRpb25UYWcnKTsKICAgICAgICAgICAgICAgIGJvb2ttYXJrQ291bnREaXYuYWRkQ2xhc3MoJ3BwQm9va21hcmtDb3VudCcpOwoKICAgICAgICAgICAgICAgIGltZy5hdHRyKCdzcmMnLCAnJyk7CiAgICAgICAgICAgICAgICBsZXQgYW5pbWF0aW9uVGFnID0gaW1nLm5leHQoKTsKICAgICAgICAgICAgICAgIGlmIChhbmltYXRpb25UYWcubGVuZ3RoICE9IDAgJiYgYW5pbWF0aW9uVGFnLmdldCgwKS50YWdOYW1lID09ICdTVkcnKSB7CiAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uVGFnLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYWRkaXRpb25UYWdEaXYuZW1wdHkoKTsKICAgICAgICAgICAgICAgIGJvb2ttYXJrQ291bnREaXYuZW1wdHkoKTsKICAgICAgICAgICAgICAgIGJvb2ttYXJrU3ZnLmZpbmQoJ3BhdGg6Zmlyc3QnKS5jc3MoJ2ZpbGwnLCAncmdiKDMxLCAzMSwgMzEpJyk7CiAgICAgICAgICAgICAgICBib29rbWFya1N2Zy5maW5kKCdwYXRoOmxhc3QnKS5jc3MoJ2ZpbGwnLCAncmdiKDI1NSwgMjU1LCAyNTUpJyk7CiAgICAgICAgICAgICAgICBpbWFnZURpdi5maW5kKCdzdmcnKS5yZW1vdmUoKTsKCiAgICAgICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5saW5rQmxhbmspIHsKICAgICAgICAgICAgICAgICAgICBpbWFnZUxpbmsuYXR0cigndGFyZ2V0JywgJ19ibGFuaycpOwogICAgICAgICAgICAgICAgICAgIHRpdGxlTGluay5hdHRyKCd0YXJnZXQnLCAnX2JsYW5rJyk7CiAgICAgICAgICAgICAgICAgICAgYXV0aG9yTGlua1Byb2ZpbGVJbWFnZS5hdHRyKCd0YXJnZXQnLCAnX2JsYW5rJyk7CiAgICAgICAgICAgICAgICAgICAgYXV0aG9yTGluay5hdHRyKCd0YXJnZXQnLCAnX2JsYW5rJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICQoY29udGFpbmVyKS5lbXB0eSgpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmtzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBsZXQgbGkgPSAkKGltYWdlRWxlbWVudFRlbXBsYXRlLmNsb25lTm9kZSh0cnVlKSk7CgogICAgICAgICAgICAgICAgbGV0IHJlZ3VsYXJVcmwgPSB3b3Jrc1tpXS51cmw7CiAgICAgICAgICAgICAgICBpZiAoZ19zZXR0aW5ncy5mdWxsU2l6ZVRodW1iKSB7CiAgICAgICAgICAgICAgICAgICAgcmVndWxhclVybCA9IGNvbnZlcnRUaHVtYlVybFRvU21hbGwod29ya3NbaV0udXJsKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxpLmZpbmQoJy5wcEltZycpLmF0dHIoJ3NyYycsIHJlZ3VsYXJVcmwpLmNzcygnb2JqZWN0LWZpdCcsICdjb250YWluJyk7CiAgICAgICAgICAgICAgICBsaS5maW5kKCcucHBJbWFnZUxpbmsnKS5hdHRyKCdocmVmJywgJy9hcnR3b3Jrcy8nICsgd29ya3NbaV0uaWQpOwogICAgICAgICAgICAgICAgbGkuZmluZCgnLnBwVGl0bGVMaW5rJykuYXR0cignaHJlZicsICcvYXJ0d29ya3MvJyArIHdvcmtzW2ldLmlkKS50ZXh0KHdvcmtzW2ldLnRpdGxlKTsKICAgICAgICAgICAgICAgIGxpLmZpbmQoJy5wcEF1dGhvckxpbmssIC5wcEF1dGhvckxpbmtQcm9maWxlSW1hZ2UnKS5hdHRyKCdocmVmJywgJy9tZW1iZXIucGhwP2lkPScgKyB3b3Jrc1tpXS51c2VySWQpLmF0dHIoeyAndXNlcklkJzogd29ya3NbaV0udXNlcklkLCAncHJvZmlsZUltYWdlVXJsJzogd29ya3NbaV0ucHJvZmlsZUltYWdlVXJsLCAndXNlck5hbWUnOiB3b3Jrc1tpXS51c2VyTmFtZSB9KTsKICAgICAgICAgICAgICAgIGxpLmZpbmQoJy5wcEF1dGhvck5hbWUnKS50ZXh0KHdvcmtzW2ldLnVzZXJOYW1lKTsKICAgICAgICAgICAgICAgIGxpLmZpbmQoJy5wcEF1dGhvckltYWdlJykucGFyZW50KCkuYXR0cigndGl0aWxlJywgd29ya3NbaV0udXNlck5hbWUpOwogICAgICAgICAgICAgICAgbGkuZmluZCgnLnBwQXV0aG9ySW1hZ2UnKS5hdHRyKCdzcmMnLCB3b3Jrc1tpXS5wcm9maWxlSW1hZ2VVcmwpOwogICAgICAgICAgICAgICAgbGkuZmluZCgnLnBwQm9va21hcmtTdmcnKS5hdHRyKCdpbGx1c3RJZCcsIHdvcmtzW2ldLmlkKTsKICAgICAgICAgICAgICAgIGlmICh3b3Jrc1tpXS5ib29rbWFya0RhdGEpIHsKICAgICAgICAgICAgICAgICAgICBsaS5maW5kKCcucHBCb29rbWFya1N2ZycpLmZpbmQoJ3BhdGgnKS5jc3MoJ2ZpbGwnLCAncmdiKDI1NSwgNjQsIDk2KScpOwogICAgICAgICAgICAgICAgICAgIGxpLmZpbmQoJy5wcEJvb2ttYXJrU3ZnJykuYXR0cignYm9va21hcmtJZCcsIHdvcmtzW2ldLmJvb2ttYXJrRGF0YS5pZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAod29ya3NbaV0ueFJlc3RyaWN0ICE9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IFIxOEhUTUwgPSAnPGRpdiBzdHlsZT0ibWFyZ2luLXRvcDogMnB4OyBtYXJnaW4tbGVmdDogMnB4OyI+PGRpdiBzdHlsZT0iY29sb3I6IHJnYigyNTUsIDI1NSwgMjU1KTtmb250LXdlaWdodDogYm9sZDtmb250LXNpemU6IDEwcHg7bGluZS1oZWlnaHQ6IDE7cGFkZGluZzogM3B4IDZweDtib3JkZXItcmFkaXVzOiAzcHg7YmFja2dyb3VuZDogcmdiKDI1NSwgNjQsIDk2KTsiPlItMTg8L2Rpdj48L2Rpdj4nOwogICAgICAgICAgICAgICAgICAgIGxpLmZpbmQoJy5wcEFkZGl0aW9uVGFnJykuYXBwZW5kKFIxOEhUTUwpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHdvcmtzW2ldLnBhZ2VDb3VudCA+IDEpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgcGFnZUNvdW50SFRNTCA9ICc8ZGl2IHN0eWxlPSJkaXNwbGF5OiBmbGV4Oy13ZWJraXQtYm94LWFsaWduOiBjZW50ZXI7YWxpZ24taXRlbXM6IGNlbnRlcjtib3gtc2l6aW5nOiBib3JkZXItYm94O21hcmdpbi1sZWZ0OiBhdXRvO2hlaWdodDogMjBweDtjb2xvcjogcmdiKDI1NSwgMjU1LCAyNTUpO2ZvbnQtc2l6ZTogMTBweDtsaW5lLWhlaWdodDogMTJweDtmb250LXdlaWdodDogYm9sZDtmbGV4OiAwIDAgYXV0bztwYWRkaW5nOiA0cHggNnB4O2JhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC4zMik7Ym9yZGVyLXJhZGl1czogMTBweDsiPlw8c3ZnIHZpZXdCb3g9IjAgMCA5IDEwIiB3aWR0aD0iOSIgaGVpZ2h0PSIxMCIgc3R5bGU9InN0cm9rZTogbm9uZTtsaW5lLWhlaWdodDogMDtmb250LXNpemU6IDBweDtmaWxsOiBjdXJyZW50Y29sb3I7Ij48cGF0aCBkPSJNOCwzIEM4LjU1MjI4NDc1LDMgOSwzLjQ0NzcxNTI1IDksNCBMOSw5IEM5LDkuNTUyMjg0NzUgOC41NTIyODQ3NSwxMCA4LDEwIEwzLDEwIEMyLjQ0NzcxNTI1LDEwIDIsOS41NTIyODQ3NSAyLDkgTDYsOSBDNy4xMDQ1Njk1LDkgOCw4LjEwNDU2OTUgOCw3IEw4LDMgWiBNMSwxIEw2LDEgQzYuNTUyMjg0NzUsMSA3LDEuNDQ3NzE1MjUgNywyIEw3LDcgQzcsNy41NTIyODQ3NSA2LjU1MjI4NDc1LDggNiw4IEwxLDggQzAuNDQ3NzE1MjUsOCAwLDcuNTUyMjg0NzUgMCw3IEwwLDIgQzAsMS40NDc3MTUyNSAwLjQ0NzcxNTI1LDEgMSwxIFoiPjwvcGF0aD48L3N2Zz48c3BhbiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDJweDsiPicgKyB3b3Jrc1tpXS5wYWdlQ291bnQgKyAnPC9zcGFuPjwvZGl2Pic7CiAgICAgICAgICAgICAgICAgICAgbGkuZmluZCgnLnBwQWRkaXRpb25UYWcnKS5hcHBlbmQocGFnZUNvdW50SFRNTCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsZXQgY291bnRIdG1sID0gJyc7CiAgICAgICAgICAgICAgICBpZiAoc29ydFR5cGUgPT0gMCkgewogICAgICAgICAgICAgICAgICAgIGNvdW50SHRtbCA9ICfinaTvuI8nICsgd29ya3NbaV0uYm9va21hcmtDb3VudDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc29ydFR5cGUgPT0gMSkgewogICAgICAgICAgICAgICAgICAgIGNvdW50SHRtbCA9ICfwn5GNJyArIHdvcmtzW2ldLmxpa2VDb3VudDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc29ydFR5cGUgPT0gMikgewogICAgICAgICAgICAgICAgICAgIGNvdW50SHRtbCA9ICfwn5GAJyArIHdvcmtzW2ldLnZpZXdDb3VudDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxldCBib29rbWFya0NvdW50SFRNTCA9ICc8ZGl2IHN0eWxlPSJtYXJnaW4tYm90dG9tOiA2cHg7IG1hcmdpbi1sZWZ0OiAycHg7Ij48ZGl2IHN0eWxlPSJjb2xvcjogcmdiKDcsIDk1LCAxNjYpO2ZvbnQtd2VpZ2h0OiBib2xkO2ZvbnQtc2l6ZTogMTNweDtsaW5lLWhlaWdodDogMTtwYWRkaW5nOiAzcHggNnB4O2JvcmRlci1yYWRpdXM6IDNweDtiYWNrZ3JvdW5kOiByZ2IoMjA0LCAyMzYsIDI1NSk7Ij4nICsgY291bnRIdG1sICsgJzwvZGl2PjwvZGl2Pic7CiAgICAgICAgICAgICAgICBsaS5maW5kKCcucHBCb29rbWFya0NvdW50JykuYXBwZW5kKGJvb2ttYXJrQ291bnRIVE1MKTsKICAgICAgICAgICAgICAgIGlmICh3b3Jrc1tpXS5pbGx1c3RUeXBlID09IDIpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYW5pbWF0aW9uSFRNTCA9ICc8c3ZnIHZpZXdCb3g9IjAgMCAyNCAyNCIgc3R5bGU9IndpZHRoOiA0OHB4OyBoZWlnaHQ6IDQ4cHg7c3Ryb2tlOiBub25lO2ZpbGw6IHJnYigyNTUsIDI1NSwgMjU1KTtsaW5lLWhlaWdodDogMDtmb250LXNpemU6IDBweDt2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO3Bvc2l0aW9uOmFic29sdXRlOyI+PGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiIHN0eWxlPSJmaWxsOiByZ2IoMCwgMCwgMCk7ZmlsbC1vcGFjaXR5OiAwLjQ7Ij48L2NpcmNsZT48cGF0aCBkPSJNOSw4Ljc0ODQxNjY0IEw5LDE1LjI1MTU4MzQgQzksMTUuODAzODY4MSA5LjQ0NzcxNTI1LDE2LjI1MTU4MzQgMTAsMTYuMjUxNTgzNCBDMTAuMTc4MjkyOCwxNi4yNTE1ODM0IDEwLjM1MzM0MzUsMTYuMjAzOTE1NiAxMC41MDcwMjAxLDE2LjExMzUxNzYgTDE2LjAzNDcxMTgsMTIuODYxOTM0MiBDMTYuNTEwNzQ1LDEyLjU4MTkxNDcgMTYuNjY5NjQ1NCwxMS45NjkwMTMgMTYuMzg5NjI1OSwxMS40OTI5Nzk5IEMxNi4zMDM0MTc5LDExLjM0NjQyNjIgMTYuMTgxMjY1NSwxMS4yMjQyNzM4IDE2LjAzNDcxMTgsMTEuMTM4MDY1OCBMMTAuNTA3MDIwMSw3Ljg4NjQ4MjQzIEMxMC4wMzA5ODcsNy42MDY0NjI5NCA5LjQxODA4NTI3LDcuNzY1MzYzMzkgOS4xMzgwNjU3OCw4LjI0MTM5NjUyIEM5LjA0NzY2Nzc2LDguMzk1MDczMTYgOSw4LjU3MDEyMzg2IDksOC43NDg0MTY2NCBaIj48L3BhdGg+PC9zdmc+JzsKICAgICAgICAgICAgICAgICAgICBsaS5maW5kKCcucHBJbWcnKS5hZnRlcihhbmltYXRpb25IVE1MKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkKGNvbnRhaW5lcikuYXBwZW5kKGxpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g55uR5ZCs5Yqg5YWl5Lmm562+54K55Ye75LqL5Lu277yM55uR5ZCs54i26IqC54K577yM5L2G5piv5oyJ54WnIDxzdmc+IOiKgueCueWkhOeQhgogICAgICAgICAgICAkKCcucHBCb29rbWFya1N2ZycpLnBhcmVudCgpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChldikgewogICAgICAgICAgICAgICAgaWYgKGdfY3NyZlRva2VuID09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgaUxvZy5lKCdObyBnX2NzcmZUb2tlbiwgZmFpbGVkIHRvIGFkZCBib29rbWFyayEnKTsKICAgICAgICAgICAgICAgICAgICBhbGVydCgn6I635Y+WIFRva2VuIOWksei0pe+8jOaXoOazlea3u+WKoO+8jOivt+WIsOivpuaDhemhteaTjeS9nOOAgicpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIOmdnuWFrOW8gOaUtuiXjwogICAgICAgICAgICAgICAgbGV0IHJlc3RyaWN0ID0gMDsKICAgICAgICAgICAgICAgIGlmIChldi5jdHJsS2V5KSB7CiAgICAgICAgICAgICAgICAgICAgcmVzdHJpY3QgPSAxOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGxldCBfdGhpcyA9ICQodGhpcykuY2hpbGRyZW4oJ3N2ZzpmaXJzdCcpOwogICAgICAgICAgICAgICAgbGV0IGlsbHVzdElkID0gX3RoaXMuYXR0cignaWxsdXN0SWQnKTsKICAgICAgICAgICAgICAgIGxldCBib29rbWFya0lkID0gX3RoaXMuYXR0cignYm9va21hcmtJZCcpOwogICAgICAgICAgICAgICAgaWYgKGJvb2ttYXJrSWQgPT0gbnVsbCB8fCBib29rbWFya0lkID09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgaUxvZy5pKCdBZGQgYm9va21hcmssIGlsbHVzdElkOiAnICsgaWxsdXN0SWQpOwogICAgICAgICAgICAgICAgICAgICQuYWpheCgnL2FqYXgvaWxsdXN0cy9ib29rbWFya3MvYWRkJywgewogICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnLAogICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICd4LWNzcmYtdG9rZW4nOiBnX2NzcmZUb2tlbiB9LAogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiAneyJpbGx1c3RfaWQiOiInICsgaWxsdXN0SWQgKyAnIiwicmVzdHJpY3QiOicgKyByZXN0cmljdCArICcsImNvbW1lbnQiOiIiLCJ0YWdzIjpbXX0nLAogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5kKCdhZGRCb29rbWFyayByZXN1bHQ6ICcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5kKGRhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmUoJ1NlcnZlciByZXR1cm5lZCBhbiBlcnJvcjogJyArIGRhdGEubWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJvb2ttYXJrSWQgPSBkYXRhLmJvZHkubGFzdF9ib29rbWFya19pZDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlMb2cuaSgnQWRkIGJvb2ttYXJrIHN1Y2Nlc3MsIGJvb2ttYXJrSWQgaXMgJyArIGJvb2ttYXJrSWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuYXR0cignYm9va21hcmtJZCcsIGJvb2ttYXJrSWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmluZCgncGF0aCcpLmNzcygnZmlsbCcsICdyZ2IoMjU1LCA2NCwgOTYpJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaUxvZy5pKCdEZWxldGUgYm9va21hcmssIGJvb2ttYXJrSWQ6ICcgKyBib29rbWFya0lkKTsKICAgICAgICAgICAgICAgICAgICAkLmFqYXgoJy9ycGMvaW5kZXgucGhwJywgewogICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyAneC1jc3JmLXRva2VuJzogZ19jc3JmVG9rZW4gfSwKICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogeyAibW9kZSI6ICJkZWxldGVfaWxsdXN0X2Jvb2ttYXJrIiwgImJvb2ttYXJrX2lkIjogYm9va21hcmtJZCB9LAogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5kKCdkZWxldGUgYm9va21hcmsgcmVzdWx0OiAnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlMb2cuZChkYXRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5lKCdTZXJ2ZXIgcmV0dXJuZWQgYW4gZXJyb3I6ICcgKyBkYXRhLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlMb2cuaSgnRGVsZXRlIGJvb2ttYXJrIHN1Y2Nlc3MuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5hdHRyKCdib29rbWFya0lkJywgJycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuZmluZCgncGF0aDpmaXJzdCcpLmNzcygnZmlsbCcsICdyZ2IoMzEsIDMxLCAzMSknKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmZpbmQoJ3BhdGg6bGFzdCcpLmNzcygnZmlsbCcsICdyZ2IoMjU1LCAyNTUsIDI1NSknKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90aGlzLnBhcmVudCgpLmZvY3VzKCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgJCgnLnBwQXV0aG9yTGluaycpLm9uKCdtb3VzZWVudGVyJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIGxldCBfdGhpcyA9ICQodGhpcyk7CgogICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0T2Zmc2V0KGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoZS5vZmZzZXRQYXJlbnQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG9mZnNldCA9IGdldE9mZnNldChlLm9mZnNldFBhcmVudCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRUb3A6IGUub2Zmc2V0VG9wICsgb2Zmc2V0Lm9mZnNldFRvcCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldExlZnQ6IGUub2Zmc2V0TGVmdCArIG9mZnNldC5vZmZzZXRMZWZ0LAogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXRUb3A6IGUub2Zmc2V0VG9wLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0TGVmdDogZS5vZmZzZXRMZWZ0LAogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBsZXQgaXNGb2xsb3dlZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgJC5hamF4KCdodHRwczovL3d3dy5waXhpdi5uZXQvYWpheC91c2VyLycgKyBfdGhpcy5hdHRyKCd1c2VySWQnKSArICc/ZnVsbD0xJywgewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgYXN5bmM6IGZhbHNlLAogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmVycm9yID09IGZhbHNlICYmIGRhdGEuYm9keS5pc0ZvbGxvd2VkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0ZvbGxvd2VkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAkKCcucHAtYXV0aG9yRGl2JykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICBsZXQgcHJlcyA9ICQoJzxkaXYgY2xhc3M9InBwLWF1dGhvckRpdiI+PGRpdiBjbGFzcz0icHBhLW1haW4iIHN0eWxlPSJwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogMHB4OyBsZWZ0OiAwcHg7IGJvcmRlci13aWR0aDogMXB4OyBib3JkZXItc3R5bGU6IHNvbGlkOyB6LWluZGV4OiAxOyBib3JkZXItY29sb3I6IHJnYmEoMCwgMCwgMCwgMC4wOCk7IGJvcmRlci1yYWRpdXM6IDhweDsiPjxkaXYgY2xhc3M9IiJzdHlsZT0iICAgIHdpZHRoOiAzMzZweDsgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDI1NSwgMjU1LCAyNTUpOyAgICBwYWRkaW5nLXRvcDogMjRweDsgICAgZmxleC1mbG93OiBjb2x1bW47Ij48ZGl2IGNsYXNzPSIic3R5bGU9IiBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBmbGV4LWZsb3c6IGNvbHVtbjsiPjxhIGNsYXNzPSJwcGEtYXV0aG9yTGluayI+PGRpdiByb2xlPSJpbWcic2l6ZT0iNjQiY2xhc3M9IiJzdHlsZT0iIGRpc3BsYXk6IGlubGluZS1ibG9jazsgd2lkdGg6IDY0cHg7IGhlaWdodDogNjRweDsgYm9yZGVyLXJhZGl1czogNTAlOyBvdmVyZmxvdzogaGlkZGVuOyI+PGltZyBjbGFzcz0icHBhLWF1dGhvckltYWdlIiB3aWR0aD0iNjQiaGVpZ2h0PSI2NCJzdHlsZT0ib2JqZWN0LWZpdDogY292ZXI7IG9iamVjdC1wb3NpdGlvbjogY2VudGVyIHRvcDsiPjwvZGl2PjwvYT48YSBjbGFzcz0icHBhLWF1dGhvckxpbmsiPjxkaXYgY2xhc3M9InBwYS1hdXRob3JOYW1lIiBzdHlsZT0iIGxpbmUtaGVpZ2h0OiAyNHB4OyBmb250LXNpemU6IDE2cHg7IGZvbnQtd2VpZ2h0OiBib2xkOyBtYXJnaW46IDRweCAwcHggMHB4OyI+PC9kaXY+PC9hPjxkaXYgY2xhc3M9IiJzdHlsZT0iIG1hcmdpbjogMTJweCAwcHggMjRweDsiPjxidXR0b24gdHlwZT0iYnV0dG9uImNsYXNzPSJwcGEtZm9sbG93InN0eWxlPSIgcGFkZGluZzogOXB4IDI1cHg7IGxpbmUtaGVpZ2h0OiAxOyBib3JkZXI6IG5vbmU7IGJvcmRlci1yYWRpdXM6IDE2cHg7IGZvbnQtd2VpZ2h0OiA3MDA7IGJhY2tncm91bmQtY29sb3I6ICMwMDk2ZmE7IGNvbG9yOiAjZmZmOyBjdXJzb3I6IHBvaW50ZXI7Ij48c3BhbiBzdHlsZT0ibWFyZ2luLXJpZ2h0OiA0cHg7Ij48c3ZnIHZpZXdCb3g9IjAgMCA4IDgid2lkdGg9IjEwImhlaWdodD0iMTAiY2xhc3M9IiJzdHlsZT0iIHN0cm9rZTogcmdiKDI1NSwgMjU1LCAyNTUpOyBzdHJva2UtbGluZWNhcDogcm91bmQ7IHN0cm9rZS13aWR0aDogMjsiPjxsaW5lIHgxPSIxInkxPSI0IngyPSI3InkyPSI0Ij48L2xpbmU+PGxpbmUgeDE9IjQieTE9IjEieDI9IjQieTI9IjciPjwvbGluZT48L3N2Zz48L3NwYW4+5YWz5rOoPC9idXR0b24+PC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+Jyk7CiAgICAgICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKHByZXMpOwogICAgICAgICAgICAgICAgbGV0IG9mZnNldCA9IGdldE9mZnNldCh0aGlzKTsKICAgICAgICAgICAgICAgIHByZXMuZmluZCgnLnBwYS1tYWluJykuY3NzKHsgJ3RvcCc6IG9mZnNldC5vZmZzZXRUb3AgLSAxOTYgKyAncHgnLCAnbGVmdCc6IG9mZnNldC5vZmZzZXRMZWZ0IC0gMTEzICsgJ3B4JyB9KTsKICAgICAgICAgICAgICAgIHByZXMuZmluZCgnLnBwYS1hdXRob3JMaW5rJykuYXR0cignaHJlZicsICcvbWVtYmVyLnBocD9pZD0nICsgX3RoaXMuYXR0cigndXNlcklkJykpOwogICAgICAgICAgICAgICAgcHJlcy5maW5kKCcucHBhLWF1dGhvckltYWdlJykuYXR0cignc3JjJywgX3RoaXMuYXR0cigncHJvZmlsZUltYWdlVXJsJykpOwogICAgICAgICAgICAgICAgcHJlcy5maW5kKCcucHBhLWF1dGhvck5hbWUnKS50ZXh0KF90aGlzLmF0dHIoJ3VzZXJOYW1lJykpOwogICAgICAgICAgICAgICAgaWYgKGlzRm9sbG93ZWQpIHsKICAgICAgICAgICAgICAgICAgICBwcmVzLmZpbmQoJy5wcGEtZm9sbG93JykuZ2V0KDApLm91dGVySFRNTCA9ICc8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9InBwYS1mb2xsb3cgZm9sbG93ZWQiIGRhdGEtY2xpY2stYWN0aW9uPSJjbGljayIgZGF0YS1jbGljay1sYWJlbD0iZm9sbG93IiBzdHlsZT0icGFkZGluZzogOXB4IDI1cHg7bGluZS1oZWlnaHQ6IDE7Ym9yZGVyOiBub25lO2JvcmRlci1yYWRpdXM6IDE2cHg7Zm9udC1zaXplOiAxNHB4O2ZvbnQtd2VpZ2h0OiA3MDA7Y3Vyc29yOiBwb2ludGVyOyI+5YWz5rOo5LitPC9idXR0b24+JzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHByZXMuZmluZCgnLnBwYS1mb2xsb3cnKS5hdHRyKCd1c2VySWQnLCBfdGhpcy5hdHRyKCd1c2VySWQnKSk7CiAgICAgICAgICAgICAgICBwcmVzLm9uKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgfSkub24oJ21vdXNlZW50ZXInLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnbW91c2VlbnRlcicpOwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgcHJlcy5maW5kKCcucHBhLWZvbGxvdycpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgdXNlcklkID0gJCh0aGlzKS5hdHRyKCd1c2VySWQnKTsKICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5oYXNDbGFzcygnZm9sbG93ZWQnKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyDlj5blhbMKICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KCdodHRwczovL3d3dy5waXhpdi5uZXQvcnBjX2dyb3VwX3NldHRpbmcucGhwJywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICd4LWNzcmYtdG9rZW4nOiBnX2NzcmZUb2tlbiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogJ21vZGU9ZGVsJnR5cGU9Ym9va3VzZXImaWQ9JyArIHVzZXJJZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5kKCdkZWxldGUgYm9va21hcmsgcmVzdWx0OiAnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmQoZGF0YSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLnR5cGUgPT0gJ2Jvb2t1c2VyJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcucHBhLWZvbGxvdycpLmdldCgwKS5vdXRlckhUTUwgPSAnPGJ1dHRvbiB0eXBlPSJidXR0b24iY2xhc3M9InBwYS1mb2xsb3cic3R5bGU9IiBwYWRkaW5nOiA5cHggMjVweDsgbGluZS1oZWlnaHQ6IDE7IGJvcmRlcjogbm9uZTsgYm9yZGVyLXJhZGl1czogMTZweDsgZm9udC13ZWlnaHQ6IDcwMDsgYmFja2dyb3VuZC1jb2xvcjogIzAwOTZmYTsgY29sb3I6ICNmZmY7IGN1cnNvcjogcG9pbnRlcjsiPjxzcGFuIHN0eWxlPSJtYXJnaW4tcmlnaHQ6IDRweDsiPjxzdmcgdmlld0JveD0iMCAwIDggOCJ3aWR0aD0iMTAiaGVpZ2h0PSIxMCJjbGFzcz0iInN0eWxlPSIgc3Ryb2tlOiByZ2IoMjU1LCAyNTUsIDI1NSk7IHN0cm9rZS1saW5lY2FwOiByb3VuZDsgc3Ryb2tlLXdpZHRoOiAyOyI+PGxpbmUgeDE9IjEieTE9IjQieDI9IjcieTI9IjQiPjwvbGluZT48bGluZSB4MT0iNCJ5MT0iMSJ4Mj0iNCJ5Mj0iNyI+PC9saW5lPjwvc3ZnPjwvc3Bhbj7lhbPms6g8L2J1dHRvbj4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5lKCdEZWxldGUgZm9sbG93IGZhaWxlZCEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWFs+azqAogICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC9ib29rbWFya19hZGQucGhwJywgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICd4LWNzcmYtdG9rZW4nOiBnX2NzcmZUb2tlbiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogJ21vZGU9YWRkJnR5cGU9dXNlciZ1c2VyX2lkPScgKyB1c2VySWQgKyAnJnRhZz0mcmVzdHJpY3Q9MCZmb3JtYXQ9anNvbicsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlMb2cuZCgnYWRkQm9va21hcmsgcmVzdWx0OiAnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpTG9nLmQoZGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3VjY2VzcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCcucHBhLWZvbGxvdycpLmdldCgwKS5vdXRlckhUTUwgPSAnPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSJwcGEtZm9sbG93IGZvbGxvd2VkIiBkYXRhLWNsaWNrLWFjdGlvbj0iY2xpY2siIGRhdGEtY2xpY2stbGFiZWw9ImZvbGxvdyIgc3R5bGU9InBhZGRpbmc6IDlweCAyNXB4O2xpbmUtaGVpZ2h0OiAxO2JvcmRlcjogbm9uZTtib3JkZXItcmFkaXVzOiAxNnB4O2ZvbnQtc2l6ZTogMTRweDtmb250LXdlaWdodDogNzAwO2N1cnNvcjogcG9pbnRlcjsiPuWFs+azqOS4rTwvYnV0dG9uPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaUxvZy5lKCdGb2xsb3cgZmFpbGVkIScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pLm9uKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGlmICghJCgnLnBwLWF1dGhvckRpdicpLmhhc0NsYXNzKCdtb3VzZWVudGVyJykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnLnBwLWF1dGhvckRpdicpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDIwMCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKHdvcmtzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgJChjb250YWluZXIpLnNob3coKS5nZXQoMCkub3V0ZXJIVE1MID0gJzxkaXYgY2xhc3M9IiJzdHlsZT0iZGlzcGxheTogZmxleDthbGlnbi1pdGVtczogY2VudGVyO2p1c3RpZnktY29udGVudDogY2VudGVyOyBoZWlnaHQ6IDQwOHB4O2ZsZXgtZmxvdzogY29sdW1uOyI+PGRpdiBjbGFzcz0iInN0eWxlPSJtYXJnaW4tYm90dG9tOiAxMnB4O2NvbG9yOiByZ2JhKDAsIDAsIDAsIDAuMTYpOyI+PHN2ZyB2aWV3Qm94PSIwIDAgMTYgMTYic2l6ZT0iNzIic3R5bGU9ImZpbGw6IGN1cnJlbnRjb2xvcjtoZWlnaHQ6IDcycHg7dmVydGljYWwtYWxpZ246IG1pZGRsZTsiPjxwYXRoIGQ9Ik04LjI1NzM5IDkuMTcxNkM3LjQ2Njk2IDkuNjk1MTIgNi41MTkwOCAxMCA1LjUgMTBDMi43Mzg1OCAxMCAwLjUgNy43NjE0MiAwLjUgNUMwLjUgMi4yMzg1OCAyLjczODU4IDAgNS41IDBDOC4yNjE0MiAwIDEwLjUgMi4yMzg1OCAxMC41IDVDMTAuNSA2LjAxOTA4IDEwLjE5NTEgNi45NjY5NiA5LjY3MTYxIDcuNzU3MzlMMTEuNzA3MSA5Ljc5Mjg4QzEyLjA5NzYgMTAuMTgzNCAxMi4wOTc2IDEwLjgxNjYgMTEuNzA3MSAxMS4yMDcxQzExLjMxNjYgMTEuNTk3NiAxMC42ODM0IDExLjU5NzYgMTAuMjkyOSAxMS4yMDcxTDguMjU3MzkgOS4xNzE2Wk04LjUgNUM4LjUgNi42NTY4NSA3LjE1Njg1IDggNS41IDhDMy44NDMxNSA4IDIuNSA2LjY1Njg1IDIuNSA1QzIuNSAzLjM0MzE1IDMuODQzMTUgMiA1LjUgMkM3LjE1Njg1IDIgOC41IDMuMzQzMTUgOC41IDVaInRyYW5zZm9ybT0idHJhbnNsYXRlKDIuMjUgMi4yNSkiZmlsbC1ydWxlPSJldmVub2RkImNsaXAtcnVsZT0iZXZlbm9kZCI+PC9wYXRoPjwvc3ZnPjwvZGl2PjxzcGFuIGNsYXNzPSJzYy1Mek1DTyBmTERVelUiPicKICAgICAgICAgICAgICAgICAgICArIFRleHRzW2dfbGFuZ3VhZ2VdLnNvcnRfbm9Xb3JrLnJlcGxhY2UoJyUxJywgd29ya3NDb3VudCkgKyAnPC9zcGFuPjwvZGl2Pic7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIOaBouWkjeaYvuekugogICAgICAgICAgICAkKCcjbG9hZGluZycpLnJlbW92ZSgpOwogICAgICAgICAgICAkKGNvbnRhaW5lcikuc2hvdygpOwoKICAgICAgICAgICAgaWYgKCQoJyNzb3J0VHlwZUJ1dHRvbnMnKS5sZW5ndGggPT0gMCkgewogICAgICAgICAgICAgICAgbGV0IHNvcnREaXYgPSAkKCc8ZGl2IGlkPSJzb3J0VHlwZUJ1dHRvbnMiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1mbGV4OyBtYXJnaW4tYm90dG9tOiAxMHB4OyI+PC9kaXY+Jyk7CiAgICAgICAgICAgICAgICBsZXQgYm9va21hcmtTb3J0QnV0dG9uID0gJCgnPGRpdiBzdHlsZT0iY3Vyc29yOiBwb2ludGVyOyBib3gtc2l6aW5nOiBib3JkZXItYm94O3RleHQtZGVjb3JhdGlvbjogbm9uZTtkaXNwbGF5OiBmbGV4Oy13ZWJraXQtYm94LWFsaWduOiBjZW50ZXI7YWxpZ24taXRlbXM6IGNlbnRlcjtib3JkZXItcmFkaXVzOiA0cHg7aGVpZ2h0OiA0MHB4O3BhZGRpbmctcmlnaHQ6IDI0cHg7cGFkZGluZy1sZWZ0OiAyNHB4O2NvbG9yOiB2YXIoLS1jaGFyY29hbC10ZXh0NSk7YmFja2dyb3VuZC1jb2xvcjogcmdiKDEzMSwgMTI2LCAyMDApOyI+JyArIFRleHRzW2dfbGFuZ3VhZ2VdLnNvcnRfc29ydEJ5Qm9va21hcmsgKyAnPC9kaXY+Jyk7CiAgICAgICAgICAgICAgICBsZXQgbGlrZVNvcnRCdXR0b24gPSAkKCc8ZGl2IHN0eWxlPSJjdXJzb3I6IHBvaW50ZXI7IGJveC1zaXppbmc6IGJvcmRlci1ib3g7dGV4dC1kZWNvcmF0aW9uOiBub25lO2Rpc3BsYXk6IGZsZXg7LXdlYmtpdC1ib3gtYWxpZ246IGNlbnRlcjthbGlnbi1pdGVtczogY2VudGVyO2JvcmRlci1yYWRpdXM6IDRweDtoZWlnaHQ6IDQwcHg7cGFkZGluZy1yaWdodDogMjRweDtwYWRkaW5nLWxlZnQ6IDI0cHg7Y29sb3I6IHZhcigtLWNoYXJjb2FsLXRleHQ1KTtiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjAwLCAxMjYsIDE3Myk7IG1hcmdpbi1sZWZ0OiAxMHB4OyI+JyArIFRleHRzW2dfbGFuZ3VhZ2VdLnNvcnRfc29ydEJ5TGlrZSArICc8L2Rpdj4nKTsKICAgICAgICAgICAgICAgIGxldCB2aWV3U29ydEJ1dHRvbiA9ICQoJzxkaXYgc3R5bGU9ImN1cnNvcjogcG9pbnRlcjsgYm94LXNpemluZzogYm9yZGVyLWJveDt0ZXh0LWRlY29yYXRpb246IG5vbmU7ZGlzcGxheTogZmxleDstd2Via2l0LWJveC1hbGlnbjogY2VudGVyO2FsaWduLWl0ZW1zOiBjZW50ZXI7Ym9yZGVyLXJhZGl1czogNHB4O2hlaWdodDogNDBweDtwYWRkaW5nLXJpZ2h0OiAyNHB4O3BhZGRpbmctbGVmdDogMjRweDtjb2xvcjogdmFyKC0tY2hhcmNvYWwtdGV4dDUpO2JhY2tncm91bmQtY29sb3I6IHJnYigxMzAsIDIwMCwgMTI2KTsgbWFyZ2luLWxlZnQ6MTBweCI+JyArIFRleHRzW2dfbGFuZ3VhZ2VdLnNvcnRfc29ydEJ5VmlldyArICc8L2Rpdj4nKTsKICAgICAgICAgICAgICAgIGJvb2ttYXJrU29ydEJ1dHRvbi5jbGljaygoKSA9PiBjbGVhckFuZFVwZGF0ZVdvcmtzKDApKTsKICAgICAgICAgICAgICAgIGxpa2VTb3J0QnV0dG9uLmNsaWNrKCgpID0+IGNsZWFyQW5kVXBkYXRlV29ya3MoMSkpOwogICAgICAgICAgICAgICAgdmlld1NvcnRCdXR0b24uY2xpY2soKCkgPT4gY2xlYXJBbmRVcGRhdGVXb3JrcygyKSk7CiAgICAgICAgICAgICAgICBzb3J0RGl2LmFwcGVuZChib29rbWFya1NvcnRCdXR0b24pOwogICAgICAgICAgICAgICAgc29ydERpdi5hcHBlbmQobGlrZVNvcnRCdXR0b24pOwogICAgICAgICAgICAgICAgc29ydERpdi5hcHBlbmQodmlld1NvcnRCdXR0b24pOwogICAgICAgICAgICAgICAgJChjb250YWluZXIpLmJlZm9yZShzb3J0RGl2KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgUGFnZXNbUGFnZVR5cGUuU2VhcmNoXS5Qcm9jZXNzUGFnZUVsZW1lbnRzKCk7CgogICAgICAgICAgICAvLyDnm5HlkKzplK7nm5jnmoTlt6blj7PplK7vvIznlKjmnaXnv7vpobUKICAgICAgICAgICAgJChkb2N1bWVudCkua2V5ZG93bihmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAgICAgaWYgKGdfc2V0dGluZ3MucGFnZUJ5S2V5ICE9IDEpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDM5KSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGJ0biA9ICQoJy5wcC1uZXh0UGFnZScpOwogICAgICAgICAgICAgICAgICAgIGlmIChidG4ubGVuZ3RoIDwgMSB8fCBidG4uYXR0cignaGlkZGVuJykgPT0gJ2hpZGRlbicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAvLyDlvojlpYfmgKrkuI3og73nlKggY2xpY2soKQogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBidG4uYXR0cignaHJlZicpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleUNvZGUgPT0gMzcpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYnRuID0gJCgnLnBwLXByZXZQYWdlJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGJ0bi5sZW5ndGggPCAxIHx8IGJ0bi5hdHRyKCdoaWRkZW4nKSA9PSAnaGlkZGVuJykgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBidG4uYXR0cignaHJlZicpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChjYWxsYmFjaykgewogICAgICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQp9OwoKLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSDlsI/or7QgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwpmdW5jdGlvbiBQaXhpdk5TKGNhbGxiYWNrKSB7CiAgICBmdW5jdGlvbiBmaW5kTm92ZWxTZWN0aW9uKCkgewogICAgICAgIGxldCB1bCA9ICQoJ3NlY3Rpb246Zmlyc3QnKS5maW5kKCd1bDpmaXJzdCcpOwogICAgICAgIGlmICh1bC5sZW5ndGggPT0gMCkgewogICAgICAgICAgICBpTG9nLmUoJ0NhbiBub3QgZm91bmQgbm92ZWwgbGlzdC4nKTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1bDsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRTZWFyY2hQYXJhbXNXaXRob3V0UGFnZSgpIHsKICAgICAgICByZXR1cm4gbG9jYXRpb24uc2VhcmNoLnN1YnN0cigxKS5yZXBsYWNlKC8mP3A9XGQrLywgJycpOwogICAgfQoKICAgIGZ1bmN0aW9uIGdldE5vdmVsVGVtcGxhdGUodWwpIHsKICAgICAgICBpZiAoIXVsKSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgICBpZiAodWwubGVuZ3RoID09IDApIHsKICAgICAgICAgICAgaUxvZy5lKCdFbXB0eSBsaXN0LCBjYW4gbm90IGNyZWF0ZSB0ZW1wbGF0ZS4nKTsKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICAgIGxldCB0ZW1wbGF0ZSA9IHVsLmNoaWxkcmVuKCkuZXEoMCkuY2xvbmUodHJ1ZSk7CiAgICAgICAgLy8g5bem5L6n5Zu+54mHCiAgICAgICAgbGV0IHBpY0RpdiA9IHRlbXBsYXRlLmNoaWxkcmVuKCkuZXEoMCkuY2hpbGRyZW4oKS5lcSgwKTsKICAgICAgICBwaWNEaXYuZmluZCgnYTpmaXJzdCcpLmFkZENsYXNzKCdwbnMtbGluaycpOwogICAgICAgIHBpY0Rpdi5maW5kKCdpbWc6Zmlyc3QnKS5hZGRDbGFzcygncG5zLWltZycpOwogICAgICAgIC8vIOWPs+S+p+ivpuaDhQogICAgICAgIGxldCBkZXRhaWxEaXYgPSB0ZW1wbGF0ZS5jaGlsZHJlbigpLmVxKDApLmNoaWxkcmVuKCkuZXEoMSkuY2hpbGRyZW4oKS5lcSgwKTsKICAgICAgICBsZXQgdGl0bGVEaXYgPSBkZXRhaWxEaXYuY2hpbGRyZW4oKS5lcSgwKTsKICAgICAgICBpZiAodGl0bGVEaXYuY2hpbGRyZW4oKS5sZW5ndGggPiAxKSB7CiAgICAgICAgICAgIHRpdGxlRGl2LmNoaWxkcmVuKCkuZXEoMCkuYWRkQ2xhc3MoJ3Bucy1zZXJpZXMnKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDlpoLmnpzkvZzkuLrmqKHmnb/nmoRESVbmsqHmnInns7vliJfvvIzlsLHoh6rlt7HliqDkuIDkuKoKICAgICAgICAgICAgbGV0IHNlcmllcyA9ICQoJzxhIGNsYXNzPSJwbnMtc2VyaWVzIiBocmVmPSIvbm92ZWwvc2VyaWVzLzAwMDAwMCI+PC9hPicpOwogICAgICAgICAgICBzZXJpZXMuY3NzKHsKICAgICAgICAgICAgICAgICdkaXNwbGF5JzogJ2lubGluZS1ibG9jaycsCiAgICAgICAgICAgICAgICAnd2hpdGUtc3BhY2UnOiAnbm93cmFwJywKICAgICAgICAgICAgICAgICd0ZXh0LW92ZXJmbG93JzogJ2VsbGlwc2lzJywKICAgICAgICAgICAgICAgICdvdmVyZmxvdyc6ICdoaWRkZW4nLAogICAgICAgICAgICAgICAgJ21heC13aWR0aCc6ICcxMDAlJywKICAgICAgICAgICAgICAgICdsaW5lLWhlaWdodCc6ICcyMnB4JywKICAgICAgICAgICAgICAgICdmb250LXNpemUnOiAnMTRweCcsCiAgICAgICAgICAgICAgICAndGV4dC1kZWNvcmF0aW9uJzogJ25vbmUnCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAkKCdoZWFkJykuYXBwZW5kKCc8c3R5bGU+LnBucy1zZXJpZXM6dmlzaXRlZHtjb2xvcjpyZ2IoMTczLDE3MywxNzMpfTwvc3R5bGU+Jyk7CiAgICAgICAgICAgIHRpdGxlRGl2LnByZXBlbmQoc2VyaWVzKTsKICAgICAgICB9CiAgICAgICAgdGl0bGVEaXYuY2hpbGRyZW4oKS5lcSgxKS5jaGlsZHJlbigpLmVxKDApLmFkZENsYXNzKCdwbnMtdGl0bGUnKS5hZGRDbGFzcygncG5zLWxpbmsnKTsKICAgICAgICBkZXRhaWxEaXYuZmluZCgnLmd0bS1ub3ZlbC1zZWFyY2hwYWdlLXJlc3VsdC11c2VyOmZpcnN0JykuYWRkQ2xhc3MoJ3Bucy1hdXRob3ItaW1nJyk7CiAgICAgICAgZGV0YWlsRGl2LmZpbmQoJy5ndG0tbm92ZWwtc2VhcmNocGFnZS1yZXN1bHQtdXNlcjpsYXN0JykuYWRkQ2xhc3MoJ3Bucy1hdXRob3InKTsKICAgICAgICBsZXQgdGFnRGl2ID0gZGV0YWlsRGl2LmNoaWxkcmVuKCkuZXEoMikuY2hpbGRyZW4oKS5lcSgwKTsKICAgICAgICBsZXQgYm9va21hcmtEaXYgPSB0YWdEaXYuY2hpbGRyZW4oKS5lcSgyKTsKICAgICAgICBib29rbWFya0Rpdi5maW5kKCdzcGFuOmZpcnN0JykuYWRkQ2xhc3MoJ3Bucy10ZXh0LWNvdW50Jyk7CiAgICAgICAgaWYgKGJvb2ttYXJrRGl2LmZpbmQoJ3NwYW4nKS5sZW5ndGggPCAyKSB7CiAgICAgICAgICAgIGxldCB0ZXh0U3BhbiA9IGJvb2ttYXJrRGl2LmZpbmQoJy5wbnMtdGV4dC1jb3VudCcpOwogICAgICAgICAgICB0ZXh0U3Bhbi5hcHBlbmQoJzxzcGFuIGNsYXNzPSJwbnMtYm9va21hcmstY291bnQiPjxzcGFuPjxkaXYgY2xhc3M9InNjLWVvcW13by0xIGdyU2VaRyI+PHNwYW4gY2xhc3M9InNjLTE0aGVvc2QtMCBnYk5qRWoiPjxzdmcgdmlld0JveD0iMCAwIDEyIDEyIiBzaXplPSIxMiIgY2xhc3M9InNjLTE0aGVvc2QtMSBZdFpvcCI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik05IDAuNzVDMTAuNjU2OSAwLjc1IDEyIDIuMDkzMTUgMTIgMy43NUMxMiA3LjcxNzAzIDcuMzM3MDkgMTAuNzEyNiA2LjIzMjU2IDExLjM2NjZDNi4wODcxNyAxMS40NTI2IDUuOTEyODMgMTEuNDUyNiA1Ljc2NzQ0IDExLjM2NjZDNC42NjI5IDEwLjcxMjYgMCA3LjcxNzAzIDAgMy43NUMwIDIuMDkzMTUgMS4zNDMxNSAwLjc1IDMgMC43NUM0LjEyNjUgMC43NSA1LjMzOTExIDEuNjAyMDIgNiAyLjY2ODIzQzYuNjYwODkgMS42MDIwMiA3Ljg3MzUgMC43NSA5IDAuNzVaIj48L3BhdGg+PC9zdmc+PC9zcGFuPjxzcGFuIGNsYXNzPSJzYy1lb3Ftd28tMiBkZlVtSkoiPjIsNDQxPC9zcGFuPjwvZGl2Pjwvc3Bhbj48L3NwYW4+Jyk7CiAgICAgICAgICAgIGJvb2ttYXJrRGl2LmZpbmQoJy5wbnMtYm9va21hcmstY291bnQnKS5hZGRDbGFzcyh0ZXh0U3Bhbi5nZXQoMCkuY2xhc3NOYW1lKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBib29rbWFya0Rpdi5maW5kKCdzcGFuOmxhc3QnKS5hZGRDbGFzcygncG5zLWJvb2ttYXJrLWNvdW50JykucGFyZW50KCkuYWRkQ2xhc3MoJ3Bucy1ib29rbWFyay1kaXYnKTsKICAgICAgICB9CiAgICAgICAgdGFnRGl2LmNoaWxkcmVuKCkuZXEoMCkuZW1wdHkoKS5hZGRDbGFzcygncG5zLXRhZy1saXN0Jyk7CiAgICAgICAgbGV0IGRlc2NEaXYgPSB0YWdEaXYuY2hpbGRyZW4oKS5lcSgxKTsKICAgICAgICBkZXNjRGl2LmNoaWxkcmVuKCkuZXEoMCkuYWRkQ2xhc3MoJ3Bucy1kZXNjJyk7CiAgICAgICAgLy8g5Y+z5LiL6KeS54ix5b+DCiAgICAgICAgbGV0IGxpa2VEaXYgPSBkZXRhaWxEaXYuY2hpbGRyZW4oKS5lcSgyKS5jaGlsZHJlbigpLmVxKDEpOwogICAgICAgIGxldCBzdmcgPSBsaWtlRGl2LmZpbmQoJ3N2ZycpOwogICAgICAgIHN2Zy5hdHRyKCdjbGFzcycsIHN2Zy5hdHRyKCdjbGFzcycpICsgJyBwbnMtbGlrZScpOwogICAgICAgIGxpa2VEaXYuZmluZCgncGF0aDpmaXJzdCcpLmNzcygnY29sb3InLCAncmdiKDMxLCAzMSwgMzEpJyk7CiAgICAgICAgbGlrZURpdi5maW5kKCdwYXRoOmxhc3QnKS5jc3MoJ2ZpbGwnLCAncmdiKDI1NSwgMjU1LCAyNTUpJyk7CgogICAgICAgIHJldHVybiB0ZW1wbGF0ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBmaWxsVGVtcGxhdGUodGVtcGxhdGUsIG5vdmVsKSB7CiAgICAgICAgaWYgKHRlbXBsYXRlID09IG51bGwgfHwgbm92ZWwgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9CiAgICAgICAgbGV0IGxpbmsgPSB0ZW1wbGF0ZS5maW5kKCcucG5zLWxpbms6Zmlyc3QnKS5hdHRyKCdocmVmJykucmVwbGFjZSgvaWQ9XGQrL2csICdpZD0nICsgbm92ZWwuaWQpOwogICAgICAgIHRlbXBsYXRlLmZpbmQoJy5wbnMtbGluaycpLmF0dHIoJ2hyZWYnLCBsaW5rKTsKICAgICAgICB0ZW1wbGF0ZS5maW5kKCcucG5zLWltZycpLmF0dHIoJ3NyYycsIG5vdmVsLnVybCk7CiAgICAgICAgaWYgKG5vdmVsLnNlcmllc0lkKSB7CiAgICAgICAgICAgIGxldCBzZXJpZXNMaW5rID0gdGVtcGxhdGUuZmluZCgnLnBucy1zZXJpZXMnKS5hdHRyKCdocmVmJykucmVwbGFjZSgvXGQrJC8sIG5vdmVsLnNlcmllc0lkKTsKICAgICAgICAgICAgdGVtcGxhdGUuZmluZCgnLnBucy1zZXJpZXMnKS50ZXh0KG5vdmVsLnNlcmllc1RpdGxlKS5hdHRyKCd0aXRsZScsIG5vdmVsLnNlcmllc1RpdGxlKS5hdHRyKCdocmVmJywgc2VyaWVzTGluayk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGVtcGxhdGUuZmluZCgnLnBucy1zZXJpZXMnKS5oaWRlKCk7CiAgICAgICAgfQogICAgICAgIHRlbXBsYXRlLmZpbmQoJy5wbnMtdGl0bGUnKS50ZXh0KG5vdmVsLnRpdGxlKS5hdHRyKCd0aXRsZScsIG5vdmVsLnRpdGxlKTsKICAgICAgICB0ZW1wbGF0ZS5maW5kKCcucG5zLXRpdGxlJykucGFyZW50KCkuYXR0cigndGl0bGUnLCBub3ZlbC50aXRsZSk7CiAgICAgICAgbGV0IGF1dGhvckxpbmsgPSB0ZW1wbGF0ZS5maW5kKCcucG5zLWF1dGhvcicpLmF0dHIoJ2hyZWYnKS5yZXBsYWNlKC9cZCskLywgbm92ZWwudXNlcklkKTsKICAgICAgICB0ZW1wbGF0ZS5maW5kKCcucG5zLWF1dGhvcicpLnRleHQobm92ZWwudXNlck5hbWUpLmF0dHIoJ2hyZWYnLCBhdXRob3JMaW5rKTsKICAgICAgICB0ZW1wbGF0ZS5maW5kKCcucG5zLWF1dGhvci1pbWcnKS5hdHRyKCdocmVmJywgYXV0aG9yTGluaykuZmluZCgnaW1nJykuYXR0cignc3JjJywgbm92ZWwucHJvZmlsZUltYWdlVXJsKTsKICAgICAgICB0ZW1wbGF0ZS5maW5kKCcucG5zLXRleHQtY291bnQnKS50ZXh0KG5vdmVsLnRleHRDb3VudCArICfmloflrZcnKTsKICAgICAgICBpZiAobm92ZWwuYm9va21hcmtDb3VudCA9PSAwKSB7CiAgICAgICAgICAgIHRlbXBsYXRlLmZpbmQoJy5wbnMtYm9va21hcmstZGl2JykuaGlkZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRlbXBsYXRlLmZpbmQoJy5wbnMtYm9va21hcmstY291bnQnKS50ZXh0KG5vdmVsLmJvb2ttYXJrQ291bnQpOwogICAgICAgIH0KICAgICAgICBsZXQgdGFnTGlzdCA9IHRlbXBsYXRlLmZpbmQoJy5wbnMtdGFnLWxpc3QnKTsKICAgICAgICBsZXQgc2VhcmNoID0gZ2V0U2VhcmNoUGFyYW1zV2l0aG91dFBhZ2UoKTsKICAgICAgICBpZiAoc2VhcmNoLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgc2VhcmNoID0gJz8nICsgc2VhcmNoOwogICAgICAgIH0KICAgICAgICAkLmVhY2gobm92ZWwudGFncywgZnVuY3Rpb24gKGksIHRhZykgewogICAgICAgICAgICBsZXQgdGFnSXRlbSA9ICQoJzxzcGFuIj48YSBzdHlsZT0iY29sb3I6IHJnYig2MSwgMTE4LCAxNTMpOyIgaHJlZj0iL3RhZ3MvJyArIGVuY29kZVVSSUNvbXBvbmVudCh0YWcpICsgJy9ub3ZlbHMnICsgc2VhcmNoICsgJyI+JyArIHRhZyArICc8L2E+PC9zcGFuPicpOwogICAgICAgICAgICBpZiAodGFnID09ICdSLTE4JyB8fCB0YWcgPT0gJ1ItMThHJykgewogICAgICAgICAgICAgICAgdGFnSXRlbS5maW5kKCdhJykuY3NzKHsgJ2NvbG9yJzogJ3JnYigyNTUsIDY0LCA5NiknLCAnZm9udC13ZWlnaHQnOiAnYm9sZCcgfSkudGV4dCh0YWcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRhZ0xpc3QuYXBwZW5kKHRhZ0l0ZW0pOwogICAgICAgIH0pOwogICAgICAgIHRlbXBsYXRlLmZpbmQoJy5wbnMtZGVzYycpLmh0bWwobm92ZWwuZGVzY3JpcHRpb24pLmF0dHIoJ3RpdGxlJywgdGVtcGxhdGUuZmluZCgnLnBucy1kZXNjJykudGV4dCgpKTsKICAgICAgICBsZXQgbGlrZSA9IHRlbXBsYXRlLmZpbmQoJy5wbnMtbGlrZScpOwogICAgICAgIGxpa2UuYXR0cignbm92ZWwtaWQnLCBub3ZlbC5pZCk7CiAgICAgICAgaWYgKG5vdmVsLmJvb2ttYXJrRGF0YSkgewogICAgICAgICAgICBsaWtlLmF0dHIoJ2Jvb2ttYXJrLWlkJywgbm92ZWwuYm9va21hcmtEYXRhLmlkKTsKICAgICAgICAgICAgbGlrZS5maW5kKCdwYXRoOmZpcnN0JykuY3NzKCdjb2xvcicsICdyZ2IoMjU1LCA2NCwgOTYpJyk7CiAgICAgICAgICAgIGxpa2UuZmluZCgncGF0aDpsYXN0JykuY3NzKCdmaWxsJywgJ3JnYigyNTUsIDY0LCA5NiknKTsKICAgICAgICB9CiAgICAgICAgbGlrZS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGlmICgkKHRoaXMpLmF0dHIoJ2Rpc2FibGUnKSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBiaWQgPSAkKHRoaXMpLmF0dHIoJ2Jvb2ttYXJrLWlkJyk7CiAgICAgICAgICAgIGxldCBuaWQgPSAkKHRoaXMpLmF0dHIoJ25vdmVsLWlkJyk7CiAgICAgICAgICAgIGlmIChiaWQpIHsKICAgICAgICAgICAgICAgIGRlbGV0ZUJvb2ttYXJrKCQodGhpcyksIGJpZCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhZGRCb29rbWFyaygkKHRoaXMpLCBuaWQsIDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgICQodGhpcykuYmx1cigpOwogICAgICAgIH0pOwogICAgICAgIGlmIChnX3NldHRpbmdzLmxpbmtCbGFuaykgewogICAgICAgICAgICB0ZW1wbGF0ZS5maW5kKCdhJykuYXR0cigndGFyZ2V0JywgJ19ibGFuaycpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdGVtcGxhdGU7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Tm92ZWxCeVBhZ2Uoa2V5LCBmcm9tLCB0bywgdG90YWwpIHsKICAgICAgICBpZiAodG90YWwgPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIHRvdGFsID0gdG8gLSBmcm9tOwogICAgICAgIH0KCiAgICAgICAgbGV0IHVybCA9IGxvY2F0aW9uLm9yaWdpbiArIGdfZ2V0Tm92ZWxVcmwucmVwbGFjZSgvI2tleSMvZywga2V5KS5yZXBsYWNlKC8jcGFnZSMvZywgZnJvbSk7CiAgICAgICAgbGV0IHNlYXJjaCA9IGdldFNlYXJjaFBhcmFtc1dpdGhvdXRQYWdlKCk7CiAgICAgICAgaWYgKHNlYXJjaC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHVybCArPSAnJicgKyBzZWFyY2g7CiAgICAgICAgfQoKICAgICAgICB1cGRhdGVQcm9ncmVzcyhUZXh0c1tnX2xhbmd1YWdlXS5uc29ydF9nZXRXb3Jrcy5yZXBsYWNlKCcxJScsIHRvdGFsIC0gdG8gKyBmcm9tICsgMSkucmVwbGFjZSgnMiUnLCB0b3RhbCkpOwoKICAgICAgICBsZXQgbm92ZWxMaXN0ID0gW107CiAgICAgICAgZnVuY3Rpb24gb25Mb2FkRmluaXNoKGRhdGEsIHJlc29sdmUpIHsKICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5ib2R5ICYmIGRhdGEuYm9keS5ub3ZlbCAmJiBkYXRhLmJvZHkubm92ZWwuZGF0YSkgewogICAgICAgICAgICAgICAgbm92ZWxMaXN0ID0gbm92ZWxMaXN0LmNvbmNhdChkYXRhLmJvZHkubm92ZWwuZGF0YSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChmcm9tID09IHRvIC0gMSkgewogICAgICAgICAgICAgICAgcmVzb2x2ZShub3ZlbExpc3QpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgZ2V0Tm92ZWxCeVBhZ2Uoa2V5LCBmcm9tICsgMSwgdG8sIHRvdGFsKS50aGVuKGZ1bmN0aW9uIChsaXN0KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGxpc3QgJiYgbGlzdC5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG5vdmVsTGlzdCA9IG5vdmVsTGlzdC5jb25jYXQobGlzdCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJlc29sdmUobm92ZWxMaXN0KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIG9uTG9hZEZpbmlzaChkYXRhLCByZXNvbHZlKTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGlMb2cuZSgnZ2V0IG5vdmVsIHBhZ2UgJyArIGZyb20gKyAnIGZhaWxlZCEnKTsKICAgICAgICAgICAgICAgICAgICBvbkxvYWRGaW5pc2gobnVsbCwgcmVzb2x2ZSk7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0KCiAgICBmdW5jdGlvbiBzb3J0Tm92ZWwobGlzdCkgewogICAgICAgIHVwZGF0ZVByb2dyZXNzKFRleHRzW2dfbGFuZ3VhZ2VdLm5zb3J0X3NvcnRpbmcpOwogICAgICAgIC8vIOaOkuW6jwogICAgICAgIGxpc3Quc29ydChmdW5jdGlvbiAoYSwgYikgewogICAgICAgICAgICBsZXQgYm9va21hcmtBID0gYS5ib29rbWFya0NvdW50OwogICAgICAgICAgICBsZXQgYm9va21hcmtCID0gYi5ib29rbWFya0NvdW50OwogICAgICAgICAgICBpZiAoIWJvb2ttYXJrQSkgewogICAgICAgICAgICAgICAgYm9va21hcmtBID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIWJvb2ttYXJrQikgewogICAgICAgICAgICAgICAgYm9va21hcmtCID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoYm9va21hcmtBID4gYm9va21hcmtCKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGJvb2ttYXJrQSA8IGJvb2ttYXJrQikgewogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfSk7CiAgICAgICAgLy8g562b6YCJCiAgICAgICAgbGV0IGZpbHRlcmVkTGlzdCA9IFtdOwogICAgICAgICQuZWFjaChsaXN0LCBmdW5jdGlvbiAoaSwgZSkgewogICAgICAgICAgICAvLyDmlLbol4/ph4/nrZvpgIkKICAgICAgICAgICAgbGV0IGJvb2ttYXJrID0gZS5ib29rbWFya0NvdW50OwogICAgICAgICAgICBpZiAoIWJvb2ttYXJrKSB7CiAgICAgICAgICAgICAgICBib29rbWFyayA9IDA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGJvb2ttYXJrIDwgZ19zZXR0aW5ncy5ub3ZlbEZhdkZpbHRlcikgewogICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g5bey5pS26JeP562b6YCJCiAgICAgICAgICAgIGlmIChnX3NldHRpbmdzLm5vdmVsSGlkZUZhdm9yaXRlICYmIGUuYm9va21hcmtEYXRhKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmaWx0ZXJlZExpc3QucHVzaChlKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gZmlsdGVyZWRMaXN0OwogICAgfQoKICAgIGZ1bmN0aW9uIHJlYXJyYW5nZU5vdmVsKGxpc3QpIHsKICAgICAgICBsZXQgdWwgPSBmaW5kTm92ZWxTZWN0aW9uKCk7CiAgICAgICAgaWYgKHVsID09IG51bGwpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsZXQgdGVtcGxhdGUgPSBnZXROb3ZlbFRlbXBsYXRlKHVsKTsKICAgICAgICBpZiAodGVtcGxhdGUgPT0gbnVsbCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxldCBuZXdMaXN0ID0gW107CiAgICAgICAgJC5lYWNoKGxpc3QsIGZ1bmN0aW9uIChpLCBub3ZlbCkgewogICAgICAgICAgICBsZXQgZSA9IGZpbGxUZW1wbGF0ZSh0ZW1wbGF0ZS5jbG9uZSh0cnVlKSwgbm92ZWwpOwogICAgICAgICAgICBpZiAoZSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBuZXdMaXN0LnB1c2goZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICB1bC5lbXB0eSgpOwogICAgICAgICQuZWFjaChuZXdMaXN0LCBmdW5jdGlvbiAoaSwgZSkgewogICAgICAgICAgICAkKGUpLmNzcygnZGlzcGxheScsICdibG9jaycpOwogICAgICAgICAgICB1bC5hcHBlbmQoZSk7CiAgICAgICAgfSk7CiAgICAgICAgaGlkZUxvYWRpbmcoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBnZXRLZXlXb3JkKCkgewogICAgICAgIGxldCBtYXRjaCA9IGxvY2F0aW9uLnBhdGhuYW1lLm1hdGNoKC9cL3RhZ3NcLyguKylcL25vdmVscy8pOwogICAgICAgIGlmICghbWF0Y2gpIHsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbWF0Y2hbMV07CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0Q3VycmVudFBhZ2UoKSB7CiAgICAgICAgbGV0IG1hdGNoID0gbG9jYXRpb24uc2VhcmNoLm1hdGNoKC9wPShcZCspLyk7CiAgICAgICAgaWYgKG1hdGNoKSB7CiAgICAgICAgICAgIHJldHVybiBwYXJzZUludChtYXRjaFsxXSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAxOwogICAgfQoKICAgIGZ1bmN0aW9uIHNob3dMb2FkaW5nKCkgewogICAgICAgIGxldCB1bCA9IGZpbmROb3ZlbFNlY3Rpb24oKTsKICAgICAgICBpZiAodWwgPT0gbnVsbCkgewogICAgICAgICAgICBpTG9nLmUoJ0NhbiBub3QgZm91bmQgbm92ZWwgc2VjdGlvbiEnKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdWwuaGlkZSgpLmJlZm9yZSgnPGRpdiBpZD0ibG9hZGluZyIgc3R5bGU9IndpZHRoOjEwMCU7dGV4dC1hbGlnbjpjZW50ZXI7Ij48aW1nIHNyYz0iJyArIGdfbG9hZGluZ0ltYWdlICsgJyIgLz48cCBpZD0icHJvZ3Jlc3MiIHN0eWxlPSJ0ZXh0LWFsaWduOiBjZW50ZXI7Zm9udC1zaXplOiBsYXJnZTtmb250LXdlaWdodDogYm9sZDtwYWRkaW5nLXRvcDogMTBweDsiPjAlPC9wPjwvZGl2PicpOwogICAgfQoKICAgIGZ1bmN0aW9uIGhpZGVMb2FkaW5nKCkgewogICAgICAgIGxldCB1bCA9IGZpbmROb3ZlbFNlY3Rpb24oKTsKICAgICAgICBpZiAodWwgPT0gbnVsbCkgewogICAgICAgICAgICBpTG9nLmUoJ0NhbiBub3QgZm91bmQgbm92ZWwgc2VjdGlvbiEnKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgJCgnI2xvYWRpbmcnKS5yZW1vdmUoKTsKICAgICAgICB1bC5zaG93KCk7CiAgICB9CgogICAgZnVuY3Rpb24gdXBkYXRlUHJvZ3Jlc3MobXNnKSB7CiAgICAgICAgbGV0IHAgPSAkKCcjcHJvZ3Jlc3MnKTsKICAgICAgICBwLnRleHQobXNnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRCb29rbWFyayhlbGVtZW50LCBub3ZlbElkLCByZXN0cmljdCkgewogICAgICAgIGlmIChnX2NzcmZUb2tlbiA9PSAnJykgewogICAgICAgICAgICBpTG9nLmUoJ05vIGdfY3NyZlRva2VuLCBmYWlsZWQgdG8gYWRkIGJvb2ttYXJrIScpOwogICAgICAgICAgICBhbGVydCgn6I635Y+WIFRva2VuIOWksei0pe+8jOaXoOazlea3u+WKoO+8jOivt+WIsOivpuaDhemhteaTjeS9nOOAgicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGVsZW1lbnQuYXR0cignZGlzYWJsZScsICdkaXNhYmxlJyk7CiAgICAgICAgaUxvZy5pKCdhZGQgYm9va21hcms6ICcgKyBub3ZlbElkKTsKICAgICAgICAkLmFqYXgoJy9hamF4L25vdmVscy9ib29rbWFya3MvYWRkJywgewogICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgnLAogICAgICAgICAgICBoZWFkZXJzOiB7ICd4LWNzcmYtdG9rZW4nOiBnX2NzcmZUb2tlbiB9LAogICAgICAgICAgICBkYXRhOiAneyJub3ZlbF9pZCI6IicgKyBub3ZlbElkICsgJyIsInJlc3RyaWN0IjonICsgcmVzdHJpY3QgKyAnLCJjb21tZW50IjoiIiwidGFncyI6W119JywKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIGlMb2cuZCgnYWRkIG5vdmVsIGJvb2ttYXJrIHJlc3VsdDogJyk7CiAgICAgICAgICAgICAgICBpTG9nLmQoZGF0YSk7CiAgICAgICAgICAgICAgICBpZiAoZGF0YS5lcnJvcikgewogICAgICAgICAgICAgICAgICAgIGlMb2cuZSgnU2VydmVyIHJldHVybmVkIGFuIGVycm9yOiAnICsgZGF0YS5tZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsZXQgYm9va21hcmtJZCA9IGRhdGEuYm9keTsKICAgICAgICAgICAgICAgIGlMb2cuaSgnQWRkIG5vdmVsIGJvb2ttYXJrIHN1Y2Nlc3MsIGJvb2ttYXJrSWQgaXMgJyArIGJvb2ttYXJrSWQpOwogICAgICAgICAgICAgICAgZWxlbWVudC5hdHRyKCdib29rbWFyay1pZCcsIGJvb2ttYXJrSWQpOwogICAgICAgICAgICAgICAgZWxlbWVudC5maW5kKCdwYXRoOmZpcnN0JykuY3NzKCdjb2xvcicsICdyZ2IoMjU1LCA2NCwgOTYpJyk7CiAgICAgICAgICAgICAgICBlbGVtZW50LmZpbmQoJ3BhdGg6bGFzdCcpLmNzcygnZmlsbCcsICdyZ2IoMjU1LCA2NCwgOTYpJyk7CiAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHIoJ2Rpc2FibGUnKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cignZGlzYWJsZScpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gZGVsZXRlQm9va21hcmsoZWxlbWVudCwgYm9va21hcmtJZCkgewogICAgICAgIGlmIChnX2NzcmZUb2tlbiA9PSAnJykgewogICAgICAgICAgICBpTG9nLmUoJ05vIGdfY3NyZlRva2VuLCBmYWlsZWQgdG8gYWRkIGJvb2ttYXJrIScpOwogICAgICAgICAgICBhbGVydCgn6I635Y+WIFRva2VuIOWksei0pe+8jOaXoOazlea3u+WKoO+8jOivt+WIsOivpuaDhemhteaTjeS9nOOAgicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGVsZW1lbnQuYXR0cignZGlzYWJsZScsICdkaXNhYmxlJyk7CiAgICAgICAgaUxvZy5pKCdkZWxldGUgYm9va21hcms6ICcgKyBib29rbWFya0lkKTsKICAgICAgICAkLmFqYXgoJy9hamF4L25vdmVscy9ib29rbWFya3MvZGVsZXRlJywgewogICAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgICAgaGVhZGVyczogeyAneC1jc3JmLXRva2VuJzogZ19jc3JmVG9rZW4gfSwKICAgICAgICAgICAgZGF0YTogeyAnZGVsJzogMSwgJ2Jvb2tfaWQnOiBib29rbWFya0lkIH0sCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICBpTG9nLmQoJ2RlbGV0ZSBub3ZlbCBib29rbWFyayByZXN1bHQ6ICcpOwogICAgICAgICAgICAgICAgaUxvZy5kKGRhdGEpOwogICAgICAgICAgICAgICAgaWYgKGRhdGEuZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICBpTG9nLmUoJ1NlcnZlciByZXR1cm5lZCBhbiBlcnJvcjogJyArIGRhdGEubWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaUxvZy5pKCdkZWxldGUgbm92ZWwgYm9va21hcmsgc3VjY2VzcycpOwogICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyKCdib29rbWFyay1pZCcpOwogICAgICAgICAgICAgICAgZWxlbWVudC5maW5kKCdwYXRoOmZpcnN0JykuY3NzKCdjb2xvcicsICdyZ2IoMzEsIDMxLCAzMSknKTsKICAgICAgICAgICAgICAgIGVsZW1lbnQuZmluZCgncGF0aDpsYXN0JykuY3NzKCdmaWxsJywgJ3JnYigyNTUsIDI1NSwgMjU1KScpOwogICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyKCdkaXNhYmxlJyk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHIoJ2Rpc2FibGUnKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZVBhZ2VTZWxlY3RvcigpIHsKICAgICAgICBsZXQgcGFnZXIgPSBQYWdlc1tQYWdlVHlwZS5Ob3ZlbFNlYXJjaF0uR2V0UGFnZVNlbGVjdG9yKCk7CiAgICAgICAgaWYgKHBhZ2VyLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgIGlMb2cuZSgnY2FuIG5vdCBmb3VuZCBwYWdlIHNlbGVjdG9yIScpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxldCBsZWZ0ID0gcGFnZXIuZmluZCgnYTpmaXJzdCcpLmNsb25lKCkuYXR0cignYXJpYS1kaXNhYmxlZCcsICdmYWxzZScpLnJlbW92ZUF0dHIoJ2hpZGRlbicpLmFkZENsYXNzKCdwcC1wcmV2UGFnZScpOwogICAgICAgIGxldCByaWdodCA9IHBhZ2VyLmZpbmQoJ2E6bGFzdCcpLmNsb25lKCkuYXR0cignYXJpYS1kaXNhYmxlZCcsICdmYWxzZScpLnJlbW92ZUF0dHIoJ2hpZGRlbicpLmFkZENsYXNzKCdwcC1uZXh0UGFnZScpOwogICAgICAgIGxldCBub3JtYWwgPSBwYWdlci5maW5kKCdhJykuZXEoMSkuY2xvbmUoKS5yZW1vdmVBdHRyKCdocmVmJyk7CiAgICAgICAgbGV0IGhyZWYgPSBsb2NhdGlvbi5ocmVmOwogICAgICAgIGxldCBtYXRjaCA9IGhyZWYubWF0Y2goL1s/Jl1wPShcZCspLyk7CiAgICAgICAgbGV0IHBhZ2UgPSAxOwogICAgICAgIGlmIChtYXRjaCkgewogICAgICAgICAgICBwYWdlID0gcGFyc2VJbnQobWF0Y2hbMV0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChsb2NhdGlvbi5zZWFyY2ggPT0gJycpIHsKICAgICAgICAgICAgICAgIGhyZWYgKz0gJz9wPTEnOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaHJlZiArPSAnJnA9MSc7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHBhZ2UgPT0gMSkgewogICAgICAgICAgICBsZWZ0LmF0dHIoJ2hpZGRlbicsICdoaWRkZW4nKTsKICAgICAgICB9CiAgICAgICAgcGFnZXIuZW1wdHkoKTsKICAgICAgICBsZXQgbHAgPSBwYWdlIC0gZ19zZXR0aW5ncy5ub3ZlbFBhZ2VDb3VudDsKICAgICAgICBsZWZ0LmF0dHIoJ2hyZWYnLCBocmVmLnJlcGxhY2UoJz9wPScgKyBwYWdlLCAnP3A9JyArIGxwKS5yZXBsYWNlKCcmcD0nICsgcGFnZSwgJyZwPScgKyBscCkpOwogICAgICAgIHBhZ2VyLmFwcGVuZChsZWZ0KTsKICAgICAgICBsZXQgcyA9ICdQcmV2aWV3ZXInOwogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcy5sZW5ndGg7ICsraSkgewogICAgICAgICAgICBsZXQgbiA9IG5vcm1hbC5jbG9uZSgpLnRleHQoc1tpXSk7CiAgICAgICAgICAgIHBhZ2VyLmFwcGVuZChuKTsKICAgICAgICB9CiAgICAgICAgbGV0IHJwID0gcGFnZSArIGdfc2V0dGluZ3Mubm92ZWxQYWdlQ291bnQ7CiAgICAgICAgcmlnaHQuYXR0cignaHJlZicsIGhyZWYucmVwbGFjZSgnP3A9JyArIHBhZ2UsICc/cD0nICsgcnApLnJlcGxhY2UoJyZwPScgKyBwYWdlLCAnJnA9JyArIHJwKSk7CiAgICAgICAgcGFnZXIuYXBwZW5kKHJpZ2h0KTsKICAgIH0KCiAgICBmdW5jdGlvbiBsaXN0bmVyVG9LZXlCb2FyZCgpIHsKICAgICAgICAkKGRvY3VtZW50KS5rZXlkb3duKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlmIChnX3NldHRpbmdzLnBhZ2VCeUtleSAhPSAxKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAzOSkgewogICAgICAgICAgICAgICAgbGV0IGJ0biA9ICQoJy5wcC1uZXh0UGFnZScpOwogICAgICAgICAgICAgICAgaWYgKGJ0bi5sZW5ndGggPCAxIHx8IGJ0bi5hdHRyKCdoaWRkZW4nKSA9PSAnaGlkZGVuJykgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBidG4uYXR0cignaHJlZicpOwogICAgICAgICAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PSAzNykgewogICAgICAgICAgICAgICAgbGV0IGJ0biA9ICQoJy5wcC1wcmV2UGFnZScpOwogICAgICAgICAgICAgICAgaWYgKGJ0bi5sZW5ndGggPCAxIHx8IGJ0bi5hdHRyKCdoaWRkZW4nKSA9PSAnaGlkZGVuJykgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBidG4uYXR0cignaHJlZicpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgZnVuY3Rpb24gbWFpbigpIHsKICAgICAgICBsZXQga2V5V29yZCA9IGdldEtleVdvcmQoKTsKICAgICAgICBpZiAoa2V5V29yZC5sZW5ndGggPT0gMCkgewogICAgICAgICAgICBpTG9nLmUoJ1BhcnNlIGtleSB3b3JkIGVycm9yLicpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxldCBjdXJyZW50UGFnZSA9IGdldEN1cnJlbnRQYWdlKCk7CgogICAgICAgIGlmICgkKCcuZ3RtLW5vdmVsLXNlYXJjaHBhZ2UtZ3MtdG9nZ2xlLWJ1dHRvbicpLmF0dHIoJ2RhdGEtZ3RtLWxhYmVsJykgPT0gJ29mZicpIHsKICAgICAgICAgICAgc2hvd0xvYWRpbmcoKTsKICAgICAgICAgICAgJCgnLmd0bS1ub3ZlbC1zZWFyY2hwYWdlLWdzLXRvZ2dsZS1idXR0b24nKS5wYXJlbnQoKS5uZXh0KCkudGV4dCgpOwogICAgICAgICAgICAvLyDkuI3luLjop4HvvIzkuI3opoHlpJror63oqIDkuoYKICAgICAgICAgICAgJCgnI2xvYWRpbmcnKS5maW5kKCcjcHJvZ3Jlc3MnKS50ZXh0KCfnlLHkuo7lkK/nlKjkuoYgIicgKyAkKCcuZ3RtLW5vdmVsLXNlYXJjaHBhZ2UtZ3MtdG9nZ2xlLWJ1dHRvbicpLnBhcmVudCgpLm5leHQoKS50ZXh0KCkgKyAnIu+8jOaXoOazlei/m+ihjOaOkuW6j+OAgicpOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGhpZGVMb2FkaW5nKCksIDMwMDApOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBzaG93TG9hZGluZygpOwogICAgICAgIGNoYW5nZVBhZ2VTZWxlY3RvcigpOwogICAgICAgIGxpc3RuZXJUb0tleUJvYXJkKCk7CiAgICAgICAgZ2V0Tm92ZWxCeVBhZ2Uoa2V5V29yZCwgY3VycmVudFBhZ2UsIGN1cnJlbnRQYWdlICsgZ19zZXR0aW5ncy5ub3ZlbFBhZ2VDb3VudCkudGhlbihmdW5jdGlvbiAobm92ZWxMaXN0KSB7CiAgICAgICAgICAgIHJlYXJyYW5nZU5vdmVsKHNvcnROb3ZlbChub3ZlbExpc3QpKTsKICAgICAgICB9KTsKICAgIH0KCiAgICBtYWluKCk7Cn0KLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSDorr7nva4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwpmdW5jdGlvbiBTZXRMb2NhbFN0b3JhZ2UobmFtZSwgdmFsdWUpIHsKICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKG5hbWUsIEpTT04uc3RyaW5naWZ5KHZhbHVlKSk7Cn0KZnVuY3Rpb24gR2V0TG9jYWxTdG9yYWdlKG5hbWUpIHsKICAgIGNvbnN0IHZhbHVlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0obmFtZSk7CiAgICBpZiAoIXZhbHVlKSByZXR1cm4gbnVsbDsKICAgIHJldHVybiB2YWx1ZTsKfQpmdW5jdGlvbiBTaG93SW5zdGFsbE1lc3NhZ2UoKSB7CiAgICAkKCcjcHAtYmcnKS5yZW1vdmUoKTsKICAgIGxldCBiZyA9ICQoJzxkaXYgaWQ9InBwLWJnIj48L2Rpdj4nKS5jc3MoewogICAgICAgICd3aWR0aCc6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCArICdweCcsICdoZWlnaHQnOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0ICsgJ3B4JywgJ3Bvc2l0aW9uJzogJ2ZpeGVkJywKICAgICAgICAnei1pbmRleCc6IDk5OTk5OSwgJ2JhY2tncm91bmQtY29sb3InOiAncmdiYSgwLDAsMCwwLjgpJywKICAgICAgICAnbGVmdCc6ICcwcHgnLCAndG9wJzogJzBweCcKICAgIH0pOwogICAgJCgnYm9keScpLmFwcGVuZChiZyk7CgogICAgYmcuZ2V0KDApLmlubmVySFRNTCA9ICc8aW1nIGlkPSJwcHMtY2xvc2Uic3JjPSJodHRwczovL3BwLTEyNTIwODkxNzIuY29zLmFwLWNoZW5nZHUubXlxY2xvdWQuY29tL0Nsb3NlLnBuZyJzdHlsZT0icG9zaXRpb246IGFic29sdXRlOyByaWdodDogMzVweDsgdG9wOiAyMHB4OyB3aWR0aDogMzJweDsgaGVpZ2h0OiAzMnB4OyBjdXJzb3I6IHBvaW50ZXI7Ij48ZGl2IHN0eWxlPSJwb3NpdGlvbjogYWJzb2x1dGU7d2lkdGg6IDQwJTtsZWZ0OiAzMCU7dG9wOiAyNSU7Zm9udC1zaXplOiAyNXB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IGNvbG9yOiB3aGl0ZTsiPicgKyBUZXh0c1tnX2xhbmd1YWdlXS5pbnN0YWxsX3RpdGxlICsgJzwvZGl2Pjxicj4nICsgVGV4dHNbZ19sYW5ndWFnZV0uaW5zdGFsbF9ib2R5OwogICAgJCgnI3Bwcy1jbG9zZScpLmNsaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAkKCcjcHAtYmcnKS5yZW1vdmUoKTsKICAgIH0pOwp9CmZ1bmN0aW9uIFNob3dVcGdyYWRlTWVzc2FnZSgpIHsKICAgICQoJyNwcC1iZycpLnJlbW92ZSgpOwogICAgbGV0IGJnID0gJCgnPGRpdiBpZD0icHAtYmciPjwvZGl2PicpLmNzcyh7CiAgICAgICAgJ3dpZHRoJzogZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoICsgJ3B4JywgJ2hlaWdodCc6IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQgKyAncHgnLCAncG9zaXRpb24nOiAnZml4ZWQnLAogICAgICAgICd6LWluZGV4JzogOTk5OTk5LCAnYmFja2dyb3VuZC1jb2xvcic6ICdyZ2JhKDAsMCwwLDAuOCknLAogICAgICAgICdsZWZ0JzogJzBweCcsICd0b3AnOiAnMHB4JwogICAgfSk7CiAgICAkKCdib2R5JykuYXBwZW5kKGJnKTsKCiAgICBsZXQgYm9keSA9IFRleHRzW2dfbGFuZ3VhZ2VdLnVwZ3JhZGVfYm9keTsKICAgIGJnLmdldCgwKS5pbm5lckhUTUwgPSAnPGltZyBpZD0icHBzLWNsb3NlInNyYz0iaHR0cHM6Ly9wcC0xMjUyMDg5MTcyLmNvcy5hcC1jaGVuZ2R1Lm15cWNsb3VkLmNvbS9DbG9zZS5wbmcic3R5bGU9InBvc2l0aW9uOiBhYnNvbHV0ZTsgcmlnaHQ6IDM1cHg7IHRvcDogMjBweDsgd2lkdGg6IDMycHg7IGhlaWdodDogMzJweDsgY3Vyc29yOiBwb2ludGVyOyI+PGRpdiBzdHlsZT0icG9zaXRpb246IGFic29sdXRlO3dpZHRoOiA0MCU7bGVmdDogMzAlO3RvcDogMjUlO2ZvbnQtc2l6ZTogMjVweDsgdGV4dC1hbGlnbjogY2VudGVyOyBjb2xvcjogd2hpdGU7Ij4nCiAgICAgICAgKyBUZXh0c1tnX2xhbmd1YWdlXS5pbnN0YWxsX3RpdGxlCiAgICAgICAgKyAnPC9kaXY+PGJyPjxkaXYgc3R5bGU9InBvc2l0aW9uOmFic29sdXRlO2xlZnQ6NTAlO3RvcDozMCU7Zm9udC1zaXplOjIwcHg7Y29sb3I6d2hpdGU7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtNTAlLDApO2hlaWdodDo1MCU7b3ZlcmZsb3c6YXV0bzsiPicKICAgICAgICArIGJvZHkgKyAnPC9kaXY+JzsKICAgICQoJyNwcHMtY2xvc2UnKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgJCgnI3BwLWJnJykucmVtb3ZlKCk7CiAgICB9KTsKfQpmdW5jdGlvbiBDb252ZXJ0U2V0dGluZ3NGcm9tR01DKCkgewogICAgbGV0IGhpZGVCeVRhZ0xpc3QgPSBHTUMuZ2V0KCdoaWRlQnlUYWdMaXN0Jyk7CiAgICBpZiAoaGlkZUJ5VGFnTGlzdCAhPSBudWxsICYmIGhpZGVCeVRhZ0xpc3QgIT0gJycpIHsKICAgICAgICBsZXQgaGlkZUJ5VGFnUmVnZXggPSBoaWRlQnlUYWdMaXN0LnJlcGxhY2UoLyx877yML2csICd8Jyk7CiAgICAgICAgR01DLnNldCgnaGlkZUJ5VGFnUmVnZXgnLCBoaWRlQnlUYWdSZWdleCk7CiAgICAgICAgR01DLnNldCgnaGlkZUJ5VGFnTGlzdCcsICcnKTsKICAgICAgICBHTUMuc2F2ZSgpOwogICAgfQoKICAgIGxldCBzZXR0aW5ncyA9IHsKICAgICAgICAnZW5hYmxlUHJldmlldyc6IEdNQy5nZXQoJ2VuYWJsZVByZXZpZXcnKSwKICAgICAgICAnZW5hYmxlQW5pbWVQcmV2aWV3JzogR01DLmdldCgnZW5hYmxlQW5pbWVQcmV2aWV3JyksCiAgICAgICAgJ2VuYWJsZVNvcnQnOiBHTUMuZ2V0KCdlbmFibGVTb3J0JyksCiAgICAgICAgJ2VuYWJsZUFuaW1lRG93bmxvYWQnOiBHTUMuZ2V0KCdlbmFibGVBbmltZURvd25sb2FkJyksCiAgICAgICAgJ29yaWdpbmFsJzogR01DLmdldCgnb3JpZ2luYWwnKSwKICAgICAgICAncHJldmlld0RlbGF5JzogcGFyc2VJbnQoR01DLmdldCgncHJldmlld0RlbGF5JykpIHx8IDIwMCwKICAgICAgICAncHJldmlld0J5S2V5JzogR01DLmdldCgncHJldmlld0J5S2V5JyksCiAgICAgICAgJ3BhZ2VDb3VudCc6IHBhcnNlSW50KEdNQy5nZXQoJ3BhZ2VDb3VudCcpKSB8fCAzLAogICAgICAgICdmYXZGaWx0ZXInOiBwYXJzZUludChHTUMuZ2V0KCdmYXZGaWx0ZXInKSkgfHwgMCwKICAgICAgICAnYWlGaWx0ZXInOiBHTUMuZ2V0KCdhaUZpbHRlcicpLAogICAgICAgICdhaU9ubHknOiBHTUMuZ2V0KCdhaU9ubHknKSwKICAgICAgICAnaGlkZUZhdm9yaXRlJzogR01DLmdldCgnaGlkZUZhdm9yaXRlJyksCiAgICAgICAgJ2hpZGVGb2xsb3dlZCc6IEdNQy5nZXQoJ2hpZGVGb2xsb3dlZCcpLAogICAgICAgICdoaWRlQnlUYWcnOiBHTUMuZ2V0KCdoaWRlQnlUYWcnKSwKICAgICAgICAnaGlkZUJ5VGFnUmVnZXgnOiBHTUMuZ2V0KCdoaWRlQnlUYWdSZWdleCcpLAogICAgICAgICdoaWRlQnlVc2VyJzogR01DLmdldCgnaGlkZUJ5VXNlcicpLAogICAgICAgICdoaWRlQnlVc2VyTGlzdCc6IEdNQy5nZXQoJ2hpZGVCeVVzZXJMaXN0JyksCiAgICAgICAgJ2hpZGVDb3VudExlc3NUaGFuJzogcGFyc2VJbnQoR01DLmdldCgnaGlkZUNvdW50TGVzc1RoYW4nKSkgfHwgMCwKICAgICAgICAnaGlkZUNvdW50TW9yZVRoYW4nOiBwYXJzZUludChHTUMuZ2V0KCdoaWRlQ291bnRNb3JlVGhhbicpKSB8fCAwLAogICAgICAgICdsaW5rQmxhbmsnOiBHTUMuZ2V0KCdsaW5rQmxhbmsnKSwKICAgICAgICAncGFnZUJ5S2V5JzogR01DLmdldCgncGFnZUJ5S2V5JyksCiAgICAgICAgJ2Z1bGxTaXplVGh1bWInOiBHTUMuZ2V0KCdmdWxsU2l6ZVRodW1iJyksCiAgICAgICAgJ2VuYWJsZU5vdmVsU29ydCc6IEdNQy5nZXQoJ2VuYWJsZU5vdmVsU29ydCcpLAogICAgICAgICdub3ZlbFBhZ2VDb3VudCc6IHBhcnNlSW50KEdNQy5nZXQoJ25vdmVsUGFnZUNvdW50JykpIHx8IDMsCiAgICAgICAgJ25vdmVsRmF2RmlsdGVyJzogcGFyc2VJbnQoR01DLmdldCgnbm92ZWxGYXZGaWx0ZXInKSkgfHwgMCwKICAgICAgICAnbm92ZWxIaWRlRmF2b3JpdGUnOiBHTUMuZ2V0KCdub3ZlbEhpZGVGYXZvcml0ZScpLAogICAgICAgICdwcmV2aWV3RnVsbFNjcmVlbic6IEdNQy5nZXQoJ3ByZXZpZXdGdWxsU2NyZWVuJyksCiAgICAgICAgJ3ByZXZpZXdLZXknOiAxNywKICAgICAgICAnc2Nyb2xsTG9ja1doZW5QcmV2aWV3JzogR01DLmdldCgnc2Nyb2xsTG9ja1doZW5QcmV2aWV3JyksCiAgICB9OwogICAgcmV0dXJuIHNldHRpbmdzOwp9CmZ1bmN0aW9uIE1pZ3JhdGVGcm9tT2xkU2V0dGluZygpIHsKICAgIGxldCBvbGRTZXR0aW5ncyA9IEdldExvY2FsU3RvcmFnZSgnUGl4aXZQcmV2aWV3Jyk7CiAgICBpZiAob2xkU2V0dGluZ3MgJiYgb2xkU2V0dGluZ3MgIT0gJ251bGwnKSB7CiAgICAgICAgbGV0IHNldHRpbmdzID0gSlNPTi5wYXJzZShvbGRTZXR0aW5ncyk7CiAgICAgICAgaWYgKHNldHRpbmdzKSB7CiAgICAgICAgICAgIC8vIOi/geenu+iuvue9rgogICAgICAgICAgICBHTUMuc2V0KCdlbmFibGVQcmV2aWV3Jywgc2V0dGluZ3MuZW5hYmxlUHJldmlldyk7CiAgICAgICAgICAgIEdNQy5zZXQoJ2VuYWJsZUFuaW1lUHJldmlldycsIHNldHRpbmdzLmVuYWJsZUFuaW1lUHJldmlldyk7CiAgICAgICAgICAgIEdNQy5zZXQoJ2VuYWJsZVNvcnQnLCBzZXR0aW5ncy5lbmFibGVTb3J0KTsKICAgICAgICAgICAgR01DLnNldCgnZW5hYmxlQW5pbWVEb3dubG9hZCcsIHNldHRpbmdzLmVuYWJsZUFuaW1lRG93bmxvYWQpOwogICAgICAgICAgICBHTUMuc2V0KCdvcmlnaW5hbCcsIHNldHRpbmdzLm9yaWdpbmFsKTsKICAgICAgICAgICAgR01DLnNldCgncHJldmlld0RlbGF5Jywgc2V0dGluZ3MucHJldmlld0RlbGF5KTsKICAgICAgICAgICAgR01DLnNldCgncHJldmlld0J5S2V5Jywgc2V0dGluZ3MucHJldmlld0J5S2V5KTsKICAgICAgICAgICAgR01DLnNldCgncGFnZUNvdW50Jywgc2V0dGluZ3MucGFnZUNvdW50KTsKICAgICAgICAgICAgR01DLnNldCgnZmF2RmlsdGVyJywgc2V0dGluZ3MuZmF2RmlsdGVyKTsKICAgICAgICAgICAgR01DLnNldCgnYWlGaWx0ZXInLCBzZXR0aW5ncy5haUZpbHRlcik7CiAgICAgICAgICAgIEdNQy5zZXQoJ2FpT25seScsIHNldHRpbmdzLmFpT25seSk7CiAgICAgICAgICAgIEdNQy5zZXQoJ2hpZGVGYXZvcml0ZScsIHNldHRpbmdzLmhpZGVGYXZvcml0ZSk7CiAgICAgICAgICAgIEdNQy5zZXQoJ2hpZGVGb2xsb3dlZCcsIHNldHRpbmdzLmhpZGVGb2xsb3dlZCk7CiAgICAgICAgICAgIEdNQy5zZXQoJ2hpZGVCeVRhZycsIHNldHRpbmdzLmhpZGVCeVRhZyk7CiAgICAgICAgICAgIEdNQy5zZXQoJ2hpZGVCeVRhZ1JlZ2V4Jywgc2V0dGluZ3MuaGlkZUJ5VGFnUmVnZXgpOwogICAgICAgICAgICBHTUMuc2V0KCdsaW5rQmxhbmsnLCBzZXR0aW5ncy5saW5rQmxhbmspOwogICAgICAgICAgICBHTUMuc2V0KCdwYWdlQnlLZXknLCBzZXR0aW5ncy5wYWdlQnlLZXkpOwogICAgICAgICAgICBHTUMuc2V0KCdmdWxsU2l6ZVRodW1iJywgc2V0dGluZ3MuZnVsbFNpemVUaHVtYik7CiAgICAgICAgICAgIEdNQy5zZXQoJ2VuYWJsZU5vdmVsU29ydCcsIHNldHRpbmdzLmVuYWJsZU5vdmVsU29ydCk7CiAgICAgICAgICAgIEdNQy5zZXQoJ25vdmVsUGFnZUNvdW50Jywgc2V0dGluZ3Mubm92ZWxQYWdlQ291bnQpOwogICAgICAgICAgICBHTUMuc2V0KCdub3ZlbEZhdkZpbHRlcicsIHNldHRpbmdzLm5vdmVsRmF2RmlsdGVyKTsKICAgICAgICAgICAgR01DLnNldCgnbm92ZWxIaWRlRmF2b3JpdGUnLCBzZXR0aW5ncy5ub3ZlbEhpZGVGYXZvcml0ZSk7CiAgICAgICAgICAgIGxldCBsYW5nU3RyaW5nID0gJ1BpeGl2UHJldmlld0xhbmcnOwogICAgICAgICAgICBTZXRMb2NhbFN0b3JhZ2UobGFuZ1N0cmluZywgcGFyc2VJbnQoc2V0dGluZ3MubGFuZykpOwogICAgICAgICAgICBTZXRMb2NhbFN0b3JhZ2UoJ1BpeGl2UHJldmlldycsIG51bGwpOwogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICB9CiAgICByZXR1cm4gZmFsc2U7Cn0KZnVuY3Rpb24gR2V0U2V0dGluZ3MoKSB7CiAgICBsZXQgdXBncmFkZWQgPSBNaWdyYXRlRnJvbU9sZFNldHRpbmcoKTsKCiAgICBsZXQgdmVyc2lvblN0cmluZyA9ICdQaXhpdlByZXZpZXdWZXJzaW9uJzsKICAgIGxldCBvbGRWZXJzaW9uRGF0YSA9IEdldExvY2FsU3RvcmFnZSh2ZXJzaW9uU3RyaW5nKTsKICAgIGxldCBvbGRWZXJzaW9uID0gbnVsbDsKICAgIGlmIChvbGRWZXJzaW9uRGF0YSkgewogICAgICAgIG9sZFZlcnNpb24gPSBKU09OLnBhcnNlKG9sZFZlcnNpb25EYXRhKTsKICAgIH0KCiAgICBpZiAodXBncmFkZWQpIHsKICAgICAgICBTZXRMb2NhbFN0b3JhZ2UodmVyc2lvblN0cmluZywgZ192ZXJzaW9uKTsKICAgICAgICBTaG93VXBncmFkZU1lc3NhZ2UoKTsKICAgIH0gZWxzZSBpZiAob2xkVmVyc2lvbiA9PSBudWxsKSB7CiAgICAgICAgLy8g5paw5a6J6KOFCiAgICAgICAgU2V0TG9jYWxTdG9yYWdlKHZlcnNpb25TdHJpbmcsIGdfdmVyc2lvbik7CiAgICAgICAgU2hvd0luc3RhbGxNZXNzYWdlKCk7CiAgICB9IGVsc2UgaWYgKG9sZFZlcnNpb24gIT0gZ192ZXJzaW9uKSB7CiAgICAgICAgLy8g5Y2H57qnCiAgICAgICAgU2V0TG9jYWxTdG9yYWdlKHZlcnNpb25TdHJpbmcsIGdfdmVyc2lvbik7CiAgICAgICAgU2hvd1VwZ3JhZGVNZXNzYWdlKCk7CiAgICB9CgogICAgcmV0dXJuIENvbnZlcnRTZXR0aW5nc0Zyb21HTUMoKTsKfQpmdW5jdGlvbiBVcGRhdGVMb2dMZXZlbCgpIHsKICAgIGxldCBsZXZlbCA9IEdNQy5nZXQoJ2xvZ0xldmVsJyk7CiAgICBpZiAobGV2ZWwgPT0gJ2Vycm9yJykgewogICAgICAgIGlMb2cuc2V0TG9nTGV2ZWwoaUxvZy5Mb2dMZXZlbC5FcnJvcik7CiAgICB9IGVsc2UgaWYgKGxldmVsID09ICd3YXJuaW5nJykgewogICAgICAgIGlMb2cuc2V0TG9nTGV2ZWwoaUxvZy5Mb2dMZXZlbC5XYXJuaW5nKTsKICAgIH0gZWxzZSBpZiAobGV2ZWwgPT0gJ2luZm8nKSB7CiAgICAgICAgaUxvZy5zZXRMb2dMZXZlbChpTG9nLkxvZ0xldmVsLkluZm8pOwogICAgfSBlbHNlIGlmIChsZXZlbCA9PSAnZGVidWcnKSB7CiAgICAgICAgaUxvZy5zZXRMb2dMZXZlbChpTG9nLkxvZ0xldmVsLlZlcmJvc2UpOwogICAgfQp9CmZ1bmN0aW9uIFNob3dTZXR0aW5nKCkgewogICAgR01DLm9wZW4oKTsKfQpmdW5jdGlvbiBTZXRUYXJnZXRCbGFuayhyZXR1cm5NYXApIHsKICAgIGlmIChnX3NldHRpbmdzLmxpbmtCbGFuaykgewogICAgICAgIGxldCB0YXJnZXQgPSBbXTsKICAgICAgICAkLmVhY2gocmV0dXJuTWFwLmNvbnRyb2xFbGVtZW50cywgZnVuY3Rpb24gKGksIGUpIHsKICAgICAgICAgICAgaWYgKGUudGFnTmFtZSA9PSAnQScpIHsKICAgICAgICAgICAgICAgIHRhcmdldC5wdXNoKGUpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgICQuZWFjaCgkKHJldHVybk1hcC5jb250cm9sRWxlbWVudHMpLmZpbmQoJ2EnKSwgZnVuY3Rpb24gKGksIGUpIHsKICAgICAgICAgICAgdGFyZ2V0LnB1c2goZSk7CiAgICAgICAgfSk7CgogICAgICAgIGxldCB0ZW1wVGFyZ2V0ID0gW107CiAgICAgICAgJC5lYWNoKHRhcmdldCwgKGksIGUpID0+IHsKICAgICAgICAgICAgbGV0IHBvbCA9ICQoZSkuZmluZCgncG9seWxpbmUnKTsKICAgICAgICAgICAgaWYgKHBvbC5sZW5ndGggPiAwICYmIHBvbC5nZXQoMCkuY2xhc3NOYW1lLmJhc2VWYWwuaW5kZXhPZignV2VkZ2VJY29uX2Fycm93JykgIT0gLTEpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRlbXBUYXJnZXQucHVzaChlKTsKICAgICAgICB9KTsKCiAgICAgICAgJC5lYWNoKHRlbXBUYXJnZXQsIGZ1bmN0aW9uIChpLCBlKSB7CiAgICAgICAgICAgICQoZSkuYXR0cih7ICd0YXJnZXQnOiAnX2JsYW5rJywgJ3JlbCc6ICdleHRlcm5hbCcgfSk7CiAgICAgICAgICAgIC8vIGpz55uR5ZCs6Lez6L2s77yM54m55q6K5aSE55CGCiAgICAgICAgICAgIGlmIChnX3BhZ2VUeXBlID09IFBhZ2VUeXBlLkhvbWUgfHwgZ19wYWdlVHlwZSA9PSBQYWdlVHlwZS5NZW1iZXIgfHwgZ19wYWdlVHlwZSA9PSBQYWdlVHlwZS5BcnR3b3JrIHx8IGdfcGFnZVR5cGUgPT0gUGFnZVR5cGUuQm9va01hcmtOZXcpIHsKICAgICAgICAgICAgICAgIGUuYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBmdW5jdGlvbiAoZXYpIHsKICAgICAgICAgICAgICAgICAgICBldi5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KfQovKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0g5Li75Ye95pWwIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwpsZXQgbG9hZEludGVydmFsID0gbnVsbDsKbGV0IGl0diA9IG51bGw7CmZ1bmN0aW9uIE1pZ3JhdGlvbkxhbmd1YWdlKCkgewogICAgbGV0IG9sZFNldHRpbmdzID0gR2V0TG9jYWxTdG9yYWdlKCdQaXhpdlByZXZpZXcnKTsKICAgIGlmIChvbGRTZXR0aW5ncyAmJiBvbGRTZXR0aW5ncyAhPSAnbnVsbCcpIHsKICAgICAgICBsZXQgc2V0dGluZ3MgPSBKU09OLnBhcnNlKG9sZFNldHRpbmdzKTsKICAgICAgICBpZiAoc2V0dGluZ3MpIHsKICAgICAgICAgICAgcmV0dXJuIHBhcnNlSW50KHNldHRpbmdzLmxhbmcpOwogICAgICAgIH0KICAgIH0KCiAgICBsZXQgbGFuZ1N0cmluZyA9ICdQaXhpdlByZXZpZXdMYW5nJzsKICAgIGxldCBsYW5nRGF0YSA9IEdldExvY2FsU3RvcmFnZShsYW5nU3RyaW5nKTsKICAgIGlmIChsYW5nRGF0YSA9PSBudWxsIHx8IGxhbmdEYXRhID09ICdudWxsJykgewogICAgICAgIHJldHVybiBMYW5nLmF1dG87CiAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBwYXJzZUludChsYW5nRGF0YSk7CiAgICB9Cn0KZnVuY3Rpb24gQXV0b0RldGVjdExhbmd1YWdlKCkgewogICAgZ19sYW5ndWFnZSA9IE1pZ3JhdGlvbkxhbmd1YWdlKCk7CiAgICBpZiAoZ19sYW5ndWFnZSA9PSBMYW5nLmF1dG8pIHsKICAgICAgICBsZXQgbGFuZyA9ICQoJ2h0bWwnKS5hdHRyKCdsYW5nJyk7CiAgICAgICAgaWYgKGxhbmcgJiYgbGFuZy5pbmRleE9mKCd6aCcpICE9IC0xKSB7CiAgICAgICAgICAgIC8vIOeugOS9k+S4reaWh+WSjOe5geS9k+S4reaWh+mDveeUqOeugOS9k+S4reaWhwogICAgICAgICAgICBnX2xhbmd1YWdlID0gTGFuZy56aF9DTjsKICAgICAgICB9IGVsc2UgaWYgKGxhbmcgJiYgbGFuZy5pbmRleE9mKCdqYScpICE9IC0xKSB7CiAgICAgICAgICAgIGdfbGFuZ3VhZ2UgPSBMYW5nLmphX0pQOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIOWFtuS7lueahOe7n+S4gOeUqOiLseivre+8jOWFtuS7luivreiogOS5n+S4jeefpemBk+iwt+atjOe/u+ivkeW+l+WvueS4jeWvuQogICAgICAgICAgICBnX2xhbmd1YWdlID0gTGFuZy5lbl9VUzsKICAgICAgICB9CiAgICB9Cn0KZnVuY3Rpb24gTG9hZCgpIHsKICAgIC8vIOWMuemFjeW9k+WJjemhtemdogogICAgZm9yIChsZXQgaSA9IDA7IGkgPCBQYWdlVHlwZS5QYWdlVHlwZUNvdW50OyBpKyspIHsKICAgICAgICBpZiAoUGFnZXNbaV0uQ2hlY2tVcmwobG9jYXRpb24uaHJlZikpIHsKICAgICAgICAgICAgZ19wYWdlVHlwZSA9IGk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KICAgIGlmIChnX3BhZ2VUeXBlID49IDApIHsKICAgICAgICBpTG9nLmkoJ0N1cnJlbnQgcGFnZSBpcyAnICsgUGFnZXNbZ19wYWdlVHlwZV0uUGFnZVR5cGVTdHJpbmcpOwogICAgfSBlbHNlIHsKICAgICAgICBpTG9nLncoJ1Vuc3VwcG9ydGVkIHBhZ2UuJyk7CiAgICAgICAgY2xlYXJJbnRlcnZhbChsb2FkSW50ZXJ2YWwpOwogICAgICAgIHJldHVybjsKICAgIH0KCiAgICAvLyDorr7nva7mjInpkq4KICAgIGxldCB0b29sQmFyID0gUGFnZXNbZ19wYWdlVHlwZV0uR2V0VG9vbEJhcigpOwogICAgaWYgKHRvb2xCYXIpIHsKICAgICAgICBpTG9nLmQodG9vbEJhcik7CiAgICAgICAgY2xlYXJJbnRlcnZhbChsb2FkSW50ZXJ2YWwpOwogICAgfSBlbHNlIHsKICAgICAgICBpTG9nLncoJ0dldCB0b29sYmFyIGZhaWxlZC4nKTsKICAgICAgICByZXR1cm47CiAgICB9CgogICAgd2luZG93Lm9ucmVzaXplID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmICgkKCcjcHAtYmcnKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGxldCBzY3JlZW5XaWR0aCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDsKICAgICAgICAgICAgbGV0IHNjcmVlbkhlaWdodCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7CiAgICAgICAgICAgICQoJyNwcC1iZycpLmNzcyh7ICd3aWR0aCc6IHNjcmVlbldpZHRoICsgJ3B4JywgJ2hlaWdodCc6IHNjcmVlbkhlaWdodCArICdweCcgfSk7CiAgICAgICAgfQogICAgfTsKCiAgICAvLyDor7vlj5borr7nva4KICAgIGdfbWF4WGhyID0gcGFyc2VJbnQoR01DLmdldCgnbWF4WGhyJykpOwogICAgZ19zZXR0aW5ncyA9IEdldFNldHRpbmdzKCk7CgogICAgaWYgKCQoJyNwcC1zb3J0JykubGVuZ3RoID09PSAwICYmICEoZ19zZXR0aW5ncz8uZW5hYmxlU29ydCkpIHsKICAgICAgICBjb25zdCBuZXdMaXN0SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGNvbnN0IG5ld0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgIG5ld0J1dHRvbi5pZCA9ICdwcC1zb3J0JzsKICAgICAgICBuZXdCdXR0b24uc3R5bGUuY3NzVGV4dCA9ICdiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMCwgMCwgMCk7IG1hcmdpbi10b3A6IDVweDsgb3BhY2l0eTogMC44OyBjdXJzb3I6IHBvaW50ZXI7IGJvcmRlcjogbm9uZTsgcGFkZGluZzogMHB4OyBib3JkZXItcmFkaXVzOiAyNHB4OyB3aWR0aDogNDhweDsgaGVpZ2h0OiA0OHB4Oyc7CiAgICAgICAgbmV3QnV0dG9uLmlubmVySFRNTCA9IGA8c3BhbiBzdHlsZT0iY29sb3I6IHdoaXRlO3ZlcnRpY2FsLWFsaWduOiB0ZXh0LXRvcDsiPiR7VGV4dHNbZ19sYW5ndWFnZV0udGV4dF9zb3J0fTwvc3Bhbj5gOwogICAgICAgIG5ld0xpc3RJdGVtLmFwcGVuZENoaWxkKG5ld0J1dHRvbik7CiAgICAgICAgdG9vbEJhci5hcHBlbmRDaGlsZChuZXdMaXN0SXRlbSk7CgogICAgICAgICQobmV3QnV0dG9uKS5jbGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHRoaXMuZGlzYWJsZWQgPSB0cnVlOwogICAgICAgICAgICBydW5QaXhpdlByZXZpZXcodHJ1ZSk7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICB9LCA3MDAwKTsKICAgICAgICB9KTsKICAgIH0KCiAgICAvLyBBIGZpeGVkIG5leHQgcGFnZSBidXR0b24gbmV4dCB0byB0aGUgc2V0dGluZyBidXR0b24KICAgIGlmICgkKCcjcHAtbmV4dFBhZ2UtZml4ZWQnKS5sZW5ndGggPT09IDApIHsKICAgICAgICBjb25zdCBuZXdMaXN0SXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIG5ld0xpc3RJdGVtLmlubmVySFRNTCA9ICcnOwogICAgICAgIGNvbnN0IG5ld0J1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgICAgIG5ld0J1dHRvbi5pZCA9ICdwcC1uZXh0UGFnZS1maXhlZCc7CiAgICAgICAgbmV3QnV0dG9uLnN0eWxlLmNzc1RleHQgPSAnYmFja2dyb3VuZC1jb2xvcjogcmdiKDAsIDAsIDApOyBtYXJnaW4tdG9wOiA1cHg7IG9wYWNpdHk6IDAuODsgY3Vyc29yOiBwb2ludGVyOyBib3JkZXI6IG5vbmU7IHBhZGRpbmc6IDEycHg7IGJvcmRlci1yYWRpdXM6IDI0cHg7IHdpZHRoOiA0OHB4OyBoZWlnaHQ6IDQ4cHg7JzsKICAgICAgICBuZXdCdXR0b24uaW5uZXJIVE1MID0gJzxzdmcgdmlld0JveD0iMCAwIDEyMCAxMjAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgc3Ryb2tlPSJ3aGl0ZSIgZmlsbD0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHlsZT0idHJhbnNmb3JtOiByb3RhdGUoOTBkZWcpOyI+IDxwb2x5bGluZSBwb2ludHM9IjYwLDEwNSA2MCw4Ij48L3BvbHlsaW5lPiA8cG9seWxpbmUgcG9pbnRzPSIxMCw1NyA2MCw4IDExMCw1NyI+PC9wb2x5bGluZT4gPC9zdmc+JzsKICAgICAgICBuZXdMaXN0SXRlbS5hcHBlbmRDaGlsZChuZXdCdXR0b24pOwogICAgICAgIHRvb2xCYXIuYXBwZW5kQ2hpbGQobmV3TGlzdEl0ZW0pOwoKICAgICAgICAkKG5ld0J1dHRvbikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICBsZXQgbmV4dFBhZ2VIcmVmID0gbnVsbDsKCiAgICAgICAgICAgIC8vIFRyeSB0byByZXVzZSAucHAtbmV4dFBhZ2UsIG90aGVyd2lzZSBmYWxsYmFjayB0byBQaXhpdiBuYXRpdmUgcGFnaW5hdG9yJ3MgbGFzdCBsaW5rICg+KQogICAgICAgICAgICBsZXQgbmV4dFBhZ2VBbmNob3IgPSAkKCcucHAtbmV4dFBhZ2UnKTsKICAgICAgICAgICAgaWYgKG5leHRQYWdlQW5jaG9yLmxlbmd0aCA+IDAgJiYgbmV4dFBhZ2VBbmNob3IuYXR0cignaGlkZGVuJykgIT09ICdoaWRkZW4nKSB7CiAgICAgICAgICAgICAgICBuZXh0UGFnZUhyZWYgPSBuZXh0UGFnZUFuY2hvci5hdHRyKCdocmVmJyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBuZXh0UGFnZUhyZWYgPSBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgibmF2IildLmZpbmQobmF2ID0+IFsuLi5uYXYuY2hpbGRyZW5dLmZpbHRlcihlbCA9PiBlbC50YWdOYW1lID09PSAiQSIpLmV2ZXJ5KGVsID0+IC9cP3A9XGQrJC8udGVzdChlbC5ocmVmKSkpPy5sYXN0RWxlbWVudENoaWxkPy5ocmVmID8/IG51bGw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIE9wZW4gdGhlIG5leHQgcGFnZSBpZiBhdmFpbGFibGUKICAgICAgICAgICAgaWYgKG5leHRQYWdlSHJlZiAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gbmV4dFBhZ2VIcmVmOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgaWYgKCQoJyNwcC1zZXR0aW5ncycpLmxlbmd0aCA9PT0gMCkgewogICAgICAgIGNvbnN0IG5ld0xpc3RJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgY29uc3QgbmV3QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgbmV3QnV0dG9uLmlkID0gJ3BwLXNldHRpbmdzJzsKICAgICAgICBuZXdCdXR0b24uc3R5bGUuY3NzVGV4dCA9ICdiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMCwgMCwgMCk7IG1hcmdpbi10b3A6IDVweDsgb3BhY2l0eTogMC44OyBjdXJzb3I6IHBvaW50ZXI7IGJvcmRlcjogbm9uZTsgcGFkZGluZzogMTJweDsgYm9yZGVyLXJhZGl1czogMjRweDsgd2lkdGg6IDQ4cHg7IGhlaWdodDogNDhweDsnOwogICAgICAgIG5ld0J1dHRvbi5pbm5lckhUTUwgPSAnPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwMCAxMDAwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxMDAwIDEwMDAiIHhtbDpzcGFjZT0icHJlc2VydmUiIHN0eWxlPSJmaWxsOiB3aGl0ZTsiPjxtZXRhZGF0YT4gU3ZnIFZlY3RvciBJY29ucyA6IGh0dHA6Ly93d3cuc2ZvbnQuY24gPC9tZXRhZGF0YT48Zz48cGF0aCBkPSJNMzc3LjUsNTAwYzAsNjcuNyw1NC44LDEyMi41LDEyMi41LDEyMi41UzYyMi41LDU2Ny43LDYyMi41LDUwMFM1NjcuNywzNzcuNSw1MDAsMzc3LjVTMzc3LjUsNDMyLjMsMzc3LjUsNTAweiI+PC9wYXRoPjxwYXRoIGQ9Ik05OTAsNTQ2di05NC44TDg1Ni4yLDQxMWMtOC45LTM1LjgtMjMtNjkuNC00MS42LTEwMC4yTDg3OSwxODZMODEyLDExOUw2ODksMTg1LjJjLTMwLjgtMTguNS02NC40LTMyLjYtMTAwLjItNDEuNUw1NDUuOSwxMGgtOTQuOEw0MTEsMTQzLjhjLTM1LjgsOC45LTY5LjUsMjMtMTAwLjIsNDEuNUwxODYuMSwxMjFsLTY3LDY2LjlMMTg1LjIsMzExYy0xOC42LDMwLjgtMzIuNiw2NC40LTQxLjUsMTAwLjNMMTAsNDU0djk0LjhMMTQzLjgsNTg5YzguOSwzNS44LDIzLDY5LjQsNDEuNiwxMDAuMkwxMjEsODE0bDY3LDY3bDEyMy02Ni4yYzMwLjgsMTguNiw2NC41LDMyLjYsMTAwLjMsNDEuNUw0NTQsOTkwaDk0LjhMNTg5LDg1Ni4yYzM1LjgtOC45LDY5LjQtMjMsMTAwLjItNDEuNkw4MTQsODc5bDY3LTY3bC02Ni4yLTEyMy4xYzE4LjYtMzAuNywzMi42LTY0LjQsNDEuNS0xMDAuMkw5OTAsNTQ2eiBNNTAwLDc0NWMtMTM1LjMsMC0yNDUtMTA5LjctMjQ1LTI0NWMwLTEzNS4zLDEwOS43LTI0NSwyNDUtMjQ1czI0NSwxMDkuNywyNDUsMjQ1Qzc0NSw2MzUuMyw2MzUuMyw3NDUsNTAwLDc0NXoiPjwvcGF0aD48L2c+PC9zdmc+JzsKICAgICAgICBuZXdMaXN0SXRlbS5hcHBlbmRDaGlsZChuZXdCdXR0b24pOwogICAgICAgIHRvb2xCYXIuYXBwZW5kQ2hpbGQobmV3TGlzdEl0ZW0pOwoKICAgICAgICAkKG5ld0J1dHRvbikuY2xpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgICBTaG93U2V0dGluZygpOwogICAgICAgIH0pOwogICAgfQoKICAgIC8vIGdfY3NyZlRva2VuCiAgICBpZiAoZ19wYWdlVHlwZSA9PSBQYWdlVHlwZS5TZWFyY2ggfHwgZ19wYWdlVHlwZSA9PSBQYWdlVHlwZS5Ob3ZlbFNlYXJjaCkgewogICAgICAgICQuZ2V0KGxvY2F0aW9uLmhyZWYsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgIGxldCBtYXRjaGVkID0gZGF0YS5tYXRjaCgvdG9rZW5cXCI6XFwiKFthLXowLTldezMyfSkvKTsKICAgICAgICAgICAgaWYgKG1hdGNoZWQgIT0gbnVsbCAmJiBtYXRjaGVkLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgIGdfY3NyZlRva2VuID0gbWF0Y2hlZFsxXTsKICAgICAgICAgICAgICAgIGlMb2cuZCgnR290IGdfY3NyZlRva2VuOiAnICsgZ19jc3JmVG9rZW4pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgaUxvZy5lKCdDYW4gbm90IGdldCBnX2NzcmZUb2tlbiwgc28geW91IGNhbiBub3QgYWRkIHdvcmtzIHRvIGJvb2ttYXJrIHdoZW4gc29ydGluZyBoYXMgZW5hYmxlZC4nKTsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQoKICAgIC8vIOaOkuW6j+OAgemihOiniAogICAgaXR2ID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgIGxldCByZXR1cm5NYXAgPSBQYWdlc1tnX3BhZ2VUeXBlXS5Qcm9jZXNzUGFnZUVsZW1lbnRzKCk7CiAgICAgICAgaWYgKCFyZXR1cm5NYXAubG9hZGluZ0NvbXBsZXRlKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlMb2cuZCgnUHJvY2VzcyBwYWdlIGNvbWxldGUsIHNvcnRpbmcgYW5kIHByZXZld2luZyBiZWdpbi4nKTsKICAgICAgICBpTG9nLmQocmV0dXJuTWFwKTsKCiAgICAgICAgY2xlYXJJbnRlcnZhbChpdHYpOwoKICAgICAgICBTZXRUYXJnZXRCbGFuayhyZXR1cm5NYXApOwogICAgICAgIHJ1blBpeGl2UHJldmlldygpOwogICAgfSwgNTAwKTsKICAgIGZ1bmN0aW9uIHJ1blBpeGl2UHJldmlldyhldmVudEZyb21CdXR0b24gPSBmYWxzZSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChnX3BhZ2VUeXBlID09IFBhZ2VUeXBlLkFydHdvcmspIHsKICAgICAgICAgICAgICAgIFBhZ2VzW2dfcGFnZVR5cGVdLldvcmsoKTsKICAgICAgICAgICAgICAgIGlmIChnX3NldHRpbmdzLmVuYWJsZVByZXZpZXcpIHsKICAgICAgICAgICAgICAgICAgICBQaXhpdlByZXZpZXcoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmIChnX3BhZ2VUeXBlID09IFBhZ2VUeXBlLlNlYXJjaCkgewogICAgICAgICAgICAgICAgaWYgKGdfc2V0dGluZ3MuZW5hYmxlU29ydCB8fCBldmVudEZyb21CdXR0b24pIHsKICAgICAgICAgICAgICAgICAgICBnX3NvcnRDb21wbGV0ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIFBpeGl2U0soZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBnX3NvcnRDb21wbGV0ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnX3NldHRpbmdzLmVuYWJsZVByZXZpZXcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBpeGl2UHJldmlldygpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGdfc2V0dGluZ3MuZW5hYmxlUHJldmlldykgewogICAgICAgICAgICAgICAgICAgIFBpeGl2UHJldmlldygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgaWYgKGdfcGFnZVR5cGUgPT0gUGFnZVR5cGUuTm92ZWxTZWFyY2gpIHsKICAgICAgICAgICAgICAgIGlmIChnX3NldHRpbmdzLmVuYWJsZU5vdmVsU29ydCB8fCBldmVudEZyb21CdXR0b24pIHsKICAgICAgICAgICAgICAgICAgICBQaXhpdk5TKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ19zZXR0aW5ncy5lbmFibGVQcmV2aWV3KSB7CiAgICAgICAgICAgICAgICBQaXhpdlByZXZpZXcoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkgewogICAgICAgICAgICBpTG9nLmUoJ1Vua25vd24gZXJyb3I6ICcgKyBlKTsKICAgICAgICB9CiAgICB9Cn0KZnVuY3Rpb24gU3RhcnRMb2FkKCkgewogICAgbG9hZEludGVydmFsID0gc2V0SW50ZXJ2YWwoTG9hZCwgMTAwMCk7CiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKGxvY2F0aW9uLmhyZWYgIT0gaW5pdGlhbFVybCkgewogICAgICAgICAgICAvLyDmjpLluo/kuK3ngrnlh7vmkJzntKJ0YWfvvIzlj6/og73lr7zoh7Tov5vooYzkuK3nmoTmjpLluo/lh7rnjrDmt7fkubHvvIzliqDlj5bmtojlpKrpurvng6bvvIznm7TmjqXotbDliLfmlrAKICAgICAgICAgICAgaWYgKCFnX3NvcnRDb21wbGV0ZSkgewogICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IGxvY2F0aW9uLmhyZWY7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gZml4IOS4u+mhtemihOiniOWbvuWHuueOsOWQjueCueWHu+WbvueJh++8jOi/m+WIsOivpuaDhemhte+8jOmihOiniOWbvuS4jea2iOWkseeahOmXrumimAogICAgICAgICAgICBpZiAoJCgnLnBwLW1haW4nKS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICAkKCcucHAtbWFpbicpLnJlbW92ZSgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGluaXRpYWxVcmwgPSBsb2NhdGlvbi5ocmVmOwogICAgICAgICAgICBjbGVhckludGVydmFsKGxvYWRJbnRlcnZhbCk7CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaXR2KTsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChhdXRvTG9hZEludGVydmFsKTsKICAgICAgICAgICAgYXV0b0xvYWRJbnRlcnZhbCA9IG51bGw7CiAgICAgICAgICAgIGdfcGFnZVR5cGUgPSAtMTsKICAgICAgICAgICAgbG9hZEludGVydmFsID0gc2V0SW50ZXJ2YWwoTG9hZCwgMzAwKTsKICAgICAgICB9CiAgICB9LCAxMDAwKTsKfQpmdW5jdGlvbiBMb2FkSlEoKSB7CiAgICBjaGVja0pRdWVyeSgpLnRoZW4oZnVuY3Rpb24gKGlzTG9hZCkgewogICAgICAgIGlmIChpc0xvYWQpIHsKICAgICAgICAgICAgQXV0b0RldGVjdExhbmd1YWdlKCk7CiAgICAgICAgICAgIGdtY0luaXQoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXRUaW1lb3V0KExvYWRKUSwgMTAwMCk7CiAgICAgICAgfQogICAgfSk7Cn0KTG9hZEpRKCk7Cg==","requires":[{"meta":{"name":"gh_2215_make_GM_xhr_more_parallel_again.js","url":"https://update.greasyfork.org/scripts/515994/1478507/gh_2215_make_GM_xhr_more_parallel_again.js","ts":1770962063662,"mimetype":"text/javascript"},"source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIGdoXzIyMTVfbWFrZV9HTV94aHJfbW9yZV9wYXJhbGxlbF9hZ2FpbgovLyBAbmFtZXNwYWNlICAgaHR0cHM6Ly9naXRodWIuY29tL1RhbXBlcm1vbmtleS90YW1wZXJtb25rZXkvaXNzdWVzLzIyMTUKLy8gQHZlcnNpb24gICAgIDEuMAovLyBAZGVzY3JpcHRpb24gR28gdG8gaHR0cHM6Ly9naXRodWIuY29tL1RhbXBlcm1vbmtleS90YW1wZXJtb25rZXkvaXNzdWVzLzIyMTUgZm9yIG1vcmUuCi8vIEBhdXRob3IgICAgICBUYW1wZXJtb25rZXkKLy8gPT0vVXNlclNjcmlwdD09CgovKgogKiBodHRwczovL2dpdGh1Yi5jb20vVGFtcGVybW9ua2V5L3RhbXBlcm1vbmtleS9pc3N1ZXMvMjIxNQogKgogKiBUaGlzIHNjcmlwdCBwcm92aWRlcyBhIHdvcmthcm91bmQgZm9yIGEgQ2hyb21lIE1WMyBpc3N1ZSAoaHR0cHM6Ly9naXRodWIuY29tL3czYy93ZWJleHRlbnNpb25zL2lzc3Vlcy82OTQpCiAqIHdoZXJlIGV4dGVuc2lvbnMgY2FuJ3Qgc2V0L2RlbGV0ZSBoZWFkZXJzIHRoYXQgYXJlIHByZXNlcnZlZCBvdmVyIHJlZGlyZWN0cy4KICoKICogQnkgc2V0dGluZyBgcmVkaXJlY3Q6ICdtYW51YWwnYCBhbmQgZm9sbG93aW5nIHJlZGlyZWN0cyBtYW51YWxseSwgdGhpcyBzY3JpcHQgZW5zdXJlcyByZXF1ZXN0IHJlZGlyZWN0cyB3b3JrCiAqIGFzIGludGVuZGVkIGFuZCByZXF1ZXN0cyB0byBkaWZmZXJlbnQgVVJMcyBhcmUgbWFkZSBpbiBwYXJhbGxlbCAoYWdhaW4pLgogKgogKiBVc2Vyc2NyaXB0IGF1dGhvcnMgc2hvdWxkIGluY2x1ZGUgdGhpcyBhcyBhIGBAcmVxdWlyZWAgd2hlbiB0aGV5IG5lZWQgdG8gbWFrZSBwYXJhbGxlbCByZXF1ZXN0cyB3aXRoIEdNX3htbGh0dHBSZXF1ZXN0LAogKiBlc3BlY2lhbGx5IGlmIHJlcXVlc3RzIG1pZ2h0IHRha2UgYSBsb25nIHRpbWUgdG8gY29tcGxldGUuCiAqCiAqIEluY2x1ZGluZyB0aGlzIHNjcmlwdCB3aWxsIG1vZGlmeSB0aGUgYmVoYXZpb3Igb2YgR01feG1saHR0cFJlcXVlc3QgYW5kIEdNLnhtbEh0dHBSZXF1ZXN0IGluIFRhbXBlcm1vbmtleSBvbmx5LgogKgogKiBVc2FnZToKICoKICogQWRkIHRoaXMgdG8gdGhlIG1ldGFkYXRhIGJsb2NrIG9mIHlvdXIgdXNlcnNjcmlwdDoKICoKICogLy8gQGdyYW50ICAgICBHTV94bWxodHRwUmVxdWVzdAogKiAvLyBAcmVxdWlyZSAgIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9UYW1wZXJtb25rZXkvdXRpbHMvcmVmcy9oZWFkcy9tYWluL3JlcXVpcmVzL2doXzIyMTVfbWFrZV9HTV94aHJfbW9yZV9wYXJhbGxlbF9hZ2Fpbi5qcwogKgoqKi8KCi8qIGdsb2JhbCBHTV9pbmZvLCBHTV94bWxodHRwUmVxdWVzdCwgR00gKi8KCmNvbnN0IEhBU19HTSA9IHR5cGVvZiBHTSAhPT0gJ3VuZGVmaW5lZCc7CmNvbnN0IE5FV19HTSA9ICgoc2NvcGUsIEdNKSA9PiB7CiAgICAvLyBDaGVjayBpZiBydW5uaW5nIGluIFRhbXBlcm1vbmtleSBhbmQgaWYgdmVyc2lvbiBzdXBwb3J0cyByZWRpcmVjdCBjb250cm9sCiAgICBpZiAoR01faW5mby5zY3JpcHRIYW5kbGVyICE9PSAiVGFtcGVybW9ua2V5IiB8fCBjb21wYXJlVmVyc2lvbnMoR01faW5mby52ZXJzaW9uLCAiNS4zLjIiKSA8IDApIHJldHVybjsKCiAgICAvLyBCYWNrdXAgb3JpZ2luYWwgZnVuY3Rpb25zCiAgICBjb25zdCBHTV94bWxodHRwUmVxdWVzdE9yaWcgPSBHTV94bWxodHRwUmVxdWVzdDsKICAgIGNvbnN0IEdNX3htbEh0dHBSZXF1ZXN0T3JpZyA9IEdNLnhtbEh0dHBSZXF1ZXN0OwoKICAgIGZ1bmN0aW9uIGNvbXBhcmVWZXJzaW9ucyh2MSwgdjIpIHsKICAgICAgICBjb25zdCBwYXJ0czEgPSB2MS5zcGxpdCgnLicpLm1hcChOdW1iZXIpOwogICAgICAgIGNvbnN0IHBhcnRzMiA9IHYyLnNwbGl0KCcuJykubWFwKE51bWJlcik7CiAgICAgICAgY29uc3QgbGVuZ3RoID0gTWF0aC5tYXgocGFydHMxLmxlbmd0aCwgcGFydHMyLmxlbmd0aCk7CgogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgY29uc3QgbnVtMSA9IHBhcnRzMVtpXSB8fCAwOwogICAgICAgICAgICBjb25zdCBudW0yID0gcGFydHMyW2ldIHx8IDA7CgogICAgICAgICAgICBpZiAobnVtMSA+IG51bTIpIHJldHVybiAxOwogICAgICAgICAgICBpZiAobnVtMSA8IG51bTIpIHJldHVybiAtMTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgLy8gV3JhcHBlciBmb3IgR01feG1saHR0cFJlcXVlc3QKICAgIGZ1bmN0aW9uIEdNX3htbGh0dHBSZXF1ZXN0V3JhcHBlcihvZGV0YWlscykgewogICAgICAgIC8vIElmIHJlZGlyZWN0IGlzIG1hbnVhbGx5IHNldCwgc2ltcGx5IHBhc3Mgb2RldGFpbHMgdG8gdGhlIG9yaWdpbmFsIGZ1bmN0aW9uCiAgICAgICAgaWYgKG9kZXRhaWxzLnJlZGlyZWN0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgcmV0dXJuIEdNX3htbGh0dHBSZXF1ZXN0T3JpZyhvZGV0YWlscyk7CiAgICAgICAgfQoKICAgICAgICAvLyBXYXJuIGlmIG9ucHJvZ3Jlc3MgaXMgdXNlZCB3aXRoIHNldHRpbmdzIGluY29tcGF0aWJsZSB3aXRoIGZldGNoIG1vZGUgdXNlZCBpbiBiYWNrZ3JvdW5kCiAgICAgICAgaWYgKG9kZXRhaWxzLm9ucHJvZ3Jlc3MgfHwgb2RldGFpbHMuZmV0Y2ggPT09IGZhbHNlKSB7CiAgICAgICAgICAgIGNvbnNvbGUud2FybigiRmV0Y2ggbW9kZSBkb2VzIG5vdCBzdXBwb3J0IG9ucHJvZ3Jlc3MgaW4gdGhlIGJhY2tncm91bmQuIik7CiAgICAgICAgfQoKICAgICAgICBjb25zdCB7CiAgICAgICAgICAgIG9ubG9hZCwKICAgICAgICAgICAgb25sb2FkZW5kLAogICAgICAgICAgICBvbmVycm9yLAogICAgICAgICAgICBvbmFib3J0LAogICAgICAgICAgICBvbnRpbWVvdXQsCiAgICAgICAgICAgIC4uLmRldGFpbHMKICAgICAgICB9ID0gb2RldGFpbHM7CgogICAgICAgIC8vIFNldCByZWRpcmVjdCB0byBtYW51YWwgYW5kIGhhbmRsZSByZWRpcmVjdHMKICAgICAgICBjb25zdCBoYW5kbGVSZWRpcmVjdHMgPSAoaW5pdGlhbERldGFpbHMpID0+IHsKICAgICAgICAgICAgY29uc3QgcmVxdWVzdCA9IEdNX3htbGh0dHBSZXF1ZXN0T3JpZyh7CiAgICAgICAgICAgICAgICAuLi5pbml0aWFsRGV0YWlscywKICAgICAgICAgICAgICAgIHJlZGlyZWN0OiAnbWFudWFsJywKICAgICAgICAgICAgICAgIG9ubG9hZDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID49IDMwMCAmJiByZXNwb25zZS5zdGF0dXMgPCA0MDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbSA9IHJlc3BvbnNlLnJlc3BvbnNlSGVhZGVycy5tYXRjaCgvTG9jYXRpb246XHMqKFxTKykvaSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvbGxvdyByZWRpcmVjdCBtYW51YWxseQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWRpcmVjdFVybCA9IG0gJiYgbVsxXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlZGlyZWN0VXJsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhYnNvbHV0ZVVybCA9IG5ldyBVUkwocmVkaXJlY3RVcmwsIGluaXRpYWxEZXRhaWxzLnVybCkuaHJlZjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZVJlZGlyZWN0cyh7IC4uLmluaXRpYWxEZXRhaWxzLCB1cmw6IGFic29sdXRlVXJsIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAob25sb2FkKSBvbmxvYWQuY2FsbCh0aGlzLCByZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9ubG9hZGVuZCkgb25sb2FkZW5kLmNhbGwodGhpcywgcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9uZXJyb3I6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9uZXJyb3IpIG9uZXJyb3IuY2FsbCh0aGlzLCByZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9ubG9hZGVuZCkgb25sb2FkZW5kLmNhbGwodGhpcywgcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9uYWJvcnQ6IGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9uYWJvcnQpIG9uYWJvcnQuY2FsbCh0aGlzLCByZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9ubG9hZGVuZCkgb25sb2FkZW5kLmNhbGwodGhpcywgcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIG9udGltZW91dDogZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICBpZiAob250aW1lb3V0KSBvbnRpbWVvdXQuY2FsbCh0aGlzLCByZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKG9ubG9hZGVuZCkgb25sb2FkZW5kLmNhbGwodGhpcywgcmVzcG9uc2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3Q7CiAgICAgICAgfTsKCiAgICAgICAgcmV0dXJuIGhhbmRsZVJlZGlyZWN0cyhkZXRhaWxzKTsKICAgIH0KCiAgICAvLyBXcmFwcGVyIGZvciBHTS54bWxIdHRwUmVxdWVzdAogICAgZnVuY3Rpb24gR01feG1sSHR0cFJlcXVlc3RXcmFwcGVyKG9kZXRhaWxzKSB7CiAgICAgICAgbGV0IGFib3J0OwoKICAgICAgICBjb25zdCBwID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgICBjb25zdCB7IG9ubG9hZCwgb250aW1lb3V0LCBvbmVycm9yLCAuLi5zZW5kIH0gPSBvZGV0YWlsczsKCiAgICAgICAgICAgIHNlbmQub25lcnJvciA9IGZ1bmN0aW9uKHIpIHsKICAgICAgICAgICAgICAgIGlmIChvbmVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyKTsKICAgICAgICAgICAgICAgICAgICBvbmVycm9yLmNhbGwodGhpcywgcik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJlamVjdChyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgc2VuZC5vbnRpbWVvdXQgPSBmdW5jdGlvbihyKSB7CiAgICAgICAgICAgICAgICBpZiAob250aW1lb3V0KSB7CiAgICAgICAgICAgICAgICAgICAgLy8gU2VlIGNvbW1lbnQgYWJvdmUKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHIpOwogICAgICAgICAgICAgICAgICAgIG9udGltZW91dC5jYWxsKHRoaXMsIHIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICByZWplY3Qocik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHNlbmQub25sb2FkID0gZnVuY3Rpb24ocikgewogICAgICAgICAgICAgICAgcmVzb2x2ZShyKTsKICAgICAgICAgICAgICAgIGlmIChvbmxvYWQpIG9ubG9hZC5jYWxsKHRoaXMsIHIpOwogICAgICAgICAgICB9OwoKICAgICAgICAgICAgY29uc3QgYSA9IEdNX3htbGh0dHBSZXF1ZXN0V3JhcHBlcihzZW5kKS5hYm9ydDsKICAgICAgICAgICAgaWYgKGFib3J0ID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgICBhKCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhYm9ydCA9IGE7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgcC5hYm9ydCA9ICAoKSA9PiB7CiAgICAgICAgICAgIGlmICh0eXBlb2YgYWJvcnQgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICAgICAgICAgIGFib3J0KCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhYm9ydCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICByZXR1cm4gcDsKICAgIH0KCiAgICAvLyBFeHBvcnQgd3JhcHBlcnMKICAgIEdNX3htbGh0dHBSZXF1ZXN0ID0gR01feG1saHR0cFJlcXVlc3RXcmFwcGVyOwogICAgc2NvcGUuR01feG1saHR0cFJlcXVlc3RPcmlnID0gR01feG1saHR0cFJlcXVlc3RPcmlnOwoKICAgIGNvbnN0IGdvcGQgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEdNLCAneG1sSHR0cFJlcXVlc3QnKTsKICAgIGlmIChnb3BkICYmIGdvcGQuY29uZmlndXJhYmxlID09PSBmYWxzZSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIF9fcHJvdG9fXzogR00sCiAgICAgICAgICAgIHhtbEh0dHBSZXF1ZXN0OiBHTV94bWxIdHRwUmVxdWVzdFdyYXBwZXIsCiAgICAgICAgICAgIHhtbEh0dHBSZXF1ZXN0T3JpZzogR01feG1sSHR0cFJlcXVlc3RPcmlnCiAgICAgICAgfTsKICAgIH0gZWxzZSB7CiAgICAgICAgR00ueG1sSHR0cFJlcXVlc3QgPSBHTV94bWxIdHRwUmVxdWVzdFdyYXBwZXI7CiAgICAgICAgR00ueG1sSHR0cFJlcXVlc3RPcmlnID0gR01feG1sSHR0cFJlcXVlc3RPcmlnOwogICAgfQp9KSh0aGlzLCBIQVNfR00gPyBHTSA6IHt9KTsKCmlmIChIQVNfR00gJiYgTkVXX0dNKSBHTSA9IE5FV19HTTs="},{"meta":{"name":"GM_config.js","url":"https://openuserjs.org/src/libs/sizzle/GM_config.js","ts":1770962070162,"mimetype":"text/javascript"},"source":"LyoNCkNvcHlyaWdodCAyMDA5KywgR01fY29uZmlnIENvbnRyaWJ1dG9ycyAoaHR0cHM6Ly9naXRodWIuY29tL3NpenpsZW1jdHdpenpsZS9HTV9jb25maWcpDQoNCkdNX2NvbmZpZyBDb2xsYWJvcmF0b3JzL0NvbnRyaWJ1dG9yczoNCiAgICBNaWtlIE1lZGxleSA8bWVkbGV5bWluZEBnbWFpbC5jb20+DQogICAgSm9lIFNpbW1vbnMNCiAgICBJenp5IFNvZnQNCiAgICBNYXJ0aSBNYXJ0eg0KICAgIEFkYW0gVGhvbXBzb24tU2hhcnBlDQoNCkdNX2NvbmZpZyBpcyBkaXN0cmlidXRlZCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZS4NCg0KICAgIEdNX2NvbmZpZyBpcyBmcmVlIHNvZnR3YXJlOiB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5DQogICAgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5DQogICAgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgZWl0aGVyIHZlcnNpb24gMyBvZiB0aGUgTGljZW5zZSwgb3INCiAgICAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLg0KDQogICAgVGhpcyBwcm9ncmFtIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsDQogICAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2YNCiAgICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlDQogICAgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuDQoNCiAgICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UNCiAgICBhbG9uZyB3aXRoIHRoaXMgcHJvZ3JhbS4gIElmIG5vdCwgc2VlIDxodHRwczovL3d3dy5nbnUub3JnL2xpY2Vuc2VzLz4uDQoqLw0KDQovLyA9PVVzZXJTY3JpcHQ9PQ0KLy8gQGV4Y2x1ZGUgICAgICAgKg0KLy8gQGF1dGhvciAgICAgICAgTWlrZSBNZWRsZXkgPG1lZGxleW1pbmRAZ21haWwuY29tPiAoaHR0cHM6Ly9naXRodWIuY29tL3NpenpsZW1jdHdpenpsZS9HTV9jb25maWcpDQovLyBAaWNvbiAgICAgICAgICBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vc2l6emxlbWN0d2l6emxlL0dNX2NvbmZpZy9tYXN0ZXIvZ21fY29uZmlnX2ljb25fbGFyZ2UucG5nDQoNCi8vID09VXNlckxpYnJhcnk9PQ0KLy8gQG5hbWUgICAgICAgICAgR01fY29uZmlnDQovLyBAZGVzY3JpcHRpb24gICBBIGxpZ2h0d2VpZ2h0LCByZXVzYWJsZSwgY3Jvc3MtYnJvd3NlciBncmFwaGljYWwgc2V0dGluZ3MgZnJhbWV3b3JrIGZvciBpbmNsdXNpb24gaW4gdXNlciBzY3JpcHRzLg0KLy8gQGNvcHlyaWdodCAgICAgMjAwOSssIE1pa2UgTWVkbGV5IChodHRwczovL2dpdGh1Yi5jb20vc2l6emxlbWN0d2l6emxlKQ0KLy8gQGxpY2Vuc2UgICAgICAgTEdQTC0zLjAtb3ItbGF0ZXI7IGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zaXp6bGVtY3R3aXp6bGUvR01fY29uZmlnL21hc3Rlci9MSUNFTlNFDQoNCi8vIEBob21lcGFnZVVSTCAgIGh0dHBzOi8vb3BlbnVzZXJqcy5vcmcvbGlicy9zaXp6bGUvR01fY29uZmlnDQovLyBAaG9tZXBhZ2VVUkwgICBodHRwczovL2dpdGh1Yi5jb20vc2l6emxlbWN0d2l6emxlL0dNX2NvbmZpZw0KLy8gQHN1cHBvcnRVUkwgICAgaHR0cHM6Ly9naXRodWIuY29tL3NpenpsZW1jdHdpenpsZS9HTV9jb25maWcvaXNzdWVzDQoNCi8vID09L1VzZXJTY3JpcHQ9PQ0KDQovLyA9PS9Vc2VyTGlicmFyeT09DQoNCi8qIGpzaGludCBlc3ZlcnNpb246IDggKi8NCg0KbGV0IEdNX2NvbmZpZyA9IChmdW5jdGlvbiAoR00pIHsNCiAgLy8gVGhpcyBpcyB0aGUgaW5pdGlhbGl6ZXIgZnVuY3Rpb24NCiAgZnVuY3Rpb24gR01fY29uZmlnSW5pdChjb25maWcsIGFyZ3MpIHsNCiAgICAvLyBJbml0aWFsaXplIGluc3RhbmNlIHZhcmlhYmxlcw0KICAgIGlmICh0eXBlb2YgY29uZmlnLmZpZWxkcyA9PSAidW5kZWZpbmVkIikgew0KICAgICAgY29uZmlnLmZpZWxkcyA9IHt9Ow0KICAgICAgY29uZmlnLm9uSW5pdCA9IGNvbmZpZy5vbkluaXQgfHwgZnVuY3Rpb24oKSB7fTsNCiAgICAgIGNvbmZpZy5vbk9wZW4gPSBjb25maWcub25PcGVuIHx8IGZ1bmN0aW9uKCkge307DQogICAgICBjb25maWcub25TYXZlID0gY29uZmlnLm9uU2F2ZSB8fCBmdW5jdGlvbigpIHt9Ow0KICAgICAgY29uZmlnLm9uQ2xvc2UgPSBjb25maWcub25DbG9zZSB8fCBmdW5jdGlvbigpIHt9Ow0KICAgICAgY29uZmlnLm9uUmVzZXQgPSBjb25maWcub25SZXNldCB8fCBmdW5jdGlvbigpIHt9Ow0KICAgICAgY29uZmlnLmlzT3BlbiA9IGZhbHNlOw0KICAgICAgY29uZmlnLnRpdGxlID0gJ1VzZXIgU2NyaXB0IFNldHRpbmdzJzsNCiAgICAgIGNvbmZpZy5jc3MgPSB7DQogICAgICAgIGJhc2ljOiBbDQogICAgICAgICAgIiNHTV9jb25maWcgKiB7IGZvbnQtZmFtaWx5OiBhcmlhbCx0YWhvbWEsbXlyaWFkIHBybyxzYW5zLXNlcmlmOyB9IiwNCiAgICAgICAgICAiI0dNX2NvbmZpZyB7IGJhY2tncm91bmQ6ICNGRkY7IH0iLA0KICAgICAgICAgICIjR01fY29uZmlnIGlucHV0W3R5cGU9J3JhZGlvJ10geyBtYXJnaW4tcmlnaHQ6IDhweDsgfSIsDQogICAgICAgICAgIiNHTV9jb25maWcgLmluZGVudDQwIHsgbWFyZ2luLWxlZnQ6IDQwJTsgfSIsDQogICAgICAgICAgIiNHTV9jb25maWcgLmZpZWxkX2xhYmVsIHsgZm9udC1zaXplOiAxMnB4OyBmb250LXdlaWdodDogYm9sZDsgbWFyZ2luLXJpZ2h0OiA2cHg7IH0iLA0KICAgICAgICAgICIjR01fY29uZmlnIC5yYWRpb19sYWJlbCB7IGZvbnQtc2l6ZTogMTJweDsgfSIsDQogICAgICAgICAgIiNHTV9jb25maWcgLmJsb2NrIHsgZGlzcGxheTogYmxvY2s7IH0iLA0KICAgICAgICAgICIjR01fY29uZmlnIC5zYXZlY2xvc2VfYnV0dG9ucyB7IG1hcmdpbjogMTZweCAxMHB4IDEwcHg7IHBhZGRpbmc6IDJweCAxMnB4OyB9IiwNCiAgICAgICAgICAiI0dNX2NvbmZpZyAucmVzZXQsICNHTV9jb25maWcgLnJlc2V0IGEsIiArDQogICAgICAgICAgICAiICNHTV9jb25maWdfYnV0dG9uc19ob2xkZXIgeyBjb2xvcjogIzAwMDsgdGV4dC1hbGlnbjogcmlnaHQ7IH0iLA0KICAgICAgICAgICIjR01fY29uZmlnIC5jb25maWdfaGVhZGVyIHsgZm9udC1zaXplOiAyMHB0OyBtYXJnaW46IDA7IH0iLA0KICAgICAgICAgICIjR01fY29uZmlnIC5jb25maWdfZGVzYywgI0dNX2NvbmZpZyAuc2VjdGlvbl9kZXNjLCAjR01fY29uZmlnIC5yZXNldCB7IGZvbnQtc2l6ZTogOXB0OyB9IiwNCiAgICAgICAgICAiI0dNX2NvbmZpZyAuY2VudGVyIHsgdGV4dC1hbGlnbjogY2VudGVyOyB9IiwNCiAgICAgICAgICAiI0dNX2NvbmZpZyAuc2VjdGlvbl9oZWFkZXJfaG9sZGVyIHsgbWFyZ2luLXRvcDogOHB4OyB9IiwNCiAgICAgICAgICAiI0dNX2NvbmZpZyAuY29uZmlnX3ZhciB7IG1hcmdpbjogMCAwIDRweDsgfSIsDQogICAgICAgICAgIiNHTV9jb25maWcgLnNlY3Rpb25faGVhZGVyIHsgYmFja2dyb3VuZDogIzQxNDE0MTsgYm9yZGVyOiAxcHggc29saWQgIzAwMDsgY29sb3I6ICNGRkY7IiwNCiAgICAgICAgICAiIGZvbnQtc2l6ZTogMTNwdDsgbWFyZ2luOiAwOyB9IiwNCiAgICAgICAgICAiI0dNX2NvbmZpZyAuc2VjdGlvbl9kZXNjIHsgYmFja2dyb3VuZDogI0VGRUZFRjsgYm9yZGVyOiAxcHggc29saWQgI0NDQzsgY29sb3I6ICM1NzU3NTc7IiArDQogICAgICAgICAgICAiIGZvbnQtc2l6ZTogOXB0OyBtYXJnaW46IDAgMCA2cHg7IH0iDQogICAgICAgICAgXS5qb2luKCdcbicpICsgJ1xuJywNCiAgICAgICAgYmFzaWNQcmVmaXg6ICJHTV9jb25maWciLA0KICAgICAgICBzdHlsaXNoOiAiIg0KICAgICAgfTsNCiAgICB9DQogICAgY29uZmlnLmZyYW1lU3R5bGUgPSBbDQogICAgICAnYm90dG9tOiBhdXRvOyBib3JkZXI6IDFweCBzb2xpZCAjMDAwOyBkaXNwbGF5OiBub25lOyBoZWlnaHQ6IDc1JTsnLA0KICAgICAgJ2xlZnQ6IDA7IG1hcmdpbjogMDsgbWF4LWhlaWdodDogOTUlOyBtYXgtd2lkdGg6IDk1JTsgb3BhY2l0eTogMDsnLA0KICAgICAgJ292ZXJmbG93OiBhdXRvOyBwYWRkaW5nOiAwOyBwb3NpdGlvbjogZml4ZWQ7IHJpZ2h0OiBhdXRvOyB0b3A6IDA7JywNCiAgICAgICd3aWR0aDogNzUlOyB6LWluZGV4OiA5OTk5OycNCgldLmpvaW4oJyAnKTsNCg0KICAgIHZhciBzZXR0aW5ncyA9IG51bGw7DQogICAgaWYgKGFyZ3MubGVuZ3RoID09IDEgJiYNCiAgICAgIHR5cGVvZiBhcmdzWzBdLmlkID09ICJzdHJpbmciICYmDQogICAgICB0eXBlb2YgYXJnc1swXS5hcHBlbmRDaGlsZCAhPSAiZnVuY3Rpb24iKSBzZXR0aW5ncyA9IGFyZ3NbMF07DQogICAgZWxzZSB7DQogICAgICAvLyBQcm92aWRlIGJhY2t3YXJkcy1jb21wYXRpYmlsaXR5IHdpdGggYXJndW1lbnQgc3R5bGUgaW50aWFsaXphdGlvbg0KICAgICAgc2V0dGluZ3MgPSB7fTsNCg0KICAgICAgLy8gbG9vcCB0aHJvdWdoIEdNX2NvbmZpZy5pbml0KCkgYXJndW1lbnRzDQogICAgICBmb3IgKGxldCBpID0gMCwgbCA9IGFyZ3MubGVuZ3RoLCBhcmc7IGkgPCBsOyArK2kpIHsNCiAgICAgICAgYXJnID0gYXJnc1tpXTsNCg0KICAgICAgICAvLyBBbiBlbGVtZW50IHRvIHVzZSBhcyB0aGUgY29uZmlnIHdpbmRvdw0KICAgICAgICBpZiAodHlwZW9mIGFyZy5hcHBlbmRDaGlsZCA9PSAiZnVuY3Rpb24iKSB7DQogICAgICAgICAgc2V0dGluZ3MuZnJhbWUgPSBhcmc7DQogICAgICAgICAgY29udGludWU7DQogICAgICAgIH0NCg0KICAgICAgICBzd2l0Y2ggKHR5cGVvZiBhcmcpIHsNCiAgICAgICAgICBjYXNlICdvYmplY3QnOg0KICAgICAgICAgICAgZm9yIChsZXQgaiBpbiBhcmcpIHsgLy8gY291bGQgYmUgYSBjYWxsYmFjayBmdW5jdGlvbnMgb3Igc2V0dGluZ3Mgb2JqZWN0DQogICAgICAgICAgICAgIGlmICh0eXBlb2YgYXJnW2pdICE9ICJmdW5jdGlvbiIpIHsgLy8gd2UgYXJlIGluIHRoZSBzZXR0aW5ncyBvYmplY3QNCiAgICAgICAgICAgICAgICBzZXR0aW5ncy5maWVsZHMgPSBhcmc7IC8vIHN0b3JlIHNldHRpbmdzIG9iamVjdA0KICAgICAgICAgICAgICAgIGJyZWFrOyAvLyBsZWF2ZSB0aGUgbG9vcA0KICAgICAgICAgICAgICB9IC8vIG90aGVyd2lzZSBpdCBtdXN0IGJlIGEgY2FsbGJhY2sgZnVuY3Rpb24NCiAgICAgICAgICAgICAgaWYgKCFzZXR0aW5ncy5ldmVudHMpIHNldHRpbmdzLmV2ZW50cyA9IHt9Ow0KICAgICAgICAgICAgICBzZXR0aW5ncy5ldmVudHNbal0gPSBhcmdbal07DQogICAgICAgICAgICB9DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICBjYXNlICdmdW5jdGlvbic6IC8vIHBhc3NpbmcgYSBiYXJlIGZ1bmN0aW9uIGlzIHNldCB0byBvcGVuIGNhbGxiYWNrDQogICAgICAgICAgICBzZXR0aW5ncy5ldmVudHMgPSB7b25PcGVuOiBhcmd9Ow0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgY2FzZSAnc3RyaW5nJzogLy8gY291bGQgYmUgY3VzdG9tIENTUyBvciB0aGUgdGl0bGUgc3RyaW5nDQogICAgICAgICAgICBpZiAoL1x3K1xzKlx7XHMqXHcrXHMqOlxzKlx3K1tcc3xcU10qXH0vLnRlc3QoYXJnKSkNCiAgICAgICAgICAgICAgc2V0dGluZ3MuY3NzID0gYXJnOw0KICAgICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgICBzZXR0aW5ncy50aXRsZSA9IGFyZzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KDQogICAgLyogSW5pdGlhbGl6ZSBldmVyeXRoaW5nIHVzaW5nIHRoZSBuZXcgc2V0dGluZ3Mgb2JqZWN0ICovDQogICAgLy8gU2V0IHRoZSBpZA0KICAgIGlmIChzZXR0aW5ncy5pZCkgY29uZmlnLmlkID0gc2V0dGluZ3MuaWQ7DQogICAgZWxzZSBpZiAodHlwZW9mIGNvbmZpZy5pZCA9PSAidW5kZWZpbmVkIikgY29uZmlnLmlkID0gJ0dNX2NvbmZpZyc7DQoNCiAgICAvLyBTZXQgdGhlIHRpdGxlDQogICAgaWYgKHNldHRpbmdzLnRpdGxlKSBjb25maWcudGl0bGUgPSBzZXR0aW5ncy50aXRsZTsNCg0KICAgIC8vIFNldCB0aGUgY3VzdG9tIGNzcw0KICAgIGlmIChzZXR0aW5ncy5jc3MpIGNvbmZpZy5jc3Muc3R5bGlzaCA9IHNldHRpbmdzLmNzczsNCg0KICAgIC8vIFNldCB0aGUgZnJhbWUNCiAgICBpZiAoc2V0dGluZ3MuZnJhbWUpIGNvbmZpZy5mcmFtZSA9IHNldHRpbmdzLmZyYW1lOw0KCQ0KICAgIC8vIFNldCB0aGUgc3R5bGUgYXR0cmlidXRlIG9mIHRoZSBmcmFtZQ0KICAgIGlmICh0eXBlb2Ygc2V0dGluZ3MuZnJhbWVTdHlsZSA9PT0gJ3N0cmluZycpIGNvbmZpZy5mcmFtZVN0eWxlID0gc2V0dGluZ3MuZnJhbWVTdHlsZTsNCg0KICAgIC8vIFNldCB0aGUgZXZlbnQgY2FsbGJhY2tzDQogICAgaWYgKHNldHRpbmdzLmV2ZW50cykgew0KICAgICAgbGV0IGV2ZW50cyA9IHNldHRpbmdzLmV2ZW50czsNCiAgICAgIGZvciAobGV0IGUgaW4gZXZlbnRzKSB7DQogICAgICAgIGNvbmZpZ1sib24iICsgZS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGUuc2xpY2UoMSldID0gZXZlbnRzW2VdOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIC8vIElmIHRoZSBpZCBoYXMgY2hhbmdlZCB3ZSBtdXN0IG1vZGlmeSB0aGUgZGVmYXVsdCBzdHlsZQ0KICAgIGlmIChjb25maWcuaWQgIT0gY29uZmlnLmNzcy5iYXNpY1ByZWZpeCkgew0KICAgICAgY29uZmlnLmNzcy5iYXNpYyA9IGNvbmZpZy5jc3MuYmFzaWMucmVwbGFjZSgNCiAgICAgICAgbmV3IFJlZ0V4cCgnIycgKyBjb25maWcuY3NzLmJhc2ljUHJlZml4LCAnZ20nKSwgJyMnICsgY29uZmlnLmlkKTsNCiAgICAgIGNvbmZpZy5jc3MuYmFzaWNQcmVmaXggPSBjb25maWcuaWQ7DQogICAgfQ0KDQogICAgLy8gQ3JlYXRlIHRoZSBmaWVsZHMNCiAgICBjb25maWcuaXNJbml0ID0gZmFsc2U7DQogICAgaWYgKHNldHRpbmdzLmZpZWxkcykgew0KICAgICAgY29uZmlnLnJlYWQobnVsbCwgKHN0b3JlZCkgPT4geyAvLyByZWFkIHRoZSBzdG9yZWQgc2V0dGluZ3MNCiAgICAgICAgbGV0IGZpZWxkcyA9IHNldHRpbmdzLmZpZWxkcywNCiAgICAgICAgICAgIGN1c3RvbVR5cGVzID0gc2V0dGluZ3MudHlwZXMgfHwge30sDQogICAgICAgICAgICBjb25maWdJZCA9IGNvbmZpZy5pZDsNCg0KICAgICAgICBmb3IgKGxldCBpZCBpbiBmaWVsZHMpIHsNCiAgICAgICAgICBsZXQgZmllbGQgPSBmaWVsZHNbaWRdLA0KICAgICAgICAgICAgICBmaWVsZEV4aXN0cyA9IGZhbHNlOw0KDQogICAgICAgICAgaWYgKGNvbmZpZy5maWVsZHNbaWRdKSB7DQogICAgICAgICAgICBmaWVsZEV4aXN0cyA9IHRydWU7DQogICAgICAgICAgfQ0KDQogICAgICAgICAgLy8gZm9yIGVhY2ggZmllbGQgZGVmaW5pdGlvbiBjcmVhdGUgYSBmaWVsZCBvYmplY3QNCiAgICAgICAgICBpZiAoZmllbGQpIHsNCiAgICAgICAgICAgIGlmIChjb25maWcuaXNPcGVuICYmIGZpZWxkRXhpc3RzKSB7DQogICAgICAgICAgICAgICAgY29uZmlnLmZpZWxkc1tpZF0ucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGNvbmZpZy5maWVsZHNbaWRdID0gbmV3IEdNX2NvbmZpZ0ZpZWxkKGZpZWxkLCBzdG9yZWRbaWRdLCBpZCwNCiAgICAgICAgICAgICAgY3VzdG9tVHlwZXNbZmllbGQudHlwZV0sIGNvbmZpZ0lkKTsNCg0KICAgICAgICAgICAgLy8gQWRkIGZpZWxkIHRvIG9wZW4gZnJhbWUNCiAgICAgICAgICAgIGlmIChjb25maWcuaXNPcGVuKSB7DQogICAgICAgICAgICAgIGNvbmZpZy5maWVsZHNbaWRdLndyYXBwZXIgPSBjb25maWcuZmllbGRzW2lkXS50b05vZGUoKTsNCiAgICAgICAgICAgICAgY29uZmlnLmZyYW1lU2VjdGlvbi5hcHBlbmRDaGlsZChjb25maWcuZmllbGRzW2lkXS53cmFwcGVyKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9IGVsc2UgaWYgKCFmaWVsZCAmJiBmaWVsZEV4aXN0cykgew0KICAgICAgICAgICAgLy8gUmVtb3ZlIGZpZWxkIGZyb20gb3BlbiBmcmFtZQ0KICAgICAgICAgICAgaWYgKGNvbmZpZy5pc09wZW4pIHsNCiAgICAgICAgICAgICAgY29uZmlnLmZpZWxkc1tpZF0ucmVtb3ZlKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIGRlbGV0ZSBjb25maWcuZmllbGRzW2lkXTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBjb25maWcuaXNJbml0ID0gdHJ1ZTsNCiAgICAgICAgY29uZmlnLm9uSW5pdC5jYWxsKGNvbmZpZyk7DQogICAgICB9KTsNCiAgICB9IGVsc2Ugew0KICAgICAgY29uZmlnLmlzSW5pdCA9IHRydWU7DQogICAgICBjb25maWcub25Jbml0LmNhbGwoY29uZmlnKTsNCiAgICB9DQogIH0NCg0KICBsZXQgY29uc3RydWN0ID0gZnVuY3Rpb24gKCkgew0KICAgIC8vIFBhcnNpbmcgb2YgaW5wdXQgcHJvdmlkZWQgdmlhIGZyb250ZW5kcw0KICAgIEdNX2NvbmZpZ0luaXQodGhpcywgYXJndW1lbnRzKTsNCiAgfTsNCiAgY29uc3RydWN0LnByb3RvdHlwZSA9IHsNCiAgICAvLyBTdXBwb3J0IHJlLWluaXRhbGl6YXRpb24NCiAgICBpbml0OiBmdW5jdGlvbigpIHsNCiAgICAgIEdNX2NvbmZpZ0luaXQodGhpcywgYXJndW1lbnRzKTsNCiAgICB9LA0KDQogICAgLy8gY2FsbCBHTV9jb25maWcub3BlbigpIGZyb20geW91ciBzY3JpcHQgdG8gb3BlbiB0aGUgbWVudQ0KICAgIG9wZW46IGZ1bmN0aW9uICgpIHsNCiAgICAgIC8vIGRvbid0IG9wZW4gYmVmb3JlIGluaXQgaXMgZmluaXNoZWQNCiAgICAgIGlmICghdGhpcy5pc0luaXQpIHsNCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB0aGlzLm9wZW4oKSwgMCk7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIC8vIERpZSBpZiB0aGUgbWVudSBpcyBhbHJlYWR5IG9wZW4gb24gdGhpcyBwYWdlDQogICAgICAvLyBZb3UgY2FuIGhhdmUgbXVsdGlwbGUgaW5zdGFuY2VzIGJ1dCB5b3UgY2FuJ3Qgb3BlbiB0aGUgc2FtZSBpbnN0YW5jZSB0d2ljZQ0KICAgICAgbGV0IG1hdGNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5pZCk7DQogICAgICBpZiAobWF0Y2ggJiYgKG1hdGNoLnRhZ05hbWUgPT0gIklGUkFNRSIgfHwgbWF0Y2guY2hpbGROb2Rlcy5sZW5ndGggPiAwKSkgcmV0dXJuOw0KDQogICAgICAvLyBTb21ldGltZXMgInRoaXMiIGdldHMgb3ZlcndyaXR0ZW4gc28gY3JlYXRlIGFuIGFsaWFzDQogICAgICBsZXQgY29uZmlnID0gdGhpczsNCg0KICAgICAgLy8gRnVuY3Rpb24gdG8gYnVpbGQgdGhlIG1pZ2h0eSBjb25maWcgd2luZG93IDopDQogICAgICBmdW5jdGlvbiBidWlsZENvbmZpZ1dpbiAoYm9keSwgaGVhZCkgew0KICAgICAgICBsZXQgY3JlYXRlID0gY29uZmlnLmNyZWF0ZSwNCiAgICAgICAgICAgIGZpZWxkcyA9IGNvbmZpZy5maWVsZHMsDQogICAgICAgICAgICBjb25maWdJZCA9IGNvbmZpZy5pZCwNCiAgICAgICAgICAgIGJvZHlXcmFwcGVyID0gY3JlYXRlKCdkaXYnLCB7aWQ6IGNvbmZpZ0lkICsgJ193cmFwcGVyJ30pOw0KDQogICAgICAgIC8vIEFwcGVuZCB0aGUgc3R5bGUgd2hpY2ggaXMgb3VyIGRlZmF1bHQgc3R5bGUgcGx1cyB0aGUgdXNlciBzdHlsZQ0KICAgICAgICBoZWFkLmFwcGVuZENoaWxkKA0KICAgICAgICAgIGNyZWF0ZSgnc3R5bGUnLCB7DQogICAgICAgICAgdHlwZTogJ3RleHQvY3NzJywNCiAgICAgICAgICB0ZXh0Q29udGVudDogY29uZmlnLmNzcy5iYXNpYyArIGNvbmZpZy5jc3Muc3R5bGlzaA0KICAgICAgICB9KSk7DQoNCiAgICAgICAgLy8gQWRkIGhlYWRlciBhbmQgdGl0bGUNCiAgICAgICAgYm9keVdyYXBwZXIuYXBwZW5kQ2hpbGQoY3JlYXRlKCdkaXYnLCB7DQogICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19oZWFkZXInLA0KICAgICAgICAgIGNsYXNzTmFtZTogJ2NvbmZpZ19oZWFkZXIgYmxvY2sgY2VudGVyJw0KICAgICAgICB9LCBjb25maWcudGl0bGUpKTsNCg0KICAgICAgICAvLyBBcHBlbmQgZWxlbWVudHMNCiAgICAgICAgbGV0IHNlY3Rpb24gPSBib2R5V3JhcHBlciwNCiAgICAgICAgICAgIHNlY051bSA9IDA7IC8vIFNlY3Rpb24gY291bnQNCg0KICAgICAgICAvLyBsb29wIHRocm91Z2ggZmllbGRzDQogICAgICAgIGZvciAobGV0IGlkIGluIGZpZWxkcykgew0KICAgICAgICAgIGxldCBmaWVsZCA9IGZpZWxkc1tpZF0sDQogICAgICAgICAgICAgIHNldHRpbmdzID0gZmllbGQuc2V0dGluZ3M7DQoNCiAgICAgICAgICBpZiAoc2V0dGluZ3Muc2VjdGlvbikgeyAvLyB0aGUgc3RhcnQgb2YgYSBuZXcgc2VjdGlvbg0KICAgICAgICAgICAgc2VjdGlvbiA9IGJvZHlXcmFwcGVyLmFwcGVuZENoaWxkKGNyZWF0ZSgnZGl2Jywgew0KICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3NlY3Rpb25faGVhZGVyX2hvbGRlcicsDQogICAgICAgICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19zZWN0aW9uXycgKyBzZWNOdW0NCiAgICAgICAgICAgICAgfSkpOw0KDQogICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoc2V0dGluZ3Muc2VjdGlvbikpDQogICAgICAgICAgICAgIHNldHRpbmdzLnNlY3Rpb24gPSBbc2V0dGluZ3Muc2VjdGlvbl07DQoNCiAgICAgICAgICAgIGlmIChzZXR0aW5ncy5zZWN0aW9uWzBdKQ0KICAgICAgICAgICAgICBzZWN0aW9uLmFwcGVuZENoaWxkKGNyZWF0ZSgnZGl2Jywgew0KICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3NlY3Rpb25faGVhZGVyIGNlbnRlcicsDQogICAgICAgICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19zZWN0aW9uX2hlYWRlcl8nICsgc2VjTnVtDQogICAgICAgICAgICAgIH0sIHNldHRpbmdzLnNlY3Rpb25bMF0pKTsNCg0KICAgICAgICAgICAgaWYgKHNldHRpbmdzLnNlY3Rpb25bMV0pDQogICAgICAgICAgICAgIHNlY3Rpb24uYXBwZW5kQ2hpbGQoY3JlYXRlKCdwJywgew0KICAgICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3NlY3Rpb25fZGVzYyBjZW50ZXInLA0KICAgICAgICAgICAgICAgIGlkOiBjb25maWdJZCArICdfc2VjdGlvbl9kZXNjXycgKyBzZWNOdW0NCiAgICAgICAgICAgICAgfSwgc2V0dGluZ3Muc2VjdGlvblsxXSkpOw0KICAgICAgICAgICAgKytzZWNOdW07DQogICAgICAgICAgfQ0KICAgICAgICAgIA0KICAgICAgICAgIGlmIChzZWNOdW0gPT09IDApIHsNCiAgICAgICAgICAgIHNlY3Rpb24gPSBib2R5V3JhcHBlci5hcHBlbmRDaGlsZChjcmVhdGUoJ2RpdicsIHsNCiAgICAgICAgICAgICAgICBjbGFzc05hbWU6ICdzZWN0aW9uX2hlYWRlcl9ob2xkZXInLA0KICAgICAgICAgICAgICAgIGlkOiBjb25maWdJZCArICdfc2VjdGlvbl8nICsgKHNlY051bSsrKQ0KICAgICAgICAgICAgfSkpOw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIC8vIENyZWF0ZSBmaWVsZCBlbGVtZW50cyBhbmQgYXBwZW5kIHRvIGN1cnJlbnQgc2VjdGlvbg0KICAgICAgICAgIHNlY3Rpb24uYXBwZW5kQ2hpbGQoKGZpZWxkLndyYXBwZXIgPSBmaWVsZC50b05vZGUoKSkpOw0KICAgICAgICB9DQogICAgICAgIA0KICAgICAgICBjb25maWcuZnJhbWVTZWN0aW9uID0gc2VjdGlvbjsNCg0KICAgICAgICAvLyBBZGQgc2F2ZSBhbmQgY2xvc2UgYnV0dG9ucw0KICAgICAgICBib2R5V3JhcHBlci5hcHBlbmRDaGlsZChjcmVhdGUoJ2RpdicsDQogICAgICAgICAge2lkOiBjb25maWdJZCArICdfYnV0dG9uc19ob2xkZXInfSwNCg0KICAgICAgICAgIGNyZWF0ZSgnYnV0dG9uJywgew0KICAgICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19zYXZlQnRuJywNCiAgICAgICAgICAgIHRleHRDb250ZW50OiAnU2F2ZScsDQogICAgICAgICAgICB0aXRsZTogJ1NhdmUgc2V0dGluZ3MnLA0KICAgICAgICAgICAgY2xhc3NOYW1lOiAnc2F2ZWNsb3NlX2J1dHRvbnMnLA0KICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24gKCkgeyBjb25maWcuc2F2ZSgpOyB9DQogICAgICAgICAgfSksDQoNCiAgICAgICAgICBjcmVhdGUoJ2J1dHRvbicsIHsNCiAgICAgICAgICAgIGlkOiBjb25maWdJZCArICdfY2xvc2VCdG4nLA0KICAgICAgICAgICAgdGV4dENvbnRlbnQ6ICdDbG9zZScsDQogICAgICAgICAgICB0aXRsZTogJ0Nsb3NlIHdpbmRvdycsDQogICAgICAgICAgICBjbGFzc05hbWU6ICdzYXZlY2xvc2VfYnV0dG9ucycsDQogICAgICAgICAgICBvbmNsaWNrOiBmdW5jdGlvbiAoKSB7IGNvbmZpZy5jbG9zZSgpOyB9DQogICAgICAgICAgfSksDQoNCiAgICAgICAgICBjcmVhdGUoJ2RpdicsDQogICAgICAgICAgICB7Y2xhc3NOYW1lOiAncmVzZXRfaG9sZGVyIGJsb2NrJ30sDQoNCiAgICAgICAgICAgIC8vIFJlc2V0IGxpbmsNCiAgICAgICAgICAgIGNyZWF0ZSgnYScsIHsNCiAgICAgICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19yZXNldExpbmsnLA0KICAgICAgICAgICAgICB0ZXh0Q29udGVudDogJ1Jlc2V0IHRvIGRlZmF1bHRzJywNCiAgICAgICAgICAgICAgaHJlZjogJyMnLA0KICAgICAgICAgICAgICB0aXRsZTogJ1Jlc2V0IGZpZWxkcyB0byBkZWZhdWx0IHZhbHVlcycsDQogICAgICAgICAgICAgIGNsYXNzTmFtZTogJ3Jlc2V0JywNCiAgICAgICAgICAgICAgb25jbGljazogZnVuY3Rpb24oZSkgeyBlLnByZXZlbnREZWZhdWx0KCk7IGNvbmZpZy5yZXNldCgpOyB9DQogICAgICAgICAgICB9KQ0KICAgICAgICApKSk7DQoNCiAgICAgICAgYm9keS5hcHBlbmRDaGlsZChib2R5V3JhcHBlcik7IC8vIFBhaW50IGV2ZXJ5dGhpbmcgdG8gd2luZG93IGF0IG9uY2UNCiAgICAgICAgY29uZmlnLmNlbnRlcigpOyAvLyBTaG93IGFuZCBjZW50ZXIgaWZyYW1lDQogICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBjb25maWcuY2VudGVyLCBmYWxzZSk7IC8vIENlbnRlciBmcmFtZSBvbiByZXNpemUNCg0KICAgICAgICAvLyBDYWxsIHRoZSBvcGVuKCkgY2FsbGJhY2sgZnVuY3Rpb24NCiAgICAgICAgY29uZmlnLm9uT3Blbihjb25maWcuZnJhbWUuY29udGVudERvY3VtZW50IHx8IGNvbmZpZy5mcmFtZS5vd25lckRvY3VtZW50LA0KICAgICAgICAgICAgICAgICAgICAgIGNvbmZpZy5mcmFtZS5jb250ZW50V2luZG93IHx8IHdpbmRvdywNCiAgICAgICAgICAgICAgICAgICAgICBjb25maWcuZnJhbWUpOw0KDQogICAgICAgIC8vIENsb3NlIGZyYW1lIG9uIHdpbmRvdyBjbG9zZQ0KICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgY29uZmlnLmNsb3NlKCk7DQogICAgICAgIH0sIGZhbHNlKTsNCg0KICAgICAgICAvLyBOb3cgdGhhdCBldmVyeXRoaW5nIGlzIGxvYWRlZCwgbWFrZSBpdCB2aXNpYmxlDQogICAgICAgIGNvbmZpZy5mcmFtZS5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsNCiAgICAgICAgY29uZmlnLmlzT3BlbiA9IHRydWU7DQogICAgICB9DQoNCiAgICAgIC8vIEVpdGhlciB1c2UgdGhlIGVsZW1lbnQgcGFzc2VkIHRvIGluaXQoKSBvciBjcmVhdGUgYW4gaWZyYW1lDQogICAgICBpZiAodGhpcy5mcmFtZSkgew0KICAgICAgICB0aGlzLmZyYW1lLmlkID0gdGhpcy5pZDsgLy8gQWxsb3dzIGZvciBwcmVmaXhpbmcgc3R5bGVzIHdpdGggdGhlIGNvbmZpZyBpZA0KICAgICAgICBpZiAodGhpcy5mcmFtZVN0eWxlKSB0aGlzLmZyYW1lLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCB0aGlzLmZyYW1lU3R5bGUpOw0KICAgICAgICBidWlsZENvbmZpZ1dpbih0aGlzLmZyYW1lLCB0aGlzLmZyYW1lLm93bmVyRG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICAvLyBDcmVhdGUgZnJhbWUNCiAgICAgICAgdGhpcy5mcmFtZSA9IHRoaXMuY3JlYXRlKCdpZnJhbWUnLCB7IGlkOiB0aGlzLmlkIH0pOw0KICAgICAgICBpZiAodGhpcy5mcmFtZVN0eWxlKSB0aGlzLmZyYW1lLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCB0aGlzLmZyYW1lU3R5bGUpOw0KICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuZnJhbWUpOw0KDQogICAgICAgIC8vIEluIFdlYktpdCBzcmMgY2FuJ3QgYmUgc2V0IHVudGlsIGl0IGlzIGFkZGVkIHRvIHRoZSBwYWdlDQogICAgICAgIHRoaXMuZnJhbWUuc3JjID0gJyc7DQogICAgICAgIC8vIHdlIHdhaXQgZm9yIHRoZSBpZnJhbWUgdG8gbG9hZCBiZWZvcmUgd2UgY2FuIG1vZGlmeSBpdA0KICAgICAgICBsZXQgdGhhdCA9IHRoaXM7DQogICAgICAgIHRoaXMuZnJhbWUuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKGUpIHsNCiAgICAgICAgICAgIGxldCBmcmFtZSA9IGNvbmZpZy5mcmFtZTsNCiAgICAgICAgICAgIGlmICghZnJhbWUuY29udGVudERvY3VtZW50KSB7DQogICAgICAgICAgICAgIHRoYXQubG9nKCJHTV9jb25maWcgZmFpbGVkIHRvIGluaXRpYWxpemUgZGVmYXVsdCBzZXR0aW5ncyBkaWFsb2cgbm9kZSEiKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIGxldCBib2R5ID0gZnJhbWUuY29udGVudERvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdib2R5JylbMF07DQogICAgICAgICAgICAgIGJvZHkuaWQgPSBjb25maWcuaWQ7IC8vIEFsbG93cyBmb3IgcHJlZml4aW5nIHN0eWxlcyB3aXRoIHRoZSBjb25maWcgaWQNCiAgICAgICAgICAgICAgYnVpbGRDb25maWdXaW4oYm9keSwgZnJhbWUuY29udGVudERvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdoZWFkJylbMF0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LCBmYWxzZSk7DQogICAgICB9DQogICAgfSwNCg0KICAgIHNhdmU6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHRoaXMud3JpdGUobnVsbCwgbnVsbCwgKHZhbHMpID0+IHRoaXMub25TYXZlKHZhbHMpKTsNCiAgICB9LA0KDQogICAgY2xvc2U6IGZ1bmN0aW9uKCkgew0KICAgICAgLy8gSWYgZnJhbWUgaXMgYW4gaWZyYW1lIHRoZW4gcmVtb3ZlIGl0DQogICAgICBpZiAodGhpcy5mcmFtZSAmJiB0aGlzLmZyYW1lLmNvbnRlbnREb2N1bWVudCkgew0KICAgICAgICB0aGlzLnJlbW92ZSh0aGlzLmZyYW1lKTsNCiAgICAgICAgdGhpcy5mcmFtZSA9IG51bGw7DQogICAgICB9IGVsc2UgaWYgKHRoaXMuZnJhbWUpIHsgLy8gZWxzZSB3aXBlIGl0cyBjb250ZW50DQogICAgICAgIHRoaXMuZnJhbWUuaW5uZXJIVE1MID0gIiI7DQogICAgICAgIHRoaXMuZnJhbWUuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgICAgIH0NCg0KICAgICAgLy8gTnVsbCBvdXQgYWxsIHRoZSBmaWVsZHMgc28gd2UgZG9uJ3QgbGVhayBtZW1vcnkNCiAgICAgIGxldCBmaWVsZHMgPSB0aGlzLmZpZWxkczsNCiAgICAgIGZvciAobGV0IGlkIGluIGZpZWxkcykgew0KICAgICAgICBsZXQgZmllbGQgPSBmaWVsZHNbaWRdOw0KICAgICAgICBmaWVsZC53cmFwcGVyID0gbnVsbDsNCiAgICAgICAgZmllbGQubm9kZSA9IG51bGw7DQogICAgICB9DQoNCiAgICAgIHRoaXMub25DbG9zZSgpOyAvLyAgQ2FsbCB0aGUgY2xvc2UoKSBjYWxsYmFjayBmdW5jdGlvbg0KICAgICAgdGhpcy5pc09wZW4gPSBmYWxzZTsNCiAgICB9LA0KDQogICAgc2V0OiBmdW5jdGlvbiAobmFtZSwgdmFsKSB7DQogICAgICB0aGlzLmZpZWxkc1tuYW1lXS52YWx1ZSA9IHZhbDsNCg0KICAgICAgaWYgKHRoaXMuZmllbGRzW25hbWVdLm5vZGUpIHsNCiAgICAgICAgdGhpcy5maWVsZHNbbmFtZV0ucmVsb2FkKCk7DQogICAgICB9DQogICAgfSwNCg0KICAgIGdldDogZnVuY3Rpb24gKG5hbWUsIGdldExpdmUpIHsNCiAgICAgIC8qIE1pZ3JhdGlvbiB3YXJuaW5nICovDQogICAgICBpZiAoIXRoaXMuaXNJbml0KSB7DQogICAgICAgIHRoaXMubG9nKCdHTV9jb25maWc6IGdldCBjYWxsZWQgYmVmb3JlIGluaXQsIHNlZSBodHRwczovL2dpdGh1Yi5jb20vc2l6emxlbWN0d2l6emxlL0dNX2NvbmZpZy9pc3N1ZXMvMTEzJyk7DQogICAgICB9DQoNCiAgICAgIGxldCBmaWVsZCA9IHRoaXMuZmllbGRzW25hbWVdLA0KICAgICAgICAgIGZpZWxkVmFsID0gbnVsbDsNCg0KICAgICAgaWYgKGdldExpdmUgJiYgZmllbGQubm9kZSkgew0KICAgICAgICBmaWVsZFZhbCA9IGZpZWxkLnRvVmFsdWUoKTsNCiAgICAgIH0NCg0KICAgICAgcmV0dXJuIGZpZWxkVmFsICE9IG51bGwgPyBmaWVsZFZhbCA6IGZpZWxkLnZhbHVlOw0KICAgIH0sDQoNCiAgICB3cml0ZTogZnVuY3Rpb24gKHN0b3JlLCBvYmosIGNiKSB7DQogICAgICBsZXQgZm9yZ290dGVuID0gbnVsbCwNCiAgICAgICAgICB2YWx1ZXMgPSBudWxsOw0KICAgICAgaWYgKCFvYmopIHsNCiAgICAgICAgbGV0IGZpZWxkcyA9IHRoaXMuZmllbGRzOw0KDQogICAgICAgIHZhbHVlcyA9IHt9Ow0KICAgICAgICBmb3Jnb3R0ZW4gPSB7fTsNCg0KICAgICAgICBmb3IgKGxldCBpZCBpbiBmaWVsZHMpIHsNCiAgICAgICAgICBsZXQgZmllbGQgPSBmaWVsZHNbaWRdOw0KICAgICAgICAgIGxldCB2YWx1ZSA9IGZpZWxkLnRvVmFsdWUoKTsNCg0KICAgICAgICAgIGlmIChmaWVsZC5zYXZlKSB7DQogICAgICAgICAgICBpZiAodmFsdWUgIT0gbnVsbCkgew0KICAgICAgICAgICAgICB2YWx1ZXNbaWRdID0gdmFsdWU7DQogICAgICAgICAgICAgIGZpZWxkLnZhbHVlID0gdmFsdWU7DQogICAgICAgICAgICB9IGVsc2UNCiAgICAgICAgICAgICAgdmFsdWVzW2lkXSA9IGZpZWxkLnZhbHVlOw0KICAgICAgICAgIH0gZWxzZQ0KICAgICAgICAgICAgZm9yZ290dGVuW2lkXSA9IHZhbHVlICE9IG51bGwgPyB2YWx1ZSA6IGZpZWxkLnZhbHVlOw0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIChhc3luYyAoKSA9PiB7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgbGV0IHZhbCA9IHRoaXMuc3RyaW5naWZ5KG9iaiB8fCB2YWx1ZXMpOw0KICAgICAgICAgIGF3YWl0IHRoaXMuc2V0VmFsdWUoc3RvcmUgfHwgdGhpcy5pZCwgdmFsKTsNCiAgICAgICAgfSBjYXRjaChlKSB7DQogICAgICAgICAgdGhpcy5sb2coIkdNX2NvbmZpZyBmYWlsZWQgdG8gc2F2ZSBzZXR0aW5ncyEiKTsNCiAgICAgICAgfQ0KICAgICAgICBjYihmb3Jnb3R0ZW4pOw0KICAgICAgfSkoKTsNCiAgICB9LA0KDQogICAgcmVhZDogZnVuY3Rpb24gKHN0b3JlLCBjYikgew0KICAgICAgKGFzeW5jICgpID0+IHsNCiAgICAgICAgbGV0IHZhbCA9IGF3YWl0IHRoaXMuZ2V0VmFsdWUoc3RvcmUgfHwgdGhpcy5pZCwgJ3t9Jyk7DQogICAgICAgIHRyeSB7DQogICAgICAgICAgbGV0IHJ2YWwgPSB0aGlzLnBhcnNlcih2YWwpOw0KICAgICAgICAgIGNiKHJ2YWwpOw0KICAgICAgICB9IGNhdGNoKGUpIHsNCiAgICAgICAgICB0aGlzLmxvZygiR01fY29uZmlnIGZhaWxlZCB0byByZWFkIHNhdmVkIHNldHRpbmdzISIpOw0KICAgICAgICAgIGNiKHt9KTsNCiAgICAgICAgfQ0KICAgICAgfSkoKTsNCiAgICB9LA0KDQogICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgIGxldCBmaWVsZHMgPSB0aGlzLmZpZWxkczsNCg0KICAgICAgLy8gUmVzZXQgYWxsIHRoZSBmaWVsZHMNCiAgICAgIGZvciAobGV0IGlkIGluIGZpZWxkcykgeyBmaWVsZHNbaWRdLnJlc2V0KCk7IH0NCg0KICAgICAgdGhpcy5vblJlc2V0KCk7IC8vIENhbGwgdGhlIHJlc2V0KCkgY2FsbGJhY2sgZnVuY3Rpb24NCiAgICB9LA0KDQogICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7DQogICAgICBsZXQgQSA9IG51bGwsDQogICAgICAgICAgQiA9IG51bGw7DQogICAgICBzd2l0Y2goYXJndW1lbnRzLmxlbmd0aCkgew0KICAgICAgICBjYXNlIDE6DQogICAgICAgICAgQSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGFyZ3VtZW50c1swXSk7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgQSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoYXJndW1lbnRzWzBdKTsNCiAgICAgICAgICBCID0gYXJndW1lbnRzWzFdOw0KICAgICAgICAgIGZvciAobGV0IGIgaW4gQikgew0KICAgICAgICAgICAgaWYgKGIuaW5kZXhPZigib24iKSA9PSAwKQ0KICAgICAgICAgICAgICBBLmFkZEV2ZW50TGlzdGVuZXIoYi5zdWJzdHJpbmcoMiksIEJbYl0sIGZhbHNlKTsNCiAgICAgICAgICAgIGVsc2UgaWYgKCIsc3R5bGUsYWNjZXNza2V5LGlkLG5hbWUsc3JjLGhyZWYsd2hpY2gsZm9yIi5pbmRleE9mKCIsIiArDQogICAgICAgICAgICAgICAgICAgICBiLnRvTG93ZXJDYXNlKCkpICE9IC0xKQ0KICAgICAgICAgICAgICBBLnNldEF0dHJpYnV0ZShiLCBCW2JdKTsNCiAgICAgICAgICAgIGVsc2UNCiAgICAgICAgICAgICAgQVtiXSA9IEJbYl07DQogICAgICAgICAgfQ0KICAgICAgICAgIGlmICh0eXBlb2YgYXJndW1lbnRzWzJdID09ICJzdHJpbmciKQ0KICAgICAgICAgICAgQS5pbm5lckhUTUwgPSBhcmd1bWVudHNbMl07DQogICAgICAgICAgZWxzZQ0KICAgICAgICAgICAgZm9yIChsZXQgaSA9IDIsIGxlbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsZW47ICsraSkNCiAgICAgICAgICAgICAgQS5hcHBlbmRDaGlsZChhcmd1bWVudHNbaV0pOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIEE7DQogICAgfSwNCg0KICAgIGNlbnRlcjogZnVuY3Rpb24gKCkgew0KICAgICAgbGV0IG5vZGUgPSB0aGlzLmZyYW1lOw0KICAgICAgaWYgKCFub2RlKSByZXR1cm47DQogICAgICBsZXQgc3R5bGUgPSBub2RlLnN0eWxlLA0KICAgICAgICAgIGJlZm9yZU9wYWNpdHkgPSBzdHlsZS5vcGFjaXR5Ow0KICAgICAgaWYgKHN0eWxlLmRpc3BsYXkgPT0gJ25vbmUnKSBzdHlsZS5vcGFjaXR5ID0gJzAnOw0KICAgICAgc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgICAgc3R5bGUudG9wID0gTWF0aC5mbG9vcigod2luZG93LmlubmVySGVpZ2h0IC8gMikgLSAobm9kZS5vZmZzZXRIZWlnaHQgLyAyKSkgKyAncHgnOw0KICAgICAgc3R5bGUubGVmdCA9IE1hdGguZmxvb3IoKHdpbmRvdy5pbm5lcldpZHRoIC8gMikgLSAobm9kZS5vZmZzZXRXaWR0aCAvIDIpKSArICdweCc7DQogICAgICBzdHlsZS5vcGFjaXR5ID0gJzEnOw0KICAgIH0sDQoNCiAgICByZW1vdmU6IGZ1bmN0aW9uIChlbCkgew0KICAgICAgaWYgKGVsICYmIGVsLnBhcmVudE5vZGUpIGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpOw0KICAgIH0NCiAgfTsNCg0KICBjb25zdHJ1Y3QucHJvdG90eXBlLm5hbWUgPSAnR01fY29uZmlnJzsNCiAgY29uc3RydWN0LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IGNvbnN0cnVjdDsNCiAgbGV0IGlzR000ID0gdHlwZW9mIEdNLmdldFZhbHVlICE9PSAndW5kZWZpbmVkJyAmJg0KICAgIHR5cGVvZiBHTS5zZXRWYWx1ZSAhPT0gJ3VuZGVmaW5lZCc7DQogIGxldCBpc0dNID0gaXNHTTQgfHwgKHR5cGVvZiBHTV9nZXRWYWx1ZSAhPT0gJ3VuZGVmaW5lZCcgJiYNCiAgICB0eXBlb2YgR01fZ2V0VmFsdWUoJ2EnLCAnYicpICE9PSAndW5kZWZpbmVkJyk7DQogIGNvbnN0cnVjdC5wcm90b3R5cGUuaXNHTSA9IGlzR007DQoNCiAgaWYgKCFpc0dNNCkgew0KICAgIGxldCBwcm9taXNpZnkgPSAob2xkKSA9PiAoLi4uYXJncykgPT4gew0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsNCiAgICAgICAgdHJ5IHsNCiAgICAgICAgICByZXNvbHZlKG9sZC5hcHBseSh0aGlzLCBhcmdzKSk7DQogICAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgICByZWplY3QoZSk7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH07DQoNCiAgICBsZXQgZ2V0VmFsdWUgPSBpc0dNID8gR01fZ2V0VmFsdWUNCiAgICAgIDogKG5hbWUsIGRlZikgPT4gew0KICAgICAgICBsZXQgcyA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKG5hbWUpOw0KICAgICAgICByZXR1cm4gcyAhPT0gbnVsbCA/IHMgOiBkZWY7DQogICAgICB9Ow0KICAgIGxldCBzZXRWYWx1ZSA9IGlzR00gPyBHTV9zZXRWYWx1ZQ0KICAgICAgOiAobmFtZSwgdmFsdWUpID0+IGxvY2FsU3RvcmFnZS5zZXRJdGVtKG5hbWUsIHZhbHVlKTsNCiAgICBsZXQgbG9nID0gdHlwZW9mIEdNX2xvZyAhPT0gJ3VuZGVmaW5lZCcgPyBHTV9sb2cgOiBjb25zb2xlLmxvZzsNCg0KICAgIEdNLmdldFZhbHVlID0gcHJvbWlzaWZ5KGdldFZhbHVlKTsNCiAgICBHTS5zZXRWYWx1ZSA9IHByb21pc2lmeShzZXRWYWx1ZSk7DQogICAgR00ubG9nID0gcHJvbWlzaWZ5KGxvZyk7DQogIH0NCg0KICBjb25zdHJ1Y3QucHJvdG90eXBlLnN0cmluZ2lmeSA9IEpTT04uc3RyaW5naWZ5Ow0KICBjb25zdHJ1Y3QucHJvdG90eXBlLnBhcnNlciA9IEpTT04ucGFyc2U7DQogIGNvbnN0cnVjdC5wcm90b3R5cGUuZ2V0VmFsdWUgPSBHTS5nZXRWYWx1ZTsNCiAgY29uc3RydWN0LnByb3RvdHlwZS5zZXRWYWx1ZSA9IEdNLnNldFZhbHVlOw0KICBjb25zdHJ1Y3QucHJvdG90eXBlLmxvZyA9IEdNLmxvZyB8fCBjb25zb2xlLmxvZzsNCg0KICAvLyBQYXNzdGhyb3VnaCBmcm9udGVuZHMgZm9yIG5ldyBhbmQgb2xkIHVzYWdlDQogIGxldCBjb25maWcgPSBmdW5jdGlvbiAoKSB7DQogICAgcmV0dXJuIG5ldyAoY29uZmlnLmJpbmQuYXBwbHkoY29uc3RydWN0LA0KICAgICAgW251bGxdLmNvbmNhdChBcnJheS5mcm9tKGFyZ3VtZW50cykpKSk7DQogIH07DQogIGNvbmZpZy5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBjb25maWc7DQoNCiAgLy8gU3VwcG9ydCBvbGQgbWV0aG9kIG9mIGluaXRhbGl6aW5nDQogIGNvbmZpZy5pbml0ID0gZnVuY3Rpb24gKCkgew0KICAgIEdNX2NvbmZpZyA9IGNvbmZpZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOw0KICAgIEdNX2NvbmZpZy5pbml0ID0gZnVuY3Rpb24oKSB7DQogICAgICBHTV9jb25maWdJbml0KHRoaXMsIGFyZ3VtZW50cyk7DQogICAgfTsNCiAgfTsNCg0KICAvLyBSZXVzYWJsZSBmdW5jdGlvbnMgYW5kIHByb3BlcnRpZXMNCiAgLy8gVXNhYmxlIHZpYSBHTV9jb25maWcuKg0KICBjb25maWcuY3JlYXRlID0gY29uc3RydWN0LnByb3RvdHlwZS5jcmVhdGU7DQogIGNvbmZpZy5pc0dNID0gY29uc3RydWN0LnByb3RvdHlwZS5pc0dNOw0KICBjb25maWcuc2V0VmFsdWUgPSBjb25zdHJ1Y3QucHJvdG90eXBlLnNldFZhbHVlOw0KICBjb25maWcuZ2V0VmFsdWUgPSBjb25zdHJ1Y3QucHJvdG90eXBlLmdldFZhbHVlOw0KICBjb25maWcuc3RyaW5naWZ5ID0gY29uc3RydWN0LnByb3RvdHlwZS5zdHJpbmdpZnk7DQogIGNvbmZpZy5wYXJzZXIgPSBjb25zdHJ1Y3QucHJvdG90eXBlLnBhcnNlcjsNCiAgY29uZmlnLmxvZyA9IGNvbnN0cnVjdC5wcm90b3R5cGUubG9nOw0KICBjb25maWcucmVtb3ZlID0gY29uc3RydWN0LnByb3RvdHlwZS5yZW1vdmU7DQogIGNvbmZpZy5yZWFkID0gY29uc3RydWN0LnByb3RvdHlwZS5yZWFkLmJpbmQoY29uZmlnKTsNCiAgY29uZmlnLndyaXRlID0gY29uc3RydWN0LnByb3RvdHlwZS53cml0ZS5iaW5kKGNvbmZpZyk7DQoNCiAgcmV0dXJuIGNvbmZpZzsNCn0odHlwZW9mIEdNID09PSAnb2JqZWN0JyA/IEdNIDogT2JqZWN0LmNyZWF0ZShudWxsKSkpOw0KbGV0IEdNX2NvbmZpZ1N0cnVjdCA9IEdNX2NvbmZpZzsNCg0KZnVuY3Rpb24gR01fY29uZmlnRmllbGQoc2V0dGluZ3MsIHN0b3JlZCwgaWQsIGN1c3RvbVR5cGUsIGNvbmZpZ0lkKSB7DQogIC8vIFN0b3JlIHRoZSBmaWVsZCdzIHNldHRpbmdzDQogIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5nczsNCiAgdGhpcy5pZCA9IGlkOw0KICB0aGlzLmNvbmZpZ0lkID0gY29uZmlnSWQ7DQogIHRoaXMubm9kZSA9IG51bGw7DQogIHRoaXMud3JhcHBlciA9IG51bGw7DQogIHRoaXMuc2F2ZSA9IHR5cGVvZiBzZXR0aW5ncy5zYXZlID09ICJ1bmRlZmluZWQiID8gdHJ1ZSA6IHNldHRpbmdzLnNhdmU7DQoNCiAgLy8gQnV0dG9ucyBhcmUgc3RhdGljIGFuZCBkb24ndCBoYXZlIGEgc3RvcmVkIHZhbHVlDQogIGlmIChzZXR0aW5ncy50eXBlID09ICJidXR0b24iKSB0aGlzLnNhdmUgPSBmYWxzZTsNCg0KICAvLyBpZiBhIGRlZmF1bHQgdmFsdWUgd2Fzbid0IHBhc3NlZCB0aHJvdWdoIGluaXQoKSB0aGVuDQogIC8vICAgaWYgdGhlIHR5cGUgaXMgY3VzdG9tIHVzZSBpdHMgZGVmYXVsdCB2YWx1ZQ0KICAvLyAgIGVsc2UgdXNlIGRlZmF1bHQgdmFsdWUgZm9yIHR5cGUNCiAgLy8gZWxzZSB1c2UgdGhlIGRlZmF1bHQgdmFsdWUgcGFzc2VkIHRocm91Z2ggaW5pdCgpDQogIHRoaXNbJ2RlZmF1bHQnXSA9IHR5cGVvZiBzZXR0aW5nc1snZGVmYXVsdCddID09ICJ1bmRlZmluZWQiID8NCiAgICBjdXN0b21UeXBlID8NCiAgICAgIGN1c3RvbVR5cGVbJ2RlZmF1bHQnXQ0KICAgICAgOiB0aGlzLmRlZmF1bHRWYWx1ZShzZXR0aW5ncy50eXBlLCBzZXR0aW5ncy5vcHRpb25zKQ0KICAgIDogc2V0dGluZ3NbJ2RlZmF1bHQnXTsNCg0KICAvLyBTdG9yZSB0aGUgZmllbGQncyB2YWx1ZQ0KICB0aGlzLnZhbHVlID0gdHlwZW9mIHN0b3JlZCA9PSAidW5kZWZpbmVkIiA/IHRoaXNbJ2RlZmF1bHQnXSA6IHN0b3JlZDsNCg0KICAvLyBTZXR1cCBtZXRob2RzIGZvciBhIGN1c3RvbSB0eXBlDQogIGlmIChjdXN0b21UeXBlKSB7DQogICAgdGhpcy50b05vZGUgPSBjdXN0b21UeXBlLnRvTm9kZTsNCiAgICB0aGlzLnRvVmFsdWUgPSBjdXN0b21UeXBlLnRvVmFsdWU7DQogICAgdGhpcy5yZXNldCA9IGN1c3RvbVR5cGUucmVzZXQ7DQogIH0NCn0NCg0KR01fY29uZmlnRmllbGQucHJvdG90eXBlID0gew0KICBjcmVhdGU6IEdNX2NvbmZpZy5jcmVhdGUsDQoNCiAgZGVmYXVsdFZhbHVlOiBmdW5jdGlvbih0eXBlLCBvcHRpb25zKSB7DQogICAgbGV0IHZhbHVlOw0KDQogICAgaWYgKHR5cGUuaW5kZXhPZigndW5zaWduZWQgJykgPT0gMCkNCiAgICAgIHR5cGUgPSB0eXBlLnN1YnN0cmluZyg5KTsNCg0KICAgIHN3aXRjaCAodHlwZSkgew0KICAgICAgY2FzZSAncmFkaW8nOiBjYXNlICdzZWxlY3QnOg0KICAgICAgICB2YWx1ZSA9IG9wdGlvbnNbMF07DQogICAgICAgIGJyZWFrOw0KICAgICAgY2FzZSAnY2hlY2tib3gnOg0KICAgICAgICB2YWx1ZSA9IGZhbHNlOw0KICAgICAgICBicmVhazsNCiAgICAgIGNhc2UgJ2ludCc6IGNhc2UgJ2ludGVnZXInOg0KICAgICAgY2FzZSAnZmxvYXQnOiBjYXNlICdudW1iZXInOg0KICAgICAgICB2YWx1ZSA9IDA7DQogICAgICAgIGJyZWFrOw0KICAgICAgZGVmYXVsdDoNCiAgICAgICAgdmFsdWUgPSAnJzsNCiAgICB9DQoNCiAgICByZXR1cm4gdmFsdWU7DQogIH0sDQoNCiAgdG9Ob2RlOiBmdW5jdGlvbigpIHsNCiAgICBsZXQgZmllbGQgPSB0aGlzLnNldHRpbmdzLA0KICAgICAgICB2YWx1ZSA9IHRoaXMudmFsdWUsDQogICAgICAgIG9wdGlvbnMgPSBmaWVsZC5vcHRpb25zLA0KICAgICAgICB0eXBlID0gZmllbGQudHlwZSwNCiAgICAgICAgaWQgPSB0aGlzLmlkLA0KICAgICAgICBjb25maWdJZCA9IHRoaXMuY29uZmlnSWQsDQogICAgICAgIGxhYmVsUG9zID0gZmllbGQubGFiZWxQb3MsDQogICAgICAgIGNyZWF0ZSA9IHRoaXMuY3JlYXRlOw0KDQogICAgZnVuY3Rpb24gYWRkTGFiZWwocG9zLCBsYWJlbEVsLCBwYXJlbnROb2RlLCBiZWZvcmVFbCkgew0KICAgICAgaWYgKCFiZWZvcmVFbCkgYmVmb3JlRWwgPSBwYXJlbnROb2RlLmZpcnN0Q2hpbGQ7DQogICAgICBzd2l0Y2ggKHBvcykgew0KICAgICAgICBjYXNlICdyaWdodCc6IGNhc2UgJ2JlbG93JzoNCiAgICAgICAgICBpZiAocG9zID09ICdiZWxvdycpDQogICAgICAgICAgICBwYXJlbnROb2RlLmFwcGVuZENoaWxkKGNyZWF0ZSgnYnInLCB7fSkpOw0KICAgICAgICAgIHBhcmVudE5vZGUuYXBwZW5kQ2hpbGQobGFiZWxFbCk7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgaWYgKHBvcyA9PSAnYWJvdmUnKQ0KICAgICAgICAgICAgcGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoY3JlYXRlKCdicicsIHt9KSwgYmVmb3JlRWwpOw0KICAgICAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGxhYmVsRWwsIGJlZm9yZUVsKTsNCiAgICAgIH0NCiAgICB9DQoNCiAgICBsZXQgcmV0Tm9kZSA9IGNyZWF0ZSgnZGl2JywgeyBjbGFzc05hbWU6ICdjb25maWdfdmFyJywNCiAgICAgICAgICBpZDogY29uZmlnSWQgKyAnXycgKyBpZCArICdfdmFyJywNCiAgICAgICAgICB0aXRsZTogZmllbGQudGl0bGUgfHwgJycgfSksDQogICAgICAgIGZpcnN0UHJvcDsNCg0KICAgIC8vIFJldHJpZXZlIHRoZSBmaXJzdCBwcm9wDQogICAgZm9yIChsZXQgaSBpbiBmaWVsZCkgeyBmaXJzdFByb3AgPSBpOyBicmVhazsgfQ0KDQogICAgbGV0IGxhYmVsID0gZmllbGQubGFiZWwgJiYgdHlwZSAhPSAiYnV0dG9uIiA/DQogICAgICBjcmVhdGUoJ2xhYmVsJywgew0KICAgICAgICBpZDogY29uZmlnSWQgKyAnXycgKyBpZCArICdfZmllbGRfbGFiZWwnLA0KICAgICAgICBmb3I6IGNvbmZpZ0lkICsgJ19maWVsZF8nICsgaWQsDQogICAgICAgIGNsYXNzTmFtZTogJ2ZpZWxkX2xhYmVsJw0KICAgICAgfSwgZmllbGQubGFiZWwpIDogbnVsbDsNCg0KICAgIGxldCB3cmFwID0gbnVsbDsNCiAgICBzd2l0Y2ggKHR5cGUpIHsNCiAgICAgIGNhc2UgJ3RleHRhcmVhJzoNCiAgICAgICAgcmV0Tm9kZS5hcHBlbmRDaGlsZCgodGhpcy5ub2RlID0gY3JlYXRlKCd0ZXh0YXJlYScsIHsNCiAgICAgICAgICBpbm5lckhUTUw6IHZhbHVlLA0KICAgICAgICAgIGlkOiBjb25maWdJZCArICdfZmllbGRfJyArIGlkLA0KICAgICAgICAgIGNsYXNzTmFtZTogJ2Jsb2NrJywNCiAgICAgICAgICBjb2xzOiAoZmllbGQuY29scyA/IGZpZWxkLmNvbHMgOiAyMCksDQogICAgICAgICAgcm93czogKGZpZWxkLnJvd3MgPyBmaWVsZC5yb3dzIDogMikNCiAgICAgICAgfSkpKTsNCiAgICAgICAgYnJlYWs7DQogICAgICBjYXNlICdyYWRpbyc6DQogICAgICAgIHdyYXAgPSBjcmVhdGUoJ2RpdicsIHsNCiAgICAgICAgICBpZDogY29uZmlnSWQgKyAnX2ZpZWxkXycgKyBpZA0KICAgICAgICB9KTsNCiAgICAgICAgdGhpcy5ub2RlID0gd3JhcDsNCg0KICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gb3B0aW9ucy5sZW5ndGg7IGkgPCBsZW47ICsraSkgew0KICAgICAgICAgIGxldCByYWRMYWJlbCA9IGNyZWF0ZSgnbGFiZWwnLCB7DQogICAgICAgICAgICBjbGFzc05hbWU6ICdyYWRpb19sYWJlbCcNCiAgICAgICAgICB9LCBvcHRpb25zW2ldKTsNCg0KICAgICAgICAgIGxldCByYWQgPSB3cmFwLmFwcGVuZENoaWxkKGNyZWF0ZSgnaW5wdXQnLCB7DQogICAgICAgICAgICB2YWx1ZTogb3B0aW9uc1tpXSwNCiAgICAgICAgICAgIHR5cGU6ICdyYWRpbycsDQogICAgICAgICAgICBuYW1lOiBpZCwNCiAgICAgICAgICAgIGNoZWNrZWQ6IG9wdGlvbnNbaV0gPT0gdmFsdWUNCiAgICAgICAgICB9KSk7DQoNCiAgICAgICAgICBsZXQgcmFkTGFiZWxQb3MgPSBsYWJlbFBvcyAmJg0KICAgICAgICAgICAgKGxhYmVsUG9zID09ICdsZWZ0JyB8fCBsYWJlbFBvcyA9PSAncmlnaHQnKSA/DQogICAgICAgICAgICBsYWJlbFBvcyA6IGZpcnN0UHJvcCA9PSAnb3B0aW9ucycgPyAnbGVmdCcgOiAncmlnaHQnOw0KDQogICAgICAgICAgYWRkTGFiZWwocmFkTGFiZWxQb3MsIHJhZExhYmVsLCB3cmFwLCByYWQpOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0Tm9kZS5hcHBlbmRDaGlsZCh3cmFwKTsNCiAgICAgICAgYnJlYWs7DQogICAgICBjYXNlICdzZWxlY3QnOg0KICAgICAgICB3cmFwID0gY3JlYXRlKCdzZWxlY3QnLCB7DQogICAgICAgICAgaWQ6IGNvbmZpZ0lkICsgJ19maWVsZF8nICsgaWQNCiAgICAgICAgfSk7DQogICAgICAgIHRoaXMubm9kZSA9IHdyYXA7DQoNCiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IG9wdGlvbnMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsNCiAgICAgICAgICBsZXQgb3B0aW9uID0gb3B0aW9uc1tpXTsNCiAgICAgICAgICB3cmFwLmFwcGVuZENoaWxkKGNyZWF0ZSgnb3B0aW9uJywgew0KICAgICAgICAgICAgdmFsdWU6IG9wdGlvbiwNCiAgICAgICAgICAgIHNlbGVjdGVkOiBvcHRpb24gPT0gdmFsdWUNCiAgICAgICAgICB9LCBvcHRpb24pKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldE5vZGUuYXBwZW5kQ2hpbGQod3JhcCk7DQogICAgICAgIGJyZWFrOw0KICAgICAgZGVmYXVsdDogLy8gZmllbGRzIHVzaW5nIGlucHV0IGVsZW1lbnRzDQogICAgICAgIGxldCBwcm9wcyA9IHsNCiAgICAgICAgICBpZDogY29uZmlnSWQgKyAnX2ZpZWxkXycgKyBpZCwNCiAgICAgICAgICB0eXBlOiB0eXBlLA0KICAgICAgICAgIHZhbHVlOiB0eXBlID09ICdidXR0b24nID8gZmllbGQubGFiZWwgOiB2YWx1ZQ0KICAgICAgICB9Ow0KDQogICAgICAgIHN3aXRjaCAodHlwZSkgew0KICAgICAgICAgIGNhc2UgJ2NoZWNrYm94JzoNCiAgICAgICAgICAgIHByb3BzLmNoZWNrZWQgPSB2YWx1ZTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGNhc2UgJ2J1dHRvbic6DQogICAgICAgICAgICBwcm9wcy5zaXplID0gZmllbGQuc2l6ZSA/IGZpZWxkLnNpemUgOiAyNTsNCiAgICAgICAgICAgIGlmIChmaWVsZC5zY3JpcHQpIGZpZWxkLmNsaWNrID0gZmllbGQuc2NyaXB0Ow0KICAgICAgICAgICAgaWYgKGZpZWxkLmNsaWNrKSBwcm9wcy5vbmNsaWNrID0gZmllbGQuY2xpY2s7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICBjYXNlICdoaWRkZW4nOg0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgIC8vIHR5cGUgPSB0ZXh0LCBpbnQsIG9yIGZsb2F0DQogICAgICAgICAgICBwcm9wcy50eXBlID0gJ3RleHQnOw0KICAgICAgICAgICAgcHJvcHMuc2l6ZSA9IGZpZWxkLnNpemUgPyBmaWVsZC5zaXplIDogMjU7DQogICAgICAgIH0NCg0KICAgICAgICByZXROb2RlLmFwcGVuZENoaWxkKCh0aGlzLm5vZGUgPSBjcmVhdGUoJ2lucHV0JywgcHJvcHMpKSk7DQogICAgfQ0KDQogICAgaWYgKGxhYmVsKSB7DQogICAgICAvLyBJZiB0aGUgbGFiZWwgaXMgcGFzc2VkIGZpcnN0LCBpbnNlcnQgaXQgYmVmb3JlIHRoZSBmaWVsZA0KICAgICAgLy8gZWxzZSBpbnNlcnQgaXQgYWZ0ZXINCiAgICAgIGlmICghbGFiZWxQb3MpDQogICAgICAgIGxhYmVsUG9zID0gZmlyc3RQcm9wID09ICJsYWJlbCIgfHwgdHlwZSA9PSAicmFkaW8iID8NCiAgICAgICAgICAibGVmdCIgOiAicmlnaHQiOw0KDQogICAgICBhZGRMYWJlbChsYWJlbFBvcywgbGFiZWwsIHJldE5vZGUpOw0KICAgIH0NCg0KICAgIHJldHVybiByZXROb2RlOw0KICB9LA0KDQogIHRvVmFsdWU6IGZ1bmN0aW9uKCkgew0KICAgIGxldCBub2RlID0gdGhpcy5ub2RlLA0KICAgICAgICBmaWVsZCA9IHRoaXMuc2V0dGluZ3MsDQogICAgICAgIHR5cGUgPSBmaWVsZC50eXBlLA0KICAgICAgICB1bnNpZ25lZCA9IGZhbHNlLA0KICAgICAgICBydmFsID0gbnVsbDsNCg0KICAgIGlmICghbm9kZSkgcmV0dXJuIHJ2YWw7DQoNCiAgICBpZiAodHlwZS5pbmRleE9mKCd1bnNpZ25lZCAnKSA9PSAwKSB7DQogICAgICB0eXBlID0gdHlwZS5zdWJzdHJpbmcoOSk7DQogICAgICB1bnNpZ25lZCA9IHRydWU7DQogICAgfQ0KDQogICAgc3dpdGNoICh0eXBlKSB7DQogICAgICBjYXNlICdjaGVja2JveCc6DQogICAgICAgIHJ2YWwgPSBub2RlLmNoZWNrZWQ7DQogICAgICAgIGJyZWFrOw0KICAgICAgY2FzZSAnc2VsZWN0JzoNCiAgICAgICAgcnZhbCA9IG5vZGVbbm9kZS5zZWxlY3RlZEluZGV4XS52YWx1ZTsNCiAgICAgICAgYnJlYWs7DQogICAgICBjYXNlICdyYWRpbyc6DQogICAgICAgIGxldCByYWRpb3MgPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpOw0KICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gcmFkaW9zLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7DQogICAgICAgICAgaWYgKHJhZGlvc1tpXS5jaGVja2VkKQ0KICAgICAgICAgICAgcnZhbCA9IHJhZGlvc1tpXS52YWx1ZTsNCiAgICAgICAgfQ0KICAgICAgICBicmVhazsNCiAgICAgIGNhc2UgJ2J1dHRvbic6DQogICAgICAgIGJyZWFrOw0KICAgICAgY2FzZSAnaW50JzogY2FzZSAnaW50ZWdlcic6DQogICAgICBjYXNlICdmbG9hdCc6IGNhc2UgJ251bWJlcic6DQogICAgICAgIGxldCBudW0gPSBOdW1iZXIobm9kZS52YWx1ZSk7DQogICAgICAgIGxldCB3YXJuID0gJ0ZpZWxkIGxhYmVsZWQgIicgKyBmaWVsZC5sYWJlbCArICciIGV4cGVjdHMgYScgKw0KICAgICAgICAgICh1bnNpZ25lZCA/ICcgcG9zaXRpdmUgJyA6ICduICcpICsgJ2ludGVnZXIgdmFsdWUnOw0KDQogICAgICAgIGlmIChpc05hTihudW0pIHx8ICh0eXBlLnN1YnN0cigwLCAzKSA9PSAnaW50JyAmJg0KICAgICAgICAgICAgTWF0aC5jZWlsKG51bSkgIT0gTWF0aC5mbG9vcihudW0pKSB8fA0KICAgICAgICAgICAgKHVuc2lnbmVkICYmIG51bSA8IDApKSB7DQogICAgICAgICAgYWxlcnQod2FybiArICcuJyk7DQogICAgICAgICAgcmV0dXJuIG51bGw7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIXRoaXMuX2NoZWNrTnVtYmVyUmFuZ2UobnVtLCB3YXJuKSkNCiAgICAgICAgICByZXR1cm4gbnVsbDsNCiAgICAgICAgcnZhbCA9IG51bTsNCiAgICAgICAgYnJlYWs7DQogICAgICBkZWZhdWx0Og0KICAgICAgICBydmFsID0gbm9kZS52YWx1ZTsNCiAgICAgICAgYnJlYWs7DQogICAgfQ0KDQogICAgcmV0dXJuIHJ2YWw7IC8vIHZhbHVlIHJlYWQgc3VjY2Vzc2Z1bGx5DQogIH0sDQoNCiAgcmVzZXQ6IGZ1bmN0aW9uKCkgew0KICAgIGxldCBub2RlID0gdGhpcy5ub2RlLA0KICAgICAgICBmaWVsZCA9IHRoaXMuc2V0dGluZ3MsDQogICAgICAgIHR5cGUgPSBmaWVsZC50eXBlOw0KDQogICAgaWYgKCFub2RlKSByZXR1cm47DQoNCiAgICBzd2l0Y2ggKHR5cGUpIHsNCiAgICAgIGNhc2UgJ2NoZWNrYm94JzoNCiAgICAgICAgbm9kZS5jaGVja2VkID0gdGhpc1snZGVmYXVsdCddOw0KICAgICAgICBicmVhazsNCiAgICAgIGNhc2UgJ3NlbGVjdCc6DQogICAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSBub2RlLm9wdGlvbnMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHsNCiAgICAgICAgICBpZiAobm9kZS5vcHRpb25zW2ldLnRleHRDb250ZW50ID09IHRoaXNbJ2RlZmF1bHQnXSkNCiAgICAgICAgICAgIG5vZGUuc2VsZWN0ZWRJbmRleCA9IGk7DQogICAgICAgIH0NCiAgICAgICAgYnJlYWs7DQogICAgICBjYXNlICdyYWRpbyc6DQogICAgICAgIGxldCByYWRpb3MgPSBub2RlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdpbnB1dCcpOw0KICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gcmFkaW9zLmxlbmd0aDsgaSA8IGxlbjsgKytpKSB7DQogICAgICAgICAgaWYgKHJhZGlvc1tpXS52YWx1ZSA9PSB0aGlzWydkZWZhdWx0J10pDQogICAgICAgICAgICByYWRpb3NbaV0uY2hlY2tlZCA9IHRydWU7DQogICAgICAgIH0NCiAgICAgICAgYnJlYWs7DQogICAgICBjYXNlICdidXR0b24nIDoNCiAgICAgICAgYnJlYWs7DQogICAgICBkZWZhdWx0Og0KICAgICAgICBub2RlLnZhbHVlID0gdGhpc1snZGVmYXVsdCddOw0KICAgICAgICBicmVhazsNCiAgICAgIH0NCiAgfSwNCg0KICByZW1vdmU6IGZ1bmN0aW9uKCkgew0KICAgIEdNX2NvbmZpZy5yZW1vdmUodGhpcy53cmFwcGVyKTsNCiAgICB0aGlzLndyYXBwZXIgPSBudWxsOw0KICAgIHRoaXMubm9kZSA9IG51bGw7DQogIH0sDQoNCiAgcmVsb2FkOiBmdW5jdGlvbigpIHsNCiAgICBsZXQgd3JhcHBlciA9IHRoaXMud3JhcHBlcjsNCiAgICBpZiAod3JhcHBlcikgew0KICAgICAgbGV0IGZpZWxkUGFyZW50ID0gd3JhcHBlci5wYXJlbnROb2RlOw0KICAgICAgbGV0IG5ld1dyYXBwZXIgPSB0aGlzLnRvTm9kZSgpOw0KICAgICAgZmllbGRQYXJlbnQuaW5zZXJ0QmVmb3JlKG5ld1dyYXBwZXIsIHdyYXBwZXIpOw0KICAgICAgR01fY29uZmlnLnJlbW92ZSh0aGlzLndyYXBwZXIpOw0KICAgICAgdGhpcy53cmFwcGVyID0gbmV3V3JhcHBlcjsNCiAgICB9DQogIH0sDQoNCiAgX2NoZWNrTnVtYmVyUmFuZ2U6IGZ1bmN0aW9uKG51bSwgd2Fybikgew0KICAgIGxldCBmaWVsZCA9IHRoaXMuc2V0dGluZ3M7DQogICAgaWYgKHR5cGVvZiBmaWVsZC5taW4gPT0gIm51bWJlciIgJiYgbnVtIDwgZmllbGQubWluKSB7DQogICAgICBhbGVydCh3YXJuICsgJyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJyArIGZpZWxkLm1pbiArICcuJyk7DQogICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQoNCiAgICBpZiAodHlwZW9mIGZpZWxkLm1heCA9PSAibnVtYmVyIiAmJiBudW0gPiBmaWVsZC5tYXgpIHsNCiAgICAgIGFsZXJ0KHdhcm4gKyAnIGxlc3MgdGhhbiBvciBlcXVhbCB0byAnICsgZmllbGQubWF4ICsgJy4nKTsNCiAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KfTsNCg=="}]},{"name":"VikACG ","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://www.vikacg.com/external*"],"orig_noframes":null,"orig_run_at":"document-start","orig_run_in":[],"orig_tags":[],"use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"run_in":null,"sandbox":null,"tags":[],"unwrap":null,"user_modified":null},"storage":{"ts":1770962150960,"data":{}},"enabled":false,"position":2,"file_url":"https://update.greasyfork.org/scripts/562472/VikACG%20%E5%A4%96%E9%93%BE%E8%B7%B3%E8%BD%AC%E5%99%A8.user.js","uuid":"4352ba13-8c16-4a21-a218-ad1b26fabec3","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBWaWtBQ0cg5aSW6ZO+6Lez6L2s5ZmoCi8vIEBuYW1lc3BhY2UgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy91c2Vycy8xNTU5NTMxLXRub2lyCi8vIEB2ZXJzaW9uICAgICAgMC4xLjIKLy8gQGRlc2NyaXB0aW9uICDmjZXojrcgVmlrQUNHIOS4rei9rOmhtemdouS4reeahOS4i+i9veWcsOWdgOW5tuebtOaOpei3s+i9rAovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vd3d3LnZpa2FjZy5jb20vZXh0ZXJuYWwqCi8vIEBydW4tYXQgICAgICAgZG9jdW1lbnQtc3RhcnQKLy8gQGdyYW50ICAgICAgICBHTV9vcGVuSW5UYWIKLy8gQGxpY2Vuc2UgICAgICBNSVQKLy8gQGljb24gICAgICAgICBodHRwczovL3d3dy52aWthY2cuY29tL2Zhdmljb24uaWNvCi8vIEBkb3dubG9hZFVSTCBodHRwczovL3VwZGF0ZS5ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzU2MjQ3Mi9WaWtBQ0clMjAlRTUlQTQlOTYlRTklOTMlQkUlRTglQjclQjMlRTglQkQlQUMlRTUlOTklQTgudXNlci5qcwovLyBAdXBkYXRlVVJMIGh0dHBzOi8vdXBkYXRlLmdyZWFzeWZvcmsub3JnL3NjcmlwdHMvNTYyNDcyL1Zpa0FDRyUyMCVFNSVBNCU5NiVFOSU5MyVCRSVFOCVCNyVCMyVFOCVCRCVBQyVFNSU5OSVBOC5tZXRhLmpzCi8vID09L1VzZXJTY3JpcHQ9PQoKKGZ1bmN0aW9uICgpIHsKICAgICd1c2Ugc3RyaWN0JzsKCiAgICAvLyB0cnVlICA9IOW9k+WJjeagh+etvumhtei3s+i9rAogICAgLy8gZmFsc2UgPSDmlrDmoIfnrb7pobXmiZPlvIDvvIjpu5jorqTvvIkKICAgIGNvbnN0IE9QRU5fSU5fQ1VSUkVOVF9UQUIgPSBmYWxzZTsKCiAgICAvLyDpmLLmraLlkIzkuIDpk77mjqXooqvlpJrmrKHop6blj5EKICAgIGxldCBoYXNSZWRpcmVjdGVkID0gZmFsc2U7CgogICAgLyogPT09PT09PT09PT09PT09PT09PT0g5LiL6L2956uZ54K555m95ZCN5Y2VID09PT09PT09PT09PT09PT09PT09ICovCgogICAgLy8g5Zu95YaF56uZ54K5CiAgICBjb25zdCBDTl9ORVRESVNLX0RPTUFJTlMgPSBbCiAgICAgICAgJ3Bhbi5iYWlkdS5jb20nLAogICAgICAgICd5dW4uYmFpZHUuY29tJywKICAgICAgICAncGFuLnh1bmxlaS5jb20nLAogICAgICAgICdjbG91ZC4xODkuY24nLAogICAgICAgICdwYW4ucXVhcmsuY24nLAogICAgICAgICdkcml2ZS51Yy5jbicsCiAgICAgICAgJ3d3dy5hbGl5dW5kcml2ZS5jb20nLAogICAgICAgICd3d3cuYWxpcGFuLmNvbScsCiAgICAgICAgJ3Bhbi4xMjNwYW4uY29tJywKICAgICAgICAnd3d3LjEyM3Bhbi5jb20nLAogICAgICAgICd3d3cubGFuem91aS5jb20nLAogICAgICAgICd3d3cubGFuem91eC5jb20nLAogICAgICAgICd3d3cubGFuem91eS5jb20nLAogICAgICAgICd3d3cubGFuem91ZS5jb20nLAogICAgICAgICd3d3cubGFuem91by5jb20nLAogICAgICAgICd3d3cubGFuem91aS5uZXQnLAogICAgICAgICd3d3cubGFuem91Yi5jb20nCiAgICBdOwoKICAgIC8vIOWbvemZheermeeCuQogICAgY29uc3QgR0xPQkFMX05FVERJU0tfRE9NQUlOUyA9IFsKICAgICAgICAnZHJpdmUuZ29vZ2xlLmNvbScsCiAgICAgICAgJ21lZ2EubnonLAogICAgICAgICdtZWdhLmlvJywKICAgICAgICAnd3d3Lm1lZGlhZmlyZS5jb20nLAogICAgICAgICd3d3cuZHJvcGJveC5jb20nLAogICAgICAgICdvbmVkcml2ZS5saXZlLmNvbScsCiAgICAgICAgJzFkcnYubXMnLAogICAgICAgICdwaXhlbGRyYWluLmNvbScsCiAgICAgICAgJ3d3dy5waXhlbGRyYWluLmNvbScsCiAgICAgICAgJ2dvZmlsZS5pbycsCiAgICAgICAgJ3d3dy5nb2ZpbGUuaW8nLAogICAgICAgICdrcmFrZW5maWxlcy5jb20nLAogICAgICAgICd3d3cua3Jha2VuZmlsZXMuY29tJywKICAgICAgICAndXBsb2FkaGF2ZW4uY29tJywKICAgICAgICAnd3d3LnVwbG9hZGhhdmVuLmNvbScsCiAgICAgICAgJ2ZpbGVjcnlwdC5jYycsCiAgICAgICAgJ3d3dy5maWxlY3J5cHQuY2MnLAogICAgICAgICdyYXBpZGdhdG9yLm5ldCcsCiAgICAgICAgJ25pdHJvZmxhcmUuY29tJywKICAgICAgICAnd3d3Lm5pdHJvZmxhcmUuY29tJywKICAgICAgICAndHVyYm9iaXQubmV0JywKICAgICAgICAnd3d3LnR1cmJvYml0Lm5ldCcsCiAgICAgICAgJ2Rkb3dubG9hZC5jb20nLAogICAgICAgICd3d3cuZGRvd25sb2FkLmNvbScsCiAgICAgICAgJ3ppcHB5c2hhcmUuY29tJywKICAgICAgICAnd3d3LnppcHB5c2hhcmUuY29tJwogICAgXTsKCiAgICAvLyDnp4HmnInkupHnm5gKICAgIGNvbnN0IFBSSVZBVEVfRklMRV9IT1NUUyA9IFsKICAgICAgICAndmlraW5nZmlsZS5jb20nLAogICAgICAgICd2aWsxbmdmaWxlLnNpdGUnLAogICAgICAgICdhbm9uZmlsZXMuY29tJywKICAgICAgICAnYmF5ZmlsZXMuY29tJywKICAgICAgICAnbGV0c3VwbG9hZC5pbycsCiAgICAgICAgJ3NlbmQuY20nLAogICAgICAgICdmaWxlY2hhbi5vcmcnLAogICAgICAgICdmaWxlcy5mbScsCiAgICAgICAgJ2ZleC5uZXQnCiAgICBdOwoKICAgIGNvbnN0IEFMTF9ORVRESVNLX0RPTUFJTlMgPSBbCiAgICAgICAgLi4uQ05fTkVURElTS19ET01BSU5TLAogICAgICAgIC4uLkdMT0JBTF9ORVRESVNLX0RPTUFJTlMsCiAgICAgICAgLi4uUFJJVkFURV9GSUxFX0hPU1RTCiAgICBdOwoKICAgIC8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCgogICAgZnVuY3Rpb24gaXNSZWFsRG93bmxvYWRVcmwodXJsKSB7CiAgICAgICAgaWYgKHR5cGVvZiB1cmwgIT09ICdzdHJpbmcnKSByZXR1cm4gZmFsc2U7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGNvbnN0IGhvc3QgPSBuZXcgVVJMKHVybCkuaG9zdG5hbWU7CiAgICAgICAgICAgIHJldHVybiBBTExfTkVURElTS19ET01BSU5TLnNvbWUoZG9tYWluID0+CiAgICAgICAgICAgICAgICBob3N0ID09PSBkb21haW4gfHwgaG9zdC5lbmRzV2l0aCgnLicgKyBkb21haW4pCiAgICAgICAgICAgICk7CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gcmVkaXJlY3QodXJsKSB7CiAgICAgICAgaWYgKGhhc1JlZGlyZWN0ZWQpIHJldHVybjsKICAgICAgICBoYXNSZWRpcmVjdGVkID0gdHJ1ZTsKCiAgICAgICAgY29uc29sZS5sb2coJ1tWaWtBQ0ddIOaNleiOt+S4i+i9vemTvuaOpe+8micsIHVybCk7CgogICAgICAgIGlmIChPUEVOX0lOX0NVUlJFTlRfVEFCKSB7CiAgICAgICAgICAgIGxvY2F0aW9uLnJlcGxhY2UodXJsKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBHTV9vcGVuSW5UYWIodXJsLCB7IGFjdGl2ZTogdHJ1ZSwgaW5zZXJ0OiB0cnVlLCBzZXRQYXJlbnQ6IHRydWUgfSk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIEhvb2sgWE1MSHR0cFJlcXVlc3QKICAgIGNvbnN0IG9yaWdpbmFsWEhST3BlbiA9IFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuOwogICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAoXywgdXJsKSB7CiAgICAgICAgaWYgKGlzUmVhbERvd25sb2FkVXJsKHVybCkpIHsKICAgICAgICAgICAgcmVkaXJlY3QodXJsKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIG9yaWdpbmFsWEhST3Blbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKCiAgICAvLyBIb29rIGZldGNo77yI5aSH55So77yJCiAgICBpZiAod2luZG93LmZldGNoKSB7CiAgICAgICAgY29uc3Qgb3JpZ2luYWxGZXRjaCA9IHdpbmRvdy5mZXRjaDsKICAgICAgICB3aW5kb3cuZmV0Y2ggPSBmdW5jdGlvbiAoaW5wdXQpIHsKICAgICAgICAgICAgY29uc3QgdXJsID0gdHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJyA/IGlucHV0IDogaW5wdXQgJiYgaW5wdXQudXJsOwogICAgICAgICAgICBpZiAoaXNSZWFsRG93bmxvYWRVcmwodXJsKSkgewogICAgICAgICAgICAgICAgcmVkaXJlY3QodXJsKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gb3JpZ2luYWxGZXRjaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICB9Cgp9KSgpOwo="},{"name":"Pixiv Plus","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":["i.pximg.net","i-f.pximg.net","i-cf.pximg.net"],"orig_excludes":[],"orig_includes":["http*://www.pixiv.net*"],"orig_matches":["http://www.pixiv.net/"],"orig_noframes":true,"orig_run_at":"document-end","orig_run_in":[],"orig_tags":[],"use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"run_in":null,"sandbox":null,"tags":[],"unwrap":null,"user_modified":null},"storage":{"ts":1770962851264,"data":{}},"enabled":false,"position":3,"file_url":"https://update.greasyfork.org/scripts/34153/Pixiv%20Plus.user.js","uuid":"5e77822e-2806-4f25-ac54-7cd4467e3648","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIFBpeGl2IFBsdXMKLy8gQG5hbWU6emgtQ04gIFBpeGl2IOWinuW8ugovLyBAbmFtZTp6aC1UVyAgUGl4aXYg5aKe5by3Ci8vIEBuYW1lc3BhY2UgICBodHRwczovL2dpdGh1Yi5jb20vQWhhb2NoYW4vVGFtcGVybW9ua2V5Ci8vIEB2ZXJzaW9uICAgICAwLjkuNQovLyBAaWNvbiAgICAgICAgaHR0cHM6Ly93d3cucGl4aXYubmV0L2Zhdmljb24uaWNvCi8vIEBkZXNjcmlwdGlvbiBGb2N1cyBvbiBpbW1lcnNpdmUgZXhwZXJpZW5jZSwgMS4gQmxvY2sgYWRzLCBkaXJlY3RseSBhY2Nlc3MgcG9wdWxhciBwaWN0dXJlcyAyLiBVc2UgdXNlciB0byBlbnRlciB0aGUgd2F5IHRvIHNlYXJjaCAzLiBTZWFyY2ggcGlkICwgdWlkIGFuZCBhdXRob3IgNC4gRGlzcGxheSBvcmlnaW5hbCBpbWFnZSBhbmQgc2l6ZSwgcGljdHVyZSByZW5hbWUsIGRvd25sb2FkIG9yaWdpbmFsIGltYWdlIHwgZ2lmIG1hcCB8IFppcHxtdWx0aXBsZSBtYXAgemlwIDUuIGRpc3BsYXkgYXJ0aXN0IGlkLCBhcnRpc3QgYmFja2dyb3VuZCBpbWFnZSA2LiBhdXRvIGxvYWQgY29tbWVudCA3LiBkeW5hbWljIG1hcmt1cCB3b3JrIHR5cGUgOC4gcmVtb3ZlIHJlZGlyZWN0aW9uIDkuIHNpbmdsZSBwYWdlIHNvcnQgMTAuIGNvbnRyb2wgcGFuZWwgc2VsZWN0IGRlc2lyZWQgZnVuY3Rpb24gZ2l0aHViOiBodHRwczovL2dpdGh1Yi5jb20vQWhhb2NoYW4vVGFtcGVybW9ua2V5LCB3ZWxjb21lIHRvIHN0YXIgYW5kIGZvcmsuCi8vIEBkZXNjcmlwdGlvbjpqYSAgICDmsqHlhaXlnovkvZPpqJPjgavnhKbngrnjgpLlvZPjgabjgovjgIExLuS6uuawl+OBruWGmeecn+OBq+ebtOaOpeOCouOCr+OCu+OCueOBmeOCi+W6g+WRiuOCkuODluODreODg+OCr+OBmeOCizIu5qSc57Si44GZ44KL5pa55rOV44KS5YWl5Yqb44GZ44KL44Gf44KB44Gr44Om44O844K244O844KS5L2/55So44GZ44KLMy7mpJzntKJwaWQgdWlkIOOBqOWJteS9nOWutiA0LuWFg+OBrueUu+WDj+OBqOOCteOCpOOCuuOCkuihqOekuuOBmeOCiyBaaXAgfCBtdWx0aXBsZSBtYXAgemlwIDUu44Ki44O844OG44Kj44K544OISUTjgIHjgqLjg7zjg4bjgqPjgrnjg4jjga7og4zmma/nlLvlg4/jgpLooajnpLrjgZfjgb7jgZnjgII2LuiHquWLleODreODvOODieOCs+ODoeODs+ODiOOCkui/veWKoOOBl+OBvuOBmeOAgjcu5YuV55qE44Oe44O844Kv44Ki44OD44OX5L2c5qWt44K/44Kk44OX44KS5oyH5a6a44GX44G+44GZ44CCOC7jg6rjg4DjgqTjg6zjgq/jg4jjgpLliYrpmaTjgZfjgb7jgZnjgII5LuOCt+ODs+OCsOODq+ODmuODvOOCuOOCveODvOODiDEwLuOCs+ODs+ODiOODreODvOODq+ODkeODjeODq+OCkumBuOaKnuOBl+OBvuOBmeOAgmdpdGh1Yu+8mmh0dHBzOi8vZ2l0aHViLmNvbS9BaGFvY2hhbi9UYW1wZXJtb25rZXnjgIHjgrnjgr/jg7zjgajjg5Xjgqnjg7zjgq/jgbjjgojjgYbjgZPjgZ3jgIIKLy8gQGRlc2NyaXB0aW9uOnpoLUNOIOS4k+azqOayiea1uOW8j+S9k+mqjO+8jDEu5bGP6JS95bm/5ZGKLOebtOaOpeiuv+mXrueDremXqOWbvueJhyAyLuS9v+eUqHVzZXJz5YWl44KK55qE5pa55byP5pCc57SiIDMu5pCc57SicGlk44CBdWlk5ZKM5L2c6ICFIDQu5pi+56S65Y6f5Zu+5Y+K5bC65a+477yM5Zu+54mH6YeN5ZG95ZCN77yM5LiL6L295Y6f5Zu+fGdpZuWbvnzliqjlm77luKd6aXB85aSa5Zu+emlwIDUu5pi+56S655S75biIaWTjgIHnlLvluIjog4zmma/lm74gNi7oh6rliqjliqDovb3or4TorrogNy7lr7nliqjmgIHmoIforrDkvZzlk4HnsbvlnosgOC7ljrvpmaTph43lrprlkJEgOS7ljZXpobXmjpLluo8gMTAu5o6n5Yi26Z2i5p2/6YCJ5oup5oOz6KaB55qE5Yqf6IO9IGdpdGh1YjpodHRwczovL2dpdGh1Yi5jb20vQWhhb2NoYW4vVGFtcGVybW9ua2V577yM5qyi6L+Oc3RhcuWSjGZvcmvjgIIKLy8gQGRlc2NyaXB0aW9uOnpoLVRXIOWwiOazqOayiea1uOW8j+mrlOmpl++8jDEu5bGP6JS95buj5ZGKLOebtOaOpeioquWVj+eGsemWgOWclueJhzIu5L2/55SodXNlcnPlhaXjgornmoTmlrnlvI/mkJzntKIzLuaQnOe0onBpZOOAgXVpZOWSjOS9nOiAhSA0Lumhr+ekuuWOn+WcluWPiuWwuuWvuO+8jOWclueJh+mHjeWRveWQje+8jOS4i+i8ieWOn+WclnxnaWblnJZ85YuV5ZyW5bmAemlwfOWkmuWclnppcCA1Lumhr+ekuueVq+W4q2lk44CB55Wr5bir6IOM5pmv5ZyWNi7oh6rli5XliqDovInoqZXoq5Y3LuWwjeWLleaFi+aomeiomOS9nOWTgemhnuWeizgu5Y676Zmk6YeN5a6a5ZCROS7llq7poIHmjpLluo8xMC7mjqfliLbpnaLmnb/pgbjmk4fmg7PopoHnmoTlip/og71naXRodWI6aHR0cHM6Ly9naXRodWIuY29tL0FoYW9jaGFuL1RhbXBlcm1vbmtlee+8jOatoei/jnN0YXLlkoxmb3Jr44CCCi8vIEBhdXRob3IgICAgICBBaGFvY2hhbgovLyBAaW5jbHVkZSAgICAgaHR0cCo6Ly93d3cucGl4aXYubmV0KgovLyBAbWF0Y2ggICAgICAgaHR0cDovL3d3dy5waXhpdi5uZXQvCi8vIEBjb25uZWN0ICAgICBpLnB4aW1nLm5ldAovLyBAY29ubmVjdCAgICAgaS1mLnB4aW1nLm5ldAovLyBAY29ubmVjdCAgICAgaS1jZi5weGltZy5uZXQKLy8gQGxpY2Vuc2UgICAgIEdQTC0zLjAKLy8gQHN1cHBvcnRVUkwgIGh0dHBzOi8vZ2l0aHViLmNvbS9BaGFvY2hhbi9UYW1wZXJtb25rZXkKLy8gQGdyYW50ICAgICAgIHVuc2FmZVdpbmRvdwovLyBAZ3JhbnQgICAgICAgR00ueG1sSHR0cFJlcXVlc3QKLy8gQGdyYW50ICAgICAgIEdNLnNldENsaXBib2FyZAovLyBAZ3JhbnQgICAgICAgR00uc2V0VmFsdWUKLy8gQGdyYW50ICAgICAgIEdNLmdldFZhbHVlCi8vIEBncmFudCAgICAgICBHTV9hZGRTdHlsZQovLyBAZ3JhbnQgICAgICAgR01feG1saHR0cFJlcXVlc3QKLy8gQGdyYW50ICAgICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQKLy8gQGdyYW50ICAgICAgIEdNX3VucmVnaXN0ZXJNZW51Q29tbWFuZAovLyBAZ3JhbnQgICAgICAgR01fc2V0Q2xpcGJvYXJkCi8vIEBncmFudCAgICAgICBHTV9zZXRWYWx1ZQovLyBAZ3JhbnQgICAgICAgR01fZ2V0VmFsdWUKLy8gQHJlcXVpcmUgICAgIGh0dHBzOi8vdXBkYXRlLmdyZWFzeWZvcmsub3JnL3NjcmlwdHMvNTA1MzUxLzE0MzU0MjAvanF1ZXJ5JTIwMjIxLmpzCi8vIEByZXF1aXJlICAgICBodHRwczovL3VwZGF0ZS5ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzUxODYzMi8xNDg5ODY1L2pzemlwLW1pbi1qcy5qcwovLyBAcmVxdWlyZSAgICAgaHR0cHM6Ly91cGRhdGUuZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy80OTg3NDYvMTM5OTY2OC9GaWxlU2F2ZXIuanMKLy8gQHJlcXVpcmUgICAgIGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy8yOTYzLWdpZi1qcy9jb2RlL2dpZmpzLmpzP3ZlcnNpb249ODU5NgovLyBAcmVxdWlyZSAgICAgaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzM3NTM1OS1nbTQtcG9seWZpbGwtMS0wLTEvY29kZS9nbTQtcG9seWZpbGwtMTAxLmpzP3ZlcnNpb249NjUyMjM4Ci8vIEBydW4tYXQgICAgICBkb2N1bWVudC1lbmQKLy8gQG5vZnJhbWVzCi8vIEBkb3dubG9hZFVSTCBodHRwczovL3VwZGF0ZS5ncmVhc3lmb3JrLm9yZy9zY3JpcHRzLzM0MTUzL1BpeGl2JTIwUGx1cy51c2VyLmpzCi8vIEB1cGRhdGVVUkwgaHR0cHM6Ly91cGRhdGUuZ3JlYXN5Zm9yay5vcmcvc2NyaXB0cy8zNDE1My9QaXhpdiUyMFBsdXMubWV0YS5qcwovLyA9PS9Vc2VyU2NyaXB0PT0KalF1ZXJ5KCQgPT4gewogICAgJ3VzZSBzdHJpY3QnOwogICAgLy8g5Yqg6L295L6d6LWWCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09IGpRdWVyeeaPkuS7tiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICQuZm4uZXh0ZW5kKHsKICAgICAgICBmaXRXaW5kb3coKSB7CiAgICAgICAgICAgIHRoaXMuY3NzKCd3aWR0aCcsICdhdXRvJykuY3NzKCdoZWlnaHQnLCAnYXV0bycpCiAgICAgICAgICAgICAgICAuY3NzKCdtYXgtd2lkdGgnLCAnJykuY3NzKCdtYXgtaGVpZ2h0JywgJCh3aW5kb3cpLmhlaWdodCgpKTsKICAgICAgICB9LAogICAgICAgIHJlcGxhY2VUYWdOYW1lKHJlcGxhY2VXaXRoKSB7CiAgICAgICAgICAgIGNvbnN0IHRhZ3MgPSBbXTsKICAgICAgICAgICAgbGV0IGkgPSB0aGlzLmxlbmd0aDsKICAgICAgICAgICAgd2hpbGUgKGktLSkgewogICAgICAgICAgICAgICAgY29uc3QgbmV3RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQocmVwbGFjZVdpdGgpOwogICAgICAgICAgICAgICAgY29uc3QgdGhpc2kgPSB0aGlzW2ldOwogICAgICAgICAgICAgICAgY29uc3QgdGhpc2lhID0gdGhpc2kuYXR0cmlidXRlczsKICAgICAgICAgICAgICAgIGZvciAobGV0IGEgPSB0aGlzaWEubGVuZ3RoIC0gMTsgYSA+PSAwOyBhLS0pIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBhdHRyaWIgPSB0aGlzaWFbYV07CiAgICAgICAgICAgICAgICAgICAgbmV3RWxlbWVudC5zZXRBdHRyaWJ1dGUoYXR0cmliLm5hbWUsIGF0dHJpYi52YWx1ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBuZXdFbGVtZW50LmlubmVySFRNTCA9IHRoaXNpLmlubmVySFRNTDsKICAgICAgICAgICAgICAgICQodGhpc2kpLmFmdGVyKG5ld0VsZW1lbnQpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgdGFnc1tpXSA9IG5ld0VsZW1lbnQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICQodGFncyk7CiAgICAgICAgfSwKICAgICAgICBnZXRCYWNrZ3JvdW5kVXJsKCkgewogICAgICAgICAgICBjb25zdCBpbWdVcmxzID0gW107CiAgICAgICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIHtzdHlsZX0pIHsKICAgICAgICAgICAgICAgIGxldCBiZ1VybCA9ICQodGhpcykuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJykgfHwgc3R5bGUuYmFja2dyb3VuZEltYWdlIHx8ICd1cmwoIiIpJzsKICAgICAgICAgICAgICAgIGNvbnN0IG1hdGNoQXJyID0gYmdVcmwubWF0Y2goL3VybFwoKFsnIl0pKC4qPylcMVwpLyk7CiAgICAgICAgICAgICAgICBiZ1VybCA9IG1hdGNoQXJyICYmIG1hdGNoQXJyLmxlbmd0aCA+PSAyID8gbWF0Y2hBcnJbMl0gOiAnJzsKICAgICAgICAgICAgICAgIGltZ1VybHMucHVzaChiZ1VybCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gaW1nVXJscy5sZW5ndGggPT09IDEgPyBpbWdVcmxzWzBdIDogaW1nVXJsczsKICAgICAgICB9LAogICAgICAgIC8vIFRPRE8g5oq95Y+W5YWs5YWx55qEYWhhby1kb25l5pa55rOVCiAgICB9KTsKCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09IGkxOG4g5Zu96ZmF5YyWID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIGNvbnN0IGkxOG5MaWIgPSB7CiAgICAgICAgamE6IHsKICAgICAgICAgICAgYXV0aG9yOiAn5L2c6ICFJywKICAgICAgICAgICAgYmFja2dyb3VuZDogJ+iDjOaZr+eUu+WDjycsCiAgICAgICAgICAgIGJhY2tncm91bmRfbm90X2ZvdW5kOiAn6IOM5pmv55S75YOP44Gq44GXJywKICAgICAgICAgICAgY29weV90b19jbGlwYm9hcmQ6ICfjgq/jg6rjg4Pjg5fjg5zjg7zjg4njgavjgrPjg5Tjg7zjgZfjgb7jgZfjgZ8nLAogICAgICAgICAgICBkb3dubG9hZDogJ+ODgOOCpuODs+ODreODvOODiScsCiAgICAgICAgICAgIGRvd25sb2FkX3dhaXQ6ICfjg4Djgqbjg7Pjg63jg7zjg4nlrozkuobjgpLjgYrlvoXjgaHjgY/jgaDjgZXjgYQnLAogICAgICAgICAgICBpbGxlZ2FsOiAn6YGV5rOVJywKICAgICAgICAgICAgaWxsdXN0X3R5cGVfc2luZ2xlOiAnW+WNmOaeml0nLAogICAgICAgICAgICBpbGx1c3RfdHlwZV9tdWx0aXBsZTogJ1vopIfmlbDmnppdJywKICAgICAgICAgICAgaWxsdXN0X3R5cGVfZ2lmOiAnW0dJRueUu+WDj10nLAogICAgICAgICAgICBsb2dpbldhcm5pbmc6ICdQaXhpduaLoeW8teOCueOCr+ODquODl+ODiOitpuWRiu+8geOCiOOCiuiJr+OBhOS9k+mok+OBruOBn+OCgeOBq1BpeGl244Gr44Ot44Kw44Kk44Oz44GX44Gm44GP44Gg44GV44GE77yB5pyq44Ot44Kw44Kk44Oz44Gu5aC05ZCI44CB5LqI5pyf44GX44Gq44GE44OQ44Kw44GM55m655Sf44GZ44KL5Y+v6IO95oCn44GM44GC44KK44G+44GZ77yBJywKICAgICAgICAgICAgc3dpdGNoX2FudGlBZDogJ+W6g+WRiueEoeWKueWMlicsCiAgICAgICAgICAgIHN3aXRjaF9hbnRpUmVkaXJlY3Q6ICfjg6rjg4DjgqTjg6zjgq/jg4jop6PpmaQnLAogICAgICAgICAgICBzd2l0Y2hfY29tbWVudExvYWQ6ICfjgrPjg6Hjg7Pjg4joqq3jgb/ovrzjgb8nLAogICAgICAgICAgICBzd2l0Y2hfaW1hZ2VTaXplOiAn55S75YOP44K144Kk44K66KGo56S6JywKICAgICAgICAgICAgc3dpdGNoX3ByZURvd25sb2FkOiAn55S75YOP44KS5LqL5YmN44OA44Km44Oz44Ot44O844OJJywKICAgICAgICAgICAgc3dpdGNoX3NlYXJjaFVpZDogJ1VJROaknOe0oicsCiAgICAgICAgICAgIHN3aXRjaF9zZWFyY2hQaWQ6ICdQSUTmpJzntKInLAogICAgICAgICAgICBzd2l0Y2hfc2VhcmNoQXV0aG9yOiAn5L2c6ICF5qSc57SiJywKICAgICAgICAgICAgc3dpdGNoX3NlYXJjaEZhdm91cml0ZTogJ3VzZXJz5YWl44KK5qSc57SiJwogICAgICAgIH0sCiAgICAgICAgZW46IHsKICAgICAgICAgICAgYXV0aG9yOiAnQXV0aG9yJywKICAgICAgICAgICAgYmFja2dyb3VuZDogJ0JhY2tncm91bmQgSW1hZ2UnLAogICAgICAgICAgICBiYWNrZ3JvdW5kX25vdF9mb3VuZDogJ05vIEJhY2tncm91bmQgSW1hZ2UnLAogICAgICAgICAgICBjb3B5X3RvX2NsaXBib2FyZDogJ0NvcGllZCB0byBjbGlwYm9hcmQnLAogICAgICAgICAgICBkb3dubG9hZDogJ0Rvd25sb2FkJywKICAgICAgICAgICAgZG93bmxvYWRfd2FpdDogJ1BsZWFzZSB3YWl0IGZvciBkb3dubG9hZCB0byBjb21wbGV0ZScsCiAgICAgICAgICAgIGlsbGVnYWw6ICdJbGxlZ2FsJywKICAgICAgICAgICAgaWxsdXN0X3R5cGVfc2luZ2xlOiAnW1NpbmdsZSBJbWFnZV0nLAogICAgICAgICAgICBpbGx1c3RfdHlwZV9tdWx0aXBsZTogJ1tNdWx0aXBsZSBJbWFnZXNdJywKICAgICAgICAgICAgaWxsdXN0X3R5cGVfZ2lmOiAnW0dJRiBJbWFnZV0nLAogICAgICAgICAgICBsb2dpbldhcm5pbmc6ICdQaXhpdiBQbHVzIFNjcmlwdCBXYXJuaW5nISBQbGVhc2UgbG9naW4gdG8gUGl4aXYgZm9yIGEgYmV0dGVyIGV4cGVyaWVuY2UhIEZhaWx1cmUgdG8gbG9naW4gbWF5IHJlc3VsdCBpbiB1bnByZWRpY3RhYmxlIGJ1Z3MhJywKICAgICAgICAgICAgc3dpdGNoX2FudGlBZDogJ0Rpc2FibGUgQWRzJywKICAgICAgICAgICAgc3dpdGNoX2FudGlSZWRpcmVjdDogJ0NhbmNlbCBSZWRpcmVjdGlvbicsCiAgICAgICAgICAgIHN3aXRjaF9jb21tZW50TG9hZDogJ0xvYWQgQ29tbWVudHMnLAogICAgICAgICAgICBzd2l0Y2hfaW1hZ2VTaXplOiAnU2hvdyBJbWFnZSBTaXplJywKICAgICAgICAgICAgc3dpdGNoX3ByZURvd25sb2FkOiAnUHJlLWRvd25sb2FkIEltYWdlcycsCiAgICAgICAgICAgIHN3aXRjaF9zZWFyY2hVaWQ6ICdTZWFyY2ggVUlEJywKICAgICAgICAgICAgc3dpdGNoX3NlYXJjaFBpZDogJ1NlYXJjaCBQSUQnLAogICAgICAgICAgICBzd2l0Y2hfc2VhcmNoQXV0aG9yOiAnU2VhcmNoIEF1dGhvcicsCiAgICAgICAgICAgIHN3aXRjaF9zZWFyY2hGYXZvdXJpdGU6ICdTZWFyY2ggdXNlcnPlhaXjgoogKHVzZXIgYm9va21hcmtzKScsCiAgICAgICAgfSwKICAgICAgICB6aDogewogICAgICAgICAgICBhdXRob3I6ICfkvZzogIUnLAogICAgICAgICAgICBiYWNrZ3JvdW5kOiAn6IOM5pmv5Zu+JywKICAgICAgICAgICAgYmFja2dyb3VuZF9ub3RfZm91bmQ6ICfml6Dog4zmma/lm74nLAogICAgICAgICAgICBjb3B5X3RvX2NsaXBib2FyZDogJ+W3suWkjeWItuWIsOWJqui0tOadvycsCiAgICAgICAgICAgIGRvd25sb2FkOiAn5LiL6L29JywKICAgICAgICAgICAgZG93bmxvYWRfd2FpdDogJ+ivt+etieW+heS4i+i9veWujOaIkCcsCiAgICAgICAgICAgIGlsbGVnYWw6ICfkuI3lkIjms5UnLAogICAgICAgICAgICBpbGx1c3RfdHlwZV9zaW5nbGU6ICdb5Y2V5Zu+XScsCiAgICAgICAgICAgIGlsbHVzdF90eXBlX211bHRpcGxlOiAnW+WkmuWbvl0nLAogICAgICAgICAgICBpbGx1c3RfdHlwZV9naWY6ICdbZ2lm5Zu+XScsCiAgICAgICAgICAgIGxvZ2luV2FybmluZzogJ1BpeGl25aKe5by6IOiEmuacrOitpuWRiiEg6K+355m75b2VUGl4aXbojrflvpfmm7Tlpb3nmoTkvZPpqowhIOacqueZu+W9leWPr+iDveS6p+eUn+S4jeWPr+mihOaWmeeahGJ1ZyEnLAogICAgICAgICAgICBzd2l0Y2hfYW50aUFkOiAn56aB55So5bm/5ZGKJywKICAgICAgICAgICAgc3dpdGNoX2FudGlSZWRpcmVjdDogJ+WPlua2iOmHjeWumuWQkScsCiAgICAgICAgICAgIHN3aXRjaF9jb21tZW50TG9hZDogJ+WKoOi9veivhOiuuicsCiAgICAgICAgICAgIHN3aXRjaF9pbWFnZVNpemU6ICfmmL7npLrlm77niYflsLrlr7gnLAogICAgICAgICAgICBzd2l0Y2hfcHJlRG93bmxvYWQ6ICfpooTkuIvovb3lm77niYcnLAogICAgICAgICAgICBzd2l0Y2hfc2VhcmNoVWlkOiAn5pCc57SidWlkJywKICAgICAgICAgICAgc3dpdGNoX3NlYXJjaFBpZDogJ+aQnOe0onBpZCcsCiAgICAgICAgICAgIHN3aXRjaF9zZWFyY2hBdXRob3I6ICfmkJzntKLkvZzogIUnLAogICAgICAgICAgICBzd2l0Y2hfc2VhcmNoRmF2b3VyaXRlOiAn5pCc57SidXNlcnPlhaXjgoonLAogICAgICAgIH0sCiAgICAgICAgJ3poLWNuJzoge30sCiAgICAgICAgJ3poLXR3JzogewogICAgICAgICAgICBhdXRob3I6ICfkvZzogIUnLAogICAgICAgICAgICBiYWNrZ3JvdW5kOiAn6IOM5pmv5ZyWJywKICAgICAgICAgICAgYmFja2dyb3VuZF9ub3RfZm91bmQ6ICfnhKHog4zmma/lnJYnLAogICAgICAgICAgICBjb3B5X3RvX2NsaXBib2FyZDogJ+W3suikh+ijveWIsOWJquiyvOewvycsCiAgICAgICAgICAgIGRvd25sb2FkOiAn5LiL6LyJJywKICAgICAgICAgICAgZG93bmxvYWRfd2FpdDogJ+iri+etieW+heS4i+i8ieWujOaIkCcsCiAgICAgICAgICAgIGlsbGVnYWw6ICfkuI3lkIjms5UnLAogICAgICAgICAgICBpbGx1c3RfdHlwZV9zaW5nbGU6ICdb5Zau5ZyWXScsCiAgICAgICAgICAgIGlsbHVzdF90eXBlX211bHRpcGxlOiAnW+WkmuWcll0nLAogICAgICAgICAgICBpbGx1c3RfdHlwZV9naWY6ICdbZ2lm5ZyWXScsCiAgICAgICAgICAgIGxvZ2luV2FybmluZzogJ1BpeGl25aKe5by3IOiFs+acrOitpuWRiiEg6KuL55m75YWlUGl4aXbnjbLlvpfmm7Tlpb3nmoTpq5TpqZchIOacqueZu+WFpeWPr+iDveeUoueUn+S4jeWPr+mgkOaWmeeahGJ1ZyEnLAogICAgICAgICAgICBzd2l0Y2hfYW50aUFkOiAn56aB55So5buj5ZGKJywKICAgICAgICAgICAgc3dpdGNoX2FudGlSZWRpcmVjdDogJ+WPlua2iOmHjeWumuWQkScsCiAgICAgICAgICAgIHN3aXRjaF9jb21tZW50TG9hZDogJ+i8ieWFpeipleirlicsCiAgICAgICAgICAgIHN3aXRjaF9pbWFnZVNpemU6ICfpoa/npLrlnJbniYflsLrlr7gnLAogICAgICAgICAgICBzd2l0Y2hfcHJlRG93bmxvYWQ6ICfpoJDkuIvovInlnJbniYcnLAogICAgICAgICAgICBzd2l0Y2hfc2VhcmNoVWlkOiAn5pCc5bCLdWlkJywKICAgICAgICAgICAgc3dpdGNoX3NlYXJjaFBpZDogJ+aQnOWwi3BpZCcsCiAgICAgICAgICAgIHN3aXRjaF9zZWFyY2hBdXRob3I6ICfmkJzlsIvkvZzogIUnLAogICAgICAgICAgICBzd2l0Y2hfc2VhcmNoRmF2b3VyaXRlOiAn5pCc5bCLdXNlcnPlhaXjgoonCiAgICAgICAgfQogICAgfTsKICAgIGkxOG5MaWJbJ3poLWNuJ10gPSBPYmplY3QuYXNzaWduKHt9LCBpMThuTGliLnpoKTsKICAgIGNvbnN0IGxhbmcgPSAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnbGFuZycpIHx8ICdlbicpLnRvTG93ZXJDYXNlKCk7CiAgICBjb25zdCBpMThuID0ga2V5ID0+IGkxOG5MaWJbbGFuZ11ba2V5XSB8fCBgaTE4blske2xhbmd9XVske2tleX1dIG5vdCBmb3VuZGA7CiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09IGkxOG4g5Zu96ZmF5YyWID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09IOWFqOWxgOWPguaVsCA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIGNvbnN0IGRlYnVnID0gdHJ1ZTsKICAgIGNvbnN0IFtsb2csIGVycm9yXSA9IFtkZWJ1ZyA/IGNvbnNvbGUubG9nIDogKCkgPT4gewogICAgfSwgY29uc29sZS5lcnJvcl07CgogICAgY29uc3QgZmVhdHVyZXMgPSB7CiAgICAgICAgYW50aUFkOiB7dHlwZTogJ2NoZWNrYm94J30sCiAgICAgICAgYW50aVJlZGlyZWN0OiB7dHlwZTogJ2NoZWNrYm94J30sCiAgICAgICAgY29tbWVudExvYWQ6IHt0eXBlOiAnY2hlY2tib3gnfSwKICAgICAgICBpbWFnZVNpemU6IHt0eXBlOiAnY2hlY2tib3gnfSwKICAgICAgICBwcmVEb3dubG9hZDoge3R5cGU6ICdjaGVja2JveCd9LAogICAgICAgIHNlYXJjaFVpZDoge3R5cGU6ICdjaGVja2JveCd9LAogICAgICAgIHNlYXJjaFBpZDoge3R5cGU6ICdjaGVja2JveCd9LAogICAgICAgIHNlYXJjaEF1dGhvcjoge3R5cGU6ICdjaGVja2JveCd9LAogICAgICAgIHNlYXJjaEZhdm91cml0ZToge3R5cGU6ICdjaGVja2JveCd9LAogICAgfTsKICAgIGxldCB1c2VyID0ge307CiAgICBjb25zdCB1c2VyQXBpID0gKHVzZXJJZCkgPT4gewogICAgICAgIGlmICghdXNlciB8fCBTdHJpbmcodXNlci51c2VySWQpICE9PSBTdHJpbmcodXNlcklkKSkgewogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdXJsOiBgL2FqYXgvdXNlci8ke3VzZXJJZH1gLAogICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJywKICAgICAgICAgICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICh7Ym9keX0pID0+IHsKICAgICAgICAgICAgICAgICAgICB1c2VyID0gYm9keTsKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdXNlcjsKICAgIH0KICAgIGxldCBpbGx1c3QgPSB7fTsKICAgIGNvbnN0IGlsbHVzdEFwaSA9ICgpID0+IHsKICAgICAgICBjb25zdCB1cmxJbGx1c3RJZCA9IGxvY2F0aW9uLmhyZWYubWF0Y2goL2FydHdvcmtzXC8oXGQqKSgjXGQqKT8kLyk/LlsxXSB8fCAnJzsKICAgICAgICAvLyAxLiDliKTmlq3mmK/lkKblt7LmnInkvZzlk4FpZCjlhbzlrrnmjInlt6blj7PmlrnlkJHplK7nv7vpobXnmoTmg4XlhrUpCiAgICAgICAgaWYgKCFpbGx1c3QgfHwgU3RyaW5nKGlsbHVzdD8uaWxsdXN0SWQpICE9PSBTdHJpbmcodXJsSWxsdXN0SWQpKSB7CiAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICB1cmw6IGAvYWpheC9pbGx1c3QvJHt1cmxJbGx1c3RJZH1gLAogICAgICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJywKICAgICAgICAgICAgICAgIGFzeW5jOiBmYWxzZSwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICh7Ym9keX0pID0+IHsKICAgICAgICAgICAgICAgICAgICBpbGx1c3QgPSBib2R5OwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBpbGx1c3Q7CiAgICB9OwogICAgY29uc3Qgb2JzZXJ2ZXJGYWN0b3J5ID0gZnVuY3Rpb24gKG9wdGlvbikgewogICAgICAgIC8vIOWIneWni+WMliBNdXRhdGlvbk9ic2VydmVyIOaJgOmcgOWPguaVsAogICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9NdXRhdGlvbk9ic2VydmVyCiAgICAgICAgY29uc3QgZGVmYXVsdHMgPSB7CiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG5vZGU6IGRvY3VtZW50LmJvZHksCiAgICAgICAgICAgIG9wdGlvbjoge2NoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZX0KICAgICAgICB9OwogICAgICAgIGxldCBvcHRpb25zOwogICAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIG9wdGlvbnMgPSB7Li4uZGVmYXVsdHMsIGNhbGxiYWNrOiBvcHRpb259OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0cywgb3B0aW9uKTsKICAgICAgICAgICAgLy8g56Gu5L+d5pyA57uIIG5vZGUg5YC85Li65pyJ5pWIIERPTSDoioLngrkKICAgICAgICAgICAgb3B0aW9ucy5ub2RlID0gb3B0aW9ucy5ub2RlIHx8IGRvY3VtZW50LmJvZHk7IC8vIFRPRE8g5oCn6IO95LyY5YyW77yM5pyA5bCR6ZmQ5bqm55uR5ZCs6IqC54K5CiAgICAgICAgfQogICAgICAgIGNvbnN0IE11dGF0aW9uT2JzZXJ2ZXIgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuTW96TXV0YXRpb25PYnNlcnZlcjsKCiAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zLCBvYnNlcnZlcikgPT4gewogICAgICAgICAgICBvcHRpb25zLmNhbGxiYWNrLmNhbGwodGhpcywgbXV0YXRpb25zLCBvYnNlcnZlcik7CiAgICAgICAgICAgIC8vIEdNLmdldFZhbHVlKCdNTycsIHRydWUpLnRoZW4oZnVuY3Rpb24gKHYpIHsgaWYoIXYpIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTsgfSk7CiAgICAgICAgfSk7CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIG9ic2VydmVyLm9ic2VydmUob3B0aW9ucy5ub2RlLCBvcHRpb25zLm9wdGlvbik7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdNdXRhdGlvbk9ic2VydmVyIOWIneWni+WMluWksei0pTonLCBlKTsKICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdXRhdGlvbk9ic2VydmVyIOWIneWni+WMluWksei0pScpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gb2JzZXJ2ZXI7CiAgICB9OwoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT0g6YWN572u5L+h5oGvID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgY29uc3QgR01rZXlzID0gewogICAgICAgIGRvd25sb2FkTmFtZTogJ2Rvd25sb2FkLW5hbWUnLCAgLy8g5LiL6L295ZCNcGF0dGVybgogICAgfTsKCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09IHVybCDpobXpnaLliKTmlq0gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICBjb25zdCBpc0FydHdvcmtQYWdlID0gKCkgPT4gLy4rYXJ0d29ya3NcL1xkKy4qLy50ZXN0KGxvY2F0aW9uLmhyZWYpOwogICAgY29uc3QgaXNNZW1iZXJJbmRleFBhZ2UgPSAoKSA9PiAvLitcL3VzZXJzXC9cZCsuKi8udGVzdChsb2NhdGlvbi5ocmVmKTsKICAgIGNvbnN0IGlzTWVtYmVySWxsdXN0UGFnZSA9ICgpID0+IC8uK1wvbWVtYmVyX2lsbHVzdFwucGhwXD9pZD1cZCsvLnRlc3QobG9jYXRpb24uaHJlZik7CiAgICBjb25zdCBpc01lbWJlckJvb2ttYXJrUGFnZSA9ICgpID0+IC8uK1wvYm9va21hcmtcLnBocFw/aWQ9XGQrLy50ZXN0KGxvY2F0aW9uLmhyZWYpOwogICAgY29uc3QgaXNNZW1iZXJGcmllbmRQYWdlID0gKCkgPT4gLy4rXC9teXBpeGl2X2FsbFwucGhwXD9pZD1cZCsvLnRlc3QobG9jYXRpb24uaHJlZik7CiAgICBjb25zdCBpc1N0YWNjUGFnZSA9ICgpID0+IC8uK1wvc3RhY2MuKy8udGVzdChsb2NhdGlvbi5ocmVmKTsKICAgIGNvbnN0IGlzTWVtYmVyUGFnZSA9ICgpID0+IGlzTWVtYmVySW5kZXhQYWdlKCkgfHwgaXNNZW1iZXJJbGx1c3RQYWdlKCkgfHwgaXNNZW1iZXJCb29rbWFya1BhZ2UoKSB8fCBpc01lbWJlckZyaWVuZFBhZ2UoKTsKICAgIGNvbnN0IGlzU2VhcmNoUGFnZSA9ICgpID0+IC8uK1wvc2VhcmNoXC5waHAuKi8udGVzdChsb2NhdGlvbi5ocmVmKSB8fCAvLitcL3RhZ3NcLy4qXC9hcnR3b3Jrcy4qLy50ZXN0KGxvY2F0aW9uLmhyZWYpOwogICAgY29uc3QgaXNNb3JlTW9kZSA9ICgpID0+IGlsbHVzdEFwaSgpLnBhZ2VDb3VudCA+IDE7CiAgICBjb25zdCBpc0dpZk1vZGUgPSAoKSA9PiBpbGx1c3RBcGkoKS5pbGx1c3RUeXBlID09PSAyOwogICAgY29uc3QgaXNTaW5nbGVNb2RlID0gKCkgPT4gKGlsbHVzdEFwaSgpLmlsbHVzdFR5cGUgPT09IDAgfHwgaWxsdXN0QXBpKCkuaWxsdXN0VHlwZSA9PT0gMSkgJiYgaWxsdXN0QXBpKCkucGFnZUNvdW50ID09PSAxOwoKICAgIC8vIDAuIOWIpOaWreaYr+WQpueZu+W9lQogICAgY29uc3QgaXNMb2dpbiA9ICgpID0+IHsKICAgICAgICBsZXQgc3RhdHVzID0gMDsKICAgICAgICAkLmFqYXgoe3VybDogJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC9zZXR0aW5nX3VzZXIucGhwJywgYXN5bmM6IGZhbHNlfSkKICAgICAgICAgICAgLmRvbmUoKGRhdGEsIHN0YXR1c1RleHQsIHhocikgPT4gc3RhdHVzID0geGhyLnN0YXR1cyk7CiAgICAgICAgcmV0dXJuIHN0YXR1cyA9PT0gMjAwOwogICAgfTsKICAgIGlmICghaXNMb2dpbigpKSB7CiAgICAgICAgYWxlcnQoaTE4bignbG9naW5XYXJuaW5nJykpOwogICAgfQoKICAgIC8vIDEuIOWxj+iUveW5v+WRiiwg5YWo5bGA6L+b6KGMY3Nz5aSE55CGCiAgICBjb25zdCBhZERpc2FibGUgPSAoKSA9PiB7CiAgICAgICAgLy8gMS4g5Yig6Zmk6Z2Z5oCB5re75Yqg55qE5bm/5ZGKCiAgICAgICAgJCgnLmFkJykucmVtb3ZlKCk7CiAgICAgICAgJCgnLl9wcmVtaXVtLWxlYWQtdGFnLXNlYXJjaC1iYXInKS5oaWRlKCk7CiAgICAgICAgJCgnLnBvcHVsYXItaW50cm9kdWN0aW9uLW92ZXJsYXknKS5oaWRlKCk7Ly8g56e76Zmk54Ot6Zeo5Zu+54mH6YGu572p5bGCCiAgICAgICAgJCgnLmFkLWZvb3RlcicpLnJlbW92ZSgpOy8v56e76Zmk6aG16ISa5bm/5ZGKCgogICAgICAgIC8vIDIuIOWIoOmZpOWKqOaAgea3u+WKoOeahOW5v+WRigogICAgICAgIGNvbnN0IGFkU2VsZWN0b3JzID0gWydpZnJhbWUnLCAnLl9wcmVtaXVtLWxlYWQtcHJvbW90aW9uLWJhbm5lcicsCiAgICAgICAgICAgICdhW2hyZWY9Ii9wcmVtaXVtL2xlYWQvbHAvP2c9YW5jaG9yJmk9cG9wdWxhcl93b3Jrc19saXN0JnA9cG9wdWxhciZwYWdlPXZpc2l0b3IiXScsIC8vIGh0dHBzOi8vd3d3LnBpeGl2Lm5ldC90YWdzLyVFNiU5RCVCMSVFNiU5NiVCOS9hcnR3b3Jrcz9zX21vZGU9c190YWcg54Ot6Zeo5L2c5ZOBCiAgICAgICAgICAgICdhW2hyZWY9Ii9wcmVtaXVtL2xlYWQvbHAvP2c9YW5jaG9yJmk9d29ya19kZXRhaWxfcmVtb3ZlX2FkcyJdJwogICAgICAgIF07CiAgICAgICAgcmV0dXJuIG9ic2VydmVyRmFjdG9yeSgobXV0YXRpb25zLCBvYnNlcnZlcikgPT4gewogICAgICAgICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykgewogICAgICAgICAgICAgICAgZm9yIChjb25zdCBhZGRlZE5vZGUgb2YgbXV0YXRpb24uYWRkZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgIGlmIChhZGRlZE5vZGUubm9kZVR5cGUgPT09IE5vZGUuRUxFTUVOVF9OT0RFKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qgc2VsZWN0b3Igb2YgYWRTZWxlY3RvcnMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoYWRkZWROb2RlKS5maW5kKHNlbGVjdG9yKS5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH07CgogICAgLy8gMi4g5pCc57Si5aKe5by6CiAgICBjb25zdCBzZWFyY2hFbmhhbmNlID0gKCkgPT4gewogICAgICAgIC8vIDEuIOaJvuWIsOWfuuehgOeahGZvcm3ooajljZUKICAgICAgICBsb2coIuaQnOe0ouWinuW8uiDliJ3lp4vljJYiKTsKICAgICAgICBsZXQgJGZvcm0gPSAkKCdmb3JtOm5vdChbYWN0aW9uXSkgPiBkaXYuY2hhcmNvYWwtdGV4dC1maWVsZC1yb290JykucGFyZW50KCdmb3JtJyk7CiAgICAgICAgaWYgKCEkZm9ybS5sZW5ndGgpIHsKICAgICAgICAgICAgLy8g5paw54mI5pys55qEIFBpeGl2IOaQnOe0ouagj+ihqOWNleS4jeWtmOWcqO+8jOafpeaJvuaXp+eJiOacrOeahCBQaXhpdiDmkJzntKLmoI/ooajljZUKICAgICAgICAgICAgJGZvcm0gPSAkKCcjanMtbW91bnQtcG9pbnQtaGVhZGVyIGZvcm06bm90KFthY3Rpb25dKSwgI3Jvb3QgZGl2W3N0eWxlPSJwb3NpdGlvbjogc3RhdGljOyB6LWluZGV4OiBhdXRvOyJdIGZvcm06bm90KFthY3Rpb25dKScpOwogICAgICAgIH0KCiAgICAgICAgLy8gMi4g5L+u5pS554i257qnZ3JpZOW4g+WxgAogICAgICAgIC8vIDIuMSDmn6Xmib7mlrDniYjmnKznmoTooajljZXmlbDph4/lubbov5vooYzliKTmlq3lvZPliY3pobXpnaLmmK/lkKbkuLrmlrAgVUkg5pCc57Si5qCP6KGo5Y2VCiAgICAgICAgY29uc3QgaXNOZXdWZXJzaW9uID0gJGZvcm0uZmluZCgnZGl2LmNoYXJjb2FsLXRleHQtZmllbGQtcm9vdCcpLmxlbmd0aCA+IDA7CiAgICAgICAgLy8gMi4yIOagueaNruS4iumdoueahOWIpOaWreadpeW6lOeUqOWTquWll+W4g+WxgO+8muecn++8jOi1sOmAgumFjeaWsOeJiOacrOagt+W8j+OAguWBh++8jOi1sOmAgumFjeiAgeeJiOacrOagt+W8jwogICAgICAgIGlmIChpc05ld1ZlcnNpb24pIHsKICAgICAgICAgICAgJGZvcm0ucGFyZW50KCkucGFyZW50KCkuY3NzKHsgJ2dyaWQtdGVtcGxhdGUtY29sdW1ucyc6ICcxZnIgMWZyIDFmciAxZnIgMWZyIDFmciAxZnInLCAnZ2FwJzogJzEwcHgnIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRmb3JtLnBhcmVudCgpLnBhcmVudCgpLmNzcygnZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zJywgJzFmciBtaW5tYXgoMHB4LCAyMTlweCkgbWlubWF4KDBweCwgMjE5cHgpIG1pbm1heCgwcHgsIDUzOHB4KSBtaW5tYXgoMHB4LCA1MzhweCkgbWlubWF4KDBweCwgMjE5cHgpIDJmcicpOwogICAgICAgIH0KICAgICAgICAkZm9ybS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKS5jc3MoJ2dyaWQtdGVtcGxhdGUtY29sdW1ucycsICcxZnIgMmZyIDFmcicpOwoKICAgICAgICAvLyAzLiDmkJzntKJVSUTvvIxQSUTlkozkvZzogIUKICAgICAgICBjb25zdCBpbml0U2VhcmNoID0gb3B0aW9uID0+IHsKICAgICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oewogICAgICAgICAgICAgICAgJGZvcm06IG51bGwsIGZpZWxkOiAn5pCc57Si5a2X5q61JywgcGxhY2Vob2xkZXI6ICfor7fovpPlhaUnLCB0ZW1wbGF0ZTogJyoqKicsIHZhbGlkTnVtYmVyOiBmYWxzZSwKICAgICAgICAgICAgfSwgb3B0aW9uKTsKICAgICAgICAgICAgaWYgKCFvcHRpb25zLiRmb3JtKSB7CiAgICAgICAgICAgICAgICBlcnJvcihg5pCc57Si57uE5Lu2WyR7b3B0aW9ucy5maWVsZH1d5Yid5aeL5YyW5aSx6LSlLCBmb3Jt5YWD57Sg6I635Y+W5aSx6LSlYCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIDEuIOWIneWni+WMluihqOWNlVVJCiAgICAgICAgICAgIGNvbnN0ICRwYXJlbnQgPSBvcHRpb25zLiRmb3JtLnBhcmVudCgpLmNsb25lKCk7CiAgICAgICAgICAgIGNvbnN0ICRmb3JtID0gJHBhcmVudC5maW5kKCdmb3JtJyk7CiAgICAgICAgICAgICRmb3JtLmNoaWxkcmVuKCdkaXYnKS5lcSgxKS5yZW1vdmUoKTsKICAgICAgICAgICAgJGZvcm0uYXR0cignY2xhc3MnLCBgYWhhby1zZWFyY2gtJHtvcHRpb25zLmZpZWxkfWApOwogICAgICAgICAgICBvcHRpb25zLiRmb3JtLnBhcmVudCgpLmJlZm9yZSgkcGFyZW50KTsKICAgICAgICAgICAgY29uc3QgJGlucHV0ID0gJGZvcm0uZmluZCgnaW5wdXRbdHlwZT0idGV4dCJdOmZpcnN0Jyk7CiAgICAgICAgICAgICRpbnB1dC5hdHRyKCdwbGFjZWhvbGRlcicsIG9wdGlvbnMucGxhY2Vob2xkZXIpOwogICAgICAgICAgICAkaW5wdXQuYXR0cigndmFsdWUnLCAnJyk7CiAgICAgICAgICAgICRpbnB1dC52YWwoJycpOwoKICAgICAgICAgICAgLy8gMi4g57uR5a6ac3VibWl05LqL5Lu2CiAgICAgICAgICAgICRmb3JtLnN1Ym1pdChlID0+IHsKICAgICAgICAgICAgICAgIC8vIOmYu+atoum7mOiupOeahOihqOWNleaPkOS6pAogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgICAgICAgIC8vIOmHjeWGmeihqOWNleaPkOS6pOmAu+i+kQogICAgICAgICAgICAgICAgY29uc3QgdmFsID0gZW5jb2RlVVJJQ29tcG9uZW50KCRpbnB1dC52YWwoKSk7CiAgICAgICAgICAgICAgICAvLyDovpPlhaXmoKHpqowKICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLnZhbGlkTnVtYmVyICYmICEvXlswLTldKyQvLnRlc3QodmFsKSkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IGxhYmVsID0gb3B0aW9ucy5wbGFjZWhvbGRlciArIGkxOG4oJ2lsbGVnYWwnKTsKICAgICAgICAgICAgICAgICAgICBhbGVydChsYWJlbCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8g5paw56qX5Y+j5omT5byAdXJsCiAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSBvcHRpb25zLnRlbXBsYXRlLnJlcGxhY2VBbGwoJyoqKicsIHZhbCk7CiAgICAgICAgICAgICAgICB3aW5kb3cub3Blbih1cmwpOwogICAgICAgICAgICAgICAgLy8g5riF56m6aW5wdXTnrYnlvoXkuIvmrKHovpPlhaUKICAgICAgICAgICAgICAgICRpbnB1dC52YWwoJycpOwogICAgICAgICAgICB9KTsKICAgICAgICB9OwogICAgICAgIGZlYXR1cmVzLnNlYXJjaFVpZC5pc0VuYWJsZSgpICYmIGluaXRTZWFyY2goeyRmb3JtLCBmaWVsZDogJ1VJRCcsIHBsYWNlaG9sZGVyOiAnVUlEJywgdGVtcGxhdGU6ICdodHRwczovL3d3dy5waXhpdi5uZXQvdXNlcnMvKioqJywgdmFsaWROdW1iZXI6IHRydWV9KTsKICAgICAgICBmZWF0dXJlcy5zZWFyY2hQaWQuaXNFbmFibGUoKSAmJiAgaW5pdFNlYXJjaCh7JGZvcm0sIGZpZWxkOiAnUElEJywgcGxhY2Vob2xkZXI6ICdQSUQnLCB0ZW1wbGF0ZTogJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC9hcnR3b3Jrcy8qKionLCB2YWxpZE51bWJlcjogdHJ1ZX0pOwogICAgICAgIC8vIFRPRE8gVUnplJnkubE6IGh0dHBzOi8vd3d3LnBpeGl2Lm5ldC9zdGFjYy9tZG5rCiAgICAgICAgZmVhdHVyZXMuc2VhcmNoQXV0aG9yLmlzRW5hYmxlKCkgJiYgaW5pdFNlYXJjaCh7JGZvcm0sIGZpZWxkOiBpMThuKCdhdXRob3InKSwgcGxhY2Vob2xkZXI6IGkxOG4oJ2F1dGhvcicpLCB0ZW1wbGF0ZTogImh0dHBzOi8vd3d3LnBpeGl2Lm5ldC9zZWFyY2hfdXNlci5waHA/bmljaz0qKiomc19tb2RlPXNfdXNyIiwgdmFsaWROdW1iZXI6IGZhbHNlfSk7CiAgICAgICAgLy8gNC4g5pCc57Si5p2h5Lu2CiAgICAgICAgaWYoZmVhdHVyZXMuc2VhcmNoRmF2b3VyaXRlLmlzRW5hYmxlKCkpIHsKICAgICAgICAgICAgY29uc3QgJGlucHV0ID0gJGZvcm0uZmluZCgnaW5wdXRbdHlwZT0idGV4dCJdOmZpcnN0Jyk7CiAgICAgICAgICAgIGNvbnN0ICRzZWxlY3QgPSAkKGAKICAgICAgICAgICAgICAgICAgICA8c2VsZWN0IGlkPSJzZWxlY3QtYWhhby1mYXZvcml0ZXMiPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIiPjwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI1MDAwMHVzZXJz5YWl44KKIj41MDAwMHVzZXJz5YWl44KKPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjMwMDAwdXNlcnPlhaXjgooiPjMwMDAwdXNlcnPlhaXjgoo8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMjAwMDB1c2Vyc+WFpeOCiiI+MjAwMDB1c2Vyc+WFpeOCijwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxMDAwMHVzZXJz5YWl44KKIj4xMDAwMHVzZXJz5YWl44KKPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjUwMDB1c2Vyc+WFpeOCiiIgPiA1MDAwdXNlcnPlhaXjgoo8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMTAwMHVzZXJz5YWl44KKIiA+IDEwMDB1c2Vyc+WFpeOCijwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI1MDB1c2Vyc+WFpeOCiiIgID4gIDUwMHVzZXJz5YWl44KKPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjMwMHVzZXJz5YWl44KKIiAgPiAgMzAwdXNlcnPlhaXjgoo8L29wdGlvbj4KICAgICAgICAgICAgICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMTAwdXNlcnPlhaXjgooiICA+ICAxMDB1c2Vyc+WFpeOCijwvb3B0aW9uPgogICAgICAgICAgICAgICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI1MHVzZXJz5YWl44KKIiAgID4gICA1MHVzZXJz5YWl44KKPC9vcHRpb24+CiAgICAgICAgICAgICAgICAgICAgPC9zZWxlY3Q+YCk7CiAgICAgICAgICAgICRzZWxlY3Qub24oJ2NoYW5nZScsICgpID0+IHsKICAgICAgICAgICAgICAgIGlmICghISRpbnB1dC52YWwoKSkgewogICAgICAgICAgICAgICAgICAgICRmb3JtLnN1Ym1pdCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgJGZvcm0ucGFyZW50KCkuYWZ0ZXIoJHNlbGVjdCk7CiAgICAgICAgICAgICRmb3JtLnN1Ym1pdChlID0+IHsKICAgICAgICAgICAgICAgIC8vIOmYu+atoum7mOiupOeahOihqOWNleaPkOS6pAogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICAgICAgICAgIC8vIOmHjeWGmeihqOWNleaPkOS6pOmAu+i+kQogICAgICAgICAgICAgICAgaWYgKCEhJHNlbGVjdC52YWwoKSkgewogICAgICAgICAgICAgICAgICAgIC8vIOWOu+mZpOaXp+eahOaQnOe0oumAiemhuQogICAgICAgICAgICAgICAgICAgICRpbnB1dC52YWwoKGluZGV4LCB2YWwpID0+IHZhbC5zcGxpdCgnICcpLmZpbHRlcigodGFnKSA9PiAhIXRhZyAmJiAhL3VzZXJz5YWl44KKJC8udGVzdCh0YWcpKS5qb2luKCcgJykpOwogICAgICAgICAgICAgICAgICAgIC8vIOa3u+WKoOaWsOeahOaQnOe0oumAiemhuQogICAgICAgICAgICAgICAgICAgICRpbnB1dC52YWwoKGluZGV4LCB2YWwpID0+IGAke3ZhbH0gJHskc2VsZWN0LnZhbCgpfWApOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBlbmNvZGVVUklDb21wb25lbnQoJGlucHV0LnZhbCgpKTsKICAgICAgICAgICAgICAgIGlmICghIXZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChsb2NhdGlvbi5ocmVmKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSB1cmwuc2VhcmNoUGFyYW1zOwogICAgICAgICAgICAgICAgICAgIHNlYXJjaFBhcmFtcy5zZXQoJ3AnLCAnMScpOwogICAgICAgICAgICAgICAgICAgIHNlYXJjaFBhcmFtcy5zZXQoJ3NfbW9kZScsICdzX3RhZycpOwogICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBgaHR0cHM6Ly93d3cucGl4aXYubmV0L3RhZ3MvJHt2YWx1ZX0vYXJ0d29ya3M/JHtzZWFyY2hQYXJhbXMudG9TdHJpbmcoKX1gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9OwoKICAgIC8vIDMuIOWNleW8oOWbvueJh+abv+aNouS4uuWOn+WbvuagvOW8jy4g6L+95Yqg5LiL6L295oyJ6ZKuLCDkuIvovb1naWblm77jgIFnaWbnmoTluKfljovnvKnljIXjgIHlpJrlm74KICAgIC8vIFRPRE8g6Kej6ICmSW1nU2l6ZeWSjOWOn+WbvuaYvuekuuWKn+iDvSBodHRwczovL3d3dy5waXhpdi5uZXQvYXJ0d29ya3MvMTEyMTY3MjE5CiAgICBjb25zdCBhZGRJbWdTaXplU3BhbiA9IChvcHRpb24pID0+IHsKICAgICAgICBpZighZmVhdHVyZXMuaW1hZ2VTaXplLmlzRW5hYmxlKCkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyDku44gJCDojrflj5blm77niYflpKflsI8sIGFmdGVyIOWIsCAkCiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oeyQ6IHVuZGVmaW5lZCwgcG9zaXRpb246ICdyZWxhdGl2ZScsfSwgb3B0aW9uKTsKICAgICAgICBjb25zdCAkaW1nID0gb3B0aW9ucy4kOwogICAgICAgIGNvbnN0IHBvc2l0aW9uID0gb3B0aW9ucy5wb3NpdGlvbjsKCiAgICAgICAgLy8gMS4g5om+5YiwIOaYvuekuuWbvueJh+Wkp+WwjyDnmoQgc3Bhbiwg5rKh5pyJ5YiZ5re75YqgCiAgICAgICAgbGV0ICRzcGFuID0gJGltZy5uZXh0KCdzcGFuJyk7CiAgICAgICAgaWYgKCRzcGFuLmxlbmd0aCA8PSAwKSB7CiAgICAgICAgICAgICRzcGFuID0gJChgPHNwYW4gY2xhc3M9ImFoYW8taW1nLXNpemUiIHN0eWxlPSJwb3NpdGlvbjogJHtwb3NpdGlvbn07IHJpZ2h0OiAwOyB0b3A6IDI4cHg7CiAgICAgICAgICAgICAgICAgICAgY29sb3I6ICNmZmZmZmY7IGZvbnQtc2l6ZTogeC1sYXJnZTsgZm9udC13ZWlnaHQ6IGJvbGQ7IC13ZWJraXQtdGV4dC1zdHJva2U6IDEuMHB4ICMwMDAwMDA7Ij48L3NwYW4+YCk7CiAgICAgICAgICAgICRpbWcuYmVmb3JlKCRzcGFuKTsKICAgICAgICB9CiAgICAgICAgLy8gMi4g5qC55o2u5qCH562+6I635Y+W5Zu+54mH5aSn5bCPLCDnm67liY3lj6rmnIkgY2FudmFzIOWSjCBpbWcg5Lik56eNCiAgICAgICAgY29uc3QgdGFnTmFtZSA9ICRpbWcucHJvcCgndGFnTmFtZScpLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgaWYgKHRhZ05hbWUgPT09ICdpbWcnKSB7CiAgICAgICAgICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpOwogICAgICAgICAgICBpbWcuc3JjID0gJGltZy5hdHRyKCdzcmMnKTsKICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICRzcGFuLnRleHQoYCR7dGhpcy53aWR0aH14JHt0aGlzLmhlaWdodH1gKTsgLy8g6YeN5paw5Yqg6L295Zu+54mHLCDku6Xojrflj5blm77niYflpKflsI8KICAgICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgaWYgKHRhZ05hbWUgPT09ICdjYW52YXMnKSB7CiAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gJGltZy5hdHRyKCd3aWR0aCcpIHx8ICRpbWcuY3NzKCd3aWR0aCcpLnJlcGxhY2UoJ3B4JywgJycpIHx8ICRpbWcuY3NzKCdtYXgtd2lkdGgnKS5yZXBsYWNlKCdweCcsICcnKSB8fCAwOwogICAgICAgICAgICBjb25zdCBoZWlnaHQgPSAkaW1nLmF0dHIoJ2hlaWdodCcpIHx8ICRpbWcuY3NzKCdoZWlnaHQnKS5yZXBsYWNlKCdweCcsICcnKSB8fCAkaW1nLmNzcygnbWF4LWhlaWdodCcpLnJlcGxhY2UoJ3B4JywgJycpIHx8IDA7CiAgICAgICAgICAgICRzcGFuLnRleHQoYCR7d2lkdGh9eCR7aGVpZ2h0fWApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICRzcGFuLnRleHQoYCR7dGFnTmFtZX3mmoLkuI3mlK/mjIHojrflj5blm77niYflpKflsI9gKTsKICAgICAgICB9CiAgICB9OwogICAgY29uc3QgYWRkSW1hZ2VEb3dubG9hZEJ0biA9IG9wdGlvbiA9PiB7CiAgICAgICAgLy8g5LiL6L295oyJ6ZKuLCDlpI3liLbliIbkuqvmjInpkq7lubbml4vovawxODDluqYKICAgICAgICBjb25zdCBvcHRpb25zID0gT2JqZWN0LmFzc2lnbih7CiAgICAgICAgICAgICRzaGFyZUJ1dHRvbkNvbnRhaW5lcjogdW5kZWZpbmVkLCBpZDogJycsIHRleHQ6ICcnLCBjbGlja0Z1bjogKCkgPT4gewogICAgICAgICAgICB9CiAgICAgICAgfSwgb3B0aW9uKTsKICAgICAgICBjb25zdCAkZG93bmxvYWRCdXR0b25Db250YWluZXIgPSBvcHRpb25zLiRzaGFyZUJ1dHRvbkNvbnRhaW5lci5jbG9uZSgpOwogICAgICAgICRkb3dubG9hZEJ1dHRvbkNvbnRhaW5lci5hZGRDbGFzcygnYWhhby1kb3dubG9hZC1idG4nKQogICAgICAgICAgICAuYXR0cignaWQnLCBvcHRpb25zLmlkKQogICAgICAgICAgICAucmVtb3ZlQ2xhc3Mob3B0aW9ucy4kc2hhcmVCdXR0b25Db250YWluZXIuYXR0cignY2xhc3MnKSkKICAgICAgICAgICAgLmNzcygnbWFyZ2luLXJpZ2h0JywgJzEwcHgnKQogICAgICAgICAgICAuY3NzKCdwb3NpdGlvbicsICdyZWxhdGl2ZScpCiAgICAgICAgICAgIC5jc3MoJ2JvcmRlcicsICcxcHggc29saWQnKQogICAgICAgICAgICAuY3NzKCdwYWRkaW5nJywgJzFweCAxMHB4JykKICAgICAgICAgICAgLmFwcGVuZChgPHAgc3R5bGU9ImRpc3BsYXk6IGlubGluZSI+JHtvcHRpb25zLnRleHR9PC9wPmApOwogICAgICAgICRkb3dubG9hZEJ1dHRvbkNvbnRhaW5lci5maW5kKCdidXR0b24nKS5jc3MoJ3RyYW5zZm9ybScsICdyb3RhdGUoMTgwZGVnKScpCiAgICAgICAgICAgIC5vbignY2xpY2snLCBvcHRpb25zLmNsaWNrRnVuKTsKICAgICAgICBvcHRpb25zLiRzaGFyZUJ1dHRvbkNvbnRhaW5lci5hZnRlcigkZG93bmxvYWRCdXR0b25Db250YWluZXIpOwogICAgICAgIHJldHVybiAkZG93bmxvYWRCdXR0b25Db250YWluZXI7CiAgICB9OwogICAgY29uc3QgZ2V0RG93bmxvYWROYW1lID0gKG5hbWUpID0+IHsKICAgICAgICBjb25zdCBpbGx1c3QgPSBpbGx1c3RBcGkoKTsKICAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKCd7cGlkfScsIGlsbHVzdC5pbGx1c3RJZCk7CiAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZSgne3VpZH0nLCBpbGx1c3QudXNlcklkKTsKICAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKCd7cG5hbWV9JywgaWxsdXN0LmlsbHVzdFRpdGxlKTsKICAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKCd7dW5hbWV9JywgaWxsdXN0LnVzZXJOYW1lKTsKICAgICAgICByZXR1cm4gbmFtZTsKICAgIH07CiAgICBjb25zdCBhcnR3b3JrT3JpZ2luYWxJbWFnZSA9ICgpID0+IHsKICAgICAgICBjb25zdCBvYnNlcnZlck9wdGlvbnMgPSB7YXR0cmlidXRlczogdHJ1ZSwgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlLCBhdHRyaWJ1dGVGaWx0ZXI6IFsnc3JjJywgJ2hyZWYnXX07CiAgICAgICAgb2JzZXJ2ZXJGYWN0b3J5KHsKICAgICAgICAgICAgY2FsbGJhY2sobXV0YXRpb25zLCBvYnNlcnZlcikgewogICAgICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGFkZGVkTm9kZSBvZiBtdXRhdGlvbi5hZGRlZE5vZGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIOWNleWbvuOAgeWkmuWbviBET00g57uT5p6E6YO95Li6IDxhIGhyZWY9IiI+PGltZy8+PC9hPgogICAgICAgICAgICAgICAgICAgICAgICBsZXQgJGltZyA9ICQoYWRkZWROb2RlKS5maWx0ZXIoJ2ltZ1tzcmNePSJodHRwczovL2kucHhpbWcubmV0L2ltZy1tYXN0ZXIiXScpOyAvLyDlpJrlm77nmoTlnLrmma8KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRpbWcubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1nID0gJChhZGRlZE5vZGUpLmZpbmQoJ2ltZ1tzcmNePSJodHRwczovL2kucHhpbWcubmV0L2ltZy1tYXN0ZXIiXScpICAgICAgIC8vIOWNleWbvueahOWcuuaZrwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICRpbWcuYXR0cignYWhhby1kb25lJywgdHJ1ZSk7IC8vIOagh+iusOWPquaJp+ihjOS4gOasoQogICAgICAgICAgICAgICAgICAgICAgICAkaW1nLmVhY2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJHRoaXMgPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaHJlZiA9ICR0aGlzLnBhcmVudCgnYScpLmF0dHIoJ2hyZWYnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGlzRXhwYW5kID0gJGltZy5wYXJlbnQoJ2EnKS5hdHRyKCdjbGFzcycpID09PSAnZ3RtLWV4cGFuZC1mdWxsLXNpemUtaWxsdXN0JzsgLy8g5aSa5Zu+5bGV5byA5qih5byP5pyJ5LiU5Y+q5pyJ5LiA5LiqY2xhc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChocmVmPy5lbmRzV2l0aCgnanBnJykgfHwgaHJlZj8uZW5kc1dpdGgoJ3BuZycpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMuYXR0cignc3JjJywgaHJlZikuY3NzKCdmaWx0ZXInLCAnbm9uZScpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmZpdFdpbmRvdygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZEltZ1NpemVTcGFuKHskOiAkdGhpcywgcG9zaXRpb246IGlzRXhwYW5kID8gJ3JlbGF0aXZlJyA6ICdhYnNvbHV0ZSd9KTsgLy8g5pi+56S65Zu+54mH5aSn5bCPCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9uOiBvYnNlcnZlck9wdGlvbnMKICAgICAgICB9KQogICAgfTsKICAgIGNvbnN0IGFydHdvcmtEb3dubG9hZE11bHRpSW1hZ2UgPSAoKSA9PiB7CiAgICAgICAgY29uc3Qgb2JzZXJ2ZXJPcHRpb25zID0ge2F0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSwgYXR0cmlidXRlRmlsdGVyOiBbJ3NyYycsICdocmVmJ119OwogICAgICAgIG9ic2VydmVyRmFjdG9yeSh7CiAgICAgICAgICAgIGNhbGxiYWNrOiAobXV0YXRpb25zLCBvYnNlcnZlcikgPT4gewogICAgICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHsKICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGFkZGVkTm9kZSBvZiBtdXRhdGlvbi5hZGRlZE5vZGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDEuIOaJvuWIsOWIhuS6q+aMiemSriwg55So5LqO5aSN5Yi2VUkKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJHNoYXJlQnRuID0gJChhZGRlZE5vZGUpLmZpbmQoJ2RpdjpoYXMoPiBidXR0b25bY2xhc3NePSJzdHlsZV90cmFuc3BhcmVudEJ1dHRvbiJdKTplcSgxKScpOwogICAgICAgICAgICAgICAgICAgICAgICBpZigkc2hhcmVCdG4ubGVuZ3RoIDw9IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAvLyAyLiDliJ3lp4vljJYg5Zu+54mH5pWw6YePLCDlm77niYd1cmwKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgemlwID0gbmV3IEpTWmlwKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkb3dubG9hZGVkID0gMDsgICAgICAgIC8vIOS4i+i9veWujOaIkOaVsOmHjwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbGx1c3QgPSBpbGx1c3RBcGkoKTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gaWxsdXN0LnBhZ2VDb3VudDsgICAgICAgLy8g5LiL6L2955uu5qCH5pWw6YePCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHVybCA9IGlsbHVzdC51cmxzLm9yaWdpbmFsOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbWdVcmxzID0gQXJyYXkocGFyc2VJbnQobnVtKSkuZmlsbCgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKCh2YWx1ZSwgaW5kZXgpID0+IHVybC5yZXBsYWNlKC9fcFxkXC4vLCBgX3Ake2luZGV4fS5gKSk7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyAzLiDliJ3lp4vljJYg5LiL6L295oyJ6ZKuLCDlpI3liLbliIbkuqvmjInpkq7lubbml4vovawxODDluqYKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJHppcEJ0biA9IGFkZEltYWdlRG93bmxvYWRCdG4oewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNoYXJlQnV0dG9uQ29udGFpbmVyOiAkc2hhcmVCdG4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ2FoYW8tZG93bmxvYWQtemlwJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IGAke2kxOG4oJ2Rvd25sb2FkJyl9YCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsaWNrRnVuKCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDMuMS4g5LiL6L295Zu+54mHLCBodHRwczovL3dpa2kuZ3JlYXNlc3BvdC5uZXQvR00ueG1sSHR0cFJlcXVlc3QKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5hdHRyKCdzdGFydCcpICE9PSAndHJ1ZScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCdzdGFydCcsIHRydWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2goaW1nVXJscywgKGluZGV4LCB1cmwpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdNLnhtbEh0dHBSZXF1ZXN0KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLCB1cmw6IHVybCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7cmVmZXJlcjogJ2h0dHBzOi8vd3d3LnBpeGl2Lm5ldC8nfSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVycmlkZU1pbWVUeXBlOiAndGV4dC9wbGFpbjsgY2hhcnNldD14LXVzZXItZGVmaW5lZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25sb2FkKHtyZXNwb25zZVRleHR9KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDMuMi4g6L2s5Li6YmxvYuexu+WeiwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gcmVzcG9uc2VUZXh0OwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBVaW50OEFycmF5KHIubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAoaSA8IHIubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhW2ldID0gci5jaGFyQ29kZUF0KGkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN1ZmZpeCA9IHVybC5zcGxpdCgnLicpLnNwbGljZSgtMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbWVUeXBlID0ge3BuZzogImltYWdlL3BuZyIsIGpwZzogImltYWdlL2pwZWciLCBnaWY6ICJpbWFnZS9naWYifVtzdWZmaXhdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2RhdGFdLCB7dHlwZTogbWltZVR5cGV9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDMuMy4g5Y6L57yp5Zu+54mHCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdNLmdldFZhbHVlKEdNa2V5cy5kb3dubG9hZE5hbWUsIGB7cGlkfWApLnRoZW4obmFtZSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6aXAuZmlsZShgJHtnZXREb3dubG9hZE5hbWUobmFtZSl9XyR7aW5kZXh9LiR7c3VmZml4fWAsIGJsb2IsIHtiaW5hcnk6IHRydWV9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMy40LiDmiYvliqhzeW5jLCDpgb/lhY3kuIvovb3kuI3lrozlhajnmoTmg4XlhrUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRlZCsrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkemlwQnRuLmZpbmQoJ3AnKS5odG1sKGAke2kxOG4oJ2Rvd25sb2FkJyl9JHtkb3dubG9hZGVkfS8ke251bX1gKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDMuMi4g5omL5Yqoc3luYywg6YG/5YWN5LiL6L295LiN5a6M5YWoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRvd25sb2FkZWQgPCBudW0pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoaTE4bignZG93bmxvYWRfd2FpdCcpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAzLjMuIOS9v+eUqGpzemlwLmpz5ZKMRmlsZVNhdmVyLmpz5Y6L57yp5bm25LiL6L295Zu+54mHCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR00uZ2V0VmFsdWUoR01rZXlzLmRvd25sb2FkTmFtZSwgYHtwaWR9YCkudGhlbihuYW1lID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgemlwLmdlbmVyYXRlQXN5bmMoe3R5cGU6ICdibG9iJywgYmFzZTY0OiB0cnVlfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGNvbnRlbnQgPT4gc2F2ZUFzKGNvbnRlbnQsIGdldERvd25sb2FkTmFtZShuYW1lKSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDQuIOaOp+WItuaYr+WQpumihOS4i+i9vSwg6YG/5YWN5aSa5Liq6aG16Z2i5a+86Ie054iG5YaF5a2YCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZlYXR1cmVzLnByZURvd25sb2FkLmlzRW5hYmxlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR6aXBCdG4uZmluZCgnYnV0dG9uJykuY2xpY2soKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9uOiBvYnNlcnZlck9wdGlvbnMKICAgICAgICB9KQogICAgfTsKICAgIGNvbnN0IGFydHdvcmtEb3dubG9hZEdpZkltYWdlID0gKCkgPT4gewogICAgICAgIGNvbnN0IG9ic2VydmVyT3B0aW9ucyA9IHthdHRyaWJ1dGVzOiB0cnVlLCBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUsIGF0dHJpYnV0ZUZpbHRlcjogWydzcmMnLCAnaHJlZiddfTsKICAgICAgICBvYnNlcnZlckZhY3RvcnkoewogICAgICAgICAgICBjYWxsYmFjazogKG11dGF0aW9ucywgb2JzZXJ2ZXIpID0+IHsKICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBhZGRlZE5vZGUgb2YgbXV0YXRpb24uYWRkZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyAxLiDmmL7npLpnaXTlsLrlr7jlpKflsI8KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJGNhbnZhcyA9ICQoYWRkZWROb2RlKS5maW5kKCdjYW52YXMnKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRjYW52YXMubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkSW1nU2l6ZVNwYW4oeyQ6ICRjYW52YXN9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4g5om+5Yiw5YiG5Lqr5oyJ6ZKuLCDnlKjkuo7lpI3liLZVSQogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkc2hhcmVCdG4gPSAkKGFkZGVkTm9kZSkuZmluZCgnZGl2Omhhcyg+IGJ1dHRvbltjbGFzc149InN0eWxlX3RyYW5zcGFyZW50QnV0dG9uIl0pOmVxKDEpJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCRzaGFyZUJ0bi5sZW5ndGggPD0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDMuIOWIneWni+WMliDkuIvovb3mjInpkq4KICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJHppcEJ0biA9IGFkZEltYWdlRG93bmxvYWRCdG4oewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNoYXJlQnV0dG9uQ29udGFpbmVyOiAkc2hhcmVCdG4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ2FoYW8tZG93bmxvYWQtemlwJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICd6aXAnLAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJGdpZkJ0biA9IGFkZEltYWdlRG93bmxvYWRCdG4oewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNoYXJlQnV0dG9uQ29udGFpbmVyOiAkc2hhcmVCdG4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogJ2FoYW8tZG93bmxvYWQtZ2lmJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdnaWYnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2xpY2tGdW4oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8g5LuOIHBpeGl2IOWumOaWuSBhcGkg6I635Y+WIGdpZiDnmoTmlbDmja4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IGAvYWpheC9pbGx1c3QvJHtpbGx1c3RBcGkoKS5pbGx1c3RJZH0vdWdvaXJhX21ldGFgLCBkYXRhVHlwZTogJ2pzb24nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiAoe2JvZHl9KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAxLiDliJ3lp4vljJYgZ2lmIOS4i+i9veaMiemSriDngrnlh7vkuovku7YKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdJRl93b3JrZXJfVVJMIOadpeiHqiBodHRwczovL2dyZWFzeWZvcmsub3JnL3NjcmlwdHMvMjk2My1naWYtanMvY29kZS9naWZqcy5qcz92ZXJzaW9uPTg1OTYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBnaWZVcmw7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2lmRnJhbWVzID0gW107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBnaWZGYWN0b3J5ID0gbmV3IEdJRih7d29ya2VyczogMSwgcXVhbGl0eTogMTAsIHdvcmtlclNjcmlwdDogR0lGX3dvcmtlcl9VUkx9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBmcmFtZUlkeCA9IDAsIGZyYW1lcyA9IGJvZHkuZnJhbWVzLCBmcmFtZXNMZW4gPSBmcmFtZXMubGVuZ3RoOyBmcmFtZUlkeCA8IGZyYW1lc0xlbjsgZnJhbWVJZHgrKykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZyYW1lID0gZnJhbWVzW2ZyYW1lSWR4XTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1cmwgPSBpbGx1c3RBcGkoKS51cmxzLm9yaWdpbmFsLnJlcGxhY2UoJ3Vnb2lyYTAuJywgYHVnb2lyYSR7ZnJhbWVJZHh9LmApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdNLnhtbEh0dHBSZXF1ZXN0KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJywgdXJsOiB1cmwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtyZWZlcmVyOiAnaHR0cHM6Ly93d3cucGl4aXYubmV0Lyd9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVycmlkZU1pbWVUeXBlOiAndGV4dC9wbGFpbjsgY2hhcnNldD14LXVzZXItZGVmaW5lZCcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ubG9hZCh7cmVzcG9uc2VUZXh0fSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4g6L2s5Li6YmxvYuexu+WeiwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgciA9IHJlc3BvbnNlVGV4dDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoci5sZW5ndGgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKGkgPCByLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFbaV0gPSByLmNoYXJDb2RlQXQoaSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSsrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3VmZml4ID0gdXJsLnNwbGl0KCcuJykuc3BsaWNlKC0xKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1pbWVUeXBlID0ge3BuZzogImltYWdlL3BuZyIsIGpwZzogImltYWdlL2pwZWciLCBnaWY6ICJpbWFnZS9naWYifVtzdWZmaXhdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtkYXRhXSwge3R5cGU6IG1pbWVUeXBlfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMy4g5Y6L5YWlZ2lmRnJhbWVz5pWw57uE5LitLCDmiYvliqjlkIzmraVzeW5jCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbWcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZy5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nLndpZHRoID0gaWxsdXN0QXBpKCkud2lkdGg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWcuaGVpZ2h0ID0gaWxsdXN0QXBpKCkuaGVpZ2h0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1nLm9ubG9hZCA9ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaWZGcmFtZXNbZnJhbWVJZHhdID0ge2ZyYW1lOiBpbWcsIG9wdGlvbjoge2RlbGF5OiBmcmFtZS5kZWxheX19OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhnaWZGcmFtZXMpLmxlbmd0aCA+PSBmcmFtZXNMZW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5lYWNoKGdpZkZyYW1lcywgKGksIGYpID0+IGdpZkZhY3RvcnkuYWRkRnJhbWUoZi5mcmFtZSwgZi5vcHRpb24pKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2lmRmFjdG9yeS5yZW5kZXIoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaWZGYWN0b3J5Lm9uKCdwcm9ncmVzcycsIHBjdCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGdpZkJ0bi5maW5kKCdwJykudGV4dChgZ2lmICR7cGFyc2VJbnQocGN0ICogMTAwKX0lYCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdpZkZhY3Rvcnkub24oJ2ZpbmlzaGVkJywgYmxvYiA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2lmVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHTS5nZXRWYWx1ZShHTWtleXMuZG93bmxvYWROYW1lLCBge3BpZH1gKS50aGVuKG5hbWUgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkYSA9ICQoYDxhIGhyZWY9IiR7Z2lmVXJsfSIgZG93bmxvYWQ9IiR7Z2V0RG93bmxvYWROYW1lKG5hbWUpfSI+PC9hPmApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZ2lmQnRuLmZpbmQoJ2J1dHRvbicpLndyYXAoJGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGdpZkJ0bi5maW5kKCdidXR0b24nKS5vZmYoJ2NsaWNrJykub24oJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghZ2lmVXJsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCdHaWbmnKrliqDovb3lrozmr5UsIOivt+eojeetieeJh+WIuyEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBZGJsb2NrIOemgeatouebtOaOpeaJk+W8gCBibG9iIHVybCwgaHR0cHM6Ly9naXRodWIuY29tL2pub3JkYmVyZy9naWYuanMvaXNzdWVzLzcxI2lzc3VlY29tbWVudC0zNjcyNjAyODQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB3aW5kb3cub3BlbihnaWZVcmwpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyA0LiDmjqfliLbmmK/lkKbpooTkuIvovb0sIOmBv+WFjeWkmuS4qumhtemdouWvvOiHtOeIhuWGheWtmCwg55u05o6l5LiL6L29IHppcAogICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBgL2FqYXgvaWxsdXN0LyR7aWxsdXN0QXBpKCkuaWxsdXN0SWR9L3Vnb2lyYV9tZXRhYCwgZGF0YVR5cGU6ICdqc29uJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICh7Ym9keX0pID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBHTS5nZXRWYWx1ZShHTWtleXMuZG93bmxvYWROYW1lLCBge3BpZH1gKS50aGVuKG5hbWUgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkYSA9ICQoYDxhIGhyZWY9IiR7Ym9keS5vcmlnaW5hbFNyY30iIGRvd25sb2FkPSIke2dldERvd25sb2FkTmFtZShuYW1lKX0iPjwvYT5gKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHppcEJ0bi5maW5kKCdidXR0b24nKS53cmFwKCRhKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGZlYXR1cmVzLnByZURvd25sb2FkLmlzRW5hYmxlKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRnaWZCdG4uZmluZCgnYnV0dG9uJykuY2xpY2soKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgb3B0aW9uOiBvYnNlcnZlck9wdGlvbnMKICAgICAgICB9KQogICAgfTsKICAgIGlmIChpc0FydHdvcmtQYWdlKCkpIHsKICAgICAgICAvLyBodHRwczovL3d3dy5waXhpdi5uZXQvYXJ0d29ya3MvNjU0MjQ4MzcjMQogICAgICAgIC8vIGh0dHBzOi8vd3d3LnBpeGl2Lm5ldC9hcnR3b3Jrcy83MTAwNTYzMwogICAgICAgIC8vIGh0dHBzOi8vd3d3LnBpeGl2Lm5ldC9hcnR3b3Jrcy83MjQxNDI1OAogICAgICAgIGFydHdvcmtPcmlnaW5hbEltYWdlKCk7CiAgICAgICAgLy8gaHR0cHM6Ly93d3cucGl4aXYubmV0L2FydHdvcmtzLzY1NDI0ODM3CiAgICAgICAgaWYgKGlzTW9yZU1vZGUoKSkgewogICAgICAgICAgICBhcnR3b3JrRG93bmxvYWRNdWx0aUltYWdlKCk7CiAgICAgICAgfQogICAgICAgIC8vIGh0dHBzOi8vd3d3LnBpeGl2Lm5ldC9hcnR3b3Jrcy83MTAwNTYzMwogICAgICAgIGlmIChpc0dpZk1vZGUoKSkgewogICAgICAgICAgICBhcnR3b3JrRG93bmxvYWRHaWZJbWFnZSgpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyA0LiDlnKjnlLvluIjpobXpnaLlkozkvZzlk4HpobXpnaLmmL7npLrnlLvluIhpZOOAgeeUu+W4iOiDjOaZr+Wbviwg55So5oi35aS05YOP5YWB6K645Y+z6ZSu5L+d5a2YCiAgICBjb25zdCBtZW1iZXJJbmRleFBhZ2VQbHVzID0gKCkgPT4gewogICAgICAgIGNvbnN0IG9ic2VydmVyT3B0aW9uID0ge2NoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZX07CiAgICAgICAgb2JzZXJ2ZXJGYWN0b3J5KHsKICAgICAgICAgICAgY2FsbGJhY2s6IChtdXRhdGlvbnMsIG9ic2VydmVyKSA9PiB7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykgewogICAgICAgICAgICAgICAgICAgIC8vIDEuIOaJvuWIsOWFs+azqOaVsOmHj+eahGRpdiwg55So5LqO5o6l5LiL5p2l55qEY2xvbmUKICAgICAgICAgICAgICAgICAgICBjb25zdCB1aWQgPSBsb2NhdGlvbi5ocmVmLm1hdGNoKC9cL3VzZXJzXC8oXGQrKS8pPy5bMV07CiAgICAgICAgICAgICAgICAgICAgY29uc3QgJHJvdyA9ICQobXV0YXRpb24udGFyZ2V0KS5maW5kKGBkaXY6aGFzKD4gYVtocmVmJD0iL3VzZXJzLyR7dWlkfS9mb2xsb3dpbmciXSlgKTsKICAgICAgICAgICAgICAgICAgICBpZiAoJHJvdy5sZW5ndGggPD0gMCB8fCAkcm93LmF0dHIoJ2FoYW8tZG9uZScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkcm93LmF0dHIoJ2FoYW8tZG9uZScsIHRydWUpOyAvLyDmoIforrDlt7LlpITnkIYsIOmBv+WFjemHjeWkjeaJp+ihjAoKICAgICAgICAgICAgICAgICAgICAvLyAyLiDmmL7npLrnlLvluIjog4zmma/lm74KICAgICAgICAgICAgICAgICAgICBjb25zdCAkYmcgPSAkcm93LmNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgJGJnLmNoaWxkcmVuKCdhJykucmVtb3ZlKCkKICAgICAgICAgICAgICAgICAgICBjb25zdCBiZ1VybCA9IHVzZXJBcGkodWlkKT8uYmFja2dyb3VuZD8udXJsIHx8ICcnOwogICAgICAgICAgICAgICAgICAgIGlmIChiZ1VybCAmJiBiZ1VybCAhPT0gJ25vbmUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRiZy5hcHBlbmQoYDxpbWcgc3JjPSIke2JnVXJsfSIgd2lkdGg9IjMwcHgiPjxhIHRhcmdldD0iX2JsYW5rIiBocmVmPSIke2JnVXJsfSIgc3R5bGU9ImZvbnQtc2l6ZTogMjBweDtmb250LXdlaWdodDogNzAwO2NvbG9yOiAjMzMzO21hcmdpbi1yaWdodDogOHB4O2xpbmUtaGVpZ2h0OiAxIj4ke2kxOG4oJ2JhY2tncm91bmQnKX08L2E+YCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGJnLmFwcGVuZChgPHNwYW4+JHtpMThuKCdiYWNrZ3JvdW5kX25vdF9mb3VuZCcpfTwvc3Bhbj5gKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHJvdy5wYXJlbnQoKS5hcHBlbmQoJGJnKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gMy4g5pi+56S655S75biIaWQsIOeCueWHu+iHquWKqOWkjeWItuWIsOWJqui0tOadvwogICAgICAgICAgICAgICAgICAgIGNvbnN0ICR1aWQgPSAkcm93LmNsb25lKCk7CiAgICAgICAgICAgICAgICAgICAgJHVpZC5jaGlsZHJlbignYScpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgICR1aWQuYXBwZW5kKCQoYDxkaXYgc3R5bGU9ImZvbnQtc2l6ZTogMjBweDtmb250LXdlaWdodDogNzAwO2NvbG9yOiAjMzMzO21hcmdpbi1yaWdodDogOHB4O2xpbmUtaGVpZ2h0OiAxIj5VSUQ6JHt1aWR9PC9kaXY+YCkKICAgICAgICAgICAgICAgICAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ICR0aGlzID0gJCh0aGlzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmh0bWwoYDxzcGFuPlVJRCR7aTE4bignY29weV90b19jbGlwYm9hcmQnKX08L3NwYW4+YCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBHTS5zZXRDbGlwYm9hcmQodWlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmh0bWwoYDxzcGFuPlVJRCR7dWlkfTwvc3Bhbj5gKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDIwMDApOwogICAgICAgICAgICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgICAgICAgICAgJHJvdy5wYXJlbnQoKS5hcHBlbmQoJHVpZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIG9wdGlvbjogb2JzZXJ2ZXJPcHRpb24KICAgICAgICB9KTsKICAgIH0KICAgIGlmIChpc01lbWJlckluZGV4UGFnZSgpKSB7CiAgICAgICAgLy8g5rWL6K+V6ZO+5o6l77yaaHR0cHM6Ly93d3cucGl4aXYubmV0L2FydHdvcmtzLzcyNDE0MjU4CiAgICAgICAgbWVtYmVySW5kZXhQYWdlUGx1cygpOwogICAgfQogICAgY29uc3QgYXJ0d29ya1BhZ2VQbHVzID0gKCkgPT4gewogICAgICAgIGNvbnN0IG9ic2VydmVyT3B0aW9uID0ge2NoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZX07CiAgICAgICAgb2JzZXJ2ZXJGYWN0b3J5KHsKICAgICAgICAgICAgY2FsbGJhY2s6IChtdXRhdGlvbnMsIG9ic2VydmVyKSA9PiB7CiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG11dGF0aW9uIG9mIG11dGF0aW9ucykgewogICAgICAgICAgICAgICAgICAgIC8vIDEuIOaJvuWIsOS9nOiAheWQjeensOeahGgyLCDnlKjkuo7mjqXkuIvmnaXnmoRjbG9uZQogICAgICAgICAgICAgICAgICAgIGNvbnN0ICRyb3cgPSAkKG11dGF0aW9uLnRhcmdldCkuZmlsdGVyKCdhc2lkZScpLmZpbmQoJ3NlY3Rpb246Zmlyc3QgaDInKTsKICAgICAgICAgICAgICAgICAgICBpZiAoJHJvdy5sZW5ndGggPD0gMCB8fCAkcm93LmF0dHIoJ2FoYW8tZG9uZScpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkcm93LmF0dHIoJ2FoYW8tZG9uZScsIHRydWUpOyAvLyDmoIforrDlt7LlpITnkIYsIOmBv+WFjemHjeWkjeaJp+ihjAoKICAgICAgICAgICAgICAgICAgICAvLyAyLiDmmL7npLrnlLvluIjog4zmma/lm74KICAgICAgICAgICAgICAgICAgICBjb25zdCB1aWQgPSAkcm93LmZpbmQoJ1tkYXRhLWd0bS12YWx1ZV06Zmlyc3QnKS5kYXRhKCdndG0tdmFsdWUnKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBiZ1VybCA9IHVzZXJBcGkodWlkKT8uYmFja2dyb3VuZD8udXJsIHx8ICcnOwogICAgICAgICAgICAgICAgICAgIGNvbnN0ICRiZyA9ICRyb3cuY2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkYmcuY2hpbGRyZW4oJ2EnKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAkYmcuY2hpbGRyZW4oJ2RpdicpLmNoaWxkcmVuKCdkaXYnKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgICAkYmcucHJlcGVuZChgPGltZyBzcmM9IiR7YmdVcmx9IiB3aWR0aD0iMTAlIi8+YCk7CiAgICAgICAgICAgICAgICAgICAgJGJnLmZpbmQoJ2RpdiBhJykKICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ2hyZWYnLCAhIWJnVXJsID8gYmdVcmwgOiAnamF2YXNjcmlwdDp2b2lkKDApJykKICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3RhcmdldCcsICdfYmxhbmsnKQogICAgICAgICAgICAgICAgICAgICAgICAudGV4dCghIWJnVXJsID8gaTE4bignYmFja2dyb3VuZCcpIDogaTE4bignYmFja2dyb3VuZF9ub3RfZm91bmQnKSk7CiAgICAgICAgICAgICAgICAgICAgJHJvdy5hZnRlcigkYmcpOwoKICAgICAgICAgICAgICAgICAgICAvLyAzLiDmmL7npLrnlLvluIhpZCwg54K55Ye76Ieq5Yqo5aSN5Yi25Yiw5Ymq6LS05p2/CiAgICAgICAgICAgICAgICAgICAgY29uc3QgJHVpZCA9ICRyb3cuY2xvbmUoKTsKICAgICAgICAgICAgICAgICAgICAkdWlkLmNoaWxkcmVuKCdhJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICAgICAgJHVpZC5jaGlsZHJlbignZGl2JykuY2hpbGRyZW4oJ2RpdicpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICAgICR1aWQuZmluZCgnYScpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdocmVmJywgJ2phdmFzY3JpcHQ6dm9pZCgwKScpCiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdpZCcsICdhaGFvLXVpZCcpCiAgICAgICAgICAgICAgICAgICAgICAgIC50ZXh0KGBVSUQ6ICR7dWlkfWApOwogICAgICAgICAgICAgICAgICAgICR1aWQub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkdGhpcyA9ICQodGhpcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmZpbmQoJ2EnKS50ZXh0KGBVSUQke2kxOG4oJ2NvcHlfdG9fY2xpcGJvYXJkJyl9YCk7CiAgICAgICAgICAgICAgICAgICAgICAgIEdNLnNldENsaXBib2FyZCh1aWQpOwogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmZpbmQoJ2EnKS50ZXh0KGBVSUQ6ICR7dWlkfWApOwogICAgICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAkYmcuYWZ0ZXIoJHVpZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9wdGlvbjogb2JzZXJ2ZXJPcHRpb24KICAgICAgICB9KTsKICAgIH07CiAgICBpZiAoaXNBcnR3b3JrUGFnZSgpKSB7CiAgICAgICAgLy8g5rWL6K+V6ZO+5o6l77yaaHR0cHM6Ly93d3cucGl4aXYubmV0L2FydHdvcmtzLzcyNDE0MjU4CiAgICAgICAgYXJ0d29ya1BhZ2VQbHVzKCk7CiAgICB9CiAgICBjb25zdCBiYWNrZ3JvdW5kVXJsUGx1cyA9ICgpID0+IHsKICAgICAgICAvLyBUT0RPIOW+heS/ruWkjQogICAgICAgIHJldHVybjsKICAgICAgICBjb25zdCBvYnNlcnZlck9wdGlvbiA9IHtjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWV9OwogICAgICAgIG9ic2VydmVyRmFjdG9yeSh7CiAgICAgICAgICAgIGNhbGxiYWNrOiAobXV0YXRpb25zLCBvYnNlcnZlcikgPT4gewogICAgICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHsKICAgICAgICAgICAgICAgICAgICAvLyAyLiDlsIbkvZzogIXlpLTlg4/nlLEgYmFja2dyb3VuZCDovazkuLogPGltZz4KICAgICAgICAgICAgICAgICAgICBjb25zdCAkdGFyZ2V0ID0gJChtdXRhdGlvbi50YXJnZXQpOwogICAgICAgICAgICAgICAgICAgIGlmICgkdGFyZ2V0LmZpbmQoJ2Rpdi5CeGFtaicpLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgZGVidWdnZXIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHRhcmdldC5maW5kKCdkaXZbcm9sZT0iaW1nIl0nKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJHRoaXMgPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0YWdOYW1lID0gJHRoaXMucHJvcCgndGFnTmFtZScpOwoKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaW1nVXJsID0gJHRoaXMuZ2V0QmFja2dyb3VuZFVybCgpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWltZ1VybCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkdXNlckltZyA9ICQoJzxpbWcgY2xhc3M9ImFoYW8tdXNlci1pbWciIHNyYz0iIi8+JykuYXR0cignc3JjJywgaW1nVXJsKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXJJbWcuY3NzKCd3aWR0aCcsICR0aGlzLmNzcygnd2lkdGgnKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jc3MoJ2hlaWdodCcsICR0aGlzLmNzcygnaGVpZ2h0JykpOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYodGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnYScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgICR0aGlzLmh0bWwoJHVzZXJJbWcpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgJHRoaXMuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJywgJycpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgICAvLyB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFnTmFtZS50b0xvd2VyQ2FzZSgpID09PSAnZGl2JykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXJJbWcuYXR0cignY2xhc3MnLCAkdGhpcy5hdHRyKCdjbGFzcycpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR1c2VySW1nLmh0bWwoJHRoaXMuaHRtbCgpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLnJlcGxhY2VXaXRoKCgpID0+ICR1c2VySW1nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAvLyAzLiDlsIbor4TorrrlpLTlg4/nlLEgYmFja2dyb3VuZCDovazkuLogPGltZz4KICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0LmZpbmQoJ2FbZGF0YS11c2VyX2lkXVtkYXRhLXNyY10nKS5lYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJHRoaXMgPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkZGl2ID0gJHRoaXMuZmluZCgnZGl2Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ICRpbWcgPSAkKCc8aW1nLz4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgJGltZy5hdHRyKCdzcmMnLCAkdGhpcy5hdHRyKCdkYXRhLXNyYycpKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEhJGRpdi5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpbWcuYXR0cignY2xhc3MnLCAkZGl2LmF0dHIoJ2NsYXNzJykpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNzcygnd2lkdGgnLCAkZGl2LmNzcygnd2lkdGgnKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY3NzKCdoZWlnaHQnLCAkZGl2LmNzcygnaGVpZ2h0JykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMuaHRtbCgkaW1nKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICBvcHRpb246IG9ic2VydmVyT3B0aW9uCiAgICAgICAgfSk7CiAgICB9OwogICAgYmFja2dyb3VuZFVybFBsdXMoKTsKCiAgICAvLyA1LiDoh6rliqjliqDovb3or4TorroKICAgIC8vIGh0dHBzOi8vd3d3LnBpeGl2Lm5ldC9hcnR3b3Jrcy83MjQxNDI1OAogICAgY29uc3QgY29tbWVudEF1dG9Mb2FkID0gKCkgPT4gewogICAgICAgIGlmICghaXNBcnR3b3JrUGFnZSgpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3Qgb2JzZXJ2ZXJPcHRpb24gPSB7Y2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlfTsKICAgICAgICBvYnNlcnZlckZhY3RvcnkoewogICAgICAgICAgICBjYWxsYmFjazogKG11dGF0aW9ucywgb2JzZXJ2ZXIpID0+IHsKICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBhZGRlZE5vZGUgb2YgbXV0YXRpb24uYWRkZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyDnrKzkuIDmrKHliqDovb3jgJDmtY/op4jmm7TlpJrjgJHmjInpkq7nmoTlnLrmma8KICAgICAgICAgICAgICAgICAgICAgICAgJChhZGRlZE5vZGUpLmZpbHRlcignW2NsYXNzXj0iQ29tbWVudExpc3RfYnV0dG9uQXJlYSJdJykuZmluZCgiZGl2W3JvbGU9J2J1dHRvbiddIikuY2xpY2soKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8g56ys5LqM5qyh5Yqg6L2944CQ5rWP6KeI5pu05aSa44CR5oyJ6ZKu55qE5Zy65pmvCiAgICAgICAgICAgICAgICAgICAgICAgICQobXV0YXRpb24udGFyZ2V0KS5maWx0ZXIoJ1tjbGFzc149IkNvbW1lbnRMaXN0X2J1dHRvbkFyZWEiXScpLmZpbmQoImRpdltyb2xlPSdidXR0b24nXSIpLmNsaWNrKCk7CgogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkbW9yZVJlcGxheUJ0biA9ICQobXV0YXRpb24udGFyZ2V0KS5maW5kKCcuXzI4elIxTVEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgJG1vcmVSZXBsYXlCdG4uY2xpY2soKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9wdGlvbjogb2JzZXJ2ZXJPcHRpb24sCiAgICAgICAgICAgIG5vZGU6IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ21haW4nKVswXQogICAgICAgIH0pOwogICAgfTsKCiAgICAvLyA2LiDlr7nkuLvpobXliqjmgIHkuK3nmoTlm77niYfmoIforrDkvZzlk4HnsbvlnosKICAgIC8vIGh0dHBzOi8vd3d3LnBpeGl2Lm5ldC9zdGFjYz9tb2RlPXVuaWZ5CiAgICBjb25zdCBhcnR3b3JrVGFnID0gKCkgPT4gewogICAgICAgIGlmICghaXNTdGFjY1BhZ2UoKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxvZygn5qCH6K6w5L2c5ZOBIOWIneWni+WMlicpOwogICAgICAgIGNvbnN0IG9ic2VydmVyT3B0aW9uID0ge2NoaWxkTGlzdDogdHJ1ZX07CiAgICAgICAgcmV0dXJuIG9ic2VydmVyRmFjdG9yeSh7CiAgICAgICAgICAgIGNhbGxiYWNrOiAobXV0YXRpb25zLCBvYnNlcnZlcikgPT4gewogICAgICAgICAgICAgICAgZm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHsKICAgICAgICAgICAgICAgICAgICAvLyAxLiDliKTmlq3mmK/lkKbmlLnlj5joioLngrkKICAgICAgICAgICAgICAgICAgICBjb25zdCAkdGl0bGUgPSAkKG11dGF0aW9uLnRhcmdldCkuZmluZCgnLnN0YWNjX3JlZl9pbGx1c3RfdGl0bGUnKTsKICAgICAgICAgICAgICAgICAgICAkdGl0bGUuZWFjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ICRhID0gJCh0aGlzKS5maW5kKCdhJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIDEuIOW3sue7j+a3u+WKoOi/h+agh+iusOeahOWwseS4jeWGjea3u+WKoAogICAgICAgICAgICAgICAgICAgICAgICBpZiAoISEkYS5hdHRyKCdhaGFvLWlsbHVzdC1pZCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gMi4g6I635Y+WcGlkLCDorr7nva7moIforrDpgb/lhY3kuozmrKHnlJ/miJAKICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgaWxsdXN0SWQgPSBuZXcgVVJMKGAke2xvY2F0aW9uLm9yaWdpbn0vJHskYS5hdHRyKCdocmVmJyl9YCkuc2VhcmNoUGFyYW1zLmdldCgnaWxsdXN0X2lkJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICRhLmF0dHIoJ2FoYW8taWxsdXN0LWlkJywgaWxsdXN0SWQpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyAzLiDosIPnlKjlrpjmlrlhcGksIOWIpOaWreS9nOWTgeexu+WeiwogICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBgL2FqYXgvaWxsdXN0LyR7aWxsdXN0SWR9YCwgZGF0YVR5cGU6ICdqc29uJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6ICh7Ym9keX0pID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbGx1c3RUeXBlID0gcGFyc2VJbnQoYm9keS5pbGx1c3RUeXBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpc011bHRpUGljID0gcGFyc2VJbnQoYm9keS5wYWdlQ291bnQpID4gMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGlsbHVzdFR5cGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYS5hZnRlcihgPHA+JHtpc011bHRpUGljID8gaTE4bignaWxsdXN0X3R5cGVfbXVsdGlwbGUnKSA6IGkxOG4oJ2lsbHVzdF90eXBlX3NpbmdsZScpfTwvcD5gKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYS5hZnRlcihgPHA+JHtpMThuKCdpbGx1c3RfdHlwZV9naWYnKX08L3A+YCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9wdGlvbjogb2JzZXJ2ZXJPcHRpb24sCiAgICAgICAgICAgIG5vZGU6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdGFjY190aW1lbGluZScpCiAgICAgICAgfSk7CiAgICB9OwoKICAgIC8vIDcuIOWvuWp1bXAucGhw5Y+W5raI6YeN5a6a5ZCRCiAgICAvLyBodHRwczovL3d3dy5waXhpdi5uZXQvYXJ0d29ya3MvNzIzMDA0NDkKICAgIC8vIGh0dHBzOi8vd3d3LnBpeGl2Lm5ldC91c2Vycy8xMDM5MzUzCiAgICBjb25zdCBhbnRpUmVkaXJlY3QgPSAoKSA9PiB7CiAgICAgICAgY29uc3Qgb2JzZXJ2ZXJPcHRpb24gPSB7Y2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlfTsKICAgICAgICBvYnNlcnZlckZhY3RvcnkoewogICAgICAgICAgICBjYWxsYmFjazogKG11dGF0aW9ucywgb2JzZXJ2ZXIpID0+IHsKICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBhZGRlZE5vZGUgb2YgbXV0YXRpb24uYWRkZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBqdW1wU2VsZWN0b3IgPSAnYVtocmVmKj0ianVtcC5waHAiXSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0ICRqdW1wID0gJChhZGRlZE5vZGUpLmZpbmQoanVtcFNlbGVjdG9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgJGp1bXAuZWFjaChmdW5jdGlvbiAoaSwgZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJHRoaXMgPSAkKHRoaXMpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXJsID0gJHRoaXMuYXR0cignaHJlZicpLm1hdGNoKC9qdW1wXC5waHBcPyh1cmw9KT8oLiopJC8pWzJdOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMuYXR0cignaHJlZicsIGRlY29kZVVSSUNvbXBvbmVudCh1cmwpKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwgb2JzZXJ2ZXJPcHRpb24pOwogICAgfQoKICAgIC8vIDguIOWKqOaAgemakOiXj++8iOWOu+mZpO+8iemhtuagj0xPR0/lj7PkvqfljaDkvY3nqbrnmb3vvIjlp4vnu4jlkK/nlKjvvIkKICAgIGNvbnN0IGhpZGVUb3BCYXJCbGFuayA9IHsKICAgICAgICBpbml0KCkgewogICAgICAgICAgICB0aGlzLmNoZWNrVXJsQW5kVG9nZ2xlRWxlbWVudCgpOwogICAgICAgICAgICB0aGlzLnNldHVwT2JzZXJ2ZXIoKTsKICAgICAgICB9LAogICAgICAgIGNoZWNrVXJsQW5kVG9nZ2xlRWxlbWVudCgpIHsKICAgICAgICAgICAgLy8ga2V5d29yZHPvvJrliKTmlq3pnIDopoHpmpDol4/nmoTmnaHku7bnmoQgVVJMIOWFs+mUruWtl+OAgiR0YXJnZXTvvJropoHmk43kvZznmoTlr7nosaHpgInmi6nlmagKICAgICAgICAgICAgY29uc3Qga2V5d29yZHMgPSBbJy9hcnR3b3JrcycsICdub3ZlbC9zaG93LnBocCcsICdib29rbWFya19uZXdfaWxsdXN0JywgJy91c2VycycsICcvdGFnJywgJy9kaXNjb3ZlcnknLCAnL2Rhc2hib2FyZCcsICcvbWFuYWdlJywgJy9zZXR0aW5ncyddOwogICAgICAgICAgICBjb25zdCAkdGFyZ2V0ID0gJCgnLmdyb3VwXFwvbG9nbyAuZmxleC5nYXAtOC5pdGVtcy1jZW50ZXIgLm1sLTguc2l6ZS1cXFs1MHB4XFxdJyk7CiAgICAgICAgICAgIC8vIOWIpOaWreW5tuaJp+ihjOebruagh+WvueixoeeahOaYvuekuuaIlumakOiXj++8iOWOu+mZpO+8ieaTjeS9nAogICAgICAgICAgICBjb25zdCBzaG91bGRIaWRlID0ga2V5d29yZHMuc29tZShrZXl3b3JkID0+IGxvY2F0aW9uLmhyZWYuaW5jbHVkZXMoa2V5d29yZCkpOwogICAgICAgICAgICAkdGFyZ2V0LnRvZ2dsZSghc2hvdWxkSGlkZSk7CiAgICAgICAgfSwKICAgICAgICBzZXR1cE9ic2VydmVyKCkgewogICAgICAgICAgICAvLyDlpI3nlKjkuLvohJrmnKznmoQgb2JzZXJ2ZXJGYWN0b3J5IOe7n+S4gOeuoeeQhuebkeWQrOWZqAogICAgICAgICAgICBvYnNlcnZlckZhY3RvcnkoewogICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHRoaXMuY2hlY2tVcmxBbmRUb2dnbGVFbGVtZW50KCksCiAgICAgICAgICAgICAgICBub2RlOiBkb2N1bWVudC5ib2R5LAogICAgICAgICAgICAgICAgb3B0aW9uOiB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH07CiAgICBoaWRlVG9wQmFyQmxhbmsuaW5pdCgpOyAvLyDlip/og70gOCDnmoTmoLjlv4Pop6blj5HlmajvvIzmsqHlroPmraTlip/og73lsIbml6Dms5Xov5DkvZzvvIEKCiAgICAvL1RPRE8g5aKe5by65paw6aG16Z2iZmFuYm94IGh0dHBzOi8vd3d3LnBpeGl2Lm5ldC9mYW5ib3gvY3JlYXRvci8yMjkyNjY2MT91dG1fY2FtcGFpZ249d3d3X3Byb2ZpbGUmdXRtX21lZGl1bT1zaXRlX2Zsb3cmdXRtX3NvdXJjZT1waXhpdgogICAgLy9UT0RPIOaXpeivreWMlgoKICAgIC8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT0g5Li75Ye95pWwID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgZm9yIChjb25zdCBrZXkgaW4gZmVhdHVyZXMpIHsKICAgICAgICBjb25zdCBmZWF0dXJlID0gZmVhdHVyZXNba2V5XTsKICAgICAgICBpZihmZWF0dXJlLnR5cGUgPT09ICdjaGVja2JveCcpIHsKICAgICAgICAgICAgZmVhdHVyZS5pc0VuYWJsZSA9ICgpID0+IEdNX2dldFZhbHVlKGtleSwgdHJ1ZSk7CiAgICAgICAgfQogICAgfQogICAgR01fcmVnaXN0ZXJNZW51Q29tbWFuZChg5o6n5Yi26Z2i5p2/YCwgKCkgPT4gewogICAgICAgIGNvbnN0IGNvbnRyb2xQYW5lbElkID0gJ215Q29udHJvbFBhbmVsJzsKICAgICAgICAvLyDliJvlu7rmjqfliLbpnaLmnb/nmoTlrrnlmajlkozmjInpkq4KICAgICAgICBjb25zdCAkY29udHJvbCA9ICQoYDxkaXYgaWQ9IiR7Y29udHJvbFBhbmVsSWR9IiBzdHlsZT0icG9zaXRpb246IGZpeGVkOyB0b3A6IDIwcHg7IGxlZnQ6IDIwcHg7IGJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7IHBhZGRpbmc6IDE1cHg7IHotaW5kZXg6IDEwMDA7IGJveC1zaGFkb3c6IDJweCAycHggNXB4IHJnYmEoMCwgMCwgMCwgMC4xKTsgYm9yZGVyLXJhZGl1czogNXB4OyBmb250LWZhbWlseTogc2Fucy1zZXJpZjsgZGlzcGxheTogZmxleDsgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsgZ2FwOiAxMHB4OyI+PC9kaXY+YCk7CiAgICAgICAgJCgnYm9keScpLmFwcGVuZCgkY29udHJvbCk7CgogICAgICAgIC8vIOWKqOaAgeWIneWni+WMlumFjee9rumhuQogICAgICAgIGZvciAoY29uc3Qga2V5IGluIGZlYXR1cmVzKSB7CiAgICAgICAgICAgIGNvbnN0IGZlYXR1cmUgPSBmZWF0dXJlc1trZXldOwogICAgICAgICAgICBpZihmZWF0dXJlLnR5cGUgPT09ICdjaGVja2JveCcpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gR01fZ2V0VmFsdWUoa2V5LCB0cnVlKTsKICAgICAgICAgICAgICAgIGNvbnN0ICRyb3cgPSAkKCc8ZGl2IHN0eWxlPSJkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDEwcHg7Ij48L2Rpdj4nKTsKICAgICAgICAgICAgICAgIGNvbnN0ICRsYWJlbCA9ICQoJzxsYWJlbCBzdHlsZT0iY29sb3I6ICMzMzM7Ij48L2xhYmVsPicpLnRleHQoaTE4bihgc3dpdGNoXyR7a2V5fWApKTsKICAgICAgICAgICAgICAgIGNvbnN0ICRjaGVja2JveCA9ICQoJzxpbnB1dCB0eXBlPSJjaGVja2JveCI+JykucHJvcCgnY2hlY2tlZCcsIHZhbHVlKTsKICAgICAgICAgICAgICAgICRjaGVja2JveC5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgR01fc2V0VmFsdWUoa2V5LCAkKHRoaXMpLnByb3AoJ2NoZWNrZWQnKSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICRyb3cuYXBwZW5kKCRjaGVja2JveCwgJGxhYmVsKTsKICAgICAgICAgICAgICAgICRjb250cm9sLmFwcGVuZCgkcm93KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8g5Yid5aeL5YyW5oyJ6ZKuCiAgICAgICAgY29uc3QgJHJlc2V0ID0gJCgnPGJ1dHRvbiBzdHlsZT0icGFkZGluZzogOHB4IDE1cHg7IGJvcmRlcjogbm9uZTsgYm9yZGVyLXJhZGl1czogM3B4OyBjdXJzb3I6IHBvaW50ZXI7IGZvbnQtc2l6ZTogMXJlbTsgYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjsgY29sb3I6IHdoaXRlOyB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuM3MgZWFzZTsgbWFyZ2luLXRvcDogMTBweDsiPumHjee9rum7mOiupOWAvDwvYnV0dG9uPicpOwogICAgICAgIGNvbnN0ICRjbG9zZSA9ICQoJzxidXR0b24gc3R5bGU9InBhZGRpbmc6IDhweCAxNXB4OyBib3JkZXI6IG5vbmU7IGJvcmRlci1yYWRpdXM6IDNweDsgY3Vyc29yOiBwb2ludGVyOyBmb250LXNpemU6IDFyZW07IGJhY2tncm91bmQtY29sb3I6ICM2Yzc1N2Q7IGNvbG9yOiB3aGl0ZTsgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjNzIGVhc2U7Ij7lhbPpl608L2J1dHRvbj4nKTsKICAgICAgICAkY29udHJvbC5hcHBlbmQoJHJlc2V0LCAkY2xvc2UpOwogICAgICAgICRyZXNldC5vbignY2xpY2snLCBmdW5jdGlvbigpIHsKICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gZmVhdHVyZXMpIHsKICAgICAgICAgICAgICAgIGNvbnN0IGZlYXR1cmUgPSBmZWF0dXJlc1trZXldOwogICAgICAgICAgICAgICAgaWYoZmVhdHVyZS50eXBlID09PSAnY2hlY2tib3gnKSB7CiAgICAgICAgICAgICAgICAgICAgR01fc2V0VmFsdWUoa2V5LCBmZWF0dXJlLmRlZmF1bHQgfHwgdHJ1ZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIEdNX3NldFZhbHVlKGtleSwgZmVhdHVyZS5kZWZhdWx0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBhbGVydCgn5omA5pyJ6YWN572u5bey6YeN572u5Li66buY6K6k5YC844CCJyk7CiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgICAgICB9KTsKICAgICAgICAkY2xvc2Uub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICRjb250cm9sLnJlbW92ZSgpOwogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7CiAgICAgICAgfSk7CiAgICB9KQoKICAgIGZlYXR1cmVzLmFudGlBZC5pc0VuYWJsZSgpICYmIGFkRGlzYWJsZSgpOwogICAgc2V0VGltZW91dCgoKSA9PiBzZWFyY2hFbmhhbmNlKCksIDEwMDApOwogICAgZmVhdHVyZXMuY29tbWVudExvYWQuaXNFbmFibGUoKSAmJiBjb21tZW50QXV0b0xvYWQoKTsKICAgIGZlYXR1cmVzLmFudGlSZWRpcmVjdC5pc0VuYWJsZSgpICYmIGFudGlSZWRpcmVjdCgpOwogICAgYXJ0d29ya1RhZygpOwp9KTsKCg==","requires":[{"meta":{"name":"jquery%20221.js","url":"https://update.greasyfork.org/scripts/505351/1435420/jquery%20221.js","ts":1770962851896,"mimetype":"text/javascript"},"source":"LyohCiAqIGpRdWVyeSBKYXZhU2NyaXB0IExpYnJhcnkgdjIuMi4xCiAqIGh0dHA6Ly9qcXVlcnkuY29tLwogKgogKiBJbmNsdWRlcyBTaXp6bGUuanMKICogaHR0cDovL3NpenpsZWpzLmNvbS8KICoKICogQ29weXJpZ2h0IGpRdWVyeSBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnMKICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlCiAqIGh0dHA6Ly9qcXVlcnkub3JnL2xpY2Vuc2UKICoKICogRGF0ZTogMjAxNi0wMi0yMlQxOToxMVoKICovCgooZnVuY3Rpb24oIGdsb2JhbCwgZmFjdG9yeSApIHsKCglpZiAoIHR5cGVvZiBtb2R1bGUgPT09ICJvYmplY3QiICYmIHR5cGVvZiBtb2R1bGUuZXhwb3J0cyA9PT0gIm9iamVjdCIgKSB7CgkJLy8gRm9yIENvbW1vbkpTIGFuZCBDb21tb25KUy1saWtlIGVudmlyb25tZW50cyB3aGVyZSBhIHByb3BlciBgd2luZG93YAoJCS8vIGlzIHByZXNlbnQsIGV4ZWN1dGUgdGhlIGZhY3RvcnkgYW5kIGdldCBqUXVlcnkuCgkJLy8gRm9yIGVudmlyb25tZW50cyB0aGF0IGRvIG5vdCBoYXZlIGEgYHdpbmRvd2Agd2l0aCBhIGBkb2N1bWVudGAKCQkvLyAoc3VjaCBhcyBOb2RlLmpzKSwgZXhwb3NlIGEgZmFjdG9yeSBhcyBtb2R1bGUuZXhwb3J0cy4KCQkvLyBUaGlzIGFjY2VudHVhdGVzIHRoZSBuZWVkIGZvciB0aGUgY3JlYXRpb24gb2YgYSByZWFsIGB3aW5kb3dgLgoJCS8vIGUuZy4gdmFyIGpRdWVyeSA9IHJlcXVpcmUoImpxdWVyeSIpKHdpbmRvdyk7CgkJLy8gU2VlIHRpY2tldCAjMTQ1NDkgZm9yIG1vcmUgaW5mby4KCQltb2R1bGUuZXhwb3J0cyA9IGdsb2JhbC5kb2N1bWVudCA/CgkJCWZhY3RvcnkoIGdsb2JhbCwgdHJ1ZSApIDoKCQkJZnVuY3Rpb24oIHcgKSB7CgkJCQlpZiAoICF3LmRvY3VtZW50ICkgewoJCQkJCXRocm93IG5ldyBFcnJvciggImpRdWVyeSByZXF1aXJlcyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnQiICk7CgkJCQl9CgkJCQlyZXR1cm4gZmFjdG9yeSggdyApOwoJCQl9OwoJfSBlbHNlIHsKCQlmYWN0b3J5KCBnbG9iYWwgKTsKCX0KCi8vIFBhc3MgdGhpcyBpZiB3aW5kb3cgaXMgbm90IGRlZmluZWQgeWV0Cn0odHlwZW9mIHdpbmRvdyAhPT0gInVuZGVmaW5lZCIgPyB3aW5kb3cgOiB0aGlzLCBmdW5jdGlvbiggd2luZG93LCBub0dsb2JhbCApIHsKCi8vIFN1cHBvcnQ6IEZpcmVmb3ggMTgrCi8vIENhbid0IGJlIGluIHN0cmljdCBtb2RlLCBzZXZlcmFsIGxpYnMgaW5jbHVkaW5nIEFTUC5ORVQgdHJhY2UKLy8gdGhlIHN0YWNrIHZpYSBhcmd1bWVudHMuY2FsbGVyLmNhbGxlZSBhbmQgRmlyZWZveCBkaWVzIGlmCi8vIHlvdSB0cnkgdG8gdHJhY2UgdGhyb3VnaCAidXNlIHN0cmljdCIgY2FsbCBjaGFpbnMuICgjMTMzMzUpCi8vInVzZSBzdHJpY3QiOwp2YXIgYXJyID0gW107Cgp2YXIgZG9jdW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQ7Cgp2YXIgc2xpY2UgPSBhcnIuc2xpY2U7Cgp2YXIgY29uY2F0ID0gYXJyLmNvbmNhdDsKCnZhciBwdXNoID0gYXJyLnB1c2g7Cgp2YXIgaW5kZXhPZiA9IGFyci5pbmRleE9mOwoKdmFyIGNsYXNzMnR5cGUgPSB7fTsKCnZhciB0b1N0cmluZyA9IGNsYXNzMnR5cGUudG9TdHJpbmc7Cgp2YXIgaGFzT3duID0gY2xhc3MydHlwZS5oYXNPd25Qcm9wZXJ0eTsKCnZhciBzdXBwb3J0ID0ge307CgoKCnZhcgoJdmVyc2lvbiA9ICIyLjIuMSIsCgoJLy8gRGVmaW5lIGEgbG9jYWwgY29weSBvZiBqUXVlcnkKCWpRdWVyeSA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCApIHsKCgkJLy8gVGhlIGpRdWVyeSBvYmplY3QgaXMgYWN0dWFsbHkganVzdCB0aGUgaW5pdCBjb25zdHJ1Y3RvciAnZW5oYW5jZWQnCgkJLy8gTmVlZCBpbml0IGlmIGpRdWVyeSBpcyBjYWxsZWQgKGp1c3QgYWxsb3cgZXJyb3IgdG8gYmUgdGhyb3duIGlmIG5vdCBpbmNsdWRlZCkKCQlyZXR1cm4gbmV3IGpRdWVyeS5mbi5pbml0KCBzZWxlY3RvciwgY29udGV4dCApOwoJfSwKCgkvLyBTdXBwb3J0OiBBbmRyb2lkPDQuMQoJLy8gTWFrZSBzdXJlIHdlIHRyaW0gQk9NIGFuZCBOQlNQCglydHJpbSA9IC9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZywKCgkvLyBNYXRjaGVzIGRhc2hlZCBzdHJpbmcgZm9yIGNhbWVsaXppbmcKCXJtc1ByZWZpeCA9IC9eLW1zLS8sCglyZGFzaEFscGhhID0gLy0oW1xkYS16XSkvZ2ksCgoJLy8gVXNlZCBieSBqUXVlcnkuY2FtZWxDYXNlIGFzIGNhbGxiYWNrIHRvIHJlcGxhY2UoKQoJZmNhbWVsQ2FzZSA9IGZ1bmN0aW9uKCBhbGwsIGxldHRlciApIHsKCQlyZXR1cm4gbGV0dGVyLnRvVXBwZXJDYXNlKCk7Cgl9OwoKalF1ZXJ5LmZuID0galF1ZXJ5LnByb3RvdHlwZSA9IHsKCgkvLyBUaGUgY3VycmVudCB2ZXJzaW9uIG9mIGpRdWVyeSBiZWluZyB1c2VkCglqcXVlcnk6IHZlcnNpb24sCgoJY29uc3RydWN0b3I6IGpRdWVyeSwKCgkvLyBTdGFydCB3aXRoIGFuIGVtcHR5IHNlbGVjdG9yCglzZWxlY3RvcjogIiIsCgoJLy8gVGhlIGRlZmF1bHQgbGVuZ3RoIG9mIGEgalF1ZXJ5IG9iamVjdCBpcyAwCglsZW5ndGg6IDAsCgoJdG9BcnJheTogZnVuY3Rpb24oKSB7CgkJcmV0dXJuIHNsaWNlLmNhbGwoIHRoaXMgKTsKCX0sCgoJLy8gR2V0IHRoZSBOdGggZWxlbWVudCBpbiB0aGUgbWF0Y2hlZCBlbGVtZW50IHNldCBPUgoJLy8gR2V0IHRoZSB3aG9sZSBtYXRjaGVkIGVsZW1lbnQgc2V0IGFzIGEgY2xlYW4gYXJyYXkKCWdldDogZnVuY3Rpb24oIG51bSApIHsKCQlyZXR1cm4gbnVtICE9IG51bGwgPwoKCQkJLy8gUmV0dXJuIGp1c3QgdGhlIG9uZSBlbGVtZW50IGZyb20gdGhlIHNldAoJCQkoIG51bSA8IDAgPyB0aGlzWyBudW0gKyB0aGlzLmxlbmd0aCBdIDogdGhpc1sgbnVtIF0gKSA6CgoJCQkvLyBSZXR1cm4gYWxsIHRoZSBlbGVtZW50cyBpbiBhIGNsZWFuIGFycmF5CgkJCXNsaWNlLmNhbGwoIHRoaXMgKTsKCX0sCgoJLy8gVGFrZSBhbiBhcnJheSBvZiBlbGVtZW50cyBhbmQgcHVzaCBpdCBvbnRvIHRoZSBzdGFjawoJLy8gKHJldHVybmluZyB0aGUgbmV3IG1hdGNoZWQgZWxlbWVudCBzZXQpCglwdXNoU3RhY2s6IGZ1bmN0aW9uKCBlbGVtcyApIHsKCgkJLy8gQnVpbGQgYSBuZXcgalF1ZXJ5IG1hdGNoZWQgZWxlbWVudCBzZXQKCQl2YXIgcmV0ID0galF1ZXJ5Lm1lcmdlKCB0aGlzLmNvbnN0cnVjdG9yKCksIGVsZW1zICk7CgoJCS8vIEFkZCB0aGUgb2xkIG9iamVjdCBvbnRvIHRoZSBzdGFjayAoYXMgYSByZWZlcmVuY2UpCgkJcmV0LnByZXZPYmplY3QgPSB0aGlzOwoJCXJldC5jb250ZXh0ID0gdGhpcy5jb250ZXh0OwoKCQkvLyBSZXR1cm4gdGhlIG5ld2x5LWZvcm1lZCBlbGVtZW50IHNldAoJCXJldHVybiByZXQ7Cgl9LAoKCS8vIEV4ZWN1dGUgYSBjYWxsYmFjayBmb3IgZXZlcnkgZWxlbWVudCBpbiB0aGUgbWF0Y2hlZCBzZXQuCgllYWNoOiBmdW5jdGlvbiggY2FsbGJhY2sgKSB7CgkJcmV0dXJuIGpRdWVyeS5lYWNoKCB0aGlzLCBjYWxsYmFjayApOwoJfSwKCgltYXA6IGZ1bmN0aW9uKCBjYWxsYmFjayApIHsKCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soIGpRdWVyeS5tYXAoIHRoaXMsIGZ1bmN0aW9uKCBlbGVtLCBpICkgewoJCQlyZXR1cm4gY2FsbGJhY2suY2FsbCggZWxlbSwgaSwgZWxlbSApOwoJCX0gKSApOwoJfSwKCglzbGljZTogZnVuY3Rpb24oKSB7CgkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBzbGljZS5hcHBseSggdGhpcywgYXJndW1lbnRzICkgKTsKCX0sCgoJZmlyc3Q6IGZ1bmN0aW9uKCkgewoJCXJldHVybiB0aGlzLmVxKCAwICk7Cgl9LAoKCWxhc3Q6IGZ1bmN0aW9uKCkgewoJCXJldHVybiB0aGlzLmVxKCAtMSApOwoJfSwKCgllcTogZnVuY3Rpb24oIGkgKSB7CgkJdmFyIGxlbiA9IHRoaXMubGVuZ3RoLAoJCQlqID0gK2kgKyAoIGkgPCAwID8gbGVuIDogMCApOwoJCXJldHVybiB0aGlzLnB1c2hTdGFjayggaiA+PSAwICYmIGogPCBsZW4gPyBbIHRoaXNbIGogXSBdIDogW10gKTsKCX0sCgoJZW5kOiBmdW5jdGlvbigpIHsKCQlyZXR1cm4gdGhpcy5wcmV2T2JqZWN0IHx8IHRoaXMuY29uc3RydWN0b3IoKTsKCX0sCgoJLy8gRm9yIGludGVybmFsIHVzZSBvbmx5LgoJLy8gQmVoYXZlcyBsaWtlIGFuIEFycmF5J3MgbWV0aG9kLCBub3QgbGlrZSBhIGpRdWVyeSBtZXRob2QuCglwdXNoOiBwdXNoLAoJc29ydDogYXJyLnNvcnQsCglzcGxpY2U6IGFyci5zcGxpY2UKfTsKCmpRdWVyeS5leHRlbmQgPSBqUXVlcnkuZm4uZXh0ZW5kID0gZnVuY3Rpb24oKSB7Cgl2YXIgb3B0aW9ucywgbmFtZSwgc3JjLCBjb3B5LCBjb3B5SXNBcnJheSwgY2xvbmUsCgkJdGFyZ2V0ID0gYXJndW1lbnRzWyAwIF0gfHwge30sCgkJaSA9IDEsCgkJbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aCwKCQlkZWVwID0gZmFsc2U7CgoJLy8gSGFuZGxlIGEgZGVlcCBjb3B5IHNpdHVhdGlvbgoJaWYgKCB0eXBlb2YgdGFyZ2V0ID09PSAiYm9vbGVhbiIgKSB7CgkJZGVlcCA9IHRhcmdldDsKCgkJLy8gU2tpcCB0aGUgYm9vbGVhbiBhbmQgdGhlIHRhcmdldAoJCXRhcmdldCA9IGFyZ3VtZW50c1sgaSBdIHx8IHt9OwoJCWkrKzsKCX0KCgkvLyBIYW5kbGUgY2FzZSB3aGVuIHRhcmdldCBpcyBhIHN0cmluZyBvciBzb21ldGhpbmcgKHBvc3NpYmxlIGluIGRlZXAgY29weSkKCWlmICggdHlwZW9mIHRhcmdldCAhPT0gIm9iamVjdCIgJiYgIWpRdWVyeS5pc0Z1bmN0aW9uKCB0YXJnZXQgKSApIHsKCQl0YXJnZXQgPSB7fTsKCX0KCgkvLyBFeHRlbmQgalF1ZXJ5IGl0c2VsZiBpZiBvbmx5IG9uZSBhcmd1bWVudCBpcyBwYXNzZWQKCWlmICggaSA9PT0gbGVuZ3RoICkgewoJCXRhcmdldCA9IHRoaXM7CgkJaS0tOwoJfQoKCWZvciAoIDsgaSA8IGxlbmd0aDsgaSsrICkgewoKCQkvLyBPbmx5IGRlYWwgd2l0aCBub24tbnVsbC91bmRlZmluZWQgdmFsdWVzCgkJaWYgKCAoIG9wdGlvbnMgPSBhcmd1bWVudHNbIGkgXSApICE9IG51bGwgKSB7CgoJCQkvLyBFeHRlbmQgdGhlIGJhc2Ugb2JqZWN0CgkJCWZvciAoIG5hbWUgaW4gb3B0aW9ucyApIHsKCQkJCXNyYyA9IHRhcmdldFsgbmFtZSBdOwoJCQkJY29weSA9IG9wdGlvbnNbIG5hbWUgXTsKCgkJCQkvLyBQcmV2ZW50IG5ldmVyLWVuZGluZyBsb29wCgkJCQlpZiAoIHRhcmdldCA9PT0gY29weSApIHsKCQkJCQljb250aW51ZTsKCQkJCX0KCgkJCQkvLyBSZWN1cnNlIGlmIHdlJ3JlIG1lcmdpbmcgcGxhaW4gb2JqZWN0cyBvciBhcnJheXMKCQkJCWlmICggZGVlcCAmJiBjb3B5ICYmICggalF1ZXJ5LmlzUGxhaW5PYmplY3QoIGNvcHkgKSB8fAoJCQkJCSggY29weUlzQXJyYXkgPSBqUXVlcnkuaXNBcnJheSggY29weSApICkgKSApIHsKCgkJCQkJaWYgKCBjb3B5SXNBcnJheSApIHsKCQkJCQkJY29weUlzQXJyYXkgPSBmYWxzZTsKCQkJCQkJY2xvbmUgPSBzcmMgJiYgalF1ZXJ5LmlzQXJyYXkoIHNyYyApID8gc3JjIDogW107CgoJCQkJCX0gZWxzZSB7CgkJCQkJCWNsb25lID0gc3JjICYmIGpRdWVyeS5pc1BsYWluT2JqZWN0KCBzcmMgKSA/IHNyYyA6IHt9OwoJCQkJCX0KCgkJCQkJLy8gTmV2ZXIgbW92ZSBvcmlnaW5hbCBvYmplY3RzLCBjbG9uZSB0aGVtCgkJCQkJdGFyZ2V0WyBuYW1lIF0gPSBqUXVlcnkuZXh0ZW5kKCBkZWVwLCBjbG9uZSwgY29weSApOwoKCQkJCS8vIERvbid0IGJyaW5nIGluIHVuZGVmaW5lZCB2YWx1ZXMKCQkJCX0gZWxzZSBpZiAoIGNvcHkgIT09IHVuZGVmaW5lZCApIHsKCQkJCQl0YXJnZXRbIG5hbWUgXSA9IGNvcHk7CgkJCQl9CgkJCX0KCQl9Cgl9CgoJLy8gUmV0dXJuIHRoZSBtb2RpZmllZCBvYmplY3QKCXJldHVybiB0YXJnZXQ7Cn07CgpqUXVlcnkuZXh0ZW5kKCB7CgoJLy8gVW5pcXVlIGZvciBlYWNoIGNvcHkgb2YgalF1ZXJ5IG9uIHRoZSBwYWdlCglleHBhbmRvOiAialF1ZXJ5IiArICggdmVyc2lvbiArIE1hdGgucmFuZG9tKCkgKS5yZXBsYWNlKCAvXEQvZywgIiIgKSwKCgkvLyBBc3N1bWUgalF1ZXJ5IGlzIHJlYWR5IHdpdGhvdXQgdGhlIHJlYWR5IG1vZHVsZQoJaXNSZWFkeTogdHJ1ZSwKCgllcnJvcjogZnVuY3Rpb24oIG1zZyApIHsKCQl0aHJvdyBuZXcgRXJyb3IoIG1zZyApOwoJfSwKCglub29wOiBmdW5jdGlvbigpIHt9LAoKCWlzRnVuY3Rpb246IGZ1bmN0aW9uKCBvYmogKSB7CgkJcmV0dXJuIGpRdWVyeS50eXBlKCBvYmogKSA9PT0gImZ1bmN0aW9uIjsKCX0sCgoJaXNBcnJheTogQXJyYXkuaXNBcnJheSwKCglpc1dpbmRvdzogZnVuY3Rpb24oIG9iaiApIHsKCQlyZXR1cm4gb2JqICE9IG51bGwgJiYgb2JqID09PSBvYmoud2luZG93OwoJfSwKCglpc051bWVyaWM6IGZ1bmN0aW9uKCBvYmogKSB7CgoJCS8vIHBhcnNlRmxvYXQgTmFOcyBudW1lcmljLWNhc3QgZmFsc2UgcG9zaXRpdmVzIChudWxsfHRydWV8ZmFsc2V8IiIpCgkJLy8gLi4uYnV0IG1pc2ludGVycHJldHMgbGVhZGluZy1udW1iZXIgc3RyaW5ncywgcGFydGljdWxhcmx5IGhleCBsaXRlcmFscyAoIjB4Li4uIikKCQkvLyBzdWJ0cmFjdGlvbiBmb3JjZXMgaW5maW5pdGllcyB0byBOYU4KCQkvLyBhZGRpbmcgMSBjb3JyZWN0cyBsb3NzIG9mIHByZWNpc2lvbiBmcm9tIHBhcnNlRmxvYXQgKCMxNTEwMCkKCQl2YXIgcmVhbFN0cmluZ09iaiA9IG9iaiAmJiBvYmoudG9TdHJpbmcoKTsKCQlyZXR1cm4gIWpRdWVyeS5pc0FycmF5KCBvYmogKSAmJiAoIHJlYWxTdHJpbmdPYmogLSBwYXJzZUZsb2F0KCByZWFsU3RyaW5nT2JqICkgKyAxICkgPj0gMDsKCX0sCgoJaXNQbGFpbk9iamVjdDogZnVuY3Rpb24oIG9iaiApIHsKCgkJLy8gTm90IHBsYWluIG9iamVjdHM6CgkJLy8gLSBBbnkgb2JqZWN0IG9yIHZhbHVlIHdob3NlIGludGVybmFsIFtbQ2xhc3NdXSBwcm9wZXJ0eSBpcyBub3QgIltvYmplY3QgT2JqZWN0XSIKCQkvLyAtIERPTSBub2RlcwoJCS8vIC0gd2luZG93CgkJaWYgKCBqUXVlcnkudHlwZSggb2JqICkgIT09ICJvYmplY3QiIHx8IG9iai5ub2RlVHlwZSB8fCBqUXVlcnkuaXNXaW5kb3coIG9iaiApICkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoKCQlpZiAoIG9iai5jb25zdHJ1Y3RvciAmJgoJCQkJIWhhc093bi5jYWxsKCBvYmouY29uc3RydWN0b3IucHJvdG90eXBlLCAiaXNQcm90b3R5cGVPZiIgKSApIHsKCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJLy8gSWYgdGhlIGZ1bmN0aW9uIGhhc24ndCByZXR1cm5lZCBhbHJlYWR5LCB3ZSdyZSBjb25maWRlbnQgdGhhdAoJCS8vIHxvYmp8IGlzIGEgcGxhaW4gb2JqZWN0LCBjcmVhdGVkIGJ5IHt9IG9yIGNvbnN0cnVjdGVkIHdpdGggbmV3IE9iamVjdAoJCXJldHVybiB0cnVlOwoJfSwKCglpc0VtcHR5T2JqZWN0OiBmdW5jdGlvbiggb2JqICkgewoJCXZhciBuYW1lOwoJCWZvciAoIG5hbWUgaW4gb2JqICkgewoJCQlyZXR1cm4gZmFsc2U7CgkJfQoJCXJldHVybiB0cnVlOwoJfSwKCgl0eXBlOiBmdW5jdGlvbiggb2JqICkgewoJCWlmICggb2JqID09IG51bGwgKSB7CgkJCXJldHVybiBvYmogKyAiIjsKCQl9CgoJCS8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4wLCBpT1M8NiAoZnVuY3Rpb25pc2ggUmVnRXhwKQoJCXJldHVybiB0eXBlb2Ygb2JqID09PSAib2JqZWN0IiB8fCB0eXBlb2Ygb2JqID09PSAiZnVuY3Rpb24iID8KCQkJY2xhc3MydHlwZVsgdG9TdHJpbmcuY2FsbCggb2JqICkgXSB8fCAib2JqZWN0IiA6CgkJCXR5cGVvZiBvYmo7Cgl9LAoKCS8vIEV2YWx1YXRlcyBhIHNjcmlwdCBpbiBhIGdsb2JhbCBjb250ZXh0CglnbG9iYWxFdmFsOiBmdW5jdGlvbiggY29kZSApIHsKCQl2YXIgc2NyaXB0LAoJCQlpbmRpcmVjdCA9IGV2YWw7CgoJCWNvZGUgPSBqUXVlcnkudHJpbSggY29kZSApOwoKCQlpZiAoIGNvZGUgKSB7CgoJCQkvLyBJZiB0aGUgY29kZSBpbmNsdWRlcyBhIHZhbGlkLCBwcm9sb2d1ZSBwb3NpdGlvbgoJCQkvLyBzdHJpY3QgbW9kZSBwcmFnbWEsIGV4ZWN1dGUgY29kZSBieSBpbmplY3RpbmcgYQoJCQkvLyBzY3JpcHQgdGFnIGludG8gdGhlIGRvY3VtZW50LgoJCQlpZiAoIGNvZGUuaW5kZXhPZiggInVzZSBzdHJpY3QiICkgPT09IDEgKSB7CgkJCQlzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAic2NyaXB0IiApOwoJCQkJc2NyaXB0LnRleHQgPSBjb2RlOwoJCQkJZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCggc2NyaXB0ICkucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggc2NyaXB0ICk7CgkJCX0gZWxzZSB7CgoJCQkJLy8gT3RoZXJ3aXNlLCBhdm9pZCB0aGUgRE9NIG5vZGUgY3JlYXRpb24sIGluc2VydGlvbgoJCQkJLy8gYW5kIHJlbW92YWwgYnkgdXNpbmcgYW4gaW5kaXJlY3QgZ2xvYmFsIGV2YWwKCgkJCQlpbmRpcmVjdCggY29kZSApOwoJCQl9CgkJfQoJfSwKCgkvLyBDb252ZXJ0IGRhc2hlZCB0byBjYW1lbENhc2U7IHVzZWQgYnkgdGhlIGNzcyBhbmQgZGF0YSBtb2R1bGVzCgkvLyBTdXBwb3J0OiBJRTktMTErCgkvLyBNaWNyb3NvZnQgZm9yZ290IHRvIGh1bXAgdGhlaXIgdmVuZG9yIHByZWZpeCAoIzk1NzIpCgljYW1lbENhc2U6IGZ1bmN0aW9uKCBzdHJpbmcgKSB7CgkJcmV0dXJuIHN0cmluZy5yZXBsYWNlKCBybXNQcmVmaXgsICJtcy0iICkucmVwbGFjZSggcmRhc2hBbHBoYSwgZmNhbWVsQ2FzZSApOwoJfSwKCglub2RlTmFtZTogZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7CgkJcmV0dXJuIGVsZW0ubm9kZU5hbWUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lLnRvTG93ZXJDYXNlKCk7Cgl9LAoKCWVhY2g6IGZ1bmN0aW9uKCBvYmosIGNhbGxiYWNrICkgewoJCXZhciBsZW5ndGgsIGkgPSAwOwoKCQlpZiAoIGlzQXJyYXlMaWtlKCBvYmogKSApIHsKCQkJbGVuZ3RoID0gb2JqLmxlbmd0aDsKCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQlpZiAoIGNhbGxiYWNrLmNhbGwoIG9ialsgaSBdLCBpLCBvYmpbIGkgXSApID09PSBmYWxzZSApIHsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCX0gZWxzZSB7CgkJCWZvciAoIGkgaW4gb2JqICkgewoJCQkJaWYgKCBjYWxsYmFjay5jYWxsKCBvYmpbIGkgXSwgaSwgb2JqWyBpIF0gKSA9PT0gZmFsc2UgKSB7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiBvYmo7Cgl9LAoKCS8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4xCgl0cmltOiBmdW5jdGlvbiggdGV4dCApIHsKCQlyZXR1cm4gdGV4dCA9PSBudWxsID8KCQkJIiIgOgoJCQkoIHRleHQgKyAiIiApLnJlcGxhY2UoIHJ0cmltLCAiIiApOwoJfSwKCgkvLyByZXN1bHRzIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5CgltYWtlQXJyYXk6IGZ1bmN0aW9uKCBhcnIsIHJlc3VsdHMgKSB7CgkJdmFyIHJldCA9IHJlc3VsdHMgfHwgW107CgoJCWlmICggYXJyICE9IG51bGwgKSB7CgkJCWlmICggaXNBcnJheUxpa2UoIE9iamVjdCggYXJyICkgKSApIHsKCQkJCWpRdWVyeS5tZXJnZSggcmV0LAoJCQkJCXR5cGVvZiBhcnIgPT09ICJzdHJpbmciID8KCQkJCQlbIGFyciBdIDogYXJyCgkJCQkpOwoJCQl9IGVsc2UgewoJCQkJcHVzaC5jYWxsKCByZXQsIGFyciApOwoJCQl9CgkJfQoKCQlyZXR1cm4gcmV0OwoJfSwKCglpbkFycmF5OiBmdW5jdGlvbiggZWxlbSwgYXJyLCBpICkgewoJCXJldHVybiBhcnIgPT0gbnVsbCA/IC0xIDogaW5kZXhPZi5jYWxsKCBhcnIsIGVsZW0sIGkgKTsKCX0sCgoJbWVyZ2U6IGZ1bmN0aW9uKCBmaXJzdCwgc2Vjb25kICkgewoJCXZhciBsZW4gPSArc2Vjb25kLmxlbmd0aCwKCQkJaiA9IDAsCgkJCWkgPSBmaXJzdC5sZW5ndGg7CgoJCWZvciAoIDsgaiA8IGxlbjsgaisrICkgewoJCQlmaXJzdFsgaSsrIF0gPSBzZWNvbmRbIGogXTsKCQl9CgoJCWZpcnN0Lmxlbmd0aCA9IGk7CgoJCXJldHVybiBmaXJzdDsKCX0sCgoJZ3JlcDogZnVuY3Rpb24oIGVsZW1zLCBjYWxsYmFjaywgaW52ZXJ0ICkgewoJCXZhciBjYWxsYmFja0ludmVyc2UsCgkJCW1hdGNoZXMgPSBbXSwKCQkJaSA9IDAsCgkJCWxlbmd0aCA9IGVsZW1zLmxlbmd0aCwKCQkJY2FsbGJhY2tFeHBlY3QgPSAhaW52ZXJ0OwoKCQkvLyBHbyB0aHJvdWdoIHRoZSBhcnJheSwgb25seSBzYXZpbmcgdGhlIGl0ZW1zCgkJLy8gdGhhdCBwYXNzIHRoZSB2YWxpZGF0b3IgZnVuY3Rpb24KCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJY2FsbGJhY2tJbnZlcnNlID0gIWNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpICk7CgkJCWlmICggY2FsbGJhY2tJbnZlcnNlICE9PSBjYWxsYmFja0V4cGVjdCApIHsKCQkJCW1hdGNoZXMucHVzaCggZWxlbXNbIGkgXSApOwoJCQl9CgkJfQoKCQlyZXR1cm4gbWF0Y2hlczsKCX0sCgoJLy8gYXJnIGlzIGZvciBpbnRlcm5hbCB1c2FnZSBvbmx5CgltYXA6IGZ1bmN0aW9uKCBlbGVtcywgY2FsbGJhY2ssIGFyZyApIHsKCQl2YXIgbGVuZ3RoLCB2YWx1ZSwKCQkJaSA9IDAsCgkJCXJldCA9IFtdOwoKCQkvLyBHbyB0aHJvdWdoIHRoZSBhcnJheSwgdHJhbnNsYXRpbmcgZWFjaCBvZiB0aGUgaXRlbXMgdG8gdGhlaXIgbmV3IHZhbHVlcwoJCWlmICggaXNBcnJheUxpa2UoIGVsZW1zICkgKSB7CgkJCWxlbmd0aCA9IGVsZW1zLmxlbmd0aDsKCQkJZm9yICggOyBpIDwgbGVuZ3RoOyBpKysgKSB7CgkJCQl2YWx1ZSA9IGNhbGxiYWNrKCBlbGVtc1sgaSBdLCBpLCBhcmcgKTsKCgkJCQlpZiAoIHZhbHVlICE9IG51bGwgKSB7CgkJCQkJcmV0LnB1c2goIHZhbHVlICk7CgkJCQl9CgkJCX0KCgkJLy8gR28gdGhyb3VnaCBldmVyeSBrZXkgb24gdGhlIG9iamVjdCwKCQl9IGVsc2UgewoJCQlmb3IgKCBpIGluIGVsZW1zICkgewoJCQkJdmFsdWUgPSBjYWxsYmFjayggZWxlbXNbIGkgXSwgaSwgYXJnICk7CgoJCQkJaWYgKCB2YWx1ZSAhPSBudWxsICkgewoJCQkJCXJldC5wdXNoKCB2YWx1ZSApOwoJCQkJfQoJCQl9CgkJfQoKCQkvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzCgkJcmV0dXJuIGNvbmNhdC5hcHBseSggW10sIHJldCApOwoJfSwKCgkvLyBBIGdsb2JhbCBHVUlEIGNvdW50ZXIgZm9yIG9iamVjdHMKCWd1aWQ6IDEsCgoJLy8gQmluZCBhIGZ1bmN0aW9uIHRvIGEgY29udGV4dCwgb3B0aW9uYWxseSBwYXJ0aWFsbHkgYXBwbHlpbmcgYW55CgkvLyBhcmd1bWVudHMuCglwcm94eTogZnVuY3Rpb24oIGZuLCBjb250ZXh0ICkgewoJCXZhciB0bXAsIGFyZ3MsIHByb3h5OwoKCQlpZiAoIHR5cGVvZiBjb250ZXh0ID09PSAic3RyaW5nIiApIHsKCQkJdG1wID0gZm5bIGNvbnRleHQgXTsKCQkJY29udGV4dCA9IGZuOwoJCQlmbiA9IHRtcDsKCQl9CgoJCS8vIFF1aWNrIGNoZWNrIHRvIGRldGVybWluZSBpZiB0YXJnZXQgaXMgY2FsbGFibGUsIGluIHRoZSBzcGVjCgkJLy8gdGhpcyB0aHJvd3MgYSBUeXBlRXJyb3IsIGJ1dCB3ZSB3aWxsIGp1c3QgcmV0dXJuIHVuZGVmaW5lZC4KCQlpZiAoICFqUXVlcnkuaXNGdW5jdGlvbiggZm4gKSApIHsKCQkJcmV0dXJuIHVuZGVmaW5lZDsKCQl9CgoJCS8vIFNpbXVsYXRlZCBiaW5kCgkJYXJncyA9IHNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMiApOwoJCXByb3h5ID0gZnVuY3Rpb24oKSB7CgkJCXJldHVybiBmbi5hcHBseSggY29udGV4dCB8fCB0aGlzLCBhcmdzLmNvbmNhdCggc2xpY2UuY2FsbCggYXJndW1lbnRzICkgKSApOwoJCX07CgoJCS8vIFNldCB0aGUgZ3VpZCBvZiB1bmlxdWUgaGFuZGxlciB0byB0aGUgc2FtZSBvZiBvcmlnaW5hbCBoYW5kbGVyLCBzbyBpdCBjYW4gYmUgcmVtb3ZlZAoJCXByb3h5Lmd1aWQgPSBmbi5ndWlkID0gZm4uZ3VpZCB8fCBqUXVlcnkuZ3VpZCsrOwoKCQlyZXR1cm4gcHJveHk7Cgl9LAoKCW5vdzogRGF0ZS5ub3csCgoJLy8galF1ZXJ5LnN1cHBvcnQgaXMgbm90IHVzZWQgaW4gQ29yZSBidXQgb3RoZXIgcHJvamVjdHMgYXR0YWNoIHRoZWlyCgkvLyBwcm9wZXJ0aWVzIHRvIGl0IHNvIGl0IG5lZWRzIHRvIGV4aXN0LgoJc3VwcG9ydDogc3VwcG9ydAp9ICk7CgovLyBKU0hpbnQgd291bGQgZXJyb3Igb24gdGhpcyBjb2RlIGR1ZSB0byB0aGUgU3ltYm9sIG5vdCBiZWluZyBkZWZpbmVkIGluIEVTNS4KLy8gRGVmaW5pbmcgdGhpcyBnbG9iYWwgaW4gLmpzaGludHJjIHdvdWxkIGNyZWF0ZSBhIGRhbmdlciBvZiB1c2luZyB0aGUgZ2xvYmFsCi8vIHVuZ3VhcmRlZCBpbiBhbm90aGVyIHBsYWNlLCBpdCBzZWVtcyBzYWZlciB0byBqdXN0IGRpc2FibGUgSlNIaW50IGZvciB0aGVzZQovLyB0aHJlZSBsaW5lcy4KLyoganNoaW50IGlnbm9yZTogc3RhcnQgKi8KaWYgKCB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICkgewoJalF1ZXJ5LmZuWyBTeW1ib2wuaXRlcmF0b3IgXSA9IGFyclsgU3ltYm9sLml0ZXJhdG9yIF07Cn0KLyoganNoaW50IGlnbm9yZTogZW5kICovCgovLyBQb3B1bGF0ZSB0aGUgY2xhc3MydHlwZSBtYXAKalF1ZXJ5LmVhY2goICJCb29sZWFuIE51bWJlciBTdHJpbmcgRnVuY3Rpb24gQXJyYXkgRGF0ZSBSZWdFeHAgT2JqZWN0IEVycm9yIFN5bWJvbCIuc3BsaXQoICIgIiApLApmdW5jdGlvbiggaSwgbmFtZSApIHsKCWNsYXNzMnR5cGVbICJbb2JqZWN0ICIgKyBuYW1lICsgIl0iIF0gPSBuYW1lLnRvTG93ZXJDYXNlKCk7Cn0gKTsKCmZ1bmN0aW9uIGlzQXJyYXlMaWtlKCBvYmogKSB7CgoJLy8gU3VwcG9ydDogaU9TIDguMiAobm90IHJlcHJvZHVjaWJsZSBpbiBzaW11bGF0b3IpCgkvLyBgaW5gIGNoZWNrIHVzZWQgdG8gcHJldmVudCBKSVQgZXJyb3IgKGdoLTIxNDUpCgkvLyBoYXNPd24gaXNuJ3QgdXNlZCBoZXJlIGR1ZSB0byBmYWxzZSBuZWdhdGl2ZXMKCS8vIHJlZ2FyZGluZyBOb2RlbGlzdCBsZW5ndGggaW4gSUUKCXZhciBsZW5ndGggPSAhIW9iaiAmJiAibGVuZ3RoIiBpbiBvYmogJiYgb2JqLmxlbmd0aCwKCQl0eXBlID0galF1ZXJ5LnR5cGUoIG9iaiApOwoKCWlmICggdHlwZSA9PT0gImZ1bmN0aW9uIiB8fCBqUXVlcnkuaXNXaW5kb3coIG9iaiApICkgewoJCXJldHVybiBmYWxzZTsKCX0KCglyZXR1cm4gdHlwZSA9PT0gImFycmF5IiB8fCBsZW5ndGggPT09IDAgfHwKCQl0eXBlb2YgbGVuZ3RoID09PSAibnVtYmVyIiAmJiBsZW5ndGggPiAwICYmICggbGVuZ3RoIC0gMSApIGluIG9iajsKfQp2YXIgU2l6emxlID0KLyohCiAqIFNpenpsZSBDU1MgU2VsZWN0b3IgRW5naW5lIHYyLjIuMQogKiBodHRwOi8vc2l6emxlanMuY29tLwogKgogKiBDb3B5cmlnaHQgalF1ZXJ5IEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycwogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UKICogaHR0cDovL2pxdWVyeS5vcmcvbGljZW5zZQogKgogKiBEYXRlOiAyMDE1LTEwLTE3CiAqLwooZnVuY3Rpb24oIHdpbmRvdyApIHsKCnZhciBpLAoJc3VwcG9ydCwKCUV4cHIsCglnZXRUZXh0LAoJaXNYTUwsCgl0b2tlbml6ZSwKCWNvbXBpbGUsCglzZWxlY3QsCglvdXRlcm1vc3RDb250ZXh0LAoJc29ydElucHV0LAoJaGFzRHVwbGljYXRlLAoKCS8vIExvY2FsIGRvY3VtZW50IHZhcnMKCXNldERvY3VtZW50LAoJZG9jdW1lbnQsCglkb2NFbGVtLAoJZG9jdW1lbnRJc0hUTUwsCglyYnVnZ3lRU0EsCglyYnVnZ3lNYXRjaGVzLAoJbWF0Y2hlcywKCWNvbnRhaW5zLAoKCS8vIEluc3RhbmNlLXNwZWNpZmljIGRhdGEKCWV4cGFuZG8gPSAic2l6emxlIiArIDEgKiBuZXcgRGF0ZSgpLAoJcHJlZmVycmVkRG9jID0gd2luZG93LmRvY3VtZW50LAoJZGlycnVucyA9IDAsCglkb25lID0gMCwKCWNsYXNzQ2FjaGUgPSBjcmVhdGVDYWNoZSgpLAoJdG9rZW5DYWNoZSA9IGNyZWF0ZUNhY2hlKCksCgljb21waWxlckNhY2hlID0gY3JlYXRlQ2FjaGUoKSwKCXNvcnRPcmRlciA9IGZ1bmN0aW9uKCBhLCBiICkgewoJCWlmICggYSA9PT0gYiApIHsKCQkJaGFzRHVwbGljYXRlID0gdHJ1ZTsKCQl9CgkJcmV0dXJuIDA7Cgl9LAoKCS8vIEdlbmVyYWwtcHVycG9zZSBjb25zdGFudHMKCU1BWF9ORUdBVElWRSA9IDEgPDwgMzEsCgoJLy8gSW5zdGFuY2UgbWV0aG9kcwoJaGFzT3duID0gKHt9KS5oYXNPd25Qcm9wZXJ0eSwKCWFyciA9IFtdLAoJcG9wID0gYXJyLnBvcCwKCXB1c2hfbmF0aXZlID0gYXJyLnB1c2gsCglwdXNoID0gYXJyLnB1c2gsCglzbGljZSA9IGFyci5zbGljZSwKCS8vIFVzZSBhIHN0cmlwcGVkLWRvd24gaW5kZXhPZiBhcyBpdCdzIGZhc3RlciB0aGFuIG5hdGl2ZQoJLy8gaHR0cDovL2pzcGVyZi5jb20vdGhvci1pbmRleG9mLXZzLWZvci81CglpbmRleE9mID0gZnVuY3Rpb24oIGxpc3QsIGVsZW0gKSB7CgkJdmFyIGkgPSAwLAoJCQlsZW4gPSBsaXN0Lmxlbmd0aDsKCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJaWYgKCBsaXN0W2ldID09PSBlbGVtICkgewoJCQkJcmV0dXJuIGk7CgkJCX0KCQl9CgkJcmV0dXJuIC0xOwoJfSwKCglib29sZWFucyA9ICJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZCIsCgoJLy8gUmVndWxhciBleHByZXNzaW9ucwoKCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSL2NzczMtc2VsZWN0b3JzLyN3aGl0ZXNwYWNlCgl3aGl0ZXNwYWNlID0gIltcXHgyMFxcdFxcclxcblxcZl0iLAoKCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSL0NTUzIxL3N5bmRhdGEuaHRtbCN2YWx1ZS1kZWYtaWRlbnRpZmllcgoJaWRlbnRpZmllciA9ICIoPzpcXFxcLnxbXFx3LV18W15cXHgwMC1cXHhhMF0pKyIsCgoJLy8gQXR0cmlidXRlIHNlbGVjdG9yczogaHR0cDovL3d3dy53My5vcmcvVFIvc2VsZWN0b3JzLyNhdHRyaWJ1dGUtc2VsZWN0b3JzCglhdHRyaWJ1dGVzID0gIlxcWyIgKyB3aGl0ZXNwYWNlICsgIiooIiArIGlkZW50aWZpZXIgKyAiKSg/OiIgKyB3aGl0ZXNwYWNlICsKCQkvLyBPcGVyYXRvciAoY2FwdHVyZSAyKQoJCSIqKFsqXiR8IX5dPz0pIiArIHdoaXRlc3BhY2UgKwoJCS8vICJBdHRyaWJ1dGUgdmFsdWVzIG11c3QgYmUgQ1NTIGlkZW50aWZpZXJzIFtjYXB0dXJlIDVdIG9yIHN0cmluZ3MgW2NhcHR1cmUgMyBvciBjYXB0dXJlIDRdIgoJCSIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIgKyBpZGVudGlmaWVyICsgIikpfCkiICsgd2hpdGVzcGFjZSArCgkJIipcXF0iLAoKCXBzZXVkb3MgPSAiOigiICsgaWRlbnRpZmllciArICIpKD86XFwoKCIgKwoJCS8vIFRvIHJlZHVjZSB0aGUgbnVtYmVyIG9mIHNlbGVjdG9ycyBuZWVkaW5nIHRva2VuaXplIGluIHRoZSBwcmVGaWx0ZXIsIHByZWZlciBhcmd1bWVudHM6CgkJLy8gMS4gcXVvdGVkIChjYXB0dXJlIDM7IGNhcHR1cmUgNCBvciBjYXB0dXJlIDUpCgkJIignKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcIil8IiArCgkJLy8gMi4gc2ltcGxlIChjYXB0dXJlIDYpCgkJIigoPzpcXFxcLnxbXlxcXFwoKVtcXF1dfCIgKyBhdHRyaWJ1dGVzICsgIikqKXwiICsKCQkvLyAzLiBhbnl0aGluZyBlbHNlIChjYXB0dXJlIDIpCgkJIi4qIiArCgkJIilcXCl8KSIsCgoJLy8gTGVhZGluZyBhbmQgbm9uLWVzY2FwZWQgdHJhaWxpbmcgd2hpdGVzcGFjZSwgY2FwdHVyaW5nIHNvbWUgbm9uLXdoaXRlc3BhY2UgY2hhcmFjdGVycyBwcmVjZWRpbmcgdGhlIGxhdHRlcgoJcndoaXRlc3BhY2UgPSBuZXcgUmVnRXhwKCB3aGl0ZXNwYWNlICsgIisiLCAiZyIgKSwKCXJ0cmltID0gbmV3IFJlZ0V4cCggIl4iICsgd2hpdGVzcGFjZSArICIrfCgoPzpefFteXFxcXF0pKD86XFxcXC4pKikiICsgd2hpdGVzcGFjZSArICIrJCIsICJnIiApLAoKCXJjb21tYSA9IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKiwiICsgd2hpdGVzcGFjZSArICIqIiApLAoJcmNvbWJpbmF0b3JzID0gbmV3IFJlZ0V4cCggIl4iICsgd2hpdGVzcGFjZSArICIqKFs+K35dfCIgKyB3aGl0ZXNwYWNlICsgIikiICsgd2hpdGVzcGFjZSArICIqIiApLAoKCXJhdHRyaWJ1dGVRdW90ZXMgPSBuZXcgUmVnRXhwKCAiPSIgKyB3aGl0ZXNwYWNlICsgIiooW15cXF0nXCJdKj8pIiArIHdoaXRlc3BhY2UgKyAiKlxcXSIsICJnIiApLAoKCXJwc2V1ZG8gPSBuZXcgUmVnRXhwKCBwc2V1ZG9zICksCglyaWRlbnRpZmllciA9IG5ldyBSZWdFeHAoICJeIiArIGlkZW50aWZpZXIgKyAiJCIgKSwKCgltYXRjaEV4cHIgPSB7CgkJIklEIjogbmV3IFJlZ0V4cCggIl4jKCIgKyBpZGVudGlmaWVyICsgIikiICksCgkJIkNMQVNTIjogbmV3IFJlZ0V4cCggIl5cXC4oIiArIGlkZW50aWZpZXIgKyAiKSIgKSwKCQkiVEFHIjogbmV3IFJlZ0V4cCggIl4oIiArIGlkZW50aWZpZXIgKyAifFsqXSkiICksCgkJIkFUVFIiOiBuZXcgUmVnRXhwKCAiXiIgKyBhdHRyaWJ1dGVzICksCgkJIlBTRVVETyI6IG5ldyBSZWdFeHAoICJeIiArIHBzZXVkb3MgKSwKCQkiQ0hJTEQiOiBuZXcgUmVnRXhwKCAiXjoob25seXxmaXJzdHxsYXN0fG50aHxudGgtbGFzdCktKGNoaWxkfG9mLXR5cGUpKD86XFwoIiArIHdoaXRlc3BhY2UgKwoJCQkiKihldmVufG9kZHwoKFsrLV18KShcXGQqKW58KSIgKyB3aGl0ZXNwYWNlICsgIiooPzooWystXXwpIiArIHdoaXRlc3BhY2UgKwoJCQkiKihcXGQrKXwpKSIgKyB3aGl0ZXNwYWNlICsgIipcXCl8KSIsICJpIiApLAoJCSJib29sIjogbmV3IFJlZ0V4cCggIl4oPzoiICsgYm9vbGVhbnMgKyAiKSQiLCAiaSIgKSwKCQkvLyBGb3IgdXNlIGluIGxpYnJhcmllcyBpbXBsZW1lbnRpbmcgLmlzKCkKCQkvLyBXZSB1c2UgdGhpcyBmb3IgUE9TIG1hdGNoaW5nIGluIGBzZWxlY3RgCgkJIm5lZWRzQ29udGV4dCI6IG5ldyBSZWdFeHAoICJeIiArIHdoaXRlc3BhY2UgKyAiKls+K35dfDooZXZlbnxvZGR8ZXF8Z3R8bHR8bnRofGZpcnN0fGxhc3QpKD86XFwoIiArCgkJCXdoaXRlc3BhY2UgKyAiKigoPzotXFxkKT9cXGQqKSIgKyB3aGl0ZXNwYWNlICsgIipcXCl8KSg/PVteLV18JCkiLCAiaSIgKQoJfSwKCglyaW5wdXRzID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8YnV0dG9uKSQvaSwKCXJoZWFkZXIgPSAvXmhcZCQvaSwKCglybmF0aXZlID0gL15bXntdK1x7XHMqXFtuYXRpdmUgXHcvLAoKCS8vIEVhc2lseS1wYXJzZWFibGUvcmV0cmlldmFibGUgSUQgb3IgVEFHIG9yIENMQVNTIHNlbGVjdG9ycwoJcnF1aWNrRXhwciA9IC9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8sCgoJcnNpYmxpbmcgPSAvWyt+XS8sCglyZXNjYXBlID0gLyd8XFwvZywKCgkvLyBDU1MgZXNjYXBlcyBodHRwOi8vd3d3LnczLm9yZy9UUi9DU1MyMS9zeW5kYXRhLmh0bWwjZXNjYXBlZC1jaGFyYWN0ZXJzCglydW5lc2NhcGUgPSBuZXcgUmVnRXhwKCAiXFxcXChbXFxkYS1mXXsxLDZ9IiArIHdoaXRlc3BhY2UgKyAiP3woIiArIHdoaXRlc3BhY2UgKyAiKXwuKSIsICJpZyIgKSwKCWZ1bmVzY2FwZSA9IGZ1bmN0aW9uKCBfLCBlc2NhcGVkLCBlc2NhcGVkV2hpdGVzcGFjZSApIHsKCQl2YXIgaGlnaCA9ICIweCIgKyBlc2NhcGVkIC0gMHgxMDAwMDsKCQkvLyBOYU4gbWVhbnMgbm9uLWNvZGVwb2ludAoJCS8vIFN1cHBvcnQ6IEZpcmVmb3g8MjQKCQkvLyBXb3JrYXJvdW5kIGVycm9uZW91cyBudW1lcmljIGludGVycHJldGF0aW9uIG9mICsiMHgiCgkJcmV0dXJuIGhpZ2ggIT09IGhpZ2ggfHwgZXNjYXBlZFdoaXRlc3BhY2UgPwoJCQllc2NhcGVkIDoKCQkJaGlnaCA8IDAgPwoJCQkJLy8gQk1QIGNvZGVwb2ludAoJCQkJU3RyaW5nLmZyb21DaGFyQ29kZSggaGlnaCArIDB4MTAwMDAgKSA6CgkJCQkvLyBTdXBwbGVtZW50YWwgUGxhbmUgY29kZXBvaW50IChzdXJyb2dhdGUgcGFpcikKCQkJCVN0cmluZy5mcm9tQ2hhckNvZGUoIGhpZ2ggPj4gMTAgfCAweEQ4MDAsIGhpZ2ggJiAweDNGRiB8IDB4REMwMCApOwoJfSwKCgkvLyBVc2VkIGZvciBpZnJhbWVzCgkvLyBTZWUgc2V0RG9jdW1lbnQoKQoJLy8gUmVtb3ZpbmcgdGhlIGZ1bmN0aW9uIHdyYXBwZXIgY2F1c2VzIGEgIlBlcm1pc3Npb24gRGVuaWVkIgoJLy8gZXJyb3IgaW4gSUUKCXVubG9hZEhhbmRsZXIgPSBmdW5jdGlvbigpIHsKCQlzZXREb2N1bWVudCgpOwoJfTsKCi8vIE9wdGltaXplIGZvciBwdXNoLmFwcGx5KCBfLCBOb2RlTGlzdCApCnRyeSB7CglwdXNoLmFwcGx5KAoJCShhcnIgPSBzbGljZS5jYWxsKCBwcmVmZXJyZWREb2MuY2hpbGROb2RlcyApKSwKCQlwcmVmZXJyZWREb2MuY2hpbGROb2RlcwoJKTsKCS8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4wCgkvLyBEZXRlY3Qgc2lsZW50bHkgZmFpbGluZyBwdXNoLmFwcGx5CglhcnJbIHByZWZlcnJlZERvYy5jaGlsZE5vZGVzLmxlbmd0aCBdLm5vZGVUeXBlOwp9IGNhdGNoICggZSApIHsKCXB1c2ggPSB7IGFwcGx5OiBhcnIubGVuZ3RoID8KCgkJLy8gTGV2ZXJhZ2Ugc2xpY2UgaWYgcG9zc2libGUKCQlmdW5jdGlvbiggdGFyZ2V0LCBlbHMgKSB7CgkJCXB1c2hfbmF0aXZlLmFwcGx5KCB0YXJnZXQsIHNsaWNlLmNhbGwoZWxzKSApOwoJCX0gOgoKCQkvLyBTdXBwb3J0OiBJRTw5CgkJLy8gT3RoZXJ3aXNlIGFwcGVuZCBkaXJlY3RseQoJCWZ1bmN0aW9uKCB0YXJnZXQsIGVscyApIHsKCQkJdmFyIGogPSB0YXJnZXQubGVuZ3RoLAoJCQkJaSA9IDA7CgkJCS8vIENhbid0IHRydXN0IE5vZGVMaXN0Lmxlbmd0aAoJCQl3aGlsZSAoICh0YXJnZXRbaisrXSA9IGVsc1tpKytdKSApIHt9CgkJCXRhcmdldC5sZW5ndGggPSBqIC0gMTsKCQl9Cgl9Owp9CgpmdW5jdGlvbiBTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0LCByZXN1bHRzLCBzZWVkICkgewoJdmFyIG0sIGksIGVsZW0sIG5pZCwgbmlkc2VsZWN0LCBtYXRjaCwgZ3JvdXBzLCBuZXdTZWxlY3RvciwKCQluZXdDb250ZXh0ID0gY29udGV4dCAmJiBjb250ZXh0Lm93bmVyRG9jdW1lbnQsCgoJCS8vIG5vZGVUeXBlIGRlZmF1bHRzIHRvIDksIHNpbmNlIGNvbnRleHQgZGVmYXVsdHMgdG8gZG9jdW1lbnQKCQlub2RlVHlwZSA9IGNvbnRleHQgPyBjb250ZXh0Lm5vZGVUeXBlIDogOTsKCglyZXN1bHRzID0gcmVzdWx0cyB8fCBbXTsKCgkvLyBSZXR1cm4gZWFybHkgZnJvbSBjYWxscyB3aXRoIGludmFsaWQgc2VsZWN0b3Igb3IgY29udGV4dAoJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciIHx8ICFzZWxlY3RvciB8fAoJCW5vZGVUeXBlICE9PSAxICYmIG5vZGVUeXBlICE9PSA5ICYmIG5vZGVUeXBlICE9PSAxMSApIHsKCgkJcmV0dXJuIHJlc3VsdHM7Cgl9CgoJLy8gVHJ5IHRvIHNob3J0Y3V0IGZpbmQgb3BlcmF0aW9ucyAoYXMgb3Bwb3NlZCB0byBmaWx0ZXJzKSBpbiBIVE1MIGRvY3VtZW50cwoJaWYgKCAhc2VlZCApIHsKCgkJaWYgKCAoIGNvbnRleHQgPyBjb250ZXh0Lm93bmVyRG9jdW1lbnQgfHwgY29udGV4dCA6IHByZWZlcnJlZERvYyApICE9PSBkb2N1bWVudCApIHsKCQkJc2V0RG9jdW1lbnQoIGNvbnRleHQgKTsKCQl9CgkJY29udGV4dCA9IGNvbnRleHQgfHwgZG9jdW1lbnQ7CgoJCWlmICggZG9jdW1lbnRJc0hUTUwgKSB7CgoJCQkvLyBJZiB0aGUgc2VsZWN0b3IgaXMgc3VmZmljaWVudGx5IHNpbXBsZSwgdHJ5IHVzaW5nIGEgImdldCpCeSoiIERPTSBtZXRob2QKCQkJLy8gKGV4Y2VwdGluZyBEb2N1bWVudEZyYWdtZW50IGNvbnRleHQsIHdoZXJlIHRoZSBtZXRob2RzIGRvbid0IGV4aXN0KQoJCQlpZiAoIG5vZGVUeXBlICE9PSAxMSAmJiAobWF0Y2ggPSBycXVpY2tFeHByLmV4ZWMoIHNlbGVjdG9yICkpICkgewoKCQkJCS8vIElEIHNlbGVjdG9yCgkJCQlpZiAoIChtID0gbWF0Y2hbMV0pICkgewoKCQkJCQkvLyBEb2N1bWVudCBjb250ZXh0CgkJCQkJaWYgKCBub2RlVHlwZSA9PT0gOSApIHsKCQkJCQkJaWYgKCAoZWxlbSA9IGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQoIG0gKSkgKSB7CgoJCQkJCQkJLy8gU3VwcG9ydDogSUUsIE9wZXJhLCBXZWJraXQKCQkJCQkJCS8vIFRPRE86IGlkZW50aWZ5IHZlcnNpb25zCgkJCQkJCQkvLyBnZXRFbGVtZW50QnlJZCBjYW4gbWF0Y2ggZWxlbWVudHMgYnkgbmFtZSBpbnN0ZWFkIG9mIElECgkJCQkJCQlpZiAoIGVsZW0uaWQgPT09IG0gKSB7CgkJCQkJCQkJcmVzdWx0cy5wdXNoKCBlbGVtICk7CgkJCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJCQl9CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCQkJfQoKCQkJCQkvLyBFbGVtZW50IGNvbnRleHQKCQkJCQl9IGVsc2UgewoKCQkJCQkJLy8gU3VwcG9ydDogSUUsIE9wZXJhLCBXZWJraXQKCQkJCQkJLy8gVE9ETzogaWRlbnRpZnkgdmVyc2lvbnMKCQkJCQkJLy8gZ2V0RWxlbWVudEJ5SWQgY2FuIG1hdGNoIGVsZW1lbnRzIGJ5IG5hbWUgaW5zdGVhZCBvZiBJRAoJCQkJCQlpZiAoIG5ld0NvbnRleHQgJiYgKGVsZW0gPSBuZXdDb250ZXh0LmdldEVsZW1lbnRCeUlkKCBtICkpICYmCgkJCQkJCQljb250YWlucyggY29udGV4dCwgZWxlbSApICYmCgkJCQkJCQllbGVtLmlkID09PSBtICkgewoKCQkJCQkJCXJlc3VsdHMucHVzaCggZWxlbSApOwoJCQkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQkJCX0KCQkJCQl9CgoJCQkJLy8gVHlwZSBzZWxlY3RvcgoJCQkJfSBlbHNlIGlmICggbWF0Y2hbMl0gKSB7CgkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSggc2VsZWN0b3IgKSApOwoJCQkJCXJldHVybiByZXN1bHRzOwoKCQkJCS8vIENsYXNzIHNlbGVjdG9yCgkJCQl9IGVsc2UgaWYgKCAobSA9IG1hdGNoWzNdKSAmJiBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYKCQkJCQljb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgKSB7CgoJCQkJCXB1c2guYXBwbHkoIHJlc3VsdHMsIGNvbnRleHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggbSApICk7CgkJCQkJcmV0dXJuIHJlc3VsdHM7CgkJCQl9CgkJCX0KCgkJCS8vIFRha2UgYWR2YW50YWdlIG9mIHF1ZXJ5U2VsZWN0b3JBbGwKCQkJaWYgKCBzdXBwb3J0LnFzYSAmJgoJCQkJIWNvbXBpbGVyQ2FjaGVbIHNlbGVjdG9yICsgIiAiIF0gJiYKCQkJCSghcmJ1Z2d5UVNBIHx8ICFyYnVnZ3lRU0EudGVzdCggc2VsZWN0b3IgKSkgKSB7CgoJCQkJaWYgKCBub2RlVHlwZSAhPT0gMSApIHsKCQkJCQluZXdDb250ZXh0ID0gY29udGV4dDsKCQkJCQluZXdTZWxlY3RvciA9IHNlbGVjdG9yOwoKCQkJCS8vIHFTQSBsb29rcyBvdXRzaWRlIEVsZW1lbnQgY29udGV4dCwgd2hpY2ggaXMgbm90IHdoYXQgd2Ugd2FudAoJCQkJLy8gVGhhbmtzIHRvIEFuZHJldyBEdXBvbnQgZm9yIHRoaXMgd29ya2Fyb3VuZCB0ZWNobmlxdWUKCQkJCS8vIFN1cHBvcnQ6IElFIDw9OAoJCQkJLy8gRXhjbHVkZSBvYmplY3QgZWxlbWVudHMKCQkJCX0gZWxzZSBpZiAoIGNvbnRleHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gIm9iamVjdCIgKSB7CgoJCQkJCS8vIENhcHR1cmUgdGhlIGNvbnRleHQgSUQsIHNldHRpbmcgaXQgZmlyc3QgaWYgbmVjZXNzYXJ5CgkJCQkJaWYgKCAobmlkID0gY29udGV4dC5nZXRBdHRyaWJ1dGUoICJpZCIgKSkgKSB7CgkJCQkJCW5pZCA9IG5pZC5yZXBsYWNlKCByZXNjYXBlLCAiXFwkJiIgKTsKCQkJCQl9IGVsc2UgewoJCQkJCQljb250ZXh0LnNldEF0dHJpYnV0ZSggImlkIiwgKG5pZCA9IGV4cGFuZG8pICk7CgkJCQkJfQoKCQkJCQkvLyBQcmVmaXggZXZlcnkgc2VsZWN0b3IgaW4gdGhlIGxpc3QKCQkJCQlncm91cHMgPSB0b2tlbml6ZSggc2VsZWN0b3IgKTsKCQkJCQlpID0gZ3JvdXBzLmxlbmd0aDsKCQkJCQluaWRzZWxlY3QgPSByaWRlbnRpZmllci50ZXN0KCBuaWQgKSA/ICIjIiArIG5pZCA6ICJbaWQ9JyIgKyBuaWQgKyAiJ10iOwoJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQlncm91cHNbaV0gPSBuaWRzZWxlY3QgKyAiICIgKyB0b1NlbGVjdG9yKCBncm91cHNbaV0gKTsKCQkJCQl9CgkJCQkJbmV3U2VsZWN0b3IgPSBncm91cHMuam9pbiggIiwiICk7CgoJCQkJCS8vIEV4cGFuZCBjb250ZXh0IGZvciBzaWJsaW5nIHNlbGVjdG9ycwoJCQkJCW5ld0NvbnRleHQgPSByc2libGluZy50ZXN0KCBzZWxlY3RvciApICYmIHRlc3RDb250ZXh0KCBjb250ZXh0LnBhcmVudE5vZGUgKSB8fAoJCQkJCQljb250ZXh0OwoJCQkJfQoKCQkJCWlmICggbmV3U2VsZWN0b3IgKSB7CgkJCQkJdHJ5IHsKCQkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywKCQkJCQkJCW5ld0NvbnRleHQucXVlcnlTZWxlY3RvckFsbCggbmV3U2VsZWN0b3IgKQoJCQkJCQkpOwoJCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCQl9IGNhdGNoICggcXNhRXJyb3IgKSB7CgkJCQkJfSBmaW5hbGx5IHsKCQkJCQkJaWYgKCBuaWQgPT09IGV4cGFuZG8gKSB7CgkJCQkJCQljb250ZXh0LnJlbW92ZUF0dHJpYnV0ZSggImlkIiApOwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfQoKCS8vIEFsbCBvdGhlcnMKCXJldHVybiBzZWxlY3QoIHNlbGVjdG9yLnJlcGxhY2UoIHJ0cmltLCAiJDEiICksIGNvbnRleHQsIHJlc3VsdHMsIHNlZWQgKTsKfQoKLyoqCiAqIENyZWF0ZSBrZXktdmFsdWUgY2FjaGVzIG9mIGxpbWl0ZWQgc2l6ZQogKiBAcmV0dXJucyB7ZnVuY3Rpb24oc3RyaW5nLCBvYmplY3QpfSBSZXR1cm5zIHRoZSBPYmplY3QgZGF0YSBhZnRlciBzdG9yaW5nIGl0IG9uIGl0c2VsZiB3aXRoCiAqCXByb3BlcnR5IG5hbWUgdGhlIChzcGFjZS1zdWZmaXhlZCkgc3RyaW5nIGFuZCAoaWYgdGhlIGNhY2hlIGlzIGxhcmdlciB0aGFuIEV4cHIuY2FjaGVMZW5ndGgpCiAqCWRlbGV0aW5nIHRoZSBvbGRlc3QgZW50cnkKICovCmZ1bmN0aW9uIGNyZWF0ZUNhY2hlKCkgewoJdmFyIGtleXMgPSBbXTsKCglmdW5jdGlvbiBjYWNoZSgga2V5LCB2YWx1ZSApIHsKCQkvLyBVc2UgKGtleSArICIgIikgdG8gYXZvaWQgY29sbGlzaW9uIHdpdGggbmF0aXZlIHByb3RvdHlwZSBwcm9wZXJ0aWVzIChzZWUgSXNzdWUgIzE1NykKCQlpZiAoIGtleXMucHVzaCgga2V5ICsgIiAiICkgPiBFeHByLmNhY2hlTGVuZ3RoICkgewoJCQkvLyBPbmx5IGtlZXAgdGhlIG1vc3QgcmVjZW50IGVudHJpZXMKCQkJZGVsZXRlIGNhY2hlWyBrZXlzLnNoaWZ0KCkgXTsKCQl9CgkJcmV0dXJuIChjYWNoZVsga2V5ICsgIiAiIF0gPSB2YWx1ZSk7Cgl9CglyZXR1cm4gY2FjaGU7Cn0KCi8qKgogKiBNYXJrIGEgZnVuY3Rpb24gZm9yIHNwZWNpYWwgdXNlIGJ5IFNpenpsZQogKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgZnVuY3Rpb24gdG8gbWFyawogKi8KZnVuY3Rpb24gbWFya0Z1bmN0aW9uKCBmbiApIHsKCWZuWyBleHBhbmRvIF0gPSB0cnVlOwoJcmV0dXJuIGZuOwp9CgovKioKICogU3VwcG9ydCB0ZXN0aW5nIHVzaW5nIGFuIGVsZW1lbnQKICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gUGFzc2VkIHRoZSBjcmVhdGVkIGRpdiBhbmQgZXhwZWN0cyBhIGJvb2xlYW4gcmVzdWx0CiAqLwpmdW5jdGlvbiBhc3NlcnQoIGZuICkgewoJdmFyIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwoKCXRyeSB7CgkJcmV0dXJuICEhZm4oIGRpdiApOwoJfSBjYXRjaCAoZSkgewoJCXJldHVybiBmYWxzZTsKCX0gZmluYWxseSB7CgkJLy8gUmVtb3ZlIGZyb20gaXRzIHBhcmVudCBieSBkZWZhdWx0CgkJaWYgKCBkaXYucGFyZW50Tm9kZSApIHsKCQkJZGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIGRpdiApOwoJCX0KCQkvLyByZWxlYXNlIG1lbW9yeSBpbiBJRQoJCWRpdiA9IG51bGw7Cgl9Cn0KCi8qKgogKiBBZGRzIHRoZSBzYW1lIGhhbmRsZXIgZm9yIGFsbCBvZiB0aGUgc3BlY2lmaWVkIGF0dHJzCiAqIEBwYXJhbSB7U3RyaW5nfSBhdHRycyBQaXBlLXNlcGFyYXRlZCBsaXN0IG9mIGF0dHJpYnV0ZXMKICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlciBUaGUgbWV0aG9kIHRoYXQgd2lsbCBiZSBhcHBsaWVkCiAqLwpmdW5jdGlvbiBhZGRIYW5kbGUoIGF0dHJzLCBoYW5kbGVyICkgewoJdmFyIGFyciA9IGF0dHJzLnNwbGl0KCJ8IiksCgkJaSA9IGFyci5sZW5ndGg7CgoJd2hpbGUgKCBpLS0gKSB7CgkJRXhwci5hdHRySGFuZGxlWyBhcnJbaV0gXSA9IGhhbmRsZXI7Cgl9Cn0KCi8qKgogKiBDaGVja3MgZG9jdW1lbnQgb3JkZXIgb2YgdHdvIHNpYmxpbmdzCiAqIEBwYXJhbSB7RWxlbWVudH0gYQogKiBAcGFyYW0ge0VsZW1lbnR9IGIKICogQHJldHVybnMge051bWJlcn0gUmV0dXJucyBsZXNzIHRoYW4gMCBpZiBhIHByZWNlZGVzIGIsIGdyZWF0ZXIgdGhhbiAwIGlmIGEgZm9sbG93cyBiCiAqLwpmdW5jdGlvbiBzaWJsaW5nQ2hlY2soIGEsIGIgKSB7Cgl2YXIgY3VyID0gYiAmJiBhLAoJCWRpZmYgPSBjdXIgJiYgYS5ub2RlVHlwZSA9PT0gMSAmJiBiLm5vZGVUeXBlID09PSAxICYmCgkJCSggfmIuc291cmNlSW5kZXggfHwgTUFYX05FR0FUSVZFICkgLQoJCQkoIH5hLnNvdXJjZUluZGV4IHx8IE1BWF9ORUdBVElWRSApOwoKCS8vIFVzZSBJRSBzb3VyY2VJbmRleCBpZiBhdmFpbGFibGUgb24gYm90aCBub2RlcwoJaWYgKCBkaWZmICkgewoJCXJldHVybiBkaWZmOwoJfQoKCS8vIENoZWNrIGlmIGIgZm9sbG93cyBhCglpZiAoIGN1ciApIHsKCQl3aGlsZSAoIChjdXIgPSBjdXIubmV4dFNpYmxpbmcpICkgewoJCQlpZiAoIGN1ciA9PT0gYiApIHsKCQkJCXJldHVybiAtMTsKCQkJfQoJCX0KCX0KCglyZXR1cm4gYSA/IDEgOiAtMTsKfQoKLyoqCiAqIFJldHVybnMgYSBmdW5jdGlvbiB0byB1c2UgaW4gcHNldWRvcyBmb3IgaW5wdXQgdHlwZXMKICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKICovCmZ1bmN0aW9uIGNyZWF0ZUlucHV0UHNldWRvKCB0eXBlICkgewoJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCXZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoJCXJldHVybiBuYW1lID09PSAiaW5wdXQiICYmIGVsZW0udHlwZSA9PT0gdHlwZTsKCX07Cn0KCi8qKgogKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIGJ1dHRvbnMKICogQHBhcmFtIHtTdHJpbmd9IHR5cGUKICovCmZ1bmN0aW9uIGNyZWF0ZUJ1dHRvblBzZXVkbyggdHlwZSApIHsKCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQl2YXIgbmFtZSA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCQlyZXR1cm4gKG5hbWUgPT09ICJpbnB1dCIgfHwgbmFtZSA9PT0gImJ1dHRvbiIpICYmIGVsZW0udHlwZSA9PT0gdHlwZTsKCX07Cn0KCi8qKgogKiBSZXR1cm5zIGEgZnVuY3Rpb24gdG8gdXNlIGluIHBzZXVkb3MgZm9yIHBvc2l0aW9uYWxzCiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuCiAqLwpmdW5jdGlvbiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKCBmbiApIHsKCXJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIGFyZ3VtZW50ICkgewoJCWFyZ3VtZW50ID0gK2FyZ3VtZW50OwoJCXJldHVybiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIG1hdGNoZXMgKSB7CgkJCXZhciBqLAoJCQkJbWF0Y2hJbmRleGVzID0gZm4oIFtdLCBzZWVkLmxlbmd0aCwgYXJndW1lbnQgKSwKCQkJCWkgPSBtYXRjaEluZGV4ZXMubGVuZ3RoOwoKCQkJLy8gTWF0Y2ggZWxlbWVudHMgZm91bmQgYXQgdGhlIHNwZWNpZmllZCBpbmRleGVzCgkJCXdoaWxlICggaS0tICkgewoJCQkJaWYgKCBzZWVkWyAoaiA9IG1hdGNoSW5kZXhlc1tpXSkgXSApIHsKCQkJCQlzZWVkW2pdID0gIShtYXRjaGVzW2pdID0gc2VlZFtqXSk7CgkJCQl9CgkJCX0KCQl9KTsKCX0pOwp9CgovKioKICogQ2hlY2tzIGEgbm9kZSBmb3IgdmFsaWRpdHkgYXMgYSBTaXp6bGUgY29udGV4dAogKiBAcGFyYW0ge0VsZW1lbnR8T2JqZWN0PX0gY29udGV4dAogKiBAcmV0dXJucyB7RWxlbWVudHxPYmplY3R8Qm9vbGVhbn0gVGhlIGlucHV0IG5vZGUgaWYgYWNjZXB0YWJsZSwgb3RoZXJ3aXNlIGEgZmFsc3kgdmFsdWUKICovCmZ1bmN0aW9uIHRlc3RDb250ZXh0KCBjb250ZXh0ICkgewoJcmV0dXJuIGNvbnRleHQgJiYgdHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUgIT09ICJ1bmRlZmluZWQiICYmIGNvbnRleHQ7Cn0KCi8vIEV4cG9zZSBzdXBwb3J0IHZhcnMgZm9yIGNvbnZlbmllbmNlCnN1cHBvcnQgPSBTaXp6bGUuc3VwcG9ydCA9IHt9OwoKLyoqCiAqIERldGVjdHMgWE1MIG5vZGVzCiAqIEBwYXJhbSB7RWxlbWVudHxPYmplY3R9IGVsZW0gQW4gZWxlbWVudCBvciBhIGRvY3VtZW50CiAqIEByZXR1cm5zIHtCb29sZWFufSBUcnVlIGlmZiBlbGVtIGlzIGEgbm9uLUhUTUwgWE1MIG5vZGUKICovCmlzWE1MID0gU2l6emxlLmlzWE1MID0gZnVuY3Rpb24oIGVsZW0gKSB7CgkvLyBkb2N1bWVudEVsZW1lbnQgaXMgdmVyaWZpZWQgZm9yIGNhc2VzIHdoZXJlIGl0IGRvZXNuJ3QgeWV0IGV4aXN0CgkvLyAoc3VjaCBhcyBsb2FkaW5nIGlmcmFtZXMgaW4gSUUgLSAjNDgzMykKCXZhciBkb2N1bWVudEVsZW1lbnQgPSBlbGVtICYmIChlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSkuZG9jdW1lbnRFbGVtZW50OwoJcmV0dXJuIGRvY3VtZW50RWxlbWVudCA/IGRvY3VtZW50RWxlbWVudC5ub2RlTmFtZSAhPT0gIkhUTUwiIDogZmFsc2U7Cn07CgovKioKICogU2V0cyBkb2N1bWVudC1yZWxhdGVkIHZhcmlhYmxlcyBvbmNlIGJhc2VkIG9uIHRoZSBjdXJyZW50IGRvY3VtZW50CiAqIEBwYXJhbSB7RWxlbWVudHxPYmplY3R9IFtkb2NdIEFuIGVsZW1lbnQgb3IgZG9jdW1lbnQgb2JqZWN0IHRvIHVzZSB0byBzZXQgdGhlIGRvY3VtZW50CiAqIEByZXR1cm5zIHtPYmplY3R9IFJldHVybnMgdGhlIGN1cnJlbnQgZG9jdW1lbnQKICovCnNldERvY3VtZW50ID0gU2l6emxlLnNldERvY3VtZW50ID0gZnVuY3Rpb24oIG5vZGUgKSB7Cgl2YXIgaGFzQ29tcGFyZSwgcGFyZW50LAoJCWRvYyA9IG5vZGUgPyBub2RlLm93bmVyRG9jdW1lbnQgfHwgbm9kZSA6IHByZWZlcnJlZERvYzsKCgkvLyBSZXR1cm4gZWFybHkgaWYgZG9jIGlzIGludmFsaWQgb3IgYWxyZWFkeSBzZWxlY3RlZAoJaWYgKCBkb2MgPT09IGRvY3VtZW50IHx8IGRvYy5ub2RlVHlwZSAhPT0gOSB8fCAhZG9jLmRvY3VtZW50RWxlbWVudCApIHsKCQlyZXR1cm4gZG9jdW1lbnQ7Cgl9CgoJLy8gVXBkYXRlIGdsb2JhbCB2YXJpYWJsZXMKCWRvY3VtZW50ID0gZG9jOwoJZG9jRWxlbSA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCWRvY3VtZW50SXNIVE1MID0gIWlzWE1MKCBkb2N1bWVudCApOwoKCS8vIFN1cHBvcnQ6IElFIDktMTEsIEVkZ2UKCS8vIEFjY2Vzc2luZyBpZnJhbWUgZG9jdW1lbnRzIGFmdGVyIHVubG9hZCB0aHJvd3MgInBlcm1pc3Npb24gZGVuaWVkIiBlcnJvcnMgKGpRdWVyeSAjMTM5MzYpCglpZiAoIChwYXJlbnQgPSBkb2N1bWVudC5kZWZhdWx0VmlldykgJiYgcGFyZW50LnRvcCAhPT0gcGFyZW50ICkgewoJCS8vIFN1cHBvcnQ6IElFIDExCgkJaWYgKCBwYXJlbnQuYWRkRXZlbnRMaXN0ZW5lciApIHsKCQkJcGFyZW50LmFkZEV2ZW50TGlzdGVuZXIoICJ1bmxvYWQiLCB1bmxvYWRIYW5kbGVyLCBmYWxzZSApOwoKCQkvLyBTdXBwb3J0OiBJRSA5IC0gMTAgb25seQoJCX0gZWxzZSBpZiAoIHBhcmVudC5hdHRhY2hFdmVudCApIHsKCQkJcGFyZW50LmF0dGFjaEV2ZW50KCAib251bmxvYWQiLCB1bmxvYWRIYW5kbGVyICk7CgkJfQoJfQoKCS8qIEF0dHJpYnV0ZXMKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCgkvLyBTdXBwb3J0OiBJRTw4CgkvLyBWZXJpZnkgdGhhdCBnZXRBdHRyaWJ1dGUgcmVhbGx5IHJldHVybnMgYXR0cmlidXRlcyBhbmQgbm90IHByb3BlcnRpZXMKCS8vIChleGNlcHRpbmcgSUU4IGJvb2xlYW5zKQoJc3VwcG9ydC5hdHRyaWJ1dGVzID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJZGl2LmNsYXNzTmFtZSA9ICJpIjsKCQlyZXR1cm4gIWRpdi5nZXRBdHRyaWJ1dGUoImNsYXNzTmFtZSIpOwoJfSk7CgoJLyogZ2V0RWxlbWVudChzKUJ5KgoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCS8vIENoZWNrIGlmIGdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikgcmV0dXJucyBvbmx5IGVsZW1lbnRzCglzdXBwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJZGl2LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVDb21tZW50KCIiKSApOwoJCXJldHVybiAhZGl2LmdldEVsZW1lbnRzQnlUYWdOYW1lKCIqIikubGVuZ3RoOwoJfSk7CgoJLy8gU3VwcG9ydDogSUU8OQoJc3VwcG9ydC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lID0gcm5hdGl2ZS50ZXN0KCBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lICk7CgoJLy8gU3VwcG9ydDogSUU8MTAKCS8vIENoZWNrIGlmIGdldEVsZW1lbnRCeUlkIHJldHVybnMgZWxlbWVudHMgYnkgbmFtZQoJLy8gVGhlIGJyb2tlbiBnZXRFbGVtZW50QnlJZCBtZXRob2RzIGRvbid0IHBpY2sgdXAgcHJvZ3JhbWF0aWNhbGx5LXNldCBuYW1lcywKCS8vIHNvIHVzZSBhIHJvdW5kYWJvdXQgZ2V0RWxlbWVudHNCeU5hbWUgdGVzdAoJc3VwcG9ydC5nZXRCeUlkID0gYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJZG9jRWxlbS5hcHBlbmRDaGlsZCggZGl2ICkuaWQgPSBleHBhbmRvOwoJCXJldHVybiAhZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUgfHwgIWRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCBleHBhbmRvICkubGVuZ3RoOwoJfSk7CgoJLy8gSUQgZmluZCBhbmQgZmlsdGVyCglpZiAoIHN1cHBvcnQuZ2V0QnlJZCApIHsKCQlFeHByLmZpbmRbIklEIl0gPSBmdW5jdGlvbiggaWQsIGNvbnRleHQgKSB7CgkJCWlmICggdHlwZW9mIGNvbnRleHQuZ2V0RWxlbWVudEJ5SWQgIT09ICJ1bmRlZmluZWQiICYmIGRvY3VtZW50SXNIVE1MICkgewoJCQkJdmFyIG0gPSBjb250ZXh0LmdldEVsZW1lbnRCeUlkKCBpZCApOwoJCQkJcmV0dXJuIG0gPyBbIG0gXSA6IFtdOwoJCQl9CgkJfTsKCQlFeHByLmZpbHRlclsiSUQiXSA9IGZ1bmN0aW9uKCBpZCApIHsKCQkJdmFyIGF0dHJJZCA9IGlkLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSgiaWQiKSA9PT0gYXR0cklkOwoJCQl9OwoJCX07Cgl9IGVsc2UgewoJCS8vIFN1cHBvcnQ6IElFNi83CgkJLy8gZ2V0RWxlbWVudEJ5SWQgaXMgbm90IHJlbGlhYmxlIGFzIGEgZmluZCBzaG9ydGN1dAoJCWRlbGV0ZSBFeHByLmZpbmRbIklEIl07CgoJCUV4cHIuZmlsdGVyWyJJRCJdID0gIGZ1bmN0aW9uKCBpZCApIHsKCQkJdmFyIGF0dHJJZCA9IGlkLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXZhciBub2RlID0gdHlwZW9mIGVsZW0uZ2V0QXR0cmlidXRlTm9kZSAhPT0gInVuZGVmaW5lZCIgJiYKCQkJCQllbGVtLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7CgkJCQlyZXR1cm4gbm9kZSAmJiBub2RlLnZhbHVlID09PSBhdHRySWQ7CgkJCX07CgkJfTsKCX0KCgkvLyBUYWcKCUV4cHIuZmluZFsiVEFHIl0gPSBzdXBwb3J0LmdldEVsZW1lbnRzQnlUYWdOYW1lID8KCQlmdW5jdGlvbiggdGFnLCBjb250ZXh0ICkgewoJCQlpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSAidW5kZWZpbmVkIiApIHsKCQkJCXJldHVybiBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgKTsKCgkJCS8vIERvY3VtZW50RnJhZ21lbnQgbm9kZXMgZG9uJ3QgaGF2ZSBnRUJUTgoJCQl9IGVsc2UgaWYgKCBzdXBwb3J0LnFzYSApIHsKCQkJCXJldHVybiBjb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoIHRhZyApOwoJCQl9CgkJfSA6CgoJCWZ1bmN0aW9uKCB0YWcsIGNvbnRleHQgKSB7CgkJCXZhciBlbGVtLAoJCQkJdG1wID0gW10sCgkJCQlpID0gMCwKCQkJCS8vIEJ5IGhhcHB5IGNvaW5jaWRlbmNlLCBhIChicm9rZW4pIGdFQlROIGFwcGVhcnMgb24gRG9jdW1lbnRGcmFnbWVudCBub2RlcyB0b28KCQkJCXJlc3VsdHMgPSBjb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgKTsKCgkJCS8vIEZpbHRlciBvdXQgcG9zc2libGUgY29tbWVudHMKCQkJaWYgKCB0YWcgPT09ICIqIiApIHsKCQkJCXdoaWxlICggKGVsZW0gPSByZXN1bHRzW2krK10pICkgewoJCQkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJCQkJdG1wLnB1c2goIGVsZW0gKTsKCQkJCQl9CgkJCQl9CgoJCQkJcmV0dXJuIHRtcDsKCQkJfQoJCQlyZXR1cm4gcmVzdWx0czsKCQl9OwoKCS8vIENsYXNzCglFeHByLmZpbmRbIkNMQVNTIl0gPSBzdXBwb3J0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYgZnVuY3Rpb24oIGNsYXNzTmFtZSwgY29udGV4dCApIHsKCQlpZiAoIHR5cGVvZiBjb250ZXh0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUgIT09ICJ1bmRlZmluZWQiICYmIGRvY3VtZW50SXNIVE1MICkgewoJCQlyZXR1cm4gY29udGV4dC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCBjbGFzc05hbWUgKTsKCQl9Cgl9OwoKCS8qIFFTQS9tYXRjaGVzU2VsZWN0b3IKCS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi8KCgkvLyBRU0EgYW5kIG1hdGNoZXNTZWxlY3RvciBzdXBwb3J0CgoJLy8gbWF0Y2hlc1NlbGVjdG9yKDphY3RpdmUpIHJlcG9ydHMgZmFsc2Ugd2hlbiB0cnVlIChJRTkvT3BlcmEgMTEuNSkKCXJidWdneU1hdGNoZXMgPSBbXTsKCgkvLyBxU2EoOmZvY3VzKSByZXBvcnRzIGZhbHNlIHdoZW4gdHJ1ZSAoQ2hyb21lIDIxKQoJLy8gV2UgYWxsb3cgdGhpcyBiZWNhdXNlIG9mIGEgYnVnIGluIElFOC85IHRoYXQgdGhyb3dzIGFuIGVycm9yCgkvLyB3aGVuZXZlciBgZG9jdW1lbnQuYWN0aXZlRWxlbWVudGAgaXMgYWNjZXNzZWQgb24gYW4gaWZyYW1lCgkvLyBTbywgd2UgYWxsb3cgOmZvY3VzIHRvIHBhc3MgdGhyb3VnaCBRU0EgYWxsIHRoZSB0aW1lIHRvIGF2b2lkIHRoZSBJRSBlcnJvcgoJLy8gU2VlIGh0dHA6Ly9idWdzLmpxdWVyeS5jb20vdGlja2V0LzEzMzc4CglyYnVnZ3lRU0EgPSBbXTsKCglpZiAoIChzdXBwb3J0LnFzYSA9IHJuYXRpdmUudGVzdCggZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCApKSApIHsKCQkvLyBCdWlsZCBRU0EgcmVnZXgKCQkvLyBSZWdleCBzdHJhdGVneSBhZG9wdGVkIGZyb20gRGllZ28gUGVyaW5pCgkJYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CgkJCS8vIFNlbGVjdCBpcyBzZXQgdG8gZW1wdHkgc3RyaW5nIG9uIHB1cnBvc2UKCQkJLy8gVGhpcyBpcyB0byB0ZXN0IElFJ3MgdHJlYXRtZW50IG9mIG5vdCBleHBsaWNpdGx5CgkJCS8vIHNldHRpbmcgYSBib29sZWFuIGNvbnRlbnQgYXR0cmlidXRlLAoJCQkvLyBzaW5jZSBpdHMgcHJlc2VuY2Ugc2hvdWxkIGJlIGVub3VnaAoJCQkvLyBodHRwOi8vYnVncy5qcXVlcnkuY29tL3RpY2tldC8xMjM1OQoJCQlkb2NFbGVtLmFwcGVuZENoaWxkKCBkaXYgKS5pbm5lckhUTUwgPSAiPGEgaWQ9JyIgKyBleHBhbmRvICsgIic+PC9hPiIgKwoJCQkJIjxzZWxlY3QgaWQ9JyIgKyBleHBhbmRvICsgIi1cclxcJyBtc2FsbG93Y2FwdHVyZT0nJz4iICsKCQkJCSI8b3B0aW9uIHNlbGVjdGVkPScnPjwvb3B0aW9uPjwvc2VsZWN0PiI7CgoJCQkvLyBTdXBwb3J0OiBJRTgsIE9wZXJhIDExLTEyLjE2CgkJCS8vIE5vdGhpbmcgc2hvdWxkIGJlIHNlbGVjdGVkIHdoZW4gZW1wdHkgc3RyaW5ncyBmb2xsb3cgXj0gb3IgJD0gb3IgKj0KCQkJLy8gVGhlIHRlc3QgYXR0cmlidXRlIG11c3QgYmUgdW5rbm93biBpbiBPcGVyYSBidXQgInNhZmUiIGZvciBXaW5SVAoJCQkvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvaWUvaGg0NjUzODguYXNweCNhdHRyaWJ1dGVfc2VjdGlvbgoJCQlpZiAoIGRpdi5xdWVyeVNlbGVjdG9yQWxsKCJbbXNhbGxvd2NhcHR1cmVePScnXSIpLmxlbmd0aCApIHsKCQkJCXJidWdneVFTQS5wdXNoKCAiWypeJF09IiArIHdoaXRlc3BhY2UgKyAiKig/OicnfFwiXCIpIiApOwoJCQl9CgoJCQkvLyBTdXBwb3J0OiBJRTgKCQkJLy8gQm9vbGVhbiBhdHRyaWJ1dGVzIGFuZCAidmFsdWUiIGFyZSBub3QgdHJlYXRlZCBjb3JyZWN0bHkKCQkJaWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIltzZWxlY3RlZF0iKS5sZW5ndGggKSB7CgkJCQlyYnVnZ3lRU0EucHVzaCggIlxcWyIgKyB3aGl0ZXNwYWNlICsgIiooPzp2YWx1ZXwiICsgYm9vbGVhbnMgKyAiKSIgKTsKCQkJfQoKCQkJLy8gU3VwcG9ydDogQ2hyb21lPDI5LCBBbmRyb2lkPDQuNCwgU2FmYXJpPDcuMCssIGlPUzw3LjArLCBQaGFudG9tSlM8MS45LjgrCgkJCWlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCAiW2lkfj0iICsgZXhwYW5kbyArICItXSIgKS5sZW5ndGggKSB7CgkJCQlyYnVnZ3lRU0EucHVzaCgifj0iKTsKCQkJfQoKCQkJLy8gV2Via2l0L09wZXJhIC0gOmNoZWNrZWQgc2hvdWxkIHJldHVybiBzZWxlY3RlZCBvcHRpb24gZWxlbWVudHMKCQkJLy8gaHR0cDovL3d3dy53My5vcmcvVFIvMjAxMS9SRUMtY3NzMy1zZWxlY3RvcnMtMjAxMTA5MjkvI2NoZWNrZWQKCQkJLy8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHMKCQkJaWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RoICkgewoJCQkJcmJ1Z2d5UVNBLnB1c2goIjpjaGVja2VkIik7CgkJCX0KCgkJCS8vIFN1cHBvcnQ6IFNhZmFyaSA4KywgaU9TIDgrCgkJCS8vIGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xMzY4NTEKCQkJLy8gSW4tcGFnZSBgc2VsZWN0b3IjaWQgc2liaW5nLWNvbWJpbmF0b3Igc2VsZWN0b3JgIGZhaWxzCgkJCWlmICggIWRpdi5xdWVyeVNlbGVjdG9yQWxsKCAiYSMiICsgZXhwYW5kbyArICIrKiIgKS5sZW5ndGggKSB7CgkJCQlyYnVnZ3lRU0EucHVzaCgiLiMuK1srfl0iKTsKCQkJfQoJCX0pOwoKCQlhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQkJLy8gU3VwcG9ydDogV2luZG93cyA4IE5hdGl2ZSBBcHBzCgkJCS8vIFRoZSB0eXBlIGFuZCBuYW1lIGF0dHJpYnV0ZXMgYXJlIHJlc3RyaWN0ZWQgZHVyaW5nIC5pbm5lckhUTUwgYXNzaWdubWVudAoJCQl2YXIgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpOwoJCQlpbnB1dC5zZXRBdHRyaWJ1dGUoICJ0eXBlIiwgImhpZGRlbiIgKTsKCQkJZGl2LmFwcGVuZENoaWxkKCBpbnB1dCApLnNldEF0dHJpYnV0ZSggIm5hbWUiLCAiRCIgKTsKCgkJCS8vIFN1cHBvcnQ6IElFOAoJCQkvLyBFbmZvcmNlIGNhc2Utc2Vuc2l0aXZpdHkgb2YgbmFtZSBhdHRyaWJ1dGUKCQkJaWYgKCBkaXYucXVlcnlTZWxlY3RvckFsbCgiW25hbWU9ZF0iKS5sZW5ndGggKSB7CgkJCQlyYnVnZ3lRU0EucHVzaCggIm5hbWUiICsgd2hpdGVzcGFjZSArICIqWypeJHwhfl0/PSIgKTsKCQkJfQoKCQkJLy8gRkYgMy41IC0gOmVuYWJsZWQvOmRpc2FibGVkIGFuZCBoaWRkZW4gZWxlbWVudHMgKGhpZGRlbiBlbGVtZW50cyBhcmUgc3RpbGwgZW5hYmxlZCkKCQkJLy8gSUU4IHRocm93cyBlcnJvciBoZXJlIGFuZCB3aWxsIG5vdCBzZWUgbGF0ZXIgdGVzdHMKCQkJaWYgKCAhZGl2LnF1ZXJ5U2VsZWN0b3JBbGwoIjplbmFibGVkIikubGVuZ3RoICkgewoJCQkJcmJ1Z2d5UVNBLnB1c2goICI6ZW5hYmxlZCIsICI6ZGlzYWJsZWQiICk7CgkJCX0KCgkJCS8vIE9wZXJhIDEwLTExIGRvZXMgbm90IHRocm93IG9uIHBvc3QtY29tbWEgaW52YWxpZCBwc2V1ZG9zCgkJCWRpdi5xdWVyeVNlbGVjdG9yQWxsKCIqLDp4Iik7CgkJCXJidWdneVFTQS5wdXNoKCIsLio6Iik7CgkJfSk7Cgl9CgoJaWYgKCAoc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3IgPSBybmF0aXZlLnRlc3QoIChtYXRjaGVzID0gZG9jRWxlbS5tYXRjaGVzIHx8CgkJZG9jRWxlbS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwKCQlkb2NFbGVtLm1vek1hdGNoZXNTZWxlY3RvciB8fAoJCWRvY0VsZW0ub01hdGNoZXNTZWxlY3RvciB8fAoJCWRvY0VsZW0ubXNNYXRjaGVzU2VsZWN0b3IpICkpICkgewoKCQlhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCQkJLy8gQ2hlY2sgdG8gc2VlIGlmIGl0J3MgcG9zc2libGUgdG8gZG8gbWF0Y2hlc1NlbGVjdG9yCgkJCS8vIG9uIGEgZGlzY29ubmVjdGVkIG5vZGUgKElFIDkpCgkJCXN1cHBvcnQuZGlzY29ubmVjdGVkTWF0Y2ggPSBtYXRjaGVzLmNhbGwoIGRpdiwgImRpdiIgKTsKCgkJCS8vIFRoaXMgc2hvdWxkIGZhaWwgd2l0aCBhbiBleGNlcHRpb24KCQkJLy8gR2Vja28gZG9lcyBub3QgZXJyb3IsIHJldHVybnMgZmFsc2UgaW5zdGVhZAoJCQltYXRjaGVzLmNhbGwoIGRpdiwgIltzIT0nJ106eCIgKTsKCQkJcmJ1Z2d5TWF0Y2hlcy5wdXNoKCAiIT0iLCBwc2V1ZG9zICk7CgkJfSk7Cgl9CgoJcmJ1Z2d5UVNBID0gcmJ1Z2d5UVNBLmxlbmd0aCAmJiBuZXcgUmVnRXhwKCByYnVnZ3lRU0Euam9pbigifCIpICk7CglyYnVnZ3lNYXRjaGVzID0gcmJ1Z2d5TWF0Y2hlcy5sZW5ndGggJiYgbmV3IFJlZ0V4cCggcmJ1Z2d5TWF0Y2hlcy5qb2luKCJ8IikgKTsKCgkvKiBDb250YWlucwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoJaGFzQ29tcGFyZSA9IHJuYXRpdmUudGVzdCggZG9jRWxlbS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiApOwoKCS8vIEVsZW1lbnQgY29udGFpbnMgYW5vdGhlcgoJLy8gUHVycG9zZWZ1bGx5IHNlbGYtZXhjbHVzaXZlCgkvLyBBcyBpbiwgYW4gZWxlbWVudCBkb2VzIG5vdCBjb250YWluIGl0c2VsZgoJY29udGFpbnMgPSBoYXNDb21wYXJlIHx8IHJuYXRpdmUudGVzdCggZG9jRWxlbS5jb250YWlucyApID8KCQlmdW5jdGlvbiggYSwgYiApIHsKCQkJdmFyIGFkb3duID0gYS5ub2RlVHlwZSA9PT0gOSA/IGEuZG9jdW1lbnRFbGVtZW50IDogYSwKCQkJCWJ1cCA9IGIgJiYgYi5wYXJlbnROb2RlOwoJCQlyZXR1cm4gYSA9PT0gYnVwIHx8ICEhKCBidXAgJiYgYnVwLm5vZGVUeXBlID09PSAxICYmICgKCQkJCWFkb3duLmNvbnRhaW5zID8KCQkJCQlhZG93bi5jb250YWlucyggYnVwICkgOgoJCQkJCWEuY29tcGFyZURvY3VtZW50UG9zaXRpb24gJiYgYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiggYnVwICkgJiAxNgoJCQkpKTsKCQl9IDoKCQlmdW5jdGlvbiggYSwgYiApIHsKCQkJaWYgKCBiICkgewoJCQkJd2hpbGUgKCAoYiA9IGIucGFyZW50Tm9kZSkgKSB7CgkJCQkJaWYgKCBiID09PSBhICkgewoJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJcmV0dXJuIGZhbHNlOwoJCX07CgoJLyogU29ydGluZwoJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqLwoKCS8vIERvY3VtZW50IG9yZGVyIHNvcnRpbmcKCXNvcnRPcmRlciA9IGhhc0NvbXBhcmUgPwoJZnVuY3Rpb24oIGEsIGIgKSB7CgoJCS8vIEZsYWcgZm9yIGR1cGxpY2F0ZSByZW1vdmFsCgkJaWYgKCBhID09PSBiICkgewoJCQloYXNEdXBsaWNhdGUgPSB0cnVlOwoJCQlyZXR1cm4gMDsKCQl9CgoJCS8vIFNvcnQgb24gbWV0aG9kIGV4aXN0ZW5jZSBpZiBvbmx5IG9uZSBpbnB1dCBoYXMgY29tcGFyZURvY3VtZW50UG9zaXRpb24KCQl2YXIgY29tcGFyZSA9ICFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uIC0gIWIuY29tcGFyZURvY3VtZW50UG9zaXRpb247CgkJaWYgKCBjb21wYXJlICkgewoJCQlyZXR1cm4gY29tcGFyZTsKCQl9CgoJCS8vIENhbGN1bGF0ZSBwb3NpdGlvbiBpZiBib3RoIGlucHV0cyBiZWxvbmcgdG8gdGhlIHNhbWUgZG9jdW1lbnQKCQljb21wYXJlID0gKCBhLm93bmVyRG9jdW1lbnQgfHwgYSApID09PSAoIGIub3duZXJEb2N1bWVudCB8fCBiICkgPwoJCQlhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKCBiICkgOgoKCQkJLy8gT3RoZXJ3aXNlIHdlIGtub3cgdGhleSBhcmUgZGlzY29ubmVjdGVkCgkJCTE7CgoJCS8vIERpc2Nvbm5lY3RlZCBub2RlcwoJCWlmICggY29tcGFyZSAmIDEgfHwKCQkJKCFzdXBwb3J0LnNvcnREZXRhY2hlZCAmJiBiLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKCBhICkgPT09IGNvbXBhcmUpICkgewoKCQkJLy8gQ2hvb3NlIHRoZSBmaXJzdCBlbGVtZW50IHRoYXQgaXMgcmVsYXRlZCB0byBvdXIgcHJlZmVycmVkIGRvY3VtZW50CgkJCWlmICggYSA9PT0gZG9jdW1lbnQgfHwgYS5vd25lckRvY3VtZW50ID09PSBwcmVmZXJyZWREb2MgJiYgY29udGFpbnMocHJlZmVycmVkRG9jLCBhKSApIHsKCQkJCXJldHVybiAtMTsKCQkJfQoJCQlpZiAoIGIgPT09IGRvY3VtZW50IHx8IGIub3duZXJEb2N1bWVudCA9PT0gcHJlZmVycmVkRG9jICYmIGNvbnRhaW5zKHByZWZlcnJlZERvYywgYikgKSB7CgkJCQlyZXR1cm4gMTsKCQkJfQoKCQkJLy8gTWFpbnRhaW4gb3JpZ2luYWwgb3JkZXIKCQkJcmV0dXJuIHNvcnRJbnB1dCA/CgkJCQkoIGluZGV4T2YoIHNvcnRJbnB1dCwgYSApIC0gaW5kZXhPZiggc29ydElucHV0LCBiICkgKSA6CgkJCQkwOwoJCX0KCgkJcmV0dXJuIGNvbXBhcmUgJiA0ID8gLTEgOiAxOwoJfSA6CglmdW5jdGlvbiggYSwgYiApIHsKCQkvLyBFeGl0IGVhcmx5IGlmIHRoZSBub2RlcyBhcmUgaWRlbnRpY2FsCgkJaWYgKCBhID09PSBiICkgewoJCQloYXNEdXBsaWNhdGUgPSB0cnVlOwoJCQlyZXR1cm4gMDsKCQl9CgoJCXZhciBjdXIsCgkJCWkgPSAwLAoJCQlhdXAgPSBhLnBhcmVudE5vZGUsCgkJCWJ1cCA9IGIucGFyZW50Tm9kZSwKCQkJYXAgPSBbIGEgXSwKCQkJYnAgPSBbIGIgXTsKCgkJLy8gUGFyZW50bGVzcyBub2RlcyBhcmUgZWl0aGVyIGRvY3VtZW50cyBvciBkaXNjb25uZWN0ZWQKCQlpZiAoICFhdXAgfHwgIWJ1cCApIHsKCQkJcmV0dXJuIGEgPT09IGRvY3VtZW50ID8gLTEgOgoJCQkJYiA9PT0gZG9jdW1lbnQgPyAxIDoKCQkJCWF1cCA/IC0xIDoKCQkJCWJ1cCA/IDEgOgoJCQkJc29ydElucHV0ID8KCQkJCSggaW5kZXhPZiggc29ydElucHV0LCBhICkgLSBpbmRleE9mKCBzb3J0SW5wdXQsIGIgKSApIDoKCQkJCTA7CgoJCS8vIElmIHRoZSBub2RlcyBhcmUgc2libGluZ3MsIHdlIGNhbiBkbyBhIHF1aWNrIGNoZWNrCgkJfSBlbHNlIGlmICggYXVwID09PSBidXAgKSB7CgkJCXJldHVybiBzaWJsaW5nQ2hlY2soIGEsIGIgKTsKCQl9CgoJCS8vIE90aGVyd2lzZSB3ZSBuZWVkIGZ1bGwgbGlzdHMgb2YgdGhlaXIgYW5jZXN0b3JzIGZvciBjb21wYXJpc29uCgkJY3VyID0gYTsKCQl3aGlsZSAoIChjdXIgPSBjdXIucGFyZW50Tm9kZSkgKSB7CgkJCWFwLnVuc2hpZnQoIGN1ciApOwoJCX0KCQljdXIgPSBiOwoJCXdoaWxlICggKGN1ciA9IGN1ci5wYXJlbnROb2RlKSApIHsKCQkJYnAudW5zaGlmdCggY3VyICk7CgkJfQoKCQkvLyBXYWxrIGRvd24gdGhlIHRyZWUgbG9va2luZyBmb3IgYSBkaXNjcmVwYW5jeQoJCXdoaWxlICggYXBbaV0gPT09IGJwW2ldICkgewoJCQlpKys7CgkJfQoKCQlyZXR1cm4gaSA/CgkJCS8vIERvIGEgc2libGluZyBjaGVjayBpZiB0aGUgbm9kZXMgaGF2ZSBhIGNvbW1vbiBhbmNlc3RvcgoJCQlzaWJsaW5nQ2hlY2soIGFwW2ldLCBicFtpXSApIDoKCgkJCS8vIE90aGVyd2lzZSBub2RlcyBpbiBvdXIgZG9jdW1lbnQgc29ydCBmaXJzdAoJCQlhcFtpXSA9PT0gcHJlZmVycmVkRG9jID8gLTEgOgoJCQlicFtpXSA9PT0gcHJlZmVycmVkRG9jID8gMSA6CgkJCTA7Cgl9OwoKCXJldHVybiBkb2N1bWVudDsKfTsKClNpenpsZS5tYXRjaGVzID0gZnVuY3Rpb24oIGV4cHIsIGVsZW1lbnRzICkgewoJcmV0dXJuIFNpenpsZSggZXhwciwgbnVsbCwgbnVsbCwgZWxlbWVudHMgKTsKfTsKClNpenpsZS5tYXRjaGVzU2VsZWN0b3IgPSBmdW5jdGlvbiggZWxlbSwgZXhwciApIHsKCS8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZAoJaWYgKCAoIGVsZW0ub3duZXJEb2N1bWVudCB8fCBlbGVtICkgIT09IGRvY3VtZW50ICkgewoJCXNldERvY3VtZW50KCBlbGVtICk7Cgl9CgoJLy8gTWFrZSBzdXJlIHRoYXQgYXR0cmlidXRlIHNlbGVjdG9ycyBhcmUgcXVvdGVkCglleHByID0gZXhwci5yZXBsYWNlKCByYXR0cmlidXRlUXVvdGVzLCAiPSckMSddIiApOwoKCWlmICggc3VwcG9ydC5tYXRjaGVzU2VsZWN0b3IgJiYgZG9jdW1lbnRJc0hUTUwgJiYKCQkhY29tcGlsZXJDYWNoZVsgZXhwciArICIgIiBdICYmCgkJKCAhcmJ1Z2d5TWF0Y2hlcyB8fCAhcmJ1Z2d5TWF0Y2hlcy50ZXN0KCBleHByICkgKSAmJgoJCSggIXJidWdneVFTQSAgICAgfHwgIXJidWdneVFTQS50ZXN0KCBleHByICkgKSApIHsKCgkJdHJ5IHsKCQkJdmFyIHJldCA9IG1hdGNoZXMuY2FsbCggZWxlbSwgZXhwciApOwoKCQkJLy8gSUUgOSdzIG1hdGNoZXNTZWxlY3RvciByZXR1cm5zIGZhbHNlIG9uIGRpc2Nvbm5lY3RlZCBub2RlcwoJCQlpZiAoIHJldCB8fCBzdXBwb3J0LmRpc2Nvbm5lY3RlZE1hdGNoIHx8CgkJCQkJLy8gQXMgd2VsbCwgZGlzY29ubmVjdGVkIG5vZGVzIGFyZSBzYWlkIHRvIGJlIGluIGEgZG9jdW1lbnQKCQkJCQkvLyBmcmFnbWVudCBpbiBJRSA5CgkJCQkJZWxlbS5kb2N1bWVudCAmJiBlbGVtLmRvY3VtZW50Lm5vZGVUeXBlICE9PSAxMSApIHsKCQkJCXJldHVybiByZXQ7CgkJCX0KCQl9IGNhdGNoIChlKSB7fQoJfQoKCXJldHVybiBTaXp6bGUoIGV4cHIsIGRvY3VtZW50LCBudWxsLCBbIGVsZW0gXSApLmxlbmd0aCA+IDA7Cn07CgpTaXp6bGUuY29udGFpbnMgPSBmdW5jdGlvbiggY29udGV4dCwgZWxlbSApIHsKCS8vIFNldCBkb2N1bWVudCB2YXJzIGlmIG5lZWRlZAoJaWYgKCAoIGNvbnRleHQub3duZXJEb2N1bWVudCB8fCBjb250ZXh0ICkgIT09IGRvY3VtZW50ICkgewoJCXNldERvY3VtZW50KCBjb250ZXh0ICk7Cgl9CglyZXR1cm4gY29udGFpbnMoIGNvbnRleHQsIGVsZW0gKTsKfTsKClNpenpsZS5hdHRyID0gZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7CgkvLyBTZXQgZG9jdW1lbnQgdmFycyBpZiBuZWVkZWQKCWlmICggKCBlbGVtLm93bmVyRG9jdW1lbnQgfHwgZWxlbSApICE9PSBkb2N1bWVudCApIHsKCQlzZXREb2N1bWVudCggZWxlbSApOwoJfQoKCXZhciBmbiA9IEV4cHIuYXR0ckhhbmRsZVsgbmFtZS50b0xvd2VyQ2FzZSgpIF0sCgkJLy8gRG9uJ3QgZ2V0IGZvb2xlZCBieSBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKGpRdWVyeSAjMTM4MDcpCgkJdmFsID0gZm4gJiYgaGFzT3duLmNhbGwoIEV4cHIuYXR0ckhhbmRsZSwgbmFtZS50b0xvd2VyQ2FzZSgpICkgPwoJCQlmbiggZWxlbSwgbmFtZSwgIWRvY3VtZW50SXNIVE1MICkgOgoJCQl1bmRlZmluZWQ7CgoJcmV0dXJuIHZhbCAhPT0gdW5kZWZpbmVkID8KCQl2YWwgOgoJCXN1cHBvcnQuYXR0cmlidXRlcyB8fCAhZG9jdW1lbnRJc0hUTUwgPwoJCQllbGVtLmdldEF0dHJpYnV0ZSggbmFtZSApIDoKCQkJKHZhbCA9IGVsZW0uZ2V0QXR0cmlidXRlTm9kZShuYW1lKSkgJiYgdmFsLnNwZWNpZmllZCA/CgkJCQl2YWwudmFsdWUgOgoJCQkJbnVsbDsKfTsKClNpenpsZS5lcnJvciA9IGZ1bmN0aW9uKCBtc2cgKSB7Cgl0aHJvdyBuZXcgRXJyb3IoICJTeW50YXggZXJyb3IsIHVucmVjb2duaXplZCBleHByZXNzaW9uOiAiICsgbXNnICk7Cn07CgovKioKICogRG9jdW1lbnQgc29ydGluZyBhbmQgcmVtb3ZpbmcgZHVwbGljYXRlcwogKiBAcGFyYW0ge0FycmF5TGlrZX0gcmVzdWx0cwogKi8KU2l6emxlLnVuaXF1ZVNvcnQgPSBmdW5jdGlvbiggcmVzdWx0cyApIHsKCXZhciBlbGVtLAoJCWR1cGxpY2F0ZXMgPSBbXSwKCQlqID0gMCwKCQlpID0gMDsKCgkvLyBVbmxlc3Mgd2UgKmtub3cqIHdlIGNhbiBkZXRlY3QgZHVwbGljYXRlcywgYXNzdW1lIHRoZWlyIHByZXNlbmNlCgloYXNEdXBsaWNhdGUgPSAhc3VwcG9ydC5kZXRlY3REdXBsaWNhdGVzOwoJc29ydElucHV0ID0gIXN1cHBvcnQuc29ydFN0YWJsZSAmJiByZXN1bHRzLnNsaWNlKCAwICk7CglyZXN1bHRzLnNvcnQoIHNvcnRPcmRlciApOwoKCWlmICggaGFzRHVwbGljYXRlICkgewoJCXdoaWxlICggKGVsZW0gPSByZXN1bHRzW2krK10pICkgewoJCQlpZiAoIGVsZW0gPT09IHJlc3VsdHNbIGkgXSApIHsKCQkJCWogPSBkdXBsaWNhdGVzLnB1c2goIGkgKTsKCQkJfQoJCX0KCQl3aGlsZSAoIGotLSApIHsKCQkJcmVzdWx0cy5zcGxpY2UoIGR1cGxpY2F0ZXNbIGogXSwgMSApOwoJCX0KCX0KCgkvLyBDbGVhciBpbnB1dCBhZnRlciBzb3J0aW5nIHRvIHJlbGVhc2Ugb2JqZWN0cwoJLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvc2l6emxlL3B1bGwvMjI1Cglzb3J0SW5wdXQgPSBudWxsOwoKCXJldHVybiByZXN1bHRzOwp9OwoKLyoqCiAqIFV0aWxpdHkgZnVuY3Rpb24gZm9yIHJldHJpZXZpbmcgdGhlIHRleHQgdmFsdWUgb2YgYW4gYXJyYXkgb2YgRE9NIG5vZGVzCiAqIEBwYXJhbSB7QXJyYXl8RWxlbWVudH0gZWxlbQogKi8KZ2V0VGV4dCA9IFNpenpsZS5nZXRUZXh0ID0gZnVuY3Rpb24oIGVsZW0gKSB7Cgl2YXIgbm9kZSwKCQlyZXQgPSAiIiwKCQlpID0gMCwKCQlub2RlVHlwZSA9IGVsZW0ubm9kZVR5cGU7CgoJaWYgKCAhbm9kZVR5cGUgKSB7CgkJLy8gSWYgbm8gbm9kZVR5cGUsIHRoaXMgaXMgZXhwZWN0ZWQgdG8gYmUgYW4gYXJyYXkKCQl3aGlsZSAoIChub2RlID0gZWxlbVtpKytdKSApIHsKCQkJLy8gRG8gbm90IHRyYXZlcnNlIGNvbW1lbnQgbm9kZXMKCQkJcmV0ICs9IGdldFRleHQoIG5vZGUgKTsKCQl9Cgl9IGVsc2UgaWYgKCBub2RlVHlwZSA9PT0gMSB8fCBub2RlVHlwZSA9PT0gOSB8fCBub2RlVHlwZSA9PT0gMTEgKSB7CgkJLy8gVXNlIHRleHRDb250ZW50IGZvciBlbGVtZW50cwoJCS8vIGlubmVyVGV4dCB1c2FnZSByZW1vdmVkIGZvciBjb25zaXN0ZW5jeSBvZiBuZXcgbGluZXMgKGpRdWVyeSAjMTExNTMpCgkJaWYgKCB0eXBlb2YgZWxlbS50ZXh0Q29udGVudCA9PT0gInN0cmluZyIgKSB7CgkJCXJldHVybiBlbGVtLnRleHRDb250ZW50OwoJCX0gZWxzZSB7CgkJCS8vIFRyYXZlcnNlIGl0cyBjaGlsZHJlbgoJCQlmb3IgKCBlbGVtID0gZWxlbS5maXJzdENoaWxkOyBlbGVtOyBlbGVtID0gZWxlbS5uZXh0U2libGluZyApIHsKCQkJCXJldCArPSBnZXRUZXh0KCBlbGVtICk7CgkJCX0KCQl9Cgl9IGVsc2UgaWYgKCBub2RlVHlwZSA9PT0gMyB8fCBub2RlVHlwZSA9PT0gNCApIHsKCQlyZXR1cm4gZWxlbS5ub2RlVmFsdWU7Cgl9CgkvLyBEbyBub3QgaW5jbHVkZSBjb21tZW50IG9yIHByb2Nlc3NpbmcgaW5zdHJ1Y3Rpb24gbm9kZXMKCglyZXR1cm4gcmV0Owp9OwoKRXhwciA9IFNpenpsZS5zZWxlY3RvcnMgPSB7CgoJLy8gQ2FuIGJlIGFkanVzdGVkIGJ5IHRoZSB1c2VyCgljYWNoZUxlbmd0aDogNTAsCgoJY3JlYXRlUHNldWRvOiBtYXJrRnVuY3Rpb24sCgoJbWF0Y2g6IG1hdGNoRXhwciwKCglhdHRySGFuZGxlOiB7fSwKCglmaW5kOiB7fSwKCglyZWxhdGl2ZTogewoJCSI+IjogeyBkaXI6ICJwYXJlbnROb2RlIiwgZmlyc3Q6IHRydWUgfSwKCQkiICI6IHsgZGlyOiAicGFyZW50Tm9kZSIgfSwKCQkiKyI6IHsgZGlyOiAicHJldmlvdXNTaWJsaW5nIiwgZmlyc3Q6IHRydWUgfSwKCQkifiI6IHsgZGlyOiAicHJldmlvdXNTaWJsaW5nIiB9Cgl9LAoKCXByZUZpbHRlcjogewoJCSJBVFRSIjogZnVuY3Rpb24oIG1hdGNoICkgewoJCQltYXRjaFsxXSA9IG1hdGNoWzFdLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICk7CgoJCQkvLyBNb3ZlIHRoZSBnaXZlbiB2YWx1ZSB0byBtYXRjaFszXSB3aGV0aGVyIHF1b3RlZCBvciB1bnF1b3RlZAoJCQltYXRjaFszXSA9ICggbWF0Y2hbM10gfHwgbWF0Y2hbNF0gfHwgbWF0Y2hbNV0gfHwgIiIgKS5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApOwoKCQkJaWYgKCBtYXRjaFsyXSA9PT0gIn49IiApIHsKCQkJCW1hdGNoWzNdID0gIiAiICsgbWF0Y2hbM10gKyAiICI7CgkJCX0KCgkJCXJldHVybiBtYXRjaC5zbGljZSggMCwgNCApOwoJCX0sCgoJCSJDSElMRCI6IGZ1bmN0aW9uKCBtYXRjaCApIHsKCQkJLyogbWF0Y2hlcyBmcm9tIG1hdGNoRXhwclsiQ0hJTEQiXQoJCQkJMSB0eXBlIChvbmx5fG50aHwuLi4pCgkJCQkyIHdoYXQgKGNoaWxkfG9mLXR5cGUpCgkJCQkzIGFyZ3VtZW50IChldmVufG9kZHxcZCp8XGQqbihbKy1dXGQrKT98Li4uKQoJCQkJNCB4bi1jb21wb25lbnQgb2YgeG4reSBhcmd1bWVudCAoWystXT9cZCpufCkKCQkJCTUgc2lnbiBvZiB4bi1jb21wb25lbnQKCQkJCTYgeCBvZiB4bi1jb21wb25lbnQKCQkJCTcgc2lnbiBvZiB5LWNvbXBvbmVudAoJCQkJOCB5IG9mIHktY29tcG9uZW50CgkJCSovCgkJCW1hdGNoWzFdID0gbWF0Y2hbMV0udG9Mb3dlckNhc2UoKTsKCgkJCWlmICggbWF0Y2hbMV0uc2xpY2UoIDAsIDMgKSA9PT0gIm50aCIgKSB7CgkJCQkvLyBudGgtKiByZXF1aXJlcyBhcmd1bWVudAoJCQkJaWYgKCAhbWF0Y2hbM10gKSB7CgkJCQkJU2l6emxlLmVycm9yKCBtYXRjaFswXSApOwoJCQkJfQoKCQkJCS8vIG51bWVyaWMgeCBhbmQgeSBwYXJhbWV0ZXJzIGZvciBFeHByLmZpbHRlci5DSElMRAoJCQkJLy8gcmVtZW1iZXIgdGhhdCBmYWxzZS90cnVlIGNhc3QgcmVzcGVjdGl2ZWx5IHRvIDAvMQoJCQkJbWF0Y2hbNF0gPSArKCBtYXRjaFs0XSA/IG1hdGNoWzVdICsgKG1hdGNoWzZdIHx8IDEpIDogMiAqICggbWF0Y2hbM10gPT09ICJldmVuIiB8fCBtYXRjaFszXSA9PT0gIm9kZCIgKSApOwoJCQkJbWF0Y2hbNV0gPSArKCAoIG1hdGNoWzddICsgbWF0Y2hbOF0gKSB8fCBtYXRjaFszXSA9PT0gIm9kZCIgKTsKCgkJCS8vIG90aGVyIHR5cGVzIHByb2hpYml0IGFyZ3VtZW50cwoJCQl9IGVsc2UgaWYgKCBtYXRjaFszXSApIHsKCQkJCVNpenpsZS5lcnJvciggbWF0Y2hbMF0gKTsKCQkJfQoKCQkJcmV0dXJuIG1hdGNoOwoJCX0sCgoJCSJQU0VVRE8iOiBmdW5jdGlvbiggbWF0Y2ggKSB7CgkJCXZhciBleGNlc3MsCgkJCQl1bnF1b3RlZCA9ICFtYXRjaFs2XSAmJiBtYXRjaFsyXTsKCgkJCWlmICggbWF0Y2hFeHByWyJDSElMRCJdLnRlc3QoIG1hdGNoWzBdICkgKSB7CgkJCQlyZXR1cm4gbnVsbDsKCQkJfQoKCQkJLy8gQWNjZXB0IHF1b3RlZCBhcmd1bWVudHMgYXMtaXMKCQkJaWYgKCBtYXRjaFszXSApIHsKCQkJCW1hdGNoWzJdID0gbWF0Y2hbNF0gfHwgbWF0Y2hbNV0gfHwgIiI7CgoJCQkvLyBTdHJpcCBleGNlc3MgY2hhcmFjdGVycyBmcm9tIHVucXVvdGVkIGFyZ3VtZW50cwoJCQl9IGVsc2UgaWYgKCB1bnF1b3RlZCAmJiBycHNldWRvLnRlc3QoIHVucXVvdGVkICkgJiYKCQkJCS8vIEdldCBleGNlc3MgZnJvbSB0b2tlbml6ZSAocmVjdXJzaXZlbHkpCgkJCQkoZXhjZXNzID0gdG9rZW5pemUoIHVucXVvdGVkLCB0cnVlICkpICYmCgkJCQkvLyBhZHZhbmNlIHRvIHRoZSBuZXh0IGNsb3NpbmcgcGFyZW50aGVzaXMKCQkJCShleGNlc3MgPSB1bnF1b3RlZC5pbmRleE9mKCAiKSIsIHVucXVvdGVkLmxlbmd0aCAtIGV4Y2VzcyApIC0gdW5xdW90ZWQubGVuZ3RoKSApIHsKCgkJCQkvLyBleGNlc3MgaXMgYSBuZWdhdGl2ZSBpbmRleAoJCQkJbWF0Y2hbMF0gPSBtYXRjaFswXS5zbGljZSggMCwgZXhjZXNzICk7CgkJCQltYXRjaFsyXSA9IHVucXVvdGVkLnNsaWNlKCAwLCBleGNlc3MgKTsKCQkJfQoKCQkJLy8gUmV0dXJuIG9ubHkgY2FwdHVyZXMgbmVlZGVkIGJ5IHRoZSBwc2V1ZG8gZmlsdGVyIG1ldGhvZCAodHlwZSBhbmQgYXJndW1lbnQpCgkJCXJldHVybiBtYXRjaC5zbGljZSggMCwgMyApOwoJCX0KCX0sCgoJZmlsdGVyOiB7CgoJCSJUQUciOiBmdW5jdGlvbiggbm9kZU5hbWVTZWxlY3RvciApIHsKCQkJdmFyIG5vZGVOYW1lID0gbm9kZU5hbWVTZWxlY3Rvci5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLnRvTG93ZXJDYXNlKCk7CgkJCXJldHVybiBub2RlTmFtZVNlbGVjdG9yID09PSAiKiIgPwoJCQkJZnVuY3Rpb24oKSB7IHJldHVybiB0cnVlOyB9IDoKCQkJCWZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXJldHVybiBlbGVtLm5vZGVOYW1lICYmIGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbm9kZU5hbWU7CgkJCQl9OwoJCX0sCgoJCSJDTEFTUyI6IGZ1bmN0aW9uKCBjbGFzc05hbWUgKSB7CgkJCXZhciBwYXR0ZXJuID0gY2xhc3NDYWNoZVsgY2xhc3NOYW1lICsgIiAiIF07CgoJCQlyZXR1cm4gcGF0dGVybiB8fAoJCQkJKHBhdHRlcm4gPSBuZXcgUmVnRXhwKCAiKF58IiArIHdoaXRlc3BhY2UgKyAiKSIgKyBjbGFzc05hbWUgKyAiKCIgKyB3aGl0ZXNwYWNlICsgInwkKSIgKSkgJiYKCQkJCWNsYXNzQ2FjaGUoIGNsYXNzTmFtZSwgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQkJcmV0dXJuIHBhdHRlcm4udGVzdCggdHlwZW9mIGVsZW0uY2xhc3NOYW1lID09PSAic3RyaW5nIiAmJiBlbGVtLmNsYXNzTmFtZSB8fCB0eXBlb2YgZWxlbS5nZXRBdHRyaWJ1dGUgIT09ICJ1bmRlZmluZWQiICYmIGVsZW0uZ2V0QXR0cmlidXRlKCJjbGFzcyIpIHx8ICIiICk7CgkJCQl9KTsKCQl9LAoKCQkiQVRUUiI6IGZ1bmN0aW9uKCBuYW1lLCBvcGVyYXRvciwgY2hlY2sgKSB7CgkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXZhciByZXN1bHQgPSBTaXp6bGUuYXR0ciggZWxlbSwgbmFtZSApOwoKCQkJCWlmICggcmVzdWx0ID09IG51bGwgKSB7CgkJCQkJcmV0dXJuIG9wZXJhdG9yID09PSAiIT0iOwoJCQkJfQoJCQkJaWYgKCAhb3BlcmF0b3IgKSB7CgkJCQkJcmV0dXJuIHRydWU7CgkJCQl9CgoJCQkJcmVzdWx0ICs9ICIiOwoKCQkJCXJldHVybiBvcGVyYXRvciA9PT0gIj0iID8gcmVzdWx0ID09PSBjaGVjayA6CgkJCQkJb3BlcmF0b3IgPT09ICIhPSIgPyByZXN1bHQgIT09IGNoZWNrIDoKCQkJCQlvcGVyYXRvciA9PT0gIl49IiA/IGNoZWNrICYmIHJlc3VsdC5pbmRleE9mKCBjaGVjayApID09PSAwIDoKCQkJCQlvcGVyYXRvciA9PT0gIio9IiA/IGNoZWNrICYmIHJlc3VsdC5pbmRleE9mKCBjaGVjayApID4gLTEgOgoJCQkJCW9wZXJhdG9yID09PSAiJD0iID8gY2hlY2sgJiYgcmVzdWx0LnNsaWNlKCAtY2hlY2subGVuZ3RoICkgPT09IGNoZWNrIDoKCQkJCQlvcGVyYXRvciA9PT0gIn49IiA/ICggIiAiICsgcmVzdWx0LnJlcGxhY2UoIHJ3aGl0ZXNwYWNlLCAiICIgKSArICIgIiApLmluZGV4T2YoIGNoZWNrICkgPiAtMSA6CgkJCQkJb3BlcmF0b3IgPT09ICJ8PSIgPyByZXN1bHQgPT09IGNoZWNrIHx8IHJlc3VsdC5zbGljZSggMCwgY2hlY2subGVuZ3RoICsgMSApID09PSBjaGVjayArICItIiA6CgkJCQkJZmFsc2U7CgkJCX07CgkJfSwKCgkJIkNISUxEIjogZnVuY3Rpb24oIHR5cGUsIHdoYXQsIGFyZ3VtZW50LCBmaXJzdCwgbGFzdCApIHsKCQkJdmFyIHNpbXBsZSA9IHR5cGUuc2xpY2UoIDAsIDMgKSAhPT0gIm50aCIsCgkJCQlmb3J3YXJkID0gdHlwZS5zbGljZSggLTQgKSAhPT0gImxhc3QiLAoJCQkJb2ZUeXBlID0gd2hhdCA9PT0gIm9mLXR5cGUiOwoKCQkJcmV0dXJuIGZpcnN0ID09PSAxICYmIGxhc3QgPT09IDAgPwoKCQkJCS8vIFNob3J0Y3V0IGZvciA6bnRoLSoobikKCQkJCWZ1bmN0aW9uKCBlbGVtICkgewoJCQkJCXJldHVybiAhIWVsZW0ucGFyZW50Tm9kZTsKCQkJCX0gOgoKCQkJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCQkJdmFyIGNhY2hlLCB1bmlxdWVDYWNoZSwgb3V0ZXJDYWNoZSwgbm9kZSwgbm9kZUluZGV4LCBzdGFydCwKCQkJCQkJZGlyID0gc2ltcGxlICE9PSBmb3J3YXJkID8gIm5leHRTaWJsaW5nIiA6ICJwcmV2aW91c1NpYmxpbmciLAoJCQkJCQlwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGUsCgkJCQkJCW5hbWUgPSBvZlR5cGUgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLAoJCQkJCQl1c2VDYWNoZSA9ICF4bWwgJiYgIW9mVHlwZSwKCQkJCQkJZGlmZiA9IGZhbHNlOwoKCQkJCQlpZiAoIHBhcmVudCApIHsKCgkJCQkJCS8vIDooZmlyc3R8bGFzdHxvbmx5KS0oY2hpbGR8b2YtdHlwZSkKCQkJCQkJaWYgKCBzaW1wbGUgKSB7CgkJCQkJCQl3aGlsZSAoIGRpciApIHsKCQkJCQkJCQlub2RlID0gZWxlbTsKCQkJCQkJCQl3aGlsZSAoIChub2RlID0gbm9kZVsgZGlyIF0pICkgewoJCQkJCQkJCQlpZiAoIG9mVHlwZSA/CgkJCQkJCQkJCQlub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IG5hbWUgOgoJCQkJCQkJCQkJbm9kZS5ub2RlVHlwZSA9PT0gMSApIHsKCgkJCQkJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJCQkJCX0KCQkJCQkJCQl9CgkJCQkJCQkJLy8gUmV2ZXJzZSBkaXJlY3Rpb24gZm9yIDpvbmx5LSogKGlmIHdlIGhhdmVuJ3QgeWV0IGRvbmUgc28pCgkJCQkJCQkJc3RhcnQgPSBkaXIgPSB0eXBlID09PSAib25seSIgJiYgIXN0YXJ0ICYmICJuZXh0U2libGluZyI7CgkJCQkJCQl9CgkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJfQoKCQkJCQkJc3RhcnQgPSBbIGZvcndhcmQgPyBwYXJlbnQuZmlyc3RDaGlsZCA6IHBhcmVudC5sYXN0Q2hpbGQgXTsKCgkJCQkJCS8vIG5vbi14bWwgOm50aC1jaGlsZCguLi4pIHN0b3JlcyBjYWNoZSBkYXRhIG9uIGBwYXJlbnRgCgkJCQkJCWlmICggZm9yd2FyZCAmJiB1c2VDYWNoZSApIHsKCgkJCQkJCQkvLyBTZWVrIGBlbGVtYCBmcm9tIGEgcHJldmlvdXNseS1jYWNoZWQgaW5kZXgKCgkJCQkJCQkvLyAuLi5pbiBhIGd6aXAtZnJpZW5kbHkgd2F5CgkJCQkJCQlub2RlID0gcGFyZW50OwoJCQkJCQkJb3V0ZXJDYWNoZSA9IG5vZGVbIGV4cGFuZG8gXSB8fCAobm9kZVsgZXhwYW5kbyBdID0ge30pOwoKCQkJCQkJCS8vIFN1cHBvcnQ6IElFIDw5IG9ubHkKCQkJCQkJCS8vIERlZmVuZCBhZ2FpbnN0IGNsb25lZCBhdHRyb3BlcnRpZXMgKGpRdWVyeSBnaC0xNzA5KQoJCQkJCQkJdW5pcXVlQ2FjaGUgPSBvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gfHwKCQkJCQkJCQkob3V0ZXJDYWNoZVsgbm9kZS51bmlxdWVJRCBdID0ge30pOwoKCQkJCQkJCWNhY2hlID0gdW5pcXVlQ2FjaGVbIHR5cGUgXSB8fCBbXTsKCQkJCQkJCW5vZGVJbmRleCA9IGNhY2hlWyAwIF0gPT09IGRpcnJ1bnMgJiYgY2FjaGVbIDEgXTsKCQkJCQkJCWRpZmYgPSBub2RlSW5kZXggJiYgY2FjaGVbIDIgXTsKCQkJCQkJCW5vZGUgPSBub2RlSW5kZXggJiYgcGFyZW50LmNoaWxkTm9kZXNbIG5vZGVJbmRleCBdOwoKCQkJCQkJCXdoaWxlICggKG5vZGUgPSArK25vZGVJbmRleCAmJiBub2RlICYmIG5vZGVbIGRpciBdIHx8CgoJCQkJCQkJCS8vIEZhbGxiYWNrIHRvIHNlZWtpbmcgYGVsZW1gIGZyb20gdGhlIHN0YXJ0CgkJCQkJCQkJKGRpZmYgPSBub2RlSW5kZXggPSAwKSB8fCBzdGFydC5wb3AoKSkgKSB7CgoJCQkJCQkJCS8vIFdoZW4gZm91bmQsIGNhY2hlIGluZGV4ZXMgb24gYHBhcmVudGAgYW5kIGJyZWFrCgkJCQkJCQkJaWYgKCBub2RlLm5vZGVUeXBlID09PSAxICYmICsrZGlmZiAmJiBub2RlID09PSBlbGVtICkgewoJCQkJCQkJCQl1bmlxdWVDYWNoZVsgdHlwZSBdID0gWyBkaXJydW5zLCBub2RlSW5kZXgsIGRpZmYgXTsKCQkJCQkJCQkJYnJlYWs7CgkJCQkJCQkJfQoJCQkJCQkJfQoKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCS8vIFVzZSBwcmV2aW91c2x5LWNhY2hlZCBlbGVtZW50IGluZGV4IGlmIGF2YWlsYWJsZQoJCQkJCQkJaWYgKCB1c2VDYWNoZSApIHsKCQkJCQkJCQkvLyAuLi5pbiBhIGd6aXAtZnJpZW5kbHkgd2F5CgkJCQkJCQkJbm9kZSA9IGVsZW07CgkJCQkJCQkJb3V0ZXJDYWNoZSA9IG5vZGVbIGV4cGFuZG8gXSB8fCAobm9kZVsgZXhwYW5kbyBdID0ge30pOwoKCQkJCQkJCQkvLyBTdXBwb3J0OiBJRSA8OSBvbmx5CgkJCQkJCQkJLy8gRGVmZW5kIGFnYWluc3QgY2xvbmVkIGF0dHJvcGVydGllcyAoalF1ZXJ5IGdoLTE3MDkpCgkJCQkJCQkJdW5pcXVlQ2FjaGUgPSBvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gfHwKCQkJCQkJCQkJKG91dGVyQ2FjaGVbIG5vZGUudW5pcXVlSUQgXSA9IHt9KTsKCgkJCQkJCQkJY2FjaGUgPSB1bmlxdWVDYWNoZVsgdHlwZSBdIHx8IFtdOwoJCQkJCQkJCW5vZGVJbmRleCA9IGNhY2hlWyAwIF0gPT09IGRpcnJ1bnMgJiYgY2FjaGVbIDEgXTsKCQkJCQkJCQlkaWZmID0gbm9kZUluZGV4OwoJCQkJCQkJfQoKCQkJCQkJCS8vIHhtbCA6bnRoLWNoaWxkKC4uLikKCQkJCQkJCS8vIG9yIDpudGgtbGFzdC1jaGlsZCguLi4pIG9yIDpudGgoLWxhc3QpPy1vZi10eXBlKC4uLikKCQkJCQkJCWlmICggZGlmZiA9PT0gZmFsc2UgKSB7CgkJCQkJCQkJLy8gVXNlIHRoZSBzYW1lIGxvb3AgYXMgYWJvdmUgdG8gc2VlayBgZWxlbWAgZnJvbSB0aGUgc3RhcnQKCQkJCQkJCQl3aGlsZSAoIChub2RlID0gKytub2RlSW5kZXggJiYgbm9kZSAmJiBub2RlWyBkaXIgXSB8fAoJCQkJCQkJCQkoZGlmZiA9IG5vZGVJbmRleCA9IDApIHx8IHN0YXJ0LnBvcCgpKSApIHsKCgkJCQkJCQkJCWlmICggKCBvZlR5cGUgPwoJCQkJCQkJCQkJbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSBuYW1lIDoKCQkJCQkJCQkJCW5vZGUubm9kZVR5cGUgPT09IDEgKSAmJgoJCQkJCQkJCQkJKytkaWZmICkgewoKCQkJCQkJCQkJCS8vIENhY2hlIHRoZSBpbmRleCBvZiBlYWNoIGVuY291bnRlcmVkIGVsZW1lbnQKCQkJCQkJCQkJCWlmICggdXNlQ2FjaGUgKSB7CgkJCQkJCQkJCQkJb3V0ZXJDYWNoZSA9IG5vZGVbIGV4cGFuZG8gXSB8fCAobm9kZVsgZXhwYW5kbyBdID0ge30pOwoKCQkJCQkJCQkJCQkvLyBTdXBwb3J0OiBJRSA8OSBvbmx5CgkJCQkJCQkJCQkJLy8gRGVmZW5kIGFnYWluc3QgY2xvbmVkIGF0dHJvcGVydGllcyAoalF1ZXJ5IGdoLTE3MDkpCgkJCQkJCQkJCQkJdW5pcXVlQ2FjaGUgPSBvdXRlckNhY2hlWyBub2RlLnVuaXF1ZUlEIF0gfHwKCQkJCQkJCQkJCQkJKG91dGVyQ2FjaGVbIG5vZGUudW5pcXVlSUQgXSA9IHt9KTsKCgkJCQkJCQkJCQkJdW5pcXVlQ2FjaGVbIHR5cGUgXSA9IFsgZGlycnVucywgZGlmZiBdOwoJCQkJCQkJCQkJfQoKCQkJCQkJCQkJCWlmICggbm9kZSA9PT0gZWxlbSApIHsKCQkJCQkJCQkJCQlicmVhazsKCQkJCQkJCQkJCX0KCQkJCQkJCQkJfQoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJfQoKCQkJCQkJLy8gSW5jb3Jwb3JhdGUgdGhlIG9mZnNldCwgdGhlbiBjaGVjayBhZ2FpbnN0IGN5Y2xlIHNpemUKCQkJCQkJZGlmZiAtPSBsYXN0OwoJCQkJCQlyZXR1cm4gZGlmZiA9PT0gZmlyc3QgfHwgKCBkaWZmICUgZmlyc3QgPT09IDAgJiYgZGlmZiAvIGZpcnN0ID49IDAgKTsKCQkJCQl9CgkJCQl9OwoJCX0sCgoJCSJQU0VVRE8iOiBmdW5jdGlvbiggcHNldWRvLCBhcmd1bWVudCApIHsKCQkJLy8gcHNldWRvLWNsYXNzIG5hbWVzIGFyZSBjYXNlLWluc2Vuc2l0aXZlCgkJCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSL3NlbGVjdG9ycy8jcHNldWRvLWNsYXNzZXMKCQkJLy8gUHJpb3JpdGl6ZSBieSBjYXNlIHNlbnNpdGl2aXR5IGluIGNhc2UgY3VzdG9tIHBzZXVkb3MgYXJlIGFkZGVkIHdpdGggdXBwZXJjYXNlIGxldHRlcnMKCQkJLy8gUmVtZW1iZXIgdGhhdCBzZXRGaWx0ZXJzIGluaGVyaXRzIGZyb20gcHNldWRvcwoJCQl2YXIgYXJncywKCQkJCWZuID0gRXhwci5wc2V1ZG9zWyBwc2V1ZG8gXSB8fCBFeHByLnNldEZpbHRlcnNbIHBzZXVkby50b0xvd2VyQ2FzZSgpIF0gfHwKCQkJCQlTaXp6bGUuZXJyb3IoICJ1bnN1cHBvcnRlZCBwc2V1ZG86ICIgKyBwc2V1ZG8gKTsKCgkJCS8vIFRoZSB1c2VyIG1heSB1c2UgY3JlYXRlUHNldWRvIHRvIGluZGljYXRlIHRoYXQKCQkJLy8gYXJndW1lbnRzIGFyZSBuZWVkZWQgdG8gY3JlYXRlIHRoZSBmaWx0ZXIgZnVuY3Rpb24KCQkJLy8ganVzdCBhcyBTaXp6bGUgZG9lcwoJCQlpZiAoIGZuWyBleHBhbmRvIF0gKSB7CgkJCQlyZXR1cm4gZm4oIGFyZ3VtZW50ICk7CgkJCX0KCgkJCS8vIEJ1dCBtYWludGFpbiBzdXBwb3J0IGZvciBvbGQgc2lnbmF0dXJlcwoJCQlpZiAoIGZuLmxlbmd0aCA+IDEgKSB7CgkJCQlhcmdzID0gWyBwc2V1ZG8sIHBzZXVkbywgIiIsIGFyZ3VtZW50IF07CgkJCQlyZXR1cm4gRXhwci5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KCBwc2V1ZG8udG9Mb3dlckNhc2UoKSApID8KCQkJCQltYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIG1hdGNoZXMgKSB7CgkJCQkJCXZhciBpZHgsCgkJCQkJCQltYXRjaGVkID0gZm4oIHNlZWQsIGFyZ3VtZW50ICksCgkJCQkJCQlpID0gbWF0Y2hlZC5sZW5ndGg7CgkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJaWR4ID0gaW5kZXhPZiggc2VlZCwgbWF0Y2hlZFtpXSApOwoJCQkJCQkJc2VlZFsgaWR4IF0gPSAhKCBtYXRjaGVzWyBpZHggXSA9IG1hdGNoZWRbaV0gKTsKCQkJCQkJfQoJCQkJCX0pIDoKCQkJCQlmdW5jdGlvbiggZWxlbSApIHsKCQkJCQkJcmV0dXJuIGZuKCBlbGVtLCAwLCBhcmdzICk7CgkJCQkJfTsKCQkJfQoKCQkJcmV0dXJuIGZuOwoJCX0KCX0sCgoJcHNldWRvczogewoJCS8vIFBvdGVudGlhbGx5IGNvbXBsZXggcHNldWRvcwoJCSJub3QiOiBtYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCQkvLyBUcmltIHRoZSBzZWxlY3RvciBwYXNzZWQgdG8gY29tcGlsZQoJCQkvLyB0byBhdm9pZCB0cmVhdGluZyBsZWFkaW5nIGFuZCB0cmFpbGluZwoJCQkvLyBzcGFjZXMgYXMgY29tYmluYXRvcnMKCQkJdmFyIGlucHV0ID0gW10sCgkJCQlyZXN1bHRzID0gW10sCgkJCQltYXRjaGVyID0gY29tcGlsZSggc2VsZWN0b3IucmVwbGFjZSggcnRyaW0sICIkMSIgKSApOwoKCQkJcmV0dXJuIG1hdGNoZXJbIGV4cGFuZG8gXSA/CgkJCQltYXJrRnVuY3Rpb24oZnVuY3Rpb24oIHNlZWQsIG1hdGNoZXMsIGNvbnRleHQsIHhtbCApIHsKCQkJCQl2YXIgZWxlbSwKCQkJCQkJdW5tYXRjaGVkID0gbWF0Y2hlciggc2VlZCwgbnVsbCwgeG1sLCBbXSApLAoJCQkJCQlpID0gc2VlZC5sZW5ndGg7CgoJCQkJCS8vIE1hdGNoIGVsZW1lbnRzIHVubWF0Y2hlZCBieSBgbWF0Y2hlcmAKCQkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQkJaWYgKCAoZWxlbSA9IHVubWF0Y2hlZFtpXSkgKSB7CgkJCQkJCQlzZWVkW2ldID0gIShtYXRjaGVzW2ldID0gZWxlbSk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9KSA6CgkJCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQkJCWlucHV0WzBdID0gZWxlbTsKCQkJCQltYXRjaGVyKCBpbnB1dCwgbnVsbCwgeG1sLCByZXN1bHRzICk7CgkJCQkJLy8gRG9uJ3Qga2VlcCB0aGUgZWxlbWVudCAoaXNzdWUgIzI5OSkKCQkJCQlpbnB1dFswXSA9IG51bGw7CgkJCQkJcmV0dXJuICFyZXN1bHRzLnBvcCgpOwoJCQkJfTsKCQl9KSwKCgkJImhhcyI6IG1hcmtGdW5jdGlvbihmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXJldHVybiBmdW5jdGlvbiggZWxlbSApIHsKCQkJCXJldHVybiBTaXp6bGUoIHNlbGVjdG9yLCBlbGVtICkubGVuZ3RoID4gMDsKCQkJfTsKCQl9KSwKCgkJImNvbnRhaW5zIjogbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCB0ZXh0ICkgewoJCQl0ZXh0ID0gdGV4dC5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApOwoJCQlyZXR1cm4gZnVuY3Rpb24oIGVsZW0gKSB7CgkJCQlyZXR1cm4gKCBlbGVtLnRleHRDb250ZW50IHx8IGVsZW0uaW5uZXJUZXh0IHx8IGdldFRleHQoIGVsZW0gKSApLmluZGV4T2YoIHRleHQgKSA+IC0xOwoJCQl9OwoJCX0pLAoKCQkvLyAiV2hldGhlciBhbiBlbGVtZW50IGlzIHJlcHJlc2VudGVkIGJ5IGEgOmxhbmcoKSBzZWxlY3RvcgoJCS8vIGlzIGJhc2VkIHNvbGVseSBvbiB0aGUgZWxlbWVudCdzIGxhbmd1YWdlIHZhbHVlCgkJLy8gYmVpbmcgZXF1YWwgdG8gdGhlIGlkZW50aWZpZXIgQywKCQkvLyBvciBiZWdpbm5pbmcgd2l0aCB0aGUgaWRlbnRpZmllciBDIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5ICItIi4KCQkvLyBUaGUgbWF0Y2hpbmcgb2YgQyBhZ2FpbnN0IHRoZSBlbGVtZW50J3MgbGFuZ3VhZ2UgdmFsdWUgaXMgcGVyZm9ybWVkIGNhc2UtaW5zZW5zaXRpdmVseS4KCQkvLyBUaGUgaWRlbnRpZmllciBDIGRvZXMgbm90IGhhdmUgdG8gYmUgYSB2YWxpZCBsYW5ndWFnZSBuYW1lLiIKCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi9zZWxlY3RvcnMvI2xhbmctcHNldWRvCgkJImxhbmciOiBtYXJrRnVuY3Rpb24oIGZ1bmN0aW9uKCBsYW5nICkgewoJCQkvLyBsYW5nIHZhbHVlIG11c3QgYmUgYSB2YWxpZCBpZGVudGlmaWVyCgkJCWlmICggIXJpZGVudGlmaWVyLnRlc3QobGFuZyB8fCAiIikgKSB7CgkJCQlTaXp6bGUuZXJyb3IoICJ1bnN1cHBvcnRlZCBsYW5nOiAiICsgbGFuZyApOwoJCQl9CgkJCWxhbmcgPSBsYW5nLnJlcGxhY2UoIHJ1bmVzY2FwZSwgZnVuZXNjYXBlICkudG9Mb3dlckNhc2UoKTsKCQkJcmV0dXJuIGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIGVsZW1MYW5nOwoJCQkJZG8gewoJCQkJCWlmICggKGVsZW1MYW5nID0gZG9jdW1lbnRJc0hUTUwgPwoJCQkJCQllbGVtLmxhbmcgOgoJCQkJCQllbGVtLmdldEF0dHJpYnV0ZSgieG1sOmxhbmciKSB8fCBlbGVtLmdldEF0dHJpYnV0ZSgibGFuZyIpKSApIHsKCgkJCQkJCWVsZW1MYW5nID0gZWxlbUxhbmcudG9Mb3dlckNhc2UoKTsKCQkJCQkJcmV0dXJuIGVsZW1MYW5nID09PSBsYW5nIHx8IGVsZW1MYW5nLmluZGV4T2YoIGxhbmcgKyAiLSIgKSA9PT0gMDsKCQkJCQl9CgkJCQl9IHdoaWxlICggKGVsZW0gPSBlbGVtLnBhcmVudE5vZGUpICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKTsKCQkJCXJldHVybiBmYWxzZTsKCQkJfTsKCQl9KSwKCgkJLy8gTWlzY2VsbGFuZW91cwoJCSJ0YXJnZXQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJdmFyIGhhc2ggPSB3aW5kb3cubG9jYXRpb24gJiYgd2luZG93LmxvY2F0aW9uLmhhc2g7CgkJCXJldHVybiBoYXNoICYmIGhhc2guc2xpY2UoIDEgKSA9PT0gZWxlbS5pZDsKCQl9LAoKCQkicm9vdCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZWxlbSA9PT0gZG9jRWxlbTsKCQl9LAoKCQkiZm9jdXMiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGVsZW0gPT09IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgJiYgKCFkb2N1bWVudC5oYXNGb2N1cyB8fCBkb2N1bWVudC5oYXNGb2N1cygpKSAmJiAhIShlbGVtLnR5cGUgfHwgZWxlbS5ocmVmIHx8IH5lbGVtLnRhYkluZGV4KTsKCQl9LAoKCQkvLyBCb29sZWFuIHByb3BlcnRpZXMKCQkiZW5hYmxlZCI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZWxlbS5kaXNhYmxlZCA9PT0gZmFsc2U7CgkJfSwKCgkJImRpc2FibGVkIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiBlbGVtLmRpc2FibGVkID09PSB0cnVlOwoJCX0sCgoJCSJjaGVja2VkIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCS8vIEluIENTUzMsIDpjaGVja2VkIHNob3VsZCByZXR1cm4gYm90aCBjaGVja2VkIGFuZCBzZWxlY3RlZCBlbGVtZW50cwoJCQkvLyBodHRwOi8vd3d3LnczLm9yZy9UUi8yMDExL1JFQy1jc3MzLXNlbGVjdG9ycy0yMDExMDkyOS8jY2hlY2tlZAoJCQl2YXIgbm9kZU5hbWUgPSBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgkJCXJldHVybiAobm9kZU5hbWUgPT09ICJpbnB1dCIgJiYgISFlbGVtLmNoZWNrZWQpIHx8IChub2RlTmFtZSA9PT0gIm9wdGlvbiIgJiYgISFlbGVtLnNlbGVjdGVkKTsKCQl9LAoKCQkic2VsZWN0ZWQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJLy8gQWNjZXNzaW5nIHRoaXMgcHJvcGVydHkgbWFrZXMgc2VsZWN0ZWQtYnktZGVmYXVsdAoJCQkvLyBvcHRpb25zIGluIFNhZmFyaSB3b3JrIHByb3Blcmx5CgkJCWlmICggZWxlbS5wYXJlbnROb2RlICkgewoJCQkJZWxlbS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXg7CgkJCX0KCgkJCXJldHVybiBlbGVtLnNlbGVjdGVkID09PSB0cnVlOwoJCX0sCgoJCS8vIENvbnRlbnRzCgkJImVtcHR5IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCS8vIGh0dHA6Ly93d3cudzMub3JnL1RSL3NlbGVjdG9ycy8jZW1wdHktcHNldWRvCgkJCS8vIDplbXB0eSBpcyBuZWdhdGVkIGJ5IGVsZW1lbnQgKDEpIG9yIGNvbnRlbnQgbm9kZXMgKHRleHQ6IDM7IGNkYXRhOiA0OyBlbnRpdHkgcmVmOiA1KSwKCQkJLy8gICBidXQgbm90IGJ5IG90aGVycyAoY29tbWVudDogODsgcHJvY2Vzc2luZyBpbnN0cnVjdGlvbjogNzsgZXRjLikKCQkJLy8gbm9kZVR5cGUgPCA2IHdvcmtzIGJlY2F1c2UgYXR0cmlidXRlcyAoMikgZG8gbm90IGFwcGVhciBhcyBjaGlsZHJlbgoJCQlmb3IgKCBlbGVtID0gZWxlbS5maXJzdENoaWxkOyBlbGVtOyBlbGVtID0gZWxlbS5uZXh0U2libGluZyApIHsKCQkJCWlmICggZWxlbS5ub2RlVHlwZSA8IDYgKSB7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9CgkJCXJldHVybiB0cnVlOwoJCX0sCgoJCSJwYXJlbnQiOiBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuICFFeHByLnBzZXVkb3NbImVtcHR5Il0oIGVsZW0gKTsKCQl9LAoKCQkvLyBFbGVtZW50L2lucHV0IHR5cGVzCgkJImhlYWRlciI6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gcmhlYWRlci50ZXN0KCBlbGVtLm5vZGVOYW1lICk7CgkJfSwKCgkJImlucHV0IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiByaW5wdXRzLnRlc3QoIGVsZW0ubm9kZU5hbWUgKTsKCQl9LAoKCQkiYnV0dG9uIjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZhciBuYW1lID0gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoJCQlyZXR1cm4gbmFtZSA9PT0gImlucHV0IiAmJiBlbGVtLnR5cGUgPT09ICJidXR0b24iIHx8IG5hbWUgPT09ICJidXR0b24iOwoJCX0sCgoJCSJ0ZXh0IjogZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXZhciBhdHRyOwoJCQlyZXR1cm4gZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAiaW5wdXQiICYmCgkJCQllbGVtLnR5cGUgPT09ICJ0ZXh0IiAmJgoKCQkJCS8vIFN1cHBvcnQ6IElFPDgKCQkJCS8vIE5ldyBIVE1MNSBhdHRyaWJ1dGUgdmFsdWVzIChlLmcuLCAic2VhcmNoIikgYXBwZWFyIHdpdGggZWxlbS50eXBlID09PSAidGV4dCIKCQkJCSggKGF0dHIgPSBlbGVtLmdldEF0dHJpYnV0ZSgidHlwZSIpKSA9PSBudWxsIHx8IGF0dHIudG9Mb3dlckNhc2UoKSA9PT0gInRleHQiICk7CgkJfSwKCgkJLy8gUG9zaXRpb24taW4tY29sbGVjdGlvbgoJCSJmaXJzdCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oKSB7CgkJCXJldHVybiBbIDAgXTsKCQl9KSwKCgkJImxhc3QiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCApIHsKCQkJcmV0dXJuIFsgbGVuZ3RoIC0gMSBdOwoJCX0pLAoKCQkiZXEiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCwgYXJndW1lbnQgKSB7CgkJCXJldHVybiBbIGFyZ3VtZW50IDwgMCA/IGFyZ3VtZW50ICsgbGVuZ3RoIDogYXJndW1lbnQgXTsKCQl9KSwKCgkJImV2ZW4iOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCApIHsKCQkJdmFyIGkgPSAwOwoJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkgKz0gMiApIHsKCQkJCW1hdGNoSW5kZXhlcy5wdXNoKCBpICk7CgkJCX0KCQkJcmV0dXJuIG1hdGNoSW5kZXhlczsKCQl9KSwKCgkJIm9kZCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoICkgewoJCQl2YXIgaSA9IDE7CgkJCWZvciAoIDsgaSA8IGxlbmd0aDsgaSArPSAyICkgewoJCQkJbWF0Y2hJbmRleGVzLnB1c2goIGkgKTsKCQkJfQoJCQlyZXR1cm4gbWF0Y2hJbmRleGVzOwoJCX0pLAoKCQkibHQiOiBjcmVhdGVQb3NpdGlvbmFsUHNldWRvKGZ1bmN0aW9uKCBtYXRjaEluZGV4ZXMsIGxlbmd0aCwgYXJndW1lbnQgKSB7CgkJCXZhciBpID0gYXJndW1lbnQgPCAwID8gYXJndW1lbnQgKyBsZW5ndGggOiBhcmd1bWVudDsKCQkJZm9yICggOyAtLWkgPj0gMDsgKSB7CgkJCQltYXRjaEluZGV4ZXMucHVzaCggaSApOwoJCQl9CgkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJfSksCgoJCSJndCI6IGNyZWF0ZVBvc2l0aW9uYWxQc2V1ZG8oZnVuY3Rpb24oIG1hdGNoSW5kZXhlcywgbGVuZ3RoLCBhcmd1bWVudCApIHsKCQkJdmFyIGkgPSBhcmd1bWVudCA8IDAgPyBhcmd1bWVudCArIGxlbmd0aCA6IGFyZ3VtZW50OwoJCQlmb3IgKCA7ICsraSA8IGxlbmd0aDsgKSB7CgkJCQltYXRjaEluZGV4ZXMucHVzaCggaSApOwoJCQl9CgkJCXJldHVybiBtYXRjaEluZGV4ZXM7CgkJfSkKCX0KfTsKCkV4cHIucHNldWRvc1sibnRoIl0gPSBFeHByLnBzZXVkb3NbImVxIl07CgovLyBBZGQgYnV0dG9uL2lucHV0IHR5cGUgcHNldWRvcwpmb3IgKCBpIGluIHsgcmFkaW86IHRydWUsIGNoZWNrYm94OiB0cnVlLCBmaWxlOiB0cnVlLCBwYXNzd29yZDogdHJ1ZSwgaW1hZ2U6IHRydWUgfSApIHsKCUV4cHIucHNldWRvc1sgaSBdID0gY3JlYXRlSW5wdXRQc2V1ZG8oIGkgKTsKfQpmb3IgKCBpIGluIHsgc3VibWl0OiB0cnVlLCByZXNldDogdHJ1ZSB9ICkgewoJRXhwci5wc2V1ZG9zWyBpIF0gPSBjcmVhdGVCdXR0b25Qc2V1ZG8oIGkgKTsKfQoKLy8gRWFzeSBBUEkgZm9yIGNyZWF0aW5nIG5ldyBzZXRGaWx0ZXJzCmZ1bmN0aW9uIHNldEZpbHRlcnMoKSB7fQpzZXRGaWx0ZXJzLnByb3RvdHlwZSA9IEV4cHIuZmlsdGVycyA9IEV4cHIucHNldWRvczsKRXhwci5zZXRGaWx0ZXJzID0gbmV3IHNldEZpbHRlcnMoKTsKCnRva2VuaXplID0gU2l6emxlLnRva2VuaXplID0gZnVuY3Rpb24oIHNlbGVjdG9yLCBwYXJzZU9ubHkgKSB7Cgl2YXIgbWF0Y2hlZCwgbWF0Y2gsIHRva2VucywgdHlwZSwKCQlzb0ZhciwgZ3JvdXBzLCBwcmVGaWx0ZXJzLAoJCWNhY2hlZCA9IHRva2VuQ2FjaGVbIHNlbGVjdG9yICsgIiAiIF07CgoJaWYgKCBjYWNoZWQgKSB7CgkJcmV0dXJuIHBhcnNlT25seSA/IDAgOiBjYWNoZWQuc2xpY2UoIDAgKTsKCX0KCglzb0ZhciA9IHNlbGVjdG9yOwoJZ3JvdXBzID0gW107CglwcmVGaWx0ZXJzID0gRXhwci5wcmVGaWx0ZXI7CgoJd2hpbGUgKCBzb0ZhciApIHsKCgkJLy8gQ29tbWEgYW5kIGZpcnN0IHJ1bgoJCWlmICggIW1hdGNoZWQgfHwgKG1hdGNoID0gcmNvbW1hLmV4ZWMoIHNvRmFyICkpICkgewoJCQlpZiAoIG1hdGNoICkgewoJCQkJLy8gRG9uJ3QgY29uc3VtZSB0cmFpbGluZyBjb21tYXMgYXMgdmFsaWQKCQkJCXNvRmFyID0gc29GYXIuc2xpY2UoIG1hdGNoWzBdLmxlbmd0aCApIHx8IHNvRmFyOwoJCQl9CgkJCWdyb3Vwcy5wdXNoKCAodG9rZW5zID0gW10pICk7CgkJfQoKCQltYXRjaGVkID0gZmFsc2U7CgoJCS8vIENvbWJpbmF0b3JzCgkJaWYgKCAobWF0Y2ggPSByY29tYmluYXRvcnMuZXhlYyggc29GYXIgKSkgKSB7CgkJCW1hdGNoZWQgPSBtYXRjaC5zaGlmdCgpOwoJCQl0b2tlbnMucHVzaCh7CgkJCQl2YWx1ZTogbWF0Y2hlZCwKCQkJCS8vIENhc3QgZGVzY2VuZGFudCBjb21iaW5hdG9ycyB0byBzcGFjZQoJCQkJdHlwZTogbWF0Y2hbMF0ucmVwbGFjZSggcnRyaW0sICIgIiApCgkJCX0pOwoJCQlzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaGVkLmxlbmd0aCApOwoJCX0KCgkJLy8gRmlsdGVycwoJCWZvciAoIHR5cGUgaW4gRXhwci5maWx0ZXIgKSB7CgkJCWlmICggKG1hdGNoID0gbWF0Y2hFeHByWyB0eXBlIF0uZXhlYyggc29GYXIgKSkgJiYgKCFwcmVGaWx0ZXJzWyB0eXBlIF0gfHwKCQkJCShtYXRjaCA9IHByZUZpbHRlcnNbIHR5cGUgXSggbWF0Y2ggKSkpICkgewoJCQkJbWF0Y2hlZCA9IG1hdGNoLnNoaWZ0KCk7CgkJCQl0b2tlbnMucHVzaCh7CgkJCQkJdmFsdWU6IG1hdGNoZWQsCgkJCQkJdHlwZTogdHlwZSwKCQkJCQltYXRjaGVzOiBtYXRjaAoJCQkJfSk7CgkJCQlzb0ZhciA9IHNvRmFyLnNsaWNlKCBtYXRjaGVkLmxlbmd0aCApOwoJCQl9CgkJfQoKCQlpZiAoICFtYXRjaGVkICkgewoJCQlicmVhazsKCQl9Cgl9CgoJLy8gUmV0dXJuIHRoZSBsZW5ndGggb2YgdGhlIGludmFsaWQgZXhjZXNzCgkvLyBpZiB3ZSdyZSBqdXN0IHBhcnNpbmcKCS8vIE90aGVyd2lzZSwgdGhyb3cgYW4gZXJyb3Igb3IgcmV0dXJuIHRva2VucwoJcmV0dXJuIHBhcnNlT25seSA/CgkJc29GYXIubGVuZ3RoIDoKCQlzb0ZhciA/CgkJCVNpenpsZS5lcnJvciggc2VsZWN0b3IgKSA6CgkJCS8vIENhY2hlIHRoZSB0b2tlbnMKCQkJdG9rZW5DYWNoZSggc2VsZWN0b3IsIGdyb3VwcyApLnNsaWNlKCAwICk7Cn07CgpmdW5jdGlvbiB0b1NlbGVjdG9yKCB0b2tlbnMgKSB7Cgl2YXIgaSA9IDAsCgkJbGVuID0gdG9rZW5zLmxlbmd0aCwKCQlzZWxlY3RvciA9ICIiOwoJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJc2VsZWN0b3IgKz0gdG9rZW5zW2ldLnZhbHVlOwoJfQoJcmV0dXJuIHNlbGVjdG9yOwp9CgpmdW5jdGlvbiBhZGRDb21iaW5hdG9yKCBtYXRjaGVyLCBjb21iaW5hdG9yLCBiYXNlICkgewoJdmFyIGRpciA9IGNvbWJpbmF0b3IuZGlyLAoJCWNoZWNrTm9uRWxlbWVudHMgPSBiYXNlICYmIGRpciA9PT0gInBhcmVudE5vZGUiLAoJCWRvbmVOYW1lID0gZG9uZSsrOwoKCXJldHVybiBjb21iaW5hdG9yLmZpcnN0ID8KCQkvLyBDaGVjayBhZ2FpbnN0IGNsb3Nlc3QgYW5jZXN0b3IvcHJlY2VkaW5nIGVsZW1lbnQKCQlmdW5jdGlvbiggZWxlbSwgY29udGV4dCwgeG1sICkgewoJCQl3aGlsZSAoIChlbGVtID0gZWxlbVsgZGlyIF0pICkgewoJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7CgkJCQkJcmV0dXJuIG1hdGNoZXIoIGVsZW0sIGNvbnRleHQsIHhtbCApOwoJCQkJfQoJCQl9CgkJfSA6CgoJCS8vIENoZWNrIGFnYWluc3QgYWxsIGFuY2VzdG9yL3ByZWNlZGluZyBlbGVtZW50cwoJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCXZhciBvbGRDYWNoZSwgdW5pcXVlQ2FjaGUsIG91dGVyQ2FjaGUsCgkJCQluZXdDYWNoZSA9IFsgZGlycnVucywgZG9uZU5hbWUgXTsKCgkJCS8vIFdlIGNhbid0IHNldCBhcmJpdHJhcnkgZGF0YSBvbiBYTUwgbm9kZXMsIHNvIHRoZXkgZG9uJ3QgYmVuZWZpdCBmcm9tIGNvbWJpbmF0b3IgY2FjaGluZwoJCQlpZiAoIHhtbCApIHsKCQkJCXdoaWxlICggKGVsZW0gPSBlbGVtWyBkaXIgXSkgKSB7CgkJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7CgkJCQkJCWlmICggbWF0Y2hlciggZWxlbSwgY29udGV4dCwgeG1sICkgKSB7CgkJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQkJfQoJCQkJCX0KCQkJCX0KCQkJfSBlbHNlIHsKCQkJCXdoaWxlICggKGVsZW0gPSBlbGVtWyBkaXIgXSkgKSB7CgkJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGNoZWNrTm9uRWxlbWVudHMgKSB7CgkJCQkJCW91dGVyQ2FjaGUgPSBlbGVtWyBleHBhbmRvIF0gfHwgKGVsZW1bIGV4cGFuZG8gXSA9IHt9KTsKCgkJCQkJCS8vIFN1cHBvcnQ6IElFIDw5IG9ubHkKCQkJCQkJLy8gRGVmZW5kIGFnYWluc3QgY2xvbmVkIGF0dHJvcGVydGllcyAoalF1ZXJ5IGdoLTE3MDkpCgkJCQkJCXVuaXF1ZUNhY2hlID0gb3V0ZXJDYWNoZVsgZWxlbS51bmlxdWVJRCBdIHx8IChvdXRlckNhY2hlWyBlbGVtLnVuaXF1ZUlEIF0gPSB7fSk7CgoJCQkJCQlpZiAoIChvbGRDYWNoZSA9IHVuaXF1ZUNhY2hlWyBkaXIgXSkgJiYKCQkJCQkJCW9sZENhY2hlWyAwIF0gPT09IGRpcnJ1bnMgJiYgb2xkQ2FjaGVbIDEgXSA9PT0gZG9uZU5hbWUgKSB7CgoJCQkJCQkJLy8gQXNzaWduIHRvIG5ld0NhY2hlIHNvIHJlc3VsdHMgYmFjay1wcm9wYWdhdGUgdG8gcHJldmlvdXMgZWxlbWVudHMKCQkJCQkJCXJldHVybiAobmV3Q2FjaGVbIDIgXSA9IG9sZENhY2hlWyAyIF0pOwoJCQkJCQl9IGVsc2UgewoJCQkJCQkJLy8gUmV1c2UgbmV3Y2FjaGUgc28gcmVzdWx0cyBiYWNrLXByb3BhZ2F0ZSB0byBwcmV2aW91cyBlbGVtZW50cwoJCQkJCQkJdW5pcXVlQ2FjaGVbIGRpciBdID0gbmV3Q2FjaGU7CgoJCQkJCQkJLy8gQSBtYXRjaCBtZWFucyB3ZSdyZSBkb25lOyBhIGZhaWwgbWVhbnMgd2UgaGF2ZSB0byBrZWVwIGNoZWNraW5nCgkJCQkJCQlpZiAoIChuZXdDYWNoZVsgMiBdID0gbWF0Y2hlciggZWxlbSwgY29udGV4dCwgeG1sICkpICkgewoJCQkJCQkJCXJldHVybiB0cnVlOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfTsKfQoKZnVuY3Rpb24gZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICkgewoJcmV0dXJuIG1hdGNoZXJzLmxlbmd0aCA+IDEgPwoJCWZ1bmN0aW9uKCBlbGVtLCBjb250ZXh0LCB4bWwgKSB7CgkJCXZhciBpID0gbWF0Y2hlcnMubGVuZ3RoOwoJCQl3aGlsZSAoIGktLSApIHsKCQkJCWlmICggIW1hdGNoZXJzW2ldKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIHRydWU7CgkJfSA6CgkJbWF0Y2hlcnNbMF07Cn0KCmZ1bmN0aW9uIG11bHRpcGxlQ29udGV4dHMoIHNlbGVjdG9yLCBjb250ZXh0cywgcmVzdWx0cyApIHsKCXZhciBpID0gMCwKCQlsZW4gPSBjb250ZXh0cy5sZW5ndGg7Cglmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQlTaXp6bGUoIHNlbGVjdG9yLCBjb250ZXh0c1tpXSwgcmVzdWx0cyApOwoJfQoJcmV0dXJuIHJlc3VsdHM7Cn0KCmZ1bmN0aW9uIGNvbmRlbnNlKCB1bm1hdGNoZWQsIG1hcCwgZmlsdGVyLCBjb250ZXh0LCB4bWwgKSB7Cgl2YXIgZWxlbSwKCQluZXdVbm1hdGNoZWQgPSBbXSwKCQlpID0gMCwKCQlsZW4gPSB1bm1hdGNoZWQubGVuZ3RoLAoJCW1hcHBlZCA9IG1hcCAhPSBudWxsOwoKCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCWlmICggKGVsZW0gPSB1bm1hdGNoZWRbaV0pICkgewoJCQlpZiAoICFmaWx0ZXIgfHwgZmlsdGVyKCBlbGVtLCBjb250ZXh0LCB4bWwgKSApIHsKCQkJCW5ld1VubWF0Y2hlZC5wdXNoKCBlbGVtICk7CgkJCQlpZiAoIG1hcHBlZCApIHsKCQkJCQltYXAucHVzaCggaSApOwoJCQkJfQoJCQl9CgkJfQoJfQoKCXJldHVybiBuZXdVbm1hdGNoZWQ7Cn0KCmZ1bmN0aW9uIHNldE1hdGNoZXIoIHByZUZpbHRlciwgc2VsZWN0b3IsIG1hdGNoZXIsIHBvc3RGaWx0ZXIsIHBvc3RGaW5kZXIsIHBvc3RTZWxlY3RvciApIHsKCWlmICggcG9zdEZpbHRlciAmJiAhcG9zdEZpbHRlclsgZXhwYW5kbyBdICkgewoJCXBvc3RGaWx0ZXIgPSBzZXRNYXRjaGVyKCBwb3N0RmlsdGVyICk7Cgl9CglpZiAoIHBvc3RGaW5kZXIgJiYgIXBvc3RGaW5kZXJbIGV4cGFuZG8gXSApIHsKCQlwb3N0RmluZGVyID0gc2V0TWF0Y2hlciggcG9zdEZpbmRlciwgcG9zdFNlbGVjdG9yICk7Cgl9CglyZXR1cm4gbWFya0Z1bmN0aW9uKGZ1bmN0aW9uKCBzZWVkLCByZXN1bHRzLCBjb250ZXh0LCB4bWwgKSB7CgkJdmFyIHRlbXAsIGksIGVsZW0sCgkJCXByZU1hcCA9IFtdLAoJCQlwb3N0TWFwID0gW10sCgkJCXByZWV4aXN0aW5nID0gcmVzdWx0cy5sZW5ndGgsCgoJCQkvLyBHZXQgaW5pdGlhbCBlbGVtZW50cyBmcm9tIHNlZWQgb3IgY29udGV4dAoJCQllbGVtcyA9IHNlZWQgfHwgbXVsdGlwbGVDb250ZXh0cyggc2VsZWN0b3IgfHwgIioiLCBjb250ZXh0Lm5vZGVUeXBlID8gWyBjb250ZXh0IF0gOiBjb250ZXh0LCBbXSApLAoKCQkJLy8gUHJlZmlsdGVyIHRvIGdldCBtYXRjaGVyIGlucHV0LCBwcmVzZXJ2aW5nIGEgbWFwIGZvciBzZWVkLXJlc3VsdHMgc3luY2hyb25pemF0aW9uCgkJCW1hdGNoZXJJbiA9IHByZUZpbHRlciAmJiAoIHNlZWQgfHwgIXNlbGVjdG9yICkgPwoJCQkJY29uZGVuc2UoIGVsZW1zLCBwcmVNYXAsIHByZUZpbHRlciwgY29udGV4dCwgeG1sICkgOgoJCQkJZWxlbXMsCgoJCQltYXRjaGVyT3V0ID0gbWF0Y2hlciA/CgkJCQkvLyBJZiB3ZSBoYXZlIGEgcG9zdEZpbmRlciwgb3IgZmlsdGVyZWQgc2VlZCwgb3Igbm9uLXNlZWQgcG9zdEZpbHRlciBvciBwcmVleGlzdGluZyByZXN1bHRzLAoJCQkJcG9zdEZpbmRlciB8fCAoIHNlZWQgPyBwcmVGaWx0ZXIgOiBwcmVleGlzdGluZyB8fCBwb3N0RmlsdGVyICkgPwoKCQkJCQkvLyAuLi5pbnRlcm1lZGlhdGUgcHJvY2Vzc2luZyBpcyBuZWNlc3NhcnkKCQkJCQlbXSA6CgoJCQkJCS8vIC4uLm90aGVyd2lzZSB1c2UgcmVzdWx0cyBkaXJlY3RseQoJCQkJCXJlc3VsdHMgOgoJCQkJbWF0Y2hlckluOwoKCQkvLyBGaW5kIHByaW1hcnkgbWF0Y2hlcwoJCWlmICggbWF0Y2hlciApIHsKCQkJbWF0Y2hlciggbWF0Y2hlckluLCBtYXRjaGVyT3V0LCBjb250ZXh0LCB4bWwgKTsKCQl9CgoJCS8vIEFwcGx5IHBvc3RGaWx0ZXIKCQlpZiAoIHBvc3RGaWx0ZXIgKSB7CgkJCXRlbXAgPSBjb25kZW5zZSggbWF0Y2hlck91dCwgcG9zdE1hcCApOwoJCQlwb3N0RmlsdGVyKCB0ZW1wLCBbXSwgY29udGV4dCwgeG1sICk7CgoJCQkvLyBVbi1tYXRjaCBmYWlsaW5nIGVsZW1lbnRzIGJ5IG1vdmluZyB0aGVtIGJhY2sgdG8gbWF0Y2hlckluCgkJCWkgPSB0ZW1wLmxlbmd0aDsKCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQlpZiAoIChlbGVtID0gdGVtcFtpXSkgKSB7CgkJCQkJbWF0Y2hlck91dFsgcG9zdE1hcFtpXSBdID0gIShtYXRjaGVySW5bIHBvc3RNYXBbaV0gXSA9IGVsZW0pOwoJCQkJfQoJCQl9CgkJfQoKCQlpZiAoIHNlZWQgKSB7CgkJCWlmICggcG9zdEZpbmRlciB8fCBwcmVGaWx0ZXIgKSB7CgkJCQlpZiAoIHBvc3RGaW5kZXIgKSB7CgkJCQkJLy8gR2V0IHRoZSBmaW5hbCBtYXRjaGVyT3V0IGJ5IGNvbmRlbnNpbmcgdGhpcyBpbnRlcm1lZGlhdGUgaW50byBwb3N0RmluZGVyIGNvbnRleHRzCgkJCQkJdGVtcCA9IFtdOwoJCQkJCWkgPSBtYXRjaGVyT3V0Lmxlbmd0aDsKCQkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQkJaWYgKCAoZWxlbSA9IG1hdGNoZXJPdXRbaV0pICkgewoJCQkJCQkJLy8gUmVzdG9yZSBtYXRjaGVySW4gc2luY2UgZWxlbSBpcyBub3QgeWV0IGEgZmluYWwgbWF0Y2gKCQkJCQkJCXRlbXAucHVzaCggKG1hdGNoZXJJbltpXSA9IGVsZW0pICk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJcG9zdEZpbmRlciggbnVsbCwgKG1hdGNoZXJPdXQgPSBbXSksIHRlbXAsIHhtbCApOwoJCQkJfQoKCQkJCS8vIE1vdmUgbWF0Y2hlZCBlbGVtZW50cyBmcm9tIHNlZWQgdG8gcmVzdWx0cyB0byBrZWVwIHRoZW0gc3luY2hyb25pemVkCgkJCQlpID0gbWF0Y2hlck91dC5sZW5ndGg7CgkJCQl3aGlsZSAoIGktLSApIHsKCQkJCQlpZiAoIChlbGVtID0gbWF0Y2hlck91dFtpXSkgJiYKCQkJCQkJKHRlbXAgPSBwb3N0RmluZGVyID8gaW5kZXhPZiggc2VlZCwgZWxlbSApIDogcHJlTWFwW2ldKSA+IC0xICkgewoKCQkJCQkJc2VlZFt0ZW1wXSA9ICEocmVzdWx0c1t0ZW1wXSA9IGVsZW0pOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkvLyBBZGQgZWxlbWVudHMgdG8gcmVzdWx0cywgdGhyb3VnaCBwb3N0RmluZGVyIGlmIGRlZmluZWQKCQl9IGVsc2UgewoJCQltYXRjaGVyT3V0ID0gY29uZGVuc2UoCgkJCQltYXRjaGVyT3V0ID09PSByZXN1bHRzID8KCQkJCQltYXRjaGVyT3V0LnNwbGljZSggcHJlZXhpc3RpbmcsIG1hdGNoZXJPdXQubGVuZ3RoICkgOgoJCQkJCW1hdGNoZXJPdXQKCQkJKTsKCQkJaWYgKCBwb3N0RmluZGVyICkgewoJCQkJcG9zdEZpbmRlciggbnVsbCwgcmVzdWx0cywgbWF0Y2hlck91dCwgeG1sICk7CgkJCX0gZWxzZSB7CgkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBtYXRjaGVyT3V0ICk7CgkJCX0KCQl9Cgl9KTsKfQoKZnVuY3Rpb24gbWF0Y2hlckZyb21Ub2tlbnMoIHRva2VucyApIHsKCXZhciBjaGVja0NvbnRleHQsIG1hdGNoZXIsIGosCgkJbGVuID0gdG9rZW5zLmxlbmd0aCwKCQlsZWFkaW5nUmVsYXRpdmUgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbMF0udHlwZSBdLAoJCWltcGxpY2l0UmVsYXRpdmUgPSBsZWFkaW5nUmVsYXRpdmUgfHwgRXhwci5yZWxhdGl2ZVsiICJdLAoJCWkgPSBsZWFkaW5nUmVsYXRpdmUgPyAxIDogMCwKCgkJLy8gVGhlIGZvdW5kYXRpb25hbCBtYXRjaGVyIGVuc3VyZXMgdGhhdCBlbGVtZW50cyBhcmUgcmVhY2hhYmxlIGZyb20gdG9wLWxldmVsIGNvbnRleHQocykKCQltYXRjaENvbnRleHQgPSBhZGRDb21iaW5hdG9yKCBmdW5jdGlvbiggZWxlbSApIHsKCQkJcmV0dXJuIGVsZW0gPT09IGNoZWNrQ29udGV4dDsKCQl9LCBpbXBsaWNpdFJlbGF0aXZlLCB0cnVlICksCgkJbWF0Y2hBbnlDb250ZXh0ID0gYWRkQ29tYmluYXRvciggZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiBpbmRleE9mKCBjaGVja0NvbnRleHQsIGVsZW0gKSA+IC0xOwoJCX0sIGltcGxpY2l0UmVsYXRpdmUsIHRydWUgKSwKCQltYXRjaGVycyA9IFsgZnVuY3Rpb24oIGVsZW0sIGNvbnRleHQsIHhtbCApIHsKCQkJdmFyIHJldCA9ICggIWxlYWRpbmdSZWxhdGl2ZSAmJiAoIHhtbCB8fCBjb250ZXh0ICE9PSBvdXRlcm1vc3RDb250ZXh0ICkgKSB8fCAoCgkJCQkoY2hlY2tDb250ZXh0ID0gY29udGV4dCkubm9kZVR5cGUgPwoJCQkJCW1hdGNoQ29udGV4dCggZWxlbSwgY29udGV4dCwgeG1sICkgOgoJCQkJCW1hdGNoQW55Q29udGV4dCggZWxlbSwgY29udGV4dCwgeG1sICkgKTsKCQkJLy8gQXZvaWQgaGFuZ2luZyBvbnRvIGVsZW1lbnQgKGlzc3VlICMyOTkpCgkJCWNoZWNrQ29udGV4dCA9IG51bGw7CgkJCXJldHVybiByZXQ7CgkJfSBdOwoKCWZvciAoIDsgaSA8IGxlbjsgaSsrICkgewoJCWlmICggKG1hdGNoZXIgPSBFeHByLnJlbGF0aXZlWyB0b2tlbnNbaV0udHlwZSBdKSApIHsKCQkJbWF0Y2hlcnMgPSBbIGFkZENvbWJpbmF0b3IoZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICksIG1hdGNoZXIpIF07CgkJfSBlbHNlIHsKCQkJbWF0Y2hlciA9IEV4cHIuZmlsdGVyWyB0b2tlbnNbaV0udHlwZSBdLmFwcGx5KCBudWxsLCB0b2tlbnNbaV0ubWF0Y2hlcyApOwoKCQkJLy8gUmV0dXJuIHNwZWNpYWwgdXBvbiBzZWVpbmcgYSBwb3NpdGlvbmFsIG1hdGNoZXIKCQkJaWYgKCBtYXRjaGVyWyBleHBhbmRvIF0gKSB7CgkJCQkvLyBGaW5kIHRoZSBuZXh0IHJlbGF0aXZlIG9wZXJhdG9yIChpZiBhbnkpIGZvciBwcm9wZXIgaGFuZGxpbmcKCQkJCWogPSArK2k7CgkJCQlmb3IgKCA7IGogPCBsZW47IGorKyApIHsKCQkJCQlpZiAoIEV4cHIucmVsYXRpdmVbIHRva2Vuc1tqXS50eXBlIF0gKSB7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiBzZXRNYXRjaGVyKAoJCQkJCWkgPiAxICYmIGVsZW1lbnRNYXRjaGVyKCBtYXRjaGVycyApLAoJCQkJCWkgPiAxICYmIHRvU2VsZWN0b3IoCgkJCQkJCS8vIElmIHRoZSBwcmVjZWRpbmcgdG9rZW4gd2FzIGEgZGVzY2VuZGFudCBjb21iaW5hdG9yLCBpbnNlcnQgYW4gaW1wbGljaXQgYW55LWVsZW1lbnQgYCpgCgkJCQkJCXRva2Vucy5zbGljZSggMCwgaSAtIDEgKS5jb25jYXQoeyB2YWx1ZTogdG9rZW5zWyBpIC0gMiBdLnR5cGUgPT09ICIgIiA/ICIqIiA6ICIiIH0pCgkJCQkJKS5yZXBsYWNlKCBydHJpbSwgIiQxIiApLAoJCQkJCW1hdGNoZXIsCgkJCQkJaSA8IGogJiYgbWF0Y2hlckZyb21Ub2tlbnMoIHRva2Vucy5zbGljZSggaSwgaiApICksCgkJCQkJaiA8IGxlbiAmJiBtYXRjaGVyRnJvbVRva2VucyggKHRva2VucyA9IHRva2Vucy5zbGljZSggaiApKSApLAoJCQkJCWogPCBsZW4gJiYgdG9TZWxlY3RvciggdG9rZW5zICkKCQkJCSk7CgkJCX0KCQkJbWF0Y2hlcnMucHVzaCggbWF0Y2hlciApOwoJCX0KCX0KCglyZXR1cm4gZWxlbWVudE1hdGNoZXIoIG1hdGNoZXJzICk7Cn0KCmZ1bmN0aW9uIG1hdGNoZXJGcm9tR3JvdXBNYXRjaGVycyggZWxlbWVudE1hdGNoZXJzLCBzZXRNYXRjaGVycyApIHsKCXZhciBieVNldCA9IHNldE1hdGNoZXJzLmxlbmd0aCA+IDAsCgkJYnlFbGVtZW50ID0gZWxlbWVudE1hdGNoZXJzLmxlbmd0aCA+IDAsCgkJc3VwZXJNYXRjaGVyID0gZnVuY3Rpb24oIHNlZWQsIGNvbnRleHQsIHhtbCwgcmVzdWx0cywgb3V0ZXJtb3N0ICkgewoJCQl2YXIgZWxlbSwgaiwgbWF0Y2hlciwKCQkJCW1hdGNoZWRDb3VudCA9IDAsCgkJCQlpID0gIjAiLAoJCQkJdW5tYXRjaGVkID0gc2VlZCAmJiBbXSwKCQkJCXNldE1hdGNoZWQgPSBbXSwKCQkJCWNvbnRleHRCYWNrdXAgPSBvdXRlcm1vc3RDb250ZXh0LAoJCQkJLy8gV2UgbXVzdCBhbHdheXMgaGF2ZSBlaXRoZXIgc2VlZCBlbGVtZW50cyBvciBvdXRlcm1vc3QgY29udGV4dAoJCQkJZWxlbXMgPSBzZWVkIHx8IGJ5RWxlbWVudCAmJiBFeHByLmZpbmRbIlRBRyJdKCAiKiIsIG91dGVybW9zdCApLAoJCQkJLy8gVXNlIGludGVnZXIgZGlycnVucyBpZmYgdGhpcyBpcyB0aGUgb3V0ZXJtb3N0IG1hdGNoZXIKCQkJCWRpcnJ1bnNVbmlxdWUgPSAoZGlycnVucyArPSBjb250ZXh0QmFja3VwID09IG51bGwgPyAxIDogTWF0aC5yYW5kb20oKSB8fCAwLjEpLAoJCQkJbGVuID0gZWxlbXMubGVuZ3RoOwoKCQkJaWYgKCBvdXRlcm1vc3QgKSB7CgkJCQlvdXRlcm1vc3RDb250ZXh0ID0gY29udGV4dCA9PT0gZG9jdW1lbnQgfHwgY29udGV4dCB8fCBvdXRlcm1vc3Q7CgkJCX0KCgkJCS8vIEFkZCBlbGVtZW50cyBwYXNzaW5nIGVsZW1lbnRNYXRjaGVycyBkaXJlY3RseSB0byByZXN1bHRzCgkJCS8vIFN1cHBvcnQ6IElFPDksIFNhZmFyaQoJCQkvLyBUb2xlcmF0ZSBOb2RlTGlzdCBwcm9wZXJ0aWVzIChJRTogImxlbmd0aCI7IFNhZmFyaTogPG51bWJlcj4pIG1hdGNoaW5nIGVsZW1lbnRzIGJ5IGlkCgkJCWZvciAoIDsgaSAhPT0gbGVuICYmIChlbGVtID0gZWxlbXNbaV0pICE9IG51bGw7IGkrKyApIHsKCQkJCWlmICggYnlFbGVtZW50ICYmIGVsZW0gKSB7CgkJCQkJaiA9IDA7CgkJCQkJaWYgKCAhY29udGV4dCAmJiBlbGVtLm93bmVyRG9jdW1lbnQgIT09IGRvY3VtZW50ICkgewoJCQkJCQlzZXREb2N1bWVudCggZWxlbSApOwoJCQkJCQl4bWwgPSAhZG9jdW1lbnRJc0hUTUw7CgkJCQkJfQoJCQkJCXdoaWxlICggKG1hdGNoZXIgPSBlbGVtZW50TWF0Y2hlcnNbaisrXSkgKSB7CgkJCQkJCWlmICggbWF0Y2hlciggZWxlbSwgY29udGV4dCB8fCBkb2N1bWVudCwgeG1sKSApIHsKCQkJCQkJCXJlc3VsdHMucHVzaCggZWxlbSApOwoJCQkJCQkJYnJlYWs7CgkJCQkJCX0KCQkJCQl9CgkJCQkJaWYgKCBvdXRlcm1vc3QgKSB7CgkJCQkJCWRpcnJ1bnMgPSBkaXJydW5zVW5pcXVlOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBUcmFjayB1bm1hdGNoZWQgZWxlbWVudHMgZm9yIHNldCBmaWx0ZXJzCgkJCQlpZiAoIGJ5U2V0ICkgewoJCQkJCS8vIFRoZXkgd2lsbCBoYXZlIGdvbmUgdGhyb3VnaCBhbGwgcG9zc2libGUgbWF0Y2hlcnMKCQkJCQlpZiAoIChlbGVtID0gIW1hdGNoZXIgJiYgZWxlbSkgKSB7CgkJCQkJCW1hdGNoZWRDb3VudC0tOwoJCQkJCX0KCgkJCQkJLy8gTGVuZ3RoZW4gdGhlIGFycmF5IGZvciBldmVyeSBlbGVtZW50LCBtYXRjaGVkIG9yIG5vdAoJCQkJCWlmICggc2VlZCApIHsKCQkJCQkJdW5tYXRjaGVkLnB1c2goIGVsZW0gKTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIGBpYCBpcyBub3cgdGhlIGNvdW50IG9mIGVsZW1lbnRzIHZpc2l0ZWQgYWJvdmUsIGFuZCBhZGRpbmcgaXQgdG8gYG1hdGNoZWRDb3VudGAKCQkJLy8gbWFrZXMgdGhlIGxhdHRlciBub25uZWdhdGl2ZS4KCQkJbWF0Y2hlZENvdW50ICs9IGk7CgoJCQkvLyBBcHBseSBzZXQgZmlsdGVycyB0byB1bm1hdGNoZWQgZWxlbWVudHMKCQkJLy8gTk9URTogVGhpcyBjYW4gYmUgc2tpcHBlZCBpZiB0aGVyZSBhcmUgbm8gdW5tYXRjaGVkIGVsZW1lbnRzIChpLmUuLCBgbWF0Y2hlZENvdW50YAoJCQkvLyBlcXVhbHMgYGlgKSwgdW5sZXNzIHdlIGRpZG4ndCB2aXNpdCBfYW55XyBlbGVtZW50cyBpbiB0aGUgYWJvdmUgbG9vcCBiZWNhdXNlIHdlIGhhdmUKCQkJLy8gbm8gZWxlbWVudCBtYXRjaGVycyBhbmQgbm8gc2VlZC4KCQkJLy8gSW5jcmVtZW50aW5nIGFuIGluaXRpYWxseS1zdHJpbmcgIjAiIGBpYCBhbGxvd3MgYGlgIHRvIHJlbWFpbiBhIHN0cmluZyBvbmx5IGluIHRoYXQKCQkJLy8gY2FzZSwgd2hpY2ggd2lsbCByZXN1bHQgaW4gYSAiMDAiIGBtYXRjaGVkQ291bnRgIHRoYXQgZGlmZmVycyBmcm9tIGBpYCBidXQgaXMgYWxzbwoJCQkvLyBudW1lcmljYWxseSB6ZXJvLgoJCQlpZiAoIGJ5U2V0ICYmIGkgIT09IG1hdGNoZWRDb3VudCApIHsKCQkJCWogPSAwOwoJCQkJd2hpbGUgKCAobWF0Y2hlciA9IHNldE1hdGNoZXJzW2orK10pICkgewoJCQkJCW1hdGNoZXIoIHVubWF0Y2hlZCwgc2V0TWF0Y2hlZCwgY29udGV4dCwgeG1sICk7CgkJCQl9CgoJCQkJaWYgKCBzZWVkICkgewoJCQkJCS8vIFJlaW50ZWdyYXRlIGVsZW1lbnQgbWF0Y2hlcyB0byBlbGltaW5hdGUgdGhlIG5lZWQgZm9yIHNvcnRpbmcKCQkJCQlpZiAoIG1hdGNoZWRDb3VudCA+IDAgKSB7CgkJCQkJCXdoaWxlICggaS0tICkgewoJCQkJCQkJaWYgKCAhKHVubWF0Y2hlZFtpXSB8fCBzZXRNYXRjaGVkW2ldKSApIHsKCQkJCQkJCQlzZXRNYXRjaGVkW2ldID0gcG9wLmNhbGwoIHJlc3VsdHMgKTsKCQkJCQkJCX0KCQkJCQkJfQoJCQkJCX0KCgkJCQkJLy8gRGlzY2FyZCBpbmRleCBwbGFjZWhvbGRlciB2YWx1ZXMgdG8gZ2V0IG9ubHkgYWN0dWFsIG1hdGNoZXMKCQkJCQlzZXRNYXRjaGVkID0gY29uZGVuc2UoIHNldE1hdGNoZWQgKTsKCQkJCX0KCgkJCQkvLyBBZGQgbWF0Y2hlcyB0byByZXN1bHRzCgkJCQlwdXNoLmFwcGx5KCByZXN1bHRzLCBzZXRNYXRjaGVkICk7CgoJCQkJLy8gU2VlZGxlc3Mgc2V0IG1hdGNoZXMgc3VjY2VlZGluZyBtdWx0aXBsZSBzdWNjZXNzZnVsIG1hdGNoZXJzIHN0aXB1bGF0ZSBzb3J0aW5nCgkJCQlpZiAoIG91dGVybW9zdCAmJiAhc2VlZCAmJiBzZXRNYXRjaGVkLmxlbmd0aCA+IDAgJiYKCQkJCQkoIG1hdGNoZWRDb3VudCArIHNldE1hdGNoZXJzLmxlbmd0aCApID4gMSApIHsKCgkJCQkJU2l6emxlLnVuaXF1ZVNvcnQoIHJlc3VsdHMgKTsKCQkJCX0KCQkJfQoKCQkJLy8gT3ZlcnJpZGUgbWFuaXB1bGF0aW9uIG9mIGdsb2JhbHMgYnkgbmVzdGVkIG1hdGNoZXJzCgkJCWlmICggb3V0ZXJtb3N0ICkgewoJCQkJZGlycnVucyA9IGRpcnJ1bnNVbmlxdWU7CgkJCQlvdXRlcm1vc3RDb250ZXh0ID0gY29udGV4dEJhY2t1cDsKCQkJfQoKCQkJcmV0dXJuIHVubWF0Y2hlZDsKCQl9OwoKCXJldHVybiBieVNldCA/CgkJbWFya0Z1bmN0aW9uKCBzdXBlck1hdGNoZXIgKSA6CgkJc3VwZXJNYXRjaGVyOwp9Cgpjb21waWxlID0gU2l6emxlLmNvbXBpbGUgPSBmdW5jdGlvbiggc2VsZWN0b3IsIG1hdGNoIC8qIEludGVybmFsIFVzZSBPbmx5ICovICkgewoJdmFyIGksCgkJc2V0TWF0Y2hlcnMgPSBbXSwKCQllbGVtZW50TWF0Y2hlcnMgPSBbXSwKCQljYWNoZWQgPSBjb21waWxlckNhY2hlWyBzZWxlY3RvciArICIgIiBdOwoKCWlmICggIWNhY2hlZCApIHsKCQkvLyBHZW5lcmF0ZSBhIGZ1bmN0aW9uIG9mIHJlY3Vyc2l2ZSBmdW5jdGlvbnMgdGhhdCBjYW4gYmUgdXNlZCB0byBjaGVjayBlYWNoIGVsZW1lbnQKCQlpZiAoICFtYXRjaCApIHsKCQkJbWF0Y2ggPSB0b2tlbml6ZSggc2VsZWN0b3IgKTsKCQl9CgkJaSA9IG1hdGNoLmxlbmd0aDsKCQl3aGlsZSAoIGktLSApIHsKCQkJY2FjaGVkID0gbWF0Y2hlckZyb21Ub2tlbnMoIG1hdGNoW2ldICk7CgkJCWlmICggY2FjaGVkWyBleHBhbmRvIF0gKSB7CgkJCQlzZXRNYXRjaGVycy5wdXNoKCBjYWNoZWQgKTsKCQkJfSBlbHNlIHsKCQkJCWVsZW1lbnRNYXRjaGVycy5wdXNoKCBjYWNoZWQgKTsKCQkJfQoJCX0KCgkJLy8gQ2FjaGUgdGhlIGNvbXBpbGVkIGZ1bmN0aW9uCgkJY2FjaGVkID0gY29tcGlsZXJDYWNoZSggc2VsZWN0b3IsIG1hdGNoZXJGcm9tR3JvdXBNYXRjaGVycyggZWxlbWVudE1hdGNoZXJzLCBzZXRNYXRjaGVycyApICk7CgoJCS8vIFNhdmUgc2VsZWN0b3IgYW5kIHRva2VuaXphdGlvbgoJCWNhY2hlZC5zZWxlY3RvciA9IHNlbGVjdG9yOwoJfQoJcmV0dXJuIGNhY2hlZDsKfTsKCi8qKgogKiBBIGxvdy1sZXZlbCBzZWxlY3Rpb24gZnVuY3Rpb24gdGhhdCB3b3JrcyB3aXRoIFNpenpsZSdzIGNvbXBpbGVkCiAqICBzZWxlY3RvciBmdW5jdGlvbnMKICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IHNlbGVjdG9yIEEgc2VsZWN0b3Igb3IgYSBwcmUtY29tcGlsZWQKICogIHNlbGVjdG9yIGZ1bmN0aW9uIGJ1aWx0IHdpdGggU2l6emxlLmNvbXBpbGUKICogQHBhcmFtIHtFbGVtZW50fSBjb250ZXh0CiAqIEBwYXJhbSB7QXJyYXl9IFtyZXN1bHRzXQogKiBAcGFyYW0ge0FycmF5fSBbc2VlZF0gQSBzZXQgb2YgZWxlbWVudHMgdG8gbWF0Y2ggYWdhaW5zdAogKi8Kc2VsZWN0ID0gU2l6emxlLnNlbGVjdCA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCwgcmVzdWx0cywgc2VlZCApIHsKCXZhciBpLCB0b2tlbnMsIHRva2VuLCB0eXBlLCBmaW5kLAoJCWNvbXBpbGVkID0gdHlwZW9mIHNlbGVjdG9yID09PSAiZnVuY3Rpb24iICYmIHNlbGVjdG9yLAoJCW1hdGNoID0gIXNlZWQgJiYgdG9rZW5pemUoIChzZWxlY3RvciA9IGNvbXBpbGVkLnNlbGVjdG9yIHx8IHNlbGVjdG9yKSApOwoKCXJlc3VsdHMgPSByZXN1bHRzIHx8IFtdOwoKCS8vIFRyeSB0byBtaW5pbWl6ZSBvcGVyYXRpb25zIGlmIHRoZXJlIGlzIG9ubHkgb25lIHNlbGVjdG9yIGluIHRoZSBsaXN0IGFuZCBubyBzZWVkCgkvLyAodGhlIGxhdHRlciBvZiB3aGljaCBndWFyYW50ZWVzIHVzIGNvbnRleHQpCglpZiAoIG1hdGNoLmxlbmd0aCA9PT0gMSApIHsKCgkJLy8gUmVkdWNlIGNvbnRleHQgaWYgdGhlIGxlYWRpbmcgY29tcG91bmQgc2VsZWN0b3IgaXMgYW4gSUQKCQl0b2tlbnMgPSBtYXRjaFswXSA9IG1hdGNoWzBdLnNsaWNlKCAwICk7CgkJaWYgKCB0b2tlbnMubGVuZ3RoID4gMiAmJiAodG9rZW4gPSB0b2tlbnNbMF0pLnR5cGUgPT09ICJJRCIgJiYKCQkJCXN1cHBvcnQuZ2V0QnlJZCAmJiBjb250ZXh0Lm5vZGVUeXBlID09PSA5ICYmIGRvY3VtZW50SXNIVE1MICYmCgkJCQlFeHByLnJlbGF0aXZlWyB0b2tlbnNbMV0udHlwZSBdICkgewoKCQkJY29udGV4dCA9ICggRXhwci5maW5kWyJJRCJdKCB0b2tlbi5tYXRjaGVzWzBdLnJlcGxhY2UocnVuZXNjYXBlLCBmdW5lc2NhcGUpLCBjb250ZXh0ICkgfHwgW10gKVswXTsKCQkJaWYgKCAhY29udGV4dCApIHsKCQkJCXJldHVybiByZXN1bHRzOwoKCQkJLy8gUHJlY29tcGlsZWQgbWF0Y2hlcnMgd2lsbCBzdGlsbCB2ZXJpZnkgYW5jZXN0cnksIHNvIHN0ZXAgdXAgYSBsZXZlbAoJCQl9IGVsc2UgaWYgKCBjb21waWxlZCApIHsKCQkJCWNvbnRleHQgPSBjb250ZXh0LnBhcmVudE5vZGU7CgkJCX0KCgkJCXNlbGVjdG9yID0gc2VsZWN0b3Iuc2xpY2UoIHRva2Vucy5zaGlmdCgpLnZhbHVlLmxlbmd0aCApOwoJCX0KCgkJLy8gRmV0Y2ggYSBzZWVkIHNldCBmb3IgcmlnaHQtdG8tbGVmdCBtYXRjaGluZwoJCWkgPSBtYXRjaEV4cHJbIm5lZWRzQ29udGV4dCJdLnRlc3QoIHNlbGVjdG9yICkgPyAwIDogdG9rZW5zLmxlbmd0aDsKCQl3aGlsZSAoIGktLSApIHsKCQkJdG9rZW4gPSB0b2tlbnNbaV07CgoJCQkvLyBBYm9ydCBpZiB3ZSBoaXQgYSBjb21iaW5hdG9yCgkJCWlmICggRXhwci5yZWxhdGl2ZVsgKHR5cGUgPSB0b2tlbi50eXBlKSBdICkgewoJCQkJYnJlYWs7CgkJCX0KCQkJaWYgKCAoZmluZCA9IEV4cHIuZmluZFsgdHlwZSBdKSApIHsKCQkJCS8vIFNlYXJjaCwgZXhwYW5kaW5nIGNvbnRleHQgZm9yIGxlYWRpbmcgc2libGluZyBjb21iaW5hdG9ycwoJCQkJaWYgKCAoc2VlZCA9IGZpbmQoCgkJCQkJdG9rZW4ubWF0Y2hlc1swXS5yZXBsYWNlKCBydW5lc2NhcGUsIGZ1bmVzY2FwZSApLAoJCQkJCXJzaWJsaW5nLnRlc3QoIHRva2Vuc1swXS50eXBlICkgJiYgdGVzdENvbnRleHQoIGNvbnRleHQucGFyZW50Tm9kZSApIHx8IGNvbnRleHQKCQkJCSkpICkgewoKCQkJCQkvLyBJZiBzZWVkIGlzIGVtcHR5IG9yIG5vIHRva2VucyByZW1haW4sIHdlIGNhbiByZXR1cm4gZWFybHkKCQkJCQl0b2tlbnMuc3BsaWNlKCBpLCAxICk7CgkJCQkJc2VsZWN0b3IgPSBzZWVkLmxlbmd0aCAmJiB0b1NlbGVjdG9yKCB0b2tlbnMgKTsKCQkJCQlpZiAoICFzZWxlY3RvciApIHsKCQkJCQkJcHVzaC5hcHBseSggcmVzdWx0cywgc2VlZCApOwoJCQkJCQlyZXR1cm4gcmVzdWx0czsKCQkJCQl9CgoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJfQoJfQoKCS8vIENvbXBpbGUgYW5kIGV4ZWN1dGUgYSBmaWx0ZXJpbmcgZnVuY3Rpb24gaWYgb25lIGlzIG5vdCBwcm92aWRlZAoJLy8gUHJvdmlkZSBgbWF0Y2hgIHRvIGF2b2lkIHJldG9rZW5pemF0aW9uIGlmIHdlIG1vZGlmaWVkIHRoZSBzZWxlY3RvciBhYm92ZQoJKCBjb21waWxlZCB8fCBjb21waWxlKCBzZWxlY3RvciwgbWF0Y2ggKSApKAoJCXNlZWQsCgkJY29udGV4dCwKCQkhZG9jdW1lbnRJc0hUTUwsCgkJcmVzdWx0cywKCQkhY29udGV4dCB8fCByc2libGluZy50ZXN0KCBzZWxlY3RvciApICYmIHRlc3RDb250ZXh0KCBjb250ZXh0LnBhcmVudE5vZGUgKSB8fCBjb250ZXh0CgkpOwoJcmV0dXJuIHJlc3VsdHM7Cn07CgovLyBPbmUtdGltZSBhc3NpZ25tZW50cwoKLy8gU29ydCBzdGFiaWxpdHkKc3VwcG9ydC5zb3J0U3RhYmxlID0gZXhwYW5kby5zcGxpdCgiIikuc29ydCggc29ydE9yZGVyICkuam9pbigiIikgPT09IGV4cGFuZG87CgovLyBTdXBwb3J0OiBDaHJvbWUgMTQtMzUrCi8vIEFsd2F5cyBhc3N1bWUgZHVwbGljYXRlcyBpZiB0aGV5IGFyZW4ndCBwYXNzZWQgdG8gdGhlIGNvbXBhcmlzb24gZnVuY3Rpb24Kc3VwcG9ydC5kZXRlY3REdXBsaWNhdGVzID0gISFoYXNEdXBsaWNhdGU7CgovLyBJbml0aWFsaXplIGFnYWluc3QgdGhlIGRlZmF1bHQgZG9jdW1lbnQKc2V0RG9jdW1lbnQoKTsKCi8vIFN1cHBvcnQ6IFdlYmtpdDw1MzcuMzIgLSBTYWZhcmkgNi4wLjMvQ2hyb21lIDI1IChmaXhlZCBpbiBDaHJvbWUgMjcpCi8vIERldGFjaGVkIG5vZGVzIGNvbmZvdW5kaW5nbHkgZm9sbG93ICplYWNoIG90aGVyKgpzdXBwb3J0LnNvcnREZXRhY2hlZCA9IGFzc2VydChmdW5jdGlvbiggZGl2MSApIHsKCS8vIFNob3VsZCByZXR1cm4gMSwgYnV0IHJldHVybnMgNCAoZm9sbG93aW5nKQoJcmV0dXJuIGRpdjEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpICkgJiAxOwp9KTsKCi8vIFN1cHBvcnQ6IElFPDgKLy8gUHJldmVudCBhdHRyaWJ1dGUvcHJvcGVydHkgImludGVycG9sYXRpb24iCi8vIGh0dHA6Ly9tc2RuLm1pY3Jvc29mdC5jb20vZW4tdXMvbGlicmFyeS9tczUzNjQyOSUyOFZTLjg1JTI5LmFzcHgKaWYgKCAhYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CglkaXYuaW5uZXJIVE1MID0gIjxhIGhyZWY9JyMnPjwvYT4iOwoJcmV0dXJuIGRpdi5maXJzdENoaWxkLmdldEF0dHJpYnV0ZSgiaHJlZiIpID09PSAiIyIgOwp9KSApIHsKCWFkZEhhbmRsZSggInR5cGV8aHJlZnxoZWlnaHR8d2lkdGgiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJaWYgKCAhaXNYTUwgKSB7CgkJCXJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSggbmFtZSwgbmFtZS50b0xvd2VyQ2FzZSgpID09PSAidHlwZSIgPyAxIDogMiApOwoJCX0KCX0pOwp9CgovLyBTdXBwb3J0OiBJRTw5Ci8vIFVzZSBkZWZhdWx0VmFsdWUgaW4gcGxhY2Ugb2YgZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpCmlmICggIXN1cHBvcnQuYXR0cmlidXRlcyB8fCAhYXNzZXJ0KGZ1bmN0aW9uKCBkaXYgKSB7CglkaXYuaW5uZXJIVE1MID0gIjxpbnB1dC8+IjsKCWRpdi5maXJzdENoaWxkLnNldEF0dHJpYnV0ZSggInZhbHVlIiwgIiIgKTsKCXJldHVybiBkaXYuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoICJ2YWx1ZSIgKSA9PT0gIiI7Cn0pICkgewoJYWRkSGFuZGxlKCAidmFsdWUiLCBmdW5jdGlvbiggZWxlbSwgbmFtZSwgaXNYTUwgKSB7CgkJaWYgKCAhaXNYTUwgJiYgZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAiaW5wdXQiICkgewoJCQlyZXR1cm4gZWxlbS5kZWZhdWx0VmFsdWU7CgkJfQoJfSk7Cn0KCi8vIFN1cHBvcnQ6IElFPDkKLy8gVXNlIGdldEF0dHJpYnV0ZU5vZGUgdG8gZmV0Y2ggYm9vbGVhbnMgd2hlbiBnZXRBdHRyaWJ1dGUgbGllcwppZiAoICFhc3NlcnQoZnVuY3Rpb24oIGRpdiApIHsKCXJldHVybiBkaXYuZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpID09IG51bGw7Cn0pICkgewoJYWRkSGFuZGxlKCBib29sZWFucywgZnVuY3Rpb24oIGVsZW0sIG5hbWUsIGlzWE1MICkgewoJCXZhciB2YWw7CgkJaWYgKCAhaXNYTUwgKSB7CgkJCXJldHVybiBlbGVtWyBuYW1lIF0gPT09IHRydWUgPyBuYW1lLnRvTG93ZXJDYXNlKCkgOgoJCQkJCSh2YWwgPSBlbGVtLmdldEF0dHJpYnV0ZU5vZGUoIG5hbWUgKSkgJiYgdmFsLnNwZWNpZmllZCA/CgkJCQkJdmFsLnZhbHVlIDoKCQkJCW51bGw7CgkJfQoJfSk7Cn0KCnJldHVybiBTaXp6bGU7Cgp9KSggd2luZG93ICk7CgoKCmpRdWVyeS5maW5kID0gU2l6emxlOwpqUXVlcnkuZXhwciA9IFNpenpsZS5zZWxlY3RvcnM7CmpRdWVyeS5leHByWyAiOiIgXSA9IGpRdWVyeS5leHByLnBzZXVkb3M7CmpRdWVyeS51bmlxdWVTb3J0ID0galF1ZXJ5LnVuaXF1ZSA9IFNpenpsZS51bmlxdWVTb3J0OwpqUXVlcnkudGV4dCA9IFNpenpsZS5nZXRUZXh0OwpqUXVlcnkuaXNYTUxEb2MgPSBTaXp6bGUuaXNYTUw7CmpRdWVyeS5jb250YWlucyA9IFNpenpsZS5jb250YWluczsKCgoKdmFyIGRpciA9IGZ1bmN0aW9uKCBlbGVtLCBkaXIsIHVudGlsICkgewoJdmFyIG1hdGNoZWQgPSBbXSwKCQl0cnVuY2F0ZSA9IHVudGlsICE9PSB1bmRlZmluZWQ7CgoJd2hpbGUgKCAoIGVsZW0gPSBlbGVtWyBkaXIgXSApICYmIGVsZW0ubm9kZVR5cGUgIT09IDkgKSB7CgkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICkgewoJCQlpZiAoIHRydW5jYXRlICYmIGpRdWVyeSggZWxlbSApLmlzKCB1bnRpbCApICkgewoJCQkJYnJlYWs7CgkJCX0KCQkJbWF0Y2hlZC5wdXNoKCBlbGVtICk7CgkJfQoJfQoJcmV0dXJuIG1hdGNoZWQ7Cn07CgoKdmFyIHNpYmxpbmdzID0gZnVuY3Rpb24oIG4sIGVsZW0gKSB7Cgl2YXIgbWF0Y2hlZCA9IFtdOwoKCWZvciAoIDsgbjsgbiA9IG4ubmV4dFNpYmxpbmcgKSB7CgkJaWYgKCBuLm5vZGVUeXBlID09PSAxICYmIG4gIT09IGVsZW0gKSB7CgkJCW1hdGNoZWQucHVzaCggbiApOwoJCX0KCX0KCglyZXR1cm4gbWF0Y2hlZDsKfTsKCgp2YXIgcm5lZWRzQ29udGV4dCA9IGpRdWVyeS5leHByLm1hdGNoLm5lZWRzQ29udGV4dDsKCnZhciByc2luZ2xlVGFnID0gKCAvXjwoW1x3LV0rKVxzKlwvPz4oPzo8XC9cMT58KSQvICk7CgoKCnZhciByaXNTaW1wbGUgPSAvXi5bXjojXFtcLixdKiQvOwoKLy8gSW1wbGVtZW50IHRoZSBpZGVudGljYWwgZnVuY3Rpb25hbGl0eSBmb3IgZmlsdGVyIGFuZCBub3QKZnVuY3Rpb24gd2lubm93KCBlbGVtZW50cywgcXVhbGlmaWVyLCBub3QgKSB7CglpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBxdWFsaWZpZXIgKSApIHsKCQlyZXR1cm4galF1ZXJ5LmdyZXAoIGVsZW1lbnRzLCBmdW5jdGlvbiggZWxlbSwgaSApIHsKCQkJLyoganNoaW50IC1XMDE4ICovCgkJCXJldHVybiAhIXF1YWxpZmllci5jYWxsKCBlbGVtLCBpLCBlbGVtICkgIT09IG5vdDsKCQl9ICk7CgoJfQoKCWlmICggcXVhbGlmaWVyLm5vZGVUeXBlICkgewoJCXJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gKCBlbGVtID09PSBxdWFsaWZpZXIgKSAhPT0gbm90OwoJCX0gKTsKCgl9CgoJaWYgKCB0eXBlb2YgcXVhbGlmaWVyID09PSAic3RyaW5nIiApIHsKCQlpZiAoIHJpc1NpbXBsZS50ZXN0KCBxdWFsaWZpZXIgKSApIHsKCQkJcmV0dXJuIGpRdWVyeS5maWx0ZXIoIHF1YWxpZmllciwgZWxlbWVudHMsIG5vdCApOwoJCX0KCgkJcXVhbGlmaWVyID0galF1ZXJ5LmZpbHRlciggcXVhbGlmaWVyLCBlbGVtZW50cyApOwoJfQoKCXJldHVybiBqUXVlcnkuZ3JlcCggZWxlbWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCXJldHVybiAoIGluZGV4T2YuY2FsbCggcXVhbGlmaWVyLCBlbGVtICkgPiAtMSApICE9PSBub3Q7Cgl9ICk7Cn0KCmpRdWVyeS5maWx0ZXIgPSBmdW5jdGlvbiggZXhwciwgZWxlbXMsIG5vdCApIHsKCXZhciBlbGVtID0gZWxlbXNbIDAgXTsKCglpZiAoIG5vdCApIHsKCQlleHByID0gIjpub3QoIiArIGV4cHIgKyAiKSI7Cgl9CgoJcmV0dXJuIGVsZW1zLmxlbmd0aCA9PT0gMSAmJiBlbGVtLm5vZGVUeXBlID09PSAxID8KCQlqUXVlcnkuZmluZC5tYXRjaGVzU2VsZWN0b3IoIGVsZW0sIGV4cHIgKSA/IFsgZWxlbSBdIDogW10gOgoJCWpRdWVyeS5maW5kLm1hdGNoZXMoIGV4cHIsIGpRdWVyeS5ncmVwKCBlbGVtcywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCXJldHVybiBlbGVtLm5vZGVUeXBlID09PSAxOwoJCX0gKSApOwp9OwoKalF1ZXJ5LmZuLmV4dGVuZCggewoJZmluZDogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCXZhciBpLAoJCQlsZW4gPSB0aGlzLmxlbmd0aCwKCQkJcmV0ID0gW10sCgkJCXNlbGYgPSB0aGlzOwoKCQlpZiAoIHR5cGVvZiBzZWxlY3RvciAhPT0gInN0cmluZyIgKSB7CgkJCXJldHVybiB0aGlzLnB1c2hTdGFjayggalF1ZXJ5KCBzZWxlY3RvciApLmZpbHRlciggZnVuY3Rpb24oKSB7CgkJCQlmb3IgKCBpID0gMDsgaSA8IGxlbjsgaSsrICkgewoJCQkJCWlmICggalF1ZXJ5LmNvbnRhaW5zKCBzZWxmWyBpIF0sIHRoaXMgKSApIHsKCQkJCQkJcmV0dXJuIHRydWU7CgkJCQkJfQoJCQkJfQoJCQl9ICkgKTsKCQl9CgoJCWZvciAoIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7CgkJCWpRdWVyeS5maW5kKCBzZWxlY3Rvciwgc2VsZlsgaSBdLCByZXQgKTsKCQl9CgoJCS8vIE5lZWRlZCBiZWNhdXNlICQoIHNlbGVjdG9yLCBjb250ZXh0ICkgYmVjb21lcyAkKCBjb250ZXh0ICkuZmluZCggc2VsZWN0b3IgKQoJCXJldCA9IHRoaXMucHVzaFN0YWNrKCBsZW4gPiAxID8galF1ZXJ5LnVuaXF1ZSggcmV0ICkgOiByZXQgKTsKCQlyZXQuc2VsZWN0b3IgPSB0aGlzLnNlbGVjdG9yID8gdGhpcy5zZWxlY3RvciArICIgIiArIHNlbGVjdG9yIDogc2VsZWN0b3I7CgkJcmV0dXJuIHJldDsKCX0sCglmaWx0ZXI6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHdpbm5vdyggdGhpcywgc2VsZWN0b3IgfHwgW10sIGZhbHNlICkgKTsKCX0sCglub3Q6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soIHdpbm5vdyggdGhpcywgc2VsZWN0b3IgfHwgW10sIHRydWUgKSApOwoJfSwKCWlzOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJcmV0dXJuICEhd2lubm93KAoJCQl0aGlzLAoKCQkJLy8gSWYgdGhpcyBpcyBhIHBvc2l0aW9uYWwvcmVsYXRpdmUgc2VsZWN0b3IsIGNoZWNrIG1lbWJlcnNoaXAgaW4gdGhlIHJldHVybmVkIHNldAoJCQkvLyBzbyAkKCJwOmZpcnN0IikuaXMoInA6bGFzdCIpIHdvbid0IHJldHVybiB0cnVlIGZvciBhIGRvYyB3aXRoIHR3byAicCIuCgkJCXR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIgJiYgcm5lZWRzQ29udGV4dC50ZXN0KCBzZWxlY3RvciApID8KCQkJCWpRdWVyeSggc2VsZWN0b3IgKSA6CgkJCQlzZWxlY3RvciB8fCBbXSwKCQkJZmFsc2UKCQkpLmxlbmd0aDsKCX0KfSApOwoKCi8vIEluaXRpYWxpemUgYSBqUXVlcnkgb2JqZWN0CgoKLy8gQSBjZW50cmFsIHJlZmVyZW5jZSB0byB0aGUgcm9vdCBqUXVlcnkoZG9jdW1lbnQpCnZhciByb290alF1ZXJ5LAoKCS8vIEEgc2ltcGxlIHdheSB0byBjaGVjayBmb3IgSFRNTCBzdHJpbmdzCgkvLyBQcmlvcml0aXplICNpZCBvdmVyIDx0YWc+IHRvIGF2b2lkIFhTUyB2aWEgbG9jYXRpb24uaGFzaCAoIzk1MjEpCgkvLyBTdHJpY3QgSFRNTCByZWNvZ25pdGlvbiAoIzExMjkwOiBtdXN0IHN0YXJ0IHdpdGggPCkKCXJxdWlja0V4cHIgPSAvXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSopKSQvLAoKCWluaXQgPSBqUXVlcnkuZm4uaW5pdCA9IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCwgcm9vdCApIHsKCQl2YXIgbWF0Y2gsIGVsZW07CgoJCS8vIEhBTkRMRTogJCgiIiksICQobnVsbCksICQodW5kZWZpbmVkKSwgJChmYWxzZSkKCQlpZiAoICFzZWxlY3RvciApIHsKCQkJcmV0dXJuIHRoaXM7CgkJfQoKCQkvLyBNZXRob2QgaW5pdCgpIGFjY2VwdHMgYW4gYWx0ZXJuYXRlIHJvb3RqUXVlcnkKCQkvLyBzbyBtaWdyYXRlIGNhbiBzdXBwb3J0IGpRdWVyeS5zdWIgKGdoLTIxMDEpCgkJcm9vdCA9IHJvb3QgfHwgcm9vdGpRdWVyeTsKCgkJLy8gSGFuZGxlIEhUTUwgc3RyaW5ncwoJCWlmICggdHlwZW9mIHNlbGVjdG9yID09PSAic3RyaW5nIiApIHsKCQkJaWYgKCBzZWxlY3RvclsgMCBdID09PSAiPCIgJiYKCQkJCXNlbGVjdG9yWyBzZWxlY3Rvci5sZW5ndGggLSAxIF0gPT09ICI+IiAmJgoJCQkJc2VsZWN0b3IubGVuZ3RoID49IDMgKSB7CgoJCQkJLy8gQXNzdW1lIHRoYXQgc3RyaW5ncyB0aGF0IHN0YXJ0IGFuZCBlbmQgd2l0aCA8PiBhcmUgSFRNTCBhbmQgc2tpcCB0aGUgcmVnZXggY2hlY2sKCQkJCW1hdGNoID0gWyBudWxsLCBzZWxlY3RvciwgbnVsbCBdOwoKCQkJfSBlbHNlIHsKCQkJCW1hdGNoID0gcnF1aWNrRXhwci5leGVjKCBzZWxlY3RvciApOwoJCQl9CgoJCQkvLyBNYXRjaCBodG1sIG9yIG1ha2Ugc3VyZSBubyBjb250ZXh0IGlzIHNwZWNpZmllZCBmb3IgI2lkCgkJCWlmICggbWF0Y2ggJiYgKCBtYXRjaFsgMSBdIHx8ICFjb250ZXh0ICkgKSB7CgoJCQkJLy8gSEFORExFOiAkKGh0bWwpIC0+ICQoYXJyYXkpCgkJCQlpZiAoIG1hdGNoWyAxIF0gKSB7CgkJCQkJY29udGV4dCA9IGNvbnRleHQgaW5zdGFuY2VvZiBqUXVlcnkgPyBjb250ZXh0WyAwIF0gOiBjb250ZXh0OwoKCQkJCQkvLyBPcHRpb24gdG8gcnVuIHNjcmlwdHMgaXMgdHJ1ZSBmb3IgYmFjay1jb21wYXQKCQkJCQkvLyBJbnRlbnRpb25hbGx5IGxldCB0aGUgZXJyb3IgYmUgdGhyb3duIGlmIHBhcnNlSFRNTCBpcyBub3QgcHJlc2VudAoJCQkJCWpRdWVyeS5tZXJnZSggdGhpcywgalF1ZXJ5LnBhcnNlSFRNTCgKCQkJCQkJbWF0Y2hbIDEgXSwKCQkJCQkJY29udGV4dCAmJiBjb250ZXh0Lm5vZGVUeXBlID8gY29udGV4dC5vd25lckRvY3VtZW50IHx8IGNvbnRleHQgOiBkb2N1bWVudCwKCQkJCQkJdHJ1ZQoJCQkJCSkgKTsKCgkJCQkJLy8gSEFORExFOiAkKGh0bWwsIHByb3BzKQoJCQkJCWlmICggcnNpbmdsZVRhZy50ZXN0KCBtYXRjaFsgMSBdICkgJiYgalF1ZXJ5LmlzUGxhaW5PYmplY3QoIGNvbnRleHQgKSApIHsKCQkJCQkJZm9yICggbWF0Y2ggaW4gY29udGV4dCApIHsKCgkJCQkJCQkvLyBQcm9wZXJ0aWVzIG9mIGNvbnRleHQgYXJlIGNhbGxlZCBhcyBtZXRob2RzIGlmIHBvc3NpYmxlCgkJCQkJCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB0aGlzWyBtYXRjaCBdICkgKSB7CgkJCQkJCQkJdGhpc1sgbWF0Y2ggXSggY29udGV4dFsgbWF0Y2ggXSApOwoKCQkJCQkJCS8vIC4uLmFuZCBvdGhlcndpc2Ugc2V0IGFzIGF0dHJpYnV0ZXMKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJdGhpcy5hdHRyKCBtYXRjaCwgY29udGV4dFsgbWF0Y2ggXSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoKCQkJCQlyZXR1cm4gdGhpczsKCgkJCQkvLyBIQU5ETEU6ICQoI2lkKQoJCQkJfSBlbHNlIHsKCQkJCQllbGVtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIG1hdGNoWyAyIF0gKTsKCgkJCQkJLy8gU3VwcG9ydDogQmxhY2tiZXJyeSA0LjYKCQkJCQkvLyBnRUJJRCByZXR1cm5zIG5vZGVzIG5vIGxvbmdlciBpbiB0aGUgZG9jdW1lbnQgKCM2OTYzKQoJCQkJCWlmICggZWxlbSAmJiBlbGVtLnBhcmVudE5vZGUgKSB7CgoJCQkJCQkvLyBJbmplY3QgdGhlIGVsZW1lbnQgZGlyZWN0bHkgaW50byB0aGUgalF1ZXJ5IG9iamVjdAoJCQkJCQl0aGlzLmxlbmd0aCA9IDE7CgkJCQkJCXRoaXNbIDAgXSA9IGVsZW07CgkJCQkJfQoKCQkJCQl0aGlzLmNvbnRleHQgPSBkb2N1bWVudDsKCQkJCQl0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3I7CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9CgoJCQkvLyBIQU5ETEU6ICQoZXhwciwgJCguLi4pKQoJCQl9IGVsc2UgaWYgKCAhY29udGV4dCB8fCBjb250ZXh0LmpxdWVyeSApIHsKCQkJCXJldHVybiAoIGNvbnRleHQgfHwgcm9vdCApLmZpbmQoIHNlbGVjdG9yICk7CgoJCQkvLyBIQU5ETEU6ICQoZXhwciwgY29udGV4dCkKCQkJLy8gKHdoaWNoIGlzIGp1c3QgZXF1aXZhbGVudCB0bzogJChjb250ZXh0KS5maW5kKGV4cHIpCgkJCX0gZWxzZSB7CgkJCQlyZXR1cm4gdGhpcy5jb25zdHJ1Y3RvciggY29udGV4dCApLmZpbmQoIHNlbGVjdG9yICk7CgkJCX0KCgkJLy8gSEFORExFOiAkKERPTUVsZW1lbnQpCgkJfSBlbHNlIGlmICggc2VsZWN0b3Iubm9kZVR5cGUgKSB7CgkJCXRoaXMuY29udGV4dCA9IHRoaXNbIDAgXSA9IHNlbGVjdG9yOwoJCQl0aGlzLmxlbmd0aCA9IDE7CgkJCXJldHVybiB0aGlzOwoKCQkvLyBIQU5ETEU6ICQoZnVuY3Rpb24pCgkJLy8gU2hvcnRjdXQgZm9yIGRvY3VtZW50IHJlYWR5CgkJfSBlbHNlIGlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHNlbGVjdG9yICkgKSB7CgkJCXJldHVybiByb290LnJlYWR5ICE9PSB1bmRlZmluZWQgPwoJCQkJcm9vdC5yZWFkeSggc2VsZWN0b3IgKSA6CgoJCQkJLy8gRXhlY3V0ZSBpbW1lZGlhdGVseSBpZiByZWFkeSBpcyBub3QgcHJlc2VudAoJCQkJc2VsZWN0b3IoIGpRdWVyeSApOwoJCX0KCgkJaWYgKCBzZWxlY3Rvci5zZWxlY3RvciAhPT0gdW5kZWZpbmVkICkgewoJCQl0aGlzLnNlbGVjdG9yID0gc2VsZWN0b3Iuc2VsZWN0b3I7CgkJCXRoaXMuY29udGV4dCA9IHNlbGVjdG9yLmNvbnRleHQ7CgkJfQoKCQlyZXR1cm4galF1ZXJ5Lm1ha2VBcnJheSggc2VsZWN0b3IsIHRoaXMgKTsKCX07CgovLyBHaXZlIHRoZSBpbml0IGZ1bmN0aW9uIHRoZSBqUXVlcnkgcHJvdG90eXBlIGZvciBsYXRlciBpbnN0YW50aWF0aW9uCmluaXQucHJvdG90eXBlID0galF1ZXJ5LmZuOwoKLy8gSW5pdGlhbGl6ZSBjZW50cmFsIHJlZmVyZW5jZQpyb290alF1ZXJ5ID0galF1ZXJ5KCBkb2N1bWVudCApOwoKCnZhciBycGFyZW50c3ByZXYgPSAvXig/OnBhcmVudHN8cHJldig/OlVudGlsfEFsbCkpLywKCgkvLyBNZXRob2RzIGd1YXJhbnRlZWQgdG8gcHJvZHVjZSBhIHVuaXF1ZSBzZXQgd2hlbiBzdGFydGluZyBmcm9tIGEgdW5pcXVlIHNldAoJZ3VhcmFudGVlZFVuaXF1ZSA9IHsKCQljaGlsZHJlbjogdHJ1ZSwKCQljb250ZW50czogdHJ1ZSwKCQluZXh0OiB0cnVlLAoJCXByZXY6IHRydWUKCX07CgpqUXVlcnkuZm4uZXh0ZW5kKCB7CgloYXM6IGZ1bmN0aW9uKCB0YXJnZXQgKSB7CgkJdmFyIHRhcmdldHMgPSBqUXVlcnkoIHRhcmdldCwgdGhpcyApLAoJCQlsID0gdGFyZ2V0cy5sZW5ndGg7CgoJCXJldHVybiB0aGlzLmZpbHRlciggZnVuY3Rpb24oKSB7CgkJCXZhciBpID0gMDsKCQkJZm9yICggOyBpIDwgbDsgaSsrICkgewoJCQkJaWYgKCBqUXVlcnkuY29udGFpbnMoIHRoaXMsIHRhcmdldHNbIGkgXSApICkgewoJCQkJCXJldHVybiB0cnVlOwoJCQkJfQoJCQl9CgkJfSApOwoJfSwKCgljbG9zZXN0OiBmdW5jdGlvbiggc2VsZWN0b3JzLCBjb250ZXh0ICkgewoJCXZhciBjdXIsCgkJCWkgPSAwLAoJCQlsID0gdGhpcy5sZW5ndGgsCgkJCW1hdGNoZWQgPSBbXSwKCQkJcG9zID0gcm5lZWRzQ29udGV4dC50ZXN0KCBzZWxlY3RvcnMgKSB8fCB0eXBlb2Ygc2VsZWN0b3JzICE9PSAic3RyaW5nIiA/CgkJCQlqUXVlcnkoIHNlbGVjdG9ycywgY29udGV4dCB8fCB0aGlzLmNvbnRleHQgKSA6CgkJCQkwOwoKCQlmb3IgKCA7IGkgPCBsOyBpKysgKSB7CgkJCWZvciAoIGN1ciA9IHRoaXNbIGkgXTsgY3VyICYmIGN1ciAhPT0gY29udGV4dDsgY3VyID0gY3VyLnBhcmVudE5vZGUgKSB7CgoJCQkJLy8gQWx3YXlzIHNraXAgZG9jdW1lbnQgZnJhZ21lbnRzCgkJCQlpZiAoIGN1ci5ub2RlVHlwZSA8IDExICYmICggcG9zID8KCQkJCQlwb3MuaW5kZXgoIGN1ciApID4gLTEgOgoKCQkJCQkvLyBEb24ndCBwYXNzIG5vbi1lbGVtZW50cyB0byBTaXp6bGUKCQkJCQljdXIubm9kZVR5cGUgPT09IDEgJiYKCQkJCQkJalF1ZXJ5LmZpbmQubWF0Y2hlc1NlbGVjdG9yKCBjdXIsIHNlbGVjdG9ycyApICkgKSB7CgoJCQkJCW1hdGNoZWQucHVzaCggY3VyICk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiB0aGlzLnB1c2hTdGFjayggbWF0Y2hlZC5sZW5ndGggPiAxID8galF1ZXJ5LnVuaXF1ZVNvcnQoIG1hdGNoZWQgKSA6IG1hdGNoZWQgKTsKCX0sCgoJLy8gRGV0ZXJtaW5lIHRoZSBwb3NpdGlvbiBvZiBhbiBlbGVtZW50IHdpdGhpbiB0aGUgc2V0CglpbmRleDogZnVuY3Rpb24oIGVsZW0gKSB7CgoJCS8vIE5vIGFyZ3VtZW50LCByZXR1cm4gaW5kZXggaW4gcGFyZW50CgkJaWYgKCAhZWxlbSApIHsKCQkJcmV0dXJuICggdGhpc1sgMCBdICYmIHRoaXNbIDAgXS5wYXJlbnROb2RlICkgPyB0aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aCA6IC0xOwoJCX0KCgkJLy8gSW5kZXggaW4gc2VsZWN0b3IKCQlpZiAoIHR5cGVvZiBlbGVtID09PSAic3RyaW5nIiApIHsKCQkJcmV0dXJuIGluZGV4T2YuY2FsbCggalF1ZXJ5KCBlbGVtICksIHRoaXNbIDAgXSApOwoJCX0KCgkJLy8gTG9jYXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgZGVzaXJlZCBlbGVtZW50CgkJcmV0dXJuIGluZGV4T2YuY2FsbCggdGhpcywKCgkJCS8vIElmIGl0IHJlY2VpdmVzIGEgalF1ZXJ5IG9iamVjdCwgdGhlIGZpcnN0IGVsZW1lbnQgaXMgdXNlZAoJCQllbGVtLmpxdWVyeSA/IGVsZW1bIDAgXSA6IGVsZW0KCQkpOwoJfSwKCglhZGQ6IGZ1bmN0aW9uKCBzZWxlY3RvciwgY29udGV4dCApIHsKCQlyZXR1cm4gdGhpcy5wdXNoU3RhY2soCgkJCWpRdWVyeS51bmlxdWVTb3J0KAoJCQkJalF1ZXJ5Lm1lcmdlKCB0aGlzLmdldCgpLCBqUXVlcnkoIHNlbGVjdG9yLCBjb250ZXh0ICkgKQoJCQkpCgkJKTsKCX0sCgoJYWRkQmFjazogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCXJldHVybiB0aGlzLmFkZCggc2VsZWN0b3IgPT0gbnVsbCA/CgkJCXRoaXMucHJldk9iamVjdCA6IHRoaXMucHJldk9iamVjdC5maWx0ZXIoIHNlbGVjdG9yICkKCQkpOwoJfQp9ICk7CgpmdW5jdGlvbiBzaWJsaW5nKCBjdXIsIGRpciApIHsKCXdoaWxlICggKCBjdXIgPSBjdXJbIGRpciBdICkgJiYgY3VyLm5vZGVUeXBlICE9PSAxICkge30KCXJldHVybiBjdXI7Cn0KCmpRdWVyeS5lYWNoKCB7CglwYXJlbnQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCXZhciBwYXJlbnQgPSBlbGVtLnBhcmVudE5vZGU7CgkJcmV0dXJuIHBhcmVudCAmJiBwYXJlbnQubm9kZVR5cGUgIT09IDExID8gcGFyZW50IDogbnVsbDsKCX0sCglwYXJlbnRzOiBmdW5jdGlvbiggZWxlbSApIHsKCQlyZXR1cm4gZGlyKCBlbGVtLCAicGFyZW50Tm9kZSIgKTsKCX0sCglwYXJlbnRzVW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1bnRpbCApIHsKCQlyZXR1cm4gZGlyKCBlbGVtLCAicGFyZW50Tm9kZSIsIHVudGlsICk7Cgl9LAoJbmV4dDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJcmV0dXJuIHNpYmxpbmcoIGVsZW0sICJuZXh0U2libGluZyIgKTsKCX0sCglwcmV2OiBmdW5jdGlvbiggZWxlbSApIHsKCQlyZXR1cm4gc2libGluZyggZWxlbSwgInByZXZpb3VzU2libGluZyIgKTsKCX0sCgluZXh0QWxsOiBmdW5jdGlvbiggZWxlbSApIHsKCQlyZXR1cm4gZGlyKCBlbGVtLCAibmV4dFNpYmxpbmciICk7Cgl9LAoJcHJldkFsbDogZnVuY3Rpb24oIGVsZW0gKSB7CgkJcmV0dXJuIGRpciggZWxlbSwgInByZXZpb3VzU2libGluZyIgKTsKCX0sCgluZXh0VW50aWw6IGZ1bmN0aW9uKCBlbGVtLCBpLCB1bnRpbCApIHsKCQlyZXR1cm4gZGlyKCBlbGVtLCAibmV4dFNpYmxpbmciLCB1bnRpbCApOwoJfSwKCXByZXZVbnRpbDogZnVuY3Rpb24oIGVsZW0sIGksIHVudGlsICkgewoJCXJldHVybiBkaXIoIGVsZW0sICJwcmV2aW91c1NpYmxpbmciLCB1bnRpbCApOwoJfSwKCXNpYmxpbmdzOiBmdW5jdGlvbiggZWxlbSApIHsKCQlyZXR1cm4gc2libGluZ3MoICggZWxlbS5wYXJlbnROb2RlIHx8IHt9ICkuZmlyc3RDaGlsZCwgZWxlbSApOwoJfSwKCWNoaWxkcmVuOiBmdW5jdGlvbiggZWxlbSApIHsKCQlyZXR1cm4gc2libGluZ3MoIGVsZW0uZmlyc3RDaGlsZCApOwoJfSwKCWNvbnRlbnRzOiBmdW5jdGlvbiggZWxlbSApIHsKCQlyZXR1cm4gZWxlbS5jb250ZW50RG9jdW1lbnQgfHwgalF1ZXJ5Lm1lcmdlKCBbXSwgZWxlbS5jaGlsZE5vZGVzICk7Cgl9Cn0sIGZ1bmN0aW9uKCBuYW1lLCBmbiApIHsKCWpRdWVyeS5mblsgbmFtZSBdID0gZnVuY3Rpb24oIHVudGlsLCBzZWxlY3RvciApIHsKCQl2YXIgbWF0Y2hlZCA9IGpRdWVyeS5tYXAoIHRoaXMsIGZuLCB1bnRpbCApOwoKCQlpZiAoIG5hbWUuc2xpY2UoIC01ICkgIT09ICJVbnRpbCIgKSB7CgkJCXNlbGVjdG9yID0gdW50aWw7CgkJfQoKCQlpZiAoIHNlbGVjdG9yICYmIHR5cGVvZiBzZWxlY3RvciA9PT0gInN0cmluZyIgKSB7CgkJCW1hdGNoZWQgPSBqUXVlcnkuZmlsdGVyKCBzZWxlY3RvciwgbWF0Y2hlZCApOwoJCX0KCgkJaWYgKCB0aGlzLmxlbmd0aCA+IDEgKSB7CgoJCQkvLyBSZW1vdmUgZHVwbGljYXRlcwoJCQlpZiAoICFndWFyYW50ZWVkVW5pcXVlWyBuYW1lIF0gKSB7CgkJCQlqUXVlcnkudW5pcXVlU29ydCggbWF0Y2hlZCApOwoJCQl9CgoJCQkvLyBSZXZlcnNlIG9yZGVyIGZvciBwYXJlbnRzKiBhbmQgcHJldi1kZXJpdmF0aXZlcwoJCQlpZiAoIHJwYXJlbnRzcHJldi50ZXN0KCBuYW1lICkgKSB7CgkJCQltYXRjaGVkLnJldmVyc2UoKTsKCQkJfQoJCX0KCgkJcmV0dXJuIHRoaXMucHVzaFN0YWNrKCBtYXRjaGVkICk7Cgl9Owp9ICk7CnZhciBybm90d2hpdGUgPSAoIC9cUysvZyApOwoKCgovLyBDb252ZXJ0IFN0cmluZy1mb3JtYXR0ZWQgb3B0aW9ucyBpbnRvIE9iamVjdC1mb3JtYXR0ZWQgb25lcwpmdW5jdGlvbiBjcmVhdGVPcHRpb25zKCBvcHRpb25zICkgewoJdmFyIG9iamVjdCA9IHt9OwoJalF1ZXJ5LmVhY2goIG9wdGlvbnMubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdLCBmdW5jdGlvbiggXywgZmxhZyApIHsKCQlvYmplY3RbIGZsYWcgXSA9IHRydWU7Cgl9ICk7CglyZXR1cm4gb2JqZWN0Owp9CgovKgogKiBDcmVhdGUgYSBjYWxsYmFjayBsaXN0IHVzaW5nIHRoZSBmb2xsb3dpbmcgcGFyYW1ldGVyczoKICoKICoJb3B0aW9uczogYW4gb3B0aW9uYWwgbGlzdCBvZiBzcGFjZS1zZXBhcmF0ZWQgb3B0aW9ucyB0aGF0IHdpbGwgY2hhbmdlIGhvdwogKgkJCXRoZSBjYWxsYmFjayBsaXN0IGJlaGF2ZXMgb3IgYSBtb3JlIHRyYWRpdGlvbmFsIG9wdGlvbiBvYmplY3QKICoKICogQnkgZGVmYXVsdCBhIGNhbGxiYWNrIGxpc3Qgd2lsbCBhY3QgbGlrZSBhbiBldmVudCBjYWxsYmFjayBsaXN0IGFuZCBjYW4gYmUKICogImZpcmVkIiBtdWx0aXBsZSB0aW1lcy4KICoKICogUG9zc2libGUgb3B0aW9uczoKICoKICoJb25jZToJCQl3aWxsIGVuc3VyZSB0aGUgY2FsbGJhY2sgbGlzdCBjYW4gb25seSBiZSBmaXJlZCBvbmNlIChsaWtlIGEgRGVmZXJyZWQpCiAqCiAqCW1lbW9yeToJCQl3aWxsIGtlZXAgdHJhY2sgb2YgcHJldmlvdXMgdmFsdWVzIGFuZCB3aWxsIGNhbGwgYW55IGNhbGxiYWNrIGFkZGVkCiAqCQkJCQlhZnRlciB0aGUgbGlzdCBoYXMgYmVlbiBmaXJlZCByaWdodCBhd2F5IHdpdGggdGhlIGxhdGVzdCAibWVtb3JpemVkIgogKgkJCQkJdmFsdWVzIChsaWtlIGEgRGVmZXJyZWQpCiAqCiAqCXVuaXF1ZToJCQl3aWxsIGVuc3VyZSBhIGNhbGxiYWNrIGNhbiBvbmx5IGJlIGFkZGVkIG9uY2UgKG5vIGR1cGxpY2F0ZSBpbiB0aGUgbGlzdCkKICoKICoJc3RvcE9uRmFsc2U6CWludGVycnVwdCBjYWxsaW5ncyB3aGVuIGEgY2FsbGJhY2sgcmV0dXJucyBmYWxzZQogKgogKi8KalF1ZXJ5LkNhbGxiYWNrcyA9IGZ1bmN0aW9uKCBvcHRpb25zICkgewoKCS8vIENvbnZlcnQgb3B0aW9ucyBmcm9tIFN0cmluZy1mb3JtYXR0ZWQgdG8gT2JqZWN0LWZvcm1hdHRlZCBpZiBuZWVkZWQKCS8vICh3ZSBjaGVjayBpbiBjYWNoZSBmaXJzdCkKCW9wdGlvbnMgPSB0eXBlb2Ygb3B0aW9ucyA9PT0gInN0cmluZyIgPwoJCWNyZWF0ZU9wdGlvbnMoIG9wdGlvbnMgKSA6CgkJalF1ZXJ5LmV4dGVuZCgge30sIG9wdGlvbnMgKTsKCgl2YXIgLy8gRmxhZyB0byBrbm93IGlmIGxpc3QgaXMgY3VycmVudGx5IGZpcmluZwoJCWZpcmluZywKCgkJLy8gTGFzdCBmaXJlIHZhbHVlIGZvciBub24tZm9yZ2V0dGFibGUgbGlzdHMKCQltZW1vcnksCgoJCS8vIEZsYWcgdG8ga25vdyBpZiBsaXN0IHdhcyBhbHJlYWR5IGZpcmVkCgkJZmlyZWQsCgoJCS8vIEZsYWcgdG8gcHJldmVudCBmaXJpbmcKCQlsb2NrZWQsCgoJCS8vIEFjdHVhbCBjYWxsYmFjayBsaXN0CgkJbGlzdCA9IFtdLAoKCQkvLyBRdWV1ZSBvZiBleGVjdXRpb24gZGF0YSBmb3IgcmVwZWF0YWJsZSBsaXN0cwoJCXF1ZXVlID0gW10sCgoJCS8vIEluZGV4IG9mIGN1cnJlbnRseSBmaXJpbmcgY2FsbGJhY2sgKG1vZGlmaWVkIGJ5IGFkZC9yZW1vdmUgYXMgbmVlZGVkKQoJCWZpcmluZ0luZGV4ID0gLTEsCgoJCS8vIEZpcmUgY2FsbGJhY2tzCgkJZmlyZSA9IGZ1bmN0aW9uKCkgewoKCQkJLy8gRW5mb3JjZSBzaW5nbGUtZmlyaW5nCgkJCWxvY2tlZCA9IG9wdGlvbnMub25jZTsKCgkJCS8vIEV4ZWN1dGUgY2FsbGJhY2tzIGZvciBhbGwgcGVuZGluZyBleGVjdXRpb25zLAoJCQkvLyByZXNwZWN0aW5nIGZpcmluZ0luZGV4IG92ZXJyaWRlcyBhbmQgcnVudGltZSBjaGFuZ2VzCgkJCWZpcmVkID0gZmlyaW5nID0gdHJ1ZTsKCQkJZm9yICggOyBxdWV1ZS5sZW5ndGg7IGZpcmluZ0luZGV4ID0gLTEgKSB7CgkJCQltZW1vcnkgPSBxdWV1ZS5zaGlmdCgpOwoJCQkJd2hpbGUgKCArK2ZpcmluZ0luZGV4IDwgbGlzdC5sZW5ndGggKSB7CgoJCQkJCS8vIFJ1biBjYWxsYmFjayBhbmQgY2hlY2sgZm9yIGVhcmx5IHRlcm1pbmF0aW9uCgkJCQkJaWYgKCBsaXN0WyBmaXJpbmdJbmRleCBdLmFwcGx5KCBtZW1vcnlbIDAgXSwgbWVtb3J5WyAxIF0gKSA9PT0gZmFsc2UgJiYKCQkJCQkJb3B0aW9ucy5zdG9wT25GYWxzZSApIHsKCgkJCQkJCS8vIEp1bXAgdG8gZW5kIGFuZCBmb3JnZXQgdGhlIGRhdGEgc28gLmFkZCBkb2Vzbid0IHJlLWZpcmUKCQkJCQkJZmlyaW5nSW5kZXggPSBsaXN0Lmxlbmd0aDsKCQkJCQkJbWVtb3J5ID0gZmFsc2U7CgkJCQkJfQoJCQkJfQoJCQl9CgoJCQkvLyBGb3JnZXQgdGhlIGRhdGEgaWYgd2UncmUgZG9uZSB3aXRoIGl0CgkJCWlmICggIW9wdGlvbnMubWVtb3J5ICkgewoJCQkJbWVtb3J5ID0gZmFsc2U7CgkJCX0KCgkJCWZpcmluZyA9IGZhbHNlOwoKCQkJLy8gQ2xlYW4gdXAgaWYgd2UncmUgZG9uZSBmaXJpbmcgZm9yIGdvb2QKCQkJaWYgKCBsb2NrZWQgKSB7CgoJCQkJLy8gS2VlcCBhbiBlbXB0eSBsaXN0IGlmIHdlIGhhdmUgZGF0YSBmb3IgZnV0dXJlIGFkZCBjYWxscwoJCQkJaWYgKCBtZW1vcnkgKSB7CgkJCQkJbGlzdCA9IFtdOwoKCQkJCS8vIE90aGVyd2lzZSwgdGhpcyBvYmplY3QgaXMgc3BlbnQKCQkJCX0gZWxzZSB7CgkJCQkJbGlzdCA9ICIiOwoJCQkJfQoJCQl9CgkJfSwKCgkJLy8gQWN0dWFsIENhbGxiYWNrcyBvYmplY3QKCQlzZWxmID0gewoKCQkJLy8gQWRkIGEgY2FsbGJhY2sgb3IgYSBjb2xsZWN0aW9uIG9mIGNhbGxiYWNrcyB0byB0aGUgbGlzdAoJCQlhZGQ6IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCBsaXN0ICkgewoKCQkJCQkvLyBJZiB3ZSBoYXZlIG1lbW9yeSBmcm9tIGEgcGFzdCBydW4sIHdlIHNob3VsZCBmaXJlIGFmdGVyIGFkZGluZwoJCQkJCWlmICggbWVtb3J5ICYmICFmaXJpbmcgKSB7CgkJCQkJCWZpcmluZ0luZGV4ID0gbGlzdC5sZW5ndGggLSAxOwoJCQkJCQlxdWV1ZS5wdXNoKCBtZW1vcnkgKTsKCQkJCQl9CgoJCQkJCSggZnVuY3Rpb24gYWRkKCBhcmdzICkgewoJCQkJCQlqUXVlcnkuZWFjaCggYXJncywgZnVuY3Rpb24oIF8sIGFyZyApIHsKCQkJCQkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGFyZyApICkgewoJCQkJCQkJCWlmICggIW9wdGlvbnMudW5pcXVlIHx8ICFzZWxmLmhhcyggYXJnICkgKSB7CgkJCQkJCQkJCWxpc3QucHVzaCggYXJnICk7CgkJCQkJCQkJfQoJCQkJCQkJfSBlbHNlIGlmICggYXJnICYmIGFyZy5sZW5ndGggJiYgalF1ZXJ5LnR5cGUoIGFyZyApICE9PSAic3RyaW5nIiApIHsKCgkJCQkJCQkJLy8gSW5zcGVjdCByZWN1cnNpdmVseQoJCQkJCQkJCWFkZCggYXJnICk7CgkJCQkJCQl9CgkJCQkJCX0gKTsKCQkJCQl9ICkoIGFyZ3VtZW50cyApOwoKCQkJCQlpZiAoIG1lbW9yeSAmJiAhZmlyaW5nICkgewoJCQkJCQlmaXJlKCk7CgkJCQkJfQoJCQkJfQoJCQkJcmV0dXJuIHRoaXM7CgkJCX0sCgoJCQkvLyBSZW1vdmUgYSBjYWxsYmFjayBmcm9tIHRoZSBsaXN0CgkJCXJlbW92ZTogZnVuY3Rpb24oKSB7CgkJCQlqUXVlcnkuZWFjaCggYXJndW1lbnRzLCBmdW5jdGlvbiggXywgYXJnICkgewoJCQkJCXZhciBpbmRleDsKCQkJCQl3aGlsZSAoICggaW5kZXggPSBqUXVlcnkuaW5BcnJheSggYXJnLCBsaXN0LCBpbmRleCApICkgPiAtMSApIHsKCQkJCQkJbGlzdC5zcGxpY2UoIGluZGV4LCAxICk7CgoJCQkJCQkvLyBIYW5kbGUgZmlyaW5nIGluZGV4ZXMKCQkJCQkJaWYgKCBpbmRleCA8PSBmaXJpbmdJbmRleCApIHsKCQkJCQkJCWZpcmluZ0luZGV4LS07CgkJCQkJCX0KCQkJCQl9CgkJCQl9ICk7CgkJCQlyZXR1cm4gdGhpczsKCQkJfSwKCgkJCS8vIENoZWNrIGlmIGEgZ2l2ZW4gY2FsbGJhY2sgaXMgaW4gdGhlIGxpc3QuCgkJCS8vIElmIG5vIGFyZ3VtZW50IGlzIGdpdmVuLCByZXR1cm4gd2hldGhlciBvciBub3QgbGlzdCBoYXMgY2FsbGJhY2tzIGF0dGFjaGVkLgoJCQloYXM6IGZ1bmN0aW9uKCBmbiApIHsKCQkJCXJldHVybiBmbiA/CgkJCQkJalF1ZXJ5LmluQXJyYXkoIGZuLCBsaXN0ICkgPiAtMSA6CgkJCQkJbGlzdC5sZW5ndGggPiAwOwoJCQl9LAoKCQkJLy8gUmVtb3ZlIGFsbCBjYWxsYmFja3MgZnJvbSB0aGUgbGlzdAoJCQllbXB0eTogZnVuY3Rpb24oKSB7CgkJCQlpZiAoIGxpc3QgKSB7CgkJCQkJbGlzdCA9IFtdOwoJCQkJfQoJCQkJcmV0dXJuIHRoaXM7CgkJCX0sCgoJCQkvLyBEaXNhYmxlIC5maXJlIGFuZCAuYWRkCgkJCS8vIEFib3J0IGFueSBjdXJyZW50L3BlbmRpbmcgZXhlY3V0aW9ucwoJCQkvLyBDbGVhciBhbGwgY2FsbGJhY2tzIGFuZCB2YWx1ZXMKCQkJZGlzYWJsZTogZnVuY3Rpb24oKSB7CgkJCQlsb2NrZWQgPSBxdWV1ZSA9IFtdOwoJCQkJbGlzdCA9IG1lbW9yeSA9ICIiOwoJCQkJcmV0dXJuIHRoaXM7CgkJCX0sCgkJCWRpc2FibGVkOiBmdW5jdGlvbigpIHsKCQkJCXJldHVybiAhbGlzdDsKCQkJfSwKCgkJCS8vIERpc2FibGUgLmZpcmUKCQkJLy8gQWxzbyBkaXNhYmxlIC5hZGQgdW5sZXNzIHdlIGhhdmUgbWVtb3J5IChzaW5jZSBpdCB3b3VsZCBoYXZlIG5vIGVmZmVjdCkKCQkJLy8gQWJvcnQgYW55IHBlbmRpbmcgZXhlY3V0aW9ucwoJCQlsb2NrOiBmdW5jdGlvbigpIHsKCQkJCWxvY2tlZCA9IHF1ZXVlID0gW107CgkJCQlpZiAoICFtZW1vcnkgKSB7CgkJCQkJbGlzdCA9IG1lbW9yeSA9ICIiOwoJCQkJfQoJCQkJcmV0dXJuIHRoaXM7CgkJCX0sCgkJCWxvY2tlZDogZnVuY3Rpb24oKSB7CgkJCQlyZXR1cm4gISFsb2NrZWQ7CgkJCX0sCgoJCQkvLyBDYWxsIGFsbCBjYWxsYmFja3Mgd2l0aCB0aGUgZ2l2ZW4gY29udGV4dCBhbmQgYXJndW1lbnRzCgkJCWZpcmVXaXRoOiBmdW5jdGlvbiggY29udGV4dCwgYXJncyApIHsKCQkJCWlmICggIWxvY2tlZCApIHsKCQkJCQlhcmdzID0gYXJncyB8fCBbXTsKCQkJCQlhcmdzID0gWyBjb250ZXh0LCBhcmdzLnNsaWNlID8gYXJncy5zbGljZSgpIDogYXJncyBdOwoJCQkJCXF1ZXVlLnB1c2goIGFyZ3MgKTsKCQkJCQlpZiAoICFmaXJpbmcgKSB7CgkJCQkJCWZpcmUoKTsKCQkJCQl9CgkJCQl9CgkJCQlyZXR1cm4gdGhpczsKCQkJfSwKCgkJCS8vIENhbGwgYWxsIHRoZSBjYWxsYmFja3Mgd2l0aCB0aGUgZ2l2ZW4gYXJndW1lbnRzCgkJCWZpcmU6IGZ1bmN0aW9uKCkgewoJCQkJc2VsZi5maXJlV2l0aCggdGhpcywgYXJndW1lbnRzICk7CgkJCQlyZXR1cm4gdGhpczsKCQkJfSwKCgkJCS8vIFRvIGtub3cgaWYgdGhlIGNhbGxiYWNrcyBoYXZlIGFscmVhZHkgYmVlbiBjYWxsZWQgYXQgbGVhc3Qgb25jZQoJCQlmaXJlZDogZnVuY3Rpb24oKSB7CgkJCQlyZXR1cm4gISFmaXJlZDsKCQkJfQoJCX07CgoJcmV0dXJuIHNlbGY7Cn07CgoKalF1ZXJ5LmV4dGVuZCggewoKCURlZmVycmVkOiBmdW5jdGlvbiggZnVuYyApIHsKCQl2YXIgdHVwbGVzID0gWwoKCQkJCS8vIGFjdGlvbiwgYWRkIGxpc3RlbmVyLCBsaXN0ZW5lciBsaXN0LCBmaW5hbCBzdGF0ZQoJCQkJWyAicmVzb2x2ZSIsICJkb25lIiwgalF1ZXJ5LkNhbGxiYWNrcyggIm9uY2UgbWVtb3J5IiApLCAicmVzb2x2ZWQiIF0sCgkJCQlbICJyZWplY3QiLCAiZmFpbCIsIGpRdWVyeS5DYWxsYmFja3MoICJvbmNlIG1lbW9yeSIgKSwgInJlamVjdGVkIiBdLAoJCQkJWyAibm90aWZ5IiwgInByb2dyZXNzIiwgalF1ZXJ5LkNhbGxiYWNrcyggIm1lbW9yeSIgKSBdCgkJCV0sCgkJCXN0YXRlID0gInBlbmRpbmciLAoJCQlwcm9taXNlID0gewoJCQkJc3RhdGU6IGZ1bmN0aW9uKCkgewoJCQkJCXJldHVybiBzdGF0ZTsKCQkJCX0sCgkJCQlhbHdheXM6IGZ1bmN0aW9uKCkgewoJCQkJCWRlZmVycmVkLmRvbmUoIGFyZ3VtZW50cyApLmZhaWwoIGFyZ3VtZW50cyApOwoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCQkJCXRoZW46IGZ1bmN0aW9uKCAvKiBmbkRvbmUsIGZuRmFpbCwgZm5Qcm9ncmVzcyAqLyApIHsKCQkJCQl2YXIgZm5zID0gYXJndW1lbnRzOwoJCQkJCXJldHVybiBqUXVlcnkuRGVmZXJyZWQoIGZ1bmN0aW9uKCBuZXdEZWZlciApIHsKCQkJCQkJalF1ZXJ5LmVhY2goIHR1cGxlcywgZnVuY3Rpb24oIGksIHR1cGxlICkgewoJCQkJCQkJdmFyIGZuID0galF1ZXJ5LmlzRnVuY3Rpb24oIGZuc1sgaSBdICkgJiYgZm5zWyBpIF07CgoJCQkJCQkJLy8gZGVmZXJyZWRbIGRvbmUgfCBmYWlsIHwgcHJvZ3Jlc3MgXSBmb3IgZm9yd2FyZGluZyBhY3Rpb25zIHRvIG5ld0RlZmVyCgkJCQkJCQlkZWZlcnJlZFsgdHVwbGVbIDEgXSBdKCBmdW5jdGlvbigpIHsKCQkJCQkJCQl2YXIgcmV0dXJuZWQgPSBmbiAmJiBmbi5hcHBseSggdGhpcywgYXJndW1lbnRzICk7CgkJCQkJCQkJaWYgKCByZXR1cm5lZCAmJiBqUXVlcnkuaXNGdW5jdGlvbiggcmV0dXJuZWQucHJvbWlzZSApICkgewoJCQkJCQkJCQlyZXR1cm5lZC5wcm9taXNlKCkKCQkJCQkJCQkJCS5wcm9ncmVzcyggbmV3RGVmZXIubm90aWZ5ICkKCQkJCQkJCQkJCS5kb25lKCBuZXdEZWZlci5yZXNvbHZlICkKCQkJCQkJCQkJCS5mYWlsKCBuZXdEZWZlci5yZWplY3QgKTsKCQkJCQkJCQl9IGVsc2UgewoJCQkJCQkJCQluZXdEZWZlclsgdHVwbGVbIDAgXSArICJXaXRoIiBdKAoJCQkJCQkJCQkJdGhpcyA9PT0gcHJvbWlzZSA/IG5ld0RlZmVyLnByb21pc2UoKSA6IHRoaXMsCgkJCQkJCQkJCQlmbiA/IFsgcmV0dXJuZWQgXSA6IGFyZ3VtZW50cwoJCQkJCQkJCQkpOwoJCQkJCQkJCX0KCQkJCQkJCX0gKTsKCQkJCQkJfSApOwoJCQkJCQlmbnMgPSBudWxsOwoJCQkJCX0gKS5wcm9taXNlKCk7CgkJCQl9LAoKCQkJCS8vIEdldCBhIHByb21pc2UgZm9yIHRoaXMgZGVmZXJyZWQKCQkJCS8vIElmIG9iaiBpcyBwcm92aWRlZCwgdGhlIHByb21pc2UgYXNwZWN0IGlzIGFkZGVkIHRvIHRoZSBvYmplY3QKCQkJCXByb21pc2U6IGZ1bmN0aW9uKCBvYmogKSB7CgkJCQkJcmV0dXJuIG9iaiAhPSBudWxsID8galF1ZXJ5LmV4dGVuZCggb2JqLCBwcm9taXNlICkgOiBwcm9taXNlOwoJCQkJfQoJCQl9LAoJCQlkZWZlcnJlZCA9IHt9OwoKCQkvLyBLZWVwIHBpcGUgZm9yIGJhY2stY29tcGF0CgkJcHJvbWlzZS5waXBlID0gcHJvbWlzZS50aGVuOwoKCQkvLyBBZGQgbGlzdC1zcGVjaWZpYyBtZXRob2RzCgkJalF1ZXJ5LmVhY2goIHR1cGxlcywgZnVuY3Rpb24oIGksIHR1cGxlICkgewoJCQl2YXIgbGlzdCA9IHR1cGxlWyAyIF0sCgkJCQlzdGF0ZVN0cmluZyA9IHR1cGxlWyAzIF07CgoJCQkvLyBwcm9taXNlWyBkb25lIHwgZmFpbCB8IHByb2dyZXNzIF0gPSBsaXN0LmFkZAoJCQlwcm9taXNlWyB0dXBsZVsgMSBdIF0gPSBsaXN0LmFkZDsKCgkJCS8vIEhhbmRsZSBzdGF0ZQoJCQlpZiAoIHN0YXRlU3RyaW5nICkgewoJCQkJbGlzdC5hZGQoIGZ1bmN0aW9uKCkgewoKCQkJCQkvLyBzdGF0ZSA9IFsgcmVzb2x2ZWQgfCByZWplY3RlZCBdCgkJCQkJc3RhdGUgPSBzdGF0ZVN0cmluZzsKCgkJCQkvLyBbIHJlamVjdF9saXN0IHwgcmVzb2x2ZV9saXN0IF0uZGlzYWJsZTsgcHJvZ3Jlc3NfbGlzdC5sb2NrCgkJCQl9LCB0dXBsZXNbIGkgXiAxIF1bIDIgXS5kaXNhYmxlLCB0dXBsZXNbIDIgXVsgMiBdLmxvY2sgKTsKCQkJfQoKCQkJLy8gZGVmZXJyZWRbIHJlc29sdmUgfCByZWplY3QgfCBub3RpZnkgXQoJCQlkZWZlcnJlZFsgdHVwbGVbIDAgXSBdID0gZnVuY3Rpb24oKSB7CgkJCQlkZWZlcnJlZFsgdHVwbGVbIDAgXSArICJXaXRoIiBdKCB0aGlzID09PSBkZWZlcnJlZCA/IHByb21pc2UgOiB0aGlzLCBhcmd1bWVudHMgKTsKCQkJCXJldHVybiB0aGlzOwoJCQl9OwoJCQlkZWZlcnJlZFsgdHVwbGVbIDAgXSArICJXaXRoIiBdID0gbGlzdC5maXJlV2l0aDsKCQl9ICk7CgoJCS8vIE1ha2UgdGhlIGRlZmVycmVkIGEgcHJvbWlzZQoJCXByb21pc2UucHJvbWlzZSggZGVmZXJyZWQgKTsKCgkJLy8gQ2FsbCBnaXZlbiBmdW5jIGlmIGFueQoJCWlmICggZnVuYyApIHsKCQkJZnVuYy5jYWxsKCBkZWZlcnJlZCwgZGVmZXJyZWQgKTsKCQl9CgoJCS8vIEFsbCBkb25lIQoJCXJldHVybiBkZWZlcnJlZDsKCX0sCgoJLy8gRGVmZXJyZWQgaGVscGVyCgl3aGVuOiBmdW5jdGlvbiggc3Vib3JkaW5hdGUgLyogLCAuLi4sIHN1Ym9yZGluYXRlTiAqLyApIHsKCQl2YXIgaSA9IDAsCgkJCXJlc29sdmVWYWx1ZXMgPSBzbGljZS5jYWxsKCBhcmd1bWVudHMgKSwKCQkJbGVuZ3RoID0gcmVzb2x2ZVZhbHVlcy5sZW5ndGgsCgoJCQkvLyB0aGUgY291bnQgb2YgdW5jb21wbGV0ZWQgc3Vib3JkaW5hdGVzCgkJCXJlbWFpbmluZyA9IGxlbmd0aCAhPT0gMSB8fAoJCQkJKCBzdWJvcmRpbmF0ZSAmJiBqUXVlcnkuaXNGdW5jdGlvbiggc3Vib3JkaW5hdGUucHJvbWlzZSApICkgPyBsZW5ndGggOiAwLAoKCQkJLy8gdGhlIG1hc3RlciBEZWZlcnJlZC4KCQkJLy8gSWYgcmVzb2x2ZVZhbHVlcyBjb25zaXN0IG9mIG9ubHkgYSBzaW5nbGUgRGVmZXJyZWQsIGp1c3QgdXNlIHRoYXQuCgkJCWRlZmVycmVkID0gcmVtYWluaW5nID09PSAxID8gc3Vib3JkaW5hdGUgOiBqUXVlcnkuRGVmZXJyZWQoKSwKCgkJCS8vIFVwZGF0ZSBmdW5jdGlvbiBmb3IgYm90aCByZXNvbHZlIGFuZCBwcm9ncmVzcyB2YWx1ZXMKCQkJdXBkYXRlRnVuYyA9IGZ1bmN0aW9uKCBpLCBjb250ZXh0cywgdmFsdWVzICkgewoJCQkJcmV0dXJuIGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJCQljb250ZXh0c1sgaSBdID0gdGhpczsKCQkJCQl2YWx1ZXNbIGkgXSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gc2xpY2UuY2FsbCggYXJndW1lbnRzICkgOiB2YWx1ZTsKCQkJCQlpZiAoIHZhbHVlcyA9PT0gcHJvZ3Jlc3NWYWx1ZXMgKSB7CgkJCQkJCWRlZmVycmVkLm5vdGlmeVdpdGgoIGNvbnRleHRzLCB2YWx1ZXMgKTsKCQkJCQl9IGVsc2UgaWYgKCAhKCAtLXJlbWFpbmluZyApICkgewoJCQkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggY29udGV4dHMsIHZhbHVlcyApOwoJCQkJCX0KCQkJCX07CgkJCX0sCgoJCQlwcm9ncmVzc1ZhbHVlcywgcHJvZ3Jlc3NDb250ZXh0cywgcmVzb2x2ZUNvbnRleHRzOwoKCQkvLyBBZGQgbGlzdGVuZXJzIHRvIERlZmVycmVkIHN1Ym9yZGluYXRlczsgdHJlYXQgb3RoZXJzIGFzIHJlc29sdmVkCgkJaWYgKCBsZW5ndGggPiAxICkgewoJCQlwcm9ncmVzc1ZhbHVlcyA9IG5ldyBBcnJheSggbGVuZ3RoICk7CgkJCXByb2dyZXNzQ29udGV4dHMgPSBuZXcgQXJyYXkoIGxlbmd0aCApOwoJCQlyZXNvbHZlQ29udGV4dHMgPSBuZXcgQXJyYXkoIGxlbmd0aCApOwoJCQlmb3IgKCA7IGkgPCBsZW5ndGg7IGkrKyApIHsKCQkJCWlmICggcmVzb2x2ZVZhbHVlc1sgaSBdICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCByZXNvbHZlVmFsdWVzWyBpIF0ucHJvbWlzZSApICkgewoJCQkJCXJlc29sdmVWYWx1ZXNbIGkgXS5wcm9taXNlKCkKCQkJCQkJLnByb2dyZXNzKCB1cGRhdGVGdW5jKCBpLCBwcm9ncmVzc0NvbnRleHRzLCBwcm9ncmVzc1ZhbHVlcyApICkKCQkJCQkJLmRvbmUoIHVwZGF0ZUZ1bmMoIGksIHJlc29sdmVDb250ZXh0cywgcmVzb2x2ZVZhbHVlcyApICkKCQkJCQkJLmZhaWwoIGRlZmVycmVkLnJlamVjdCApOwoJCQkJfSBlbHNlIHsKCQkJCQktLXJlbWFpbmluZzsKCQkJCX0KCQkJfQoJCX0KCgkJLy8gSWYgd2UncmUgbm90IHdhaXRpbmcgb24gYW55dGhpbmcsIHJlc29sdmUgdGhlIG1hc3RlcgoJCWlmICggIXJlbWFpbmluZyApIHsKCQkJZGVmZXJyZWQucmVzb2x2ZVdpdGgoIHJlc29sdmVDb250ZXh0cywgcmVzb2x2ZVZhbHVlcyApOwoJCX0KCgkJcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTsKCX0KfSApOwoKCi8vIFRoZSBkZWZlcnJlZCB1c2VkIG9uIERPTSByZWFkeQp2YXIgcmVhZHlMaXN0OwoKalF1ZXJ5LmZuLnJlYWR5ID0gZnVuY3Rpb24oIGZuICkgewoKCS8vIEFkZCB0aGUgY2FsbGJhY2sKCWpRdWVyeS5yZWFkeS5wcm9taXNlKCkuZG9uZSggZm4gKTsKCglyZXR1cm4gdGhpczsKfTsKCmpRdWVyeS5leHRlbmQoIHsKCgkvLyBJcyB0aGUgRE9NIHJlYWR5IHRvIGJlIHVzZWQ/IFNldCB0byB0cnVlIG9uY2UgaXQgb2NjdXJzLgoJaXNSZWFkeTogZmFsc2UsCgoJLy8gQSBjb3VudGVyIHRvIHRyYWNrIGhvdyBtYW55IGl0ZW1zIHRvIHdhaXQgZm9yIGJlZm9yZQoJLy8gdGhlIHJlYWR5IGV2ZW50IGZpcmVzLiBTZWUgIzY3ODEKCXJlYWR5V2FpdDogMSwKCgkvLyBIb2xkIChvciByZWxlYXNlKSB0aGUgcmVhZHkgZXZlbnQKCWhvbGRSZWFkeTogZnVuY3Rpb24oIGhvbGQgKSB7CgkJaWYgKCBob2xkICkgewoJCQlqUXVlcnkucmVhZHlXYWl0Kys7CgkJfSBlbHNlIHsKCQkJalF1ZXJ5LnJlYWR5KCB0cnVlICk7CgkJfQoJfSwKCgkvLyBIYW5kbGUgd2hlbiB0aGUgRE9NIGlzIHJlYWR5CglyZWFkeTogZnVuY3Rpb24oIHdhaXQgKSB7CgoJCS8vIEFib3J0IGlmIHRoZXJlIGFyZSBwZW5kaW5nIGhvbGRzIG9yIHdlJ3JlIGFscmVhZHkgcmVhZHkKCQlpZiAoIHdhaXQgPT09IHRydWUgPyAtLWpRdWVyeS5yZWFkeVdhaXQgOiBqUXVlcnkuaXNSZWFkeSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJLy8gUmVtZW1iZXIgdGhhdCB0aGUgRE9NIGlzIHJlYWR5CgkJalF1ZXJ5LmlzUmVhZHkgPSB0cnVlOwoKCQkvLyBJZiBhIG5vcm1hbCBET00gUmVhZHkgZXZlbnQgZmlyZWQsIGRlY3JlbWVudCwgYW5kIHdhaXQgaWYgbmVlZCBiZQoJCWlmICggd2FpdCAhPT0gdHJ1ZSAmJiAtLWpRdWVyeS5yZWFkeVdhaXQgPiAwICkgewoJCQlyZXR1cm47CgkJfQoKCQkvLyBJZiB0aGVyZSBhcmUgZnVuY3Rpb25zIGJvdW5kLCB0byBleGVjdXRlCgkJcmVhZHlMaXN0LnJlc29sdmVXaXRoKCBkb2N1bWVudCwgWyBqUXVlcnkgXSApOwoKCQkvLyBUcmlnZ2VyIGFueSBib3VuZCByZWFkeSBldmVudHMKCQlpZiAoIGpRdWVyeS5mbi50cmlnZ2VySGFuZGxlciApIHsKCQkJalF1ZXJ5KCBkb2N1bWVudCApLnRyaWdnZXJIYW5kbGVyKCAicmVhZHkiICk7CgkJCWpRdWVyeSggZG9jdW1lbnQgKS5vZmYoICJyZWFkeSIgKTsKCQl9Cgl9Cn0gKTsKCi8qKgogKiBUaGUgcmVhZHkgZXZlbnQgaGFuZGxlciBhbmQgc2VsZiBjbGVhbnVwIG1ldGhvZAogKi8KZnVuY3Rpb24gY29tcGxldGVkKCkgewoJZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lciggIkRPTUNvbnRlbnRMb2FkZWQiLCBjb21wbGV0ZWQgKTsKCXdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCAibG9hZCIsIGNvbXBsZXRlZCApOwoJalF1ZXJ5LnJlYWR5KCk7Cn0KCmpRdWVyeS5yZWFkeS5wcm9taXNlID0gZnVuY3Rpb24oIG9iaiApIHsKCWlmICggIXJlYWR5TGlzdCApIHsKCgkJcmVhZHlMaXN0ID0galF1ZXJ5LkRlZmVycmVkKCk7CgoJCS8vIENhdGNoIGNhc2VzIHdoZXJlICQoZG9jdW1lbnQpLnJlYWR5KCkgaXMgY2FsbGVkCgkJLy8gYWZ0ZXIgdGhlIGJyb3dzZXIgZXZlbnQgaGFzIGFscmVhZHkgb2NjdXJyZWQuCgkJLy8gU3VwcG9ydDogSUU5LTEwIG9ubHkKCQkvLyBPbGRlciBJRSBzb21ldGltZXMgc2lnbmFscyAiaW50ZXJhY3RpdmUiIHRvbyBzb29uCgkJaWYgKCBkb2N1bWVudC5yZWFkeVN0YXRlID09PSAiY29tcGxldGUiIHx8CgkJCSggZG9jdW1lbnQucmVhZHlTdGF0ZSAhPT0gImxvYWRpbmciICYmICFkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZG9TY3JvbGwgKSApIHsKCgkJCS8vIEhhbmRsZSBpdCBhc3luY2hyb25vdXNseSB0byBhbGxvdyBzY3JpcHRzIHRoZSBvcHBvcnR1bml0eSB0byBkZWxheSByZWFkeQoJCQl3aW5kb3cuc2V0VGltZW91dCggalF1ZXJ5LnJlYWR5ICk7CgoJCX0gZWxzZSB7CgoJCQkvLyBVc2UgdGhlIGhhbmR5IGV2ZW50IGNhbGxiYWNrCgkJCWRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoICJET01Db250ZW50TG9hZGVkIiwgY29tcGxldGVkICk7CgoJCQkvLyBBIGZhbGxiYWNrIHRvIHdpbmRvdy5vbmxvYWQsIHRoYXQgd2lsbCBhbHdheXMgd29yawoJCQl3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciggImxvYWQiLCBjb21wbGV0ZWQgKTsKCQl9Cgl9CglyZXR1cm4gcmVhZHlMaXN0LnByb21pc2UoIG9iaiApOwp9OwoKLy8gS2ljayBvZmYgdGhlIERPTSByZWFkeSBjaGVjayBldmVuIGlmIHRoZSB1c2VyIGRvZXMgbm90CmpRdWVyeS5yZWFkeS5wcm9taXNlKCk7CgoKCgovLyBNdWx0aWZ1bmN0aW9uYWwgbWV0aG9kIHRvIGdldCBhbmQgc2V0IHZhbHVlcyBvZiBhIGNvbGxlY3Rpb24KLy8gVGhlIHZhbHVlL3MgY2FuIG9wdGlvbmFsbHkgYmUgZXhlY3V0ZWQgaWYgaXQncyBhIGZ1bmN0aW9uCnZhciBhY2Nlc3MgPSBmdW5jdGlvbiggZWxlbXMsIGZuLCBrZXksIHZhbHVlLCBjaGFpbmFibGUsIGVtcHR5R2V0LCByYXcgKSB7Cgl2YXIgaSA9IDAsCgkJbGVuID0gZWxlbXMubGVuZ3RoLAoJCWJ1bGsgPSBrZXkgPT0gbnVsbDsKCgkvLyBTZXRzIG1hbnkgdmFsdWVzCglpZiAoIGpRdWVyeS50eXBlKCBrZXkgKSA9PT0gIm9iamVjdCIgKSB7CgkJY2hhaW5hYmxlID0gdHJ1ZTsKCQlmb3IgKCBpIGluIGtleSApIHsKCQkJYWNjZXNzKCBlbGVtcywgZm4sIGksIGtleVsgaSBdLCB0cnVlLCBlbXB0eUdldCwgcmF3ICk7CgkJfQoKCS8vIFNldHMgb25lIHZhbHVlCgl9IGVsc2UgaWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICkgewoJCWNoYWluYWJsZSA9IHRydWU7CgoJCWlmICggIWpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQlyYXcgPSB0cnVlOwoJCX0KCgkJaWYgKCBidWxrICkgewoKCQkJLy8gQnVsayBvcGVyYXRpb25zIHJ1biBhZ2FpbnN0IHRoZSBlbnRpcmUgc2V0CgkJCWlmICggcmF3ICkgewoJCQkJZm4uY2FsbCggZWxlbXMsIHZhbHVlICk7CgkJCQlmbiA9IG51bGw7CgoJCQkvLyAuLi5leGNlcHQgd2hlbiBleGVjdXRpbmcgZnVuY3Rpb24gdmFsdWVzCgkJCX0gZWxzZSB7CgkJCQlidWxrID0gZm47CgkJCQlmbiA9IGZ1bmN0aW9uKCBlbGVtLCBrZXksIHZhbHVlICkgewoJCQkJCXJldHVybiBidWxrLmNhbGwoIGpRdWVyeSggZWxlbSApLCB2YWx1ZSApOwoJCQkJfTsKCQkJfQoJCX0KCgkJaWYgKCBmbiApIHsKCQkJZm9yICggOyBpIDwgbGVuOyBpKysgKSB7CgkJCQlmbigKCQkJCQllbGVtc1sgaSBdLCBrZXksIHJhdyA/CgkJCQkJdmFsdWUgOgoJCQkJCXZhbHVlLmNhbGwoIGVsZW1zWyBpIF0sIGksIGZuKCBlbGVtc1sgaSBdLCBrZXkgKSApCgkJCQkpOwoJCQl9CgkJfQoJfQoKCXJldHVybiBjaGFpbmFibGUgPwoJCWVsZW1zIDoKCgkJLy8gR2V0cwoJCWJ1bGsgPwoJCQlmbi5jYWxsKCBlbGVtcyApIDoKCQkJbGVuID8gZm4oIGVsZW1zWyAwIF0sIGtleSApIDogZW1wdHlHZXQ7Cn07CnZhciBhY2NlcHREYXRhID0gZnVuY3Rpb24oIG93bmVyICkgewoKCS8vIEFjY2VwdHMgb25seToKCS8vICAtIE5vZGUKCS8vICAgIC0gTm9kZS5FTEVNRU5UX05PREUKCS8vICAgIC0gTm9kZS5ET0NVTUVOVF9OT0RFCgkvLyAgLSBPYmplY3QKCS8vICAgIC0gQW55CgkvKiBqc2hpbnQgLVcwMTggKi8KCXJldHVybiBvd25lci5ub2RlVHlwZSA9PT0gMSB8fCBvd25lci5ub2RlVHlwZSA9PT0gOSB8fCAhKCArb3duZXIubm9kZVR5cGUgKTsKfTsKCgoKCmZ1bmN0aW9uIERhdGEoKSB7Cgl0aGlzLmV4cGFuZG8gPSBqUXVlcnkuZXhwYW5kbyArIERhdGEudWlkKys7Cn0KCkRhdGEudWlkID0gMTsKCkRhdGEucHJvdG90eXBlID0gewoKCXJlZ2lzdGVyOiBmdW5jdGlvbiggb3duZXIsIGluaXRpYWwgKSB7CgkJdmFyIHZhbHVlID0gaW5pdGlhbCB8fCB7fTsKCgkJLy8gSWYgaXQgaXMgYSBub2RlIHVubGlrZWx5IHRvIGJlIHN0cmluZ2lmeS1lZCBvciBsb29wZWQgb3ZlcgoJCS8vIHVzZSBwbGFpbiBhc3NpZ25tZW50CgkJaWYgKCBvd25lci5ub2RlVHlwZSApIHsKCQkJb3duZXJbIHRoaXMuZXhwYW5kbyBdID0gdmFsdWU7CgoJCS8vIE90aGVyd2lzZSBzZWN1cmUgaXQgaW4gYSBub24tZW51bWVyYWJsZSwgbm9uLXdyaXRhYmxlIHByb3BlcnR5CgkJLy8gY29uZmlndXJhYmlsaXR5IG11c3QgYmUgdHJ1ZSB0byBhbGxvdyB0aGUgcHJvcGVydHkgdG8gYmUKCQkvLyBkZWxldGVkIHdpdGggdGhlIGRlbGV0ZSBvcGVyYXRvcgoJCX0gZWxzZSB7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eSggb3duZXIsIHRoaXMuZXhwYW5kbywgewoJCQkJdmFsdWU6IHZhbHVlLAoJCQkJd3JpdGFibGU6IHRydWUsCgkJCQljb25maWd1cmFibGU6IHRydWUKCQkJfSApOwoJCX0KCQlyZXR1cm4gb3duZXJbIHRoaXMuZXhwYW5kbyBdOwoJfSwKCWNhY2hlOiBmdW5jdGlvbiggb3duZXIgKSB7CgoJCS8vIFdlIGNhbiBhY2NlcHQgZGF0YSBmb3Igbm9uLWVsZW1lbnQgbm9kZXMgaW4gbW9kZXJuIGJyb3dzZXJzLAoJCS8vIGJ1dCB3ZSBzaG91bGQgbm90LCBzZWUgIzgzMzUuCgkJLy8gQWx3YXlzIHJldHVybiBhbiBlbXB0eSBvYmplY3QuCgkJaWYgKCAhYWNjZXB0RGF0YSggb3duZXIgKSApIHsKCQkJcmV0dXJuIHt9OwoJCX0KCgkJLy8gQ2hlY2sgaWYgdGhlIG93bmVyIG9iamVjdCBhbHJlYWR5IGhhcyBhIGNhY2hlCgkJdmFyIHZhbHVlID0gb3duZXJbIHRoaXMuZXhwYW5kbyBdOwoKCQkvLyBJZiBub3QsIGNyZWF0ZSBvbmUKCQlpZiAoICF2YWx1ZSApIHsKCQkJdmFsdWUgPSB7fTsKCgkJCS8vIFdlIGNhbiBhY2NlcHQgZGF0YSBmb3Igbm9uLWVsZW1lbnQgbm9kZXMgaW4gbW9kZXJuIGJyb3dzZXJzLAoJCQkvLyBidXQgd2Ugc2hvdWxkIG5vdCwgc2VlICM4MzM1LgoJCQkvLyBBbHdheXMgcmV0dXJuIGFuIGVtcHR5IG9iamVjdC4KCQkJaWYgKCBhY2NlcHREYXRhKCBvd25lciApICkgewoKCQkJCS8vIElmIGl0IGlzIGEgbm9kZSB1bmxpa2VseSB0byBiZSBzdHJpbmdpZnktZWQgb3IgbG9vcGVkIG92ZXIKCQkJCS8vIHVzZSBwbGFpbiBhc3NpZ25tZW50CgkJCQlpZiAoIG93bmVyLm5vZGVUeXBlICkgewoJCQkJCW93bmVyWyB0aGlzLmV4cGFuZG8gXSA9IHZhbHVlOwoKCQkJCS8vIE90aGVyd2lzZSBzZWN1cmUgaXQgaW4gYSBub24tZW51bWVyYWJsZSBwcm9wZXJ0eQoJCQkJLy8gY29uZmlndXJhYmxlIG11c3QgYmUgdHJ1ZSB0byBhbGxvdyB0aGUgcHJvcGVydHkgdG8gYmUKCQkJCS8vIGRlbGV0ZWQgd2hlbiBkYXRhIGlzIHJlbW92ZWQKCQkJCX0gZWxzZSB7CgkJCQkJT2JqZWN0LmRlZmluZVByb3BlcnR5KCBvd25lciwgdGhpcy5leHBhbmRvLCB7CgkJCQkJCXZhbHVlOiB2YWx1ZSwKCQkJCQkJY29uZmlndXJhYmxlOiB0cnVlCgkJCQkJfSApOwoJCQkJfQoJCQl9CgkJfQoKCQlyZXR1cm4gdmFsdWU7Cgl9LAoJc2V0OiBmdW5jdGlvbiggb3duZXIsIGRhdGEsIHZhbHVlICkgewoJCXZhciBwcm9wLAoJCQljYWNoZSA9IHRoaXMuY2FjaGUoIG93bmVyICk7CgoJCS8vIEhhbmRsZTogWyBvd25lciwga2V5LCB2YWx1ZSBdIGFyZ3MKCQlpZiAoIHR5cGVvZiBkYXRhID09PSAic3RyaW5nIiApIHsKCQkJY2FjaGVbIGRhdGEgXSA9IHZhbHVlOwoKCQkvLyBIYW5kbGU6IFsgb3duZXIsIHsgcHJvcGVydGllcyB9IF0gYXJncwoJCX0gZWxzZSB7CgoJCQkvLyBDb3B5IHRoZSBwcm9wZXJ0aWVzIG9uZS1ieS1vbmUgdG8gdGhlIGNhY2hlIG9iamVjdAoJCQlmb3IgKCBwcm9wIGluIGRhdGEgKSB7CgkJCQljYWNoZVsgcHJvcCBdID0gZGF0YVsgcHJvcCBdOwoJCQl9CgkJfQoJCXJldHVybiBjYWNoZTsKCX0sCglnZXQ6IGZ1bmN0aW9uKCBvd25lciwga2V5ICkgewoJCXJldHVybiBrZXkgPT09IHVuZGVmaW5lZCA/CgkJCXRoaXMuY2FjaGUoIG93bmVyICkgOgoJCQlvd25lclsgdGhpcy5leHBhbmRvIF0gJiYgb3duZXJbIHRoaXMuZXhwYW5kbyBdWyBrZXkgXTsKCX0sCglhY2Nlc3M6IGZ1bmN0aW9uKCBvd25lciwga2V5LCB2YWx1ZSApIHsKCQl2YXIgc3RvcmVkOwoKCQkvLyBJbiBjYXNlcyB3aGVyZSBlaXRoZXI6CgkJLy8KCQkvLyAgIDEuIE5vIGtleSB3YXMgc3BlY2lmaWVkCgkJLy8gICAyLiBBIHN0cmluZyBrZXkgd2FzIHNwZWNpZmllZCwgYnV0IG5vIHZhbHVlIHByb3ZpZGVkCgkJLy8KCQkvLyBUYWtlIHRoZSAicmVhZCIgcGF0aCBhbmQgYWxsb3cgdGhlIGdldCBtZXRob2QgdG8gZGV0ZXJtaW5lCgkJLy8gd2hpY2ggdmFsdWUgdG8gcmV0dXJuLCByZXNwZWN0aXZlbHkgZWl0aGVyOgoJCS8vCgkJLy8gICAxLiBUaGUgZW50aXJlIGNhY2hlIG9iamVjdAoJCS8vICAgMi4gVGhlIGRhdGEgc3RvcmVkIGF0IHRoZSBrZXkKCQkvLwoJCWlmICgga2V5ID09PSB1bmRlZmluZWQgfHwKCQkJCSggKCBrZXkgJiYgdHlwZW9mIGtleSA9PT0gInN0cmluZyIgKSAmJiB2YWx1ZSA9PT0gdW5kZWZpbmVkICkgKSB7CgoJCQlzdG9yZWQgPSB0aGlzLmdldCggb3duZXIsIGtleSApOwoKCQkJcmV0dXJuIHN0b3JlZCAhPT0gdW5kZWZpbmVkID8KCQkJCXN0b3JlZCA6IHRoaXMuZ2V0KCBvd25lciwgalF1ZXJ5LmNhbWVsQ2FzZSgga2V5ICkgKTsKCQl9CgoJCS8vIFdoZW4gdGhlIGtleSBpcyBub3QgYSBzdHJpbmcsIG9yIGJvdGggYSBrZXkgYW5kIHZhbHVlCgkJLy8gYXJlIHNwZWNpZmllZCwgc2V0IG9yIGV4dGVuZCAoZXhpc3Rpbmcgb2JqZWN0cykgd2l0aCBlaXRoZXI6CgkJLy8KCQkvLyAgIDEuIEFuIG9iamVjdCBvZiBwcm9wZXJ0aWVzCgkJLy8gICAyLiBBIGtleSBhbmQgdmFsdWUKCQkvLwoJCXRoaXMuc2V0KCBvd25lciwga2V5LCB2YWx1ZSApOwoKCQkvLyBTaW5jZSB0aGUgInNldCIgcGF0aCBjYW4gaGF2ZSB0d28gcG9zc2libGUgZW50cnkgcG9pbnRzCgkJLy8gcmV0dXJuIHRoZSBleHBlY3RlZCBkYXRhIGJhc2VkIG9uIHdoaWNoIHBhdGggd2FzIHRha2VuWypdCgkJcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPyB2YWx1ZSA6IGtleTsKCX0sCglyZW1vdmU6IGZ1bmN0aW9uKCBvd25lciwga2V5ICkgewoJCXZhciBpLCBuYW1lLCBjYW1lbCwKCQkJY2FjaGUgPSBvd25lclsgdGhpcy5leHBhbmRvIF07CgoJCWlmICggY2FjaGUgPT09IHVuZGVmaW5lZCApIHsKCQkJcmV0dXJuOwoJCX0KCgkJaWYgKCBrZXkgPT09IHVuZGVmaW5lZCApIHsKCQkJdGhpcy5yZWdpc3Rlciggb3duZXIgKTsKCgkJfSBlbHNlIHsKCgkJCS8vIFN1cHBvcnQgYXJyYXkgb3Igc3BhY2Ugc2VwYXJhdGVkIHN0cmluZyBvZiBrZXlzCgkJCWlmICggalF1ZXJ5LmlzQXJyYXkoIGtleSApICkgewoKCQkJCS8vIElmICJuYW1lIiBpcyBhbiBhcnJheSBvZiBrZXlzLi4uCgkJCQkvLyBXaGVuIGRhdGEgaXMgaW5pdGlhbGx5IGNyZWF0ZWQsIHZpYSAoImtleSIsICJ2YWwiKSBzaWduYXR1cmUsCgkJCQkvLyBrZXlzIHdpbGwgYmUgY29udmVydGVkIHRvIGNhbWVsQ2FzZS4KCQkJCS8vIFNpbmNlIHRoZXJlIGlzIG5vIHdheSB0byB0ZWxsIF9ob3dfIGEga2V5IHdhcyBhZGRlZCwgcmVtb3ZlCgkJCQkvLyBib3RoIHBsYWluIGtleSBhbmQgY2FtZWxDYXNlIGtleS4gIzEyNzg2CgkJCQkvLyBUaGlzIHdpbGwgb25seSBwZW5hbGl6ZSB0aGUgYXJyYXkgYXJndW1lbnQgcGF0aC4KCQkJCW5hbWUgPSBrZXkuY29uY2F0KCBrZXkubWFwKCBqUXVlcnkuY2FtZWxDYXNlICkgKTsKCQkJfSBlbHNlIHsKCQkJCWNhbWVsID0galF1ZXJ5LmNhbWVsQ2FzZSgga2V5ICk7CgoJCQkJLy8gVHJ5IHRoZSBzdHJpbmcgYXMgYSBrZXkgYmVmb3JlIGFueSBtYW5pcHVsYXRpb24KCQkJCWlmICgga2V5IGluIGNhY2hlICkgewoJCQkJCW5hbWUgPSBbIGtleSwgY2FtZWwgXTsKCQkJCX0gZWxzZSB7CgoJCQkJCS8vIElmIGEga2V5IHdpdGggdGhlIHNwYWNlcyBleGlzdHMsIHVzZSBpdC4KCQkJCQkvLyBPdGhlcndpc2UsIGNyZWF0ZSBhbiBhcnJheSBieSBtYXRjaGluZyBub24td2hpdGVzcGFjZQoJCQkJCW5hbWUgPSBjYW1lbDsKCQkJCQluYW1lID0gbmFtZSBpbiBjYWNoZSA/CgkJCQkJCVsgbmFtZSBdIDogKCBuYW1lLm1hdGNoKCBybm90d2hpdGUgKSB8fCBbXSApOwoJCQkJfQoJCQl9CgoJCQlpID0gbmFtZS5sZW5ndGg7CgoJCQl3aGlsZSAoIGktLSApIHsKCQkJCWRlbGV0ZSBjYWNoZVsgbmFtZVsgaSBdIF07CgkJCX0KCQl9CgoJCS8vIFJlbW92ZSB0aGUgZXhwYW5kbyBpZiB0aGVyZSdzIG5vIG1vcmUgZGF0YQoJCWlmICgga2V5ID09PSB1bmRlZmluZWQgfHwgalF1ZXJ5LmlzRW1wdHlPYmplY3QoIGNhY2hlICkgKSB7CgoJCQkvLyBTdXBwb3J0OiBDaHJvbWUgPD0gMzUtNDUrCgkJCS8vIFdlYmtpdCAmIEJsaW5rIHBlcmZvcm1hbmNlIHN1ZmZlcnMgd2hlbiBkZWxldGluZyBwcm9wZXJ0aWVzCgkJCS8vIGZyb20gRE9NIG5vZGVzLCBzbyBzZXQgdG8gdW5kZWZpbmVkIGluc3RlYWQKCQkJLy8gaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTM3ODYwNwoJCQlpZiAoIG93bmVyLm5vZGVUeXBlICkgewoJCQkJb3duZXJbIHRoaXMuZXhwYW5kbyBdID0gdW5kZWZpbmVkOwoJCQl9IGVsc2UgewoJCQkJZGVsZXRlIG93bmVyWyB0aGlzLmV4cGFuZG8gXTsKCQkJfQoJCX0KCX0sCgloYXNEYXRhOiBmdW5jdGlvbiggb3duZXIgKSB7CgkJdmFyIGNhY2hlID0gb3duZXJbIHRoaXMuZXhwYW5kbyBdOwoJCXJldHVybiBjYWNoZSAhPT0gdW5kZWZpbmVkICYmICFqUXVlcnkuaXNFbXB0eU9iamVjdCggY2FjaGUgKTsKCX0KfTsKdmFyIGRhdGFQcml2ID0gbmV3IERhdGEoKTsKCnZhciBkYXRhVXNlciA9IG5ldyBEYXRhKCk7CgoKCi8vCUltcGxlbWVudGF0aW9uIFN1bW1hcnkKLy8KLy8JMS4gRW5mb3JjZSBBUEkgc3VyZmFjZSBhbmQgc2VtYW50aWMgY29tcGF0aWJpbGl0eSB3aXRoIDEuOS54IGJyYW5jaAovLwkyLiBJbXByb3ZlIHRoZSBtb2R1bGUncyBtYWludGFpbmFiaWxpdHkgYnkgcmVkdWNpbmcgdGhlIHN0b3JhZ2UKLy8JCXBhdGhzIHRvIGEgc2luZ2xlIG1lY2hhbmlzbS4KLy8JMy4gVXNlIHRoZSBzYW1lIHNpbmdsZSBtZWNoYW5pc20gdG8gc3VwcG9ydCAicHJpdmF0ZSIgYW5kICJ1c2VyIiBkYXRhLgovLwk0LiBfTmV2ZXJfIGV4cG9zZSAicHJpdmF0ZSIgZGF0YSB0byB1c2VyIGNvZGUgKFRPRE86IERyb3AgX2RhdGEsIF9yZW1vdmVEYXRhKQovLwk1LiBBdm9pZCBleHBvc2luZyBpbXBsZW1lbnRhdGlvbiBkZXRhaWxzIG9uIHVzZXIgb2JqZWN0cyAoZWcuIGV4cGFuZG8gcHJvcGVydGllcykKLy8JNi4gUHJvdmlkZSBhIGNsZWFyIHBhdGggZm9yIGltcGxlbWVudGF0aW9uIHVwZ3JhZGUgdG8gV2Vha01hcCBpbiAyMDE0Cgp2YXIgcmJyYWNlID0gL14oPzpce1tcd1xXXSpcfXxcW1tcd1xXXSpcXSkkLywKCXJtdWx0aURhc2ggPSAvW0EtWl0vZzsKCmZ1bmN0aW9uIGRhdGFBdHRyKCBlbGVtLCBrZXksIGRhdGEgKSB7Cgl2YXIgbmFtZTsKCgkvLyBJZiBub3RoaW5nIHdhcyBmb3VuZCBpbnRlcm5hbGx5LCB0cnkgdG8gZmV0Y2ggYW55CgkvLyBkYXRhIGZyb20gdGhlIEhUTUw1IGRhdGEtKiBhdHRyaWJ1dGUKCWlmICggZGF0YSA9PT0gdW5kZWZpbmVkICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJbmFtZSA9ICJkYXRhLSIgKyBrZXkucmVwbGFjZSggcm11bHRpRGFzaCwgIi0kJiIgKS50b0xvd2VyQ2FzZSgpOwoJCWRhdGEgPSBlbGVtLmdldEF0dHJpYnV0ZSggbmFtZSApOwoKCQlpZiAoIHR5cGVvZiBkYXRhID09PSAic3RyaW5nIiApIHsKCQkJdHJ5IHsKCQkJCWRhdGEgPSBkYXRhID09PSAidHJ1ZSIgPyB0cnVlIDoKCQkJCQlkYXRhID09PSAiZmFsc2UiID8gZmFsc2UgOgoJCQkJCWRhdGEgPT09ICJudWxsIiA/IG51bGwgOgoKCQkJCQkvLyBPbmx5IGNvbnZlcnQgdG8gYSBudW1iZXIgaWYgaXQgZG9lc24ndCBjaGFuZ2UgdGhlIHN0cmluZwoJCQkJCStkYXRhICsgIiIgPT09IGRhdGEgPyArZGF0YSA6CgkJCQkJcmJyYWNlLnRlc3QoIGRhdGEgKSA/IGpRdWVyeS5wYXJzZUpTT04oIGRhdGEgKSA6CgkJCQkJZGF0YTsKCQkJfSBjYXRjaCAoIGUgKSB7fQoKCQkJLy8gTWFrZSBzdXJlIHdlIHNldCB0aGUgZGF0YSBzbyBpdCBpc24ndCBjaGFuZ2VkIGxhdGVyCgkJCWRhdGFVc2VyLnNldCggZWxlbSwga2V5LCBkYXRhICk7CgkJfSBlbHNlIHsKCQkJZGF0YSA9IHVuZGVmaW5lZDsKCQl9Cgl9CglyZXR1cm4gZGF0YTsKfQoKalF1ZXJ5LmV4dGVuZCggewoJaGFzRGF0YTogZnVuY3Rpb24oIGVsZW0gKSB7CgkJcmV0dXJuIGRhdGFVc2VyLmhhc0RhdGEoIGVsZW0gKSB8fCBkYXRhUHJpdi5oYXNEYXRhKCBlbGVtICk7Cgl9LAoKCWRhdGE6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBkYXRhICkgewoJCXJldHVybiBkYXRhVXNlci5hY2Nlc3MoIGVsZW0sIG5hbWUsIGRhdGEgKTsKCX0sCgoJcmVtb3ZlRGF0YTogZnVuY3Rpb24oIGVsZW0sIG5hbWUgKSB7CgkJZGF0YVVzZXIucmVtb3ZlKCBlbGVtLCBuYW1lICk7Cgl9LAoKCS8vIFRPRE86IE5vdyB0aGF0IGFsbCBjYWxscyB0byBfZGF0YSBhbmQgX3JlbW92ZURhdGEgaGF2ZSBiZWVuIHJlcGxhY2VkCgkvLyB3aXRoIGRpcmVjdCBjYWxscyB0byBkYXRhUHJpdiBtZXRob2RzLCB0aGVzZSBjYW4gYmUgZGVwcmVjYXRlZC4KCV9kYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZGF0YSApIHsKCQlyZXR1cm4gZGF0YVByaXYuYWNjZXNzKCBlbGVtLCBuYW1lLCBkYXRhICk7Cgl9LAoKCV9yZW1vdmVEYXRhOiBmdW5jdGlvbiggZWxlbSwgbmFtZSApIHsKCQlkYXRhUHJpdi5yZW1vdmUoIGVsZW0sIG5hbWUgKTsKCX0KfSApOwoKalF1ZXJ5LmZuLmV4dGVuZCggewoJZGF0YTogZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7CgkJdmFyIGksIG5hbWUsIGRhdGEsCgkJCWVsZW0gPSB0aGlzWyAwIF0sCgkJCWF0dHJzID0gZWxlbSAmJiBlbGVtLmF0dHJpYnV0ZXM7CgoJCS8vIEdldHMgYWxsIHZhbHVlcwoJCWlmICgga2V5ID09PSB1bmRlZmluZWQgKSB7CgkJCWlmICggdGhpcy5sZW5ndGggKSB7CgkJCQlkYXRhID0gZGF0YVVzZXIuZ2V0KCBlbGVtICk7CgoJCQkJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICYmICFkYXRhUHJpdi5nZXQoIGVsZW0sICJoYXNEYXRhQXR0cnMiICkgKSB7CgkJCQkJaSA9IGF0dHJzLmxlbmd0aDsKCQkJCQl3aGlsZSAoIGktLSApIHsKCgkJCQkJCS8vIFN1cHBvcnQ6IElFMTErCgkJCQkJCS8vIFRoZSBhdHRycyBlbGVtZW50cyBjYW4gYmUgbnVsbCAoIzE0ODk0KQoJCQkJCQlpZiAoIGF0dHJzWyBpIF0gKSB7CgkJCQkJCQluYW1lID0gYXR0cnNbIGkgXS5uYW1lOwoJCQkJCQkJaWYgKCBuYW1lLmluZGV4T2YoICJkYXRhLSIgKSA9PT0gMCApIHsKCQkJCQkJCQluYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZS5zbGljZSggNSApICk7CgkJCQkJCQkJZGF0YUF0dHIoIGVsZW0sIG5hbWUsIGRhdGFbIG5hbWUgXSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJCWRhdGFQcml2LnNldCggZWxlbSwgImhhc0RhdGFBdHRycyIsIHRydWUgKTsKCQkJCX0KCQkJfQoKCQkJcmV0dXJuIGRhdGE7CgkJfQoKCQkvLyBTZXRzIG11bHRpcGxlIHZhbHVlcwoJCWlmICggdHlwZW9mIGtleSA9PT0gIm9iamVjdCIgKSB7CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJZGF0YVVzZXIuc2V0KCB0aGlzLCBrZXkgKTsKCQkJfSApOwoJCX0KCgkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIHZhbHVlICkgewoJCQl2YXIgZGF0YSwgY2FtZWxLZXk7CgoJCQkvLyBUaGUgY2FsbGluZyBqUXVlcnkgb2JqZWN0IChlbGVtZW50IG1hdGNoZXMpIGlzIG5vdCBlbXB0eQoJCQkvLyAoYW5kIHRoZXJlZm9yZSBoYXMgYW4gZWxlbWVudCBhcHBlYXJzIGF0IHRoaXNbIDAgXSkgYW5kIHRoZQoJCQkvLyBgdmFsdWVgIHBhcmFtZXRlciB3YXMgbm90IHVuZGVmaW5lZC4gQW4gZW1wdHkgalF1ZXJ5IG9iamVjdAoJCQkvLyB3aWxsIHJlc3VsdCBpbiBgdW5kZWZpbmVkYCBmb3IgZWxlbSA9IHRoaXNbIDAgXSB3aGljaCB3aWxsCgkJCS8vIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhbiBhdHRlbXB0IHRvIHJlYWQgYSBkYXRhIGNhY2hlIGlzIG1hZGUuCgkJCWlmICggZWxlbSAmJiB2YWx1ZSA9PT0gdW5kZWZpbmVkICkgewoKCQkJCS8vIEF0dGVtcHQgdG8gZ2V0IGRhdGEgZnJvbSB0aGUgY2FjaGUKCQkJCS8vIHdpdGggdGhlIGtleSBhcy1pcwoJCQkJZGF0YSA9IGRhdGFVc2VyLmdldCggZWxlbSwga2V5ICkgfHwKCgkJCQkJLy8gVHJ5IHRvIGZpbmQgZGFzaGVkIGtleSBpZiBpdCBleGlzdHMgKGdoLTI3NzkpCgkJCQkJLy8gVGhpcyBpcyBmb3IgMi4yLnggb25seQoJCQkJCWRhdGFVc2VyLmdldCggZWxlbSwga2V5LnJlcGxhY2UoIHJtdWx0aURhc2gsICItJCYiICkudG9Mb3dlckNhc2UoKSApOwoKCQkJCWlmICggZGF0YSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCXJldHVybiBkYXRhOwoJCQkJfQoKCQkJCWNhbWVsS2V5ID0galF1ZXJ5LmNhbWVsQ2FzZSgga2V5ICk7CgoJCQkJLy8gQXR0ZW1wdCB0byBnZXQgZGF0YSBmcm9tIHRoZSBjYWNoZQoJCQkJLy8gd2l0aCB0aGUga2V5IGNhbWVsaXplZAoJCQkJZGF0YSA9IGRhdGFVc2VyLmdldCggZWxlbSwgY2FtZWxLZXkgKTsKCQkJCWlmICggZGF0YSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCXJldHVybiBkYXRhOwoJCQkJfQoKCQkJCS8vIEF0dGVtcHQgdG8gImRpc2NvdmVyIiB0aGUgZGF0YSBpbgoJCQkJLy8gSFRNTDUgY3VzdG9tIGRhdGEtKiBhdHRycwoJCQkJZGF0YSA9IGRhdGFBdHRyKCBlbGVtLCBjYW1lbEtleSwgdW5kZWZpbmVkICk7CgkJCQlpZiAoIGRhdGEgIT09IHVuZGVmaW5lZCApIHsKCQkJCQlyZXR1cm4gZGF0YTsKCQkJCX0KCgkJCQkvLyBXZSB0cmllZCByZWFsbHkgaGFyZCwgYnV0IHRoZSBkYXRhIGRvZXNuJ3QgZXhpc3QuCgkJCQlyZXR1cm47CgkJCX0KCgkJCS8vIFNldCB0aGUgZGF0YS4uLgoJCQljYW1lbEtleSA9IGpRdWVyeS5jYW1lbENhc2UoIGtleSApOwoJCQl0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoKCQkJCS8vIEZpcnN0LCBhdHRlbXB0IHRvIHN0b3JlIGEgY29weSBvciByZWZlcmVuY2Ugb2YgYW55CgkJCQkvLyBkYXRhIHRoYXQgbWlnaHQndmUgYmVlbiBzdG9yZSB3aXRoIGEgY2FtZWxDYXNlZCBrZXkuCgkJCQl2YXIgZGF0YSA9IGRhdGFVc2VyLmdldCggdGhpcywgY2FtZWxLZXkgKTsKCgkJCQkvLyBGb3IgSFRNTDUgZGF0YS0qIGF0dHJpYnV0ZSBpbnRlcm9wLCB3ZSBoYXZlIHRvCgkJCQkvLyBzdG9yZSBwcm9wZXJ0eSBuYW1lcyB3aXRoIGRhc2hlcyBpbiBhIGNhbWVsQ2FzZSBmb3JtLgoJCQkJLy8gVGhpcyBtaWdodCBub3QgYXBwbHkgdG8gYWxsIHByb3BlcnRpZXMuLi4qCgkJCQlkYXRhVXNlci5zZXQoIHRoaXMsIGNhbWVsS2V5LCB2YWx1ZSApOwoKCQkJCS8vICouLi4gSW4gdGhlIGNhc2Ugb2YgcHJvcGVydGllcyB0aGF0IG1pZ2h0IF9hY3R1YWxseV8KCQkJCS8vIGhhdmUgZGFzaGVzLCB3ZSBuZWVkIHRvIGFsc28gc3RvcmUgYSBjb3B5IG9mIHRoYXQKCQkJCS8vIHVuY2hhbmdlZCBwcm9wZXJ0eS4KCQkJCWlmICgga2V5LmluZGV4T2YoICItIiApID4gLTEgJiYgZGF0YSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCWRhdGFVc2VyLnNldCggdGhpcywga2V5LCB2YWx1ZSApOwoJCQkJfQoJCQl9ICk7CgkJfSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxLCBudWxsLCB0cnVlICk7Cgl9LAoKCXJlbW92ZURhdGE6IGZ1bmN0aW9uKCBrZXkgKSB7CgkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCWRhdGFVc2VyLnJlbW92ZSggdGhpcywga2V5ICk7CgkJfSApOwoJfQp9ICk7CgoKalF1ZXJ5LmV4dGVuZCggewoJcXVldWU6IGZ1bmN0aW9uKCBlbGVtLCB0eXBlLCBkYXRhICkgewoJCXZhciBxdWV1ZTsKCgkJaWYgKCBlbGVtICkgewoJCQl0eXBlID0gKCB0eXBlIHx8ICJmeCIgKSArICJxdWV1ZSI7CgkJCXF1ZXVlID0gZGF0YVByaXYuZ2V0KCBlbGVtLCB0eXBlICk7CgoJCQkvLyBTcGVlZCB1cCBkZXF1ZXVlIGJ5IGdldHRpbmcgb3V0IHF1aWNrbHkgaWYgdGhpcyBpcyBqdXN0IGEgbG9va3VwCgkJCWlmICggZGF0YSApIHsKCQkJCWlmICggIXF1ZXVlIHx8IGpRdWVyeS5pc0FycmF5KCBkYXRhICkgKSB7CgkJCQkJcXVldWUgPSBkYXRhUHJpdi5hY2Nlc3MoIGVsZW0sIHR5cGUsIGpRdWVyeS5tYWtlQXJyYXkoIGRhdGEgKSApOwoJCQkJfSBlbHNlIHsKCQkJCQlxdWV1ZS5wdXNoKCBkYXRhICk7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIHF1ZXVlIHx8IFtdOwoJCX0KCX0sCgoJZGVxdWV1ZTogZnVuY3Rpb24oIGVsZW0sIHR5cGUgKSB7CgkJdHlwZSA9IHR5cGUgfHwgImZ4IjsKCgkJdmFyIHF1ZXVlID0galF1ZXJ5LnF1ZXVlKCBlbGVtLCB0eXBlICksCgkJCXN0YXJ0TGVuZ3RoID0gcXVldWUubGVuZ3RoLAoJCQlmbiA9IHF1ZXVlLnNoaWZ0KCksCgkJCWhvb2tzID0galF1ZXJ5Ll9xdWV1ZUhvb2tzKCBlbGVtLCB0eXBlICksCgkJCW5leHQgPSBmdW5jdGlvbigpIHsKCQkJCWpRdWVyeS5kZXF1ZXVlKCBlbGVtLCB0eXBlICk7CgkJCX07CgoJCS8vIElmIHRoZSBmeCBxdWV1ZSBpcyBkZXF1ZXVlZCwgYWx3YXlzIHJlbW92ZSB0aGUgcHJvZ3Jlc3Mgc2VudGluZWwKCQlpZiAoIGZuID09PSAiaW5wcm9ncmVzcyIgKSB7CgkJCWZuID0gcXVldWUuc2hpZnQoKTsKCQkJc3RhcnRMZW5ndGgtLTsKCQl9CgoJCWlmICggZm4gKSB7CgoJCQkvLyBBZGQgYSBwcm9ncmVzcyBzZW50aW5lbCB0byBwcmV2ZW50IHRoZSBmeCBxdWV1ZSBmcm9tIGJlaW5nCgkJCS8vIGF1dG9tYXRpY2FsbHkgZGVxdWV1ZWQKCQkJaWYgKCB0eXBlID09PSAiZngiICkgewoJCQkJcXVldWUudW5zaGlmdCggImlucHJvZ3Jlc3MiICk7CgkJCX0KCgkJCS8vIENsZWFyIHVwIHRoZSBsYXN0IHF1ZXVlIHN0b3AgZnVuY3Rpb24KCQkJZGVsZXRlIGhvb2tzLnN0b3A7CgkJCWZuLmNhbGwoIGVsZW0sIG5leHQsIGhvb2tzICk7CgkJfQoKCQlpZiAoICFzdGFydExlbmd0aCAmJiBob29rcyApIHsKCQkJaG9va3MuZW1wdHkuZmlyZSgpOwoJCX0KCX0sCgoJLy8gTm90IHB1YmxpYyAtIGdlbmVyYXRlIGEgcXVldWVIb29rcyBvYmplY3QsIG9yIHJldHVybiB0aGUgY3VycmVudCBvbmUKCV9xdWV1ZUhvb2tzOiBmdW5jdGlvbiggZWxlbSwgdHlwZSApIHsKCQl2YXIga2V5ID0gdHlwZSArICJxdWV1ZUhvb2tzIjsKCQlyZXR1cm4gZGF0YVByaXYuZ2V0KCBlbGVtLCBrZXkgKSB8fCBkYXRhUHJpdi5hY2Nlc3MoIGVsZW0sIGtleSwgewoJCQllbXB0eTogalF1ZXJ5LkNhbGxiYWNrcyggIm9uY2UgbWVtb3J5IiApLmFkZCggZnVuY3Rpb24oKSB7CgkJCQlkYXRhUHJpdi5yZW1vdmUoIGVsZW0sIFsgdHlwZSArICJxdWV1ZSIsIGtleSBdICk7CgkJCX0gKQoJCX0gKTsKCX0KfSApOwoKalF1ZXJ5LmZuLmV4dGVuZCggewoJcXVldWU6IGZ1bmN0aW9uKCB0eXBlLCBkYXRhICkgewoJCXZhciBzZXR0ZXIgPSAyOwoKCQlpZiAoIHR5cGVvZiB0eXBlICE9PSAic3RyaW5nIiApIHsKCQkJZGF0YSA9IHR5cGU7CgkJCXR5cGUgPSAiZngiOwoJCQlzZXR0ZXItLTsKCQl9CgoJCWlmICggYXJndW1lbnRzLmxlbmd0aCA8IHNldHRlciApIHsKCQkJcmV0dXJuIGpRdWVyeS5xdWV1ZSggdGhpc1sgMCBdLCB0eXBlICk7CgkJfQoKCQlyZXR1cm4gZGF0YSA9PT0gdW5kZWZpbmVkID8KCQkJdGhpcyA6CgkJCXRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCQl2YXIgcXVldWUgPSBqUXVlcnkucXVldWUoIHRoaXMsIHR5cGUsIGRhdGEgKTsKCgkJCQkvLyBFbnN1cmUgYSBob29rcyBmb3IgdGhpcyBxdWV1ZQoJCQkJalF1ZXJ5Ll9xdWV1ZUhvb2tzKCB0aGlzLCB0eXBlICk7CgoJCQkJaWYgKCB0eXBlID09PSAiZngiICYmIHF1ZXVlWyAwIF0gIT09ICJpbnByb2dyZXNzIiApIHsKCQkJCQlqUXVlcnkuZGVxdWV1ZSggdGhpcywgdHlwZSApOwoJCQkJfQoJCQl9ICk7Cgl9LAoJZGVxdWV1ZTogZnVuY3Rpb24oIHR5cGUgKSB7CgkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCB0eXBlICk7CgkJfSApOwoJfSwKCWNsZWFyUXVldWU6IGZ1bmN0aW9uKCB0eXBlICkgewoJCXJldHVybiB0aGlzLnF1ZXVlKCB0eXBlIHx8ICJmeCIsIFtdICk7Cgl9LAoKCS8vIEdldCBhIHByb21pc2UgcmVzb2x2ZWQgd2hlbiBxdWV1ZXMgb2YgYSBjZXJ0YWluIHR5cGUKCS8vIGFyZSBlbXB0aWVkIChmeCBpcyB0aGUgdHlwZSBieSBkZWZhdWx0KQoJcHJvbWlzZTogZnVuY3Rpb24oIHR5cGUsIG9iaiApIHsKCQl2YXIgdG1wLAoJCQljb3VudCA9IDEsCgkJCWRlZmVyID0galF1ZXJ5LkRlZmVycmVkKCksCgkJCWVsZW1lbnRzID0gdGhpcywKCQkJaSA9IHRoaXMubGVuZ3RoLAoJCQlyZXNvbHZlID0gZnVuY3Rpb24oKSB7CgkJCQlpZiAoICEoIC0tY291bnQgKSApIHsKCQkJCQlkZWZlci5yZXNvbHZlV2l0aCggZWxlbWVudHMsIFsgZWxlbWVudHMgXSApOwoJCQkJfQoJCQl9OwoKCQlpZiAoIHR5cGVvZiB0eXBlICE9PSAic3RyaW5nIiApIHsKCQkJb2JqID0gdHlwZTsKCQkJdHlwZSA9IHVuZGVmaW5lZDsKCQl9CgkJdHlwZSA9IHR5cGUgfHwgImZ4IjsKCgkJd2hpbGUgKCBpLS0gKSB7CgkJCXRtcCA9IGRhdGFQcml2LmdldCggZWxlbWVudHNbIGkgXSwgdHlwZSArICJxdWV1ZUhvb2tzIiApOwoJCQlpZiAoIHRtcCAmJiB0bXAuZW1wdHkgKSB7CgkJCQljb3VudCsrOwoJCQkJdG1wLmVtcHR5LmFkZCggcmVzb2x2ZSApOwoJCQl9CgkJfQoJCXJlc29sdmUoKTsKCQlyZXR1cm4gZGVmZXIucHJvbWlzZSggb2JqICk7Cgl9Cn0gKTsKdmFyIHBudW0gPSAoIC9bKy1dPyg/OlxkKlwufClcZCsoPzpbZUVdWystXT9cZCt8KS8gKS5zb3VyY2U7Cgp2YXIgcmNzc051bSA9IG5ldyBSZWdFeHAoICJeKD86KFsrLV0pPXwpKCIgKyBwbnVtICsgIikoW2EteiVdKikkIiwgImkiICk7CgoKdmFyIGNzc0V4cGFuZCA9IFsgIlRvcCIsICJSaWdodCIsICJCb3R0b20iLCAiTGVmdCIgXTsKCnZhciBpc0hpZGRlbiA9IGZ1bmN0aW9uKCBlbGVtLCBlbCApIHsKCgkJLy8gaXNIaWRkZW4gbWlnaHQgYmUgY2FsbGVkIGZyb20galF1ZXJ5I2ZpbHRlciBmdW5jdGlvbjsKCQkvLyBpbiB0aGF0IGNhc2UsIGVsZW1lbnQgd2lsbCBiZSBzZWNvbmQgYXJndW1lbnQKCQllbGVtID0gZWwgfHwgZWxlbTsKCQlyZXR1cm4galF1ZXJ5LmNzcyggZWxlbSwgImRpc3BsYXkiICkgPT09ICJub25lIiB8fAoJCQkhalF1ZXJ5LmNvbnRhaW5zKCBlbGVtLm93bmVyRG9jdW1lbnQsIGVsZW0gKTsKCX07CgoKCmZ1bmN0aW9uIGFkanVzdENTUyggZWxlbSwgcHJvcCwgdmFsdWVQYXJ0cywgdHdlZW4gKSB7Cgl2YXIgYWRqdXN0ZWQsCgkJc2NhbGUgPSAxLAoJCW1heEl0ZXJhdGlvbnMgPSAyMCwKCQljdXJyZW50VmFsdWUgPSB0d2VlbiA/CgkJCWZ1bmN0aW9uKCkgeyByZXR1cm4gdHdlZW4uY3VyKCk7IH0gOgoJCQlmdW5jdGlvbigpIHsgcmV0dXJuIGpRdWVyeS5jc3MoIGVsZW0sIHByb3AsICIiICk7IH0sCgkJaW5pdGlhbCA9IGN1cnJlbnRWYWx1ZSgpLAoJCXVuaXQgPSB2YWx1ZVBhcnRzICYmIHZhbHVlUGFydHNbIDMgXSB8fCAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSA/ICIiIDogInB4IiApLAoKCQkvLyBTdGFydGluZyB2YWx1ZSBjb21wdXRhdGlvbiBpcyByZXF1aXJlZCBmb3IgcG90ZW50aWFsIHVuaXQgbWlzbWF0Y2hlcwoJCWluaXRpYWxJblVuaXQgPSAoIGpRdWVyeS5jc3NOdW1iZXJbIHByb3AgXSB8fCB1bml0ICE9PSAicHgiICYmICtpbml0aWFsICkgJiYKCQkJcmNzc051bS5leGVjKCBqUXVlcnkuY3NzKCBlbGVtLCBwcm9wICkgKTsKCglpZiAoIGluaXRpYWxJblVuaXQgJiYgaW5pdGlhbEluVW5pdFsgMyBdICE9PSB1bml0ICkgewoKCQkvLyBUcnVzdCB1bml0cyByZXBvcnRlZCBieSBqUXVlcnkuY3NzCgkJdW5pdCA9IHVuaXQgfHwgaW5pdGlhbEluVW5pdFsgMyBdOwoKCQkvLyBNYWtlIHN1cmUgd2UgdXBkYXRlIHRoZSB0d2VlbiBwcm9wZXJ0aWVzIGxhdGVyIG9uCgkJdmFsdWVQYXJ0cyA9IHZhbHVlUGFydHMgfHwgW107CgoJCS8vIEl0ZXJhdGl2ZWx5IGFwcHJveGltYXRlIGZyb20gYSBub256ZXJvIHN0YXJ0aW5nIHBvaW50CgkJaW5pdGlhbEluVW5pdCA9ICtpbml0aWFsIHx8IDE7CgoJCWRvIHsKCgkJCS8vIElmIHByZXZpb3VzIGl0ZXJhdGlvbiB6ZXJvZWQgb3V0LCBkb3VibGUgdW50aWwgd2UgZ2V0ICpzb21ldGhpbmcqLgoJCQkvLyBVc2Ugc3RyaW5nIGZvciBkb3VibGluZyBzbyB3ZSBkb24ndCBhY2NpZGVudGFsbHkgc2VlIHNjYWxlIGFzIHVuY2hhbmdlZCBiZWxvdwoJCQlzY2FsZSA9IHNjYWxlIHx8ICIuNSI7CgoJCQkvLyBBZGp1c3QgYW5kIGFwcGx5CgkJCWluaXRpYWxJblVuaXQgPSBpbml0aWFsSW5Vbml0IC8gc2NhbGU7CgkJCWpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCwgaW5pdGlhbEluVW5pdCArIHVuaXQgKTsKCgkJLy8gVXBkYXRlIHNjYWxlLCB0b2xlcmF0aW5nIHplcm8gb3IgTmFOIGZyb20gdHdlZW4uY3VyKCkKCQkvLyBCcmVhayB0aGUgbG9vcCBpZiBzY2FsZSBpcyB1bmNoYW5nZWQgb3IgcGVyZmVjdCwgb3IgaWYgd2UndmUganVzdCBoYWQgZW5vdWdoLgoJCX0gd2hpbGUgKAoJCQlzY2FsZSAhPT0gKCBzY2FsZSA9IGN1cnJlbnRWYWx1ZSgpIC8gaW5pdGlhbCApICYmIHNjYWxlICE9PSAxICYmIC0tbWF4SXRlcmF0aW9ucwoJCSk7Cgl9CgoJaWYgKCB2YWx1ZVBhcnRzICkgewoJCWluaXRpYWxJblVuaXQgPSAraW5pdGlhbEluVW5pdCB8fCAraW5pdGlhbCB8fCAwOwoKCQkvLyBBcHBseSByZWxhdGl2ZSBvZmZzZXQgKCs9Ly09KSBpZiBzcGVjaWZpZWQKCQlhZGp1c3RlZCA9IHZhbHVlUGFydHNbIDEgXSA/CgkJCWluaXRpYWxJblVuaXQgKyAoIHZhbHVlUGFydHNbIDEgXSArIDEgKSAqIHZhbHVlUGFydHNbIDIgXSA6CgkJCSt2YWx1ZVBhcnRzWyAyIF07CgkJaWYgKCB0d2VlbiApIHsKCQkJdHdlZW4udW5pdCA9IHVuaXQ7CgkJCXR3ZWVuLnN0YXJ0ID0gaW5pdGlhbEluVW5pdDsKCQkJdHdlZW4uZW5kID0gYWRqdXN0ZWQ7CgkJfQoJfQoJcmV0dXJuIGFkanVzdGVkOwp9CnZhciByY2hlY2thYmxlVHlwZSA9ICggL14oPzpjaGVja2JveHxyYWRpbykkL2kgKTsKCnZhciBydGFnTmFtZSA9ICggLzwoW1x3Oi1dKykvICk7Cgp2YXIgcnNjcmlwdFR5cGUgPSAoIC9eJHxcLyg/OmphdmF8ZWNtYSlzY3JpcHQvaSApOwoKCgovLyBXZSBoYXZlIHRvIGNsb3NlIHRoZXNlIHRhZ3MgdG8gc3VwcG9ydCBYSFRNTCAoIzEzMjAwKQp2YXIgd3JhcE1hcCA9IHsKCgkvLyBTdXBwb3J0OiBJRTkKCW9wdGlvbjogWyAxLCAiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsICI8L3NlbGVjdD4iIF0sCgoJLy8gWEhUTUwgcGFyc2VycyBkbyBub3QgbWFnaWNhbGx5IGluc2VydCBlbGVtZW50cyBpbiB0aGUKCS8vIHNhbWUgd2F5IHRoYXQgdGFnIHNvdXAgcGFyc2VycyBkby4gU28gd2UgY2Fubm90IHNob3J0ZW4KCS8vIHRoaXMgYnkgb21pdHRpbmcgPHRib2R5PiBvciBvdGhlciByZXF1aXJlZCBlbGVtZW50cy4KCXRoZWFkOiBbIDEsICI8dGFibGU+IiwgIjwvdGFibGU+IiBdLAoJY29sOiBbIDIsICI8dGFibGU+PGNvbGdyb3VwPiIsICI8L2NvbGdyb3VwPjwvdGFibGU+IiBdLAoJdHI6IFsgMiwgIjx0YWJsZT48dGJvZHk+IiwgIjwvdGJvZHk+PC90YWJsZT4iIF0sCgl0ZDogWyAzLCAiPHRhYmxlPjx0Ym9keT48dHI+IiwgIjwvdHI+PC90Ym9keT48L3RhYmxlPiIgXSwKCglfZGVmYXVsdDogWyAwLCAiIiwgIiIgXQp9OwoKLy8gU3VwcG9ydDogSUU5CndyYXBNYXAub3B0Z3JvdXAgPSB3cmFwTWFwLm9wdGlvbjsKCndyYXBNYXAudGJvZHkgPSB3cmFwTWFwLnRmb290ID0gd3JhcE1hcC5jb2xncm91cCA9IHdyYXBNYXAuY2FwdGlvbiA9IHdyYXBNYXAudGhlYWQ7CndyYXBNYXAudGggPSB3cmFwTWFwLnRkOwoKCmZ1bmN0aW9uIGdldEFsbCggY29udGV4dCwgdGFnICkgewoKCS8vIFN1cHBvcnQ6IElFOS0xMSsKCS8vIFVzZSB0eXBlb2YgdG8gYXZvaWQgemVyby1hcmd1bWVudCBtZXRob2QgaW52b2NhdGlvbiBvbiBob3N0IG9iamVjdHMgKCMxNTE1MSkKCXZhciByZXQgPSB0eXBlb2YgY29udGV4dC5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gInVuZGVmaW5lZCIgPwoJCQljb250ZXh0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCB0YWcgfHwgIioiICkgOgoJCQl0eXBlb2YgY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsICE9PSAidW5kZWZpbmVkIiA/CgkJCQljb250ZXh0LnF1ZXJ5U2VsZWN0b3JBbGwoIHRhZyB8fCAiKiIgKSA6CgkJCVtdOwoKCXJldHVybiB0YWcgPT09IHVuZGVmaW5lZCB8fCB0YWcgJiYgalF1ZXJ5Lm5vZGVOYW1lKCBjb250ZXh0LCB0YWcgKSA/CgkJalF1ZXJ5Lm1lcmdlKCBbIGNvbnRleHQgXSwgcmV0ICkgOgoJCXJldDsKfQoKCi8vIE1hcmsgc2NyaXB0cyBhcyBoYXZpbmcgYWxyZWFkeSBiZWVuIGV2YWx1YXRlZApmdW5jdGlvbiBzZXRHbG9iYWxFdmFsKCBlbGVtcywgcmVmRWxlbWVudHMgKSB7Cgl2YXIgaSA9IDAsCgkJbCA9IGVsZW1zLmxlbmd0aDsKCglmb3IgKCA7IGkgPCBsOyBpKysgKSB7CgkJZGF0YVByaXYuc2V0KAoJCQllbGVtc1sgaSBdLAoJCQkiZ2xvYmFsRXZhbCIsCgkJCSFyZWZFbGVtZW50cyB8fCBkYXRhUHJpdi5nZXQoIHJlZkVsZW1lbnRzWyBpIF0sICJnbG9iYWxFdmFsIiApCgkJKTsKCX0KfQoKCnZhciByaHRtbCA9IC88fCYjP1x3KzsvOwoKZnVuY3Rpb24gYnVpbGRGcmFnbWVudCggZWxlbXMsIGNvbnRleHQsIHNjcmlwdHMsIHNlbGVjdGlvbiwgaWdub3JlZCApIHsKCXZhciBlbGVtLCB0bXAsIHRhZywgd3JhcCwgY29udGFpbnMsIGosCgkJZnJhZ21lbnQgPSBjb250ZXh0LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSwKCQlub2RlcyA9IFtdLAoJCWkgPSAwLAoJCWwgPSBlbGVtcy5sZW5ndGg7CgoJZm9yICggOyBpIDwgbDsgaSsrICkgewoJCWVsZW0gPSBlbGVtc1sgaSBdOwoKCQlpZiAoIGVsZW0gfHwgZWxlbSA9PT0gMCApIHsKCgkJCS8vIEFkZCBub2RlcyBkaXJlY3RseQoJCQlpZiAoIGpRdWVyeS50eXBlKCBlbGVtICkgPT09ICJvYmplY3QiICkgewoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4xLCBQaGFudG9tSlM8MgoJCQkJLy8gcHVzaC5hcHBseShfLCBhcnJheWxpa2UpIHRocm93cyBvbiBhbmNpZW50IFdlYktpdAoJCQkJalF1ZXJ5Lm1lcmdlKCBub2RlcywgZWxlbS5ub2RlVHlwZSA/IFsgZWxlbSBdIDogZWxlbSApOwoKCQkJLy8gQ29udmVydCBub24taHRtbCBpbnRvIGEgdGV4dCBub2RlCgkJCX0gZWxzZSBpZiAoICFyaHRtbC50ZXN0KCBlbGVtICkgKSB7CgkJCQlub2Rlcy5wdXNoKCBjb250ZXh0LmNyZWF0ZVRleHROb2RlKCBlbGVtICkgKTsKCgkJCS8vIENvbnZlcnQgaHRtbCBpbnRvIERPTSBub2RlcwoJCQl9IGVsc2UgewoJCQkJdG1wID0gdG1wIHx8IGZyYWdtZW50LmFwcGVuZENoaWxkKCBjb250ZXh0LmNyZWF0ZUVsZW1lbnQoICJkaXYiICkgKTsKCgkJCQkvLyBEZXNlcmlhbGl6ZSBhIHN0YW5kYXJkIHJlcHJlc2VudGF0aW9uCgkJCQl0YWcgPSAoIHJ0YWdOYW1lLmV4ZWMoIGVsZW0gKSB8fCBbICIiLCAiIiBdIClbIDEgXS50b0xvd2VyQ2FzZSgpOwoJCQkJd3JhcCA9IHdyYXBNYXBbIHRhZyBdIHx8IHdyYXBNYXAuX2RlZmF1bHQ7CgkJCQl0bXAuaW5uZXJIVE1MID0gd3JhcFsgMSBdICsgalF1ZXJ5Lmh0bWxQcmVmaWx0ZXIoIGVsZW0gKSArIHdyYXBbIDIgXTsKCgkJCQkvLyBEZXNjZW5kIHRocm91Z2ggd3JhcHBlcnMgdG8gdGhlIHJpZ2h0IGNvbnRlbnQKCQkJCWogPSB3cmFwWyAwIF07CgkJCQl3aGlsZSAoIGotLSApIHsKCQkJCQl0bXAgPSB0bXAubGFzdENoaWxkOwoJCQkJfQoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4xLCBQaGFudG9tSlM8MgoJCQkJLy8gcHVzaC5hcHBseShfLCBhcnJheWxpa2UpIHRocm93cyBvbiBhbmNpZW50IFdlYktpdAoJCQkJalF1ZXJ5Lm1lcmdlKCBub2RlcywgdG1wLmNoaWxkTm9kZXMgKTsKCgkJCQkvLyBSZW1lbWJlciB0aGUgdG9wLWxldmVsIGNvbnRhaW5lcgoJCQkJdG1wID0gZnJhZ21lbnQuZmlyc3RDaGlsZDsKCgkJCQkvLyBFbnN1cmUgdGhlIGNyZWF0ZWQgbm9kZXMgYXJlIG9ycGhhbmVkICgjMTIzOTIpCgkJCQl0bXAudGV4dENvbnRlbnQgPSAiIjsKCQkJfQoJCX0KCX0KCgkvLyBSZW1vdmUgd3JhcHBlciBmcm9tIGZyYWdtZW50CglmcmFnbWVudC50ZXh0Q29udGVudCA9ICIiOwoKCWkgPSAwOwoJd2hpbGUgKCAoIGVsZW0gPSBub2Rlc1sgaSsrIF0gKSApIHsKCgkJLy8gU2tpcCBlbGVtZW50cyBhbHJlYWR5IGluIHRoZSBjb250ZXh0IGNvbGxlY3Rpb24gKHRyYWMtNDA4NykKCQlpZiAoIHNlbGVjdGlvbiAmJiBqUXVlcnkuaW5BcnJheSggZWxlbSwgc2VsZWN0aW9uICkgPiAtMSApIHsKCQkJaWYgKCBpZ25vcmVkICkgewoJCQkJaWdub3JlZC5wdXNoKCBlbGVtICk7CgkJCX0KCQkJY29udGludWU7CgkJfQoKCQljb250YWlucyA9IGpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICk7CgoJCS8vIEFwcGVuZCB0byBmcmFnbWVudAoJCXRtcCA9IGdldEFsbCggZnJhZ21lbnQuYXBwZW5kQ2hpbGQoIGVsZW0gKSwgInNjcmlwdCIgKTsKCgkJLy8gUHJlc2VydmUgc2NyaXB0IGV2YWx1YXRpb24gaGlzdG9yeQoJCWlmICggY29udGFpbnMgKSB7CgkJCXNldEdsb2JhbEV2YWwoIHRtcCApOwoJCX0KCgkJLy8gQ2FwdHVyZSBleGVjdXRhYmxlcwoJCWlmICggc2NyaXB0cyApIHsKCQkJaiA9IDA7CgkJCXdoaWxlICggKCBlbGVtID0gdG1wWyBqKysgXSApICkgewoJCQkJaWYgKCByc2NyaXB0VHlwZS50ZXN0KCBlbGVtLnR5cGUgfHwgIiIgKSApIHsKCQkJCQlzY3JpcHRzLnB1c2goIGVsZW0gKTsKCQkJCX0KCQkJfQoJCX0KCX0KCglyZXR1cm4gZnJhZ21lbnQ7Cn0KCgooIGZ1bmN0aW9uKCkgewoJdmFyIGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLAoJCWRpdiA9IGZyYWdtZW50LmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApICksCgkJaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiaW5wdXQiICk7CgoJLy8gU3VwcG9ydDogQW5kcm9pZCA0LjAtNC4zLCBTYWZhcmk8PTUuMQoJLy8gQ2hlY2sgc3RhdGUgbG9zdCBpZiB0aGUgbmFtZSBpcyBzZXQgKCMxMTIxNykKCS8vIFN1cHBvcnQ6IFdpbmRvd3MgV2ViIEFwcHMgKFdXQSkKCS8vIGBuYW1lYCBhbmQgYHR5cGVgIG11c3QgdXNlIC5zZXRBdHRyaWJ1dGUgZm9yIFdXQSAoIzE0OTAxKQoJaW5wdXQuc2V0QXR0cmlidXRlKCAidHlwZSIsICJyYWRpbyIgKTsKCWlucHV0LnNldEF0dHJpYnV0ZSggImNoZWNrZWQiLCAiY2hlY2tlZCIgKTsKCWlucHV0LnNldEF0dHJpYnV0ZSggIm5hbWUiLCAidCIgKTsKCglkaXYuYXBwZW5kQ2hpbGQoIGlucHV0ICk7CgoJLy8gU3VwcG9ydDogU2FmYXJpPD01LjEsIEFuZHJvaWQ8NC4yCgkvLyBPbGRlciBXZWJLaXQgZG9lc24ndCBjbG9uZSBjaGVja2VkIHN0YXRlIGNvcnJlY3RseSBpbiBmcmFnbWVudHMKCXN1cHBvcnQuY2hlY2tDbG9uZSA9IGRpdi5jbG9uZU5vZGUoIHRydWUgKS5jbG9uZU5vZGUoIHRydWUgKS5sYXN0Q2hpbGQuY2hlY2tlZDsKCgkvLyBTdXBwb3J0OiBJRTw9MTErCgkvLyBNYWtlIHN1cmUgdGV4dGFyZWEgKGFuZCBjaGVja2JveCkgZGVmYXVsdFZhbHVlIGlzIHByb3Blcmx5IGNsb25lZAoJZGl2LmlubmVySFRNTCA9ICI8dGV4dGFyZWE+eDwvdGV4dGFyZWE+IjsKCXN1cHBvcnQubm9DbG9uZUNoZWNrZWQgPSAhIWRpdi5jbG9uZU5vZGUoIHRydWUgKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlOwp9ICkoKTsKCgp2YXIKCXJrZXlFdmVudCA9IC9ea2V5LywKCXJtb3VzZUV2ZW50ID0gL14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51fGRyYWd8ZHJvcCl8Y2xpY2svLAoJcnR5cGVuYW1lc3BhY2UgPSAvXihbXi5dKikoPzpcLiguKyl8KS87CgpmdW5jdGlvbiByZXR1cm5UcnVlKCkgewoJcmV0dXJuIHRydWU7Cn0KCmZ1bmN0aW9uIHJldHVybkZhbHNlKCkgewoJcmV0dXJuIGZhbHNlOwp9CgovLyBTdXBwb3J0OiBJRTkKLy8gU2VlICMxMzM5MyBmb3IgbW9yZSBpbmZvCmZ1bmN0aW9uIHNhZmVBY3RpdmVFbGVtZW50KCkgewoJdHJ5IHsKCQlyZXR1cm4gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDsKCX0gY2F0Y2ggKCBlcnIgKSB7IH0KfQoKZnVuY3Rpb24gb24oIGVsZW0sIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4sIG9uZSApIHsKCXZhciBvcmlnRm4sIHR5cGU7CgoJLy8gVHlwZXMgY2FuIGJlIGEgbWFwIG9mIHR5cGVzL2hhbmRsZXJzCglpZiAoIHR5cGVvZiB0eXBlcyA9PT0gIm9iamVjdCIgKSB7CgoJCS8vICggdHlwZXMtT2JqZWN0LCBzZWxlY3RvciwgZGF0YSApCgkJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgIT09ICJzdHJpbmciICkgewoKCQkJLy8gKCB0eXBlcy1PYmplY3QsIGRhdGEgKQoJCQlkYXRhID0gZGF0YSB8fCBzZWxlY3RvcjsKCQkJc2VsZWN0b3IgPSB1bmRlZmluZWQ7CgkJfQoJCWZvciAoIHR5cGUgaW4gdHlwZXMgKSB7CgkJCW9uKCBlbGVtLCB0eXBlLCBzZWxlY3RvciwgZGF0YSwgdHlwZXNbIHR5cGUgXSwgb25lICk7CgkJfQoJCXJldHVybiBlbGVtOwoJfQoKCWlmICggZGF0YSA9PSBudWxsICYmIGZuID09IG51bGwgKSB7CgoJCS8vICggdHlwZXMsIGZuICkKCQlmbiA9IHNlbGVjdG9yOwoJCWRhdGEgPSBzZWxlY3RvciA9IHVuZGVmaW5lZDsKCX0gZWxzZSBpZiAoIGZuID09IG51bGwgKSB7CgkJaWYgKCB0eXBlb2Ygc2VsZWN0b3IgPT09ICJzdHJpbmciICkgewoKCQkJLy8gKCB0eXBlcywgc2VsZWN0b3IsIGZuICkKCQkJZm4gPSBkYXRhOwoJCQlkYXRhID0gdW5kZWZpbmVkOwoJCX0gZWxzZSB7CgoJCQkvLyAoIHR5cGVzLCBkYXRhLCBmbiApCgkJCWZuID0gZGF0YTsKCQkJZGF0YSA9IHNlbGVjdG9yOwoJCQlzZWxlY3RvciA9IHVuZGVmaW5lZDsKCQl9Cgl9CglpZiAoIGZuID09PSBmYWxzZSApIHsKCQlmbiA9IHJldHVybkZhbHNlOwoJfSBlbHNlIGlmICggIWZuICkgewoJCXJldHVybiBlbGVtOwoJfQoKCWlmICggb25lID09PSAxICkgewoJCW9yaWdGbiA9IGZuOwoJCWZuID0gZnVuY3Rpb24oIGV2ZW50ICkgewoKCQkJLy8gQ2FuIHVzZSBhbiBlbXB0eSBzZXQsIHNpbmNlIGV2ZW50IGNvbnRhaW5zIHRoZSBpbmZvCgkJCWpRdWVyeSgpLm9mZiggZXZlbnQgKTsKCQkJcmV0dXJuIG9yaWdGbi5hcHBseSggdGhpcywgYXJndW1lbnRzICk7CgkJfTsKCgkJLy8gVXNlIHNhbWUgZ3VpZCBzbyBjYWxsZXIgY2FuIHJlbW92ZSB1c2luZyBvcmlnRm4KCQlmbi5ndWlkID0gb3JpZ0ZuLmd1aWQgfHwgKCBvcmlnRm4uZ3VpZCA9IGpRdWVyeS5ndWlkKysgKTsKCX0KCXJldHVybiBlbGVtLmVhY2goIGZ1bmN0aW9uKCkgewoJCWpRdWVyeS5ldmVudC5hZGQoIHRoaXMsIHR5cGVzLCBmbiwgZGF0YSwgc2VsZWN0b3IgKTsKCX0gKTsKfQoKLyoKICogSGVscGVyIGZ1bmN0aW9ucyBmb3IgbWFuYWdpbmcgZXZlbnRzIC0tIG5vdCBwYXJ0IG9mIHRoZSBwdWJsaWMgaW50ZXJmYWNlLgogKiBQcm9wcyB0byBEZWFuIEVkd2FyZHMnIGFkZEV2ZW50IGxpYnJhcnkgZm9yIG1hbnkgb2YgdGhlIGlkZWFzLgogKi8KalF1ZXJ5LmV2ZW50ID0gewoKCWdsb2JhbDoge30sCgoJYWRkOiBmdW5jdGlvbiggZWxlbSwgdHlwZXMsIGhhbmRsZXIsIGRhdGEsIHNlbGVjdG9yICkgewoKCQl2YXIgaGFuZGxlT2JqSW4sIGV2ZW50SGFuZGxlLCB0bXAsCgkJCWV2ZW50cywgdCwgaGFuZGxlT2JqLAoJCQlzcGVjaWFsLCBoYW5kbGVycywgdHlwZSwgbmFtZXNwYWNlcywgb3JpZ1R5cGUsCgkJCWVsZW1EYXRhID0gZGF0YVByaXYuZ2V0KCBlbGVtICk7CgoJCS8vIERvbid0IGF0dGFjaCBldmVudHMgdG8gbm9EYXRhIG9yIHRleHQvY29tbWVudCBub2RlcyAoYnV0IGFsbG93IHBsYWluIG9iamVjdHMpCgkJaWYgKCAhZWxlbURhdGEgKSB7CgkJCXJldHVybjsKCQl9CgoJCS8vIENhbGxlciBjYW4gcGFzcyBpbiBhbiBvYmplY3Qgb2YgY3VzdG9tIGRhdGEgaW4gbGlldSBvZiB0aGUgaGFuZGxlcgoJCWlmICggaGFuZGxlci5oYW5kbGVyICkgewoJCQloYW5kbGVPYmpJbiA9IGhhbmRsZXI7CgkJCWhhbmRsZXIgPSBoYW5kbGVPYmpJbi5oYW5kbGVyOwoJCQlzZWxlY3RvciA9IGhhbmRsZU9iakluLnNlbGVjdG9yOwoJCX0KCgkJLy8gTWFrZSBzdXJlIHRoYXQgdGhlIGhhbmRsZXIgaGFzIGEgdW5pcXVlIElELCB1c2VkIHRvIGZpbmQvcmVtb3ZlIGl0IGxhdGVyCgkJaWYgKCAhaGFuZGxlci5ndWlkICkgewoJCQloYW5kbGVyLmd1aWQgPSBqUXVlcnkuZ3VpZCsrOwoJCX0KCgkJLy8gSW5pdCB0aGUgZWxlbWVudCdzIGV2ZW50IHN0cnVjdHVyZSBhbmQgbWFpbiBoYW5kbGVyLCBpZiB0aGlzIGlzIHRoZSBmaXJzdAoJCWlmICggISggZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzICkgKSB7CgkJCWV2ZW50cyA9IGVsZW1EYXRhLmV2ZW50cyA9IHt9OwoJCX0KCQlpZiAoICEoIGV2ZW50SGFuZGxlID0gZWxlbURhdGEuaGFuZGxlICkgKSB7CgkJCWV2ZW50SGFuZGxlID0gZWxlbURhdGEuaGFuZGxlID0gZnVuY3Rpb24oIGUgKSB7CgoJCQkJLy8gRGlzY2FyZCB0aGUgc2Vjb25kIGV2ZW50IG9mIGEgalF1ZXJ5LmV2ZW50LnRyaWdnZXIoKSBhbmQKCQkJCS8vIHdoZW4gYW4gZXZlbnQgaXMgY2FsbGVkIGFmdGVyIGEgcGFnZSBoYXMgdW5sb2FkZWQKCQkJCXJldHVybiB0eXBlb2YgalF1ZXJ5ICE9PSAidW5kZWZpbmVkIiAmJiBqUXVlcnkuZXZlbnQudHJpZ2dlcmVkICE9PSBlLnR5cGUgPwoJCQkJCWpRdWVyeS5ldmVudC5kaXNwYXRjaC5hcHBseSggZWxlbSwgYXJndW1lbnRzICkgOiB1bmRlZmluZWQ7CgkJCX07CgkJfQoKCQkvLyBIYW5kbGUgbXVsdGlwbGUgZXZlbnRzIHNlcGFyYXRlZCBieSBhIHNwYWNlCgkJdHlwZXMgPSAoIHR5cGVzIHx8ICIiICkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFsgIiIgXTsKCQl0ID0gdHlwZXMubGVuZ3RoOwoJCXdoaWxlICggdC0tICkgewoJCQl0bXAgPSBydHlwZW5hbWVzcGFjZS5leGVjKCB0eXBlc1sgdCBdICkgfHwgW107CgkJCXR5cGUgPSBvcmlnVHlwZSA9IHRtcFsgMSBdOwoJCQluYW1lc3BhY2VzID0gKCB0bXBbIDIgXSB8fCAiIiApLnNwbGl0KCAiLiIgKS5zb3J0KCk7CgoJCQkvLyBUaGVyZSAqbXVzdCogYmUgYSB0eXBlLCBubyBhdHRhY2hpbmcgbmFtZXNwYWNlLW9ubHkgaGFuZGxlcnMKCQkJaWYgKCAhdHlwZSApIHsKCQkJCWNvbnRpbnVlOwoJCQl9CgoJCQkvLyBJZiBldmVudCBjaGFuZ2VzIGl0cyB0eXBlLCB1c2UgdGhlIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMgZm9yIHRoZSBjaGFuZ2VkIHR5cGUKCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgoJCQkvLyBJZiBzZWxlY3RvciBkZWZpbmVkLCBkZXRlcm1pbmUgc3BlY2lhbCBldmVudCBhcGkgdHlwZSwgb3RoZXJ3aXNlIGdpdmVuIHR5cGUKCQkJdHlwZSA9ICggc2VsZWN0b3IgPyBzcGVjaWFsLmRlbGVnYXRlVHlwZSA6IHNwZWNpYWwuYmluZFR5cGUgKSB8fCB0eXBlOwoKCQkJLy8gVXBkYXRlIHNwZWNpYWwgYmFzZWQgb24gbmV3bHkgcmVzZXQgdHlwZQoJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIHR5cGUgXSB8fCB7fTsKCgkJCS8vIGhhbmRsZU9iaiBpcyBwYXNzZWQgdG8gYWxsIGV2ZW50IGhhbmRsZXJzCgkJCWhhbmRsZU9iaiA9IGpRdWVyeS5leHRlbmQoIHsKCQkJCXR5cGU6IHR5cGUsCgkJCQlvcmlnVHlwZTogb3JpZ1R5cGUsCgkJCQlkYXRhOiBkYXRhLAoJCQkJaGFuZGxlcjogaGFuZGxlciwKCQkJCWd1aWQ6IGhhbmRsZXIuZ3VpZCwKCQkJCXNlbGVjdG9yOiBzZWxlY3RvciwKCQkJCW5lZWRzQ29udGV4dDogc2VsZWN0b3IgJiYgalF1ZXJ5LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3QoIHNlbGVjdG9yICksCgkJCQluYW1lc3BhY2U6IG5hbWVzcGFjZXMuam9pbiggIi4iICkKCQkJfSwgaGFuZGxlT2JqSW4gKTsKCgkJCS8vIEluaXQgdGhlIGV2ZW50IGhhbmRsZXIgcXVldWUgaWYgd2UncmUgdGhlIGZpcnN0CgkJCWlmICggISggaGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSApICkgewoJCQkJaGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSA9IFtdOwoJCQkJaGFuZGxlcnMuZGVsZWdhdGVDb3VudCA9IDA7CgoJCQkJLy8gT25seSB1c2UgYWRkRXZlbnRMaXN0ZW5lciBpZiB0aGUgc3BlY2lhbCBldmVudHMgaGFuZGxlciByZXR1cm5zIGZhbHNlCgkJCQlpZiAoICFzcGVjaWFsLnNldHVwIHx8CgkJCQkJc3BlY2lhbC5zZXR1cC5jYWxsKCBlbGVtLCBkYXRhLCBuYW1lc3BhY2VzLCBldmVudEhhbmRsZSApID09PSBmYWxzZSApIHsKCgkJCQkJaWYgKCBlbGVtLmFkZEV2ZW50TGlzdGVuZXIgKSB7CgkJCQkJCWVsZW0uYWRkRXZlbnRMaXN0ZW5lciggdHlwZSwgZXZlbnRIYW5kbGUgKTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCWlmICggc3BlY2lhbC5hZGQgKSB7CgkJCQlzcGVjaWFsLmFkZC5jYWxsKCBlbGVtLCBoYW5kbGVPYmogKTsKCgkJCQlpZiAoICFoYW5kbGVPYmouaGFuZGxlci5ndWlkICkgewoJCQkJCWhhbmRsZU9iai5oYW5kbGVyLmd1aWQgPSBoYW5kbGVyLmd1aWQ7CgkJCQl9CgkJCX0KCgkJCS8vIEFkZCB0byB0aGUgZWxlbWVudCdzIGhhbmRsZXIgbGlzdCwgZGVsZWdhdGVzIGluIGZyb250CgkJCWlmICggc2VsZWN0b3IgKSB7CgkJCQloYW5kbGVycy5zcGxpY2UoIGhhbmRsZXJzLmRlbGVnYXRlQ291bnQrKywgMCwgaGFuZGxlT2JqICk7CgkJCX0gZWxzZSB7CgkJCQloYW5kbGVycy5wdXNoKCBoYW5kbGVPYmogKTsKCQkJfQoKCQkJLy8gS2VlcCB0cmFjayBvZiB3aGljaCBldmVudHMgaGF2ZSBldmVyIGJlZW4gdXNlZCwgZm9yIGV2ZW50IG9wdGltaXphdGlvbgoJCQlqUXVlcnkuZXZlbnQuZ2xvYmFsWyB0eXBlIF0gPSB0cnVlOwoJCX0KCgl9LAoKCS8vIERldGFjaCBhbiBldmVudCBvciBzZXQgb2YgZXZlbnRzIGZyb20gYW4gZWxlbWVudAoJcmVtb3ZlOiBmdW5jdGlvbiggZWxlbSwgdHlwZXMsIGhhbmRsZXIsIHNlbGVjdG9yLCBtYXBwZWRUeXBlcyApIHsKCgkJdmFyIGosIG9yaWdDb3VudCwgdG1wLAoJCQlldmVudHMsIHQsIGhhbmRsZU9iaiwKCQkJc3BlY2lhbCwgaGFuZGxlcnMsIHR5cGUsIG5hbWVzcGFjZXMsIG9yaWdUeXBlLAoJCQllbGVtRGF0YSA9IGRhdGFQcml2Lmhhc0RhdGEoIGVsZW0gKSAmJiBkYXRhUHJpdi5nZXQoIGVsZW0gKTsKCgkJaWYgKCAhZWxlbURhdGEgfHwgISggZXZlbnRzID0gZWxlbURhdGEuZXZlbnRzICkgKSB7CgkJCXJldHVybjsKCQl9CgoJCS8vIE9uY2UgZm9yIGVhY2ggdHlwZS5uYW1lc3BhY2UgaW4gdHlwZXM7IHR5cGUgbWF5IGJlIG9taXR0ZWQKCQl0eXBlcyA9ICggdHlwZXMgfHwgIiIgKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgWyAiIiBdOwoJCXQgPSB0eXBlcy5sZW5ndGg7CgkJd2hpbGUgKCB0LS0gKSB7CgkJCXRtcCA9IHJ0eXBlbmFtZXNwYWNlLmV4ZWMoIHR5cGVzWyB0IF0gKSB8fCBbXTsKCQkJdHlwZSA9IG9yaWdUeXBlID0gdG1wWyAxIF07CgkJCW5hbWVzcGFjZXMgPSAoIHRtcFsgMiBdIHx8ICIiICkuc3BsaXQoICIuIiApLnNvcnQoKTsKCgkJCS8vIFVuYmluZCBhbGwgZXZlbnRzIChvbiB0aGlzIG5hbWVzcGFjZSwgaWYgcHJvdmlkZWQpIGZvciB0aGUgZWxlbWVudAoJCQlpZiAoICF0eXBlICkgewoJCQkJZm9yICggdHlwZSBpbiBldmVudHMgKSB7CgkJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggZWxlbSwgdHlwZSArIHR5cGVzWyB0IF0sIGhhbmRsZXIsIHNlbGVjdG9yLCB0cnVlICk7CgkJCQl9CgkJCQljb250aW51ZTsKCQkJfQoKCQkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgkJCXR5cGUgPSAoIHNlbGVjdG9yID8gc3BlY2lhbC5kZWxlZ2F0ZVR5cGUgOiBzcGVjaWFsLmJpbmRUeXBlICkgfHwgdHlwZTsKCQkJaGFuZGxlcnMgPSBldmVudHNbIHR5cGUgXSB8fCBbXTsKCQkJdG1wID0gdG1wWyAyIF0gJiYKCQkJCW5ldyBSZWdFeHAoICIoXnxcXC4pIiArIG5hbWVzcGFjZXMuam9pbiggIlxcLig/Oi4qXFwufCkiICkgKyAiKFxcLnwkKSIgKTsKCgkJCS8vIFJlbW92ZSBtYXRjaGluZyBldmVudHMKCQkJb3JpZ0NvdW50ID0gaiA9IGhhbmRsZXJzLmxlbmd0aDsKCQkJd2hpbGUgKCBqLS0gKSB7CgkJCQloYW5kbGVPYmogPSBoYW5kbGVyc1sgaiBdOwoKCQkJCWlmICggKCBtYXBwZWRUeXBlcyB8fCBvcmlnVHlwZSA9PT0gaGFuZGxlT2JqLm9yaWdUeXBlICkgJiYKCQkJCQkoICFoYW5kbGVyIHx8IGhhbmRsZXIuZ3VpZCA9PT0gaGFuZGxlT2JqLmd1aWQgKSAmJgoJCQkJCSggIXRtcCB8fCB0bXAudGVzdCggaGFuZGxlT2JqLm5hbWVzcGFjZSApICkgJiYKCQkJCQkoICFzZWxlY3RvciB8fCBzZWxlY3RvciA9PT0gaGFuZGxlT2JqLnNlbGVjdG9yIHx8CgkJCQkJCXNlbGVjdG9yID09PSAiKioiICYmIGhhbmRsZU9iai5zZWxlY3RvciApICkgewoJCQkJCWhhbmRsZXJzLnNwbGljZSggaiwgMSApOwoKCQkJCQlpZiAoIGhhbmRsZU9iai5zZWxlY3RvciApIHsKCQkJCQkJaGFuZGxlcnMuZGVsZWdhdGVDb3VudC0tOwoJCQkJCX0KCQkJCQlpZiAoIHNwZWNpYWwucmVtb3ZlICkgewoJCQkJCQlzcGVjaWFsLnJlbW92ZS5jYWxsKCBlbGVtLCBoYW5kbGVPYmogKTsKCQkJCQl9CgkJCQl9CgkJCX0KCgkJCS8vIFJlbW92ZSBnZW5lcmljIGV2ZW50IGhhbmRsZXIgaWYgd2UgcmVtb3ZlZCBzb21ldGhpbmcgYW5kIG5vIG1vcmUgaGFuZGxlcnMgZXhpc3QKCQkJLy8gKGF2b2lkcyBwb3RlbnRpYWwgZm9yIGVuZGxlc3MgcmVjdXJzaW9uIGR1cmluZyByZW1vdmFsIG9mIHNwZWNpYWwgZXZlbnQgaGFuZGxlcnMpCgkJCWlmICggb3JpZ0NvdW50ICYmICFoYW5kbGVycy5sZW5ndGggKSB7CgkJCQlpZiAoICFzcGVjaWFsLnRlYXJkb3duIHx8CgkJCQkJc3BlY2lhbC50ZWFyZG93bi5jYWxsKCBlbGVtLCBuYW1lc3BhY2VzLCBlbGVtRGF0YS5oYW5kbGUgKSA9PT0gZmFsc2UgKSB7CgoJCQkJCWpRdWVyeS5yZW1vdmVFdmVudCggZWxlbSwgdHlwZSwgZWxlbURhdGEuaGFuZGxlICk7CgkJCQl9CgoJCQkJZGVsZXRlIGV2ZW50c1sgdHlwZSBdOwoJCQl9CgkJfQoKCQkvLyBSZW1vdmUgZGF0YSBhbmQgdGhlIGV4cGFuZG8gaWYgaXQncyBubyBsb25nZXIgdXNlZAoJCWlmICggalF1ZXJ5LmlzRW1wdHlPYmplY3QoIGV2ZW50cyApICkgewoJCQlkYXRhUHJpdi5yZW1vdmUoIGVsZW0sICJoYW5kbGUgZXZlbnRzIiApOwoJCX0KCX0sCgoJZGlzcGF0Y2g6IGZ1bmN0aW9uKCBldmVudCApIHsKCgkJLy8gTWFrZSBhIHdyaXRhYmxlIGpRdWVyeS5FdmVudCBmcm9tIHRoZSBuYXRpdmUgZXZlbnQgb2JqZWN0CgkJZXZlbnQgPSBqUXVlcnkuZXZlbnQuZml4KCBldmVudCApOwoKCQl2YXIgaSwgaiwgcmV0LCBtYXRjaGVkLCBoYW5kbGVPYmosCgkJCWhhbmRsZXJRdWV1ZSA9IFtdLAoJCQlhcmdzID0gc2xpY2UuY2FsbCggYXJndW1lbnRzICksCgkJCWhhbmRsZXJzID0gKCBkYXRhUHJpdi5nZXQoIHRoaXMsICJldmVudHMiICkgfHwge30gKVsgZXZlbnQudHlwZSBdIHx8IFtdLAoJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGV2ZW50LnR5cGUgXSB8fCB7fTsKCgkJLy8gVXNlIHRoZSBmaXgtZWQgalF1ZXJ5LkV2ZW50IHJhdGhlciB0aGFuIHRoZSAocmVhZC1vbmx5KSBuYXRpdmUgZXZlbnQKCQlhcmdzWyAwIF0gPSBldmVudDsKCQlldmVudC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXM7CgoJCS8vIENhbGwgdGhlIHByZURpc3BhdGNoIGhvb2sgZm9yIHRoZSBtYXBwZWQgdHlwZSwgYW5kIGxldCBpdCBiYWlsIGlmIGRlc2lyZWQKCQlpZiAoIHNwZWNpYWwucHJlRGlzcGF0Y2ggJiYgc3BlY2lhbC5wcmVEaXNwYXRjaC5jYWxsKCB0aGlzLCBldmVudCApID09PSBmYWxzZSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJLy8gRGV0ZXJtaW5lIGhhbmRsZXJzCgkJaGFuZGxlclF1ZXVlID0galF1ZXJ5LmV2ZW50LmhhbmRsZXJzLmNhbGwoIHRoaXMsIGV2ZW50LCBoYW5kbGVycyApOwoKCQkvLyBSdW4gZGVsZWdhdGVzIGZpcnN0OyB0aGV5IG1heSB3YW50IHRvIHN0b3AgcHJvcGFnYXRpb24gYmVuZWF0aCB1cwoJCWkgPSAwOwoJCXdoaWxlICggKCBtYXRjaGVkID0gaGFuZGxlclF1ZXVlWyBpKysgXSApICYmICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkgewoJCQlldmVudC5jdXJyZW50VGFyZ2V0ID0gbWF0Y2hlZC5lbGVtOwoKCQkJaiA9IDA7CgkJCXdoaWxlICggKCBoYW5kbGVPYmogPSBtYXRjaGVkLmhhbmRsZXJzWyBqKysgXSApICYmCgkJCQkhZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKSApIHsKCgkJCQkvLyBUcmlnZ2VyZWQgZXZlbnQgbXVzdCBlaXRoZXIgMSkgaGF2ZSBubyBuYW1lc3BhY2UsIG9yIDIpIGhhdmUgbmFtZXNwYWNlKHMpCgkJCQkvLyBhIHN1YnNldCBvciBlcXVhbCB0byB0aG9zZSBpbiB0aGUgYm91bmQgZXZlbnQgKGJvdGggY2FuIGhhdmUgbm8gbmFtZXNwYWNlKS4KCQkJCWlmICggIWV2ZW50LnJuYW1lc3BhY2UgfHwgZXZlbnQucm5hbWVzcGFjZS50ZXN0KCBoYW5kbGVPYmoubmFtZXNwYWNlICkgKSB7CgoJCQkJCWV2ZW50LmhhbmRsZU9iaiA9IGhhbmRsZU9iajsKCQkJCQlldmVudC5kYXRhID0gaGFuZGxlT2JqLmRhdGE7CgoJCQkJCXJldCA9ICggKCBqUXVlcnkuZXZlbnQuc3BlY2lhbFsgaGFuZGxlT2JqLm9yaWdUeXBlIF0gfHwge30gKS5oYW5kbGUgfHwKCQkJCQkJaGFuZGxlT2JqLmhhbmRsZXIgKS5hcHBseSggbWF0Y2hlZC5lbGVtLCBhcmdzICk7CgoJCQkJCWlmICggcmV0ICE9PSB1bmRlZmluZWQgKSB7CgkJCQkJCWlmICggKCBldmVudC5yZXN1bHQgPSByZXQgKSA9PT0gZmFsc2UgKSB7CgkJCQkJCQlldmVudC5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQkJZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCS8vIENhbGwgdGhlIHBvc3REaXNwYXRjaCBob29rIGZvciB0aGUgbWFwcGVkIHR5cGUKCQlpZiAoIHNwZWNpYWwucG9zdERpc3BhdGNoICkgewoJCQlzcGVjaWFsLnBvc3REaXNwYXRjaC5jYWxsKCB0aGlzLCBldmVudCApOwoJCX0KCgkJcmV0dXJuIGV2ZW50LnJlc3VsdDsKCX0sCgoJaGFuZGxlcnM6IGZ1bmN0aW9uKCBldmVudCwgaGFuZGxlcnMgKSB7CgkJdmFyIGksIG1hdGNoZXMsIHNlbCwgaGFuZGxlT2JqLAoJCQloYW5kbGVyUXVldWUgPSBbXSwKCQkJZGVsZWdhdGVDb3VudCA9IGhhbmRsZXJzLmRlbGVnYXRlQ291bnQsCgkJCWN1ciA9IGV2ZW50LnRhcmdldDsKCgkJLy8gU3VwcG9ydCAoYXQgbGVhc3QpOiBDaHJvbWUsIElFOQoJCS8vIEZpbmQgZGVsZWdhdGUgaGFuZGxlcnMKCQkvLyBCbGFjay1ob2xlIFNWRyA8dXNlPiBpbnN0YW5jZSB0cmVlcyAoIzEzMTgwKQoJCS8vCgkJLy8gU3VwcG9ydDogRmlyZWZveDw9NDIrCgkJLy8gQXZvaWQgbm9uLWxlZnQtY2xpY2sgaW4gRkYgYnV0IGRvbid0IGJsb2NrIElFIHJhZGlvIGV2ZW50cyAoIzM4NjEsIGdoLTIzNDMpCgkJaWYgKCBkZWxlZ2F0ZUNvdW50ICYmIGN1ci5ub2RlVHlwZSAmJgoJCQkoIGV2ZW50LnR5cGUgIT09ICJjbGljayIgfHwgaXNOYU4oIGV2ZW50LmJ1dHRvbiApIHx8IGV2ZW50LmJ1dHRvbiA8IDEgKSApIHsKCgkJCWZvciAoIDsgY3VyICE9PSB0aGlzOyBjdXIgPSBjdXIucGFyZW50Tm9kZSB8fCB0aGlzICkgewoKCQkJCS8vIERvbid0IGNoZWNrIG5vbi1lbGVtZW50cyAoIzEzMjA4KQoJCQkJLy8gRG9uJ3QgcHJvY2VzcyBjbGlja3Mgb24gZGlzYWJsZWQgZWxlbWVudHMgKCM2OTExLCAjODE2NSwgIzExMzgyLCAjMTE3NjQpCgkJCQlpZiAoIGN1ci5ub2RlVHlwZSA9PT0gMSAmJiAoIGN1ci5kaXNhYmxlZCAhPT0gdHJ1ZSB8fCBldmVudC50eXBlICE9PSAiY2xpY2siICkgKSB7CgkJCQkJbWF0Y2hlcyA9IFtdOwoJCQkJCWZvciAoIGkgPSAwOyBpIDwgZGVsZWdhdGVDb3VudDsgaSsrICkgewoJCQkJCQloYW5kbGVPYmogPSBoYW5kbGVyc1sgaSBdOwoKCQkJCQkJLy8gRG9uJ3QgY29uZmxpY3Qgd2l0aCBPYmplY3QucHJvdG90eXBlIHByb3BlcnRpZXMgKCMxMzIwMykKCQkJCQkJc2VsID0gaGFuZGxlT2JqLnNlbGVjdG9yICsgIiAiOwoKCQkJCQkJaWYgKCBtYXRjaGVzWyBzZWwgXSA9PT0gdW5kZWZpbmVkICkgewoJCQkJCQkJbWF0Y2hlc1sgc2VsIF0gPSBoYW5kbGVPYmoubmVlZHNDb250ZXh0ID8KCQkJCQkJCQlqUXVlcnkoIHNlbCwgdGhpcyApLmluZGV4KCBjdXIgKSA+IC0xIDoKCQkJCQkJCQlqUXVlcnkuZmluZCggc2VsLCB0aGlzLCBudWxsLCBbIGN1ciBdICkubGVuZ3RoOwoJCQkJCQl9CgkJCQkJCWlmICggbWF0Y2hlc1sgc2VsIF0gKSB7CgkJCQkJCQltYXRjaGVzLnB1c2goIGhhbmRsZU9iaiApOwoJCQkJCQl9CgkJCQkJfQoJCQkJCWlmICggbWF0Y2hlcy5sZW5ndGggKSB7CgkJCQkJCWhhbmRsZXJRdWV1ZS5wdXNoKCB7IGVsZW06IGN1ciwgaGFuZGxlcnM6IG1hdGNoZXMgfSApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJLy8gQWRkIHRoZSByZW1haW5pbmcgKGRpcmVjdGx5LWJvdW5kKSBoYW5kbGVycwoJCWlmICggZGVsZWdhdGVDb3VudCA8IGhhbmRsZXJzLmxlbmd0aCApIHsKCQkJaGFuZGxlclF1ZXVlLnB1c2goIHsgZWxlbTogdGhpcywgaGFuZGxlcnM6IGhhbmRsZXJzLnNsaWNlKCBkZWxlZ2F0ZUNvdW50ICkgfSApOwoJCX0KCgkJcmV0dXJuIGhhbmRsZXJRdWV1ZTsKCX0sCgoJLy8gSW5jbHVkZXMgc29tZSBldmVudCBwcm9wcyBzaGFyZWQgYnkgS2V5RXZlbnQgYW5kIE1vdXNlRXZlbnQKCXByb3BzOiAoICJhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBkZXRhaWwgZXZlbnRQaGFzZSAiICsKCQkibWV0YUtleSByZWxhdGVkVGFyZ2V0IHNoaWZ0S2V5IHRhcmdldCB0aW1lU3RhbXAgdmlldyB3aGljaCIgKS5zcGxpdCggIiAiICksCgoJZml4SG9va3M6IHt9LAoKCWtleUhvb2tzOiB7CgkJcHJvcHM6ICJjaGFyIGNoYXJDb2RlIGtleSBrZXlDb2RlIi5zcGxpdCggIiAiICksCgkJZmlsdGVyOiBmdW5jdGlvbiggZXZlbnQsIG9yaWdpbmFsICkgewoKCQkJLy8gQWRkIHdoaWNoIGZvciBrZXkgZXZlbnRzCgkJCWlmICggZXZlbnQud2hpY2ggPT0gbnVsbCApIHsKCQkJCWV2ZW50LndoaWNoID0gb3JpZ2luYWwuY2hhckNvZGUgIT0gbnVsbCA/IG9yaWdpbmFsLmNoYXJDb2RlIDogb3JpZ2luYWwua2V5Q29kZTsKCQkJfQoKCQkJcmV0dXJuIGV2ZW50OwoJCX0KCX0sCgoJbW91c2VIb29rczogewoJCXByb3BzOiAoICJidXR0b24gYnV0dG9ucyBjbGllbnRYIGNsaWVudFkgb2Zmc2V0WCBvZmZzZXRZIHBhZ2VYIHBhZ2VZICIgKwoJCQkic2NyZWVuWCBzY3JlZW5ZIHRvRWxlbWVudCIgKS5zcGxpdCggIiAiICksCgkJZmlsdGVyOiBmdW5jdGlvbiggZXZlbnQsIG9yaWdpbmFsICkgewoJCQl2YXIgZXZlbnREb2MsIGRvYywgYm9keSwKCQkJCWJ1dHRvbiA9IG9yaWdpbmFsLmJ1dHRvbjsKCgkJCS8vIENhbGN1bGF0ZSBwYWdlWC9ZIGlmIG1pc3NpbmcgYW5kIGNsaWVudFgvWSBhdmFpbGFibGUKCQkJaWYgKCBldmVudC5wYWdlWCA9PSBudWxsICYmIG9yaWdpbmFsLmNsaWVudFggIT0gbnVsbCApIHsKCQkJCWV2ZW50RG9jID0gZXZlbnQudGFyZ2V0Lm93bmVyRG9jdW1lbnQgfHwgZG9jdW1lbnQ7CgkJCQlkb2MgPSBldmVudERvYy5kb2N1bWVudEVsZW1lbnQ7CgkJCQlib2R5ID0gZXZlbnREb2MuYm9keTsKCgkJCQlldmVudC5wYWdlWCA9IG9yaWdpbmFsLmNsaWVudFggKwoJCQkJCSggZG9jICYmIGRvYy5zY3JvbGxMZWZ0IHx8IGJvZHkgJiYgYm9keS5zY3JvbGxMZWZ0IHx8IDAgKSAtCgkJCQkJKCBkb2MgJiYgZG9jLmNsaWVudExlZnQgfHwgYm9keSAmJiBib2R5LmNsaWVudExlZnQgfHwgMCApOwoJCQkJZXZlbnQucGFnZVkgPSBvcmlnaW5hbC5jbGllbnRZICsKCQkJCQkoIGRvYyAmJiBkb2Muc2Nyb2xsVG9wICB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsVG9wICB8fCAwICkgLQoJCQkJCSggZG9jICYmIGRvYy5jbGllbnRUb3AgIHx8IGJvZHkgJiYgYm9keS5jbGllbnRUb3AgIHx8IDAgKTsKCQkJfQoKCQkJLy8gQWRkIHdoaWNoIGZvciBjbGljazogMSA9PT0gbGVmdDsgMiA9PT0gbWlkZGxlOyAzID09PSByaWdodAoJCQkvLyBOb3RlOiBidXR0b24gaXMgbm90IG5vcm1hbGl6ZWQsIHNvIGRvbid0IHVzZSBpdAoJCQlpZiAoICFldmVudC53aGljaCAmJiBidXR0b24gIT09IHVuZGVmaW5lZCApIHsKCQkJCWV2ZW50LndoaWNoID0gKCBidXR0b24gJiAxID8gMSA6ICggYnV0dG9uICYgMiA/IDMgOiAoIGJ1dHRvbiAmIDQgPyAyIDogMCApICkgKTsKCQkJfQoKCQkJcmV0dXJuIGV2ZW50OwoJCX0KCX0sCgoJZml4OiBmdW5jdGlvbiggZXZlbnQgKSB7CgkJaWYgKCBldmVudFsgalF1ZXJ5LmV4cGFuZG8gXSApIHsKCQkJcmV0dXJuIGV2ZW50OwoJCX0KCgkJLy8gQ3JlYXRlIGEgd3JpdGFibGUgY29weSBvZiB0aGUgZXZlbnQgb2JqZWN0IGFuZCBub3JtYWxpemUgc29tZSBwcm9wZXJ0aWVzCgkJdmFyIGksIHByb3AsIGNvcHksCgkJCXR5cGUgPSBldmVudC50eXBlLAoJCQlvcmlnaW5hbEV2ZW50ID0gZXZlbnQsCgkJCWZpeEhvb2sgPSB0aGlzLmZpeEhvb2tzWyB0eXBlIF07CgoJCWlmICggIWZpeEhvb2sgKSB7CgkJCXRoaXMuZml4SG9va3NbIHR5cGUgXSA9IGZpeEhvb2sgPQoJCQkJcm1vdXNlRXZlbnQudGVzdCggdHlwZSApID8gdGhpcy5tb3VzZUhvb2tzIDoKCQkJCXJrZXlFdmVudC50ZXN0KCB0eXBlICkgPyB0aGlzLmtleUhvb2tzIDoKCQkJCXt9OwoJCX0KCQljb3B5ID0gZml4SG9vay5wcm9wcyA/IHRoaXMucHJvcHMuY29uY2F0KCBmaXhIb29rLnByb3BzICkgOiB0aGlzLnByb3BzOwoKCQlldmVudCA9IG5ldyBqUXVlcnkuRXZlbnQoIG9yaWdpbmFsRXZlbnQgKTsKCgkJaSA9IGNvcHkubGVuZ3RoOwoJCXdoaWxlICggaS0tICkgewoJCQlwcm9wID0gY29weVsgaSBdOwoJCQlldmVudFsgcHJvcCBdID0gb3JpZ2luYWxFdmVudFsgcHJvcCBdOwoJCX0KCgkJLy8gU3VwcG9ydDogQ29yZG92YSAyLjUgKFdlYktpdCkgKCMxMzI1NSkKCQkvLyBBbGwgZXZlbnRzIHNob3VsZCBoYXZlIGEgdGFyZ2V0OyBDb3Jkb3ZhIGRldmljZXJlYWR5IGRvZXNuJ3QKCQlpZiAoICFldmVudC50YXJnZXQgKSB7CgkJCWV2ZW50LnRhcmdldCA9IGRvY3VtZW50OwoJCX0KCgkJLy8gU3VwcG9ydDogU2FmYXJpIDYuMCssIENocm9tZTwyOAoJCS8vIFRhcmdldCBzaG91bGQgbm90IGJlIGEgdGV4dCBub2RlICgjNTA0LCAjMTMxNDMpCgkJaWYgKCBldmVudC50YXJnZXQubm9kZVR5cGUgPT09IDMgKSB7CgkJCWV2ZW50LnRhcmdldCA9IGV2ZW50LnRhcmdldC5wYXJlbnROb2RlOwoJCX0KCgkJcmV0dXJuIGZpeEhvb2suZmlsdGVyID8gZml4SG9vay5maWx0ZXIoIGV2ZW50LCBvcmlnaW5hbEV2ZW50ICkgOiBldmVudDsKCX0sCgoJc3BlY2lhbDogewoJCWxvYWQ6IHsKCgkJCS8vIFByZXZlbnQgdHJpZ2dlcmVkIGltYWdlLmxvYWQgZXZlbnRzIGZyb20gYnViYmxpbmcgdG8gd2luZG93LmxvYWQKCQkJbm9CdWJibGU6IHRydWUKCQl9LAoJCWZvY3VzOiB7CgoJCQkvLyBGaXJlIG5hdGl2ZSBldmVudCBpZiBwb3NzaWJsZSBzbyBibHVyL2ZvY3VzIHNlcXVlbmNlIGlzIGNvcnJlY3QKCQkJdHJpZ2dlcjogZnVuY3Rpb24oKSB7CgkJCQlpZiAoIHRoaXMgIT09IHNhZmVBY3RpdmVFbGVtZW50KCkgJiYgdGhpcy5mb2N1cyApIHsKCQkJCQl0aGlzLmZvY3VzKCk7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9LAoJCQlkZWxlZ2F0ZVR5cGU6ICJmb2N1c2luIgoJCX0sCgkJYmx1cjogewoJCQl0cmlnZ2VyOiBmdW5jdGlvbigpIHsKCQkJCWlmICggdGhpcyA9PT0gc2FmZUFjdGl2ZUVsZW1lbnQoKSAmJiB0aGlzLmJsdXIgKSB7CgkJCQkJdGhpcy5ibHVyKCk7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9LAoJCQlkZWxlZ2F0ZVR5cGU6ICJmb2N1c291dCIKCQl9LAoJCWNsaWNrOiB7CgoJCQkvLyBGb3IgY2hlY2tib3gsIGZpcmUgbmF0aXZlIGV2ZW50IHNvIGNoZWNrZWQgc3RhdGUgd2lsbCBiZSByaWdodAoJCQl0cmlnZ2VyOiBmdW5jdGlvbigpIHsKCQkJCWlmICggdGhpcy50eXBlID09PSAiY2hlY2tib3giICYmIHRoaXMuY2xpY2sgJiYgalF1ZXJ5Lm5vZGVOYW1lKCB0aGlzLCAiaW5wdXQiICkgKSB7CgkJCQkJdGhpcy5jbGljaygpOwoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCQkJfSwKCgkJCS8vIEZvciBjcm9zcy1icm93c2VyIGNvbnNpc3RlbmN5LCBkb24ndCBmaXJlIG5hdGl2ZSAuY2xpY2soKSBvbiBsaW5rcwoJCQlfZGVmYXVsdDogZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJcmV0dXJuIGpRdWVyeS5ub2RlTmFtZSggZXZlbnQudGFyZ2V0LCAiYSIgKTsKCQkJfQoJCX0sCgoJCWJlZm9yZXVubG9hZDogewoJCQlwb3N0RGlzcGF0Y2g6IGZ1bmN0aW9uKCBldmVudCApIHsKCgkJCQkvLyBTdXBwb3J0OiBGaXJlZm94IDIwKwoJCQkJLy8gRmlyZWZveCBkb2Vzbid0IGFsZXJ0IGlmIHRoZSByZXR1cm5WYWx1ZSBmaWVsZCBpcyBub3Qgc2V0LgoJCQkJaWYgKCBldmVudC5yZXN1bHQgIT09IHVuZGVmaW5lZCAmJiBldmVudC5vcmlnaW5hbEV2ZW50ICkgewoJCQkJCWV2ZW50Lm9yaWdpbmFsRXZlbnQucmV0dXJuVmFsdWUgPSBldmVudC5yZXN1bHQ7CgkJCQl9CgkJCX0KCQl9Cgl9Cn07CgpqUXVlcnkucmVtb3ZlRXZlbnQgPSBmdW5jdGlvbiggZWxlbSwgdHlwZSwgaGFuZGxlICkgewoKCS8vIFRoaXMgImlmIiBpcyBuZWVkZWQgZm9yIHBsYWluIG9iamVjdHMKCWlmICggZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyICkgewoJCWVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lciggdHlwZSwgaGFuZGxlICk7Cgl9Cn07CgpqUXVlcnkuRXZlbnQgPSBmdW5jdGlvbiggc3JjLCBwcm9wcyApIHsKCgkvLyBBbGxvdyBpbnN0YW50aWF0aW9uIHdpdGhvdXQgdGhlICduZXcnIGtleXdvcmQKCWlmICggISggdGhpcyBpbnN0YW5jZW9mIGpRdWVyeS5FdmVudCApICkgewoJCXJldHVybiBuZXcgalF1ZXJ5LkV2ZW50KCBzcmMsIHByb3BzICk7Cgl9CgoJLy8gRXZlbnQgb2JqZWN0CglpZiAoIHNyYyAmJiBzcmMudHlwZSApIHsKCQl0aGlzLm9yaWdpbmFsRXZlbnQgPSBzcmM7CgkJdGhpcy50eXBlID0gc3JjLnR5cGU7CgoJCS8vIEV2ZW50cyBidWJibGluZyB1cCB0aGUgZG9jdW1lbnQgbWF5IGhhdmUgYmVlbiBtYXJrZWQgYXMgcHJldmVudGVkCgkJLy8gYnkgYSBoYW5kbGVyIGxvd2VyIGRvd24gdGhlIHRyZWU7IHJlZmxlY3QgdGhlIGNvcnJlY3QgdmFsdWUuCgkJdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQgPSBzcmMuZGVmYXVsdFByZXZlbnRlZCB8fAoJCQkJc3JjLmRlZmF1bHRQcmV2ZW50ZWQgPT09IHVuZGVmaW5lZCAmJgoKCQkJCS8vIFN1cHBvcnQ6IEFuZHJvaWQ8NC4wCgkJCQlzcmMucmV0dXJuVmFsdWUgPT09IGZhbHNlID8KCQkJcmV0dXJuVHJ1ZSA6CgkJCXJldHVybkZhbHNlOwoKCS8vIEV2ZW50IHR5cGUKCX0gZWxzZSB7CgkJdGhpcy50eXBlID0gc3JjOwoJfQoKCS8vIFB1dCBleHBsaWNpdGx5IHByb3ZpZGVkIHByb3BlcnRpZXMgb250byB0aGUgZXZlbnQgb2JqZWN0CglpZiAoIHByb3BzICkgewoJCWpRdWVyeS5leHRlbmQoIHRoaXMsIHByb3BzICk7Cgl9CgoJLy8gQ3JlYXRlIGEgdGltZXN0YW1wIGlmIGluY29taW5nIGV2ZW50IGRvZXNuJ3QgaGF2ZSBvbmUKCXRoaXMudGltZVN0YW1wID0gc3JjICYmIHNyYy50aW1lU3RhbXAgfHwgalF1ZXJ5Lm5vdygpOwoKCS8vIE1hcmsgaXQgYXMgZml4ZWQKCXRoaXNbIGpRdWVyeS5leHBhbmRvIF0gPSB0cnVlOwp9OwoKLy8galF1ZXJ5LkV2ZW50IGlzIGJhc2VkIG9uIERPTTMgRXZlbnRzIGFzIHNwZWNpZmllZCBieSB0aGUgRUNNQVNjcmlwdCBMYW5ndWFnZSBCaW5kaW5nCi8vIGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDMvV0QtRE9NLUxldmVsLTMtRXZlbnRzLTIwMDMwMzMxL2VjbWEtc2NyaXB0LWJpbmRpbmcuaHRtbApqUXVlcnkuRXZlbnQucHJvdG90eXBlID0gewoJY29uc3RydWN0b3I6IGpRdWVyeS5FdmVudCwKCWlzRGVmYXVsdFByZXZlbnRlZDogcmV0dXJuRmFsc2UsCglpc1Byb3BhZ2F0aW9uU3RvcHBlZDogcmV0dXJuRmFsc2UsCglpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDogcmV0dXJuRmFsc2UsCgoJcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uKCkgewoJCXZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50OwoKCQl0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IHJldHVyblRydWU7CgoJCWlmICggZSApIHsKCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCX0KCX0sCglzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkgewoJCXZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50OwoKCQl0aGlzLmlzUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1ZTsKCgkJaWYgKCBlICkgewoJCQllLnN0b3BQcm9wYWdhdGlvbigpOwoJCX0KCX0sCglzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246IGZ1bmN0aW9uKCkgewoJCXZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50OwoKCQl0aGlzLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkID0gcmV0dXJuVHJ1ZTsKCgkJaWYgKCBlICkgewoJCQllLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpOwoJCX0KCgkJdGhpcy5zdG9wUHJvcGFnYXRpb24oKTsKCX0KfTsKCi8vIENyZWF0ZSBtb3VzZWVudGVyL2xlYXZlIGV2ZW50cyB1c2luZyBtb3VzZW92ZXIvb3V0IGFuZCBldmVudC10aW1lIGNoZWNrcwovLyBzbyB0aGF0IGV2ZW50IGRlbGVnYXRpb24gd29ya3MgaW4galF1ZXJ5LgovLyBEbyB0aGUgc2FtZSBmb3IgcG9pbnRlcmVudGVyL3BvaW50ZXJsZWF2ZSBhbmQgcG9pbnRlcm92ZXIvcG9pbnRlcm91dAovLwovLyBTdXBwb3J0OiBTYWZhcmkgNyBvbmx5Ci8vIFNhZmFyaSBzZW5kcyBtb3VzZWVudGVyIHRvbyBvZnRlbjsgc2VlOgovLyBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NDcwMjU4Ci8vIGZvciB0aGUgZGVzY3JpcHRpb24gb2YgdGhlIGJ1ZyAoaXQgZXhpc3RlZCBpbiBvbGRlciBDaHJvbWUgdmVyc2lvbnMgYXMgd2VsbCkuCmpRdWVyeS5lYWNoKCB7Cgltb3VzZWVudGVyOiAibW91c2VvdmVyIiwKCW1vdXNlbGVhdmU6ICJtb3VzZW91dCIsCglwb2ludGVyZW50ZXI6ICJwb2ludGVyb3ZlciIsCglwb2ludGVybGVhdmU6ICJwb2ludGVyb3V0Igp9LCBmdW5jdGlvbiggb3JpZywgZml4ICkgewoJalF1ZXJ5LmV2ZW50LnNwZWNpYWxbIG9yaWcgXSA9IHsKCQlkZWxlZ2F0ZVR5cGU6IGZpeCwKCQliaW5kVHlwZTogZml4LAoKCQloYW5kbGU6IGZ1bmN0aW9uKCBldmVudCApIHsKCQkJdmFyIHJldCwKCQkJCXRhcmdldCA9IHRoaXMsCgkJCQlyZWxhdGVkID0gZXZlbnQucmVsYXRlZFRhcmdldCwKCQkJCWhhbmRsZU9iaiA9IGV2ZW50LmhhbmRsZU9iajsKCgkJCS8vIEZvciBtb3VzZWVudGVyL2xlYXZlIGNhbGwgdGhlIGhhbmRsZXIgaWYgcmVsYXRlZCBpcyBvdXRzaWRlIHRoZSB0YXJnZXQuCgkJCS8vIE5COiBObyByZWxhdGVkVGFyZ2V0IGlmIHRoZSBtb3VzZSBsZWZ0L2VudGVyZWQgdGhlIGJyb3dzZXIgd2luZG93CgkJCWlmICggIXJlbGF0ZWQgfHwgKCByZWxhdGVkICE9PSB0YXJnZXQgJiYgIWpRdWVyeS5jb250YWlucyggdGFyZ2V0LCByZWxhdGVkICkgKSApIHsKCQkJCWV2ZW50LnR5cGUgPSBoYW5kbGVPYmoub3JpZ1R5cGU7CgkJCQlyZXQgPSBoYW5kbGVPYmouaGFuZGxlci5hcHBseSggdGhpcywgYXJndW1lbnRzICk7CgkJCQlldmVudC50eXBlID0gZml4OwoJCQl9CgkJCXJldHVybiByZXQ7CgkJfQoJfTsKfSApOwoKalF1ZXJ5LmZuLmV4dGVuZCggewoJb246IGZ1bmN0aW9uKCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuICkgewoJCXJldHVybiBvbiggdGhpcywgdHlwZXMsIHNlbGVjdG9yLCBkYXRhLCBmbiApOwoJfSwKCW9uZTogZnVuY3Rpb24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKSB7CgkJcmV0dXJuIG9uKCB0aGlzLCB0eXBlcywgc2VsZWN0b3IsIGRhdGEsIGZuLCAxICk7Cgl9LAoJb2ZmOiBmdW5jdGlvbiggdHlwZXMsIHNlbGVjdG9yLCBmbiApIHsKCQl2YXIgaGFuZGxlT2JqLCB0eXBlOwoJCWlmICggdHlwZXMgJiYgdHlwZXMucHJldmVudERlZmF1bHQgJiYgdHlwZXMuaGFuZGxlT2JqICkgewoKCQkJLy8gKCBldmVudCApICBkaXNwYXRjaGVkIGpRdWVyeS5FdmVudAoJCQloYW5kbGVPYmogPSB0eXBlcy5oYW5kbGVPYmo7CgkJCWpRdWVyeSggdHlwZXMuZGVsZWdhdGVUYXJnZXQgKS5vZmYoCgkJCQloYW5kbGVPYmoubmFtZXNwYWNlID8KCQkJCQloYW5kbGVPYmoub3JpZ1R5cGUgKyAiLiIgKyBoYW5kbGVPYmoubmFtZXNwYWNlIDoKCQkJCQloYW5kbGVPYmoub3JpZ1R5cGUsCgkJCQloYW5kbGVPYmouc2VsZWN0b3IsCgkJCQloYW5kbGVPYmouaGFuZGxlcgoJCQkpOwoJCQlyZXR1cm4gdGhpczsKCQl9CgkJaWYgKCB0eXBlb2YgdHlwZXMgPT09ICJvYmplY3QiICkgewoKCQkJLy8gKCB0eXBlcy1vYmplY3QgWywgc2VsZWN0b3JdICkKCQkJZm9yICggdHlwZSBpbiB0eXBlcyApIHsKCQkJCXRoaXMub2ZmKCB0eXBlLCBzZWxlY3RvciwgdHlwZXNbIHR5cGUgXSApOwoJCQl9CgkJCXJldHVybiB0aGlzOwoJCX0KCQlpZiAoIHNlbGVjdG9yID09PSBmYWxzZSB8fCB0eXBlb2Ygc2VsZWN0b3IgPT09ICJmdW5jdGlvbiIgKSB7CgoJCQkvLyAoIHR5cGVzIFssIGZuXSApCgkJCWZuID0gc2VsZWN0b3I7CgkJCXNlbGVjdG9yID0gdW5kZWZpbmVkOwoJCX0KCQlpZiAoIGZuID09PSBmYWxzZSApIHsKCQkJZm4gPSByZXR1cm5GYWxzZTsKCQl9CgkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCWpRdWVyeS5ldmVudC5yZW1vdmUoIHRoaXMsIHR5cGVzLCBmbiwgc2VsZWN0b3IgKTsKCQl9ICk7Cgl9Cn0gKTsKCgp2YXIKCXJ4aHRtbFRhZyA9IC88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcdzotXSspW14+XSopXC8+L2dpLAoKCS8vIFN1cHBvcnQ6IElFIDEwLTExLCBFZGdlIDEwMjQwKwoJLy8gSW4gSUUvRWRnZSB1c2luZyByZWdleCBncm91cHMgaGVyZSBjYXVzZXMgc2V2ZXJlIHNsb3dkb3ducy4KCS8vIFNlZSBodHRwczovL2Nvbm5lY3QubWljcm9zb2Z0LmNvbS9JRS9mZWVkYmFjay9kZXRhaWxzLzE3MzY1MTIvCglybm9Jbm5lcmh0bWwgPSAvPHNjcmlwdHw8c3R5bGV8PGxpbmsvaSwKCgkvLyBjaGVja2VkPSJjaGVja2VkIiBvciBjaGVja2VkCglyY2hlY2tlZCA9IC9jaGVja2VkXHMqKD86W149XXw9XHMqLmNoZWNrZWQuKS9pLAoJcnNjcmlwdFR5cGVNYXNrZWQgPSAvXnRydWVcLyguKikvLAoJcmNsZWFuU2NyaXB0ID0gL15ccyo8ISg/OlxbQ0RBVEFcW3wtLSl8KD86XF1cXXwtLSk+XHMqJC9nOwoKLy8gTWFuaXB1bGF0aW5nIHRhYmxlcyByZXF1aXJlcyBhIHRib2R5CmZ1bmN0aW9uIG1hbmlwdWxhdGlvblRhcmdldCggZWxlbSwgY29udGVudCApIHsKCXJldHVybiBqUXVlcnkubm9kZU5hbWUoIGVsZW0sICJ0YWJsZSIgKSAmJgoJCWpRdWVyeS5ub2RlTmFtZSggY29udGVudC5ub2RlVHlwZSAhPT0gMTEgPyBjb250ZW50IDogY29udGVudC5maXJzdENoaWxkLCAidHIiICkgPwoKCQllbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKCAidGJvZHkiIClbIDAgXSB8fAoJCQllbGVtLmFwcGVuZENoaWxkKCBlbGVtLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCggInRib2R5IiApICkgOgoJCWVsZW07Cn0KCi8vIFJlcGxhY2UvcmVzdG9yZSB0aGUgdHlwZSBhdHRyaWJ1dGUgb2Ygc2NyaXB0IGVsZW1lbnRzIGZvciBzYWZlIERPTSBtYW5pcHVsYXRpb24KZnVuY3Rpb24gZGlzYWJsZVNjcmlwdCggZWxlbSApIHsKCWVsZW0udHlwZSA9ICggZWxlbS5nZXRBdHRyaWJ1dGUoICJ0eXBlIiApICE9PSBudWxsICkgKyAiLyIgKyBlbGVtLnR5cGU7CglyZXR1cm4gZWxlbTsKfQpmdW5jdGlvbiByZXN0b3JlU2NyaXB0KCBlbGVtICkgewoJdmFyIG1hdGNoID0gcnNjcmlwdFR5cGVNYXNrZWQuZXhlYyggZWxlbS50eXBlICk7CgoJaWYgKCBtYXRjaCApIHsKCQllbGVtLnR5cGUgPSBtYXRjaFsgMSBdOwoJfSBlbHNlIHsKCQllbGVtLnJlbW92ZUF0dHJpYnV0ZSggInR5cGUiICk7Cgl9CgoJcmV0dXJuIGVsZW07Cn0KCmZ1bmN0aW9uIGNsb25lQ29weUV2ZW50KCBzcmMsIGRlc3QgKSB7Cgl2YXIgaSwgbCwgdHlwZSwgcGRhdGFPbGQsIHBkYXRhQ3VyLCB1ZGF0YU9sZCwgdWRhdGFDdXIsIGV2ZW50czsKCglpZiAoIGRlc3Qubm9kZVR5cGUgIT09IDEgKSB7CgkJcmV0dXJuOwoJfQoKCS8vIDEuIENvcHkgcHJpdmF0ZSBkYXRhOiBldmVudHMsIGhhbmRsZXJzLCBldGMuCglpZiAoIGRhdGFQcml2Lmhhc0RhdGEoIHNyYyApICkgewoJCXBkYXRhT2xkID0gZGF0YVByaXYuYWNjZXNzKCBzcmMgKTsKCQlwZGF0YUN1ciA9IGRhdGFQcml2LnNldCggZGVzdCwgcGRhdGFPbGQgKTsKCQlldmVudHMgPSBwZGF0YU9sZC5ldmVudHM7CgoJCWlmICggZXZlbnRzICkgewoJCQlkZWxldGUgcGRhdGFDdXIuaGFuZGxlOwoJCQlwZGF0YUN1ci5ldmVudHMgPSB7fTsKCgkJCWZvciAoIHR5cGUgaW4gZXZlbnRzICkgewoJCQkJZm9yICggaSA9IDAsIGwgPSBldmVudHNbIHR5cGUgXS5sZW5ndGg7IGkgPCBsOyBpKysgKSB7CgkJCQkJalF1ZXJ5LmV2ZW50LmFkZCggZGVzdCwgdHlwZSwgZXZlbnRzWyB0eXBlIF1bIGkgXSApOwoJCQkJfQoJCQl9CgkJfQoJfQoKCS8vIDIuIENvcHkgdXNlciBkYXRhCglpZiAoIGRhdGFVc2VyLmhhc0RhdGEoIHNyYyApICkgewoJCXVkYXRhT2xkID0gZGF0YVVzZXIuYWNjZXNzKCBzcmMgKTsKCQl1ZGF0YUN1ciA9IGpRdWVyeS5leHRlbmQoIHt9LCB1ZGF0YU9sZCApOwoKCQlkYXRhVXNlci5zZXQoIGRlc3QsIHVkYXRhQ3VyICk7Cgl9Cn0KCi8vIEZpeCBJRSBidWdzLCBzZWUgc3VwcG9ydCB0ZXN0cwpmdW5jdGlvbiBmaXhJbnB1dCggc3JjLCBkZXN0ICkgewoJdmFyIG5vZGVOYW1lID0gZGVzdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwoKCS8vIEZhaWxzIHRvIHBlcnNpc3QgdGhlIGNoZWNrZWQgc3RhdGUgb2YgYSBjbG9uZWQgY2hlY2tib3ggb3IgcmFkaW8gYnV0dG9uLgoJaWYgKCBub2RlTmFtZSA9PT0gImlucHV0IiAmJiByY2hlY2thYmxlVHlwZS50ZXN0KCBzcmMudHlwZSApICkgewoJCWRlc3QuY2hlY2tlZCA9IHNyYy5jaGVja2VkOwoKCS8vIEZhaWxzIHRvIHJldHVybiB0aGUgc2VsZWN0ZWQgb3B0aW9uIHRvIHRoZSBkZWZhdWx0IHNlbGVjdGVkIHN0YXRlIHdoZW4gY2xvbmluZyBvcHRpb25zCgl9IGVsc2UgaWYgKCBub2RlTmFtZSA9PT0gImlucHV0IiB8fCBub2RlTmFtZSA9PT0gInRleHRhcmVhIiApIHsKCQlkZXN0LmRlZmF1bHRWYWx1ZSA9IHNyYy5kZWZhdWx0VmFsdWU7Cgl9Cn0KCmZ1bmN0aW9uIGRvbU1hbmlwKCBjb2xsZWN0aW9uLCBhcmdzLCBjYWxsYmFjaywgaWdub3JlZCApIHsKCgkvLyBGbGF0dGVuIGFueSBuZXN0ZWQgYXJyYXlzCglhcmdzID0gY29uY2F0LmFwcGx5KCBbXSwgYXJncyApOwoKCXZhciBmcmFnbWVudCwgZmlyc3QsIHNjcmlwdHMsIGhhc1NjcmlwdHMsIG5vZGUsIGRvYywKCQlpID0gMCwKCQlsID0gY29sbGVjdGlvbi5sZW5ndGgsCgkJaU5vQ2xvbmUgPSBsIC0gMSwKCQl2YWx1ZSA9IGFyZ3NbIDAgXSwKCQlpc0Z1bmN0aW9uID0galF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICk7CgoJLy8gV2UgY2FuJ3QgY2xvbmVOb2RlIGZyYWdtZW50cyB0aGF0IGNvbnRhaW4gY2hlY2tlZCwgaW4gV2ViS2l0CglpZiAoIGlzRnVuY3Rpb24gfHwKCQkJKCBsID4gMSAmJiB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmCgkJCQkhc3VwcG9ydC5jaGVja0Nsb25lICYmIHJjaGVja2VkLnRlc3QoIHZhbHVlICkgKSApIHsKCQlyZXR1cm4gY29sbGVjdGlvbi5lYWNoKCBmdW5jdGlvbiggaW5kZXggKSB7CgkJCXZhciBzZWxmID0gY29sbGVjdGlvbi5lcSggaW5kZXggKTsKCQkJaWYgKCBpc0Z1bmN0aW9uICkgewoJCQkJYXJnc1sgMCBdID0gdmFsdWUuY2FsbCggdGhpcywgaW5kZXgsIHNlbGYuaHRtbCgpICk7CgkJCX0KCQkJZG9tTWFuaXAoIHNlbGYsIGFyZ3MsIGNhbGxiYWNrLCBpZ25vcmVkICk7CgkJfSApOwoJfQoKCWlmICggbCApIHsKCQlmcmFnbWVudCA9IGJ1aWxkRnJhZ21lbnQoIGFyZ3MsIGNvbGxlY3Rpb25bIDAgXS5vd25lckRvY3VtZW50LCBmYWxzZSwgY29sbGVjdGlvbiwgaWdub3JlZCApOwoJCWZpcnN0ID0gZnJhZ21lbnQuZmlyc3RDaGlsZDsKCgkJaWYgKCBmcmFnbWVudC5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMSApIHsKCQkJZnJhZ21lbnQgPSBmaXJzdDsKCQl9CgoJCS8vIFJlcXVpcmUgZWl0aGVyIG5ldyBjb250ZW50IG9yIGFuIGludGVyZXN0IGluIGlnbm9yZWQgZWxlbWVudHMgdG8gaW52b2tlIHRoZSBjYWxsYmFjawoJCWlmICggZmlyc3QgfHwgaWdub3JlZCApIHsKCQkJc2NyaXB0cyA9IGpRdWVyeS5tYXAoIGdldEFsbCggZnJhZ21lbnQsICJzY3JpcHQiICksIGRpc2FibGVTY3JpcHQgKTsKCQkJaGFzU2NyaXB0cyA9IHNjcmlwdHMubGVuZ3RoOwoKCQkJLy8gVXNlIHRoZSBvcmlnaW5hbCBmcmFnbWVudCBmb3IgdGhlIGxhc3QgaXRlbQoJCQkvLyBpbnN0ZWFkIG9mIHRoZSBmaXJzdCBiZWNhdXNlIGl0IGNhbiBlbmQgdXAKCQkJLy8gYmVpbmcgZW1wdGllZCBpbmNvcnJlY3RseSBpbiBjZXJ0YWluIHNpdHVhdGlvbnMgKCM4MDcwKS4KCQkJZm9yICggOyBpIDwgbDsgaSsrICkgewoJCQkJbm9kZSA9IGZyYWdtZW50OwoKCQkJCWlmICggaSAhPT0gaU5vQ2xvbmUgKSB7CgkJCQkJbm9kZSA9IGpRdWVyeS5jbG9uZSggbm9kZSwgdHJ1ZSwgdHJ1ZSApOwoKCQkJCQkvLyBLZWVwIHJlZmVyZW5jZXMgdG8gY2xvbmVkIHNjcmlwdHMgZm9yIGxhdGVyIHJlc3RvcmF0aW9uCgkJCQkJaWYgKCBoYXNTY3JpcHRzICkgewoKCQkJCQkJLy8gU3VwcG9ydDogQW5kcm9pZDw0LjEsIFBoYW50b21KUzwyCgkJCQkJCS8vIHB1c2guYXBwbHkoXywgYXJyYXlsaWtlKSB0aHJvd3Mgb24gYW5jaWVudCBXZWJLaXQKCQkJCQkJalF1ZXJ5Lm1lcmdlKCBzY3JpcHRzLCBnZXRBbGwoIG5vZGUsICJzY3JpcHQiICkgKTsKCQkJCQl9CgkJCQl9CgoJCQkJY2FsbGJhY2suY2FsbCggY29sbGVjdGlvblsgaSBdLCBub2RlLCBpICk7CgkJCX0KCgkJCWlmICggaGFzU2NyaXB0cyApIHsKCQkJCWRvYyA9IHNjcmlwdHNbIHNjcmlwdHMubGVuZ3RoIC0gMSBdLm93bmVyRG9jdW1lbnQ7CgoJCQkJLy8gUmVlbmFibGUgc2NyaXB0cwoJCQkJalF1ZXJ5Lm1hcCggc2NyaXB0cywgcmVzdG9yZVNjcmlwdCApOwoKCQkJCS8vIEV2YWx1YXRlIGV4ZWN1dGFibGUgc2NyaXB0cyBvbiBmaXJzdCBkb2N1bWVudCBpbnNlcnRpb24KCQkJCWZvciAoIGkgPSAwOyBpIDwgaGFzU2NyaXB0czsgaSsrICkgewoJCQkJCW5vZGUgPSBzY3JpcHRzWyBpIF07CgkJCQkJaWYgKCByc2NyaXB0VHlwZS50ZXN0KCBub2RlLnR5cGUgfHwgIiIgKSAmJgoJCQkJCQkhZGF0YVByaXYuYWNjZXNzKCBub2RlLCAiZ2xvYmFsRXZhbCIgKSAmJgoJCQkJCQlqUXVlcnkuY29udGFpbnMoIGRvYywgbm9kZSApICkgewoKCQkJCQkJaWYgKCBub2RlLnNyYyApIHsKCgkJCQkJCQkvLyBPcHRpb25hbCBBSkFYIGRlcGVuZGVuY3ksIGJ1dCB3b24ndCBydW4gc2NyaXB0cyBpZiBub3QgcHJlc2VudAoJCQkJCQkJaWYgKCBqUXVlcnkuX2V2YWxVcmwgKSB7CgkJCQkJCQkJalF1ZXJ5Ll9ldmFsVXJsKCBub2RlLnNyYyApOwoJCQkJCQkJfQoJCQkJCQl9IGVsc2UgewoJCQkJCQkJalF1ZXJ5Lmdsb2JhbEV2YWwoIG5vZGUudGV4dENvbnRlbnQucmVwbGFjZSggcmNsZWFuU2NyaXB0LCAiIiApICk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCX0KCQl9Cgl9CgoJcmV0dXJuIGNvbGxlY3Rpb247Cn0KCmZ1bmN0aW9uIHJlbW92ZSggZWxlbSwgc2VsZWN0b3IsIGtlZXBEYXRhICkgewoJdmFyIG5vZGUsCgkJbm9kZXMgPSBzZWxlY3RvciA/IGpRdWVyeS5maWx0ZXIoIHNlbGVjdG9yLCBlbGVtICkgOiBlbGVtLAoJCWkgPSAwOwoKCWZvciAoIDsgKCBub2RlID0gbm9kZXNbIGkgXSApICE9IG51bGw7IGkrKyApIHsKCQlpZiAoICFrZWVwRGF0YSAmJiBub2RlLm5vZGVUeXBlID09PSAxICkgewoJCQlqUXVlcnkuY2xlYW5EYXRhKCBnZXRBbGwoIG5vZGUgKSApOwoJCX0KCgkJaWYgKCBub2RlLnBhcmVudE5vZGUgKSB7CgkJCWlmICgga2VlcERhdGEgJiYgalF1ZXJ5LmNvbnRhaW5zKCBub2RlLm93bmVyRG9jdW1lbnQsIG5vZGUgKSApIHsKCQkJCXNldEdsb2JhbEV2YWwoIGdldEFsbCggbm9kZSwgInNjcmlwdCIgKSApOwoJCQl9CgkJCW5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggbm9kZSApOwoJCX0KCX0KCglyZXR1cm4gZWxlbTsKfQoKalF1ZXJ5LmV4dGVuZCggewoJaHRtbFByZWZpbHRlcjogZnVuY3Rpb24oIGh0bWwgKSB7CgkJcmV0dXJuIGh0bWwucmVwbGFjZSggcnhodG1sVGFnLCAiPCQxPjwvJDI+IiApOwoJfSwKCgljbG9uZTogZnVuY3Rpb24oIGVsZW0sIGRhdGFBbmRFdmVudHMsIGRlZXBEYXRhQW5kRXZlbnRzICkgewoJCXZhciBpLCBsLCBzcmNFbGVtZW50cywgZGVzdEVsZW1lbnRzLAoJCQljbG9uZSA9IGVsZW0uY2xvbmVOb2RlKCB0cnVlICksCgkJCWluUGFnZSA9IGpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICk7CgoJCS8vIEZpeCBJRSBjbG9uaW5nIGlzc3VlcwoJCWlmICggIXN1cHBvcnQubm9DbG9uZUNoZWNrZWQgJiYgKCBlbGVtLm5vZGVUeXBlID09PSAxIHx8IGVsZW0ubm9kZVR5cGUgPT09IDExICkgJiYKCQkJCSFqUXVlcnkuaXNYTUxEb2MoIGVsZW0gKSApIHsKCgkJCS8vIFdlIGVzY2hldyBTaXp6bGUgaGVyZSBmb3IgcGVyZm9ybWFuY2UgcmVhc29uczogaHR0cDovL2pzcGVyZi5jb20vZ2V0YWxsLXZzLXNpenpsZS8yCgkJCWRlc3RFbGVtZW50cyA9IGdldEFsbCggY2xvbmUgKTsKCQkJc3JjRWxlbWVudHMgPSBnZXRBbGwoIGVsZW0gKTsKCgkJCWZvciAoIGkgPSAwLCBsID0gc3JjRWxlbWVudHMubGVuZ3RoOyBpIDwgbDsgaSsrICkgewoJCQkJZml4SW5wdXQoIHNyY0VsZW1lbnRzWyBpIF0sIGRlc3RFbGVtZW50c1sgaSBdICk7CgkJCX0KCQl9CgoJCS8vIENvcHkgdGhlIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCB0byB0aGUgY2xvbmUKCQlpZiAoIGRhdGFBbmRFdmVudHMgKSB7CgkJCWlmICggZGVlcERhdGFBbmRFdmVudHMgKSB7CgkJCQlzcmNFbGVtZW50cyA9IHNyY0VsZW1lbnRzIHx8IGdldEFsbCggZWxlbSApOwoJCQkJZGVzdEVsZW1lbnRzID0gZGVzdEVsZW1lbnRzIHx8IGdldEFsbCggY2xvbmUgKTsKCgkJCQlmb3IgKCBpID0gMCwgbCA9IHNyY0VsZW1lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKyApIHsKCQkJCQljbG9uZUNvcHlFdmVudCggc3JjRWxlbWVudHNbIGkgXSwgZGVzdEVsZW1lbnRzWyBpIF0gKTsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCWNsb25lQ29weUV2ZW50KCBlbGVtLCBjbG9uZSApOwoJCQl9CgkJfQoKCQkvLyBQcmVzZXJ2ZSBzY3JpcHQgZXZhbHVhdGlvbiBoaXN0b3J5CgkJZGVzdEVsZW1lbnRzID0gZ2V0QWxsKCBjbG9uZSwgInNjcmlwdCIgKTsKCQlpZiAoIGRlc3RFbGVtZW50cy5sZW5ndGggPiAwICkgewoJCQlzZXRHbG9iYWxFdmFsKCBkZXN0RWxlbWVudHMsICFpblBhZ2UgJiYgZ2V0QWxsKCBlbGVtLCAic2NyaXB0IiApICk7CgkJfQoKCQkvLyBSZXR1cm4gdGhlIGNsb25lZCBzZXQKCQlyZXR1cm4gY2xvbmU7Cgl9LAoKCWNsZWFuRGF0YTogZnVuY3Rpb24oIGVsZW1zICkgewoJCXZhciBkYXRhLCBlbGVtLCB0eXBlLAoJCQlzcGVjaWFsID0galF1ZXJ5LmV2ZW50LnNwZWNpYWwsCgkJCWkgPSAwOwoKCQlmb3IgKCA7ICggZWxlbSA9IGVsZW1zWyBpIF0gKSAhPT0gdW5kZWZpbmVkOyBpKysgKSB7CgkJCWlmICggYWNjZXB0RGF0YSggZWxlbSApICkgewoJCQkJaWYgKCAoIGRhdGEgPSBlbGVtWyBkYXRhUHJpdi5leHBhbmRvIF0gKSApIHsKCQkJCQlpZiAoIGRhdGEuZXZlbnRzICkgewoJCQkJCQlmb3IgKCB0eXBlIGluIGRhdGEuZXZlbnRzICkgewoJCQkJCQkJaWYgKCBzcGVjaWFsWyB0eXBlIF0gKSB7CgkJCQkJCQkJalF1ZXJ5LmV2ZW50LnJlbW92ZSggZWxlbSwgdHlwZSApOwoKCQkJCQkJCS8vIFRoaXMgaXMgYSBzaG9ydGN1dCB0byBhdm9pZCBqUXVlcnkuZXZlbnQucmVtb3ZlJ3Mgb3ZlcmhlYWQKCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJalF1ZXJ5LnJlbW92ZUV2ZW50KCBlbGVtLCB0eXBlLCBkYXRhLmhhbmRsZSApOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBTdXBwb3J0OiBDaHJvbWUgPD0gMzUtNDUrCgkJCQkJLy8gQXNzaWduIHVuZGVmaW5lZCBpbnN0ZWFkIG9mIHVzaW5nIGRlbGV0ZSwgc2VlIERhdGEjcmVtb3ZlCgkJCQkJZWxlbVsgZGF0YVByaXYuZXhwYW5kbyBdID0gdW5kZWZpbmVkOwoJCQkJfQoJCQkJaWYgKCBlbGVtWyBkYXRhVXNlci5leHBhbmRvIF0gKSB7CgoJCQkJCS8vIFN1cHBvcnQ6IENocm9tZSA8PSAzNS00NSsKCQkJCQkvLyBBc3NpZ24gdW5kZWZpbmVkIGluc3RlYWQgb2YgdXNpbmcgZGVsZXRlLCBzZWUgRGF0YSNyZW1vdmUKCQkJCQllbGVtWyBkYXRhVXNlci5leHBhbmRvIF0gPSB1bmRlZmluZWQ7CgkJCQl9CgkJCX0KCQl9Cgl9Cn0gKTsKCmpRdWVyeS5mbi5leHRlbmQoIHsKCgkvLyBLZWVwIGRvbU1hbmlwIGV4cG9zZWQgdW50aWwgMy4wIChnaC0yMjI1KQoJZG9tTWFuaXA6IGRvbU1hbmlwLAoKCWRldGFjaDogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCXJldHVybiByZW1vdmUoIHRoaXMsIHNlbGVjdG9yLCB0cnVlICk7Cgl9LAoKCXJlbW92ZTogZnVuY3Rpb24oIHNlbGVjdG9yICkgewoJCXJldHVybiByZW1vdmUoIHRoaXMsIHNlbGVjdG9yICk7Cgl9LAoKCXRleHQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggdmFsdWUgKSB7CgkJCXJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8KCQkJCWpRdWVyeS50ZXh0KCB0aGlzICkgOgoJCQkJdGhpcy5lbXB0eSgpLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJCWlmICggdGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5ICkgewoJCQkJCQl0aGlzLnRleHRDb250ZW50ID0gdmFsdWU7CgkJCQkJfQoJCQkJfSApOwoJCX0sIG51bGwsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoICk7Cgl9LAoKCWFwcGVuZDogZnVuY3Rpb24oKSB7CgkJcmV0dXJuIGRvbU1hbmlwKCB0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQlpZiAoIHRoaXMubm9kZVR5cGUgPT09IDEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gMTEgfHwgdGhpcy5ub2RlVHlwZSA9PT0gOSApIHsKCQkJCXZhciB0YXJnZXQgPSBtYW5pcHVsYXRpb25UYXJnZXQoIHRoaXMsIGVsZW0gKTsKCQkJCXRhcmdldC5hcHBlbmRDaGlsZCggZWxlbSApOwoJCQl9CgkJfSApOwoJfSwKCglwcmVwZW5kOiBmdW5jdGlvbigpIHsKCQlyZXR1cm4gZG9tTWFuaXAoIHRoaXMsIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCWlmICggdGhpcy5ub2RlVHlwZSA9PT0gMSB8fCB0aGlzLm5vZGVUeXBlID09PSAxMSB8fCB0aGlzLm5vZGVUeXBlID09PSA5ICkgewoJCQkJdmFyIHRhcmdldCA9IG1hbmlwdWxhdGlvblRhcmdldCggdGhpcywgZWxlbSApOwoJCQkJdGFyZ2V0Lmluc2VydEJlZm9yZSggZWxlbSwgdGFyZ2V0LmZpcnN0Q2hpbGQgKTsKCQkJfQoJCX0gKTsKCX0sCgoJYmVmb3JlOiBmdW5jdGlvbigpIHsKCQlyZXR1cm4gZG9tTWFuaXAoIHRoaXMsIGFyZ3VtZW50cywgZnVuY3Rpb24oIGVsZW0gKSB7CgkJCWlmICggdGhpcy5wYXJlbnROb2RlICkgewoJCQkJdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZSggZWxlbSwgdGhpcyApOwoJCQl9CgkJfSApOwoJfSwKCglhZnRlcjogZnVuY3Rpb24oKSB7CgkJcmV0dXJuIGRvbU1hbmlwKCB0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uKCBlbGVtICkgewoJCQlpZiAoIHRoaXMucGFyZW50Tm9kZSApIHsKCQkJCXRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIGVsZW0sIHRoaXMubmV4dFNpYmxpbmcgKTsKCQkJfQoJCX0gKTsKCX0sCgoJZW1wdHk6IGZ1bmN0aW9uKCkgewoJCXZhciBlbGVtLAoJCQlpID0gMDsKCgkJZm9yICggOyAoIGVsZW0gPSB0aGlzWyBpIF0gKSAhPSBudWxsOyBpKysgKSB7CgkJCWlmICggZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCgkJCQkvLyBQcmV2ZW50IG1lbW9yeSBsZWFrcwoJCQkJalF1ZXJ5LmNsZWFuRGF0YSggZ2V0QWxsKCBlbGVtLCBmYWxzZSApICk7CgoJCQkJLy8gUmVtb3ZlIGFueSByZW1haW5pbmcgbm9kZXMKCQkJCWVsZW0udGV4dENvbnRlbnQgPSAiIjsKCQkJfQoJCX0KCgkJcmV0dXJuIHRoaXM7Cgl9LAoKCWNsb25lOiBmdW5jdGlvbiggZGF0YUFuZEV2ZW50cywgZGVlcERhdGFBbmRFdmVudHMgKSB7CgkJZGF0YUFuZEV2ZW50cyA9IGRhdGFBbmRFdmVudHMgPT0gbnVsbCA/IGZhbHNlIDogZGF0YUFuZEV2ZW50czsKCQlkZWVwRGF0YUFuZEV2ZW50cyA9IGRlZXBEYXRhQW5kRXZlbnRzID09IG51bGwgPyBkYXRhQW5kRXZlbnRzIDogZGVlcERhdGFBbmRFdmVudHM7CgoJCXJldHVybiB0aGlzLm1hcCggZnVuY3Rpb24oKSB7CgkJCXJldHVybiBqUXVlcnkuY2xvbmUoIHRoaXMsIGRhdGFBbmRFdmVudHMsIGRlZXBEYXRhQW5kRXZlbnRzICk7CgkJfSApOwoJfSwKCglodG1sOiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIHZhbHVlICkgewoJCQl2YXIgZWxlbSA9IHRoaXNbIDAgXSB8fCB7fSwKCQkJCWkgPSAwLAoJCQkJbCA9IHRoaXMubGVuZ3RoOwoKCQkJaWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICYmIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQlyZXR1cm4gZWxlbS5pbm5lckhUTUw7CgkJCX0KCgkJCS8vIFNlZSBpZiB3ZSBjYW4gdGFrZSBhIHNob3J0Y3V0IGFuZCBqdXN0IHVzZSBpbm5lckhUTUwKCQkJaWYgKCB0eXBlb2YgdmFsdWUgPT09ICJzdHJpbmciICYmICFybm9Jbm5lcmh0bWwudGVzdCggdmFsdWUgKSAmJgoJCQkJIXdyYXBNYXBbICggcnRhZ05hbWUuZXhlYyggdmFsdWUgKSB8fCBbICIiLCAiIiBdIClbIDEgXS50b0xvd2VyQ2FzZSgpIF0gKSB7CgoJCQkJdmFsdWUgPSBqUXVlcnkuaHRtbFByZWZpbHRlciggdmFsdWUgKTsKCgkJCQl0cnkgewoJCQkJCWZvciAoIDsgaSA8IGw7IGkrKyApIHsKCQkJCQkJZWxlbSA9IHRoaXNbIGkgXSB8fCB7fTsKCgkJCQkJCS8vIFJlbW92ZSBlbGVtZW50IG5vZGVzIGFuZCBwcmV2ZW50IG1lbW9yeSBsZWFrcwoJCQkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgKSB7CgkJCQkJCQlqUXVlcnkuY2xlYW5EYXRhKCBnZXRBbGwoIGVsZW0sIGZhbHNlICkgKTsKCQkJCQkJCWVsZW0uaW5uZXJIVE1MID0gdmFsdWU7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCWVsZW0gPSAwOwoKCQkJCS8vIElmIHVzaW5nIGlubmVySFRNTCB0aHJvd3MgYW4gZXhjZXB0aW9uLCB1c2UgdGhlIGZhbGxiYWNrIG1ldGhvZAoJCQkJfSBjYXRjaCAoIGUgKSB7fQoJCQl9CgoJCQlpZiAoIGVsZW0gKSB7CgkJCQl0aGlzLmVtcHR5KCkuYXBwZW5kKCB2YWx1ZSApOwoJCQl9CgkJfSwgbnVsbCwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggKTsKCX0sCgoJcmVwbGFjZVdpdGg6IGZ1bmN0aW9uKCkgewoJCXZhciBpZ25vcmVkID0gW107CgoJCS8vIE1ha2UgdGhlIGNoYW5nZXMsIHJlcGxhY2luZyBlYWNoIG5vbi1pZ25vcmVkIGNvbnRleHQgZWxlbWVudCB3aXRoIHRoZSBuZXcgY29udGVudAoJCXJldHVybiBkb21NYW5pcCggdGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiggZWxlbSApIHsKCQkJdmFyIHBhcmVudCA9IHRoaXMucGFyZW50Tm9kZTsKCgkJCWlmICggalF1ZXJ5LmluQXJyYXkoIHRoaXMsIGlnbm9yZWQgKSA8IDAgKSB7CgkJCQlqUXVlcnkuY2xlYW5EYXRhKCBnZXRBbGwoIHRoaXMgKSApOwoJCQkJaWYgKCBwYXJlbnQgKSB7CgkJCQkJcGFyZW50LnJlcGxhY2VDaGlsZCggZWxlbSwgdGhpcyApOwoJCQkJfQoJCQl9CgoJCS8vIEZvcmNlIGNhbGxiYWNrIGludm9jYXRpb24KCQl9LCBpZ25vcmVkICk7Cgl9Cn0gKTsKCmpRdWVyeS5lYWNoKCB7CglhcHBlbmRUbzogImFwcGVuZCIsCglwcmVwZW5kVG86ICJwcmVwZW5kIiwKCWluc2VydEJlZm9yZTogImJlZm9yZSIsCglpbnNlcnRBZnRlcjogImFmdGVyIiwKCXJlcGxhY2VBbGw6ICJyZXBsYWNlV2l0aCIKfSwgZnVuY3Rpb24oIG5hbWUsIG9yaWdpbmFsICkgewoJalF1ZXJ5LmZuWyBuYW1lIF0gPSBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJdmFyIGVsZW1zLAoJCQlyZXQgPSBbXSwKCQkJaW5zZXJ0ID0galF1ZXJ5KCBzZWxlY3RvciApLAoJCQlsYXN0ID0gaW5zZXJ0Lmxlbmd0aCAtIDEsCgkJCWkgPSAwOwoKCQlmb3IgKCA7IGkgPD0gbGFzdDsgaSsrICkgewoJCQllbGVtcyA9IGkgPT09IGxhc3QgPyB0aGlzIDogdGhpcy5jbG9uZSggdHJ1ZSApOwoJCQlqUXVlcnkoIGluc2VydFsgaSBdIClbIG9yaWdpbmFsIF0oIGVsZW1zICk7CgoJCQkvLyBTdXBwb3J0OiBRdFdlYktpdAoJCQkvLyAuZ2V0KCkgYmVjYXVzZSBwdXNoLmFwcGx5KF8sIGFycmF5bGlrZSkgdGhyb3dzCgkJCXB1c2guYXBwbHkoIHJldCwgZWxlbXMuZ2V0KCkgKTsKCQl9CgoJCXJldHVybiB0aGlzLnB1c2hTdGFjayggcmV0ICk7Cgl9Owp9ICk7CgoKdmFyIGlmcmFtZSwKCWVsZW1kaXNwbGF5ID0gewoKCQkvLyBTdXBwb3J0OiBGaXJlZm94CgkJLy8gV2UgaGF2ZSB0byBwcmUtZGVmaW5lIHRoZXNlIHZhbHVlcyBmb3IgRkYgKCMxMDIyNykKCQlIVE1MOiAiYmxvY2siLAoJCUJPRFk6ICJibG9jayIKCX07CgovKioKICogUmV0cmlldmUgdGhlIGFjdHVhbCBkaXNwbGF5IG9mIGEgZWxlbWVudAogKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBub2RlTmFtZSBvZiB0aGUgZWxlbWVudAogKiBAcGFyYW0ge09iamVjdH0gZG9jIERvY3VtZW50IG9iamVjdAogKi8KCi8vIENhbGxlZCBvbmx5IGZyb20gd2l0aGluIGRlZmF1bHREaXNwbGF5CmZ1bmN0aW9uIGFjdHVhbERpc3BsYXkoIG5hbWUsIGRvYyApIHsKCXZhciBlbGVtID0galF1ZXJ5KCBkb2MuY3JlYXRlRWxlbWVudCggbmFtZSApICkuYXBwZW5kVG8oIGRvYy5ib2R5ICksCgoJCWRpc3BsYXkgPSBqUXVlcnkuY3NzKCBlbGVtWyAwIF0sICJkaXNwbGF5IiApOwoKCS8vIFdlIGRvbid0IGhhdmUgYW55IGRhdGEgc3RvcmVkIG9uIHRoZSBlbGVtZW50LAoJLy8gc28gdXNlICJkZXRhY2giIG1ldGhvZCBhcyBmYXN0IHdheSB0byBnZXQgcmlkIG9mIHRoZSBlbGVtZW50CgllbGVtLmRldGFjaCgpOwoKCXJldHVybiBkaXNwbGF5Owp9CgovKioKICogVHJ5IHRvIGRldGVybWluZSB0aGUgZGVmYXVsdCBkaXNwbGF5IHZhbHVlIG9mIGFuIGVsZW1lbnQKICogQHBhcmFtIHtTdHJpbmd9IG5vZGVOYW1lCiAqLwpmdW5jdGlvbiBkZWZhdWx0RGlzcGxheSggbm9kZU5hbWUgKSB7Cgl2YXIgZG9jID0gZG9jdW1lbnQsCgkJZGlzcGxheSA9IGVsZW1kaXNwbGF5WyBub2RlTmFtZSBdOwoKCWlmICggIWRpc3BsYXkgKSB7CgkJZGlzcGxheSA9IGFjdHVhbERpc3BsYXkoIG5vZGVOYW1lLCBkb2MgKTsKCgkJLy8gSWYgdGhlIHNpbXBsZSB3YXkgZmFpbHMsIHJlYWQgZnJvbSBpbnNpZGUgYW4gaWZyYW1lCgkJaWYgKCBkaXNwbGF5ID09PSAibm9uZSIgfHwgIWRpc3BsYXkgKSB7CgoJCQkvLyBVc2UgdGhlIGFscmVhZHktY3JlYXRlZCBpZnJhbWUgaWYgcG9zc2libGUKCQkJaWZyYW1lID0gKCBpZnJhbWUgfHwgalF1ZXJ5KCAiPGlmcmFtZSBmcmFtZWJvcmRlcj0nMCcgd2lkdGg9JzAnIGhlaWdodD0nMCcvPiIgKSApCgkJCQkuYXBwZW5kVG8oIGRvYy5kb2N1bWVudEVsZW1lbnQgKTsKCgkJCS8vIEFsd2F5cyB3cml0ZSBhIG5ldyBIVE1MIHNrZWxldG9uIHNvIFdlYmtpdCBhbmQgRmlyZWZveCBkb24ndCBjaG9rZSBvbiByZXVzZQoJCQlkb2MgPSBpZnJhbWVbIDAgXS5jb250ZW50RG9jdW1lbnQ7CgoJCQkvLyBTdXBwb3J0OiBJRQoJCQlkb2Mud3JpdGUoKTsKCQkJZG9jLmNsb3NlKCk7CgoJCQlkaXNwbGF5ID0gYWN0dWFsRGlzcGxheSggbm9kZU5hbWUsIGRvYyApOwoJCQlpZnJhbWUuZGV0YWNoKCk7CgkJfQoKCQkvLyBTdG9yZSB0aGUgY29ycmVjdCBkZWZhdWx0IGRpc3BsYXkKCQllbGVtZGlzcGxheVsgbm9kZU5hbWUgXSA9IGRpc3BsYXk7Cgl9CgoJcmV0dXJuIGRpc3BsYXk7Cn0KdmFyIHJtYXJnaW4gPSAoIC9ebWFyZ2luLyApOwoKdmFyIHJudW1ub25weCA9IG5ldyBSZWdFeHAoICJeKCIgKyBwbnVtICsgIikoPyFweClbYS16JV0rJCIsICJpIiApOwoKdmFyIGdldFN0eWxlcyA9IGZ1bmN0aW9uKCBlbGVtICkgewoKCQkvLyBTdXBwb3J0OiBJRTw9MTErLCBGaXJlZm94PD0zMCsgKCMxNTA5OCwgIzE0MTUwKQoJCS8vIElFIHRocm93cyBvbiBlbGVtZW50cyBjcmVhdGVkIGluIHBvcHVwcwoJCS8vIEZGIG1lYW53aGlsZSB0aHJvd3Mgb24gZnJhbWUgZWxlbWVudHMgdGhyb3VnaCAiZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZSIKCQl2YXIgdmlldyA9IGVsZW0ub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldzsKCgkJaWYgKCAhdmlldyB8fCAhdmlldy5vcGVuZXIgKSB7CgkJCXZpZXcgPSB3aW5kb3c7CgkJfQoKCQlyZXR1cm4gdmlldy5nZXRDb21wdXRlZFN0eWxlKCBlbGVtICk7Cgl9OwoKdmFyIHN3YXAgPSBmdW5jdGlvbiggZWxlbSwgb3B0aW9ucywgY2FsbGJhY2ssIGFyZ3MgKSB7Cgl2YXIgcmV0LCBuYW1lLAoJCW9sZCA9IHt9OwoKCS8vIFJlbWVtYmVyIHRoZSBvbGQgdmFsdWVzLCBhbmQgaW5zZXJ0IHRoZSBuZXcgb25lcwoJZm9yICggbmFtZSBpbiBvcHRpb25zICkgewoJCW9sZFsgbmFtZSBdID0gZWxlbS5zdHlsZVsgbmFtZSBdOwoJCWVsZW0uc3R5bGVbIG5hbWUgXSA9IG9wdGlvbnNbIG5hbWUgXTsKCX0KCglyZXQgPSBjYWxsYmFjay5hcHBseSggZWxlbSwgYXJncyB8fCBbXSApOwoKCS8vIFJldmVydCB0aGUgb2xkIHZhbHVlcwoJZm9yICggbmFtZSBpbiBvcHRpb25zICkgewoJCWVsZW0uc3R5bGVbIG5hbWUgXSA9IG9sZFsgbmFtZSBdOwoJfQoKCXJldHVybiByZXQ7Cn07CgoKdmFyIGRvY3VtZW50RWxlbWVudCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsKCgoKKCBmdW5jdGlvbigpIHsKCXZhciBwaXhlbFBvc2l0aW9uVmFsLCBib3hTaXppbmdSZWxpYWJsZVZhbCwgcGl4ZWxNYXJnaW5SaWdodFZhbCwgcmVsaWFibGVNYXJnaW5MZWZ0VmFsLAoJCWNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJkaXYiICksCgkJZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKTsKCgkvLyBGaW5pc2ggZWFybHkgaW4gbGltaXRlZCAobm9uLWJyb3dzZXIpIGVudmlyb25tZW50cwoJaWYgKCAhZGl2LnN0eWxlICkgewoJCXJldHVybjsKCX0KCgkvLyBTdXBwb3J0OiBJRTktMTErCgkvLyBTdHlsZSBvZiBjbG9uZWQgZWxlbWVudCBhZmZlY3RzIHNvdXJjZSBlbGVtZW50IGNsb25lZCAoIzg5MDgpCglkaXYuc3R5bGUuYmFja2dyb3VuZENsaXAgPSAiY29udGVudC1ib3giOwoJZGl2LmNsb25lTm9kZSggdHJ1ZSApLnN0eWxlLmJhY2tncm91bmRDbGlwID0gIiI7CglzdXBwb3J0LmNsZWFyQ2xvbmVTdHlsZSA9IGRpdi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCA9PT0gImNvbnRlbnQtYm94IjsKCgljb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICJib3JkZXI6MDt3aWR0aDo4cHg7aGVpZ2h0OjA7dG9wOjA7bGVmdDotOTk5OXB4OyIgKwoJCSJwYWRkaW5nOjA7bWFyZ2luLXRvcDoxcHg7cG9zaXRpb246YWJzb2x1dGUiOwoJY29udGFpbmVyLmFwcGVuZENoaWxkKCBkaXYgKTsKCgkvLyBFeGVjdXRpbmcgYm90aCBwaXhlbFBvc2l0aW9uICYgYm94U2l6aW5nUmVsaWFibGUgdGVzdHMgcmVxdWlyZSBvbmx5IG9uZSBsYXlvdXQKCS8vIHNvIHRoZXkncmUgZXhlY3V0ZWQgYXQgdGhlIHNhbWUgdGltZSB0byBzYXZlIHRoZSBzZWNvbmQgY29tcHV0YXRpb24uCglmdW5jdGlvbiBjb21wdXRlU3R5bGVUZXN0cygpIHsKCQlkaXYuc3R5bGUuY3NzVGV4dCA9CgoJCQkvLyBTdXBwb3J0OiBGaXJlZm94PDI5LCBBbmRyb2lkIDIuMwoJCQkvLyBWZW5kb3ItcHJlZml4IGJveC1zaXppbmcKCQkJIi13ZWJraXQtYm94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O2JveC1zaXppbmc6Ym9yZGVyLWJveDsiICsKCQkJInBvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7IiArCgkJCSJtYXJnaW46YXV0bztib3JkZXI6MXB4O3BhZGRpbmc6MXB4OyIgKwoJCQkidG9wOjElO3dpZHRoOjUwJSI7CgkJZGl2LmlubmVySFRNTCA9ICIiOwoJCWRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZCggY29udGFpbmVyICk7CgoJCXZhciBkaXZTdHlsZSA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCBkaXYgKTsKCQlwaXhlbFBvc2l0aW9uVmFsID0gZGl2U3R5bGUudG9wICE9PSAiMSUiOwoJCXJlbGlhYmxlTWFyZ2luTGVmdFZhbCA9IGRpdlN0eWxlLm1hcmdpbkxlZnQgPT09ICIycHgiOwoJCWJveFNpemluZ1JlbGlhYmxlVmFsID0gZGl2U3R5bGUud2lkdGggPT09ICI0cHgiOwoKCQkvLyBTdXBwb3J0OiBBbmRyb2lkIDQuMCAtIDQuMyBvbmx5CgkJLy8gU29tZSBzdHlsZXMgY29tZSBiYWNrIHdpdGggcGVyY2VudGFnZSB2YWx1ZXMsIGV2ZW4gdGhvdWdoIHRoZXkgc2hvdWxkbid0CgkJZGl2LnN0eWxlLm1hcmdpblJpZ2h0ID0gIjUwJSI7CgkJcGl4ZWxNYXJnaW5SaWdodFZhbCA9IGRpdlN0eWxlLm1hcmdpblJpZ2h0ID09PSAiNHB4IjsKCgkJZG9jdW1lbnRFbGVtZW50LnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTsKCX0KCglqUXVlcnkuZXh0ZW5kKCBzdXBwb3J0LCB7CgkJcGl4ZWxQb3NpdGlvbjogZnVuY3Rpb24oKSB7CgoJCQkvLyBUaGlzIHRlc3QgaXMgZXhlY3V0ZWQgb25seSBvbmNlIGJ1dCB3ZSBzdGlsbCBkbyBtZW1vaXppbmcKCQkJLy8gc2luY2Ugd2UgY2FuIHVzZSB0aGUgYm94U2l6aW5nUmVsaWFibGUgcHJlLWNvbXB1dGluZy4KCQkJLy8gTm8gbmVlZCB0byBjaGVjayBpZiB0aGUgdGVzdCB3YXMgYWxyZWFkeSBwZXJmb3JtZWQsIHRob3VnaC4KCQkJY29tcHV0ZVN0eWxlVGVzdHMoKTsKCQkJcmV0dXJuIHBpeGVsUG9zaXRpb25WYWw7CgkJfSwKCQlib3hTaXppbmdSZWxpYWJsZTogZnVuY3Rpb24oKSB7CgkJCWlmICggYm94U2l6aW5nUmVsaWFibGVWYWwgPT0gbnVsbCApIHsKCQkJCWNvbXB1dGVTdHlsZVRlc3RzKCk7CgkJCX0KCQkJcmV0dXJuIGJveFNpemluZ1JlbGlhYmxlVmFsOwoJCX0sCgkJcGl4ZWxNYXJnaW5SaWdodDogZnVuY3Rpb24oKSB7CgoJCQkvLyBTdXBwb3J0OiBBbmRyb2lkIDQuMC00LjMKCQkJLy8gV2UncmUgY2hlY2tpbmcgZm9yIGJveFNpemluZ1JlbGlhYmxlVmFsIGhlcmUgaW5zdGVhZCBvZiBwaXhlbE1hcmdpblJpZ2h0VmFsCgkJCS8vIHNpbmNlIHRoYXQgY29tcHJlc3NlcyBiZXR0ZXIgYW5kIHRoZXkncmUgY29tcHV0ZWQgdG9nZXRoZXIgYW55d2F5LgoJCQlpZiAoIGJveFNpemluZ1JlbGlhYmxlVmFsID09IG51bGwgKSB7CgkJCQljb21wdXRlU3R5bGVUZXN0cygpOwoJCQl9CgkJCXJldHVybiBwaXhlbE1hcmdpblJpZ2h0VmFsOwoJCX0sCgkJcmVsaWFibGVNYXJnaW5MZWZ0OiBmdW5jdGlvbigpIHsKCgkJCS8vIFN1cHBvcnQ6IElFIDw9OCBvbmx5LCBBbmRyb2lkIDQuMCAtIDQuMyBvbmx5LCBGaXJlZm94IDw9MyAtIDM3CgkJCWlmICggYm94U2l6aW5nUmVsaWFibGVWYWwgPT0gbnVsbCApIHsKCQkJCWNvbXB1dGVTdHlsZVRlc3RzKCk7CgkJCX0KCQkJcmV0dXJuIHJlbGlhYmxlTWFyZ2luTGVmdFZhbDsKCQl9LAoJCXJlbGlhYmxlTWFyZ2luUmlnaHQ6IGZ1bmN0aW9uKCkgewoKCQkJLy8gU3VwcG9ydDogQW5kcm9pZCAyLjMKCQkJLy8gQ2hlY2sgaWYgZGl2IHdpdGggZXhwbGljaXQgd2lkdGggYW5kIG5vIG1hcmdpbi1yaWdodCBpbmNvcnJlY3RseQoJCQkvLyBnZXRzIGNvbXB1dGVkIG1hcmdpbi1yaWdodCBiYXNlZCBvbiB3aWR0aCBvZiBjb250YWluZXIuICgjMzMzMykKCQkJLy8gV2ViS2l0IEJ1ZyAxMzM0MyAtIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyB3cm9uZyB2YWx1ZSBmb3IgbWFyZ2luLXJpZ2h0CgkJCS8vIFRoaXMgc3VwcG9ydCBmdW5jdGlvbiBpcyBvbmx5IGV4ZWN1dGVkIG9uY2Ugc28gbm8gbWVtb2l6aW5nIGlzIG5lZWRlZC4KCQkJdmFyIHJldCwKCQkJCW1hcmdpbkRpdiA9IGRpdi5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggImRpdiIgKSApOwoKCQkJLy8gUmVzZXQgQ1NTOiBib3gtc2l6aW5nOyBkaXNwbGF5OyBtYXJnaW47IGJvcmRlcjsgcGFkZGluZwoJCQltYXJnaW5EaXYuc3R5bGUuY3NzVGV4dCA9IGRpdi5zdHlsZS5jc3NUZXh0ID0KCgkJCQkvLyBTdXBwb3J0OiBBbmRyb2lkIDIuMwoJCQkJLy8gVmVuZG9yLXByZWZpeCBib3gtc2l6aW5nCgkJCQkiLXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94O2JveC1zaXppbmc6Y29udGVudC1ib3g7IiArCgkJCQkiZGlzcGxheTpibG9jazttYXJnaW46MDtib3JkZXI6MDtwYWRkaW5nOjAiOwoJCQltYXJnaW5EaXYuc3R5bGUubWFyZ2luUmlnaHQgPSBtYXJnaW5EaXYuc3R5bGUud2lkdGggPSAiMCI7CgkJCWRpdi5zdHlsZS53aWR0aCA9ICIxcHgiOwoJCQlkb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoIGNvbnRhaW5lciApOwoKCQkJcmV0ID0gIXBhcnNlRmxvYXQoIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKCBtYXJnaW5EaXYgKS5tYXJnaW5SaWdodCApOwoKCQkJZG9jdW1lbnRFbGVtZW50LnJlbW92ZUNoaWxkKCBjb250YWluZXIgKTsKCQkJZGl2LnJlbW92ZUNoaWxkKCBtYXJnaW5EaXYgKTsKCgkJCXJldHVybiByZXQ7CgkJfQoJfSApOwp9ICkoKTsKCgpmdW5jdGlvbiBjdXJDU1MoIGVsZW0sIG5hbWUsIGNvbXB1dGVkICkgewoJdmFyIHdpZHRoLCBtaW5XaWR0aCwgbWF4V2lkdGgsIHJldCwKCQlzdHlsZSA9IGVsZW0uc3R5bGU7CgoJY29tcHV0ZWQgPSBjb21wdXRlZCB8fCBnZXRTdHlsZXMoIGVsZW0gKTsKCXJldCA9IGNvbXB1dGVkID8gY29tcHV0ZWQuZ2V0UHJvcGVydHlWYWx1ZSggbmFtZSApIHx8IGNvbXB1dGVkWyBuYW1lIF0gOiB1bmRlZmluZWQ7CgoJLy8gU3VwcG9ydDogT3BlcmEgMTIuMXggb25seQoJLy8gRmFsbCBiYWNrIHRvIHN0eWxlIGV2ZW4gd2l0aG91dCBjb21wdXRlZAoJLy8gY29tcHV0ZWQgaXMgdW5kZWZpbmVkIGZvciBlbGVtcyBvbiBkb2N1bWVudCBmcmFnbWVudHMKCWlmICggKCByZXQgPT09ICIiIHx8IHJldCA9PT0gdW5kZWZpbmVkICkgJiYgIWpRdWVyeS5jb250YWlucyggZWxlbS5vd25lckRvY3VtZW50LCBlbGVtICkgKSB7CgkJcmV0ID0galF1ZXJ5LnN0eWxlKCBlbGVtLCBuYW1lICk7Cgl9CgoJLy8gU3VwcG9ydDogSUU5CgkvLyBnZXRQcm9wZXJ0eVZhbHVlIGlzIG9ubHkgbmVlZGVkIGZvciAuY3NzKCdmaWx0ZXInKSAoIzEyNTM3KQoJaWYgKCBjb21wdXRlZCApIHsKCgkJLy8gQSB0cmlidXRlIHRvIHRoZSAiYXdlc29tZSBoYWNrIGJ5IERlYW4gRWR3YXJkcyIKCQkvLyBBbmRyb2lkIEJyb3dzZXIgcmV0dXJucyBwZXJjZW50YWdlIGZvciBzb21lIHZhbHVlcywKCQkvLyBidXQgd2lkdGggc2VlbXMgdG8gYmUgcmVsaWFibHkgcGl4ZWxzLgoJCS8vIFRoaXMgaXMgYWdhaW5zdCB0aGUgQ1NTT00gZHJhZnQgc3BlYzoKCQkvLyBodHRwOi8vZGV2LnczLm9yZy9jc3N3Zy9jc3NvbS8jcmVzb2x2ZWQtdmFsdWVzCgkJaWYgKCAhc3VwcG9ydC5waXhlbE1hcmdpblJpZ2h0KCkgJiYgcm51bW5vbnB4LnRlc3QoIHJldCApICYmIHJtYXJnaW4udGVzdCggbmFtZSApICkgewoKCQkJLy8gUmVtZW1iZXIgdGhlIG9yaWdpbmFsIHZhbHVlcwoJCQl3aWR0aCA9IHN0eWxlLndpZHRoOwoJCQltaW5XaWR0aCA9IHN0eWxlLm1pbldpZHRoOwoJCQltYXhXaWR0aCA9IHN0eWxlLm1heFdpZHRoOwoKCQkJLy8gUHV0IGluIHRoZSBuZXcgdmFsdWVzIHRvIGdldCBhIGNvbXB1dGVkIHZhbHVlIG91dAoJCQlzdHlsZS5taW5XaWR0aCA9IHN0eWxlLm1heFdpZHRoID0gc3R5bGUud2lkdGggPSByZXQ7CgkJCXJldCA9IGNvbXB1dGVkLndpZHRoOwoKCQkJLy8gUmV2ZXJ0IHRoZSBjaGFuZ2VkIHZhbHVlcwoJCQlzdHlsZS53aWR0aCA9IHdpZHRoOwoJCQlzdHlsZS5taW5XaWR0aCA9IG1pbldpZHRoOwoJCQlzdHlsZS5tYXhXaWR0aCA9IG1heFdpZHRoOwoJCX0KCX0KCglyZXR1cm4gcmV0ICE9PSB1bmRlZmluZWQgPwoKCQkvLyBTdXBwb3J0OiBJRTktMTErCgkJLy8gSUUgcmV0dXJucyB6SW5kZXggdmFsdWUgYXMgYW4gaW50ZWdlci4KCQlyZXQgKyAiIiA6CgkJcmV0Owp9CgoKZnVuY3Rpb24gYWRkR2V0SG9va0lmKCBjb25kaXRpb25GbiwgaG9va0ZuICkgewoKCS8vIERlZmluZSB0aGUgaG9vaywgd2UnbGwgY2hlY2sgb24gdGhlIGZpcnN0IHJ1biBpZiBpdCdzIHJlYWxseSBuZWVkZWQuCglyZXR1cm4gewoJCWdldDogZnVuY3Rpb24oKSB7CgkJCWlmICggY29uZGl0aW9uRm4oKSApIHsKCgkJCQkvLyBIb29rIG5vdCBuZWVkZWQgKG9yIGl0J3Mgbm90IHBvc3NpYmxlIHRvIHVzZSBpdCBkdWUKCQkJCS8vIHRvIG1pc3NpbmcgZGVwZW5kZW5jeSksIHJlbW92ZSBpdC4KCQkJCWRlbGV0ZSB0aGlzLmdldDsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gSG9vayBuZWVkZWQ7IHJlZGVmaW5lIGl0IHNvIHRoYXQgdGhlIHN1cHBvcnQgdGVzdCBpcyBub3QgZXhlY3V0ZWQgYWdhaW4uCgkJCXJldHVybiAoIHRoaXMuZ2V0ID0gaG9va0ZuICkuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJCX0KCX07Cn0KCgp2YXIKCgkvLyBTd2FwcGFibGUgaWYgZGlzcGxheSBpcyBub25lIG9yIHN0YXJ0cyB3aXRoIHRhYmxlCgkvLyBleGNlcHQgInRhYmxlIiwgInRhYmxlLWNlbGwiLCBvciAidGFibGUtY2FwdGlvbiIKCS8vIFNlZSBoZXJlIGZvciBkaXNwbGF5IHZhbHVlczogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9DU1MvZGlzcGxheQoJcmRpc3BsYXlzd2FwID0gL14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLAoKCWNzc1Nob3cgPSB7IHBvc2l0aW9uOiAiYWJzb2x1dGUiLCB2aXNpYmlsaXR5OiAiaGlkZGVuIiwgZGlzcGxheTogImJsb2NrIiB9LAoJY3NzTm9ybWFsVHJhbnNmb3JtID0gewoJCWxldHRlclNwYWNpbmc6ICIwIiwKCQlmb250V2VpZ2h0OiAiNDAwIgoJfSwKCgljc3NQcmVmaXhlcyA9IFsgIldlYmtpdCIsICJPIiwgIk1veiIsICJtcyIgXSwKCWVtcHR5U3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiZGl2IiApLnN0eWxlOwoKLy8gUmV0dXJuIGEgY3NzIHByb3BlcnR5IG1hcHBlZCB0byBhIHBvdGVudGlhbGx5IHZlbmRvciBwcmVmaXhlZCBwcm9wZXJ0eQpmdW5jdGlvbiB2ZW5kb3JQcm9wTmFtZSggbmFtZSApIHsKCgkvLyBTaG9ydGN1dCBmb3IgbmFtZXMgdGhhdCBhcmUgbm90IHZlbmRvciBwcmVmaXhlZAoJaWYgKCBuYW1lIGluIGVtcHR5U3R5bGUgKSB7CgkJcmV0dXJuIG5hbWU7Cgl9CgoJLy8gQ2hlY2sgZm9yIHZlbmRvciBwcmVmaXhlZCBuYW1lcwoJdmFyIGNhcE5hbWUgPSBuYW1lWyAwIF0udG9VcHBlckNhc2UoKSArIG5hbWUuc2xpY2UoIDEgKSwKCQlpID0gY3NzUHJlZml4ZXMubGVuZ3RoOwoKCXdoaWxlICggaS0tICkgewoJCW5hbWUgPSBjc3NQcmVmaXhlc1sgaSBdICsgY2FwTmFtZTsKCQlpZiAoIG5hbWUgaW4gZW1wdHlTdHlsZSApIHsKCQkJcmV0dXJuIG5hbWU7CgkJfQoJfQp9CgpmdW5jdGlvbiBzZXRQb3NpdGl2ZU51bWJlciggZWxlbSwgdmFsdWUsIHN1YnRyYWN0ICkgewoKCS8vIEFueSByZWxhdGl2ZSAoKy8tKSB2YWx1ZXMgaGF2ZSBhbHJlYWR5IGJlZW4KCS8vIG5vcm1hbGl6ZWQgYXQgdGhpcyBwb2ludAoJdmFyIG1hdGNoZXMgPSByY3NzTnVtLmV4ZWMoIHZhbHVlICk7CglyZXR1cm4gbWF0Y2hlcyA/CgoJCS8vIEd1YXJkIGFnYWluc3QgdW5kZWZpbmVkICJzdWJ0cmFjdCIsIGUuZy4sIHdoZW4gdXNlZCBhcyBpbiBjc3NIb29rcwoJCU1hdGgubWF4KCAwLCBtYXRjaGVzWyAyIF0gLSAoIHN1YnRyYWN0IHx8IDAgKSApICsgKCBtYXRjaGVzWyAzIF0gfHwgInB4IiApIDoKCQl2YWx1ZTsKfQoKZnVuY3Rpb24gYXVnbWVudFdpZHRoT3JIZWlnaHQoIGVsZW0sIG5hbWUsIGV4dHJhLCBpc0JvcmRlckJveCwgc3R5bGVzICkgewoJdmFyIGkgPSBleHRyYSA9PT0gKCBpc0JvcmRlckJveCA/ICJib3JkZXIiIDogImNvbnRlbnQiICkgPwoKCQkvLyBJZiB3ZSBhbHJlYWR5IGhhdmUgdGhlIHJpZ2h0IG1lYXN1cmVtZW50LCBhdm9pZCBhdWdtZW50YXRpb24KCQk0IDoKCgkJLy8gT3RoZXJ3aXNlIGluaXRpYWxpemUgZm9yIGhvcml6b250YWwgb3IgdmVydGljYWwgcHJvcGVydGllcwoJCW5hbWUgPT09ICJ3aWR0aCIgPyAxIDogMCwKCgkJdmFsID0gMDsKCglmb3IgKCA7IGkgPCA0OyBpICs9IDIgKSB7CgoJCS8vIEJvdGggYm94IG1vZGVscyBleGNsdWRlIG1hcmdpbiwgc28gYWRkIGl0IGlmIHdlIHdhbnQgaXQKCQlpZiAoIGV4dHJhID09PSAibWFyZ2luIiApIHsKCQkJdmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sIGV4dHJhICsgY3NzRXhwYW5kWyBpIF0sIHRydWUsIHN0eWxlcyApOwoJCX0KCgkJaWYgKCBpc0JvcmRlckJveCApIHsKCgkJCS8vIGJvcmRlci1ib3ggaW5jbHVkZXMgcGFkZGluZywgc28gcmVtb3ZlIGl0IGlmIHdlIHdhbnQgY29udGVudAoJCQlpZiAoIGV4dHJhID09PSAiY29udGVudCIgKSB7CgkJCQl2YWwgLT0galF1ZXJ5LmNzcyggZWxlbSwgInBhZGRpbmciICsgY3NzRXhwYW5kWyBpIF0sIHRydWUsIHN0eWxlcyApOwoJCQl9CgoJCQkvLyBBdCB0aGlzIHBvaW50LCBleHRyYSBpc24ndCBib3JkZXIgbm9yIG1hcmdpbiwgc28gcmVtb3ZlIGJvcmRlcgoJCQlpZiAoIGV4dHJhICE9PSAibWFyZ2luIiApIHsKCQkJCXZhbCAtPSBqUXVlcnkuY3NzKCBlbGVtLCAiYm9yZGVyIiArIGNzc0V4cGFuZFsgaSBdICsgIldpZHRoIiwgdHJ1ZSwgc3R5bGVzICk7CgkJCX0KCQl9IGVsc2UgewoKCQkJLy8gQXQgdGhpcyBwb2ludCwgZXh0cmEgaXNuJ3QgY29udGVudCwgc28gYWRkIHBhZGRpbmcKCQkJdmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sICJwYWRkaW5nIiArIGNzc0V4cGFuZFsgaSBdLCB0cnVlLCBzdHlsZXMgKTsKCgkJCS8vIEF0IHRoaXMgcG9pbnQsIGV4dHJhIGlzbid0IGNvbnRlbnQgbm9yIHBhZGRpbmcsIHNvIGFkZCBib3JkZXIKCQkJaWYgKCBleHRyYSAhPT0gInBhZGRpbmciICkgewoJCQkJdmFsICs9IGpRdWVyeS5jc3MoIGVsZW0sICJib3JkZXIiICsgY3NzRXhwYW5kWyBpIF0gKyAiV2lkdGgiLCB0cnVlLCBzdHlsZXMgKTsKCQkJfQoJCX0KCX0KCglyZXR1cm4gdmFsOwp9CgpmdW5jdGlvbiBnZXRXaWR0aE9ySGVpZ2h0KCBlbGVtLCBuYW1lLCBleHRyYSApIHsKCgkvLyBTdGFydCB3aXRoIG9mZnNldCBwcm9wZXJ0eSwgd2hpY2ggaXMgZXF1aXZhbGVudCB0byB0aGUgYm9yZGVyLWJveCB2YWx1ZQoJdmFyIHZhbHVlSXNCb3JkZXJCb3ggPSB0cnVlLAoJCXZhbCA9IG5hbWUgPT09ICJ3aWR0aCIgPyBlbGVtLm9mZnNldFdpZHRoIDogZWxlbS5vZmZzZXRIZWlnaHQsCgkJc3R5bGVzID0gZ2V0U3R5bGVzKCBlbGVtICksCgkJaXNCb3JkZXJCb3ggPSBqUXVlcnkuY3NzKCBlbGVtLCAiYm94U2l6aW5nIiwgZmFsc2UsIHN0eWxlcyApID09PSAiYm9yZGVyLWJveCI7CgoJLy8gU3VwcG9ydDogSUUxMSBvbmx5CgkvLyBJbiBJRSAxMSBmdWxsc2NyZWVuIGVsZW1lbnRzIGluc2lkZSBvZiBhbiBpZnJhbWUgaGF2ZQoJLy8gMTAweCB0b28gc21hbGwgZGltZW5zaW9ucyAoZ2gtMTc2NCkuCglpZiAoIGRvY3VtZW50Lm1zRnVsbHNjcmVlbkVsZW1lbnQgJiYgd2luZG93LnRvcCAhPT0gd2luZG93ICkgewoKCQkvLyBTdXBwb3J0OiBJRTExIG9ubHkKCQkvLyBSdW5uaW5nIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBvbiBhIGRpc2Nvbm5lY3RlZCBub2RlCgkJLy8gaW4gSUUgdGhyb3dzIGFuIGVycm9yLgoJCWlmICggZWxlbS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCApIHsKCQkJdmFsID0gTWF0aC5yb3VuZCggZWxlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVsgbmFtZSBdICogMTAwICk7CgkJfQoJfQoKCS8vIFNvbWUgbm9uLWh0bWwgZWxlbWVudHMgcmV0dXJuIHVuZGVmaW5lZCBmb3Igb2Zmc2V0V2lkdGgsIHNvIGNoZWNrIGZvciBudWxsL3VuZGVmaW5lZAoJLy8gc3ZnIC0gaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9NjQ5Mjg1CgkvLyBNYXRoTUwgLSBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD00OTE2NjgKCWlmICggdmFsIDw9IDAgfHwgdmFsID09IG51bGwgKSB7CgoJCS8vIEZhbGwgYmFjayB0byBjb21wdXRlZCB0aGVuIHVuY29tcHV0ZWQgY3NzIGlmIG5lY2Vzc2FyeQoJCXZhbCA9IGN1ckNTUyggZWxlbSwgbmFtZSwgc3R5bGVzICk7CgkJaWYgKCB2YWwgPCAwIHx8IHZhbCA9PSBudWxsICkgewoJCQl2YWwgPSBlbGVtLnN0eWxlWyBuYW1lIF07CgkJfQoKCQkvLyBDb21wdXRlZCB1bml0IGlzIG5vdCBwaXhlbHMuIFN0b3AgaGVyZSBhbmQgcmV0dXJuLgoJCWlmICggcm51bW5vbnB4LnRlc3QoIHZhbCApICkgewoJCQlyZXR1cm4gdmFsOwoJCX0KCgkJLy8gQ2hlY2sgZm9yIHN0eWxlIGluIGNhc2UgYSBicm93c2VyIHdoaWNoIHJldHVybnMgdW5yZWxpYWJsZSB2YWx1ZXMKCQkvLyBmb3IgZ2V0Q29tcHV0ZWRTdHlsZSBzaWxlbnRseSBmYWxscyBiYWNrIHRvIHRoZSByZWxpYWJsZSBlbGVtLnN0eWxlCgkJdmFsdWVJc0JvcmRlckJveCA9IGlzQm9yZGVyQm94ICYmCgkJCSggc3VwcG9ydC5ib3hTaXppbmdSZWxpYWJsZSgpIHx8IHZhbCA9PT0gZWxlbS5zdHlsZVsgbmFtZSBdICk7CgoJCS8vIE5vcm1hbGl6ZSAiIiwgYXV0bywgYW5kIHByZXBhcmUgZm9yIGV4dHJhCgkJdmFsID0gcGFyc2VGbG9hdCggdmFsICkgfHwgMDsKCX0KCgkvLyBVc2UgdGhlIGFjdGl2ZSBib3gtc2l6aW5nIG1vZGVsIHRvIGFkZC9zdWJ0cmFjdCBpcnJlbGV2YW50IHN0eWxlcwoJcmV0dXJuICggdmFsICsKCQlhdWdtZW50V2lkdGhPckhlaWdodCgKCQkJZWxlbSwKCQkJbmFtZSwKCQkJZXh0cmEgfHwgKCBpc0JvcmRlckJveCA/ICJib3JkZXIiIDogImNvbnRlbnQiICksCgkJCXZhbHVlSXNCb3JkZXJCb3gsCgkJCXN0eWxlcwoJCSkKCSkgKyAicHgiOwp9CgpmdW5jdGlvbiBzaG93SGlkZSggZWxlbWVudHMsIHNob3cgKSB7Cgl2YXIgZGlzcGxheSwgZWxlbSwgaGlkZGVuLAoJCXZhbHVlcyA9IFtdLAoJCWluZGV4ID0gMCwKCQlsZW5ndGggPSBlbGVtZW50cy5sZW5ndGg7CgoJZm9yICggOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHsKCQllbGVtID0gZWxlbWVudHNbIGluZGV4IF07CgkJaWYgKCAhZWxlbS5zdHlsZSApIHsKCQkJY29udGludWU7CgkJfQoKCQl2YWx1ZXNbIGluZGV4IF0gPSBkYXRhUHJpdi5nZXQoIGVsZW0sICJvbGRkaXNwbGF5IiApOwoJCWRpc3BsYXkgPSBlbGVtLnN0eWxlLmRpc3BsYXk7CgkJaWYgKCBzaG93ICkgewoKCQkJLy8gUmVzZXQgdGhlIGlubGluZSBkaXNwbGF5IG9mIHRoaXMgZWxlbWVudCB0byBsZWFybiBpZiBpdCBpcwoJCQkvLyBiZWluZyBoaWRkZW4gYnkgY2FzY2FkZWQgcnVsZXMgb3Igbm90CgkJCWlmICggIXZhbHVlc1sgaW5kZXggXSAmJiBkaXNwbGF5ID09PSAibm9uZSIgKSB7CgkJCQllbGVtLnN0eWxlLmRpc3BsYXkgPSAiIjsKCQkJfQoKCQkJLy8gU2V0IGVsZW1lbnRzIHdoaWNoIGhhdmUgYmVlbiBvdmVycmlkZGVuIHdpdGggZGlzcGxheTogbm9uZQoJCQkvLyBpbiBhIHN0eWxlc2hlZXQgdG8gd2hhdGV2ZXIgdGhlIGRlZmF1bHQgYnJvd3NlciBzdHlsZSBpcwoJCQkvLyBmb3Igc3VjaCBhbiBlbGVtZW50CgkJCWlmICggZWxlbS5zdHlsZS5kaXNwbGF5ID09PSAiIiAmJiBpc0hpZGRlbiggZWxlbSApICkgewoJCQkJdmFsdWVzWyBpbmRleCBdID0gZGF0YVByaXYuYWNjZXNzKAoJCQkJCWVsZW0sCgkJCQkJIm9sZGRpc3BsYXkiLAoJCQkJCWRlZmF1bHREaXNwbGF5KCBlbGVtLm5vZGVOYW1lICkKCQkJCSk7CgkJCX0KCQl9IGVsc2UgewoJCQloaWRkZW4gPSBpc0hpZGRlbiggZWxlbSApOwoKCQkJaWYgKCBkaXNwbGF5ICE9PSAibm9uZSIgfHwgIWhpZGRlbiApIHsKCQkJCWRhdGFQcml2LnNldCgKCQkJCQllbGVtLAoJCQkJCSJvbGRkaXNwbGF5IiwKCQkJCQloaWRkZW4gPyBkaXNwbGF5IDogalF1ZXJ5LmNzcyggZWxlbSwgImRpc3BsYXkiICkKCQkJCSk7CgkJCX0KCQl9Cgl9CgoJLy8gU2V0IHRoZSBkaXNwbGF5IG9mIG1vc3Qgb2YgdGhlIGVsZW1lbnRzIGluIGEgc2Vjb25kIGxvb3AKCS8vIHRvIGF2b2lkIHRoZSBjb25zdGFudCByZWZsb3cKCWZvciAoIGluZGV4ID0gMDsgaW5kZXggPCBsZW5ndGg7IGluZGV4KysgKSB7CgkJZWxlbSA9IGVsZW1lbnRzWyBpbmRleCBdOwoJCWlmICggIWVsZW0uc3R5bGUgKSB7CgkJCWNvbnRpbnVlOwoJCX0KCQlpZiAoICFzaG93IHx8IGVsZW0uc3R5bGUuZGlzcGxheSA9PT0gIm5vbmUiIHx8IGVsZW0uc3R5bGUuZGlzcGxheSA9PT0gIiIgKSB7CgkJCWVsZW0uc3R5bGUuZGlzcGxheSA9IHNob3cgPyB2YWx1ZXNbIGluZGV4IF0gfHwgIiIgOiAibm9uZSI7CgkJfQoJfQoKCXJldHVybiBlbGVtZW50czsKfQoKalF1ZXJ5LmV4dGVuZCggewoKCS8vIEFkZCBpbiBzdHlsZSBwcm9wZXJ0eSBob29rcyBmb3Igb3ZlcnJpZGluZyB0aGUgZGVmYXVsdAoJLy8gYmVoYXZpb3Igb2YgZ2V0dGluZyBhbmQgc2V0dGluZyBhIHN0eWxlIHByb3BlcnR5Cgljc3NIb29rczogewoJCW9wYWNpdHk6IHsKCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQgKSB7CgkJCQlpZiAoIGNvbXB1dGVkICkgewoKCQkJCQkvLyBXZSBzaG91bGQgYWx3YXlzIGdldCBhIG51bWJlciBiYWNrIGZyb20gb3BhY2l0eQoJCQkJCXZhciByZXQgPSBjdXJDU1MoIGVsZW0sICJvcGFjaXR5IiApOwoJCQkJCXJldHVybiByZXQgPT09ICIiID8gIjEiIDogcmV0OwoJCQkJfQoJCQl9CgkJfQoJfSwKCgkvLyBEb24ndCBhdXRvbWF0aWNhbGx5IGFkZCAicHgiIHRvIHRoZXNlIHBvc3NpYmx5LXVuaXRsZXNzIHByb3BlcnRpZXMKCWNzc051bWJlcjogewoJCSJhbmltYXRpb25JdGVyYXRpb25Db3VudCI6IHRydWUsCgkJImNvbHVtbkNvdW50IjogdHJ1ZSwKCQkiZmlsbE9wYWNpdHkiOiB0cnVlLAoJCSJmbGV4R3JvdyI6IHRydWUsCgkJImZsZXhTaHJpbmsiOiB0cnVlLAoJCSJmb250V2VpZ2h0IjogdHJ1ZSwKCQkibGluZUhlaWdodCI6IHRydWUsCgkJIm9wYWNpdHkiOiB0cnVlLAoJCSJvcmRlciI6IHRydWUsCgkJIm9ycGhhbnMiOiB0cnVlLAoJCSJ3aWRvd3MiOiB0cnVlLAoJCSJ6SW5kZXgiOiB0cnVlLAoJCSJ6b29tIjogdHJ1ZQoJfSwKCgkvLyBBZGQgaW4gcHJvcGVydGllcyB3aG9zZSBuYW1lcyB5b3Ugd2lzaCB0byBmaXggYmVmb3JlCgkvLyBzZXR0aW5nIG9yIGdldHRpbmcgdGhlIHZhbHVlCgljc3NQcm9wczogewoJCSJmbG9hdCI6ICJjc3NGbG9hdCIKCX0sCgoJLy8gR2V0IGFuZCBzZXQgdGhlIHN0eWxlIHByb3BlcnR5IG9uIGEgRE9NIE5vZGUKCXN0eWxlOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUsIGV4dHJhICkgewoKCQkvLyBEb24ndCBzZXQgc3R5bGVzIG9uIHRleHQgYW5kIGNvbW1lbnQgbm9kZXMKCQlpZiAoICFlbGVtIHx8IGVsZW0ubm9kZVR5cGUgPT09IDMgfHwgZWxlbS5ub2RlVHlwZSA9PT0gOCB8fCAhZWxlbS5zdHlsZSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJLy8gTWFrZSBzdXJlIHRoYXQgd2UncmUgd29ya2luZyB3aXRoIHRoZSByaWdodCBuYW1lCgkJdmFyIHJldCwgdHlwZSwgaG9va3MsCgkJCW9yaWdOYW1lID0galF1ZXJ5LmNhbWVsQ2FzZSggbmFtZSApLAoJCQlzdHlsZSA9IGVsZW0uc3R5bGU7CgoJCW5hbWUgPSBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gfHwKCQkJKCBqUXVlcnkuY3NzUHJvcHNbIG9yaWdOYW1lIF0gPSB2ZW5kb3JQcm9wTmFtZSggb3JpZ05hbWUgKSB8fCBvcmlnTmFtZSApOwoKCQkvLyBHZXRzIGhvb2sgZm9yIHRoZSBwcmVmaXhlZCB2ZXJzaW9uLCB0aGVuIHVucHJlZml4ZWQgdmVyc2lvbgoJCWhvb2tzID0galF1ZXJ5LmNzc0hvb2tzWyBuYW1lIF0gfHwgalF1ZXJ5LmNzc0hvb2tzWyBvcmlnTmFtZSBdOwoKCQkvLyBDaGVjayBpZiB3ZSdyZSBzZXR0aW5nIGEgdmFsdWUKCQlpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7CgkJCXR5cGUgPSB0eXBlb2YgdmFsdWU7CgoJCQkvLyBDb252ZXJ0ICIrPSIgb3IgIi09IiB0byByZWxhdGl2ZSBudW1iZXJzICgjNzM0NSkKCQkJaWYgKCB0eXBlID09PSAic3RyaW5nIiAmJiAoIHJldCA9IHJjc3NOdW0uZXhlYyggdmFsdWUgKSApICYmIHJldFsgMSBdICkgewoJCQkJdmFsdWUgPSBhZGp1c3RDU1MoIGVsZW0sIG5hbWUsIHJldCApOwoKCQkJCS8vIEZpeGVzIGJ1ZyAjOTIzNwoJCQkJdHlwZSA9ICJudW1iZXIiOwoJCQl9CgoJCQkvLyBNYWtlIHN1cmUgdGhhdCBudWxsIGFuZCBOYU4gdmFsdWVzIGFyZW4ndCBzZXQgKCM3MTE2KQoJCQlpZiAoIHZhbHVlID09IG51bGwgfHwgdmFsdWUgIT09IHZhbHVlICkgewoJCQkJcmV0dXJuOwoJCQl9CgoJCQkvLyBJZiBhIG51bWJlciB3YXMgcGFzc2VkIGluLCBhZGQgdGhlIHVuaXQgKGV4Y2VwdCBmb3IgY2VydGFpbiBDU1MgcHJvcGVydGllcykKCQkJaWYgKCB0eXBlID09PSAibnVtYmVyIiApIHsKCQkJCXZhbHVlICs9IHJldCAmJiByZXRbIDMgXSB8fCAoIGpRdWVyeS5jc3NOdW1iZXJbIG9yaWdOYW1lIF0gPyAiIiA6ICJweCIgKTsKCQkJfQoKCQkJLy8gU3VwcG9ydDogSUU5LTExKwoJCQkvLyBiYWNrZ3JvdW5kLSogcHJvcHMgYWZmZWN0IG9yaWdpbmFsIGNsb25lJ3MgdmFsdWVzCgkJCWlmICggIXN1cHBvcnQuY2xlYXJDbG9uZVN0eWxlICYmIHZhbHVlID09PSAiIiAmJiBuYW1lLmluZGV4T2YoICJiYWNrZ3JvdW5kIiApID09PSAwICkgewoJCQkJc3R5bGVbIG5hbWUgXSA9ICJpbmhlcml0IjsKCQkJfQoKCQkJLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCwgdXNlIHRoYXQgdmFsdWUsIG90aGVyd2lzZSBqdXN0IHNldCB0aGUgc3BlY2lmaWVkIHZhbHVlCgkJCWlmICggIWhvb2tzIHx8ICEoICJzZXQiIGluIGhvb2tzICkgfHwKCQkJCSggdmFsdWUgPSBob29rcy5zZXQoIGVsZW0sIHZhbHVlLCBleHRyYSApICkgIT09IHVuZGVmaW5lZCApIHsKCgkJCQlzdHlsZVsgbmFtZSBdID0gdmFsdWU7CgkJCX0KCgkJfSBlbHNlIHsKCgkJCS8vIElmIGEgaG9vayB3YXMgcHJvdmlkZWQgZ2V0IHRoZSBub24tY29tcHV0ZWQgdmFsdWUgZnJvbSB0aGVyZQoJCQlpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICYmCgkJCQkoIHJldCA9IGhvb2tzLmdldCggZWxlbSwgZmFsc2UsIGV4dHJhICkgKSAhPT0gdW5kZWZpbmVkICkgewoKCQkJCXJldHVybiByZXQ7CgkJCX0KCgkJCS8vIE90aGVyd2lzZSBqdXN0IGdldCB0aGUgdmFsdWUgZnJvbSB0aGUgc3R5bGUgb2JqZWN0CgkJCXJldHVybiBzdHlsZVsgbmFtZSBdOwoJCX0KCX0sCgoJY3NzOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgZXh0cmEsIHN0eWxlcyApIHsKCQl2YXIgdmFsLCBudW0sIGhvb2tzLAoJCQlvcmlnTmFtZSA9IGpRdWVyeS5jYW1lbENhc2UoIG5hbWUgKTsKCgkJLy8gTWFrZSBzdXJlIHRoYXQgd2UncmUgd29ya2luZyB3aXRoIHRoZSByaWdodCBuYW1lCgkJbmFtZSA9IGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSB8fAoJCQkoIGpRdWVyeS5jc3NQcm9wc1sgb3JpZ05hbWUgXSA9IHZlbmRvclByb3BOYW1lKCBvcmlnTmFtZSApIHx8IG9yaWdOYW1lICk7CgoJCS8vIFRyeSBwcmVmaXhlZCBuYW1lIGZvbGxvd2VkIGJ5IHRoZSB1bnByZWZpeGVkIG5hbWUKCQlob29rcyA9IGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdIHx8IGpRdWVyeS5jc3NIb29rc1sgb3JpZ05hbWUgXTsKCgkJLy8gSWYgYSBob29rIHdhcyBwcm92aWRlZCBnZXQgdGhlIGNvbXB1dGVkIHZhbHVlIGZyb20gdGhlcmUKCQlpZiAoIGhvb2tzICYmICJnZXQiIGluIGhvb2tzICkgewoJCQl2YWwgPSBob29rcy5nZXQoIGVsZW0sIHRydWUsIGV4dHJhICk7CgkJfQoKCQkvLyBPdGhlcndpc2UsIGlmIGEgd2F5IHRvIGdldCB0aGUgY29tcHV0ZWQgdmFsdWUgZXhpc3RzLCB1c2UgdGhhdAoJCWlmICggdmFsID09PSB1bmRlZmluZWQgKSB7CgkJCXZhbCA9IGN1ckNTUyggZWxlbSwgbmFtZSwgc3R5bGVzICk7CgkJfQoKCQkvLyBDb252ZXJ0ICJub3JtYWwiIHRvIGNvbXB1dGVkIHZhbHVlCgkJaWYgKCB2YWwgPT09ICJub3JtYWwiICYmIG5hbWUgaW4gY3NzTm9ybWFsVHJhbnNmb3JtICkgewoJCQl2YWwgPSBjc3NOb3JtYWxUcmFuc2Zvcm1bIG5hbWUgXTsKCQl9CgoJCS8vIE1ha2UgbnVtZXJpYyBpZiBmb3JjZWQgb3IgYSBxdWFsaWZpZXIgd2FzIHByb3ZpZGVkIGFuZCB2YWwgbG9va3MgbnVtZXJpYwoJCWlmICggZXh0cmEgPT09ICIiIHx8IGV4dHJhICkgewoJCQludW0gPSBwYXJzZUZsb2F0KCB2YWwgKTsKCQkJcmV0dXJuIGV4dHJhID09PSB0cnVlIHx8IGlzRmluaXRlKCBudW0gKSA/IG51bSB8fCAwIDogdmFsOwoJCX0KCQlyZXR1cm4gdmFsOwoJfQp9ICk7CgpqUXVlcnkuZWFjaCggWyAiaGVpZ2h0IiwgIndpZHRoIiBdLCBmdW5jdGlvbiggaSwgbmFtZSApIHsKCWpRdWVyeS5jc3NIb29rc1sgbmFtZSBdID0gewoJCWdldDogZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkLCBleHRyYSApIHsKCQkJaWYgKCBjb21wdXRlZCApIHsKCgkJCQkvLyBDZXJ0YWluIGVsZW1lbnRzIGNhbiBoYXZlIGRpbWVuc2lvbiBpbmZvIGlmIHdlIGludmlzaWJseSBzaG93IHRoZW0KCQkJCS8vIGJ1dCBpdCBtdXN0IGhhdmUgYSBjdXJyZW50IGRpc3BsYXkgc3R5bGUgdGhhdCB3b3VsZCBiZW5lZml0CgkJCQlyZXR1cm4gcmRpc3BsYXlzd2FwLnRlc3QoIGpRdWVyeS5jc3MoIGVsZW0sICJkaXNwbGF5IiApICkgJiYKCQkJCQllbGVtLm9mZnNldFdpZHRoID09PSAwID8KCQkJCQkJc3dhcCggZWxlbSwgY3NzU2hvdywgZnVuY3Rpb24oKSB7CgkJCQkJCQlyZXR1cm4gZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTsKCQkJCQkJfSApIDoKCQkJCQkJZ2V0V2lkdGhPckhlaWdodCggZWxlbSwgbmFtZSwgZXh0cmEgKTsKCQkJfQoJCX0sCgoJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlLCBleHRyYSApIHsKCQkJdmFyIG1hdGNoZXMsCgkJCQlzdHlsZXMgPSBleHRyYSAmJiBnZXRTdHlsZXMoIGVsZW0gKSwKCQkJCXN1YnRyYWN0ID0gZXh0cmEgJiYgYXVnbWVudFdpZHRoT3JIZWlnaHQoCgkJCQkJZWxlbSwKCQkJCQluYW1lLAoJCQkJCWV4dHJhLAoJCQkJCWpRdWVyeS5jc3MoIGVsZW0sICJib3hTaXppbmciLCBmYWxzZSwgc3R5bGVzICkgPT09ICJib3JkZXItYm94IiwKCQkJCQlzdHlsZXMKCQkJCSk7CgoJCQkvLyBDb252ZXJ0IHRvIHBpeGVscyBpZiB2YWx1ZSBhZGp1c3RtZW50IGlzIG5lZWRlZAoJCQlpZiAoIHN1YnRyYWN0ICYmICggbWF0Y2hlcyA9IHJjc3NOdW0uZXhlYyggdmFsdWUgKSApICYmCgkJCQkoIG1hdGNoZXNbIDMgXSB8fCAicHgiICkgIT09ICJweCIgKSB7CgoJCQkJZWxlbS5zdHlsZVsgbmFtZSBdID0gdmFsdWU7CgkJCQl2YWx1ZSA9IGpRdWVyeS5jc3MoIGVsZW0sIG5hbWUgKTsKCQkJfQoKCQkJcmV0dXJuIHNldFBvc2l0aXZlTnVtYmVyKCBlbGVtLCB2YWx1ZSwgc3VidHJhY3QgKTsKCQl9Cgl9Owp9ICk7CgpqUXVlcnkuY3NzSG9va3MubWFyZ2luTGVmdCA9IGFkZEdldEhvb2tJZiggc3VwcG9ydC5yZWxpYWJsZU1hcmdpbkxlZnQsCglmdW5jdGlvbiggZWxlbSwgY29tcHV0ZWQgKSB7CgkJaWYgKCBjb21wdXRlZCApIHsKCQkJcmV0dXJuICggcGFyc2VGbG9hdCggY3VyQ1NTKCBlbGVtLCAibWFyZ2luTGVmdCIgKSApIHx8CgkJCQllbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgLQoJCQkJCXN3YXAoIGVsZW0sIHsgbWFyZ2luTGVmdDogMCB9LCBmdW5jdGlvbigpIHsKCQkJCQkJcmV0dXJuIGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDsKCQkJCQl9ICkKCQkJCSkgKyAicHgiOwoJCX0KCX0KKTsKCi8vIFN1cHBvcnQ6IEFuZHJvaWQgMi4zCmpRdWVyeS5jc3NIb29rcy5tYXJnaW5SaWdodCA9IGFkZEdldEhvb2tJZiggc3VwcG9ydC5yZWxpYWJsZU1hcmdpblJpZ2h0LAoJZnVuY3Rpb24oIGVsZW0sIGNvbXB1dGVkICkgewoJCWlmICggY29tcHV0ZWQgKSB7CgkJCXJldHVybiBzd2FwKCBlbGVtLCB7ICJkaXNwbGF5IjogImlubGluZS1ibG9jayIgfSwKCQkJCWN1ckNTUywgWyBlbGVtLCAibWFyZ2luUmlnaHQiIF0gKTsKCQl9Cgl9Cik7CgovLyBUaGVzZSBob29rcyBhcmUgdXNlZCBieSBhbmltYXRlIHRvIGV4cGFuZCBwcm9wZXJ0aWVzCmpRdWVyeS5lYWNoKCB7CgltYXJnaW46ICIiLAoJcGFkZGluZzogIiIsCglib3JkZXI6ICJXaWR0aCIKfSwgZnVuY3Rpb24oIHByZWZpeCwgc3VmZml4ICkgewoJalF1ZXJ5LmNzc0hvb2tzWyBwcmVmaXggKyBzdWZmaXggXSA9IHsKCQlleHBhbmQ6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJdmFyIGkgPSAwLAoJCQkJZXhwYW5kZWQgPSB7fSwKCgkJCQkvLyBBc3N1bWVzIGEgc2luZ2xlIG51bWJlciBpZiBub3QgYSBzdHJpbmcKCQkJCXBhcnRzID0gdHlwZW9mIHZhbHVlID09PSAic3RyaW5nIiA/IHZhbHVlLnNwbGl0KCAiICIgKSA6IFsgdmFsdWUgXTsKCgkJCWZvciAoIDsgaSA8IDQ7IGkrKyApIHsKCQkJCWV4cGFuZGVkWyBwcmVmaXggKyBjc3NFeHBhbmRbIGkgXSArIHN1ZmZpeCBdID0KCQkJCQlwYXJ0c1sgaSBdIHx8IHBhcnRzWyBpIC0gMiBdIHx8IHBhcnRzWyAwIF07CgkJCX0KCgkJCXJldHVybiBleHBhbmRlZDsKCQl9Cgl9OwoKCWlmICggIXJtYXJnaW4udGVzdCggcHJlZml4ICkgKSB7CgkJalF1ZXJ5LmNzc0hvb2tzWyBwcmVmaXggKyBzdWZmaXggXS5zZXQgPSBzZXRQb3NpdGl2ZU51bWJlcjsKCX0KfSApOwoKalF1ZXJ5LmZuLmV4dGVuZCggewoJY3NzOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJcmV0dXJuIGFjY2VzcyggdGhpcywgZnVuY3Rpb24oIGVsZW0sIG5hbWUsIHZhbHVlICkgewoJCQl2YXIgc3R5bGVzLCBsZW4sCgkJCQltYXAgPSB7fSwKCQkJCWkgPSAwOwoKCQkJaWYgKCBqUXVlcnkuaXNBcnJheSggbmFtZSApICkgewoJCQkJc3R5bGVzID0gZ2V0U3R5bGVzKCBlbGVtICk7CgkJCQlsZW4gPSBuYW1lLmxlbmd0aDsKCgkJCQlmb3IgKCA7IGkgPCBsZW47IGkrKyApIHsKCQkJCQltYXBbIG5hbWVbIGkgXSBdID0galF1ZXJ5LmNzcyggZWxlbSwgbmFtZVsgaSBdLCBmYWxzZSwgc3R5bGVzICk7CgkJCQl9CgoJCQkJcmV0dXJuIG1hcDsKCQkJfQoKCQkJcmV0dXJuIHZhbHVlICE9PSB1bmRlZmluZWQgPwoJCQkJalF1ZXJ5LnN0eWxlKCBlbGVtLCBuYW1lLCB2YWx1ZSApIDoKCQkJCWpRdWVyeS5jc3MoIGVsZW0sIG5hbWUgKTsKCQl9LCBuYW1lLCB2YWx1ZSwgYXJndW1lbnRzLmxlbmd0aCA+IDEgKTsKCX0sCglzaG93OiBmdW5jdGlvbigpIHsKCQlyZXR1cm4gc2hvd0hpZGUoIHRoaXMsIHRydWUgKTsKCX0sCgloaWRlOiBmdW5jdGlvbigpIHsKCQlyZXR1cm4gc2hvd0hpZGUoIHRoaXMgKTsKCX0sCgl0b2dnbGU6IGZ1bmN0aW9uKCBzdGF0ZSApIHsKCQlpZiAoIHR5cGVvZiBzdGF0ZSA9PT0gImJvb2xlYW4iICkgewoJCQlyZXR1cm4gc3RhdGUgPyB0aGlzLnNob3coKSA6IHRoaXMuaGlkZSgpOwoJCX0KCgkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCWlmICggaXNIaWRkZW4oIHRoaXMgKSApIHsKCQkJCWpRdWVyeSggdGhpcyApLnNob3coKTsKCQkJfSBlbHNlIHsKCQkJCWpRdWVyeSggdGhpcyApLmhpZGUoKTsKCQkJfQoJCX0gKTsKCX0KfSApOwoKCmZ1bmN0aW9uIFR3ZWVuKCBlbGVtLCBvcHRpb25zLCBwcm9wLCBlbmQsIGVhc2luZyApIHsKCXJldHVybiBuZXcgVHdlZW4ucHJvdG90eXBlLmluaXQoIGVsZW0sIG9wdGlvbnMsIHByb3AsIGVuZCwgZWFzaW5nICk7Cn0KalF1ZXJ5LlR3ZWVuID0gVHdlZW47CgpUd2Vlbi5wcm90b3R5cGUgPSB7Cgljb25zdHJ1Y3RvcjogVHdlZW4sCglpbml0OiBmdW5jdGlvbiggZWxlbSwgb3B0aW9ucywgcHJvcCwgZW5kLCBlYXNpbmcsIHVuaXQgKSB7CgkJdGhpcy5lbGVtID0gZWxlbTsKCQl0aGlzLnByb3AgPSBwcm9wOwoJCXRoaXMuZWFzaW5nID0gZWFzaW5nIHx8IGpRdWVyeS5lYXNpbmcuX2RlZmF1bHQ7CgkJdGhpcy5vcHRpb25zID0gb3B0aW9uczsKCQl0aGlzLnN0YXJ0ID0gdGhpcy5ub3cgPSB0aGlzLmN1cigpOwoJCXRoaXMuZW5kID0gZW5kOwoJCXRoaXMudW5pdCA9IHVuaXQgfHwgKCBqUXVlcnkuY3NzTnVtYmVyWyBwcm9wIF0gPyAiIiA6ICJweCIgKTsKCX0sCgljdXI6IGZ1bmN0aW9uKCkgewoJCXZhciBob29rcyA9IFR3ZWVuLnByb3BIb29rc1sgdGhpcy5wcm9wIF07CgoJCXJldHVybiBob29rcyAmJiBob29rcy5nZXQgPwoJCQlob29rcy5nZXQoIHRoaXMgKSA6CgkJCVR3ZWVuLnByb3BIb29rcy5fZGVmYXVsdC5nZXQoIHRoaXMgKTsKCX0sCglydW46IGZ1bmN0aW9uKCBwZXJjZW50ICkgewoJCXZhciBlYXNlZCwKCQkJaG9va3MgPSBUd2Vlbi5wcm9wSG9va3NbIHRoaXMucHJvcCBdOwoKCQlpZiAoIHRoaXMub3B0aW9ucy5kdXJhdGlvbiApIHsKCQkJdGhpcy5wb3MgPSBlYXNlZCA9IGpRdWVyeS5lYXNpbmdbIHRoaXMuZWFzaW5nIF0oCgkJCQlwZXJjZW50LCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKiBwZXJjZW50LCAwLCAxLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24KCQkJKTsKCQl9IGVsc2UgewoJCQl0aGlzLnBvcyA9IGVhc2VkID0gcGVyY2VudDsKCQl9CgkJdGhpcy5ub3cgPSAoIHRoaXMuZW5kIC0gdGhpcy5zdGFydCApICogZWFzZWQgKyB0aGlzLnN0YXJ0OwoKCQlpZiAoIHRoaXMub3B0aW9ucy5zdGVwICkgewoJCQl0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKCB0aGlzLmVsZW0sIHRoaXMubm93LCB0aGlzICk7CgkJfQoKCQlpZiAoIGhvb2tzICYmIGhvb2tzLnNldCApIHsKCQkJaG9va3Muc2V0KCB0aGlzICk7CgkJfSBlbHNlIHsKCQkJVHdlZW4ucHJvcEhvb2tzLl9kZWZhdWx0LnNldCggdGhpcyApOwoJCX0KCQlyZXR1cm4gdGhpczsKCX0KfTsKClR3ZWVuLnByb3RvdHlwZS5pbml0LnByb3RvdHlwZSA9IFR3ZWVuLnByb3RvdHlwZTsKClR3ZWVuLnByb3BIb29rcyA9IHsKCV9kZWZhdWx0OiB7CgkJZ2V0OiBmdW5jdGlvbiggdHdlZW4gKSB7CgkJCXZhciByZXN1bHQ7CgoJCQkvLyBVc2UgYSBwcm9wZXJ0eSBvbiB0aGUgZWxlbWVudCBkaXJlY3RseSB3aGVuIGl0IGlzIG5vdCBhIERPTSBlbGVtZW50LAoJCQkvLyBvciB3aGVuIHRoZXJlIGlzIG5vIG1hdGNoaW5nIHN0eWxlIHByb3BlcnR5IHRoYXQgZXhpc3RzLgoJCQlpZiAoIHR3ZWVuLmVsZW0ubm9kZVR5cGUgIT09IDEgfHwKCQkJCXR3ZWVuLmVsZW1bIHR3ZWVuLnByb3AgXSAhPSBudWxsICYmIHR3ZWVuLmVsZW0uc3R5bGVbIHR3ZWVuLnByb3AgXSA9PSBudWxsICkgewoJCQkJcmV0dXJuIHR3ZWVuLmVsZW1bIHR3ZWVuLnByb3AgXTsKCQkJfQoKCQkJLy8gUGFzc2luZyBhbiBlbXB0eSBzdHJpbmcgYXMgYSAzcmQgcGFyYW1ldGVyIHRvIC5jc3Mgd2lsbCBhdXRvbWF0aWNhbGx5CgkJCS8vIGF0dGVtcHQgYSBwYXJzZUZsb2F0IGFuZCBmYWxsYmFjayB0byBhIHN0cmluZyBpZiB0aGUgcGFyc2UgZmFpbHMuCgkJCS8vIFNpbXBsZSB2YWx1ZXMgc3VjaCBhcyAiMTBweCIgYXJlIHBhcnNlZCB0byBGbG9hdDsKCQkJLy8gY29tcGxleCB2YWx1ZXMgc3VjaCBhcyAicm90YXRlKDFyYWQpIiBhcmUgcmV0dXJuZWQgYXMtaXMuCgkJCXJlc3VsdCA9IGpRdWVyeS5jc3MoIHR3ZWVuLmVsZW0sIHR3ZWVuLnByb3AsICIiICk7CgoJCQkvLyBFbXB0eSBzdHJpbmdzLCBudWxsLCB1bmRlZmluZWQgYW5kICJhdXRvIiBhcmUgY29udmVydGVkIHRvIDAuCgkJCXJldHVybiAhcmVzdWx0IHx8IHJlc3VsdCA9PT0gImF1dG8iID8gMCA6IHJlc3VsdDsKCQl9LAoJCXNldDogZnVuY3Rpb24oIHR3ZWVuICkgewoKCQkJLy8gVXNlIHN0ZXAgaG9vayBmb3IgYmFjayBjb21wYXQuCgkJCS8vIFVzZSBjc3NIb29rIGlmIGl0cyB0aGVyZS4KCQkJLy8gVXNlIC5zdHlsZSBpZiBhdmFpbGFibGUgYW5kIHVzZSBwbGFpbiBwcm9wZXJ0aWVzIHdoZXJlIGF2YWlsYWJsZS4KCQkJaWYgKCBqUXVlcnkuZnguc3RlcFsgdHdlZW4ucHJvcCBdICkgewoJCQkJalF1ZXJ5LmZ4LnN0ZXBbIHR3ZWVuLnByb3AgXSggdHdlZW4gKTsKCQkJfSBlbHNlIGlmICggdHdlZW4uZWxlbS5ub2RlVHlwZSA9PT0gMSAmJgoJCQkJKCB0d2Vlbi5lbGVtLnN0eWxlWyBqUXVlcnkuY3NzUHJvcHNbIHR3ZWVuLnByb3AgXSBdICE9IG51bGwgfHwKCQkJCQlqUXVlcnkuY3NzSG9va3NbIHR3ZWVuLnByb3AgXSApICkgewoJCQkJalF1ZXJ5LnN0eWxlKCB0d2Vlbi5lbGVtLCB0d2Vlbi5wcm9wLCB0d2Vlbi5ub3cgKyB0d2Vlbi51bml0ICk7CgkJCX0gZWxzZSB7CgkJCQl0d2Vlbi5lbGVtWyB0d2Vlbi5wcm9wIF0gPSB0d2Vlbi5ub3c7CgkJCX0KCQl9Cgl9Cn07CgovLyBTdXBwb3J0OiBJRTkKLy8gUGFuaWMgYmFzZWQgYXBwcm9hY2ggdG8gc2V0dGluZyB0aGluZ3Mgb24gZGlzY29ubmVjdGVkIG5vZGVzClR3ZWVuLnByb3BIb29rcy5zY3JvbGxUb3AgPSBUd2Vlbi5wcm9wSG9va3Muc2Nyb2xsTGVmdCA9IHsKCXNldDogZnVuY3Rpb24oIHR3ZWVuICkgewoJCWlmICggdHdlZW4uZWxlbS5ub2RlVHlwZSAmJiB0d2Vlbi5lbGVtLnBhcmVudE5vZGUgKSB7CgkJCXR3ZWVuLmVsZW1bIHR3ZWVuLnByb3AgXSA9IHR3ZWVuLm5vdzsKCQl9Cgl9Cn07CgpqUXVlcnkuZWFzaW5nID0gewoJbGluZWFyOiBmdW5jdGlvbiggcCApIHsKCQlyZXR1cm4gcDsKCX0sCglzd2luZzogZnVuY3Rpb24oIHAgKSB7CgkJcmV0dXJuIDAuNSAtIE1hdGguY29zKCBwICogTWF0aC5QSSApIC8gMjsKCX0sCglfZGVmYXVsdDogInN3aW5nIgp9OwoKalF1ZXJ5LmZ4ID0gVHdlZW4ucHJvdG90eXBlLmluaXQ7CgovLyBCYWNrIENvbXBhdCA8MS44IGV4dGVuc2lvbiBwb2ludApqUXVlcnkuZnguc3RlcCA9IHt9OwoKCgoKdmFyCglmeE5vdywgdGltZXJJZCwKCXJmeHR5cGVzID0gL14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLAoJcnJ1biA9IC9xdWV1ZUhvb2tzJC87CgovLyBBbmltYXRpb25zIGNyZWF0ZWQgc3luY2hyb25vdXNseSB3aWxsIHJ1biBzeW5jaHJvbm91c2x5CmZ1bmN0aW9uIGNyZWF0ZUZ4Tm93KCkgewoJd2luZG93LnNldFRpbWVvdXQoIGZ1bmN0aW9uKCkgewoJCWZ4Tm93ID0gdW5kZWZpbmVkOwoJfSApOwoJcmV0dXJuICggZnhOb3cgPSBqUXVlcnkubm93KCkgKTsKfQoKLy8gR2VuZXJhdGUgcGFyYW1ldGVycyB0byBjcmVhdGUgYSBzdGFuZGFyZCBhbmltYXRpb24KZnVuY3Rpb24gZ2VuRngoIHR5cGUsIGluY2x1ZGVXaWR0aCApIHsKCXZhciB3aGljaCwKCQlpID0gMCwKCQlhdHRycyA9IHsgaGVpZ2h0OiB0eXBlIH07CgoJLy8gSWYgd2UgaW5jbHVkZSB3aWR0aCwgc3RlcCB2YWx1ZSBpcyAxIHRvIGRvIGFsbCBjc3NFeHBhbmQgdmFsdWVzLAoJLy8gb3RoZXJ3aXNlIHN0ZXAgdmFsdWUgaXMgMiB0byBza2lwIG92ZXIgTGVmdCBhbmQgUmlnaHQKCWluY2x1ZGVXaWR0aCA9IGluY2x1ZGVXaWR0aCA/IDEgOiAwOwoJZm9yICggOyBpIDwgNCA7IGkgKz0gMiAtIGluY2x1ZGVXaWR0aCApIHsKCQl3aGljaCA9IGNzc0V4cGFuZFsgaSBdOwoJCWF0dHJzWyAibWFyZ2luIiArIHdoaWNoIF0gPSBhdHRyc1sgInBhZGRpbmciICsgd2hpY2ggXSA9IHR5cGU7Cgl9CgoJaWYgKCBpbmNsdWRlV2lkdGggKSB7CgkJYXR0cnMub3BhY2l0eSA9IGF0dHJzLndpZHRoID0gdHlwZTsKCX0KCglyZXR1cm4gYXR0cnM7Cn0KCmZ1bmN0aW9uIGNyZWF0ZVR3ZWVuKCB2YWx1ZSwgcHJvcCwgYW5pbWF0aW9uICkgewoJdmFyIHR3ZWVuLAoJCWNvbGxlY3Rpb24gPSAoIEFuaW1hdGlvbi50d2VlbmVyc1sgcHJvcCBdIHx8IFtdICkuY29uY2F0KCBBbmltYXRpb24udHdlZW5lcnNbICIqIiBdICksCgkJaW5kZXggPSAwLAoJCWxlbmd0aCA9IGNvbGxlY3Rpb24ubGVuZ3RoOwoJZm9yICggOyBpbmRleCA8IGxlbmd0aDsgaW5kZXgrKyApIHsKCQlpZiAoICggdHdlZW4gPSBjb2xsZWN0aW9uWyBpbmRleCBdLmNhbGwoIGFuaW1hdGlvbiwgcHJvcCwgdmFsdWUgKSApICkgewoKCQkJLy8gV2UncmUgZG9uZSB3aXRoIHRoaXMgcHJvcGVydHkKCQkJcmV0dXJuIHR3ZWVuOwoJCX0KCX0KfQoKZnVuY3Rpb24gZGVmYXVsdFByZWZpbHRlciggZWxlbSwgcHJvcHMsIG9wdHMgKSB7CgkvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovCgl2YXIgcHJvcCwgdmFsdWUsIHRvZ2dsZSwgdHdlZW4sIGhvb2tzLCBvbGRmaXJlLCBkaXNwbGF5LCBjaGVja0Rpc3BsYXksCgkJYW5pbSA9IHRoaXMsCgkJb3JpZyA9IHt9LAoJCXN0eWxlID0gZWxlbS5zdHlsZSwKCQloaWRkZW4gPSBlbGVtLm5vZGVUeXBlICYmIGlzSGlkZGVuKCBlbGVtICksCgkJZGF0YVNob3cgPSBkYXRhUHJpdi5nZXQoIGVsZW0sICJmeHNob3ciICk7CgoJLy8gSGFuZGxlIHF1ZXVlOiBmYWxzZSBwcm9taXNlcwoJaWYgKCAhb3B0cy5xdWV1ZSApIHsKCQlob29rcyA9IGpRdWVyeS5fcXVldWVIb29rcyggZWxlbSwgImZ4IiApOwoJCWlmICggaG9va3MudW5xdWV1ZWQgPT0gbnVsbCApIHsKCQkJaG9va3MudW5xdWV1ZWQgPSAwOwoJCQlvbGRmaXJlID0gaG9va3MuZW1wdHkuZmlyZTsKCQkJaG9va3MuZW1wdHkuZmlyZSA9IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCAhaG9va3MudW5xdWV1ZWQgKSB7CgkJCQkJb2xkZmlyZSgpOwoJCQkJfQoJCQl9OwoJCX0KCQlob29rcy51bnF1ZXVlZCsrOwoKCQlhbmltLmFsd2F5cyggZnVuY3Rpb24oKSB7CgoJCQkvLyBFbnN1cmUgdGhlIGNvbXBsZXRlIGhhbmRsZXIgaXMgY2FsbGVkIGJlZm9yZSB0aGlzIGNvbXBsZXRlcwoJCQlhbmltLmFsd2F5cyggZnVuY3Rpb24oKSB7CgkJCQlob29rcy51bnF1ZXVlZC0tOwoJCQkJaWYgKCAhalF1ZXJ5LnF1ZXVlKCBlbGVtLCAiZngiICkubGVuZ3RoICkgewoJCQkJCWhvb2tzLmVtcHR5LmZpcmUoKTsKCQkJCX0KCQkJfSApOwoJCX0gKTsKCX0KCgkvLyBIZWlnaHQvd2lkdGggb3ZlcmZsb3cgcGFzcwoJaWYgKCBlbGVtLm5vZGVUeXBlID09PSAxICYmICggImhlaWdodCIgaW4gcHJvcHMgfHwgIndpZHRoIiBpbiBwcm9wcyApICkgewoKCQkvLyBNYWtlIHN1cmUgdGhhdCBub3RoaW5nIHNuZWFrcyBvdXQKCQkvLyBSZWNvcmQgYWxsIDMgb3ZlcmZsb3cgYXR0cmlidXRlcyBiZWNhdXNlIElFOS0xMCBkbyBub3QKCQkvLyBjaGFuZ2UgdGhlIG92ZXJmbG93IGF0dHJpYnV0ZSB3aGVuIG92ZXJmbG93WCBhbmQKCQkvLyBvdmVyZmxvd1kgYXJlIHNldCB0byB0aGUgc2FtZSB2YWx1ZQoJCW9wdHMub3ZlcmZsb3cgPSBbIHN0eWxlLm92ZXJmbG93LCBzdHlsZS5vdmVyZmxvd1gsIHN0eWxlLm92ZXJmbG93WSBdOwoKCQkvLyBTZXQgZGlzcGxheSBwcm9wZXJ0eSB0byBpbmxpbmUtYmxvY2sgZm9yIGhlaWdodC93aWR0aAoJCS8vIGFuaW1hdGlvbnMgb24gaW5saW5lIGVsZW1lbnRzIHRoYXQgYXJlIGhhdmluZyB3aWR0aC9oZWlnaHQgYW5pbWF0ZWQKCQlkaXNwbGF5ID0galF1ZXJ5LmNzcyggZWxlbSwgImRpc3BsYXkiICk7CgoJCS8vIFRlc3QgZGVmYXVsdCBkaXNwbGF5IGlmIGRpc3BsYXkgaXMgY3VycmVudGx5ICJub25lIgoJCWNoZWNrRGlzcGxheSA9IGRpc3BsYXkgPT09ICJub25lIiA/CgkJCWRhdGFQcml2LmdldCggZWxlbSwgIm9sZGRpc3BsYXkiICkgfHwgZGVmYXVsdERpc3BsYXkoIGVsZW0ubm9kZU5hbWUgKSA6IGRpc3BsYXk7CgoJCWlmICggY2hlY2tEaXNwbGF5ID09PSAiaW5saW5lIiAmJiBqUXVlcnkuY3NzKCBlbGVtLCAiZmxvYXQiICkgPT09ICJub25lIiApIHsKCQkJc3R5bGUuZGlzcGxheSA9ICJpbmxpbmUtYmxvY2siOwoJCX0KCX0KCglpZiAoIG9wdHMub3ZlcmZsb3cgKSB7CgkJc3R5bGUub3ZlcmZsb3cgPSAiaGlkZGVuIjsKCQlhbmltLmFsd2F5cyggZnVuY3Rpb24oKSB7CgkJCXN0eWxlLm92ZXJmbG93ID0gb3B0cy5vdmVyZmxvd1sgMCBdOwoJCQlzdHlsZS5vdmVyZmxvd1ggPSBvcHRzLm92ZXJmbG93WyAxIF07CgkJCXN0eWxlLm92ZXJmbG93WSA9IG9wdHMub3ZlcmZsb3dbIDIgXTsKCQl9ICk7Cgl9CgoJLy8gc2hvdy9oaWRlIHBhc3MKCWZvciAoIHByb3AgaW4gcHJvcHMgKSB7CgkJdmFsdWUgPSBwcm9wc1sgcHJvcCBdOwoJCWlmICggcmZ4dHlwZXMuZXhlYyggdmFsdWUgKSApIHsKCQkJZGVsZXRlIHByb3BzWyBwcm9wIF07CgkJCXRvZ2dsZSA9IHRvZ2dsZSB8fCB2YWx1ZSA9PT0gInRvZ2dsZSI7CgkJCWlmICggdmFsdWUgPT09ICggaGlkZGVuID8gImhpZGUiIDogInNob3ciICkgKSB7CgoJCQkJLy8gSWYgdGhlcmUgaXMgZGF0YVNob3cgbGVmdCBvdmVyIGZyb20gYSBzdG9wcGVkIGhpZGUgb3Igc2hvdwoJCQkJLy8gYW5kIHdlIGFyZSBnb2luZyB0byBwcm9jZWVkIHdpdGggc2hvdywgd2Ugc2hvdWxkIHByZXRlbmQgdG8gYmUgaGlkZGVuCgkJCQlpZiAoIHZhbHVlID09PSAic2hvdyIgJiYgZGF0YVNob3cgJiYgZGF0YVNob3dbIHByb3AgXSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCWhpZGRlbiA9IHRydWU7CgkJCQl9IGVsc2UgewoJCQkJCWNvbnRpbnVlOwoJCQkJfQoJCQl9CgkJCW9yaWdbIHByb3AgXSA9IGRhdGFTaG93ICYmIGRhdGFTaG93WyBwcm9wIF0gfHwgalF1ZXJ5LnN0eWxlKCBlbGVtLCBwcm9wICk7CgoJCS8vIEFueSBub24tZnggdmFsdWUgc3RvcHMgdXMgZnJvbSByZXN0b3JpbmcgdGhlIG9yaWdpbmFsIGRpc3BsYXkgdmFsdWUKCQl9IGVsc2UgewoJCQlkaXNwbGF5ID0gdW5kZWZpbmVkOwoJCX0KCX0KCglpZiAoICFqUXVlcnkuaXNFbXB0eU9iamVjdCggb3JpZyApICkgewoJCWlmICggZGF0YVNob3cgKSB7CgkJCWlmICggImhpZGRlbiIgaW4gZGF0YVNob3cgKSB7CgkJCQloaWRkZW4gPSBkYXRhU2hvdy5oaWRkZW47CgkJCX0KCQl9IGVsc2UgewoJCQlkYXRhU2hvdyA9IGRhdGFQcml2LmFjY2VzcyggZWxlbSwgImZ4c2hvdyIsIHt9ICk7CgkJfQoKCQkvLyBTdG9yZSBzdGF0ZSBpZiBpdHMgdG9nZ2xlIC0gZW5hYmxlcyAuc3RvcCgpLnRvZ2dsZSgpIHRvICJyZXZlcnNlIgoJCWlmICggdG9nZ2xlICkgewoJCQlkYXRhU2hvdy5oaWRkZW4gPSAhaGlkZGVuOwoJCX0KCQlpZiAoIGhpZGRlbiApIHsKCQkJalF1ZXJ5KCBlbGVtICkuc2hvdygpOwoJCX0gZWxzZSB7CgkJCWFuaW0uZG9uZSggZnVuY3Rpb24oKSB7CgkJCQlqUXVlcnkoIGVsZW0gKS5oaWRlKCk7CgkJCX0gKTsKCQl9CgkJYW5pbS5kb25lKCBmdW5jdGlvbigpIHsKCQkJdmFyIHByb3A7CgoJCQlkYXRhUHJpdi5yZW1vdmUoIGVsZW0sICJmeHNob3ciICk7CgkJCWZvciAoIHByb3AgaW4gb3JpZyApIHsKCQkJCWpRdWVyeS5zdHlsZSggZWxlbSwgcHJvcCwgb3JpZ1sgcHJvcCBdICk7CgkJCX0KCQl9ICk7CgkJZm9yICggcHJvcCBpbiBvcmlnICkgewoJCQl0d2VlbiA9IGNyZWF0ZVR3ZWVuKCBoaWRkZW4gPyBkYXRhU2hvd1sgcHJvcCBdIDogMCwgcHJvcCwgYW5pbSApOwoKCQkJaWYgKCAhKCBwcm9wIGluIGRhdGFTaG93ICkgKSB7CgkJCQlkYXRhU2hvd1sgcHJvcCBdID0gdHdlZW4uc3RhcnQ7CgkJCQlpZiAoIGhpZGRlbiApIHsKCQkJCQl0d2Vlbi5lbmQgPSB0d2Vlbi5zdGFydDsKCQkJCQl0d2Vlbi5zdGFydCA9IHByb3AgPT09ICJ3aWR0aCIgfHwgcHJvcCA9PT0gImhlaWdodCIgPyAxIDogMDsKCQkJCX0KCQkJfQoJCX0KCgkvLyBJZiB0aGlzIGlzIGEgbm9vcCBsaWtlIC5oaWRlKCkuaGlkZSgpLCByZXN0b3JlIGFuIG92ZXJ3cml0dGVuIGRpc3BsYXkgdmFsdWUKCX0gZWxzZSBpZiAoICggZGlzcGxheSA9PT0gIm5vbmUiID8gZGVmYXVsdERpc3BsYXkoIGVsZW0ubm9kZU5hbWUgKSA6IGRpc3BsYXkgKSA9PT0gImlubGluZSIgKSB7CgkJc3R5bGUuZGlzcGxheSA9IGRpc3BsYXk7Cgl9Cn0KCmZ1bmN0aW9uIHByb3BGaWx0ZXIoIHByb3BzLCBzcGVjaWFsRWFzaW5nICkgewoJdmFyIGluZGV4LCBuYW1lLCBlYXNpbmcsIHZhbHVlLCBob29rczsKCgkvLyBjYW1lbENhc2UsIHNwZWNpYWxFYXNpbmcgYW5kIGV4cGFuZCBjc3NIb29rIHBhc3MKCWZvciAoIGluZGV4IGluIHByb3BzICkgewoJCW5hbWUgPSBqUXVlcnkuY2FtZWxDYXNlKCBpbmRleCApOwoJCWVhc2luZyA9IHNwZWNpYWxFYXNpbmdbIG5hbWUgXTsKCQl2YWx1ZSA9IHByb3BzWyBpbmRleCBdOwoJCWlmICggalF1ZXJ5LmlzQXJyYXkoIHZhbHVlICkgKSB7CgkJCWVhc2luZyA9IHZhbHVlWyAxIF07CgkJCXZhbHVlID0gcHJvcHNbIGluZGV4IF0gPSB2YWx1ZVsgMCBdOwoJCX0KCgkJaWYgKCBpbmRleCAhPT0gbmFtZSApIHsKCQkJcHJvcHNbIG5hbWUgXSA9IHZhbHVlOwoJCQlkZWxldGUgcHJvcHNbIGluZGV4IF07CgkJfQoKCQlob29rcyA9IGpRdWVyeS5jc3NIb29rc1sgbmFtZSBdOwoJCWlmICggaG9va3MgJiYgImV4cGFuZCIgaW4gaG9va3MgKSB7CgkJCXZhbHVlID0gaG9va3MuZXhwYW5kKCB2YWx1ZSApOwoJCQlkZWxldGUgcHJvcHNbIG5hbWUgXTsKCgkJCS8vIE5vdCBxdWl0ZSAkLmV4dGVuZCwgdGhpcyB3b24ndCBvdmVyd3JpdGUgZXhpc3Rpbmcga2V5cy4KCQkJLy8gUmV1c2luZyAnaW5kZXgnIGJlY2F1c2Ugd2UgaGF2ZSB0aGUgY29ycmVjdCAibmFtZSIKCQkJZm9yICggaW5kZXggaW4gdmFsdWUgKSB7CgkJCQlpZiAoICEoIGluZGV4IGluIHByb3BzICkgKSB7CgkJCQkJcHJvcHNbIGluZGV4IF0gPSB2YWx1ZVsgaW5kZXggXTsKCQkJCQlzcGVjaWFsRWFzaW5nWyBpbmRleCBdID0gZWFzaW5nOwoJCQkJfQoJCQl9CgkJfSBlbHNlIHsKCQkJc3BlY2lhbEVhc2luZ1sgbmFtZSBdID0gZWFzaW5nOwoJCX0KCX0KfQoKZnVuY3Rpb24gQW5pbWF0aW9uKCBlbGVtLCBwcm9wZXJ0aWVzLCBvcHRpb25zICkgewoJdmFyIHJlc3VsdCwKCQlzdG9wcGVkLAoJCWluZGV4ID0gMCwKCQlsZW5ndGggPSBBbmltYXRpb24ucHJlZmlsdGVycy5sZW5ndGgsCgkJZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKS5hbHdheXMoIGZ1bmN0aW9uKCkgewoKCQkJLy8gRG9uJ3QgbWF0Y2ggZWxlbSBpbiB0aGUgOmFuaW1hdGVkIHNlbGVjdG9yCgkJCWRlbGV0ZSB0aWNrLmVsZW07CgkJfSApLAoJCXRpY2sgPSBmdW5jdGlvbigpIHsKCQkJaWYgKCBzdG9wcGVkICkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCXZhciBjdXJyZW50VGltZSA9IGZ4Tm93IHx8IGNyZWF0ZUZ4Tm93KCksCgkJCQlyZW1haW5pbmcgPSBNYXRoLm1heCggMCwgYW5pbWF0aW9uLnN0YXJ0VGltZSArIGFuaW1hdGlvbi5kdXJhdGlvbiAtIGN1cnJlbnRUaW1lICksCgoJCQkJLy8gU3VwcG9ydDogQW5kcm9pZCAyLjMKCQkJCS8vIEFyY2hhaWMgY3Jhc2ggYnVnIHdvbid0IGFsbG93IHVzIHRvIHVzZSBgMSAtICggMC41IHx8IDAgKWAgKCMxMjQ5NykKCQkJCXRlbXAgPSByZW1haW5pbmcgLyBhbmltYXRpb24uZHVyYXRpb24gfHwgMCwKCQkJCXBlcmNlbnQgPSAxIC0gdGVtcCwKCQkJCWluZGV4ID0gMCwKCQkJCWxlbmd0aCA9IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoOwoKCQkJZm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7CgkJCQlhbmltYXRpb24udHdlZW5zWyBpbmRleCBdLnJ1biggcGVyY2VudCApOwoJCQl9CgoJCQlkZWZlcnJlZC5ub3RpZnlXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiwgcGVyY2VudCwgcmVtYWluaW5nIF0gKTsKCgkJCWlmICggcGVyY2VudCA8IDEgJiYgbGVuZ3RoICkgewoJCQkJcmV0dXJuIHJlbWFpbmluZzsKCQkJfSBlbHNlIHsKCQkJCWRlZmVycmVkLnJlc29sdmVXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiBdICk7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQl9LAoJCWFuaW1hdGlvbiA9IGRlZmVycmVkLnByb21pc2UoIHsKCQkJZWxlbTogZWxlbSwKCQkJcHJvcHM6IGpRdWVyeS5leHRlbmQoIHt9LCBwcm9wZXJ0aWVzICksCgkJCW9wdHM6IGpRdWVyeS5leHRlbmQoIHRydWUsIHsKCQkJCXNwZWNpYWxFYXNpbmc6IHt9LAoJCQkJZWFzaW5nOiBqUXVlcnkuZWFzaW5nLl9kZWZhdWx0CgkJCX0sIG9wdGlvbnMgKSwKCQkJb3JpZ2luYWxQcm9wZXJ0aWVzOiBwcm9wZXJ0aWVzLAoJCQlvcmlnaW5hbE9wdGlvbnM6IG9wdGlvbnMsCgkJCXN0YXJ0VGltZTogZnhOb3cgfHwgY3JlYXRlRnhOb3coKSwKCQkJZHVyYXRpb246IG9wdGlvbnMuZHVyYXRpb24sCgkJCXR3ZWVuczogW10sCgkJCWNyZWF0ZVR3ZWVuOiBmdW5jdGlvbiggcHJvcCwgZW5kICkgewoJCQkJdmFyIHR3ZWVuID0galF1ZXJ5LlR3ZWVuKCBlbGVtLCBhbmltYXRpb24ub3B0cywgcHJvcCwgZW5kLAoJCQkJCQlhbmltYXRpb24ub3B0cy5zcGVjaWFsRWFzaW5nWyBwcm9wIF0gfHwgYW5pbWF0aW9uLm9wdHMuZWFzaW5nICk7CgkJCQlhbmltYXRpb24udHdlZW5zLnB1c2goIHR3ZWVuICk7CgkJCQlyZXR1cm4gdHdlZW47CgkJCX0sCgkJCXN0b3A6IGZ1bmN0aW9uKCBnb3RvRW5kICkgewoJCQkJdmFyIGluZGV4ID0gMCwKCgkJCQkJLy8gSWYgd2UgYXJlIGdvaW5nIHRvIHRoZSBlbmQsIHdlIHdhbnQgdG8gcnVuIGFsbCB0aGUgdHdlZW5zCgkJCQkJLy8gb3RoZXJ3aXNlIHdlIHNraXAgdGhpcyBwYXJ0CgkJCQkJbGVuZ3RoID0gZ290b0VuZCA/IGFuaW1hdGlvbi50d2VlbnMubGVuZ3RoIDogMDsKCQkJCWlmICggc3RvcHBlZCApIHsKCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0KCQkJCXN0b3BwZWQgPSB0cnVlOwoJCQkJZm9yICggOyBpbmRleCA8IGxlbmd0aCA7IGluZGV4KysgKSB7CgkJCQkJYW5pbWF0aW9uLnR3ZWVuc1sgaW5kZXggXS5ydW4oIDEgKTsKCQkJCX0KCgkJCQkvLyBSZXNvbHZlIHdoZW4gd2UgcGxheWVkIHRoZSBsYXN0IGZyYW1lOyBvdGhlcndpc2UsIHJlamVjdAoJCQkJaWYgKCBnb3RvRW5kICkgewoJCQkJCWRlZmVycmVkLm5vdGlmeVdpdGgoIGVsZW0sIFsgYW5pbWF0aW9uLCAxLCAwIF0gKTsKCQkJCQlkZWZlcnJlZC5yZXNvbHZlV2l0aCggZWxlbSwgWyBhbmltYXRpb24sIGdvdG9FbmQgXSApOwoJCQkJfSBlbHNlIHsKCQkJCQlkZWZlcnJlZC5yZWplY3RXaXRoKCBlbGVtLCBbIGFuaW1hdGlvbiwgZ290b0VuZCBdICk7CgkJCQl9CgkJCQlyZXR1cm4gdGhpczsKCQkJfQoJCX0gKSwKCQlwcm9wcyA9IGFuaW1hdGlvbi5wcm9wczsKCglwcm9wRmlsdGVyKCBwcm9wcywgYW5pbWF0aW9uLm9wdHMuc3BlY2lhbEVhc2luZyApOwoKCWZvciAoIDsgaW5kZXggPCBsZW5ndGggOyBpbmRleCsrICkgewoJCXJlc3VsdCA9IEFuaW1hdGlvbi5wcmVmaWx0ZXJzWyBpbmRleCBdLmNhbGwoIGFuaW1hdGlvbiwgZWxlbSwgcHJvcHMsIGFuaW1hdGlvbi5vcHRzICk7CgkJaWYgKCByZXN1bHQgKSB7CgkJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHJlc3VsdC5zdG9wICkgKSB7CgkJCQlqUXVlcnkuX3F1ZXVlSG9va3MoIGFuaW1hdGlvbi5lbGVtLCBhbmltYXRpb24ub3B0cy5xdWV1ZSApLnN0b3AgPQoJCQkJCWpRdWVyeS5wcm94eSggcmVzdWx0LnN0b3AsIHJlc3VsdCApOwoJCQl9CgkJCXJldHVybiByZXN1bHQ7CgkJfQoJfQoKCWpRdWVyeS5tYXAoIHByb3BzLCBjcmVhdGVUd2VlbiwgYW5pbWF0aW9uICk7CgoJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggYW5pbWF0aW9uLm9wdHMuc3RhcnQgKSApIHsKCQlhbmltYXRpb24ub3B0cy5zdGFydC5jYWxsKCBlbGVtLCBhbmltYXRpb24gKTsKCX0KCglqUXVlcnkuZngudGltZXIoCgkJalF1ZXJ5LmV4dGVuZCggdGljaywgewoJCQllbGVtOiBlbGVtLAoJCQlhbmltOiBhbmltYXRpb24sCgkJCXF1ZXVlOiBhbmltYXRpb24ub3B0cy5xdWV1ZQoJCX0gKQoJKTsKCgkvLyBhdHRhY2ggY2FsbGJhY2tzIGZyb20gb3B0aW9ucwoJcmV0dXJuIGFuaW1hdGlvbi5wcm9ncmVzcyggYW5pbWF0aW9uLm9wdHMucHJvZ3Jlc3MgKQoJCS5kb25lKCBhbmltYXRpb24ub3B0cy5kb25lLCBhbmltYXRpb24ub3B0cy5jb21wbGV0ZSApCgkJLmZhaWwoIGFuaW1hdGlvbi5vcHRzLmZhaWwgKQoJCS5hbHdheXMoIGFuaW1hdGlvbi5vcHRzLmFsd2F5cyApOwp9CgpqUXVlcnkuQW5pbWF0aW9uID0galF1ZXJ5LmV4dGVuZCggQW5pbWF0aW9uLCB7Cgl0d2VlbmVyczogewoJCSIqIjogWyBmdW5jdGlvbiggcHJvcCwgdmFsdWUgKSB7CgkJCXZhciB0d2VlbiA9IHRoaXMuY3JlYXRlVHdlZW4oIHByb3AsIHZhbHVlICk7CgkJCWFkanVzdENTUyggdHdlZW4uZWxlbSwgcHJvcCwgcmNzc051bS5leGVjKCB2YWx1ZSApLCB0d2VlbiApOwoJCQlyZXR1cm4gdHdlZW47CgkJfSBdCgl9LAoKCXR3ZWVuZXI6IGZ1bmN0aW9uKCBwcm9wcywgY2FsbGJhY2sgKSB7CgkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggcHJvcHMgKSApIHsKCQkJY2FsbGJhY2sgPSBwcm9wczsKCQkJcHJvcHMgPSBbICIqIiBdOwoJCX0gZWxzZSB7CgkJCXByb3BzID0gcHJvcHMubWF0Y2goIHJub3R3aGl0ZSApOwoJCX0KCgkJdmFyIHByb3AsCgkJCWluZGV4ID0gMCwKCQkJbGVuZ3RoID0gcHJvcHMubGVuZ3RoOwoKCQlmb3IgKCA7IGluZGV4IDwgbGVuZ3RoIDsgaW5kZXgrKyApIHsKCQkJcHJvcCA9IHByb3BzWyBpbmRleCBdOwoJCQlBbmltYXRpb24udHdlZW5lcnNbIHByb3AgXSA9IEFuaW1hdGlvbi50d2VlbmVyc1sgcHJvcCBdIHx8IFtdOwoJCQlBbmltYXRpb24udHdlZW5lcnNbIHByb3AgXS51bnNoaWZ0KCBjYWxsYmFjayApOwoJCX0KCX0sCgoJcHJlZmlsdGVyczogWyBkZWZhdWx0UHJlZmlsdGVyIF0sCgoJcHJlZmlsdGVyOiBmdW5jdGlvbiggY2FsbGJhY2ssIHByZXBlbmQgKSB7CgkJaWYgKCBwcmVwZW5kICkgewoJCQlBbmltYXRpb24ucHJlZmlsdGVycy51bnNoaWZ0KCBjYWxsYmFjayApOwoJCX0gZWxzZSB7CgkJCUFuaW1hdGlvbi5wcmVmaWx0ZXJzLnB1c2goIGNhbGxiYWNrICk7CgkJfQoJfQp9ICk7CgpqUXVlcnkuc3BlZWQgPSBmdW5jdGlvbiggc3BlZWQsIGVhc2luZywgZm4gKSB7Cgl2YXIgb3B0ID0gc3BlZWQgJiYgdHlwZW9mIHNwZWVkID09PSAib2JqZWN0IiA/IGpRdWVyeS5leHRlbmQoIHt9LCBzcGVlZCApIDogewoJCWNvbXBsZXRlOiBmbiB8fCAhZm4gJiYgZWFzaW5nIHx8CgkJCWpRdWVyeS5pc0Z1bmN0aW9uKCBzcGVlZCApICYmIHNwZWVkLAoJCWR1cmF0aW9uOiBzcGVlZCwKCQllYXNpbmc6IGZuICYmIGVhc2luZyB8fCBlYXNpbmcgJiYgIWpRdWVyeS5pc0Z1bmN0aW9uKCBlYXNpbmcgKSAmJiBlYXNpbmcKCX07CgoJb3B0LmR1cmF0aW9uID0galF1ZXJ5LmZ4Lm9mZiA/IDAgOiB0eXBlb2Ygb3B0LmR1cmF0aW9uID09PSAibnVtYmVyIiA/CgkJb3B0LmR1cmF0aW9uIDogb3B0LmR1cmF0aW9uIGluIGpRdWVyeS5meC5zcGVlZHMgPwoJCQlqUXVlcnkuZnguc3BlZWRzWyBvcHQuZHVyYXRpb24gXSA6IGpRdWVyeS5meC5zcGVlZHMuX2RlZmF1bHQ7CgoJLy8gTm9ybWFsaXplIG9wdC5xdWV1ZSAtIHRydWUvdW5kZWZpbmVkL251bGwgLT4gImZ4IgoJaWYgKCBvcHQucXVldWUgPT0gbnVsbCB8fCBvcHQucXVldWUgPT09IHRydWUgKSB7CgkJb3B0LnF1ZXVlID0gImZ4IjsKCX0KCgkvLyBRdWV1ZWluZwoJb3B0Lm9sZCA9IG9wdC5jb21wbGV0ZTsKCglvcHQuY29tcGxldGUgPSBmdW5jdGlvbigpIHsKCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBvcHQub2xkICkgKSB7CgkJCW9wdC5vbGQuY2FsbCggdGhpcyApOwoJCX0KCgkJaWYgKCBvcHQucXVldWUgKSB7CgkJCWpRdWVyeS5kZXF1ZXVlKCB0aGlzLCBvcHQucXVldWUgKTsKCQl9Cgl9OwoKCXJldHVybiBvcHQ7Cn07CgpqUXVlcnkuZm4uZXh0ZW5kKCB7CglmYWRlVG86IGZ1bmN0aW9uKCBzcGVlZCwgdG8sIGVhc2luZywgY2FsbGJhY2sgKSB7CgoJCS8vIFNob3cgYW55IGhpZGRlbiBlbGVtZW50cyBhZnRlciBzZXR0aW5nIG9wYWNpdHkgdG8gMAoJCXJldHVybiB0aGlzLmZpbHRlciggaXNIaWRkZW4gKS5jc3MoICJvcGFjaXR5IiwgMCApLnNob3coKQoKCQkJLy8gQW5pbWF0ZSB0byB0aGUgdmFsdWUgc3BlY2lmaWVkCgkJCS5lbmQoKS5hbmltYXRlKCB7IG9wYWNpdHk6IHRvIH0sIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICk7Cgl9LAoJYW5pbWF0ZTogZnVuY3Rpb24oIHByb3AsIHNwZWVkLCBlYXNpbmcsIGNhbGxiYWNrICkgewoJCXZhciBlbXB0eSA9IGpRdWVyeS5pc0VtcHR5T2JqZWN0KCBwcm9wICksCgkJCW9wdGFsbCA9IGpRdWVyeS5zcGVlZCggc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKSwKCQkJZG9BbmltYXRpb24gPSBmdW5jdGlvbigpIHsKCgkJCQkvLyBPcGVyYXRlIG9uIGEgY29weSBvZiBwcm9wIHNvIHBlci1wcm9wZXJ0eSBlYXNpbmcgd29uJ3QgYmUgbG9zdAoJCQkJdmFyIGFuaW0gPSBBbmltYXRpb24oIHRoaXMsIGpRdWVyeS5leHRlbmQoIHt9LCBwcm9wICksIG9wdGFsbCApOwoKCQkJCS8vIEVtcHR5IGFuaW1hdGlvbnMsIG9yIGZpbmlzaGluZyByZXNvbHZlcyBpbW1lZGlhdGVseQoJCQkJaWYgKCBlbXB0eSB8fCBkYXRhUHJpdi5nZXQoIHRoaXMsICJmaW5pc2giICkgKSB7CgkJCQkJYW5pbS5zdG9wKCB0cnVlICk7CgkJCQl9CgkJCX07CgkJCWRvQW5pbWF0aW9uLmZpbmlzaCA9IGRvQW5pbWF0aW9uOwoKCQlyZXR1cm4gZW1wdHkgfHwgb3B0YWxsLnF1ZXVlID09PSBmYWxzZSA/CgkJCXRoaXMuZWFjaCggZG9BbmltYXRpb24gKSA6CgkJCXRoaXMucXVldWUoIG9wdGFsbC5xdWV1ZSwgZG9BbmltYXRpb24gKTsKCX0sCglzdG9wOiBmdW5jdGlvbiggdHlwZSwgY2xlYXJRdWV1ZSwgZ290b0VuZCApIHsKCQl2YXIgc3RvcFF1ZXVlID0gZnVuY3Rpb24oIGhvb2tzICkgewoJCQl2YXIgc3RvcCA9IGhvb2tzLnN0b3A7CgkJCWRlbGV0ZSBob29rcy5zdG9wOwoJCQlzdG9wKCBnb3RvRW5kICk7CgkJfTsKCgkJaWYgKCB0eXBlb2YgdHlwZSAhPT0gInN0cmluZyIgKSB7CgkJCWdvdG9FbmQgPSBjbGVhclF1ZXVlOwoJCQljbGVhclF1ZXVlID0gdHlwZTsKCQkJdHlwZSA9IHVuZGVmaW5lZDsKCQl9CgkJaWYgKCBjbGVhclF1ZXVlICYmIHR5cGUgIT09IGZhbHNlICkgewoJCQl0aGlzLnF1ZXVlKCB0eXBlIHx8ICJmeCIsIFtdICk7CgkJfQoKCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsKCQkJdmFyIGRlcXVldWUgPSB0cnVlLAoJCQkJaW5kZXggPSB0eXBlICE9IG51bGwgJiYgdHlwZSArICJxdWV1ZUhvb2tzIiwKCQkJCXRpbWVycyA9IGpRdWVyeS50aW1lcnMsCgkJCQlkYXRhID0gZGF0YVByaXYuZ2V0KCB0aGlzICk7CgoJCQlpZiAoIGluZGV4ICkgewoJCQkJaWYgKCBkYXRhWyBpbmRleCBdICYmIGRhdGFbIGluZGV4IF0uc3RvcCApIHsKCQkJCQlzdG9wUXVldWUoIGRhdGFbIGluZGV4IF0gKTsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCWZvciAoIGluZGV4IGluIGRhdGEgKSB7CgkJCQkJaWYgKCBkYXRhWyBpbmRleCBdICYmIGRhdGFbIGluZGV4IF0uc3RvcCAmJiBycnVuLnRlc3QoIGluZGV4ICkgKSB7CgkJCQkJCXN0b3BRdWV1ZSggZGF0YVsgaW5kZXggXSApOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJZm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHsKCQkJCWlmICggdGltZXJzWyBpbmRleCBdLmVsZW0gPT09IHRoaXMgJiYKCQkJCQkoIHR5cGUgPT0gbnVsbCB8fCB0aW1lcnNbIGluZGV4IF0ucXVldWUgPT09IHR5cGUgKSApIHsKCgkJCQkJdGltZXJzWyBpbmRleCBdLmFuaW0uc3RvcCggZ290b0VuZCApOwoJCQkJCWRlcXVldWUgPSBmYWxzZTsKCQkJCQl0aW1lcnMuc3BsaWNlKCBpbmRleCwgMSApOwoJCQkJfQoJCQl9CgoJCQkvLyBTdGFydCB0aGUgbmV4dCBpbiB0aGUgcXVldWUgaWYgdGhlIGxhc3Qgc3RlcCB3YXNuJ3QgZm9yY2VkLgoJCQkvLyBUaW1lcnMgY3VycmVudGx5IHdpbGwgY2FsbCB0aGVpciBjb21wbGV0ZSBjYWxsYmFja3MsIHdoaWNoCgkJCS8vIHdpbGwgZGVxdWV1ZSBidXQgb25seSBpZiB0aGV5IHdlcmUgZ290b0VuZC4KCQkJaWYgKCBkZXF1ZXVlIHx8ICFnb3RvRW5kICkgewoJCQkJalF1ZXJ5LmRlcXVldWUoIHRoaXMsIHR5cGUgKTsKCQkJfQoJCX0gKTsKCX0sCglmaW5pc2g6IGZ1bmN0aW9uKCB0eXBlICkgewoJCWlmICggdHlwZSAhPT0gZmFsc2UgKSB7CgkJCXR5cGUgPSB0eXBlIHx8ICJmeCI7CgkJfQoJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQl2YXIgaW5kZXgsCgkJCQlkYXRhID0gZGF0YVByaXYuZ2V0KCB0aGlzICksCgkJCQlxdWV1ZSA9IGRhdGFbIHR5cGUgKyAicXVldWUiIF0sCgkJCQlob29rcyA9IGRhdGFbIHR5cGUgKyAicXVldWVIb29rcyIgXSwKCQkJCXRpbWVycyA9IGpRdWVyeS50aW1lcnMsCgkJCQlsZW5ndGggPSBxdWV1ZSA/IHF1ZXVlLmxlbmd0aCA6IDA7CgoJCQkvLyBFbmFibGUgZmluaXNoaW5nIGZsYWcgb24gcHJpdmF0ZSBkYXRhCgkJCWRhdGEuZmluaXNoID0gdHJ1ZTsKCgkJCS8vIEVtcHR5IHRoZSBxdWV1ZSBmaXJzdAoJCQlqUXVlcnkucXVldWUoIHRoaXMsIHR5cGUsIFtdICk7CgoJCQlpZiAoIGhvb2tzICYmIGhvb2tzLnN0b3AgKSB7CgkJCQlob29rcy5zdG9wLmNhbGwoIHRoaXMsIHRydWUgKTsKCQkJfQoKCQkJLy8gTG9vayBmb3IgYW55IGFjdGl2ZSBhbmltYXRpb25zLCBhbmQgZmluaXNoIHRoZW0KCQkJZm9yICggaW5kZXggPSB0aW1lcnMubGVuZ3RoOyBpbmRleC0tOyApIHsKCQkJCWlmICggdGltZXJzWyBpbmRleCBdLmVsZW0gPT09IHRoaXMgJiYgdGltZXJzWyBpbmRleCBdLnF1ZXVlID09PSB0eXBlICkgewoJCQkJCXRpbWVyc1sgaW5kZXggXS5hbmltLnN0b3AoIHRydWUgKTsKCQkJCQl0aW1lcnMuc3BsaWNlKCBpbmRleCwgMSApOwoJCQkJfQoJCQl9CgoJCQkvLyBMb29rIGZvciBhbnkgYW5pbWF0aW9ucyBpbiB0aGUgb2xkIHF1ZXVlIGFuZCBmaW5pc2ggdGhlbQoJCQlmb3IgKCBpbmRleCA9IDA7IGluZGV4IDwgbGVuZ3RoOyBpbmRleCsrICkgewoJCQkJaWYgKCBxdWV1ZVsgaW5kZXggXSAmJiBxdWV1ZVsgaW5kZXggXS5maW5pc2ggKSB7CgkJCQkJcXVldWVbIGluZGV4IF0uZmluaXNoLmNhbGwoIHRoaXMgKTsKCQkJCX0KCQkJfQoKCQkJLy8gVHVybiBvZmYgZmluaXNoaW5nIGZsYWcKCQkJZGVsZXRlIGRhdGEuZmluaXNoOwoJCX0gKTsKCX0KfSApOwoKalF1ZXJ5LmVhY2goIFsgInRvZ2dsZSIsICJzaG93IiwgImhpZGUiIF0sIGZ1bmN0aW9uKCBpLCBuYW1lICkgewoJdmFyIGNzc0ZuID0galF1ZXJ5LmZuWyBuYW1lIF07CglqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHsKCQlyZXR1cm4gc3BlZWQgPT0gbnVsbCB8fCB0eXBlb2Ygc3BlZWQgPT09ICJib29sZWFuIiA/CgkJCWNzc0ZuLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKSA6CgkJCXRoaXMuYW5pbWF0ZSggZ2VuRngoIG5hbWUsIHRydWUgKSwgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKTsKCX07Cn0gKTsKCi8vIEdlbmVyYXRlIHNob3J0Y3V0cyBmb3IgY3VzdG9tIGFuaW1hdGlvbnMKalF1ZXJ5LmVhY2goIHsKCXNsaWRlRG93bjogZ2VuRngoICJzaG93IiApLAoJc2xpZGVVcDogZ2VuRngoICJoaWRlIiApLAoJc2xpZGVUb2dnbGU6IGdlbkZ4KCAidG9nZ2xlIiApLAoJZmFkZUluOiB7IG9wYWNpdHk6ICJzaG93IiB9LAoJZmFkZU91dDogeyBvcGFjaXR5OiAiaGlkZSIgfSwKCWZhZGVUb2dnbGU6IHsgb3BhY2l0eTogInRvZ2dsZSIgfQp9LCBmdW5jdGlvbiggbmFtZSwgcHJvcHMgKSB7CglqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBzcGVlZCwgZWFzaW5nLCBjYWxsYmFjayApIHsKCQlyZXR1cm4gdGhpcy5hbmltYXRlKCBwcm9wcywgc3BlZWQsIGVhc2luZywgY2FsbGJhY2sgKTsKCX07Cn0gKTsKCmpRdWVyeS50aW1lcnMgPSBbXTsKalF1ZXJ5LmZ4LnRpY2sgPSBmdW5jdGlvbigpIHsKCXZhciB0aW1lciwKCQlpID0gMCwKCQl0aW1lcnMgPSBqUXVlcnkudGltZXJzOwoKCWZ4Tm93ID0galF1ZXJ5Lm5vdygpOwoKCWZvciAoIDsgaSA8IHRpbWVycy5sZW5ndGg7IGkrKyApIHsKCQl0aW1lciA9IHRpbWVyc1sgaSBdOwoKCQkvLyBDaGVja3MgdGhlIHRpbWVyIGhhcyBub3QgYWxyZWFkeSBiZWVuIHJlbW92ZWQKCQlpZiAoICF0aW1lcigpICYmIHRpbWVyc1sgaSBdID09PSB0aW1lciApIHsKCQkJdGltZXJzLnNwbGljZSggaS0tLCAxICk7CgkJfQoJfQoKCWlmICggIXRpbWVycy5sZW5ndGggKSB7CgkJalF1ZXJ5LmZ4LnN0b3AoKTsKCX0KCWZ4Tm93ID0gdW5kZWZpbmVkOwp9OwoKalF1ZXJ5LmZ4LnRpbWVyID0gZnVuY3Rpb24oIHRpbWVyICkgewoJalF1ZXJ5LnRpbWVycy5wdXNoKCB0aW1lciApOwoJaWYgKCB0aW1lcigpICkgewoJCWpRdWVyeS5meC5zdGFydCgpOwoJfSBlbHNlIHsKCQlqUXVlcnkudGltZXJzLnBvcCgpOwoJfQp9OwoKalF1ZXJ5LmZ4LmludGVydmFsID0gMTM7CmpRdWVyeS5meC5zdGFydCA9IGZ1bmN0aW9uKCkgewoJaWYgKCAhdGltZXJJZCApIHsKCQl0aW1lcklkID0gd2luZG93LnNldEludGVydmFsKCBqUXVlcnkuZngudGljaywgalF1ZXJ5LmZ4LmludGVydmFsICk7Cgl9Cn07CgpqUXVlcnkuZnguc3RvcCA9IGZ1bmN0aW9uKCkgewoJd2luZG93LmNsZWFySW50ZXJ2YWwoIHRpbWVySWQgKTsKCgl0aW1lcklkID0gbnVsbDsKfTsKCmpRdWVyeS5meC5zcGVlZHMgPSB7CglzbG93OiA2MDAsCglmYXN0OiAyMDAsCgoJLy8gRGVmYXVsdCBzcGVlZAoJX2RlZmF1bHQ6IDQwMAp9OwoKCi8vIEJhc2VkIG9mZiBvZiB0aGUgcGx1Z2luIGJ5IENsaW50IEhlbGZlcnMsIHdpdGggcGVybWlzc2lvbi4KLy8gaHR0cDovL3dlYi5hcmNoaXZlLm9yZy93ZWIvMjAxMDAzMjQwMTQ3NDcvaHR0cDovL2JsaW5kc2lnbmFscy5jb20vaW5kZXgucGhwLzIwMDkvMDcvanF1ZXJ5LWRlbGF5LwpqUXVlcnkuZm4uZGVsYXkgPSBmdW5jdGlvbiggdGltZSwgdHlwZSApIHsKCXRpbWUgPSBqUXVlcnkuZnggPyBqUXVlcnkuZnguc3BlZWRzWyB0aW1lIF0gfHwgdGltZSA6IHRpbWU7Cgl0eXBlID0gdHlwZSB8fCAiZngiOwoKCXJldHVybiB0aGlzLnF1ZXVlKCB0eXBlLCBmdW5jdGlvbiggbmV4dCwgaG9va3MgKSB7CgkJdmFyIHRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCggbmV4dCwgdGltZSApOwoJCWhvb2tzLnN0b3AgPSBmdW5jdGlvbigpIHsKCQkJd2luZG93LmNsZWFyVGltZW91dCggdGltZW91dCApOwoJCX07Cgl9ICk7Cn07CgoKKCBmdW5jdGlvbigpIHsKCXZhciBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJpbnB1dCIgKSwKCQlzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAic2VsZWN0IiApLAoJCW9wdCA9IHNlbGVjdC5hcHBlbmRDaGlsZCggZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggIm9wdGlvbiIgKSApOwoKCWlucHV0LnR5cGUgPSAiY2hlY2tib3giOwoKCS8vIFN1cHBvcnQ6IGlPUzw9NS4xLCBBbmRyb2lkPD00LjIrCgkvLyBEZWZhdWx0IHZhbHVlIGZvciBhIGNoZWNrYm94IHNob3VsZCBiZSAib24iCglzdXBwb3J0LmNoZWNrT24gPSBpbnB1dC52YWx1ZSAhPT0gIiI7CgoJLy8gU3VwcG9ydDogSUU8PTExKwoJLy8gTXVzdCBhY2Nlc3Mgc2VsZWN0ZWRJbmRleCB0byBtYWtlIGRlZmF1bHQgb3B0aW9ucyBzZWxlY3QKCXN1cHBvcnQub3B0U2VsZWN0ZWQgPSBvcHQuc2VsZWN0ZWQ7CgoJLy8gU3VwcG9ydDogQW5kcm9pZDw9Mi4zCgkvLyBPcHRpb25zIGluc2lkZSBkaXNhYmxlZCBzZWxlY3RzIGFyZSBpbmNvcnJlY3RseSBtYXJrZWQgYXMgZGlzYWJsZWQKCXNlbGVjdC5kaXNhYmxlZCA9IHRydWU7CglzdXBwb3J0Lm9wdERpc2FibGVkID0gIW9wdC5kaXNhYmxlZDsKCgkvLyBTdXBwb3J0OiBJRTw9MTErCgkvLyBBbiBpbnB1dCBsb3NlcyBpdHMgdmFsdWUgYWZ0ZXIgYmVjb21pbmcgYSByYWRpbwoJaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAiaW5wdXQiICk7CglpbnB1dC52YWx1ZSA9ICJ0IjsKCWlucHV0LnR5cGUgPSAicmFkaW8iOwoJc3VwcG9ydC5yYWRpb1ZhbHVlID0gaW5wdXQudmFsdWUgPT09ICJ0IjsKfSApKCk7CgoKdmFyIGJvb2xIb29rLAoJYXR0ckhhbmRsZSA9IGpRdWVyeS5leHByLmF0dHJIYW5kbGU7CgpqUXVlcnkuZm4uZXh0ZW5kKCB7CglhdHRyOiBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7CgkJcmV0dXJuIGFjY2VzcyggdGhpcywgalF1ZXJ5LmF0dHIsIG5hbWUsIHZhbHVlLCBhcmd1bWVudHMubGVuZ3RoID4gMSApOwoJfSwKCglyZW1vdmVBdHRyOiBmdW5jdGlvbiggbmFtZSApIHsKCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbigpIHsKCQkJalF1ZXJ5LnJlbW92ZUF0dHIoIHRoaXMsIG5hbWUgKTsKCQl9ICk7Cgl9Cn0gKTsKCmpRdWVyeS5leHRlbmQoIHsKCWF0dHI6IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCB2YWx1ZSApIHsKCQl2YXIgcmV0LCBob29rcywKCQkJblR5cGUgPSBlbGVtLm5vZGVUeXBlOwoKCQkvLyBEb24ndCBnZXQvc2V0IGF0dHJpYnV0ZXMgb24gdGV4dCwgY29tbWVudCBhbmQgYXR0cmlidXRlIG5vZGVzCgkJaWYgKCBuVHlwZSA9PT0gMyB8fCBuVHlwZSA9PT0gOCB8fCBuVHlwZSA9PT0gMiApIHsKCQkJcmV0dXJuOwoJCX0KCgkJLy8gRmFsbGJhY2sgdG8gcHJvcCB3aGVuIGF0dHJpYnV0ZXMgYXJlIG5vdCBzdXBwb3J0ZWQKCQlpZiAoIHR5cGVvZiBlbGVtLmdldEF0dHJpYnV0ZSA9PT0gInVuZGVmaW5lZCIgKSB7CgkJCXJldHVybiBqUXVlcnkucHJvcCggZWxlbSwgbmFtZSwgdmFsdWUgKTsKCQl9CgoJCS8vIEFsbCBhdHRyaWJ1dGVzIGFyZSBsb3dlcmNhc2UKCQkvLyBHcmFiIG5lY2Vzc2FyeSBob29rIGlmIG9uZSBpcyBkZWZpbmVkCgkJaWYgKCBuVHlwZSAhPT0gMSB8fCAhalF1ZXJ5LmlzWE1MRG9jKCBlbGVtICkgKSB7CgkJCW5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CgkJCWhvb2tzID0galF1ZXJ5LmF0dHJIb29rc1sgbmFtZSBdIHx8CgkJCQkoIGpRdWVyeS5leHByLm1hdGNoLmJvb2wudGVzdCggbmFtZSApID8gYm9vbEhvb2sgOiB1bmRlZmluZWQgKTsKCQl9CgoJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJaWYgKCB2YWx1ZSA9PT0gbnVsbCApIHsKCQkJCWpRdWVyeS5yZW1vdmVBdHRyKCBlbGVtLCBuYW1lICk7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWlmICggaG9va3MgJiYgInNldCIgaW4gaG9va3MgJiYKCQkJCSggcmV0ID0gaG9va3Muc2V0KCBlbGVtLCB2YWx1ZSwgbmFtZSApICkgIT09IHVuZGVmaW5lZCApIHsKCQkJCXJldHVybiByZXQ7CgkJCX0KCgkJCWVsZW0uc2V0QXR0cmlidXRlKCBuYW1lLCB2YWx1ZSArICIiICk7CgkJCXJldHVybiB2YWx1ZTsKCQl9CgoJCWlmICggaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKCByZXQgPSBob29rcy5nZXQoIGVsZW0sIG5hbWUgKSApICE9PSBudWxsICkgewoJCQlyZXR1cm4gcmV0OwoJCX0KCgkJcmV0ID0galF1ZXJ5LmZpbmQuYXR0ciggZWxlbSwgbmFtZSApOwoKCQkvLyBOb24tZXhpc3RlbnQgYXR0cmlidXRlcyByZXR1cm4gbnVsbCwgd2Ugbm9ybWFsaXplIHRvIHVuZGVmaW5lZAoJCXJldHVybiByZXQgPT0gbnVsbCA/IHVuZGVmaW5lZCA6IHJldDsKCX0sCgoJYXR0ckhvb2tzOiB7CgkJdHlwZTogewoJCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJCWlmICggIXN1cHBvcnQucmFkaW9WYWx1ZSAmJiB2YWx1ZSA9PT0gInJhZGlvIiAmJgoJCQkJCWpRdWVyeS5ub2RlTmFtZSggZWxlbSwgImlucHV0IiApICkgewoJCQkJCXZhciB2YWwgPSBlbGVtLnZhbHVlOwoJCQkJCWVsZW0uc2V0QXR0cmlidXRlKCAidHlwZSIsIHZhbHVlICk7CgkJCQkJaWYgKCB2YWwgKSB7CgkJCQkJCWVsZW0udmFsdWUgPSB2YWw7CgkJCQkJfQoJCQkJCXJldHVybiB2YWx1ZTsKCQkJCX0KCQkJfQoJCX0KCX0sCgoJcmVtb3ZlQXR0cjogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCXZhciBuYW1lLCBwcm9wTmFtZSwKCQkJaSA9IDAsCgkJCWF0dHJOYW1lcyA9IHZhbHVlICYmIHZhbHVlLm1hdGNoKCBybm90d2hpdGUgKTsKCgkJaWYgKCBhdHRyTmFtZXMgJiYgZWxlbS5ub2RlVHlwZSA9PT0gMSApIHsKCQkJd2hpbGUgKCAoIG5hbWUgPSBhdHRyTmFtZXNbIGkrKyBdICkgKSB7CgkJCQlwcm9wTmFtZSA9IGpRdWVyeS5wcm9wRml4WyBuYW1lIF0gfHwgbmFtZTsKCgkJCQkvLyBCb29sZWFuIGF0dHJpYnV0ZXMgZ2V0IHNwZWNpYWwgdHJlYXRtZW50ICgjMTA4NzApCgkJCQlpZiAoIGpRdWVyeS5leHByLm1hdGNoLmJvb2wudGVzdCggbmFtZSApICkgewoKCQkJCQkvLyBTZXQgY29ycmVzcG9uZGluZyBwcm9wZXJ0eSB0byBmYWxzZQoJCQkJCWVsZW1bIHByb3BOYW1lIF0gPSBmYWxzZTsKCQkJCX0KCgkJCQllbGVtLnJlbW92ZUF0dHJpYnV0ZSggbmFtZSApOwoJCQl9CgkJfQoJfQp9ICk7CgovLyBIb29rcyBmb3IgYm9vbGVhbiBhdHRyaWJ1dGVzCmJvb2xIb29rID0gewoJc2V0OiBmdW5jdGlvbiggZWxlbSwgdmFsdWUsIG5hbWUgKSB7CgkJaWYgKCB2YWx1ZSA9PT0gZmFsc2UgKSB7CgoJCQkvLyBSZW1vdmUgYm9vbGVhbiBhdHRyaWJ1dGVzIHdoZW4gc2V0IHRvIGZhbHNlCgkJCWpRdWVyeS5yZW1vdmVBdHRyKCBlbGVtLCBuYW1lICk7CgkJfSBlbHNlIHsKCQkJZWxlbS5zZXRBdHRyaWJ1dGUoIG5hbWUsIG5hbWUgKTsKCQl9CgkJcmV0dXJuIG5hbWU7Cgl9Cn07CmpRdWVyeS5lYWNoKCBqUXVlcnkuZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCggL1x3Ky9nICksIGZ1bmN0aW9uKCBpLCBuYW1lICkgewoJdmFyIGdldHRlciA9IGF0dHJIYW5kbGVbIG5hbWUgXSB8fCBqUXVlcnkuZmluZC5hdHRyOwoKCWF0dHJIYW5kbGVbIG5hbWUgXSA9IGZ1bmN0aW9uKCBlbGVtLCBuYW1lLCBpc1hNTCApIHsKCQl2YXIgcmV0LCBoYW5kbGU7CgkJaWYgKCAhaXNYTUwgKSB7CgoJCQkvLyBBdm9pZCBhbiBpbmZpbml0ZSBsb29wIGJ5IHRlbXBvcmFyaWx5IHJlbW92aW5nIHRoaXMgZnVuY3Rpb24gZnJvbSB0aGUgZ2V0dGVyCgkJCWhhbmRsZSA9IGF0dHJIYW5kbGVbIG5hbWUgXTsKCQkJYXR0ckhhbmRsZVsgbmFtZSBdID0gcmV0OwoJCQlyZXQgPSBnZXR0ZXIoIGVsZW0sIG5hbWUsIGlzWE1MICkgIT0gbnVsbCA/CgkJCQluYW1lLnRvTG93ZXJDYXNlKCkgOgoJCQkJbnVsbDsKCQkJYXR0ckhhbmRsZVsgbmFtZSBdID0gaGFuZGxlOwoJCX0KCQlyZXR1cm4gcmV0OwoJfTsKfSApOwoKCgoKdmFyIHJmb2N1c2FibGUgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLAoJcmNsaWNrYWJsZSA9IC9eKD86YXxhcmVhKSQvaTsKCmpRdWVyeS5mbi5leHRlbmQoIHsKCXByb3A6IGZ1bmN0aW9uKCBuYW1lLCB2YWx1ZSApIHsKCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBqUXVlcnkucHJvcCwgbmFtZSwgdmFsdWUsIGFyZ3VtZW50cy5sZW5ndGggPiAxICk7Cgl9LAoKCXJlbW92ZVByb3A6IGZ1bmN0aW9uKCBuYW1lICkgewoJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQlkZWxldGUgdGhpc1sgalF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lIF07CgkJfSApOwoJfQp9ICk7CgpqUXVlcnkuZXh0ZW5kKCB7Cglwcm9wOiBmdW5jdGlvbiggZWxlbSwgbmFtZSwgdmFsdWUgKSB7CgkJdmFyIHJldCwgaG9va3MsCgkJCW5UeXBlID0gZWxlbS5ub2RlVHlwZTsKCgkJLy8gRG9uJ3QgZ2V0L3NldCBwcm9wZXJ0aWVzIG9uIHRleHQsIGNvbW1lbnQgYW5kIGF0dHJpYnV0ZSBub2RlcwoJCWlmICggblR5cGUgPT09IDMgfHwgblR5cGUgPT09IDggfHwgblR5cGUgPT09IDIgKSB7CgkJCXJldHVybjsKCQl9CgoJCWlmICggblR5cGUgIT09IDEgfHwgIWpRdWVyeS5pc1hNTERvYyggZWxlbSApICkgewoKCQkJLy8gRml4IG5hbWUgYW5kIGF0dGFjaCBob29rcwoJCQluYW1lID0galF1ZXJ5LnByb3BGaXhbIG5hbWUgXSB8fCBuYW1lOwoJCQlob29rcyA9IGpRdWVyeS5wcm9wSG9va3NbIG5hbWUgXTsKCQl9CgoJCWlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApIHsKCQkJaWYgKCBob29rcyAmJiAic2V0IiBpbiBob29rcyAmJgoJCQkJKCByZXQgPSBob29rcy5zZXQoIGVsZW0sIHZhbHVlLCBuYW1lICkgKSAhPT0gdW5kZWZpbmVkICkgewoJCQkJcmV0dXJuIHJldDsKCQkJfQoKCQkJcmV0dXJuICggZWxlbVsgbmFtZSBdID0gdmFsdWUgKTsKCQl9CgoJCWlmICggaG9va3MgJiYgImdldCIgaW4gaG9va3MgJiYgKCByZXQgPSBob29rcy5nZXQoIGVsZW0sIG5hbWUgKSApICE9PSBudWxsICkgewoJCQlyZXR1cm4gcmV0OwoJCX0KCgkJcmV0dXJuIGVsZW1bIG5hbWUgXTsKCX0sCgoJcHJvcEhvb2tzOiB7CgkJdGFiSW5kZXg6IHsKCQkJZ2V0OiBmdW5jdGlvbiggZWxlbSApIHsKCgkJCQkvLyBlbGVtLnRhYkluZGV4IGRvZXNuJ3QgYWx3YXlzIHJldHVybiB0aGUKCQkJCS8vIGNvcnJlY3QgdmFsdWUgd2hlbiBpdCBoYXNuJ3QgYmVlbiBleHBsaWNpdGx5IHNldAoJCQkJLy8gaHR0cDovL2ZsdWlkcHJvamVjdC5vcmcvYmxvZy8yMDA4LzAxLzA5L2dldHRpbmctc2V0dGluZy1hbmQtcmVtb3ZpbmctdGFiaW5kZXgtdmFsdWVzLXdpdGgtamF2YXNjcmlwdC8KCQkJCS8vIFVzZSBwcm9wZXIgYXR0cmlidXRlIHJldHJpZXZhbCgjMTIwNzIpCgkJCQl2YXIgdGFiaW5kZXggPSBqUXVlcnkuZmluZC5hdHRyKCBlbGVtLCAidGFiaW5kZXgiICk7CgoJCQkJcmV0dXJuIHRhYmluZGV4ID8KCQkJCQlwYXJzZUludCggdGFiaW5kZXgsIDEwICkgOgoJCQkJCXJmb2N1c2FibGUudGVzdCggZWxlbS5ub2RlTmFtZSApIHx8CgkJCQkJCXJjbGlja2FibGUudGVzdCggZWxlbS5ub2RlTmFtZSApICYmIGVsZW0uaHJlZiA/CgkJCQkJCQkwIDoKCQkJCQkJCS0xOwoJCQl9CgkJfQoJfSwKCglwcm9wRml4OiB7CgkJImZvciI6ICJodG1sRm9yIiwKCQkiY2xhc3MiOiAiY2xhc3NOYW1lIgoJfQp9ICk7CgppZiAoICFzdXBwb3J0Lm9wdFNlbGVjdGVkICkgewoJalF1ZXJ5LnByb3BIb29rcy5zZWxlY3RlZCA9IHsKCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQl2YXIgcGFyZW50ID0gZWxlbS5wYXJlbnROb2RlOwoJCQlpZiAoIHBhcmVudCAmJiBwYXJlbnQucGFyZW50Tm9kZSApIHsKCQkJCXBhcmVudC5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXg7CgkJCX0KCQkJcmV0dXJuIG51bGw7CgkJfQoJfTsKfQoKalF1ZXJ5LmVhY2goIFsKCSJ0YWJJbmRleCIsCgkicmVhZE9ubHkiLAoJIm1heExlbmd0aCIsCgkiY2VsbFNwYWNpbmciLAoJImNlbGxQYWRkaW5nIiwKCSJyb3dTcGFuIiwKCSJjb2xTcGFuIiwKCSJ1c2VNYXAiLAoJImZyYW1lQm9yZGVyIiwKCSJjb250ZW50RWRpdGFibGUiCl0sIGZ1bmN0aW9uKCkgewoJalF1ZXJ5LnByb3BGaXhbIHRoaXMudG9Mb3dlckNhc2UoKSBdID0gdGhpczsKfSApOwoKCgoKdmFyIHJjbGFzcyA9IC9bXHRcclxuXGZdL2c7CgpmdW5jdGlvbiBnZXRDbGFzcyggZWxlbSApIHsKCXJldHVybiBlbGVtLmdldEF0dHJpYnV0ZSAmJiBlbGVtLmdldEF0dHJpYnV0ZSggImNsYXNzIiApIHx8ICIiOwp9CgpqUXVlcnkuZm4uZXh0ZW5kKCB7CglhZGRDbGFzczogZnVuY3Rpb24oIHZhbHVlICkgewoJCXZhciBjbGFzc2VzLCBlbGVtLCBjdXIsIGN1clZhbHVlLCBjbGF6eiwgaiwgZmluYWxWYWx1ZSwKCQkJaSA9IDA7CgoJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgKSB7CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCBqICkgewoJCQkJalF1ZXJ5KCB0aGlzICkuYWRkQ2xhc3MoIHZhbHVlLmNhbGwoIHRoaXMsIGosIGdldENsYXNzKCB0aGlzICkgKSApOwoJCQl9ICk7CgkJfQoKCQlpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgdmFsdWUgKSB7CgkJCWNsYXNzZXMgPSB2YWx1ZS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107CgoJCQl3aGlsZSAoICggZWxlbSA9IHRoaXNbIGkrKyBdICkgKSB7CgkJCQljdXJWYWx1ZSA9IGdldENsYXNzKCBlbGVtICk7CgkJCQljdXIgPSBlbGVtLm5vZGVUeXBlID09PSAxICYmCgkJCQkJKCAiICIgKyBjdXJWYWx1ZSArICIgIiApLnJlcGxhY2UoIHJjbGFzcywgIiAiICk7CgoJCQkJaWYgKCBjdXIgKSB7CgkJCQkJaiA9IDA7CgkJCQkJd2hpbGUgKCAoIGNsYXp6ID0gY2xhc3Nlc1sgaisrIF0gKSApIHsKCQkJCQkJaWYgKCBjdXIuaW5kZXhPZiggIiAiICsgY2xhenogKyAiICIgKSA8IDAgKSB7CgkJCQkJCQljdXIgKz0gY2xhenogKyAiICI7CgkJCQkJCX0KCQkJCQl9CgoJCQkJCS8vIE9ubHkgYXNzaWduIGlmIGRpZmZlcmVudCB0byBhdm9pZCB1bm5lZWRlZCByZW5kZXJpbmcuCgkJCQkJZmluYWxWYWx1ZSA9IGpRdWVyeS50cmltKCBjdXIgKTsKCQkJCQlpZiAoIGN1clZhbHVlICE9PSBmaW5hbFZhbHVlICkgewoJCQkJCQllbGVtLnNldEF0dHJpYnV0ZSggImNsYXNzIiwgZmluYWxWYWx1ZSApOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIHRoaXM7Cgl9LAoKCXJlbW92ZUNsYXNzOiBmdW5jdGlvbiggdmFsdWUgKSB7CgkJdmFyIGNsYXNzZXMsIGVsZW0sIGN1ciwgY3VyVmFsdWUsIGNsYXp6LCBqLCBmaW5hbFZhbHVlLAoJCQlpID0gMDsKCgkJaWYgKCBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGogKSB7CgkJCQlqUXVlcnkoIHRoaXMgKS5yZW1vdmVDbGFzcyggdmFsdWUuY2FsbCggdGhpcywgaiwgZ2V0Q2xhc3MoIHRoaXMgKSApICk7CgkJCX0gKTsKCQl9CgoJCWlmICggIWFyZ3VtZW50cy5sZW5ndGggKSB7CgkJCXJldHVybiB0aGlzLmF0dHIoICJjbGFzcyIsICIiICk7CgkJfQoKCQlpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gInN0cmluZyIgJiYgdmFsdWUgKSB7CgkJCWNsYXNzZXMgPSB2YWx1ZS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107CgoJCQl3aGlsZSAoICggZWxlbSA9IHRoaXNbIGkrKyBdICkgKSB7CgkJCQljdXJWYWx1ZSA9IGdldENsYXNzKCBlbGVtICk7CgoJCQkJLy8gVGhpcyBleHByZXNzaW9uIGlzIGhlcmUgZm9yIGJldHRlciBjb21wcmVzc2liaWxpdHkgKHNlZSBhZGRDbGFzcykKCQkJCWN1ciA9IGVsZW0ubm9kZVR5cGUgPT09IDEgJiYKCQkJCQkoICIgIiArIGN1clZhbHVlICsgIiAiICkucmVwbGFjZSggcmNsYXNzLCAiICIgKTsKCgkJCQlpZiAoIGN1ciApIHsKCQkJCQlqID0gMDsKCQkJCQl3aGlsZSAoICggY2xhenogPSBjbGFzc2VzWyBqKysgXSApICkgewoKCQkJCQkJLy8gUmVtb3ZlICphbGwqIGluc3RhbmNlcwoJCQkJCQl3aGlsZSAoIGN1ci5pbmRleE9mKCAiICIgKyBjbGF6eiArICIgIiApID4gLTEgKSB7CgkJCQkJCQljdXIgPSBjdXIucmVwbGFjZSggIiAiICsgY2xhenogKyAiICIsICIgIiApOwoJCQkJCQl9CgkJCQkJfQoKCQkJCQkvLyBPbmx5IGFzc2lnbiBpZiBkaWZmZXJlbnQgdG8gYXZvaWQgdW5uZWVkZWQgcmVuZGVyaW5nLgoJCQkJCWZpbmFsVmFsdWUgPSBqUXVlcnkudHJpbSggY3VyICk7CgkJCQkJaWYgKCBjdXJWYWx1ZSAhPT0gZmluYWxWYWx1ZSApIHsKCQkJCQkJZWxlbS5zZXRBdHRyaWJ1dGUoICJjbGFzcyIsIGZpbmFsVmFsdWUgKTsKCQkJCQl9CgkJCQl9CgkJCX0KCQl9CgoJCXJldHVybiB0aGlzOwoJfSwKCgl0b2dnbGVDbGFzczogZnVuY3Rpb24oIHZhbHVlLCBzdGF0ZVZhbCApIHsKCQl2YXIgdHlwZSA9IHR5cGVvZiB2YWx1ZTsKCgkJaWYgKCB0eXBlb2Ygc3RhdGVWYWwgPT09ICJib29sZWFuIiAmJiB0eXBlID09PSAic3RyaW5nIiApIHsKCQkJcmV0dXJuIHN0YXRlVmFsID8gdGhpcy5hZGRDbGFzcyggdmFsdWUgKSA6IHRoaXMucmVtb3ZlQ2xhc3MoIHZhbHVlICk7CgkJfQoKCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCB2YWx1ZSApICkgewoJCQlyZXR1cm4gdGhpcy5lYWNoKCBmdW5jdGlvbiggaSApIHsKCQkJCWpRdWVyeSggdGhpcyApLnRvZ2dsZUNsYXNzKAoJCQkJCXZhbHVlLmNhbGwoIHRoaXMsIGksIGdldENsYXNzKCB0aGlzICksIHN0YXRlVmFsICksCgkJCQkJc3RhdGVWYWwKCQkJCSk7CgkJCX0gKTsKCQl9CgoJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQl2YXIgY2xhc3NOYW1lLCBpLCBzZWxmLCBjbGFzc05hbWVzOwoKCQkJaWYgKCB0eXBlID09PSAic3RyaW5nIiApIHsKCgkJCQkvLyBUb2dnbGUgaW5kaXZpZHVhbCBjbGFzcyBuYW1lcwoJCQkJaSA9IDA7CgkJCQlzZWxmID0galF1ZXJ5KCB0aGlzICk7CgkJCQljbGFzc05hbWVzID0gdmFsdWUubWF0Y2goIHJub3R3aGl0ZSApIHx8IFtdOwoKCQkJCXdoaWxlICggKCBjbGFzc05hbWUgPSBjbGFzc05hbWVzWyBpKysgXSApICkgewoKCQkJCQkvLyBDaGVjayBlYWNoIGNsYXNzTmFtZSBnaXZlbiwgc3BhY2Ugc2VwYXJhdGVkIGxpc3QKCQkJCQlpZiAoIHNlbGYuaGFzQ2xhc3MoIGNsYXNzTmFtZSApICkgewoJCQkJCQlzZWxmLnJlbW92ZUNsYXNzKCBjbGFzc05hbWUgKTsKCQkJCQl9IGVsc2UgewoJCQkJCQlzZWxmLmFkZENsYXNzKCBjbGFzc05hbWUgKTsKCQkJCQl9CgkJCQl9CgoJCQkvLyBUb2dnbGUgd2hvbGUgY2xhc3MgbmFtZQoJCQl9IGVsc2UgaWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHR5cGUgPT09ICJib29sZWFuIiApIHsKCQkJCWNsYXNzTmFtZSA9IGdldENsYXNzKCB0aGlzICk7CgkJCQlpZiAoIGNsYXNzTmFtZSApIHsKCgkJCQkJLy8gU3RvcmUgY2xhc3NOYW1lIGlmIHNldAoJCQkJCWRhdGFQcml2LnNldCggdGhpcywgIl9fY2xhc3NOYW1lX18iLCBjbGFzc05hbWUgKTsKCQkJCX0KCgkJCQkvLyBJZiB0aGUgZWxlbWVudCBoYXMgYSBjbGFzcyBuYW1lIG9yIGlmIHdlJ3JlIHBhc3NlZCBgZmFsc2VgLAoJCQkJLy8gdGhlbiByZW1vdmUgdGhlIHdob2xlIGNsYXNzbmFtZSAoaWYgdGhlcmUgd2FzIG9uZSwgdGhlIGFib3ZlIHNhdmVkIGl0KS4KCQkJCS8vIE90aGVyd2lzZSBicmluZyBiYWNrIHdoYXRldmVyIHdhcyBwcmV2aW91c2x5IHNhdmVkIChpZiBhbnl0aGluZyksCgkJCQkvLyBmYWxsaW5nIGJhY2sgdG8gdGhlIGVtcHR5IHN0cmluZyBpZiBub3RoaW5nIHdhcyBzdG9yZWQuCgkJCQlpZiAoIHRoaXMuc2V0QXR0cmlidXRlICkgewoJCQkJCXRoaXMuc2V0QXR0cmlidXRlKCAiY2xhc3MiLAoJCQkJCQljbGFzc05hbWUgfHwgdmFsdWUgPT09IGZhbHNlID8KCQkJCQkJIiIgOgoJCQkJCQlkYXRhUHJpdi5nZXQoIHRoaXMsICJfX2NsYXNzTmFtZV9fIiApIHx8ICIiCgkJCQkJKTsKCQkJCX0KCQkJfQoJCX0gKTsKCX0sCgoJaGFzQ2xhc3M6IGZ1bmN0aW9uKCBzZWxlY3RvciApIHsKCQl2YXIgY2xhc3NOYW1lLCBlbGVtLAoJCQlpID0gMDsKCgkJY2xhc3NOYW1lID0gIiAiICsgc2VsZWN0b3IgKyAiICI7CgkJd2hpbGUgKCAoIGVsZW0gPSB0aGlzWyBpKysgXSApICkgewoJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDEgJiYKCQkJCSggIiAiICsgZ2V0Q2xhc3MoIGVsZW0gKSArICIgIiApLnJlcGxhY2UoIHJjbGFzcywgIiAiICkKCQkJCQkuaW5kZXhPZiggY2xhc3NOYW1lICkgPiAtMQoJCQkpIHsKCQkJCXJldHVybiB0cnVlOwoJCQl9CgkJfQoKCQlyZXR1cm4gZmFsc2U7Cgl9Cn0gKTsKCgoKCnZhciBycmV0dXJuID0gL1xyL2c7CgpqUXVlcnkuZm4uZXh0ZW5kKCB7Cgl2YWw6IGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQl2YXIgaG9va3MsIHJldCwgaXNGdW5jdGlvbiwKCQkJZWxlbSA9IHRoaXNbIDAgXTsKCgkJaWYgKCAhYXJndW1lbnRzLmxlbmd0aCApIHsKCQkJaWYgKCBlbGVtICkgewoJCQkJaG9va3MgPSBqUXVlcnkudmFsSG9va3NbIGVsZW0udHlwZSBdIHx8CgkJCQkJalF1ZXJ5LnZhbEhvb2tzWyBlbGVtLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgXTsKCgkJCQlpZiAoIGhvb2tzICYmCgkJCQkJImdldCIgaW4gaG9va3MgJiYKCQkJCQkoIHJldCA9IGhvb2tzLmdldCggZWxlbSwgInZhbHVlIiApICkgIT09IHVuZGVmaW5lZAoJCQkJKSB7CgkJCQkJcmV0dXJuIHJldDsKCQkJCX0KCgkJCQlyZXQgPSBlbGVtLnZhbHVlOwoKCQkJCXJldHVybiB0eXBlb2YgcmV0ID09PSAic3RyaW5nIiA/CgoJCQkJCS8vIEhhbmRsZSBtb3N0IGNvbW1vbiBzdHJpbmcgY2FzZXMKCQkJCQlyZXQucmVwbGFjZSggcnJldHVybiwgIiIgKSA6CgoJCQkJCS8vIEhhbmRsZSBjYXNlcyB3aGVyZSB2YWx1ZSBpcyBudWxsL3VuZGVmIG9yIG51bWJlcgoJCQkJCXJldCA9PSBudWxsID8gIiIgOiByZXQ7CgkJCX0KCgkJCXJldHVybjsKCQl9CgoJCWlzRnVuY3Rpb24gPSBqUXVlcnkuaXNGdW5jdGlvbiggdmFsdWUgKTsKCgkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGkgKSB7CgkJCXZhciB2YWw7CgoJCQlpZiAoIHRoaXMubm9kZVR5cGUgIT09IDEgKSB7CgkJCQlyZXR1cm47CgkJCX0KCgkJCWlmICggaXNGdW5jdGlvbiApIHsKCQkJCXZhbCA9IHZhbHVlLmNhbGwoIHRoaXMsIGksIGpRdWVyeSggdGhpcyApLnZhbCgpICk7CgkJCX0gZWxzZSB7CgkJCQl2YWwgPSB2YWx1ZTsKCQkJfQoKCQkJLy8gVHJlYXQgbnVsbC91bmRlZmluZWQgYXMgIiI7IGNvbnZlcnQgbnVtYmVycyB0byBzdHJpbmcKCQkJaWYgKCB2YWwgPT0gbnVsbCApIHsKCQkJCXZhbCA9ICIiOwoKCQkJfSBlbHNlIGlmICggdHlwZW9mIHZhbCA9PT0gIm51bWJlciIgKSB7CgkJCQl2YWwgKz0gIiI7CgoJCQl9IGVsc2UgaWYgKCBqUXVlcnkuaXNBcnJheSggdmFsICkgKSB7CgkJCQl2YWwgPSBqUXVlcnkubWFwKCB2YWwsIGZ1bmN0aW9uKCB2YWx1ZSApIHsKCQkJCQlyZXR1cm4gdmFsdWUgPT0gbnVsbCA/ICIiIDogdmFsdWUgKyAiIjsKCQkJCX0gKTsKCQkJfQoKCQkJaG9va3MgPSBqUXVlcnkudmFsSG9va3NbIHRoaXMudHlwZSBdIHx8IGpRdWVyeS52YWxIb29rc1sgdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpIF07CgoJCQkvLyBJZiBzZXQgcmV0dXJucyB1bmRlZmluZWQsIGZhbGwgYmFjayB0byBub3JtYWwgc2V0dGluZwoJCQlpZiAoICFob29rcyB8fCAhKCAic2V0IiBpbiBob29rcyApIHx8IGhvb2tzLnNldCggdGhpcywgdmFsLCAidmFsdWUiICkgPT09IHVuZGVmaW5lZCApIHsKCQkJCXRoaXMudmFsdWUgPSB2YWw7CgkJCX0KCQl9ICk7Cgl9Cn0gKTsKCmpRdWVyeS5leHRlbmQoIHsKCXZhbEhvb2tzOiB7CgkJb3B0aW9uOiB7CgkJCWdldDogZnVuY3Rpb24oIGVsZW0gKSB7CgoJCQkJLy8gU3VwcG9ydDogSUU8MTEKCQkJCS8vIG9wdGlvbi52YWx1ZSBub3QgdHJpbW1lZCAoIzE0ODU4KQoJCQkJcmV0dXJuIGpRdWVyeS50cmltKCBlbGVtLnZhbHVlICk7CgkJCX0KCQl9LAoJCXNlbGVjdDogewoJCQlnZXQ6IGZ1bmN0aW9uKCBlbGVtICkgewoJCQkJdmFyIHZhbHVlLCBvcHRpb24sCgkJCQkJb3B0aW9ucyA9IGVsZW0ub3B0aW9ucywKCQkJCQlpbmRleCA9IGVsZW0uc2VsZWN0ZWRJbmRleCwKCQkJCQlvbmUgPSBlbGVtLnR5cGUgPT09ICJzZWxlY3Qtb25lIiB8fCBpbmRleCA8IDAsCgkJCQkJdmFsdWVzID0gb25lID8gbnVsbCA6IFtdLAoJCQkJCW1heCA9IG9uZSA/IGluZGV4ICsgMSA6IG9wdGlvbnMubGVuZ3RoLAoJCQkJCWkgPSBpbmRleCA8IDAgPwoJCQkJCQltYXggOgoJCQkJCQlvbmUgPyBpbmRleCA6IDA7CgoJCQkJLy8gTG9vcCB0aHJvdWdoIGFsbCB0aGUgc2VsZWN0ZWQgb3B0aW9ucwoJCQkJZm9yICggOyBpIDwgbWF4OyBpKysgKSB7CgkJCQkJb3B0aW9uID0gb3B0aW9uc1sgaSBdOwoKCQkJCQkvLyBJRTgtOSBkb2Vzbid0IHVwZGF0ZSBzZWxlY3RlZCBhZnRlciBmb3JtIHJlc2V0ICgjMjU1MSkKCQkJCQlpZiAoICggb3B0aW9uLnNlbGVjdGVkIHx8IGkgPT09IGluZGV4ICkgJiYKCgkJCQkJCQkvLyBEb24ndCByZXR1cm4gb3B0aW9ucyB0aGF0IGFyZSBkaXNhYmxlZCBvciBpbiBhIGRpc2FibGVkIG9wdGdyb3VwCgkJCQkJCQkoIHN1cHBvcnQub3B0RGlzYWJsZWQgPwoJCQkJCQkJCSFvcHRpb24uZGlzYWJsZWQgOiBvcHRpb24uZ2V0QXR0cmlidXRlKCAiZGlzYWJsZWQiICkgPT09IG51bGwgKSAmJgoJCQkJCQkJKCAhb3B0aW9uLnBhcmVudE5vZGUuZGlzYWJsZWQgfHwKCQkJCQkJCQkhalF1ZXJ5Lm5vZGVOYW1lKCBvcHRpb24ucGFyZW50Tm9kZSwgIm9wdGdyb3VwIiApICkgKSB7CgoJCQkJCQkvLyBHZXQgdGhlIHNwZWNpZmljIHZhbHVlIGZvciB0aGUgb3B0aW9uCgkJCQkJCXZhbHVlID0galF1ZXJ5KCBvcHRpb24gKS52YWwoKTsKCgkJCQkJCS8vIFdlIGRvbid0IG5lZWQgYW4gYXJyYXkgZm9yIG9uZSBzZWxlY3RzCgkJCQkJCWlmICggb25lICkgewoJCQkJCQkJcmV0dXJuIHZhbHVlOwoJCQkJCQl9CgoJCQkJCQkvLyBNdWx0aS1TZWxlY3RzIHJldHVybiBhbiBhcnJheQoJCQkJCQl2YWx1ZXMucHVzaCggdmFsdWUgKTsKCQkJCQl9CgkJCQl9CgoJCQkJcmV0dXJuIHZhbHVlczsKCQkJfSwKCgkJCXNldDogZnVuY3Rpb24oIGVsZW0sIHZhbHVlICkgewoJCQkJdmFyIG9wdGlvblNldCwgb3B0aW9uLAoJCQkJCW9wdGlvbnMgPSBlbGVtLm9wdGlvbnMsCgkJCQkJdmFsdWVzID0galF1ZXJ5Lm1ha2VBcnJheSggdmFsdWUgKSwKCQkJCQlpID0gb3B0aW9ucy5sZW5ndGg7CgoJCQkJd2hpbGUgKCBpLS0gKSB7CgkJCQkJb3B0aW9uID0gb3B0aW9uc1sgaSBdOwoJCQkJCWlmICggb3B0aW9uLnNlbGVjdGVkID0KCQkJCQkJCWpRdWVyeS5pbkFycmF5KCBqUXVlcnkudmFsSG9va3Mub3B0aW9uLmdldCggb3B0aW9uICksIHZhbHVlcyApID4gLTEKCQkJCQkpIHsKCQkJCQkJb3B0aW9uU2V0ID0gdHJ1ZTsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gRm9yY2UgYnJvd3NlcnMgdG8gYmVoYXZlIGNvbnNpc3RlbnRseSB3aGVuIG5vbi1tYXRjaGluZyB2YWx1ZSBpcyBzZXQKCQkJCWlmICggIW9wdGlvblNldCApIHsKCQkJCQllbGVtLnNlbGVjdGVkSW5kZXggPSAtMTsKCQkJCX0KCQkJCXJldHVybiB2YWx1ZXM7CgkJCX0KCQl9Cgl9Cn0gKTsKCi8vIFJhZGlvcyBhbmQgY2hlY2tib3hlcyBnZXR0ZXIvc2V0dGVyCmpRdWVyeS5lYWNoKCBbICJyYWRpbyIsICJjaGVja2JveCIgXSwgZnVuY3Rpb24oKSB7CglqUXVlcnkudmFsSG9va3NbIHRoaXMgXSA9IHsKCQlzZXQ6IGZ1bmN0aW9uKCBlbGVtLCB2YWx1ZSApIHsKCQkJaWYgKCBqUXVlcnkuaXNBcnJheSggdmFsdWUgKSApIHsKCQkJCXJldHVybiAoIGVsZW0uY2hlY2tlZCA9IGpRdWVyeS5pbkFycmF5KCBqUXVlcnkoIGVsZW0gKS52YWwoKSwgdmFsdWUgKSA+IC0xICk7CgkJCX0KCQl9Cgl9OwoJaWYgKCAhc3VwcG9ydC5jaGVja09uICkgewoJCWpRdWVyeS52YWxIb29rc1sgdGhpcyBdLmdldCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJCQlyZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoICJ2YWx1ZSIgKSA9PT0gbnVsbCA/ICJvbiIgOiBlbGVtLnZhbHVlOwoJCX07Cgl9Cn0gKTsKCgoKCi8vIFJldHVybiBqUXVlcnkgZm9yIGF0dHJpYnV0ZXMtb25seSBpbmNsdXNpb24KCgp2YXIgcmZvY3VzTW9ycGggPSAvXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC87CgpqUXVlcnkuZXh0ZW5kKCBqUXVlcnkuZXZlbnQsIHsKCgl0cmlnZ2VyOiBmdW5jdGlvbiggZXZlbnQsIGRhdGEsIGVsZW0sIG9ubHlIYW5kbGVycyApIHsKCgkJdmFyIGksIGN1ciwgdG1wLCBidWJibGVUeXBlLCBvbnR5cGUsIGhhbmRsZSwgc3BlY2lhbCwKCQkJZXZlbnRQYXRoID0gWyBlbGVtIHx8IGRvY3VtZW50IF0sCgkJCXR5cGUgPSBoYXNPd24uY2FsbCggZXZlbnQsICJ0eXBlIiApID8gZXZlbnQudHlwZSA6IGV2ZW50LAoJCQluYW1lc3BhY2VzID0gaGFzT3duLmNhbGwoIGV2ZW50LCAibmFtZXNwYWNlIiApID8gZXZlbnQubmFtZXNwYWNlLnNwbGl0KCAiLiIgKSA6IFtdOwoKCQljdXIgPSB0bXAgPSBlbGVtID0gZWxlbSB8fCBkb2N1bWVudDsKCgkJLy8gRG9uJ3QgZG8gZXZlbnRzIG9uIHRleHQgYW5kIGNvbW1lbnQgbm9kZXMKCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDMgfHwgZWxlbS5ub2RlVHlwZSA9PT0gOCApIHsKCQkJcmV0dXJuOwoJCX0KCgkJLy8gZm9jdXMvYmx1ciBtb3JwaHMgdG8gZm9jdXNpbi9vdXQ7IGVuc3VyZSB3ZSdyZSBub3QgZmlyaW5nIHRoZW0gcmlnaHQgbm93CgkJaWYgKCByZm9jdXNNb3JwaC50ZXN0KCB0eXBlICsgalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCApICkgewoJCQlyZXR1cm47CgkJfQoKCQlpZiAoIHR5cGUuaW5kZXhPZiggIi4iICkgPiAtMSApIHsKCgkJCS8vIE5hbWVzcGFjZWQgdHJpZ2dlcjsgY3JlYXRlIGEgcmVnZXhwIHRvIG1hdGNoIGV2ZW50IHR5cGUgaW4gaGFuZGxlKCkKCQkJbmFtZXNwYWNlcyA9IHR5cGUuc3BsaXQoICIuIiApOwoJCQl0eXBlID0gbmFtZXNwYWNlcy5zaGlmdCgpOwoJCQluYW1lc3BhY2VzLnNvcnQoKTsKCQl9CgkJb250eXBlID0gdHlwZS5pbmRleE9mKCAiOiIgKSA8IDAgJiYgIm9uIiArIHR5cGU7CgoJCS8vIENhbGxlciBjYW4gcGFzcyBpbiBhIGpRdWVyeS5FdmVudCBvYmplY3QsIE9iamVjdCwgb3IganVzdCBhbiBldmVudCB0eXBlIHN0cmluZwoJCWV2ZW50ID0gZXZlbnRbIGpRdWVyeS5leHBhbmRvIF0gPwoJCQlldmVudCA6CgkJCW5ldyBqUXVlcnkuRXZlbnQoIHR5cGUsIHR5cGVvZiBldmVudCA9PT0gIm9iamVjdCIgJiYgZXZlbnQgKTsKCgkJLy8gVHJpZ2dlciBiaXRtYXNrOiAmIDEgZm9yIG5hdGl2ZSBoYW5kbGVyczsgJiAyIGZvciBqUXVlcnkgKGFsd2F5cyB0cnVlKQoJCWV2ZW50LmlzVHJpZ2dlciA9IG9ubHlIYW5kbGVycyA/IDIgOiAzOwoJCWV2ZW50Lm5hbWVzcGFjZSA9IG5hbWVzcGFjZXMuam9pbiggIi4iICk7CgkJZXZlbnQucm5hbWVzcGFjZSA9IGV2ZW50Lm5hbWVzcGFjZSA/CgkJCW5ldyBSZWdFeHAoICIoXnxcXC4pIiArIG5hbWVzcGFjZXMuam9pbiggIlxcLig/Oi4qXFwufCkiICkgKyAiKFxcLnwkKSIgKSA6CgkJCW51bGw7CgoJCS8vIENsZWFuIHVwIHRoZSBldmVudCBpbiBjYXNlIGl0IGlzIGJlaW5nIHJldXNlZAoJCWV2ZW50LnJlc3VsdCA9IHVuZGVmaW5lZDsKCQlpZiAoICFldmVudC50YXJnZXQgKSB7CgkJCWV2ZW50LnRhcmdldCA9IGVsZW07CgkJfQoKCQkvLyBDbG9uZSBhbnkgaW5jb21pbmcgZGF0YSBhbmQgcHJlcGVuZCB0aGUgZXZlbnQsIGNyZWF0aW5nIHRoZSBoYW5kbGVyIGFyZyBsaXN0CgkJZGF0YSA9IGRhdGEgPT0gbnVsbCA/CgkJCVsgZXZlbnQgXSA6CgkJCWpRdWVyeS5tYWtlQXJyYXkoIGRhdGEsIFsgZXZlbnQgXSApOwoKCQkvLyBBbGxvdyBzcGVjaWFsIGV2ZW50cyB0byBkcmF3IG91dHNpZGUgdGhlIGxpbmVzCgkJc3BlY2lhbCA9IGpRdWVyeS5ldmVudC5zcGVjaWFsWyB0eXBlIF0gfHwge307CgkJaWYgKCAhb25seUhhbmRsZXJzICYmIHNwZWNpYWwudHJpZ2dlciAmJiBzcGVjaWFsLnRyaWdnZXIuYXBwbHkoIGVsZW0sIGRhdGEgKSA9PT0gZmFsc2UgKSB7CgkJCXJldHVybjsKCQl9CgoJCS8vIERldGVybWluZSBldmVudCBwcm9wYWdhdGlvbiBwYXRoIGluIGFkdmFuY2UsIHBlciBXM0MgZXZlbnRzIHNwZWMgKCM5OTUxKQoJCS8vIEJ1YmJsZSB1cCB0byBkb2N1bWVudCwgdGhlbiB0byB3aW5kb3c7IHdhdGNoIGZvciBhIGdsb2JhbCBvd25lckRvY3VtZW50IHZhciAoIzk3MjQpCgkJaWYgKCAhb25seUhhbmRsZXJzICYmICFzcGVjaWFsLm5vQnViYmxlICYmICFqUXVlcnkuaXNXaW5kb3coIGVsZW0gKSApIHsKCgkJCWJ1YmJsZVR5cGUgPSBzcGVjaWFsLmRlbGVnYXRlVHlwZSB8fCB0eXBlOwoJCQlpZiAoICFyZm9jdXNNb3JwaC50ZXN0KCBidWJibGVUeXBlICsgdHlwZSApICkgewoJCQkJY3VyID0gY3VyLnBhcmVudE5vZGU7CgkJCX0KCQkJZm9yICggOyBjdXI7IGN1ciA9IGN1ci5wYXJlbnROb2RlICkgewoJCQkJZXZlbnRQYXRoLnB1c2goIGN1ciApOwoJCQkJdG1wID0gY3VyOwoJCQl9CgoJCQkvLyBPbmx5IGFkZCB3aW5kb3cgaWYgd2UgZ290IHRvIGRvY3VtZW50IChlLmcuLCBub3QgcGxhaW4gb2JqIG9yIGRldGFjaGVkIERPTSkKCQkJaWYgKCB0bXAgPT09ICggZWxlbS5vd25lckRvY3VtZW50IHx8IGRvY3VtZW50ICkgKSB7CgkJCQlldmVudFBhdGgucHVzaCggdG1wLmRlZmF1bHRWaWV3IHx8IHRtcC5wYXJlbnRXaW5kb3cgfHwgd2luZG93ICk7CgkJCX0KCQl9CgoJCS8vIEZpcmUgaGFuZGxlcnMgb24gdGhlIGV2ZW50IHBhdGgKCQlpID0gMDsKCQl3aGlsZSAoICggY3VyID0gZXZlbnRQYXRoWyBpKysgXSApICYmICFldmVudC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpICkgewoKCQkJZXZlbnQudHlwZSA9IGkgPiAxID8KCQkJCWJ1YmJsZVR5cGUgOgoJCQkJc3BlY2lhbC5iaW5kVHlwZSB8fCB0eXBlOwoKCQkJLy8galF1ZXJ5IGhhbmRsZXIKCQkJaGFuZGxlID0gKCBkYXRhUHJpdi5nZXQoIGN1ciwgImV2ZW50cyIgKSB8fCB7fSApWyBldmVudC50eXBlIF0gJiYKCQkJCWRhdGFQcml2LmdldCggY3VyLCAiaGFuZGxlIiApOwoJCQlpZiAoIGhhbmRsZSApIHsKCQkJCWhhbmRsZS5hcHBseSggY3VyLCBkYXRhICk7CgkJCX0KCgkJCS8vIE5hdGl2ZSBoYW5kbGVyCgkJCWhhbmRsZSA9IG9udHlwZSAmJiBjdXJbIG9udHlwZSBdOwoJCQlpZiAoIGhhbmRsZSAmJiBoYW5kbGUuYXBwbHkgJiYgYWNjZXB0RGF0YSggY3VyICkgKSB7CgkJCQlldmVudC5yZXN1bHQgPSBoYW5kbGUuYXBwbHkoIGN1ciwgZGF0YSApOwoJCQkJaWYgKCBldmVudC5yZXN1bHQgPT09IGZhbHNlICkgewoJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQl9CgkJCX0KCQl9CgkJZXZlbnQudHlwZSA9IHR5cGU7CgoJCS8vIElmIG5vYm9keSBwcmV2ZW50ZWQgdGhlIGRlZmF1bHQgYWN0aW9uLCBkbyBpdCBub3cKCQlpZiAoICFvbmx5SGFuZGxlcnMgJiYgIWV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpICkgewoKCQkJaWYgKCAoICFzcGVjaWFsLl9kZWZhdWx0IHx8CgkJCQlzcGVjaWFsLl9kZWZhdWx0LmFwcGx5KCBldmVudFBhdGgucG9wKCksIGRhdGEgKSA9PT0gZmFsc2UgKSAmJgoJCQkJYWNjZXB0RGF0YSggZWxlbSApICkgewoKCQkJCS8vIENhbGwgYSBuYXRpdmUgRE9NIG1ldGhvZCBvbiB0aGUgdGFyZ2V0IHdpdGggdGhlIHNhbWUgbmFtZSBuYW1lIGFzIHRoZSBldmVudC4KCQkJCS8vIERvbid0IGRvIGRlZmF1bHQgYWN0aW9ucyBvbiB3aW5kb3csIHRoYXQncyB3aGVyZSBnbG9iYWwgdmFyaWFibGVzIGJlICgjNjE3MCkKCQkJCWlmICggb250eXBlICYmIGpRdWVyeS5pc0Z1bmN0aW9uKCBlbGVtWyB0eXBlIF0gKSAmJiAhalF1ZXJ5LmlzV2luZG93KCBlbGVtICkgKSB7CgoJCQkJCS8vIERvbid0IHJlLXRyaWdnZXIgYW4gb25GT08gZXZlbnQgd2hlbiB3ZSBjYWxsIGl0cyBGT08oKSBtZXRob2QKCQkJCQl0bXAgPSBlbGVtWyBvbnR5cGUgXTsKCgkJCQkJaWYgKCB0bXAgKSB7CgkJCQkJCWVsZW1bIG9udHlwZSBdID0gbnVsbDsKCQkJCQl9CgoJCQkJCS8vIFByZXZlbnQgcmUtdHJpZ2dlcmluZyBvZiB0aGUgc2FtZSBldmVudCwgc2luY2Ugd2UgYWxyZWFkeSBidWJibGVkIGl0IGFib3ZlCgkJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHR5cGU7CgkJCQkJZWxlbVsgdHlwZSBdKCk7CgkJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXJlZCA9IHVuZGVmaW5lZDsKCgkJCQkJaWYgKCB0bXAgKSB7CgkJCQkJCWVsZW1bIG9udHlwZSBdID0gdG1wOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIGV2ZW50LnJlc3VsdDsKCX0sCgoJLy8gUGlnZ3liYWNrIG9uIGEgZG9ub3IgZXZlbnQgdG8gc2ltdWxhdGUgYSBkaWZmZXJlbnQgb25lCglzaW11bGF0ZTogZnVuY3Rpb24oIHR5cGUsIGVsZW0sIGV2ZW50ICkgewoJCXZhciBlID0galF1ZXJ5LmV4dGVuZCgKCQkJbmV3IGpRdWVyeS5FdmVudCgpLAoJCQlldmVudCwKCQkJewoJCQkJdHlwZTogdHlwZSwKCQkJCWlzU2ltdWxhdGVkOiB0cnVlCgoJCQkJLy8gUHJldmlvdXNseSwgYG9yaWdpbmFsRXZlbnQ6IHt9YCB3YXMgc2V0IGhlcmUsIHNvIHN0b3BQcm9wYWdhdGlvbiBjYWxsCgkJCQkvLyB3b3VsZCBub3QgYmUgdHJpZ2dlcmVkIG9uIGRvbm9yIGV2ZW50LCBzaW5jZSBpbiBvdXIgb3duCgkJCQkvLyBqUXVlcnkuZXZlbnQuc3RvcFByb3BhZ2F0aW9uIGZ1bmN0aW9uIHdlIGhhZCBhIGNoZWNrIGZvciBleGlzdGVuY2Ugb2YKCQkJCS8vIG9yaWdpbmFsRXZlbnQuc3RvcFByb3BhZ2F0aW9uIG1ldGhvZCwgc28sIGNvbnNlcXVlbnRseSBpdCB3b3VsZCBiZSBhIG5vb3AuCgkJCQkvLwoJCQkJLy8gQnV0IG5vdywgdGhpcyAic2ltdWxhdGUiIGZ1bmN0aW9uIGlzIHVzZWQgb25seSBmb3IgZXZlbnRzCgkJCQkvLyBmb3Igd2hpY2ggc3RvcFByb3BhZ2F0aW9uKCkgaXMgbm9vcCwgc28gdGhlcmUgaXMgbm8gbmVlZCBmb3IgdGhhdCBhbnltb3JlLgoJCQkJLy8KCQkJCS8vIEZvciB0aGUgMS54IGJyYW5jaCB0aG91Z2gsIGd1YXJkIGZvciAiY2xpY2siIGFuZCAic3VibWl0IgoJCQkJLy8gZXZlbnRzIGlzIHN0aWxsIHVzZWQsIGJ1dCB3YXMgbW92ZWQgdG8galF1ZXJ5LmV2ZW50LnN0b3BQcm9wYWdhdGlvbiBmdW5jdGlvbgoJCQkJLy8gYmVjYXVzZSBgb3JpZ2luYWxFdmVudGAgc2hvdWxkIHBvaW50IHRvIHRoZSBvcmlnaW5hbCBldmVudCBmb3IgdGhlIGNvbnN0YW5jeQoJCQkJLy8gd2l0aCBvdGhlciBldmVudHMgYW5kIGZvciBtb3JlIGZvY3VzZWQgbG9naWMKCQkJfQoJCSk7CgoJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCBlLCBudWxsLCBlbGVtICk7CgoJCWlmICggZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSApIHsKCQkJZXZlbnQucHJldmVudERlZmF1bHQoKTsKCQl9Cgl9Cgp9ICk7CgpqUXVlcnkuZm4uZXh0ZW5kKCB7CgoJdHJpZ2dlcjogZnVuY3Rpb24oIHR5cGUsIGRhdGEgKSB7CgkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oKSB7CgkJCWpRdWVyeS5ldmVudC50cmlnZ2VyKCB0eXBlLCBkYXRhLCB0aGlzICk7CgkJfSApOwoJfSwKCXRyaWdnZXJIYW5kbGVyOiBmdW5jdGlvbiggdHlwZSwgZGF0YSApIHsKCQl2YXIgZWxlbSA9IHRoaXNbIDAgXTsKCQlpZiAoIGVsZW0gKSB7CgkJCXJldHVybiBqUXVlcnkuZXZlbnQudHJpZ2dlciggdHlwZSwgZGF0YSwgZWxlbSwgdHJ1ZSApOwoJCX0KCX0KfSApOwoKCmpRdWVyeS5lYWNoKCAoICJibHVyIGZvY3VzIGZvY3VzaW4gZm9jdXNvdXQgbG9hZCByZXNpemUgc2Nyb2xsIHVubG9hZCBjbGljayBkYmxjbGljayAiICsKCSJtb3VzZWRvd24gbW91c2V1cCBtb3VzZW1vdmUgbW91c2VvdmVyIG1vdXNlb3V0IG1vdXNlZW50ZXIgbW91c2VsZWF2ZSAiICsKCSJjaGFuZ2Ugc2VsZWN0IHN1Ym1pdCBrZXlkb3duIGtleXByZXNzIGtleXVwIGVycm9yIGNvbnRleHRtZW51IiApLnNwbGl0KCAiICIgKSwKCWZ1bmN0aW9uKCBpLCBuYW1lICkgewoKCS8vIEhhbmRsZSBldmVudCBiaW5kaW5nCglqUXVlcnkuZm5bIG5hbWUgXSA9IGZ1bmN0aW9uKCBkYXRhLCBmbiApIHsKCQlyZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDAgPwoJCQl0aGlzLm9uKCBuYW1lLCBudWxsLCBkYXRhLCBmbiApIDoKCQkJdGhpcy50cmlnZ2VyKCBuYW1lICk7Cgl9Owp9ICk7CgpqUXVlcnkuZm4uZXh0ZW5kKCB7Cglob3ZlcjogZnVuY3Rpb24oIGZuT3ZlciwgZm5PdXQgKSB7CgkJcmV0dXJuIHRoaXMubW91c2VlbnRlciggZm5PdmVyICkubW91c2VsZWF2ZSggZm5PdXQgfHwgZm5PdmVyICk7Cgl9Cn0gKTsKCgoKCnN1cHBvcnQuZm9jdXNpbiA9ICJvbmZvY3VzaW4iIGluIHdpbmRvdzsKCgovLyBTdXBwb3J0OiBGaXJlZm94Ci8vIEZpcmVmb3ggZG9lc24ndCBoYXZlIGZvY3VzKGluIHwgb3V0KSBldmVudHMKLy8gUmVsYXRlZCB0aWNrZXQgLSBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD02ODc3ODcKLy8KLy8gU3VwcG9ydDogQ2hyb21lLCBTYWZhcmkKLy8gZm9jdXMoaW4gfCBvdXQpIGV2ZW50cyBmaXJlIGFmdGVyIGZvY3VzICYgYmx1ciBldmVudHMsCi8vIHdoaWNoIGlzIHNwZWMgdmlvbGF0aW9uIC0gaHR0cDovL3d3dy53My5vcmcvVFIvRE9NLUxldmVsLTMtRXZlbnRzLyNldmVudHMtZm9jdXNldmVudC1ldmVudC1vcmRlcgovLyBSZWxhdGVkIHRpY2tldCAtIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD00NDk4NTcKaWYgKCAhc3VwcG9ydC5mb2N1c2luICkgewoJalF1ZXJ5LmVhY2goIHsgZm9jdXM6ICJmb2N1c2luIiwgYmx1cjogImZvY3Vzb3V0IiB9LCBmdW5jdGlvbiggb3JpZywgZml4ICkgewoKCQkvLyBBdHRhY2ggYSBzaW5nbGUgY2FwdHVyaW5nIGhhbmRsZXIgb24gdGhlIGRvY3VtZW50IHdoaWxlIHNvbWVvbmUgd2FudHMgZm9jdXNpbi9mb2N1c291dAoJCXZhciBoYW5kbGVyID0gZnVuY3Rpb24oIGV2ZW50ICkgewoJCQlqUXVlcnkuZXZlbnQuc2ltdWxhdGUoIGZpeCwgZXZlbnQudGFyZ2V0LCBqUXVlcnkuZXZlbnQuZml4KCBldmVudCApICk7CgkJfTsKCgkJalF1ZXJ5LmV2ZW50LnNwZWNpYWxbIGZpeCBdID0gewoJCQlzZXR1cDogZnVuY3Rpb24oKSB7CgkJCQl2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsCgkJCQkJYXR0YWNoZXMgPSBkYXRhUHJpdi5hY2Nlc3MoIGRvYywgZml4ICk7CgoJCQkJaWYgKCAhYXR0YWNoZXMgKSB7CgkJCQkJZG9jLmFkZEV2ZW50TGlzdGVuZXIoIG9yaWcsIGhhbmRsZXIsIHRydWUgKTsKCQkJCX0KCQkJCWRhdGFQcml2LmFjY2VzcyggZG9jLCBmaXgsICggYXR0YWNoZXMgfHwgMCApICsgMSApOwoJCQl9LAoJCQl0ZWFyZG93bjogZnVuY3Rpb24oKSB7CgkJCQl2YXIgZG9jID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsCgkJCQkJYXR0YWNoZXMgPSBkYXRhUHJpdi5hY2Nlc3MoIGRvYywgZml4ICkgLSAxOwoKCQkJCWlmICggIWF0dGFjaGVzICkgewoJCQkJCWRvYy5yZW1vdmVFdmVudExpc3RlbmVyKCBvcmlnLCBoYW5kbGVyLCB0cnVlICk7CgkJCQkJZGF0YVByaXYucmVtb3ZlKCBkb2MsIGZpeCApOwoKCQkJCX0gZWxzZSB7CgkJCQkJZGF0YVByaXYuYWNjZXNzKCBkb2MsIGZpeCwgYXR0YWNoZXMgKTsKCQkJCX0KCQkJfQoJCX07Cgl9ICk7Cn0KdmFyIGxvY2F0aW9uID0gd2luZG93LmxvY2F0aW9uOwoKdmFyIG5vbmNlID0galF1ZXJ5Lm5vdygpOwoKdmFyIHJxdWVyeSA9ICggL1w/LyApOwoKCgovLyBTdXBwb3J0OiBBbmRyb2lkIDIuMwovLyBXb3JrYXJvdW5kIGZhaWx1cmUgdG8gc3RyaW5nLWNhc3QgbnVsbCBpbnB1dApqUXVlcnkucGFyc2VKU09OID0gZnVuY3Rpb24oIGRhdGEgKSB7CglyZXR1cm4gSlNPTi5wYXJzZSggZGF0YSArICIiICk7Cn07CgoKLy8gQ3Jvc3MtYnJvd3NlciB4bWwgcGFyc2luZwpqUXVlcnkucGFyc2VYTUwgPSBmdW5jdGlvbiggZGF0YSApIHsKCXZhciB4bWw7CglpZiAoICFkYXRhIHx8IHR5cGVvZiBkYXRhICE9PSAic3RyaW5nIiApIHsKCQlyZXR1cm4gbnVsbDsKCX0KCgkvLyBTdXBwb3J0OiBJRTkKCXRyeSB7CgkJeG1sID0gKCBuZXcgd2luZG93LkRPTVBhcnNlcigpICkucGFyc2VGcm9tU3RyaW5nKCBkYXRhLCAidGV4dC94bWwiICk7Cgl9IGNhdGNoICggZSApIHsKCQl4bWwgPSB1bmRlZmluZWQ7Cgl9CgoJaWYgKCAheG1sIHx8IHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSggInBhcnNlcmVycm9yIiApLmxlbmd0aCApIHsKCQlqUXVlcnkuZXJyb3IoICJJbnZhbGlkIFhNTDogIiArIGRhdGEgKTsKCX0KCXJldHVybiB4bWw7Cn07CgoKdmFyCglyaGFzaCA9IC8jLiokLywKCXJ0cyA9IC8oWz8mXSlfPVteJl0qLywKCXJoZWFkZXJzID0gL14oLio/KTpbIFx0XSooW15cclxuXSopJC9tZywKCgkvLyAjNzY1MywgIzgxMjUsICM4MTUyOiBsb2NhbCBwcm90b2NvbCBkZXRlY3Rpb24KCXJsb2NhbFByb3RvY29sID0gL14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8sCglybm9Db250ZW50ID0gL14oPzpHRVR8SEVBRCkkLywKCXJwcm90b2NvbCA9IC9eXC9cLy8sCgoJLyogUHJlZmlsdGVycwoJICogMSkgVGhleSBhcmUgdXNlZnVsIHRvIGludHJvZHVjZSBjdXN0b20gZGF0YVR5cGVzIChzZWUgYWpheC9qc29ucC5qcyBmb3IgYW4gZXhhbXBsZSkKCSAqIDIpIFRoZXNlIGFyZSBjYWxsZWQ6CgkgKiAgICAtIEJFRk9SRSBhc2tpbmcgZm9yIGEgdHJhbnNwb3J0CgkgKiAgICAtIEFGVEVSIHBhcmFtIHNlcmlhbGl6YXRpb24gKHMuZGF0YSBpcyBhIHN0cmluZyBpZiBzLnByb2Nlc3NEYXRhIGlzIHRydWUpCgkgKiAzKSBrZXkgaXMgdGhlIGRhdGFUeXBlCgkgKiA0KSB0aGUgY2F0Y2hhbGwgc3ltYm9sICIqIiBjYW4gYmUgdXNlZAoJICogNSkgZXhlY3V0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gY29udGludWUgZG93biB0byAiKiIgaWYgbmVlZGVkCgkgKi8KCXByZWZpbHRlcnMgPSB7fSwKCgkvKiBUcmFuc3BvcnRzIGJpbmRpbmdzCgkgKiAxKSBrZXkgaXMgdGhlIGRhdGFUeXBlCgkgKiAyKSB0aGUgY2F0Y2hhbGwgc3ltYm9sICIqIiBjYW4gYmUgdXNlZAoJICogMykgc2VsZWN0aW9uIHdpbGwgc3RhcnQgd2l0aCB0cmFuc3BvcnQgZGF0YVR5cGUgYW5kIFRIRU4gZ28gdG8gIioiIGlmIG5lZWRlZAoJICovCgl0cmFuc3BvcnRzID0ge30sCgoJLy8gQXZvaWQgY29tbWVudC1wcm9sb2cgY2hhciBzZXF1ZW5jZSAoIzEwMDk4KTsgbXVzdCBhcHBlYXNlIGxpbnQgYW5kIGV2YWRlIGNvbXByZXNzaW9uCglhbGxUeXBlcyA9ICIqLyIuY29uY2F0KCAiKiIgKSwKCgkvLyBBbmNob3IgdGFnIGZvciBwYXJzaW5nIHRoZSBkb2N1bWVudCBvcmlnaW4KCW9yaWdpbkFuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJhIiApOwoJb3JpZ2luQW5jaG9yLmhyZWYgPSBsb2NhdGlvbi5ocmVmOwoKLy8gQmFzZSAiY29uc3RydWN0b3IiIGZvciBqUXVlcnkuYWpheFByZWZpbHRlciBhbmQgalF1ZXJ5LmFqYXhUcmFuc3BvcnQKZnVuY3Rpb24gYWRkVG9QcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCBzdHJ1Y3R1cmUgKSB7CgoJLy8gZGF0YVR5cGVFeHByZXNzaW9uIGlzIG9wdGlvbmFsIGFuZCBkZWZhdWx0cyB0byAiKiIKCXJldHVybiBmdW5jdGlvbiggZGF0YVR5cGVFeHByZXNzaW9uLCBmdW5jICkgewoKCQlpZiAoIHR5cGVvZiBkYXRhVHlwZUV4cHJlc3Npb24gIT09ICJzdHJpbmciICkgewoJCQlmdW5jID0gZGF0YVR5cGVFeHByZXNzaW9uOwoJCQlkYXRhVHlwZUV4cHJlc3Npb24gPSAiKiI7CgkJfQoKCQl2YXIgZGF0YVR5cGUsCgkJCWkgPSAwLAoJCQlkYXRhVHlwZXMgPSBkYXRhVHlwZUV4cHJlc3Npb24udG9Mb3dlckNhc2UoKS5tYXRjaCggcm5vdHdoaXRlICkgfHwgW107CgoJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGZ1bmMgKSApIHsKCgkJCS8vIEZvciBlYWNoIGRhdGFUeXBlIGluIHRoZSBkYXRhVHlwZUV4cHJlc3Npb24KCQkJd2hpbGUgKCAoIGRhdGFUeXBlID0gZGF0YVR5cGVzWyBpKysgXSApICkgewoKCQkJCS8vIFByZXBlbmQgaWYgcmVxdWVzdGVkCgkJCQlpZiAoIGRhdGFUeXBlWyAwIF0gPT09ICIrIiApIHsKCQkJCQlkYXRhVHlwZSA9IGRhdGFUeXBlLnNsaWNlKCAxICkgfHwgIioiOwoJCQkJCSggc3RydWN0dXJlWyBkYXRhVHlwZSBdID0gc3RydWN0dXJlWyBkYXRhVHlwZSBdIHx8IFtdICkudW5zaGlmdCggZnVuYyApOwoKCQkJCS8vIE90aGVyd2lzZSBhcHBlbmQKCQkJCX0gZWxzZSB7CgkJCQkJKCBzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gPSBzdHJ1Y3R1cmVbIGRhdGFUeXBlIF0gfHwgW10gKS5wdXNoKCBmdW5jICk7CgkJCQl9CgkJCX0KCQl9Cgl9Owp9CgovLyBCYXNlIGluc3BlY3Rpb24gZnVuY3Rpb24gZm9yIHByZWZpbHRlcnMgYW5kIHRyYW5zcG9ydHMKZnVuY3Rpb24gaW5zcGVjdFByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHN0cnVjdHVyZSwgb3B0aW9ucywgb3JpZ2luYWxPcHRpb25zLCBqcVhIUiApIHsKCgl2YXIgaW5zcGVjdGVkID0ge30sCgkJc2Vla2luZ1RyYW5zcG9ydCA9ICggc3RydWN0dXJlID09PSB0cmFuc3BvcnRzICk7CgoJZnVuY3Rpb24gaW5zcGVjdCggZGF0YVR5cGUgKSB7CgkJdmFyIHNlbGVjdGVkOwoJCWluc3BlY3RlZFsgZGF0YVR5cGUgXSA9IHRydWU7CgkJalF1ZXJ5LmVhY2goIHN0cnVjdHVyZVsgZGF0YVR5cGUgXSB8fCBbXSwgZnVuY3Rpb24oIF8sIHByZWZpbHRlck9yRmFjdG9yeSApIHsKCQkJdmFyIGRhdGFUeXBlT3JUcmFuc3BvcnQgPSBwcmVmaWx0ZXJPckZhY3RvcnkoIG9wdGlvbnMsIG9yaWdpbmFsT3B0aW9ucywganFYSFIgKTsKCQkJaWYgKCB0eXBlb2YgZGF0YVR5cGVPclRyYW5zcG9ydCA9PT0gInN0cmluZyIgJiYKCQkJCSFzZWVraW5nVHJhbnNwb3J0ICYmICFpbnNwZWN0ZWRbIGRhdGFUeXBlT3JUcmFuc3BvcnQgXSApIHsKCgkJCQlvcHRpb25zLmRhdGFUeXBlcy51bnNoaWZ0KCBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7CgkJCQlpbnNwZWN0KCBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0gZWxzZSBpZiAoIHNlZWtpbmdUcmFuc3BvcnQgKSB7CgkJCQlyZXR1cm4gISggc2VsZWN0ZWQgPSBkYXRhVHlwZU9yVHJhbnNwb3J0ICk7CgkJCX0KCQl9ICk7CgkJcmV0dXJuIHNlbGVjdGVkOwoJfQoKCXJldHVybiBpbnNwZWN0KCBvcHRpb25zLmRhdGFUeXBlc1sgMCBdICkgfHwgIWluc3BlY3RlZFsgIioiIF0gJiYgaW5zcGVjdCggIioiICk7Cn0KCi8vIEEgc3BlY2lhbCBleHRlbmQgZm9yIGFqYXggb3B0aW9ucwovLyB0aGF0IHRha2VzICJmbGF0IiBvcHRpb25zIChub3QgdG8gYmUgZGVlcCBleHRlbmRlZCkKLy8gRml4ZXMgIzk4ODcKZnVuY3Rpb24gYWpheEV4dGVuZCggdGFyZ2V0LCBzcmMgKSB7Cgl2YXIga2V5LCBkZWVwLAoJCWZsYXRPcHRpb25zID0galF1ZXJ5LmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9ucyB8fCB7fTsKCglmb3IgKCBrZXkgaW4gc3JjICkgewoJCWlmICggc3JjWyBrZXkgXSAhPT0gdW5kZWZpbmVkICkgewoJCQkoIGZsYXRPcHRpb25zWyBrZXkgXSA/IHRhcmdldCA6ICggZGVlcCB8fCAoIGRlZXAgPSB7fSApICkgKVsga2V5IF0gPSBzcmNbIGtleSBdOwoJCX0KCX0KCWlmICggZGVlcCApIHsKCQlqUXVlcnkuZXh0ZW5kKCB0cnVlLCB0YXJnZXQsIGRlZXAgKTsKCX0KCglyZXR1cm4gdGFyZ2V0Owp9CgovKiBIYW5kbGVzIHJlc3BvbnNlcyB0byBhbiBhamF4IHJlcXVlc3Q6CiAqIC0gZmluZHMgdGhlIHJpZ2h0IGRhdGFUeXBlIChtZWRpYXRlcyBiZXR3ZWVuIGNvbnRlbnQtdHlwZSBhbmQgZXhwZWN0ZWQgZGF0YVR5cGUpCiAqIC0gcmV0dXJucyB0aGUgY29ycmVzcG9uZGluZyByZXNwb25zZQogKi8KZnVuY3Rpb24gYWpheEhhbmRsZVJlc3BvbnNlcyggcywganFYSFIsIHJlc3BvbnNlcyApIHsKCgl2YXIgY3QsIHR5cGUsIGZpbmFsRGF0YVR5cGUsIGZpcnN0RGF0YVR5cGUsCgkJY29udGVudHMgPSBzLmNvbnRlbnRzLAoJCWRhdGFUeXBlcyA9IHMuZGF0YVR5cGVzOwoKCS8vIFJlbW92ZSBhdXRvIGRhdGFUeXBlIGFuZCBnZXQgY29udGVudC10eXBlIGluIHRoZSBwcm9jZXNzCgl3aGlsZSAoIGRhdGFUeXBlc1sgMCBdID09PSAiKiIgKSB7CgkJZGF0YVR5cGVzLnNoaWZ0KCk7CgkJaWYgKCBjdCA9PT0gdW5kZWZpbmVkICkgewoJCQljdCA9IHMubWltZVR5cGUgfHwganFYSFIuZ2V0UmVzcG9uc2VIZWFkZXIoICJDb250ZW50LVR5cGUiICk7CgkJfQoJfQoKCS8vIENoZWNrIGlmIHdlJ3JlIGRlYWxpbmcgd2l0aCBhIGtub3duIGNvbnRlbnQtdHlwZQoJaWYgKCBjdCApIHsKCQlmb3IgKCB0eXBlIGluIGNvbnRlbnRzICkgewoJCQlpZiAoIGNvbnRlbnRzWyB0eXBlIF0gJiYgY29udGVudHNbIHR5cGUgXS50ZXN0KCBjdCApICkgewoJCQkJZGF0YVR5cGVzLnVuc2hpZnQoIHR5cGUgKTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoJfQoKCS8vIENoZWNrIHRvIHNlZSBpZiB3ZSBoYXZlIGEgcmVzcG9uc2UgZm9yIHRoZSBleHBlY3RlZCBkYXRhVHlwZQoJaWYgKCBkYXRhVHlwZXNbIDAgXSBpbiByZXNwb25zZXMgKSB7CgkJZmluYWxEYXRhVHlwZSA9IGRhdGFUeXBlc1sgMCBdOwoJfSBlbHNlIHsKCgkJLy8gVHJ5IGNvbnZlcnRpYmxlIGRhdGFUeXBlcwoJCWZvciAoIHR5cGUgaW4gcmVzcG9uc2VzICkgewoJCQlpZiAoICFkYXRhVHlwZXNbIDAgXSB8fCBzLmNvbnZlcnRlcnNbIHR5cGUgKyAiICIgKyBkYXRhVHlwZXNbIDAgXSBdICkgewoJCQkJZmluYWxEYXRhVHlwZSA9IHR5cGU7CgkJCQlicmVhazsKCQkJfQoJCQlpZiAoICFmaXJzdERhdGFUeXBlICkgewoJCQkJZmlyc3REYXRhVHlwZSA9IHR5cGU7CgkJCX0KCQl9CgoJCS8vIE9yIGp1c3QgdXNlIGZpcnN0IG9uZQoJCWZpbmFsRGF0YVR5cGUgPSBmaW5hbERhdGFUeXBlIHx8IGZpcnN0RGF0YVR5cGU7Cgl9CgoJLy8gSWYgd2UgZm91bmQgYSBkYXRhVHlwZQoJLy8gV2UgYWRkIHRoZSBkYXRhVHlwZSB0byB0aGUgbGlzdCBpZiBuZWVkZWQKCS8vIGFuZCByZXR1cm4gdGhlIGNvcnJlc3BvbmRpbmcgcmVzcG9uc2UKCWlmICggZmluYWxEYXRhVHlwZSApIHsKCQlpZiAoIGZpbmFsRGF0YVR5cGUgIT09IGRhdGFUeXBlc1sgMCBdICkgewoJCQlkYXRhVHlwZXMudW5zaGlmdCggZmluYWxEYXRhVHlwZSApOwoJCX0KCQlyZXR1cm4gcmVzcG9uc2VzWyBmaW5hbERhdGFUeXBlIF07Cgl9Cn0KCi8qIENoYWluIGNvbnZlcnNpb25zIGdpdmVuIHRoZSByZXF1ZXN0IGFuZCB0aGUgb3JpZ2luYWwgcmVzcG9uc2UKICogQWxzbyBzZXRzIHRoZSByZXNwb25zZVhYWCBmaWVsZHMgb24gdGhlIGpxWEhSIGluc3RhbmNlCiAqLwpmdW5jdGlvbiBhamF4Q29udmVydCggcywgcmVzcG9uc2UsIGpxWEhSLCBpc1N1Y2Nlc3MgKSB7Cgl2YXIgY29udjIsIGN1cnJlbnQsIGNvbnYsIHRtcCwgcHJldiwKCQljb252ZXJ0ZXJzID0ge30sCgoJCS8vIFdvcmsgd2l0aCBhIGNvcHkgb2YgZGF0YVR5cGVzIGluIGNhc2Ugd2UgbmVlZCB0byBtb2RpZnkgaXQgZm9yIGNvbnZlcnNpb24KCQlkYXRhVHlwZXMgPSBzLmRhdGFUeXBlcy5zbGljZSgpOwoKCS8vIENyZWF0ZSBjb252ZXJ0ZXJzIG1hcCB3aXRoIGxvd2VyY2FzZWQga2V5cwoJaWYgKCBkYXRhVHlwZXNbIDEgXSApIHsKCQlmb3IgKCBjb252IGluIHMuY29udmVydGVycyApIHsKCQkJY29udmVydGVyc1sgY29udi50b0xvd2VyQ2FzZSgpIF0gPSBzLmNvbnZlcnRlcnNbIGNvbnYgXTsKCQl9Cgl9CgoJY3VycmVudCA9IGRhdGFUeXBlcy5zaGlmdCgpOwoKCS8vIENvbnZlcnQgdG8gZWFjaCBzZXF1ZW50aWFsIGRhdGFUeXBlCgl3aGlsZSAoIGN1cnJlbnQgKSB7CgoJCWlmICggcy5yZXNwb25zZUZpZWxkc1sgY3VycmVudCBdICkgewoJCQlqcVhIUlsgcy5yZXNwb25zZUZpZWxkc1sgY3VycmVudCBdIF0gPSByZXNwb25zZTsKCQl9CgoJCS8vIEFwcGx5IHRoZSBkYXRhRmlsdGVyIGlmIHByb3ZpZGVkCgkJaWYgKCAhcHJldiAmJiBpc1N1Y2Nlc3MgJiYgcy5kYXRhRmlsdGVyICkgewoJCQlyZXNwb25zZSA9IHMuZGF0YUZpbHRlciggcmVzcG9uc2UsIHMuZGF0YVR5cGUgKTsKCQl9CgoJCXByZXYgPSBjdXJyZW50OwoJCWN1cnJlbnQgPSBkYXRhVHlwZXMuc2hpZnQoKTsKCgkJaWYgKCBjdXJyZW50ICkgewoKCQkvLyBUaGVyZSdzIG9ubHkgd29yayB0byBkbyBpZiBjdXJyZW50IGRhdGFUeXBlIGlzIG5vbi1hdXRvCgkJCWlmICggY3VycmVudCA9PT0gIioiICkgewoKCQkJCWN1cnJlbnQgPSBwcmV2OwoKCQkJLy8gQ29udmVydCByZXNwb25zZSBpZiBwcmV2IGRhdGFUeXBlIGlzIG5vbi1hdXRvIGFuZCBkaWZmZXJzIGZyb20gY3VycmVudAoJCQl9IGVsc2UgaWYgKCBwcmV2ICE9PSAiKiIgJiYgcHJldiAhPT0gY3VycmVudCApIHsKCgkJCQkvLyBTZWVrIGEgZGlyZWN0IGNvbnZlcnRlcgoJCQkJY29udiA9IGNvbnZlcnRlcnNbIHByZXYgKyAiICIgKyBjdXJyZW50IF0gfHwgY29udmVydGVyc1sgIiogIiArIGN1cnJlbnQgXTsKCgkJCQkvLyBJZiBub25lIGZvdW5kLCBzZWVrIGEgcGFpcgoJCQkJaWYgKCAhY29udiApIHsKCQkJCQlmb3IgKCBjb252MiBpbiBjb252ZXJ0ZXJzICkgewoKCQkJCQkJLy8gSWYgY29udjIgb3V0cHV0cyBjdXJyZW50CgkJCQkJCXRtcCA9IGNvbnYyLnNwbGl0KCAiICIgKTsKCQkJCQkJaWYgKCB0bXBbIDEgXSA9PT0gY3VycmVudCApIHsKCgkJCQkJCQkvLyBJZiBwcmV2IGNhbiBiZSBjb252ZXJ0ZWQgdG8gYWNjZXB0ZWQgaW5wdXQKCQkJCQkJCWNvbnYgPSBjb252ZXJ0ZXJzWyBwcmV2ICsgIiAiICsgdG1wWyAwIF0gXSB8fAoJCQkJCQkJCWNvbnZlcnRlcnNbICIqICIgKyB0bXBbIDAgXSBdOwoJCQkJCQkJaWYgKCBjb252ICkgewoKCQkJCQkJCQkvLyBDb25kZW5zZSBlcXVpdmFsZW5jZSBjb252ZXJ0ZXJzCgkJCQkJCQkJaWYgKCBjb252ID09PSB0cnVlICkgewoJCQkJCQkJCQljb252ID0gY29udmVydGVyc1sgY29udjIgXTsKCgkJCQkJCQkJLy8gT3RoZXJ3aXNlLCBpbnNlcnQgdGhlIGludGVybWVkaWF0ZSBkYXRhVHlwZQoJCQkJCQkJCX0gZWxzZSBpZiAoIGNvbnZlcnRlcnNbIGNvbnYyIF0gIT09IHRydWUgKSB7CgkJCQkJCQkJCWN1cnJlbnQgPSB0bXBbIDAgXTsKCQkJCQkJCQkJZGF0YVR5cGVzLnVuc2hpZnQoIHRtcFsgMSBdICk7CgkJCQkJCQkJfQoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoKCQkJCS8vIEFwcGx5IGNvbnZlcnRlciAoaWYgbm90IGFuIGVxdWl2YWxlbmNlKQoJCQkJaWYgKCBjb252ICE9PSB0cnVlICkgewoKCQkJCQkvLyBVbmxlc3MgZXJyb3JzIGFyZSBhbGxvd2VkIHRvIGJ1YmJsZSwgY2F0Y2ggYW5kIHJldHVybiB0aGVtCgkJCQkJaWYgKCBjb252ICYmIHMudGhyb3dzICkgewoJCQkJCQlyZXNwb25zZSA9IGNvbnYoIHJlc3BvbnNlICk7CgkJCQkJfSBlbHNlIHsKCQkJCQkJdHJ5IHsKCQkJCQkJCXJlc3BvbnNlID0gY29udiggcmVzcG9uc2UgKTsKCQkJCQkJfSBjYXRjaCAoIGUgKSB7CgkJCQkJCQlyZXR1cm4gewoJCQkJCQkJCXN0YXRlOiAicGFyc2VyZXJyb3IiLAoJCQkJCQkJCWVycm9yOiBjb252ID8gZSA6ICJObyBjb252ZXJzaW9uIGZyb20gIiArIHByZXYgKyAiIHRvICIgKyBjdXJyZW50CgkJCQkJCQl9OwoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJfQoJfQoKCXJldHVybiB7IHN0YXRlOiAic3VjY2VzcyIsIGRhdGE6IHJlc3BvbnNlIH07Cn0KCmpRdWVyeS5leHRlbmQoIHsKCgkvLyBDb3VudGVyIGZvciBob2xkaW5nIHRoZSBudW1iZXIgb2YgYWN0aXZlIHF1ZXJpZXMKCWFjdGl2ZTogMCwKCgkvLyBMYXN0LU1vZGlmaWVkIGhlYWRlciBjYWNoZSBmb3IgbmV4dCByZXF1ZXN0CglsYXN0TW9kaWZpZWQ6IHt9LAoJZXRhZzoge30sCgoJYWpheFNldHRpbmdzOiB7CgkJdXJsOiBsb2NhdGlvbi5ocmVmLAoJCXR5cGU6ICJHRVQiLAoJCWlzTG9jYWw6IHJsb2NhbFByb3RvY29sLnRlc3QoIGxvY2F0aW9uLnByb3RvY29sICksCgkJZ2xvYmFsOiB0cnVlLAoJCXByb2Nlc3NEYXRhOiB0cnVlLAoJCWFzeW5jOiB0cnVlLAoJCWNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwKCQkvKgoJCXRpbWVvdXQ6IDAsCgkJZGF0YTogbnVsbCwKCQlkYXRhVHlwZTogbnVsbCwKCQl1c2VybmFtZTogbnVsbCwKCQlwYXNzd29yZDogbnVsbCwKCQljYWNoZTogbnVsbCwKCQl0aHJvd3M6IGZhbHNlLAoJCXRyYWRpdGlvbmFsOiBmYWxzZSwKCQloZWFkZXJzOiB7fSwKCQkqLwoKCQlhY2NlcHRzOiB7CgkJCSIqIjogYWxsVHlwZXMsCgkJCXRleHQ6ICJ0ZXh0L3BsYWluIiwKCQkJaHRtbDogInRleHQvaHRtbCIsCgkJCXhtbDogImFwcGxpY2F0aW9uL3htbCwgdGV4dC94bWwiLAoJCQlqc29uOiAiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0IgoJCX0sCgoJCWNvbnRlbnRzOiB7CgkJCXhtbDogL1xieG1sXGIvLAoJCQlodG1sOiAvXGJodG1sLywKCQkJanNvbjogL1xianNvblxiLwoJCX0sCgoJCXJlc3BvbnNlRmllbGRzOiB7CgkJCXhtbDogInJlc3BvbnNlWE1MIiwKCQkJdGV4dDogInJlc3BvbnNlVGV4dCIsCgkJCWpzb246ICJyZXNwb25zZUpTT04iCgkJfSwKCgkJLy8gRGF0YSBjb252ZXJ0ZXJzCgkJLy8gS2V5cyBzZXBhcmF0ZSBzb3VyY2UgKG9yIGNhdGNoYWxsICIqIikgYW5kIGRlc3RpbmF0aW9uIHR5cGVzIHdpdGggYSBzaW5nbGUgc3BhY2UKCQljb252ZXJ0ZXJzOiB7CgoJCQkvLyBDb252ZXJ0IGFueXRoaW5nIHRvIHRleHQKCQkJIiogdGV4dCI6IFN0cmluZywKCgkJCS8vIFRleHQgdG8gaHRtbCAodHJ1ZSA9IG5vIHRyYW5zZm9ybWF0aW9uKQoJCQkidGV4dCBodG1sIjogdHJ1ZSwKCgkJCS8vIEV2YWx1YXRlIHRleHQgYXMgYSBqc29uIGV4cHJlc3Npb24KCQkJInRleHQganNvbiI6IGpRdWVyeS5wYXJzZUpTT04sCgoJCQkvLyBQYXJzZSB0ZXh0IGFzIHhtbAoJCQkidGV4dCB4bWwiOiBqUXVlcnkucGFyc2VYTUwKCQl9LAoKCQkvLyBGb3Igb3B0aW9ucyB0aGF0IHNob3VsZG4ndCBiZSBkZWVwIGV4dGVuZGVkOgoJCS8vIHlvdSBjYW4gYWRkIHlvdXIgb3duIGN1c3RvbSBvcHRpb25zIGhlcmUgaWYKCQkvLyBhbmQgd2hlbiB5b3UgY3JlYXRlIG9uZSB0aGF0IHNob3VsZG4ndCBiZQoJCS8vIGRlZXAgZXh0ZW5kZWQgKHNlZSBhamF4RXh0ZW5kKQoJCWZsYXRPcHRpb25zOiB7CgkJCXVybDogdHJ1ZSwKCQkJY29udGV4dDogdHJ1ZQoJCX0KCX0sCgoJLy8gQ3JlYXRlcyBhIGZ1bGwgZmxlZGdlZCBzZXR0aW5ncyBvYmplY3QgaW50byB0YXJnZXQKCS8vIHdpdGggYm90aCBhamF4U2V0dGluZ3MgYW5kIHNldHRpbmdzIGZpZWxkcy4KCS8vIElmIHRhcmdldCBpcyBvbWl0dGVkLCB3cml0ZXMgaW50byBhamF4U2V0dGluZ3MuCglhamF4U2V0dXA6IGZ1bmN0aW9uKCB0YXJnZXQsIHNldHRpbmdzICkgewoJCXJldHVybiBzZXR0aW5ncyA/CgoJCQkvLyBCdWlsZGluZyBhIHNldHRpbmdzIG9iamVjdAoJCQlhamF4RXh0ZW5kKCBhamF4RXh0ZW5kKCB0YXJnZXQsIGpRdWVyeS5hamF4U2V0dGluZ3MgKSwgc2V0dGluZ3MgKSA6CgoJCQkvLyBFeHRlbmRpbmcgYWpheFNldHRpbmdzCgkJCWFqYXhFeHRlbmQoIGpRdWVyeS5hamF4U2V0dGluZ3MsIHRhcmdldCApOwoJfSwKCglhamF4UHJlZmlsdGVyOiBhZGRUb1ByZWZpbHRlcnNPclRyYW5zcG9ydHMoIHByZWZpbHRlcnMgKSwKCWFqYXhUcmFuc3BvcnQ6IGFkZFRvUHJlZmlsdGVyc09yVHJhbnNwb3J0cyggdHJhbnNwb3J0cyApLAoKCS8vIE1haW4gbWV0aG9kCglhamF4OiBmdW5jdGlvbiggdXJsLCBvcHRpb25zICkgewoKCQkvLyBJZiB1cmwgaXMgYW4gb2JqZWN0LCBzaW11bGF0ZSBwcmUtMS41IHNpZ25hdHVyZQoJCWlmICggdHlwZW9mIHVybCA9PT0gIm9iamVjdCIgKSB7CgkJCW9wdGlvbnMgPSB1cmw7CgkJCXVybCA9IHVuZGVmaW5lZDsKCQl9CgoJCS8vIEZvcmNlIG9wdGlvbnMgdG8gYmUgYW4gb2JqZWN0CgkJb3B0aW9ucyA9IG9wdGlvbnMgfHwge307CgoJCXZhciB0cmFuc3BvcnQsCgoJCQkvLyBVUkwgd2l0aG91dCBhbnRpLWNhY2hlIHBhcmFtCgkJCWNhY2hlVVJMLAoKCQkJLy8gUmVzcG9uc2UgaGVhZGVycwoJCQlyZXNwb25zZUhlYWRlcnNTdHJpbmcsCgkJCXJlc3BvbnNlSGVhZGVycywKCgkJCS8vIHRpbWVvdXQgaGFuZGxlCgkJCXRpbWVvdXRUaW1lciwKCgkJCS8vIFVybCBjbGVhbnVwIHZhcgoJCQl1cmxBbmNob3IsCgoJCQkvLyBUbyBrbm93IGlmIGdsb2JhbCBldmVudHMgYXJlIHRvIGJlIGRpc3BhdGNoZWQKCQkJZmlyZUdsb2JhbHMsCgoJCQkvLyBMb29wIHZhcmlhYmxlCgkJCWksCgoJCQkvLyBDcmVhdGUgdGhlIGZpbmFsIG9wdGlvbnMgb2JqZWN0CgkJCXMgPSBqUXVlcnkuYWpheFNldHVwKCB7fSwgb3B0aW9ucyApLAoKCQkJLy8gQ2FsbGJhY2tzIGNvbnRleHQKCQkJY2FsbGJhY2tDb250ZXh0ID0gcy5jb250ZXh0IHx8IHMsCgoJCQkvLyBDb250ZXh0IGZvciBnbG9iYWwgZXZlbnRzIGlzIGNhbGxiYWNrQ29udGV4dCBpZiBpdCBpcyBhIERPTSBub2RlIG9yIGpRdWVyeSBjb2xsZWN0aW9uCgkJCWdsb2JhbEV2ZW50Q29udGV4dCA9IHMuY29udGV4dCAmJgoJCQkJKCBjYWxsYmFja0NvbnRleHQubm9kZVR5cGUgfHwgY2FsbGJhY2tDb250ZXh0LmpxdWVyeSApID8KCQkJCQlqUXVlcnkoIGNhbGxiYWNrQ29udGV4dCApIDoKCQkJCQlqUXVlcnkuZXZlbnQsCgoJCQkvLyBEZWZlcnJlZHMKCQkJZGVmZXJyZWQgPSBqUXVlcnkuRGVmZXJyZWQoKSwKCQkJY29tcGxldGVEZWZlcnJlZCA9IGpRdWVyeS5DYWxsYmFja3MoICJvbmNlIG1lbW9yeSIgKSwKCgkJCS8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzCgkJCXN0YXR1c0NvZGUgPSBzLnN0YXR1c0NvZGUgfHwge30sCgoJCQkvLyBIZWFkZXJzICh0aGV5IGFyZSBzZW50IGFsbCBhdCBvbmNlKQoJCQlyZXF1ZXN0SGVhZGVycyA9IHt9LAoJCQlyZXF1ZXN0SGVhZGVyc05hbWVzID0ge30sCgoJCQkvLyBUaGUganFYSFIgc3RhdGUKCQkJc3RhdGUgPSAwLAoKCQkJLy8gRGVmYXVsdCBhYm9ydCBtZXNzYWdlCgkJCXN0ckFib3J0ID0gImNhbmNlbGVkIiwKCgkJCS8vIEZha2UgeGhyCgkJCWpxWEhSID0gewoJCQkJcmVhZHlTdGF0ZTogMCwKCgkJCQkvLyBCdWlsZHMgaGVhZGVycyBoYXNodGFibGUgaWYgbmVlZGVkCgkJCQlnZXRSZXNwb25zZUhlYWRlcjogZnVuY3Rpb24oIGtleSApIHsKCQkJCQl2YXIgbWF0Y2g7CgkJCQkJaWYgKCBzdGF0ZSA9PT0gMiApIHsKCQkJCQkJaWYgKCAhcmVzcG9uc2VIZWFkZXJzICkgewoJCQkJCQkJcmVzcG9uc2VIZWFkZXJzID0ge307CgkJCQkJCQl3aGlsZSAoICggbWF0Y2ggPSByaGVhZGVycy5leGVjKCByZXNwb25zZUhlYWRlcnNTdHJpbmcgKSApICkgewoJCQkJCQkJCXJlc3BvbnNlSGVhZGVyc1sgbWF0Y2hbIDEgXS50b0xvd2VyQ2FzZSgpIF0gPSBtYXRjaFsgMiBdOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJCW1hdGNoID0gcmVzcG9uc2VIZWFkZXJzWyBrZXkudG9Mb3dlckNhc2UoKSBdOwoJCQkJCX0KCQkJCQlyZXR1cm4gbWF0Y2ggPT0gbnVsbCA/IG51bGwgOiBtYXRjaDsKCQkJCX0sCgoJCQkJLy8gUmF3IHN0cmluZwoJCQkJZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbigpIHsKCQkJCQlyZXR1cm4gc3RhdGUgPT09IDIgPyByZXNwb25zZUhlYWRlcnNTdHJpbmcgOiBudWxsOwoJCQkJfSwKCgkJCQkvLyBDYWNoZXMgdGhlIGhlYWRlcgoJCQkJc2V0UmVxdWVzdEhlYWRlcjogZnVuY3Rpb24oIG5hbWUsIHZhbHVlICkgewoJCQkJCXZhciBsbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKCQkJCQlpZiAoICFzdGF0ZSApIHsKCQkJCQkJbmFtZSA9IHJlcXVlc3RIZWFkZXJzTmFtZXNbIGxuYW1lIF0gPSByZXF1ZXN0SGVhZGVyc05hbWVzWyBsbmFtZSBdIHx8IG5hbWU7CgkJCQkJCXJlcXVlc3RIZWFkZXJzWyBuYW1lIF0gPSB2YWx1ZTsKCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoKCQkJCS8vIE92ZXJyaWRlcyByZXNwb25zZSBjb250ZW50LXR5cGUgaGVhZGVyCgkJCQlvdmVycmlkZU1pbWVUeXBlOiBmdW5jdGlvbiggdHlwZSApIHsKCQkJCQlpZiAoICFzdGF0ZSApIHsKCQkJCQkJcy5taW1lVHlwZSA9IHR5cGU7CgkJCQkJfQoJCQkJCXJldHVybiB0aGlzOwoJCQkJfSwKCgkJCQkvLyBTdGF0dXMtZGVwZW5kZW50IGNhbGxiYWNrcwoJCQkJc3RhdHVzQ29kZTogZnVuY3Rpb24oIG1hcCApIHsKCQkJCQl2YXIgY29kZTsKCQkJCQlpZiAoIG1hcCApIHsKCQkJCQkJaWYgKCBzdGF0ZSA8IDIgKSB7CgkJCQkJCQlmb3IgKCBjb2RlIGluIG1hcCApIHsKCgkJCQkJCQkJLy8gTGF6eS1hZGQgdGhlIG5ldyBjYWxsYmFjayBpbiBhIHdheSB0aGF0IHByZXNlcnZlcyBvbGQgb25lcwoJCQkJCQkJCXN0YXR1c0NvZGVbIGNvZGUgXSA9IFsgc3RhdHVzQ29kZVsgY29kZSBdLCBtYXBbIGNvZGUgXSBdOwoJCQkJCQkJfQoJCQkJCQl9IGVsc2UgewoKCQkJCQkJCS8vIEV4ZWN1dGUgdGhlIGFwcHJvcHJpYXRlIGNhbGxiYWNrcwoJCQkJCQkJanFYSFIuYWx3YXlzKCBtYXBbIGpxWEhSLnN0YXR1cyBdICk7CgkJCQkJCX0KCQkJCQl9CgkJCQkJcmV0dXJuIHRoaXM7CgkJCQl9LAoKCQkJCS8vIENhbmNlbCB0aGUgcmVxdWVzdAoJCQkJYWJvcnQ6IGZ1bmN0aW9uKCBzdGF0dXNUZXh0ICkgewoJCQkJCXZhciBmaW5hbFRleHQgPSBzdGF0dXNUZXh0IHx8IHN0ckFib3J0OwoJCQkJCWlmICggdHJhbnNwb3J0ICkgewoJCQkJCQl0cmFuc3BvcnQuYWJvcnQoIGZpbmFsVGV4dCApOwoJCQkJCX0KCQkJCQlkb25lKCAwLCBmaW5hbFRleHQgKTsKCQkJCQlyZXR1cm4gdGhpczsKCQkJCX0KCQkJfTsKCgkJLy8gQXR0YWNoIGRlZmVycmVkcwoJCWRlZmVycmVkLnByb21pc2UoIGpxWEhSICkuY29tcGxldGUgPSBjb21wbGV0ZURlZmVycmVkLmFkZDsKCQlqcVhIUi5zdWNjZXNzID0ganFYSFIuZG9uZTsKCQlqcVhIUi5lcnJvciA9IGpxWEhSLmZhaWw7CgoJCS8vIFJlbW92ZSBoYXNoIGNoYXJhY3RlciAoIzc1MzE6IGFuZCBzdHJpbmcgcHJvbW90aW9uKQoJCS8vIEFkZCBwcm90b2NvbCBpZiBub3QgcHJvdmlkZWQgKHByZWZpbHRlcnMgbWlnaHQgZXhwZWN0IGl0KQoJCS8vIEhhbmRsZSBmYWxzeSB1cmwgaW4gdGhlIHNldHRpbmdzIG9iamVjdCAoIzEwMDkzOiBjb25zaXN0ZW5jeSB3aXRoIG9sZCBzaWduYXR1cmUpCgkJLy8gV2UgYWxzbyB1c2UgdGhlIHVybCBwYXJhbWV0ZXIgaWYgYXZhaWxhYmxlCgkJcy51cmwgPSAoICggdXJsIHx8IHMudXJsIHx8IGxvY2F0aW9uLmhyZWYgKSArICIiICkucmVwbGFjZSggcmhhc2gsICIiICkKCQkJLnJlcGxhY2UoIHJwcm90b2NvbCwgbG9jYXRpb24ucHJvdG9jb2wgKyAiLy8iICk7CgoJCS8vIEFsaWFzIG1ldGhvZCBvcHRpb24gdG8gdHlwZSBhcyBwZXIgdGlja2V0ICMxMjAwNAoJCXMudHlwZSA9IG9wdGlvbnMubWV0aG9kIHx8IG9wdGlvbnMudHlwZSB8fCBzLm1ldGhvZCB8fCBzLnR5cGU7CgoJCS8vIEV4dHJhY3QgZGF0YVR5cGVzIGxpc3QKCQlzLmRhdGFUeXBlcyA9IGpRdWVyeS50cmltKCBzLmRhdGFUeXBlIHx8ICIqIiApLnRvTG93ZXJDYXNlKCkubWF0Y2goIHJub3R3aGl0ZSApIHx8IFsgIiIgXTsKCgkJLy8gQSBjcm9zcy1kb21haW4gcmVxdWVzdCBpcyBpbiBvcmRlciB3aGVuIHRoZSBvcmlnaW4gZG9lc24ndCBtYXRjaCB0aGUgY3VycmVudCBvcmlnaW4uCgkJaWYgKCBzLmNyb3NzRG9tYWluID09IG51bGwgKSB7CgkJCXVybEFuY2hvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICJhIiApOwoKCQkJLy8gU3VwcG9ydDogSUU4LTExKwoJCQkvLyBJRSB0aHJvd3MgZXhjZXB0aW9uIGlmIHVybCBpcyBtYWxmb3JtZWQsIGUuZy4gaHR0cDovL2V4YW1wbGUuY29tOjgweC8KCQkJdHJ5IHsKCQkJCXVybEFuY2hvci5ocmVmID0gcy51cmw7CgoJCQkJLy8gU3VwcG9ydDogSUU4LTExKwoJCQkJLy8gQW5jaG9yJ3MgaG9zdCBwcm9wZXJ0eSBpc24ndCBjb3JyZWN0bHkgc2V0IHdoZW4gcy51cmwgaXMgcmVsYXRpdmUKCQkJCXVybEFuY2hvci5ocmVmID0gdXJsQW5jaG9yLmhyZWY7CgkJCQlzLmNyb3NzRG9tYWluID0gb3JpZ2luQW5jaG9yLnByb3RvY29sICsgIi8vIiArIG9yaWdpbkFuY2hvci5ob3N0ICE9PQoJCQkJCXVybEFuY2hvci5wcm90b2NvbCArICIvLyIgKyB1cmxBbmNob3IuaG9zdDsKCQkJfSBjYXRjaCAoIGUgKSB7CgoJCQkJLy8gSWYgdGhlcmUgaXMgYW4gZXJyb3IgcGFyc2luZyB0aGUgVVJMLCBhc3N1bWUgaXQgaXMgY3Jvc3NEb21haW4sCgkJCQkvLyBpdCBjYW4gYmUgcmVqZWN0ZWQgYnkgdGhlIHRyYW5zcG9ydCBpZiBpdCBpcyBpbnZhbGlkCgkJCQlzLmNyb3NzRG9tYWluID0gdHJ1ZTsKCQkJfQoJCX0KCgkJLy8gQ29udmVydCBkYXRhIGlmIG5vdCBhbHJlYWR5IGEgc3RyaW5nCgkJaWYgKCBzLmRhdGEgJiYgcy5wcm9jZXNzRGF0YSAmJiB0eXBlb2Ygcy5kYXRhICE9PSAic3RyaW5nIiApIHsKCQkJcy5kYXRhID0galF1ZXJ5LnBhcmFtKCBzLmRhdGEsIHMudHJhZGl0aW9uYWwgKTsKCQl9CgoJCS8vIEFwcGx5IHByZWZpbHRlcnMKCQlpbnNwZWN0UHJlZmlsdGVyc09yVHJhbnNwb3J0cyggcHJlZmlsdGVycywgcywgb3B0aW9ucywganFYSFIgKTsKCgkJLy8gSWYgcmVxdWVzdCB3YXMgYWJvcnRlZCBpbnNpZGUgYSBwcmVmaWx0ZXIsIHN0b3AgdGhlcmUKCQlpZiAoIHN0YXRlID09PSAyICkgewoJCQlyZXR1cm4ganFYSFI7CgkJfQoKCQkvLyBXZSBjYW4gZmlyZSBnbG9iYWwgZXZlbnRzIGFzIG9mIG5vdyBpZiBhc2tlZCB0bwoJCS8vIERvbid0IGZpcmUgZXZlbnRzIGlmIGpRdWVyeS5ldmVudCBpcyB1bmRlZmluZWQgaW4gYW4gQU1ELXVzYWdlIHNjZW5hcmlvICgjMTUxMTgpCgkJZmlyZUdsb2JhbHMgPSBqUXVlcnkuZXZlbnQgJiYgcy5nbG9iYWw7CgoJCS8vIFdhdGNoIGZvciBhIG5ldyBzZXQgb2YgcmVxdWVzdHMKCQlpZiAoIGZpcmVHbG9iYWxzICYmIGpRdWVyeS5hY3RpdmUrKyA9PT0gMCApIHsKCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXIoICJhamF4U3RhcnQiICk7CgkJfQoKCQkvLyBVcHBlcmNhc2UgdGhlIHR5cGUKCQlzLnR5cGUgPSBzLnR5cGUudG9VcHBlckNhc2UoKTsKCgkJLy8gRGV0ZXJtaW5lIGlmIHJlcXVlc3QgaGFzIGNvbnRlbnQKCQlzLmhhc0NvbnRlbnQgPSAhcm5vQ29udGVudC50ZXN0KCBzLnR5cGUgKTsKCgkJLy8gU2F2ZSB0aGUgVVJMIGluIGNhc2Ugd2UncmUgdG95aW5nIHdpdGggdGhlIElmLU1vZGlmaWVkLVNpbmNlCgkJLy8gYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyIGxhdGVyIG9uCgkJY2FjaGVVUkwgPSBzLnVybDsKCgkJLy8gTW9yZSBvcHRpb25zIGhhbmRsaW5nIGZvciByZXF1ZXN0cyB3aXRoIG5vIGNvbnRlbnQKCQlpZiAoICFzLmhhc0NvbnRlbnQgKSB7CgoJCQkvLyBJZiBkYXRhIGlzIGF2YWlsYWJsZSwgYXBwZW5kIGRhdGEgdG8gdXJsCgkJCWlmICggcy5kYXRhICkgewoJCQkJY2FjaGVVUkwgPSAoIHMudXJsICs9ICggcnF1ZXJ5LnRlc3QoIGNhY2hlVVJMICkgPyAiJiIgOiAiPyIgKSArIHMuZGF0YSApOwoKCQkJCS8vICM5NjgyOiByZW1vdmUgZGF0YSBzbyB0aGF0IGl0J3Mgbm90IHVzZWQgaW4gYW4gZXZlbnR1YWwgcmV0cnkKCQkJCWRlbGV0ZSBzLmRhdGE7CgkJCX0KCgkJCS8vIEFkZCBhbnRpLWNhY2hlIGluIHVybCBpZiBuZWVkZWQKCQkJaWYgKCBzLmNhY2hlID09PSBmYWxzZSApIHsKCQkJCXMudXJsID0gcnRzLnRlc3QoIGNhY2hlVVJMICkgPwoKCQkJCQkvLyBJZiB0aGVyZSBpcyBhbHJlYWR5IGEgJ18nIHBhcmFtZXRlciwgc2V0IGl0cyB2YWx1ZQoJCQkJCWNhY2hlVVJMLnJlcGxhY2UoIHJ0cywgIiQxXz0iICsgbm9uY2UrKyApIDoKCgkJCQkJLy8gT3RoZXJ3aXNlIGFkZCBvbmUgdG8gdGhlIGVuZAoJCQkJCWNhY2hlVVJMICsgKCBycXVlcnkudGVzdCggY2FjaGVVUkwgKSA/ICImIiA6ICI/IiApICsgIl89IiArIG5vbmNlKys7CgkJCX0KCQl9CgoJCS8vIFNldCB0aGUgSWYtTW9kaWZpZWQtU2luY2UgYW5kL29yIElmLU5vbmUtTWF0Y2ggaGVhZGVyLCBpZiBpbiBpZk1vZGlmaWVkIG1vZGUuCgkJaWYgKCBzLmlmTW9kaWZpZWQgKSB7CgkJCWlmICggalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSApIHsKCQkJCWpxWEhSLnNldFJlcXVlc3RIZWFkZXIoICJJZi1Nb2RpZmllZC1TaW5jZSIsIGpRdWVyeS5sYXN0TW9kaWZpZWRbIGNhY2hlVVJMIF0gKTsKCQkJfQoJCQlpZiAoIGpRdWVyeS5ldGFnWyBjYWNoZVVSTCBdICkgewoJCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlciggIklmLU5vbmUtTWF0Y2giLCBqUXVlcnkuZXRhZ1sgY2FjaGVVUkwgXSApOwoJCQl9CgkJfQoKCQkvLyBTZXQgdGhlIGNvcnJlY3QgaGVhZGVyLCBpZiBkYXRhIGlzIGJlaW5nIHNlbnQKCQlpZiAoIHMuZGF0YSAmJiBzLmhhc0NvbnRlbnQgJiYgcy5jb250ZW50VHlwZSAhPT0gZmFsc2UgfHwgb3B0aW9ucy5jb250ZW50VHlwZSApIHsKCQkJanFYSFIuc2V0UmVxdWVzdEhlYWRlciggIkNvbnRlbnQtVHlwZSIsIHMuY29udGVudFR5cGUgKTsKCQl9CgoJCS8vIFNldCB0aGUgQWNjZXB0cyBoZWFkZXIgZm9yIHRoZSBzZXJ2ZXIsIGRlcGVuZGluZyBvbiB0aGUgZGF0YVR5cGUKCQlqcVhIUi5zZXRSZXF1ZXN0SGVhZGVyKAoJCQkiQWNjZXB0IiwKCQkJcy5kYXRhVHlwZXNbIDAgXSAmJiBzLmFjY2VwdHNbIHMuZGF0YVR5cGVzWyAwIF0gXSA/CgkJCQlzLmFjY2VwdHNbIHMuZGF0YVR5cGVzWyAwIF0gXSArCgkJCQkJKCBzLmRhdGFUeXBlc1sgMCBdICE9PSAiKiIgPyAiLCAiICsgYWxsVHlwZXMgKyAiOyBxPTAuMDEiIDogIiIgKSA6CgkJCQlzLmFjY2VwdHNbICIqIiBdCgkJKTsKCgkJLy8gQ2hlY2sgZm9yIGhlYWRlcnMgb3B0aW9uCgkJZm9yICggaSBpbiBzLmhlYWRlcnMgKSB7CgkJCWpxWEhSLnNldFJlcXVlc3RIZWFkZXIoIGksIHMuaGVhZGVyc1sgaSBdICk7CgkJfQoKCQkvLyBBbGxvdyBjdXN0b20gaGVhZGVycy9taW1ldHlwZXMgYW5kIGVhcmx5IGFib3J0CgkJaWYgKCBzLmJlZm9yZVNlbmQgJiYKCQkJKCBzLmJlZm9yZVNlbmQuY2FsbCggY2FsbGJhY2tDb250ZXh0LCBqcVhIUiwgcyApID09PSBmYWxzZSB8fCBzdGF0ZSA9PT0gMiApICkgewoKCQkJLy8gQWJvcnQgaWYgbm90IGRvbmUgYWxyZWFkeSBhbmQgcmV0dXJuCgkJCXJldHVybiBqcVhIUi5hYm9ydCgpOwoJCX0KCgkJLy8gQWJvcnRpbmcgaXMgbm8gbG9uZ2VyIGEgY2FuY2VsbGF0aW9uCgkJc3RyQWJvcnQgPSAiYWJvcnQiOwoKCQkvLyBJbnN0YWxsIGNhbGxiYWNrcyBvbiBkZWZlcnJlZHMKCQlmb3IgKCBpIGluIHsgc3VjY2VzczogMSwgZXJyb3I6IDEsIGNvbXBsZXRlOiAxIH0gKSB7CgkJCWpxWEhSWyBpIF0oIHNbIGkgXSApOwoJCX0KCgkJLy8gR2V0IHRyYW5zcG9ydAoJCXRyYW5zcG9ydCA9IGluc3BlY3RQcmVmaWx0ZXJzT3JUcmFuc3BvcnRzKCB0cmFuc3BvcnRzLCBzLCBvcHRpb25zLCBqcVhIUiApOwoKCQkvLyBJZiBubyB0cmFuc3BvcnQsIHdlIGF1dG8tYWJvcnQKCQlpZiAoICF0cmFuc3BvcnQgKSB7CgkJCWRvbmUoIC0xLCAiTm8gVHJhbnNwb3J0IiApOwoJCX0gZWxzZSB7CgkJCWpxWEhSLnJlYWR5U3RhdGUgPSAxOwoKCQkJLy8gU2VuZCBnbG9iYWwgZXZlbnQKCQkJaWYgKCBmaXJlR2xvYmFscyApIHsKCQkJCWdsb2JhbEV2ZW50Q29udGV4dC50cmlnZ2VyKCAiYWpheFNlbmQiLCBbIGpxWEhSLCBzIF0gKTsKCQkJfQoKCQkJLy8gSWYgcmVxdWVzdCB3YXMgYWJvcnRlZCBpbnNpZGUgYWpheFNlbmQsIHN0b3AgdGhlcmUKCQkJaWYgKCBzdGF0ZSA9PT0gMiApIHsKCQkJCXJldHVybiBqcVhIUjsKCQkJfQoKCQkJLy8gVGltZW91dAoJCQlpZiAoIHMuYXN5bmMgJiYgcy50aW1lb3V0ID4gMCApIHsKCQkJCXRpbWVvdXRUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsKCQkJCQlqcVhIUi5hYm9ydCggInRpbWVvdXQiICk7CgkJCQl9LCBzLnRpbWVvdXQgKTsKCQkJfQoKCQkJdHJ5IHsKCQkJCXN0YXRlID0gMTsKCQkJCXRyYW5zcG9ydC5zZW5kKCByZXF1ZXN0SGVhZGVycywgZG9uZSApOwoJCQl9IGNhdGNoICggZSApIHsKCgkJCQkvLyBQcm9wYWdhdGUgZXhjZXB0aW9uIGFzIGVycm9yIGlmIG5vdCBkb25lCgkJCQlpZiAoIHN0YXRlIDwgMiApIHsKCQkJCQlkb25lKCAtMSwgZSApOwoKCQkJCS8vIFNpbXBseSByZXRocm93IG90aGVyd2lzZQoJCQkJfSBlbHNlIHsKCQkJCQl0aHJvdyBlOwoJCQkJfQoJCQl9CgkJfQoKCQkvLyBDYWxsYmFjayBmb3Igd2hlbiBldmVyeXRoaW5nIGlzIGRvbmUKCQlmdW5jdGlvbiBkb25lKCBzdGF0dXMsIG5hdGl2ZVN0YXR1c1RleHQsIHJlc3BvbnNlcywgaGVhZGVycyApIHsKCQkJdmFyIGlzU3VjY2Vzcywgc3VjY2VzcywgZXJyb3IsIHJlc3BvbnNlLCBtb2RpZmllZCwKCQkJCXN0YXR1c1RleHQgPSBuYXRpdmVTdGF0dXNUZXh0OwoKCQkJLy8gQ2FsbGVkIG9uY2UKCQkJaWYgKCBzdGF0ZSA9PT0gMiApIHsKCQkJCXJldHVybjsKCQkJfQoKCQkJLy8gU3RhdGUgaXMgImRvbmUiIG5vdwoJCQlzdGF0ZSA9IDI7CgoJCQkvLyBDbGVhciB0aW1lb3V0IGlmIGl0IGV4aXN0cwoJCQlpZiAoIHRpbWVvdXRUaW1lciApIHsKCQkJCXdpbmRvdy5jbGVhclRpbWVvdXQoIHRpbWVvdXRUaW1lciApOwoJCQl9CgoJCQkvLyBEZXJlZmVyZW5jZSB0cmFuc3BvcnQgZm9yIGVhcmx5IGdhcmJhZ2UgY29sbGVjdGlvbgoJCQkvLyAobm8gbWF0dGVyIGhvdyBsb25nIHRoZSBqcVhIUiBvYmplY3Qgd2lsbCBiZSB1c2VkKQoJCQl0cmFuc3BvcnQgPSB1bmRlZmluZWQ7CgoJCQkvLyBDYWNoZSByZXNwb25zZSBoZWFkZXJzCgkJCXJlc3BvbnNlSGVhZGVyc1N0cmluZyA9IGhlYWRlcnMgfHwgIiI7CgoJCQkvLyBTZXQgcmVhZHlTdGF0ZQoJCQlqcVhIUi5yZWFkeVN0YXRlID0gc3RhdHVzID4gMCA/IDQgOiAwOwoKCQkJLy8gRGV0ZXJtaW5lIGlmIHN1Y2Nlc3NmdWwKCQkJaXNTdWNjZXNzID0gc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDAgfHwgc3RhdHVzID09PSAzMDQ7CgoJCQkvLyBHZXQgcmVzcG9uc2UgZGF0YQoJCQlpZiAoIHJlc3BvbnNlcyApIHsKCQkJCXJlc3BvbnNlID0gYWpheEhhbmRsZVJlc3BvbnNlcyggcywganFYSFIsIHJlc3BvbnNlcyApOwoJCQl9CgoJCQkvLyBDb252ZXJ0IG5vIG1hdHRlciB3aGF0ICh0aGF0IHdheSByZXNwb25zZVhYWCBmaWVsZHMgYXJlIGFsd2F5cyBzZXQpCgkJCXJlc3BvbnNlID0gYWpheENvbnZlcnQoIHMsIHJlc3BvbnNlLCBqcVhIUiwgaXNTdWNjZXNzICk7CgoJCQkvLyBJZiBzdWNjZXNzZnVsLCBoYW5kbGUgdHlwZSBjaGFpbmluZwoJCQlpZiAoIGlzU3VjY2VzcyApIHsKCgkJCQkvLyBTZXQgdGhlIElmLU1vZGlmaWVkLVNpbmNlIGFuZC9vciBJZi1Ob25lLU1hdGNoIGhlYWRlciwgaWYgaW4gaWZNb2RpZmllZCBtb2RlLgoJCQkJaWYgKCBzLmlmTW9kaWZpZWQgKSB7CgkJCQkJbW9kaWZpZWQgPSBqcVhIUi5nZXRSZXNwb25zZUhlYWRlciggIkxhc3QtTW9kaWZpZWQiICk7CgkJCQkJaWYgKCBtb2RpZmllZCApIHsKCQkJCQkJalF1ZXJ5Lmxhc3RNb2RpZmllZFsgY2FjaGVVUkwgXSA9IG1vZGlmaWVkOwoJCQkJCX0KCQkJCQltb2RpZmllZCA9IGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCAiZXRhZyIgKTsKCQkJCQlpZiAoIG1vZGlmaWVkICkgewoJCQkJCQlqUXVlcnkuZXRhZ1sgY2FjaGVVUkwgXSA9IG1vZGlmaWVkOwoJCQkJCX0KCQkJCX0KCgkJCQkvLyBpZiBubyBjb250ZW50CgkJCQlpZiAoIHN0YXR1cyA9PT0gMjA0IHx8IHMudHlwZSA9PT0gIkhFQUQiICkgewoJCQkJCXN0YXR1c1RleHQgPSAibm9jb250ZW50IjsKCgkJCQkvLyBpZiBub3QgbW9kaWZpZWQKCQkJCX0gZWxzZSBpZiAoIHN0YXR1cyA9PT0gMzA0ICkgewoJCQkJCXN0YXR1c1RleHQgPSAibm90bW9kaWZpZWQiOwoKCQkJCS8vIElmIHdlIGhhdmUgZGF0YSwgbGV0J3MgY29udmVydCBpdAoJCQkJfSBlbHNlIHsKCQkJCQlzdGF0dXNUZXh0ID0gcmVzcG9uc2Uuc3RhdGU7CgkJCQkJc3VjY2VzcyA9IHJlc3BvbnNlLmRhdGE7CgkJCQkJZXJyb3IgPSByZXNwb25zZS5lcnJvcjsKCQkJCQlpc1N1Y2Nlc3MgPSAhZXJyb3I7CgkJCQl9CgkJCX0gZWxzZSB7CgoJCQkJLy8gRXh0cmFjdCBlcnJvciBmcm9tIHN0YXR1c1RleHQgYW5kIG5vcm1hbGl6ZSBmb3Igbm9uLWFib3J0cwoJCQkJZXJyb3IgPSBzdGF0dXNUZXh0OwoJCQkJaWYgKCBzdGF0dXMgfHwgIXN0YXR1c1RleHQgKSB7CgkJCQkJc3RhdHVzVGV4dCA9ICJlcnJvciI7CgkJCQkJaWYgKCBzdGF0dXMgPCAwICkgewoJCQkJCQlzdGF0dXMgPSAwOwoJCQkJCX0KCQkJCX0KCQkJfQoKCQkJLy8gU2V0IGRhdGEgZm9yIHRoZSBmYWtlIHhociBvYmplY3QKCQkJanFYSFIuc3RhdHVzID0gc3RhdHVzOwoJCQlqcVhIUi5zdGF0dXNUZXh0ID0gKCBuYXRpdmVTdGF0dXNUZXh0IHx8IHN0YXR1c1RleHQgKSArICIiOwoKCQkJLy8gU3VjY2Vzcy9FcnJvcgoJCQlpZiAoIGlzU3VjY2VzcyApIHsKCQkJCWRlZmVycmVkLnJlc29sdmVXaXRoKCBjYWxsYmFja0NvbnRleHQsIFsgc3VjY2Vzcywgc3RhdHVzVGV4dCwganFYSFIgXSApOwoJCQl9IGVsc2UgewoJCQkJZGVmZXJyZWQucmVqZWN0V2l0aCggY2FsbGJhY2tDb250ZXh0LCBbIGpxWEhSLCBzdGF0dXNUZXh0LCBlcnJvciBdICk7CgkJCX0KCgkJCS8vIFN0YXR1cy1kZXBlbmRlbnQgY2FsbGJhY2tzCgkJCWpxWEhSLnN0YXR1c0NvZGUoIHN0YXR1c0NvZGUgKTsKCQkJc3RhdHVzQ29kZSA9IHVuZGVmaW5lZDsKCgkJCWlmICggZmlyZUdsb2JhbHMgKSB7CgkJCQlnbG9iYWxFdmVudENvbnRleHQudHJpZ2dlciggaXNTdWNjZXNzID8gImFqYXhTdWNjZXNzIiA6ICJhamF4RXJyb3IiLAoJCQkJCVsganFYSFIsIHMsIGlzU3VjY2VzcyA/IHN1Y2Nlc3MgOiBlcnJvciBdICk7CgkJCX0KCgkJCS8vIENvbXBsZXRlCgkJCWNvbXBsZXRlRGVmZXJyZWQuZmlyZVdpdGgoIGNhbGxiYWNrQ29udGV4dCwgWyBqcVhIUiwgc3RhdHVzVGV4dCBdICk7CgoJCQlpZiAoIGZpcmVHbG9iYWxzICkgewoJCQkJZ2xvYmFsRXZlbnRDb250ZXh0LnRyaWdnZXIoICJhamF4Q29tcGxldGUiLCBbIGpxWEhSLCBzIF0gKTsKCgkJCQkvLyBIYW5kbGUgdGhlIGdsb2JhbCBBSkFYIGNvdW50ZXIKCQkJCWlmICggISggLS1qUXVlcnkuYWN0aXZlICkgKSB7CgkJCQkJalF1ZXJ5LmV2ZW50LnRyaWdnZXIoICJhamF4U3RvcCIgKTsKCQkJCX0KCQkJfQoJCX0KCgkJcmV0dXJuIGpxWEhSOwoJfSwKCglnZXRKU09OOiBmdW5jdGlvbiggdXJsLCBkYXRhLCBjYWxsYmFjayApIHsKCQlyZXR1cm4galF1ZXJ5LmdldCggdXJsLCBkYXRhLCBjYWxsYmFjaywgImpzb24iICk7Cgl9LAoKCWdldFNjcmlwdDogZnVuY3Rpb24oIHVybCwgY2FsbGJhY2sgKSB7CgkJcmV0dXJuIGpRdWVyeS5nZXQoIHVybCwgdW5kZWZpbmVkLCBjYWxsYmFjaywgInNjcmlwdCIgKTsKCX0KfSApOwoKalF1ZXJ5LmVhY2goIFsgImdldCIsICJwb3N0IiBdLCBmdW5jdGlvbiggaSwgbWV0aG9kICkgewoJalF1ZXJ5WyBtZXRob2QgXSA9IGZ1bmN0aW9uKCB1cmwsIGRhdGEsIGNhbGxiYWNrLCB0eXBlICkgewoKCQkvLyBTaGlmdCBhcmd1bWVudHMgaWYgZGF0YSBhcmd1bWVudCB3YXMgb21pdHRlZAoJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGRhdGEgKSApIHsKCQkJdHlwZSA9IHR5cGUgfHwgY2FsbGJhY2s7CgkJCWNhbGxiYWNrID0gZGF0YTsKCQkJZGF0YSA9IHVuZGVmaW5lZDsKCQl9CgoJCS8vIFRoZSB1cmwgY2FuIGJlIGFuIG9wdGlvbnMgb2JqZWN0ICh3aGljaCB0aGVuIG11c3QgaGF2ZSAudXJsKQoJCXJldHVybiBqUXVlcnkuYWpheCggalF1ZXJ5LmV4dGVuZCggewoJCQl1cmw6IHVybCwKCQkJdHlwZTogbWV0aG9kLAoJCQlkYXRhVHlwZTogdHlwZSwKCQkJZGF0YTogZGF0YSwKCQkJc3VjY2VzczogY2FsbGJhY2sKCQl9LCBqUXVlcnkuaXNQbGFpbk9iamVjdCggdXJsICkgJiYgdXJsICkgKTsKCX07Cn0gKTsKCgpqUXVlcnkuX2V2YWxVcmwgPSBmdW5jdGlvbiggdXJsICkgewoJcmV0dXJuIGpRdWVyeS5hamF4KCB7CgkJdXJsOiB1cmwsCgoJCS8vIE1ha2UgdGhpcyBleHBsaWNpdCwgc2luY2UgdXNlciBjYW4gb3ZlcnJpZGUgdGhpcyB0aHJvdWdoIGFqYXhTZXR1cCAoIzExMjY0KQoJCXR5cGU6ICJHRVQiLAoJCWRhdGFUeXBlOiAic2NyaXB0IiwKCQlhc3luYzogZmFsc2UsCgkJZ2xvYmFsOiBmYWxzZSwKCQkidGhyb3dzIjogdHJ1ZQoJfSApOwp9OwoKCmpRdWVyeS5mbi5leHRlbmQoIHsKCXdyYXBBbGw6IGZ1bmN0aW9uKCBodG1sICkgewoJCXZhciB3cmFwOwoKCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICkgKSB7CgkJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCBpICkgewoJCQkJalF1ZXJ5KCB0aGlzICkud3JhcEFsbCggaHRtbC5jYWxsKCB0aGlzLCBpICkgKTsKCQkJfSApOwoJCX0KCgkJaWYgKCB0aGlzWyAwIF0gKSB7CgoJCQkvLyBUaGUgZWxlbWVudHMgdG8gd3JhcCB0aGUgdGFyZ2V0IGFyb3VuZAoJCQl3cmFwID0galF1ZXJ5KCBodG1sLCB0aGlzWyAwIF0ub3duZXJEb2N1bWVudCApLmVxKCAwICkuY2xvbmUoIHRydWUgKTsKCgkJCWlmICggdGhpc1sgMCBdLnBhcmVudE5vZGUgKSB7CgkJCQl3cmFwLmluc2VydEJlZm9yZSggdGhpc1sgMCBdICk7CgkJCX0KCgkJCXdyYXAubWFwKCBmdW5jdGlvbigpIHsKCQkJCXZhciBlbGVtID0gdGhpczsKCgkJCQl3aGlsZSAoIGVsZW0uZmlyc3RFbGVtZW50Q2hpbGQgKSB7CgkJCQkJZWxlbSA9IGVsZW0uZmlyc3RFbGVtZW50Q2hpbGQ7CgkJCQl9CgoJCQkJcmV0dXJuIGVsZW07CgkJCX0gKS5hcHBlbmQoIHRoaXMgKTsKCQl9CgoJCXJldHVybiB0aGlzOwoJfSwKCgl3cmFwSW5uZXI6IGZ1bmN0aW9uKCBodG1sICkgewoJCWlmICggalF1ZXJ5LmlzRnVuY3Rpb24oIGh0bWwgKSApIHsKCQkJcmV0dXJuIHRoaXMuZWFjaCggZnVuY3Rpb24oIGkgKSB7CgkJCQlqUXVlcnkoIHRoaXMgKS53cmFwSW5uZXIoIGh0bWwuY2FsbCggdGhpcywgaSApICk7CgkJCX0gKTsKCQl9CgoJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQl2YXIgc2VsZiA9IGpRdWVyeSggdGhpcyApLAoJCQkJY29udGVudHMgPSBzZWxmLmNvbnRlbnRzKCk7CgoJCQlpZiAoIGNvbnRlbnRzLmxlbmd0aCApIHsKCQkJCWNvbnRlbnRzLndyYXBBbGwoIGh0bWwgKTsKCgkJCX0gZWxzZSB7CgkJCQlzZWxmLmFwcGVuZCggaHRtbCApOwoJCQl9CgkJfSApOwoJfSwKCgl3cmFwOiBmdW5jdGlvbiggaHRtbCApIHsKCQl2YXIgaXNGdW5jdGlvbiA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBodG1sICk7CgoJCXJldHVybiB0aGlzLmVhY2goIGZ1bmN0aW9uKCBpICkgewoJCQlqUXVlcnkoIHRoaXMgKS53cmFwQWxsKCBpc0Z1bmN0aW9uID8gaHRtbC5jYWxsKCB0aGlzLCBpICkgOiBodG1sICk7CgkJfSApOwoJfSwKCgl1bndyYXA6IGZ1bmN0aW9uKCkgewoJCXJldHVybiB0aGlzLnBhcmVudCgpLmVhY2goIGZ1bmN0aW9uKCkgewoJCQlpZiAoICFqUXVlcnkubm9kZU5hbWUoIHRoaXMsICJib2R5IiApICkgewoJCQkJalF1ZXJ5KCB0aGlzICkucmVwbGFjZVdpdGgoIHRoaXMuY2hpbGROb2RlcyApOwoJCQl9CgkJfSApLmVuZCgpOwoJfQp9ICk7CgoKalF1ZXJ5LmV4cHIuZmlsdGVycy5oaWRkZW4gPSBmdW5jdGlvbiggZWxlbSApIHsKCXJldHVybiAhalF1ZXJ5LmV4cHIuZmlsdGVycy52aXNpYmxlKCBlbGVtICk7Cn07CmpRdWVyeS5leHByLmZpbHRlcnMudmlzaWJsZSA9IGZ1bmN0aW9uKCBlbGVtICkgewoKCS8vIFN1cHBvcnQ6IE9wZXJhIDw9IDEyLjEyCgkvLyBPcGVyYSByZXBvcnRzIG9mZnNldFdpZHRocyBhbmQgb2Zmc2V0SGVpZ2h0cyBsZXNzIHRoYW4gemVybyBvbiBzb21lIGVsZW1lbnRzCgkvLyBVc2UgT1IgaW5zdGVhZCBvZiBBTkQgYXMgdGhlIGVsZW1lbnQgaXMgbm90IHZpc2libGUgaWYgZWl0aGVyIGlzIHRydWUKCS8vIFNlZSB0aWNrZXRzICMxMDQwNiBhbmQgIzEzMTMyCglyZXR1cm4gZWxlbS5vZmZzZXRXaWR0aCA+IDAgfHwgZWxlbS5vZmZzZXRIZWlnaHQgPiAwIHx8IGVsZW0uZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggPiAwOwp9OwoKCgoKdmFyIHIyMCA9IC8lMjAvZywKCXJicmFja2V0ID0gL1xbXF0kLywKCXJDUkxGID0gL1xyP1xuL2csCglyc3VibWl0dGVyVHlwZXMgPSAvXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksCglyc3VibWl0dGFibGUgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxrZXlnZW4pL2k7CgpmdW5jdGlvbiBidWlsZFBhcmFtcyggcHJlZml4LCBvYmosIHRyYWRpdGlvbmFsLCBhZGQgKSB7Cgl2YXIgbmFtZTsKCglpZiAoIGpRdWVyeS5pc0FycmF5KCBvYmogKSApIHsKCgkJLy8gU2VyaWFsaXplIGFycmF5IGl0ZW0uCgkJalF1ZXJ5LmVhY2goIG9iaiwgZnVuY3Rpb24oIGksIHYgKSB7CgkJCWlmICggdHJhZGl0aW9uYWwgfHwgcmJyYWNrZXQudGVzdCggcHJlZml4ICkgKSB7CgoJCQkJLy8gVHJlYXQgZWFjaCBhcnJheSBpdGVtIGFzIGEgc2NhbGFyLgoJCQkJYWRkKCBwcmVmaXgsIHYgKTsKCgkJCX0gZWxzZSB7CgoJCQkJLy8gSXRlbSBpcyBub24tc2NhbGFyIChhcnJheSBvciBvYmplY3QpLCBlbmNvZGUgaXRzIG51bWVyaWMgaW5kZXguCgkJCQlidWlsZFBhcmFtcygKCQkJCQlwcmVmaXggKyAiWyIgKyAoIHR5cGVvZiB2ID09PSAib2JqZWN0IiAmJiB2ICE9IG51bGwgPyBpIDogIiIgKSArICJdIiwKCQkJCQl2LAoJCQkJCXRyYWRpdGlvbmFsLAoJCQkJCWFkZAoJCQkJKTsKCQkJfQoJCX0gKTsKCgl9IGVsc2UgaWYgKCAhdHJhZGl0aW9uYWwgJiYgalF1ZXJ5LnR5cGUoIG9iaiApID09PSAib2JqZWN0IiApIHsKCgkJLy8gU2VyaWFsaXplIG9iamVjdCBpdGVtLgoJCWZvciAoIG5hbWUgaW4gb2JqICkgewoJCQlidWlsZFBhcmFtcyggcHJlZml4ICsgIlsiICsgbmFtZSArICJdIiwgb2JqWyBuYW1lIF0sIHRyYWRpdGlvbmFsLCBhZGQgKTsKCQl9CgoJfSBlbHNlIHsKCgkJLy8gU2VyaWFsaXplIHNjYWxhciBpdGVtLgoJCWFkZCggcHJlZml4LCBvYmogKTsKCX0KfQoKLy8gU2VyaWFsaXplIGFuIGFycmF5IG9mIGZvcm0gZWxlbWVudHMgb3IgYSBzZXQgb2YKLy8ga2V5L3ZhbHVlcyBpbnRvIGEgcXVlcnkgc3RyaW5nCmpRdWVyeS5wYXJhbSA9IGZ1bmN0aW9uKCBhLCB0cmFkaXRpb25hbCApIHsKCXZhciBwcmVmaXgsCgkJcyA9IFtdLAoJCWFkZCA9IGZ1bmN0aW9uKCBrZXksIHZhbHVlICkgewoKCQkJLy8gSWYgdmFsdWUgaXMgYSBmdW5jdGlvbiwgaW52b2tlIGl0IGFuZCByZXR1cm4gaXRzIHZhbHVlCgkJCXZhbHVlID0galF1ZXJ5LmlzRnVuY3Rpb24oIHZhbHVlICkgPyB2YWx1ZSgpIDogKCB2YWx1ZSA9PSBudWxsID8gIiIgOiB2YWx1ZSApOwoJCQlzWyBzLmxlbmd0aCBdID0gZW5jb2RlVVJJQ29tcG9uZW50KCBrZXkgKSArICI9IiArIGVuY29kZVVSSUNvbXBvbmVudCggdmFsdWUgKTsKCQl9OwoKCS8vIFNldCB0cmFkaXRpb25hbCB0byB0cnVlIGZvciBqUXVlcnkgPD0gMS4zLjIgYmVoYXZpb3IuCglpZiAoIHRyYWRpdGlvbmFsID09PSB1bmRlZmluZWQgKSB7CgkJdHJhZGl0aW9uYWwgPSBqUXVlcnkuYWpheFNldHRpbmdzICYmIGpRdWVyeS5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWw7Cgl9CgoJLy8gSWYgYW4gYXJyYXkgd2FzIHBhc3NlZCBpbiwgYXNzdW1lIHRoYXQgaXQgaXMgYW4gYXJyYXkgb2YgZm9ybSBlbGVtZW50cy4KCWlmICggalF1ZXJ5LmlzQXJyYXkoIGEgKSB8fCAoIGEuanF1ZXJ5ICYmICFqUXVlcnkuaXNQbGFpbk9iamVjdCggYSApICkgKSB7CgoJCS8vIFNlcmlhbGl6ZSB0aGUgZm9ybSBlbGVtZW50cwoJCWpRdWVyeS5lYWNoKCBhLCBmdW5jdGlvbigpIHsKCQkJYWRkKCB0aGlzLm5hbWUsIHRoaXMudmFsdWUgKTsKCQl9ICk7CgoJfSBlbHNlIHsKCgkJLy8gSWYgdHJhZGl0aW9uYWwsIGVuY29kZSB0aGUgIm9sZCIgd2F5ICh0aGUgd2F5IDEuMy4yIG9yIG9sZGVyCgkJLy8gZGlkIGl0KSwgb3RoZXJ3aXNlIGVuY29kZSBwYXJhbXMgcmVjdXJzaXZlbHkuCgkJZm9yICggcHJlZml4IGluIGEgKSB7CgkJCWJ1aWxkUGFyYW1zKCBwcmVmaXgsIGFbIHByZWZpeCBdLCB0cmFkaXRpb25hbCwgYWRkICk7CgkJfQoJfQoKCS8vIFJldHVybiB0aGUgcmVzdWx0aW5nIHNlcmlhbGl6YXRpb24KCXJldHVybiBzLmpvaW4oICImIiApLnJlcGxhY2UoIHIyMCwgIisiICk7Cn07CgpqUXVlcnkuZm4uZXh0ZW5kKCB7CglzZXJpYWxpemU6IGZ1bmN0aW9uKCkgewoJCXJldHVybiBqUXVlcnkucGFyYW0oIHRoaXMuc2VyaWFsaXplQXJyYXkoKSApOwoJfSwKCXNlcmlhbGl6ZUFycmF5OiBmdW5jdGlvbigpIHsKCQlyZXR1cm4gdGhpcy5tYXAoIGZ1bmN0aW9uKCkgewoKCQkJLy8gQ2FuIGFkZCBwcm9wSG9vayBmb3IgImVsZW1lbnRzIiB0byBmaWx0ZXIgb3IgYWRkIGZvcm0gZWxlbWVudHMKCQkJdmFyIGVsZW1lbnRzID0galF1ZXJ5LnByb3AoIHRoaXMsICJlbGVtZW50cyIgKTsKCQkJcmV0dXJuIGVsZW1lbnRzID8galF1ZXJ5Lm1ha2VBcnJheSggZWxlbWVudHMgKSA6IHRoaXM7CgkJfSApCgkJLmZpbHRlciggZnVuY3Rpb24oKSB7CgkJCXZhciB0eXBlID0gdGhpcy50eXBlOwoKCQkJLy8gVXNlIC5pcyggIjpkaXNhYmxlZCIgKSBzbyB0aGF0IGZpZWxkc2V0W2Rpc2FibGVkXSB3b3JrcwoJCQlyZXR1cm4gdGhpcy5uYW1lICYmICFqUXVlcnkoIHRoaXMgKS5pcyggIjpkaXNhYmxlZCIgKSAmJgoJCQkJcnN1Ym1pdHRhYmxlLnRlc3QoIHRoaXMubm9kZU5hbWUgKSAmJiAhcnN1Ym1pdHRlclR5cGVzLnRlc3QoIHR5cGUgKSAmJgoJCQkJKCB0aGlzLmNoZWNrZWQgfHwgIXJjaGVja2FibGVUeXBlLnRlc3QoIHR5cGUgKSApOwoJCX0gKQoJCS5tYXAoIGZ1bmN0aW9uKCBpLCBlbGVtICkgewoJCQl2YXIgdmFsID0galF1ZXJ5KCB0aGlzICkudmFsKCk7CgoJCQlyZXR1cm4gdmFsID09IG51bGwgPwoJCQkJbnVsbCA6CgkJCQlqUXVlcnkuaXNBcnJheSggdmFsICkgPwoJCQkJCWpRdWVyeS5tYXAoIHZhbCwgZnVuY3Rpb24oIHZhbCApIHsKCQkJCQkJcmV0dXJuIHsgbmFtZTogZWxlbS5uYW1lLCB2YWx1ZTogdmFsLnJlcGxhY2UoIHJDUkxGLCAiXHJcbiIgKSB9OwoJCQkJCX0gKSA6CgkJCQkJeyBuYW1lOiBlbGVtLm5hbWUsIHZhbHVlOiB2YWwucmVwbGFjZSggckNSTEYsICJcclxuIiApIH07CgkJfSApLmdldCgpOwoJfQp9ICk7CgoKalF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIgPSBmdW5jdGlvbigpIHsKCXRyeSB7CgkJcmV0dXJuIG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTsKCX0gY2F0Y2ggKCBlICkge30KfTsKCnZhciB4aHJTdWNjZXNzU3RhdHVzID0gewoKCQkvLyBGaWxlIHByb3RvY29sIGFsd2F5cyB5aWVsZHMgc3RhdHVzIGNvZGUgMCwgYXNzdW1lIDIwMAoJCTA6IDIwMCwKCgkJLy8gU3VwcG9ydDogSUU5CgkJLy8gIzE0NTA6IHNvbWV0aW1lcyBJRSByZXR1cm5zIDEyMjMgd2hlbiBpdCBzaG91bGQgYmUgMjA0CgkJMTIyMzogMjA0Cgl9LAoJeGhyU3VwcG9ydGVkID0galF1ZXJ5LmFqYXhTZXR0aW5ncy54aHIoKTsKCnN1cHBvcnQuY29ycyA9ICEheGhyU3VwcG9ydGVkICYmICggIndpdGhDcmVkZW50aWFscyIgaW4geGhyU3VwcG9ydGVkICk7CnN1cHBvcnQuYWpheCA9IHhoclN1cHBvcnRlZCA9ICEheGhyU3VwcG9ydGVkOwoKalF1ZXJ5LmFqYXhUcmFuc3BvcnQoIGZ1bmN0aW9uKCBvcHRpb25zICkgewoJdmFyIGNhbGxiYWNrLCBlcnJvckNhbGxiYWNrOwoKCS8vIENyb3NzIGRvbWFpbiBvbmx5IGFsbG93ZWQgaWYgc3VwcG9ydGVkIHRocm91Z2ggWE1MSHR0cFJlcXVlc3QKCWlmICggc3VwcG9ydC5jb3JzIHx8IHhoclN1cHBvcnRlZCAmJiAhb3B0aW9ucy5jcm9zc0RvbWFpbiApIHsKCQlyZXR1cm4gewoJCQlzZW5kOiBmdW5jdGlvbiggaGVhZGVycywgY29tcGxldGUgKSB7CgkJCQl2YXIgaSwKCQkJCQl4aHIgPSBvcHRpb25zLnhocigpOwoKCQkJCXhoci5vcGVuKAoJCQkJCW9wdGlvbnMudHlwZSwKCQkJCQlvcHRpb25zLnVybCwKCQkJCQlvcHRpb25zLmFzeW5jLAoJCQkJCW9wdGlvbnMudXNlcm5hbWUsCgkJCQkJb3B0aW9ucy5wYXNzd29yZAoJCQkJKTsKCgkJCQkvLyBBcHBseSBjdXN0b20gZmllbGRzIGlmIHByb3ZpZGVkCgkJCQlpZiAoIG9wdGlvbnMueGhyRmllbGRzICkgewoJCQkJCWZvciAoIGkgaW4gb3B0aW9ucy54aHJGaWVsZHMgKSB7CgkJCQkJCXhoclsgaSBdID0gb3B0aW9ucy54aHJGaWVsZHNbIGkgXTsKCQkJCQl9CgkJCQl9CgoJCQkJLy8gT3ZlcnJpZGUgbWltZSB0eXBlIGlmIG5lZWRlZAoJCQkJaWYgKCBvcHRpb25zLm1pbWVUeXBlICYmIHhoci5vdmVycmlkZU1pbWVUeXBlICkgewoJCQkJCXhoci5vdmVycmlkZU1pbWVUeXBlKCBvcHRpb25zLm1pbWVUeXBlICk7CgkJCQl9CgoJCQkJLy8gWC1SZXF1ZXN0ZWQtV2l0aCBoZWFkZXIKCQkJCS8vIEZvciBjcm9zcy1kb21haW4gcmVxdWVzdHMsIHNlZWluZyBhcyBjb25kaXRpb25zIGZvciBhIHByZWZsaWdodCBhcmUKCQkJCS8vIGFraW4gdG8gYSBqaWdzYXcgcHV6emxlLCB3ZSBzaW1wbHkgbmV2ZXIgc2V0IGl0IHRvIGJlIHN1cmUuCgkJCQkvLyAoaXQgY2FuIGFsd2F5cyBiZSBzZXQgb24gYSBwZXItcmVxdWVzdCBiYXNpcyBvciBldmVuIHVzaW5nIGFqYXhTZXR1cCkKCQkJCS8vIEZvciBzYW1lLWRvbWFpbiByZXF1ZXN0cywgd29uJ3QgY2hhbmdlIGhlYWRlciBpZiBhbHJlYWR5IHByb3ZpZGVkLgoJCQkJaWYgKCAhb3B0aW9ucy5jcm9zc0RvbWFpbiAmJiAhaGVhZGVyc1sgIlgtUmVxdWVzdGVkLVdpdGgiIF0gKSB7CgkJCQkJaGVhZGVyc1sgIlgtUmVxdWVzdGVkLVdpdGgiIF0gPSAiWE1MSHR0cFJlcXVlc3QiOwoJCQkJfQoKCQkJCS8vIFNldCBoZWFkZXJzCgkJCQlmb3IgKCBpIGluIGhlYWRlcnMgKSB7CgkJCQkJeGhyLnNldFJlcXVlc3RIZWFkZXIoIGksIGhlYWRlcnNbIGkgXSApOwoJCQkJfQoKCQkJCS8vIENhbGxiYWNrCgkJCQljYWxsYmFjayA9IGZ1bmN0aW9uKCB0eXBlICkgewoJCQkJCXJldHVybiBmdW5jdGlvbigpIHsKCQkJCQkJaWYgKCBjYWxsYmFjayApIHsKCQkJCQkJCWNhbGxiYWNrID0gZXJyb3JDYWxsYmFjayA9IHhoci5vbmxvYWQgPQoJCQkJCQkJCXhoci5vbmVycm9yID0geGhyLm9uYWJvcnQgPSB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDsKCgkJCQkJCQlpZiAoIHR5cGUgPT09ICJhYm9ydCIgKSB7CgkJCQkJCQkJeGhyLmFib3J0KCk7CgkJCQkJCQl9IGVsc2UgaWYgKCB0eXBlID09PSAiZXJyb3IiICkgewoKCQkJCQkJCQkvLyBTdXBwb3J0OiBJRTkKCQkJCQkJCQkvLyBPbiBhIG1hbnVhbCBuYXRpdmUgYWJvcnQsIElFOSB0aHJvd3MKCQkJCQkJCQkvLyBlcnJvcnMgb24gYW55IHByb3BlcnR5IGFjY2VzcyB0aGF0IGlzIG5vdCByZWFkeVN0YXRlCgkJCQkJCQkJaWYgKCB0eXBlb2YgeGhyLnN0YXR1cyAhPT0gIm51bWJlciIgKSB7CgkJCQkJCQkJCWNvbXBsZXRlKCAwLCAiZXJyb3IiICk7CgkJCQkJCQkJfSBlbHNlIHsKCQkJCQkJCQkJY29tcGxldGUoCgoJCQkJCQkJCQkJLy8gRmlsZTogcHJvdG9jb2wgYWx3YXlzIHlpZWxkcyBzdGF0dXMgMDsgc2VlICM4NjA1LCAjMTQyMDcKCQkJCQkJCQkJCXhoci5zdGF0dXMsCgkJCQkJCQkJCQl4aHIuc3RhdHVzVGV4dAoJCQkJCQkJCQkpOwoJCQkJCQkJCX0KCQkJCQkJCX0gZWxzZSB7CgkJCQkJCQkJY29tcGxldGUoCgkJCQkJCQkJCXhoclN1Y2Nlc3NTdGF0dXNbIHhoci5zdGF0dXMgXSB8fCB4aHIuc3RhdHVzLAoJCQkJCQkJCQl4aHIuc3RhdHVzVGV4dCwKCgkJCQkJCQkJCS8vIFN1cHBvcnQ6IElFOSBvbmx5CgkJCQkJCQkJCS8vIElFOSBoYXMgbm8gWEhSMiBidXQgdGhyb3dzIG9uIGJpbmFyeSAodHJhYy0xMTQyNikKCQkJCQkJCQkJLy8gRm9yIFhIUjIgbm9uLXRleHQsIGxldCB0aGUgY2FsbGVyIGhhbmRsZSBpdCAoZ2gtMjQ5OCkKCQkJCQkJCQkJKCB4aHIucmVzcG9uc2VUeXBlIHx8ICJ0ZXh0IiApICE9PSAidGV4dCIgIHx8CgkJCQkJCQkJCXR5cGVvZiB4aHIucmVzcG9uc2VUZXh0ICE9PSAic3RyaW5nIiA/CgkJCQkJCQkJCQl7IGJpbmFyeTogeGhyLnJlc3BvbnNlIH0gOgoJCQkJCQkJCQkJeyB0ZXh0OiB4aHIucmVzcG9uc2VUZXh0IH0sCgkJCQkJCQkJCXhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKQoJCQkJCQkJCSk7CgkJCQkJCQl9CgkJCQkJCX0KCQkJCQl9OwoJCQkJfTsKCgkJCQkvLyBMaXN0ZW4gdG8gZXZlbnRzCgkJCQl4aHIub25sb2FkID0gY2FsbGJhY2soKTsKCQkJCWVycm9yQ2FsbGJhY2sgPSB4aHIub25lcnJvciA9IGNhbGxiYWNrKCAiZXJyb3IiICk7CgoJCQkJLy8gU3VwcG9ydDogSUU5CgkJCQkvLyBVc2Ugb25yZWFkeXN0YXRlY2hhbmdlIHRvIHJlcGxhY2Ugb25hYm9ydAoJCQkJLy8gdG8gaGFuZGxlIHVuY2F1Z2h0IGFib3J0cwoJCQkJaWYgKCB4aHIub25hYm9ydCAhPT0gdW5kZWZpbmVkICkgewoJCQkJCXhoci5vbmFib3J0ID0gZXJyb3JDYWxsYmFjazsKCQkJCX0gZWxzZSB7CgkJCQkJeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewoKCQkJCQkJLy8gQ2hlY2sgcmVhZHlTdGF0ZSBiZWZvcmUgdGltZW91dCBhcyBpdCBjaGFuZ2VzCgkJCQkJCWlmICggeGhyLnJlYWR5U3RhdGUgPT09IDQgKSB7CgoJCQkJCQkJLy8gQWxsb3cgb25lcnJvciB0byBiZSBjYWxsZWQgZmlyc3QsCgkJCQkJCQkvLyBidXQgdGhhdCB3aWxsIG5vdCBoYW5kbGUgYSBuYXRpdmUgYWJvcnQKCQkJCQkJCS8vIEFsc28sIHNhdmUgZXJyb3JDYWxsYmFjayB0byBhIHZhcmlhYmxlCgkJCQkJCQkvLyBhcyB4aHIub25lcnJvciBjYW5ub3QgYmUgYWNjZXNzZWQKCQkJCQkJCXdpbmRvdy5zZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsKCQkJCQkJCQlpZiAoIGNhbGxiYWNrICkgewoJCQkJCQkJCQllcnJvckNhbGxiYWNrKCk7CgkJCQkJCQkJfQoJCQkJCQkJfSApOwoJCQkJCQl9CgkJCQkJfTsKCQkJCX0KCgkJCQkvLyBDcmVhdGUgdGhlIGFib3J0IGNhbGxiYWNrCgkJCQljYWxsYmFjayA9IGNhbGxiYWNrKCAiYWJvcnQiICk7CgoJCQkJdHJ5IHsKCgkJCQkJLy8gRG8gc2VuZCB0aGUgcmVxdWVzdCAodGhpcyBtYXkgcmFpc2UgYW4gZXhjZXB0aW9uKQoJCQkJCXhoci5zZW5kKCBvcHRpb25zLmhhc0NvbnRlbnQgJiYgb3B0aW9ucy5kYXRhIHx8IG51bGwgKTsKCQkJCX0gY2F0Y2ggKCBlICkgewoKCQkJCQkvLyAjMTQ2ODM6IE9ubHkgcmV0aHJvdyBpZiB0aGlzIGhhc24ndCBiZWVuIG5vdGlmaWVkIGFzIGFuIGVycm9yIHlldAoJCQkJCWlmICggY2FsbGJhY2sgKSB7CgkJCQkJCXRocm93IGU7CgkJCQkJfQoJCQkJfQoJCQl9LAoKCQkJYWJvcnQ6IGZ1bmN0aW9uKCkgewoJCQkJaWYgKCBjYWxsYmFjayApIHsKCQkJCQljYWxsYmFjaygpOwoJCQkJfQoJCQl9CgkJfTsKCX0KfSApOwoKCgoKLy8gSW5zdGFsbCBzY3JpcHQgZGF0YVR5cGUKalF1ZXJ5LmFqYXhTZXR1cCggewoJYWNjZXB0czogewoJCXNjcmlwdDogInRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCwgIiArCgkJCSJhcHBsaWNhdGlvbi9lY21hc2NyaXB0LCBhcHBsaWNhdGlvbi94LWVjbWFzY3JpcHQiCgl9LAoJY29udGVudHM6IHsKCQlzY3JpcHQ6IC9cYig/OmphdmF8ZWNtYSlzY3JpcHRcYi8KCX0sCgljb252ZXJ0ZXJzOiB7CgkJInRleHQgc2NyaXB0IjogZnVuY3Rpb24oIHRleHQgKSB7CgkJCWpRdWVyeS5nbG9iYWxFdmFsKCB0ZXh0ICk7CgkJCXJldHVybiB0ZXh0OwoJCX0KCX0KfSApOwoKLy8gSGFuZGxlIGNhY2hlJ3Mgc3BlY2lhbCBjYXNlIGFuZCBjcm9zc0RvbWFpbgpqUXVlcnkuYWpheFByZWZpbHRlciggInNjcmlwdCIsIGZ1bmN0aW9uKCBzICkgewoJaWYgKCBzLmNhY2hlID09PSB1bmRlZmluZWQgKSB7CgkJcy5jYWNoZSA9IGZhbHNlOwoJfQoJaWYgKCBzLmNyb3NzRG9tYWluICkgewoJCXMudHlwZSA9ICJHRVQiOwoJfQp9ICk7CgovLyBCaW5kIHNjcmlwdCB0YWcgaGFjayB0cmFuc3BvcnQKalF1ZXJ5LmFqYXhUcmFuc3BvcnQoICJzY3JpcHQiLCBmdW5jdGlvbiggcyApIHsKCgkvLyBUaGlzIHRyYW5zcG9ydCBvbmx5IGRlYWxzIHdpdGggY3Jvc3MgZG9tYWluIHJlcXVlc3RzCglpZiAoIHMuY3Jvc3NEb21haW4gKSB7CgkJdmFyIHNjcmlwdCwgY2FsbGJhY2s7CgkJcmV0dXJuIHsKCQkJc2VuZDogZnVuY3Rpb24oIF8sIGNvbXBsZXRlICkgewoJCQkJc2NyaXB0ID0galF1ZXJ5KCAiPHNjcmlwdD4iICkucHJvcCggewoJCQkJCWNoYXJzZXQ6IHMuc2NyaXB0Q2hhcnNldCwKCQkJCQlzcmM6IHMudXJsCgkJCQl9ICkub24oCgkJCQkJImxvYWQgZXJyb3IiLAoJCQkJCWNhbGxiYWNrID0gZnVuY3Rpb24oIGV2dCApIHsKCQkJCQkJc2NyaXB0LnJlbW92ZSgpOwoJCQkJCQljYWxsYmFjayA9IG51bGw7CgkJCQkJCWlmICggZXZ0ICkgewoJCQkJCQkJY29tcGxldGUoIGV2dC50eXBlID09PSAiZXJyb3IiID8gNDA0IDogMjAwLCBldnQudHlwZSApOwoJCQkJCQl9CgkJCQkJfQoJCQkJKTsKCgkJCQkvLyBVc2UgbmF0aXZlIERPTSBtYW5pcHVsYXRpb24gdG8gYXZvaWQgb3VyIGRvbU1hbmlwIEFKQVggdHJpY2tlcnkKCQkJCWRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoIHNjcmlwdFsgMCBdICk7CgkJCX0sCgkJCWFib3J0OiBmdW5jdGlvbigpIHsKCQkJCWlmICggY2FsbGJhY2sgKSB7CgkJCQkJY2FsbGJhY2soKTsKCQkJCX0KCQkJfQoJCX07Cgl9Cn0gKTsKCgoKCnZhciBvbGRDYWxsYmFja3MgPSBbXSwKCXJqc29ucCA9IC8oPSlcPyg/PSZ8JCl8XD9cPy87CgovLyBEZWZhdWx0IGpzb25wIHNldHRpbmdzCmpRdWVyeS5hamF4U2V0dXAoIHsKCWpzb25wOiAiY2FsbGJhY2siLAoJanNvbnBDYWxsYmFjazogZnVuY3Rpb24oKSB7CgkJdmFyIGNhbGxiYWNrID0gb2xkQ2FsbGJhY2tzLnBvcCgpIHx8ICggalF1ZXJ5LmV4cGFuZG8gKyAiXyIgKyAoIG5vbmNlKysgKSApOwoJCXRoaXNbIGNhbGxiYWNrIF0gPSB0cnVlOwoJCXJldHVybiBjYWxsYmFjazsKCX0KfSApOwoKLy8gRGV0ZWN0LCBub3JtYWxpemUgb3B0aW9ucyBhbmQgaW5zdGFsbCBjYWxsYmFja3MgZm9yIGpzb25wIHJlcXVlc3RzCmpRdWVyeS5hamF4UHJlZmlsdGVyKCAianNvbiBqc29ucCIsIGZ1bmN0aW9uKCBzLCBvcmlnaW5hbFNldHRpbmdzLCBqcVhIUiApIHsKCgl2YXIgY2FsbGJhY2tOYW1lLCBvdmVyd3JpdHRlbiwgcmVzcG9uc2VDb250YWluZXIsCgkJanNvblByb3AgPSBzLmpzb25wICE9PSBmYWxzZSAmJiAoIHJqc29ucC50ZXN0KCBzLnVybCApID8KCQkJInVybCIgOgoJCQl0eXBlb2Ygcy5kYXRhID09PSAic3RyaW5nIiAmJgoJCQkJKCBzLmNvbnRlbnRUeXBlIHx8ICIiICkKCQkJCQkuaW5kZXhPZiggImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIgKSA9PT0gMCAmJgoJCQkJcmpzb25wLnRlc3QoIHMuZGF0YSApICYmICJkYXRhIgoJCSk7CgoJLy8gSGFuZGxlIGlmZiB0aGUgZXhwZWN0ZWQgZGF0YSB0eXBlIGlzICJqc29ucCIgb3Igd2UgaGF2ZSBhIHBhcmFtZXRlciB0byBzZXQKCWlmICgganNvblByb3AgfHwgcy5kYXRhVHlwZXNbIDAgXSA9PT0gImpzb25wIiApIHsKCgkJLy8gR2V0IGNhbGxiYWNrIG5hbWUsIHJlbWVtYmVyaW5nIHByZWV4aXN0aW5nIHZhbHVlIGFzc29jaWF0ZWQgd2l0aCBpdAoJCWNhbGxiYWNrTmFtZSA9IHMuanNvbnBDYWxsYmFjayA9IGpRdWVyeS5pc0Z1bmN0aW9uKCBzLmpzb25wQ2FsbGJhY2sgKSA/CgkJCXMuanNvbnBDYWxsYmFjaygpIDoKCQkJcy5qc29ucENhbGxiYWNrOwoKCQkvLyBJbnNlcnQgY2FsbGJhY2sgaW50byB1cmwgb3IgZm9ybSBkYXRhCgkJaWYgKCBqc29uUHJvcCApIHsKCQkJc1sganNvblByb3AgXSA9IHNbIGpzb25Qcm9wIF0ucmVwbGFjZSggcmpzb25wLCAiJDEiICsgY2FsbGJhY2tOYW1lICk7CgkJfSBlbHNlIGlmICggcy5qc29ucCAhPT0gZmFsc2UgKSB7CgkJCXMudXJsICs9ICggcnF1ZXJ5LnRlc3QoIHMudXJsICkgPyAiJiIgOiAiPyIgKSArIHMuanNvbnAgKyAiPSIgKyBjYWxsYmFja05hbWU7CgkJfQoKCQkvLyBVc2UgZGF0YSBjb252ZXJ0ZXIgdG8gcmV0cmlldmUganNvbiBhZnRlciBzY3JpcHQgZXhlY3V0aW9uCgkJcy5jb252ZXJ0ZXJzWyAic2NyaXB0IGpzb24iIF0gPSBmdW5jdGlvbigpIHsKCQkJaWYgKCAhcmVzcG9uc2VDb250YWluZXIgKSB7CgkJCQlqUXVlcnkuZXJyb3IoIGNhbGxiYWNrTmFtZSArICIgd2FzIG5vdCBjYWxsZWQiICk7CgkJCX0KCQkJcmV0dXJuIHJlc3BvbnNlQ29udGFpbmVyWyAwIF07CgkJfTsKCgkJLy8gRm9yY2UganNvbiBkYXRhVHlwZQoJCXMuZGF0YVR5cGVzWyAwIF0gPSAianNvbiI7CgoJCS8vIEluc3RhbGwgY2FsbGJhY2sKCQlvdmVyd3JpdHRlbiA9IHdpbmRvd1sgY2FsbGJhY2tOYW1lIF07CgkJd2luZG93WyBjYWxsYmFja05hbWUgXSA9IGZ1bmN0aW9uKCkgewoJCQlyZXNwb25zZUNvbnRhaW5lciA9IGFyZ3VtZW50czsKCQl9OwoKCQkvLyBDbGVhbi11cCBmdW5jdGlvbiAoZmlyZXMgYWZ0ZXIgY29udmVydGVycykKCQlqcVhIUi5hbHdheXMoIGZ1bmN0aW9uKCkgewoKCQkJLy8gSWYgcHJldmlvdXMgdmFsdWUgZGlkbid0IGV4aXN0IC0gcmVtb3ZlIGl0CgkJCWlmICggb3ZlcndyaXR0ZW4gPT09IHVuZGVmaW5lZCApIHsKCQkJCWpRdWVyeSggd2luZG93ICkucmVtb3ZlUHJvcCggY2FsbGJhY2tOYW1lICk7CgoJCQkvLyBPdGhlcndpc2UgcmVzdG9yZSBwcmVleGlzdGluZyB2YWx1ZQoJCQl9IGVsc2UgewoJCQkJd2luZG93WyBjYWxsYmFja05hbWUgXSA9IG92ZXJ3cml0dGVuOwoJCQl9CgoJCQkvLyBTYXZlIGJhY2sgYXMgZnJlZQoJCQlpZiAoIHNbIGNhbGxiYWNrTmFtZSBdICkgewoKCQkJCS8vIE1ha2Ugc3VyZSB0aGF0IHJlLXVzaW5nIHRoZSBvcHRpb25zIGRvZXNuJ3Qgc2NyZXcgdGhpbmdzIGFyb3VuZAoJCQkJcy5qc29ucENhbGxiYWNrID0gb3JpZ2luYWxTZXR0aW5ncy5qc29ucENhbGxiYWNrOwoKCQkJCS8vIFNhdmUgdGhlIGNhbGxiYWNrIG5hbWUgZm9yIGZ1dHVyZSB1c2UKCQkJCW9sZENhbGxiYWNrcy5wdXNoKCBjYWxsYmFja05hbWUgKTsKCQkJfQoKCQkJLy8gQ2FsbCBpZiBpdCB3YXMgYSBmdW5jdGlvbiBhbmQgd2UgaGF2ZSBhIHJlc3BvbnNlCgkJCWlmICggcmVzcG9uc2VDb250YWluZXIgJiYgalF1ZXJ5LmlzRnVuY3Rpb24oIG92ZXJ3cml0dGVuICkgKSB7CgkJCQlvdmVyd3JpdHRlbiggcmVzcG9uc2VDb250YWluZXJbIDAgXSApOwoJCQl9CgoJCQlyZXNwb25zZUNvbnRhaW5lciA9IG92ZXJ3cml0dGVuID0gdW5kZWZpbmVkOwoJCX0gKTsKCgkJLy8gRGVsZWdhdGUgdG8gc2NyaXB0CgkJcmV0dXJuICJzY3JpcHQiOwoJfQp9ICk7CgoKCgovLyBTdXBwb3J0OiBTYWZhcmkgOCsKLy8gSW4gU2FmYXJpIDggZG9jdW1lbnRzIGNyZWF0ZWQgdmlhIGRvY3VtZW50LmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudAovLyBjb2xsYXBzZSBzaWJsaW5nIGZvcm1zOiB0aGUgc2Vjb25kIG9uZSBiZWNvbWVzIGEgY2hpbGQgb2YgdGhlIGZpcnN0IG9uZS4KLy8gQmVjYXVzZSBvZiB0aGF0LCB0aGlzIHNlY3VyaXR5IG1lYXN1cmUgaGFzIHRvIGJlIGRpc2FibGVkIGluIFNhZmFyaSA4LgovLyBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTM3MzM3CnN1cHBvcnQuY3JlYXRlSFRNTERvY3VtZW50ID0gKCBmdW5jdGlvbigpIHsKCXZhciBib2R5ID0gZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KCAiIiApLmJvZHk7Cglib2R5LmlubmVySFRNTCA9ICI8Zm9ybT48L2Zvcm0+PGZvcm0+PC9mb3JtPiI7CglyZXR1cm4gYm9keS5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMjsKfSApKCk7CgoKLy8gQXJndW1lbnQgImRhdGEiIHNob3VsZCBiZSBzdHJpbmcgb2YgaHRtbAovLyBjb250ZXh0IChvcHRpb25hbCk6IElmIHNwZWNpZmllZCwgdGhlIGZyYWdtZW50IHdpbGwgYmUgY3JlYXRlZCBpbiB0aGlzIGNvbnRleHQsCi8vIGRlZmF1bHRzIHRvIGRvY3VtZW50Ci8vIGtlZXBTY3JpcHRzIChvcHRpb25hbCk6IElmIHRydWUsIHdpbGwgaW5jbHVkZSBzY3JpcHRzIHBhc3NlZCBpbiB0aGUgaHRtbCBzdHJpbmcKalF1ZXJ5LnBhcnNlSFRNTCA9IGZ1bmN0aW9uKCBkYXRhLCBjb250ZXh0LCBrZWVwU2NyaXB0cyApIHsKCWlmICggIWRhdGEgfHwgdHlwZW9mIGRhdGEgIT09ICJzdHJpbmciICkgewoJCXJldHVybiBudWxsOwoJfQoJaWYgKCB0eXBlb2YgY29udGV4dCA9PT0gImJvb2xlYW4iICkgewoJCWtlZXBTY3JpcHRzID0gY29udGV4dDsKCQljb250ZXh0ID0gZmFsc2U7Cgl9CgoJLy8gU3RvcCBzY3JpcHRzIG9yIGlubGluZSBldmVudCBoYW5kbGVycyBmcm9tIGJlaW5nIGV4ZWN1dGVkIGltbWVkaWF0ZWx5CgkvLyBieSB1c2luZyBkb2N1bWVudC5pbXBsZW1lbnRhdGlvbgoJY29udGV4dCA9IGNvbnRleHQgfHwgKCBzdXBwb3J0LmNyZWF0ZUhUTUxEb2N1bWVudCA/CgkJZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KCAiIiApIDoKCQlkb2N1bWVudCApOwoKCXZhciBwYXJzZWQgPSByc2luZ2xlVGFnLmV4ZWMoIGRhdGEgKSwKCQlzY3JpcHRzID0gIWtlZXBTY3JpcHRzICYmIFtdOwoKCS8vIFNpbmdsZSB0YWcKCWlmICggcGFyc2VkICkgewoJCXJldHVybiBbIGNvbnRleHQuY3JlYXRlRWxlbWVudCggcGFyc2VkWyAxIF0gKSBdOwoJfQoKCXBhcnNlZCA9IGJ1aWxkRnJhZ21lbnQoIFsgZGF0YSBdLCBjb250ZXh0LCBzY3JpcHRzICk7CgoJaWYgKCBzY3JpcHRzICYmIHNjcmlwdHMubGVuZ3RoICkgewoJCWpRdWVyeSggc2NyaXB0cyApLnJlbW92ZSgpOwoJfQoKCXJldHVybiBqUXVlcnkubWVyZ2UoIFtdLCBwYXJzZWQuY2hpbGROb2RlcyApOwp9OwoKCi8vIEtlZXAgYSBjb3B5IG9mIHRoZSBvbGQgbG9hZCBtZXRob2QKdmFyIF9sb2FkID0galF1ZXJ5LmZuLmxvYWQ7CgovKioKICogTG9hZCBhIHVybCBpbnRvIGEgcGFnZQogKi8KalF1ZXJ5LmZuLmxvYWQgPSBmdW5jdGlvbiggdXJsLCBwYXJhbXMsIGNhbGxiYWNrICkgewoJaWYgKCB0eXBlb2YgdXJsICE9PSAic3RyaW5nIiAmJiBfbG9hZCApIHsKCQlyZXR1cm4gX2xvYWQuYXBwbHkoIHRoaXMsIGFyZ3VtZW50cyApOwoJfQoKCXZhciBzZWxlY3RvciwgdHlwZSwgcmVzcG9uc2UsCgkJc2VsZiA9IHRoaXMsCgkJb2ZmID0gdXJsLmluZGV4T2YoICIgIiApOwoKCWlmICggb2ZmID4gLTEgKSB7CgkJc2VsZWN0b3IgPSBqUXVlcnkudHJpbSggdXJsLnNsaWNlKCBvZmYgKSApOwoJCXVybCA9IHVybC5zbGljZSggMCwgb2ZmICk7Cgl9CgoJLy8gSWYgaXQncyBhIGZ1bmN0aW9uCglpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBwYXJhbXMgKSApIHsKCgkJLy8gV2UgYXNzdW1lIHRoYXQgaXQncyB0aGUgY2FsbGJhY2sKCQljYWxsYmFjayA9IHBhcmFtczsKCQlwYXJhbXMgPSB1bmRlZmluZWQ7CgoJLy8gT3RoZXJ3aXNlLCBidWlsZCBhIHBhcmFtIHN0cmluZwoJfSBlbHNlIGlmICggcGFyYW1zICYmIHR5cGVvZiBwYXJhbXMgPT09ICJvYmplY3QiICkgewoJCXR5cGUgPSAiUE9TVCI7Cgl9CgoJLy8gSWYgd2UgaGF2ZSBlbGVtZW50cyB0byBtb2RpZnksIG1ha2UgdGhlIHJlcXVlc3QKCWlmICggc2VsZi5sZW5ndGggPiAwICkgewoJCWpRdWVyeS5hamF4KCB7CgkJCXVybDogdXJsLAoKCQkJLy8gSWYgInR5cGUiIHZhcmlhYmxlIGlzIHVuZGVmaW5lZCwgdGhlbiAiR0VUIiBtZXRob2Qgd2lsbCBiZSB1c2VkLgoJCQkvLyBNYWtlIHZhbHVlIG9mIHRoaXMgZmllbGQgZXhwbGljaXQgc2luY2UKCQkJLy8gdXNlciBjYW4gb3ZlcnJpZGUgaXQgdGhyb3VnaCBhamF4U2V0dXAgbWV0aG9kCgkJCXR5cGU6IHR5cGUgfHwgIkdFVCIsCgkJCWRhdGFUeXBlOiAiaHRtbCIsCgkJCWRhdGE6IHBhcmFtcwoJCX0gKS5kb25lKCBmdW5jdGlvbiggcmVzcG9uc2VUZXh0ICkgewoKCQkJLy8gU2F2ZSByZXNwb25zZSBmb3IgdXNlIGluIGNvbXBsZXRlIGNhbGxiYWNrCgkJCXJlc3BvbnNlID0gYXJndW1lbnRzOwoKCQkJc2VsZi5odG1sKCBzZWxlY3RvciA/CgoJCQkJLy8gSWYgYSBzZWxlY3RvciB3YXMgc3BlY2lmaWVkLCBsb2NhdGUgdGhlIHJpZ2h0IGVsZW1lbnRzIGluIGEgZHVtbXkgZGl2CgkJCQkvLyBFeGNsdWRlIHNjcmlwdHMgdG8gYXZvaWQgSUUgJ1Blcm1pc3Npb24gRGVuaWVkJyBlcnJvcnMKCQkJCWpRdWVyeSggIjxkaXY+IiApLmFwcGVuZCggalF1ZXJ5LnBhcnNlSFRNTCggcmVzcG9uc2VUZXh0ICkgKS5maW5kKCBzZWxlY3RvciApIDoKCgkJCQkvLyBPdGhlcndpc2UgdXNlIHRoZSBmdWxsIHJlc3VsdAoJCQkJcmVzcG9uc2VUZXh0ICk7CgoJCS8vIElmIHRoZSByZXF1ZXN0IHN1Y2NlZWRzLCB0aGlzIGZ1bmN0aW9uIGdldHMgImRhdGEiLCAic3RhdHVzIiwgImpxWEhSIgoJCS8vIGJ1dCB0aGV5IGFyZSBpZ25vcmVkIGJlY2F1c2UgcmVzcG9uc2Ugd2FzIHNldCBhYm92ZS4KCQkvLyBJZiBpdCBmYWlscywgdGhpcyBmdW5jdGlvbiBnZXRzICJqcVhIUiIsICJzdGF0dXMiLCAiZXJyb3IiCgkJfSApLmFsd2F5cyggY2FsbGJhY2sgJiYgZnVuY3Rpb24oIGpxWEhSLCBzdGF0dXMgKSB7CgkJCXNlbGYuZWFjaCggZnVuY3Rpb24oKSB7CgkJCQljYWxsYmFjay5hcHBseSggc2VsZiwgcmVzcG9uc2UgfHwgWyBqcVhIUi5yZXNwb25zZVRleHQsIHN0YXR1cywganFYSFIgXSApOwoJCQl9ICk7CgkJfSApOwoJfQoKCXJldHVybiB0aGlzOwp9OwoKCgoKLy8gQXR0YWNoIGEgYnVuY2ggb2YgZnVuY3Rpb25zIGZvciBoYW5kbGluZyBjb21tb24gQUpBWCBldmVudHMKalF1ZXJ5LmVhY2goIFsKCSJhamF4U3RhcnQiLAoJImFqYXhTdG9wIiwKCSJhamF4Q29tcGxldGUiLAoJImFqYXhFcnJvciIsCgkiYWpheFN1Y2Nlc3MiLAoJImFqYXhTZW5kIgpdLCBmdW5jdGlvbiggaSwgdHlwZSApIHsKCWpRdWVyeS5mblsgdHlwZSBdID0gZnVuY3Rpb24oIGZuICkgewoJCXJldHVybiB0aGlzLm9uKCB0eXBlLCBmbiApOwoJfTsKfSApOwoKCgoKalF1ZXJ5LmV4cHIuZmlsdGVycy5hbmltYXRlZCA9IGZ1bmN0aW9uKCBlbGVtICkgewoJcmV0dXJuIGpRdWVyeS5ncmVwKCBqUXVlcnkudGltZXJzLCBmdW5jdGlvbiggZm4gKSB7CgkJcmV0dXJuIGVsZW0gPT09IGZuLmVsZW07Cgl9ICkubGVuZ3RoOwp9OwoKCgoKLyoqCiAqIEdldHMgYSB3aW5kb3cgZnJvbSBhbiBlbGVtZW50CiAqLwpmdW5jdGlvbiBnZXRXaW5kb3coIGVsZW0gKSB7CglyZXR1cm4galF1ZXJ5LmlzV2luZG93KCBlbGVtICkgPyBlbGVtIDogZWxlbS5ub2RlVHlwZSA9PT0gOSAmJiBlbGVtLmRlZmF1bHRWaWV3Owp9CgpqUXVlcnkub2Zmc2V0ID0gewoJc2V0T2Zmc2V0OiBmdW5jdGlvbiggZWxlbSwgb3B0aW9ucywgaSApIHsKCQl2YXIgY3VyUG9zaXRpb24sIGN1ckxlZnQsIGN1ckNTU1RvcCwgY3VyVG9wLCBjdXJPZmZzZXQsIGN1ckNTU0xlZnQsIGNhbGN1bGF0ZVBvc2l0aW9uLAoJCQlwb3NpdGlvbiA9IGpRdWVyeS5jc3MoIGVsZW0sICJwb3NpdGlvbiIgKSwKCQkJY3VyRWxlbSA9IGpRdWVyeSggZWxlbSApLAoJCQlwcm9wcyA9IHt9OwoKCQkvLyBTZXQgcG9zaXRpb24gZmlyc3QsIGluLWNhc2UgdG9wL2xlZnQgYXJlIHNldCBldmVuIG9uIHN0YXRpYyBlbGVtCgkJaWYgKCBwb3NpdGlvbiA9PT0gInN0YXRpYyIgKSB7CgkJCWVsZW0uc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiOwoJCX0KCgkJY3VyT2Zmc2V0ID0gY3VyRWxlbS5vZmZzZXQoKTsKCQljdXJDU1NUb3AgPSBqUXVlcnkuY3NzKCBlbGVtLCAidG9wIiApOwoJCWN1ckNTU0xlZnQgPSBqUXVlcnkuY3NzKCBlbGVtLCAibGVmdCIgKTsKCQljYWxjdWxhdGVQb3NpdGlvbiA9ICggcG9zaXRpb24gPT09ICJhYnNvbHV0ZSIgfHwgcG9zaXRpb24gPT09ICJmaXhlZCIgKSAmJgoJCQkoIGN1ckNTU1RvcCArIGN1ckNTU0xlZnQgKS5pbmRleE9mKCAiYXV0byIgKSA+IC0xOwoKCQkvLyBOZWVkIHRvIGJlIGFibGUgdG8gY2FsY3VsYXRlIHBvc2l0aW9uIGlmIGVpdGhlcgoJCS8vIHRvcCBvciBsZWZ0IGlzIGF1dG8gYW5kIHBvc2l0aW9uIGlzIGVpdGhlciBhYnNvbHV0ZSBvciBmaXhlZAoJCWlmICggY2FsY3VsYXRlUG9zaXRpb24gKSB7CgkJCWN1clBvc2l0aW9uID0gY3VyRWxlbS5wb3NpdGlvbigpOwoJCQljdXJUb3AgPSBjdXJQb3NpdGlvbi50b3A7CgkJCWN1ckxlZnQgPSBjdXJQb3NpdGlvbi5sZWZ0OwoKCQl9IGVsc2UgewoJCQljdXJUb3AgPSBwYXJzZUZsb2F0KCBjdXJDU1NUb3AgKSB8fCAwOwoJCQljdXJMZWZ0ID0gcGFyc2VGbG9hdCggY3VyQ1NTTGVmdCApIHx8IDA7CgkJfQoKCQlpZiAoIGpRdWVyeS5pc0Z1bmN0aW9uKCBvcHRpb25zICkgKSB7CgoJCQkvLyBVc2UgalF1ZXJ5LmV4dGVuZCBoZXJlIHRvIGFsbG93IG1vZGlmaWNhdGlvbiBvZiBjb29yZGluYXRlcyBhcmd1bWVudCAoZ2gtMTg0OCkKCQkJb3B0aW9ucyA9IG9wdGlvbnMuY2FsbCggZWxlbSwgaSwgalF1ZXJ5LmV4dGVuZCgge30sIGN1ck9mZnNldCApICk7CgkJfQoKCQlpZiAoIG9wdGlvbnMudG9wICE9IG51bGwgKSB7CgkJCXByb3BzLnRvcCA9ICggb3B0aW9ucy50b3AgLSBjdXJPZmZzZXQudG9wICkgKyBjdXJUb3A7CgkJfQoJCWlmICggb3B0aW9ucy5sZWZ0ICE9IG51bGwgKSB7CgkJCXByb3BzLmxlZnQgPSAoIG9wdGlvbnMubGVmdCAtIGN1ck9mZnNldC5sZWZ0ICkgKyBjdXJMZWZ0OwoJCX0KCgkJaWYgKCAidXNpbmciIGluIG9wdGlvbnMgKSB7CgkJCW9wdGlvbnMudXNpbmcuY2FsbCggZWxlbSwgcHJvcHMgKTsKCgkJfSBlbHNlIHsKCQkJY3VyRWxlbS5jc3MoIHByb3BzICk7CgkJfQoJfQp9OwoKalF1ZXJ5LmZuLmV4dGVuZCggewoJb2Zmc2V0OiBmdW5jdGlvbiggb3B0aW9ucyApIHsKCQlpZiAoIGFyZ3VtZW50cy5sZW5ndGggKSB7CgkJCXJldHVybiBvcHRpb25zID09PSB1bmRlZmluZWQgPwoJCQkJdGhpcyA6CgkJCQl0aGlzLmVhY2goIGZ1bmN0aW9uKCBpICkgewoJCQkJCWpRdWVyeS5vZmZzZXQuc2V0T2Zmc2V0KCB0aGlzLCBvcHRpb25zLCBpICk7CgkJCQl9ICk7CgkJfQoKCQl2YXIgZG9jRWxlbSwgd2luLAoJCQllbGVtID0gdGhpc1sgMCBdLAoJCQlib3ggPSB7IHRvcDogMCwgbGVmdDogMCB9LAoJCQlkb2MgPSBlbGVtICYmIGVsZW0ub3duZXJEb2N1bWVudDsKCgkJaWYgKCAhZG9jICkgewoJCQlyZXR1cm47CgkJfQoKCQlkb2NFbGVtID0gZG9jLmRvY3VtZW50RWxlbWVudDsKCgkJLy8gTWFrZSBzdXJlIGl0J3Mgbm90IGEgZGlzY29ubmVjdGVkIERPTSBub2RlCgkJaWYgKCAhalF1ZXJ5LmNvbnRhaW5zKCBkb2NFbGVtLCBlbGVtICkgKSB7CgkJCXJldHVybiBib3g7CgkJfQoKCQlib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwoJCXdpbiA9IGdldFdpbmRvdyggZG9jICk7CgkJcmV0dXJuIHsKCQkJdG9wOiBib3gudG9wICsgd2luLnBhZ2VZT2Zmc2V0IC0gZG9jRWxlbS5jbGllbnRUb3AsCgkJCWxlZnQ6IGJveC5sZWZ0ICsgd2luLnBhZ2VYT2Zmc2V0IC0gZG9jRWxlbS5jbGllbnRMZWZ0CgkJfTsKCX0sCgoJcG9zaXRpb246IGZ1bmN0aW9uKCkgewoJCWlmICggIXRoaXNbIDAgXSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdmFyIG9mZnNldFBhcmVudCwgb2Zmc2V0LAoJCQllbGVtID0gdGhpc1sgMCBdLAoJCQlwYXJlbnRPZmZzZXQgPSB7IHRvcDogMCwgbGVmdDogMCB9OwoKCQkvLyBGaXhlZCBlbGVtZW50cyBhcmUgb2Zmc2V0IGZyb20gd2luZG93IChwYXJlbnRPZmZzZXQgPSB7dG9wOjAsIGxlZnQ6IDB9LAoJCS8vIGJlY2F1c2UgaXQgaXMgaXRzIG9ubHkgb2Zmc2V0IHBhcmVudAoJCWlmICggalF1ZXJ5LmNzcyggZWxlbSwgInBvc2l0aW9uIiApID09PSAiZml4ZWQiICkgewoKCQkJLy8gQXNzdW1lIGdldEJvdW5kaW5nQ2xpZW50UmVjdCBpcyB0aGVyZSB3aGVuIGNvbXB1dGVkIHBvc2l0aW9uIGlzIGZpeGVkCgkJCW9mZnNldCA9IGVsZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CgoJCX0gZWxzZSB7CgoJCQkvLyBHZXQgKnJlYWwqIG9mZnNldFBhcmVudAoJCQlvZmZzZXRQYXJlbnQgPSB0aGlzLm9mZnNldFBhcmVudCgpOwoKCQkJLy8gR2V0IGNvcnJlY3Qgb2Zmc2V0cwoJCQlvZmZzZXQgPSB0aGlzLm9mZnNldCgpOwoJCQlpZiAoICFqUXVlcnkubm9kZU5hbWUoIG9mZnNldFBhcmVudFsgMCBdLCAiaHRtbCIgKSApIHsKCQkJCXBhcmVudE9mZnNldCA9IG9mZnNldFBhcmVudC5vZmZzZXQoKTsKCQkJfQoKCQkJLy8gQWRkIG9mZnNldFBhcmVudCBib3JkZXJzCgkJCXBhcmVudE9mZnNldC50b3AgKz0galF1ZXJ5LmNzcyggb2Zmc2V0UGFyZW50WyAwIF0sICJib3JkZXJUb3BXaWR0aCIsIHRydWUgKTsKCQkJcGFyZW50T2Zmc2V0LmxlZnQgKz0galF1ZXJ5LmNzcyggb2Zmc2V0UGFyZW50WyAwIF0sICJib3JkZXJMZWZ0V2lkdGgiLCB0cnVlICk7CgkJfQoKCQkvLyBTdWJ0cmFjdCBwYXJlbnQgb2Zmc2V0cyBhbmQgZWxlbWVudCBtYXJnaW5zCgkJcmV0dXJuIHsKCQkJdG9wOiBvZmZzZXQudG9wIC0gcGFyZW50T2Zmc2V0LnRvcCAtIGpRdWVyeS5jc3MoIGVsZW0sICJtYXJnaW5Ub3AiLCB0cnVlICksCgkJCWxlZnQ6IG9mZnNldC5sZWZ0IC0gcGFyZW50T2Zmc2V0LmxlZnQgLSBqUXVlcnkuY3NzKCBlbGVtLCAibWFyZ2luTGVmdCIsIHRydWUgKQoJCX07Cgl9LAoKCS8vIFRoaXMgbWV0aG9kIHdpbGwgcmV0dXJuIGRvY3VtZW50RWxlbWVudCBpbiB0aGUgZm9sbG93aW5nIGNhc2VzOgoJLy8gMSkgRm9yIHRoZSBlbGVtZW50IGluc2lkZSB0aGUgaWZyYW1lIHdpdGhvdXQgb2Zmc2V0UGFyZW50LCB0aGlzIG1ldGhvZCB3aWxsIHJldHVybgoJLy8gICAgZG9jdW1lbnRFbGVtZW50IG9mIHRoZSBwYXJlbnQgd2luZG93CgkvLyAyKSBGb3IgdGhlIGhpZGRlbiBvciBkZXRhY2hlZCBlbGVtZW50CgkvLyAzKSBGb3IgYm9keSBvciBodG1sIGVsZW1lbnQsIGkuZS4gaW4gY2FzZSBvZiB0aGUgaHRtbCBub2RlIC0gaXQgd2lsbCByZXR1cm4gaXRzZWxmCgkvLwoJLy8gYnV0IHRob3NlIGV4Y2VwdGlvbnMgd2VyZSBuZXZlciBwcmVzZW50ZWQgYXMgYSByZWFsIGxpZmUgdXNlLWNhc2VzCgkvLyBhbmQgbWlnaHQgYmUgY29uc2lkZXJlZCBhcyBtb3JlIHByZWZlcmFibGUgcmVzdWx0cy4KCS8vCgkvLyBUaGlzIGxvZ2ljLCBob3dldmVyLCBpcyBub3QgZ3VhcmFudGVlZCBhbmQgY2FuIGNoYW5nZSBhdCBhbnkgcG9pbnQgaW4gdGhlIGZ1dHVyZQoJb2Zmc2V0UGFyZW50OiBmdW5jdGlvbigpIHsKCQlyZXR1cm4gdGhpcy5tYXAoIGZ1bmN0aW9uKCkgewoJCQl2YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5vZmZzZXRQYXJlbnQ7CgoJCQl3aGlsZSAoIG9mZnNldFBhcmVudCAmJiBqUXVlcnkuY3NzKCBvZmZzZXRQYXJlbnQsICJwb3NpdGlvbiIgKSA9PT0gInN0YXRpYyIgKSB7CgkJCQlvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQub2Zmc2V0UGFyZW50OwoJCQl9CgoJCQlyZXR1cm4gb2Zmc2V0UGFyZW50IHx8IGRvY3VtZW50RWxlbWVudDsKCQl9ICk7Cgl9Cn0gKTsKCi8vIENyZWF0ZSBzY3JvbGxMZWZ0IGFuZCBzY3JvbGxUb3AgbWV0aG9kcwpqUXVlcnkuZWFjaCggeyBzY3JvbGxMZWZ0OiAicGFnZVhPZmZzZXQiLCBzY3JvbGxUb3A6ICJwYWdlWU9mZnNldCIgfSwgZnVuY3Rpb24oIG1ldGhvZCwgcHJvcCApIHsKCXZhciB0b3AgPSAicGFnZVlPZmZzZXQiID09PSBwcm9wOwoKCWpRdWVyeS5mblsgbWV0aG9kIF0gPSBmdW5jdGlvbiggdmFsICkgewoJCXJldHVybiBhY2Nlc3MoIHRoaXMsIGZ1bmN0aW9uKCBlbGVtLCBtZXRob2QsIHZhbCApIHsKCQkJdmFyIHdpbiA9IGdldFdpbmRvdyggZWxlbSApOwoKCQkJaWYgKCB2YWwgPT09IHVuZGVmaW5lZCApIHsKCQkJCXJldHVybiB3aW4gPyB3aW5bIHByb3AgXSA6IGVsZW1bIG1ldGhvZCBdOwoJCQl9CgoJCQlpZiAoIHdpbiApIHsKCQkJCXdpbi5zY3JvbGxUbygKCQkJCQkhdG9wID8gdmFsIDogd2luLnBhZ2VYT2Zmc2V0LAoJCQkJCXRvcCA/IHZhbCA6IHdpbi5wYWdlWU9mZnNldAoJCQkJKTsKCgkJCX0gZWxzZSB7CgkJCQllbGVtWyBtZXRob2QgXSA9IHZhbDsKCQkJfQoJCX0sIG1ldGhvZCwgdmFsLCBhcmd1bWVudHMubGVuZ3RoICk7Cgl9Owp9ICk7CgovLyBTdXBwb3J0OiBTYWZhcmk8Ny04KywgQ2hyb21lPDM3LTQ0KwovLyBBZGQgdGhlIHRvcC9sZWZ0IGNzc0hvb2tzIHVzaW5nIGpRdWVyeS5mbi5wb3NpdGlvbgovLyBXZWJraXQgYnVnOiBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MjkwODQKLy8gQmxpbmsgYnVnOiBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MjI5MjgwCi8vIGdldENvbXB1dGVkU3R5bGUgcmV0dXJucyBwZXJjZW50IHdoZW4gc3BlY2lmaWVkIGZvciB0b3AvbGVmdC9ib3R0b20vcmlnaHQ7Ci8vIHJhdGhlciB0aGFuIG1ha2UgdGhlIGNzcyBtb2R1bGUgZGVwZW5kIG9uIHRoZSBvZmZzZXQgbW9kdWxlLCBqdXN0IGNoZWNrIGZvciBpdCBoZXJlCmpRdWVyeS5lYWNoKCBbICJ0b3AiLCAibGVmdCIgXSwgZnVuY3Rpb24oIGksIHByb3AgKSB7CglqUXVlcnkuY3NzSG9va3NbIHByb3AgXSA9IGFkZEdldEhvb2tJZiggc3VwcG9ydC5waXhlbFBvc2l0aW9uLAoJCWZ1bmN0aW9uKCBlbGVtLCBjb21wdXRlZCApIHsKCQkJaWYgKCBjb21wdXRlZCApIHsKCQkJCWNvbXB1dGVkID0gY3VyQ1NTKCBlbGVtLCBwcm9wICk7CgoJCQkJLy8gSWYgY3VyQ1NTIHJldHVybnMgcGVyY2VudGFnZSwgZmFsbGJhY2sgdG8gb2Zmc2V0CgkJCQlyZXR1cm4gcm51bW5vbnB4LnRlc3QoIGNvbXB1dGVkICkgPwoJCQkJCWpRdWVyeSggZWxlbSApLnBvc2l0aW9uKClbIHByb3AgXSArICJweCIgOgoJCQkJCWNvbXB1dGVkOwoJCQl9CgkJfQoJKTsKfSApOwoKCi8vIENyZWF0ZSBpbm5lckhlaWdodCwgaW5uZXJXaWR0aCwgaGVpZ2h0LCB3aWR0aCwgb3V0ZXJIZWlnaHQgYW5kIG91dGVyV2lkdGggbWV0aG9kcwpqUXVlcnkuZWFjaCggeyBIZWlnaHQ6ICJoZWlnaHQiLCBXaWR0aDogIndpZHRoIiB9LCBmdW5jdGlvbiggbmFtZSwgdHlwZSApIHsKCWpRdWVyeS5lYWNoKCB7IHBhZGRpbmc6ICJpbm5lciIgKyBuYW1lLCBjb250ZW50OiB0eXBlLCAiIjogIm91dGVyIiArIG5hbWUgfSwKCQlmdW5jdGlvbiggZGVmYXVsdEV4dHJhLCBmdW5jTmFtZSApIHsKCgkJLy8gTWFyZ2luIGlzIG9ubHkgZm9yIG91dGVySGVpZ2h0LCBvdXRlcldpZHRoCgkJalF1ZXJ5LmZuWyBmdW5jTmFtZSBdID0gZnVuY3Rpb24oIG1hcmdpbiwgdmFsdWUgKSB7CgkJCXZhciBjaGFpbmFibGUgPSBhcmd1bWVudHMubGVuZ3RoICYmICggZGVmYXVsdEV4dHJhIHx8IHR5cGVvZiBtYXJnaW4gIT09ICJib29sZWFuIiApLAoJCQkJZXh0cmEgPSBkZWZhdWx0RXh0cmEgfHwgKCBtYXJnaW4gPT09IHRydWUgfHwgdmFsdWUgPT09IHRydWUgPyAibWFyZ2luIiA6ICJib3JkZXIiICk7CgoJCQlyZXR1cm4gYWNjZXNzKCB0aGlzLCBmdW5jdGlvbiggZWxlbSwgdHlwZSwgdmFsdWUgKSB7CgkJCQl2YXIgZG9jOwoKCQkJCWlmICggalF1ZXJ5LmlzV2luZG93KCBlbGVtICkgKSB7CgoJCQkJCS8vIEFzIG9mIDUvOC8yMDEyIHRoaXMgd2lsbCB5aWVsZCBpbmNvcnJlY3QgcmVzdWx0cyBmb3IgTW9iaWxlIFNhZmFyaSwgYnV0IHRoZXJlCgkJCQkJLy8gaXNuJ3QgYSB3aG9sZSBsb3Qgd2UgY2FuIGRvLiBTZWUgcHVsbCByZXF1ZXN0IGF0IHRoaXMgVVJMIGZvciBkaXNjdXNzaW9uOgoJCQkJCS8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qcXVlcnkvanF1ZXJ5L3B1bGwvNzY0CgkJCQkJcmV0dXJuIGVsZW0uZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyAiY2xpZW50IiArIG5hbWUgXTsKCQkJCX0KCgkJCQkvLyBHZXQgZG9jdW1lbnQgd2lkdGggb3IgaGVpZ2h0CgkJCQlpZiAoIGVsZW0ubm9kZVR5cGUgPT09IDkgKSB7CgkJCQkJZG9jID0gZWxlbS5kb2N1bWVudEVsZW1lbnQ7CgoJCQkJCS8vIEVpdGhlciBzY3JvbGxbV2lkdGgvSGVpZ2h0XSBvciBvZmZzZXRbV2lkdGgvSGVpZ2h0XSBvciBjbGllbnRbV2lkdGgvSGVpZ2h0XSwKCQkJCQkvLyB3aGljaGV2ZXIgaXMgZ3JlYXRlc3QKCQkJCQlyZXR1cm4gTWF0aC5tYXgoCgkJCQkJCWVsZW0uYm9keVsgInNjcm9sbCIgKyBuYW1lIF0sIGRvY1sgInNjcm9sbCIgKyBuYW1lIF0sCgkJCQkJCWVsZW0uYm9keVsgIm9mZnNldCIgKyBuYW1lIF0sIGRvY1sgIm9mZnNldCIgKyBuYW1lIF0sCgkJCQkJCWRvY1sgImNsaWVudCIgKyBuYW1lIF0KCQkJCQkpOwoJCQkJfQoKCQkJCXJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8KCgkJCQkJLy8gR2V0IHdpZHRoIG9yIGhlaWdodCBvbiB0aGUgZWxlbWVudCwgcmVxdWVzdGluZyBidXQgbm90IGZvcmNpbmcgcGFyc2VGbG9hdAoJCQkJCWpRdWVyeS5jc3MoIGVsZW0sIHR5cGUsIGV4dHJhICkgOgoKCQkJCQkvLyBTZXQgd2lkdGggb3IgaGVpZ2h0IG9uIHRoZSBlbGVtZW50CgkJCQkJalF1ZXJ5LnN0eWxlKCBlbGVtLCB0eXBlLCB2YWx1ZSwgZXh0cmEgKTsKCQkJfSwgdHlwZSwgY2hhaW5hYmxlID8gbWFyZ2luIDogdW5kZWZpbmVkLCBjaGFpbmFibGUsIG51bGwgKTsKCQl9OwoJfSApOwp9ICk7CgoKalF1ZXJ5LmZuLmV4dGVuZCggewoKCWJpbmQ6IGZ1bmN0aW9uKCB0eXBlcywgZGF0YSwgZm4gKSB7CgkJcmV0dXJuIHRoaXMub24oIHR5cGVzLCBudWxsLCBkYXRhLCBmbiApOwoJfSwKCXVuYmluZDogZnVuY3Rpb24oIHR5cGVzLCBmbiApIHsKCQlyZXR1cm4gdGhpcy5vZmYoIHR5cGVzLCBudWxsLCBmbiApOwoJfSwKCglkZWxlZ2F0ZTogZnVuY3Rpb24oIHNlbGVjdG9yLCB0eXBlcywgZGF0YSwgZm4gKSB7CgkJcmV0dXJuIHRoaXMub24oIHR5cGVzLCBzZWxlY3RvciwgZGF0YSwgZm4gKTsKCX0sCgl1bmRlbGVnYXRlOiBmdW5jdGlvbiggc2VsZWN0b3IsIHR5cGVzLCBmbiApIHsKCgkJLy8gKCBuYW1lc3BhY2UgKSBvciAoIHNlbGVjdG9yLCB0eXBlcyBbLCBmbl0gKQoJCXJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAxID8KCQkJdGhpcy5vZmYoIHNlbGVjdG9yLCAiKioiICkgOgoJCQl0aGlzLm9mZiggdHlwZXMsIHNlbGVjdG9yIHx8ICIqKiIsIGZuICk7Cgl9LAoJc2l6ZTogZnVuY3Rpb24oKSB7CgkJcmV0dXJuIHRoaXMubGVuZ3RoOwoJfQp9ICk7CgpqUXVlcnkuZm4uYW5kU2VsZiA9IGpRdWVyeS5mbi5hZGRCYWNrOwoKCgoKLy8gUmVnaXN0ZXIgYXMgYSBuYW1lZCBBTUQgbW9kdWxlLCBzaW5jZSBqUXVlcnkgY2FuIGJlIGNvbmNhdGVuYXRlZCB3aXRoIG90aGVyCi8vIGZpbGVzIHRoYXQgbWF5IHVzZSBkZWZpbmUsIGJ1dCBub3QgdmlhIGEgcHJvcGVyIGNvbmNhdGVuYXRpb24gc2NyaXB0IHRoYXQKLy8gdW5kZXJzdGFuZHMgYW5vbnltb3VzIEFNRCBtb2R1bGVzLiBBIG5hbWVkIEFNRCBpcyBzYWZlc3QgYW5kIG1vc3Qgcm9idXN0Ci8vIHdheSB0byByZWdpc3Rlci4gTG93ZXJjYXNlIGpxdWVyeSBpcyB1c2VkIGJlY2F1c2UgQU1EIG1vZHVsZSBuYW1lcyBhcmUKLy8gZGVyaXZlZCBmcm9tIGZpbGUgbmFtZXMsIGFuZCBqUXVlcnkgaXMgbm9ybWFsbHkgZGVsaXZlcmVkIGluIGEgbG93ZXJjYXNlCi8vIGZpbGUgbmFtZS4gRG8gdGhpcyBhZnRlciBjcmVhdGluZyB0aGUgZ2xvYmFsIHNvIHRoYXQgaWYgYW4gQU1EIG1vZHVsZSB3YW50cwovLyB0byBjYWxsIG5vQ29uZmxpY3QgdG8gaGlkZSB0aGlzIHZlcnNpb24gb2YgalF1ZXJ5LCBpdCB3aWxsIHdvcmsuCgovLyBOb3RlIHRoYXQgZm9yIG1heGltdW0gcG9ydGFiaWxpdHksIGxpYnJhcmllcyB0aGF0IGFyZSBub3QgalF1ZXJ5IHNob3VsZAovLyBkZWNsYXJlIHRoZW1zZWx2ZXMgYXMgYW5vbnltb3VzIG1vZHVsZXMsIGFuZCBhdm9pZCBzZXR0aW5nIGEgZ2xvYmFsIGlmIGFuCi8vIEFNRCBsb2FkZXIgaXMgcHJlc2VudC4galF1ZXJ5IGlzIGEgc3BlY2lhbCBjYXNlLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiwgc2VlCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qcmJ1cmtlL3JlcXVpcmVqcy93aWtpL1VwZGF0aW5nLWV4aXN0aW5nLWxpYnJhcmllcyN3aWtpLWFub24KCmlmICggdHlwZW9mIGRlZmluZSA9PT0gImZ1bmN0aW9uIiAmJiBkZWZpbmUuYW1kICkgewoJZGVmaW5lKCAianF1ZXJ5IiwgW10sIGZ1bmN0aW9uKCkgewoJCXJldHVybiBqUXVlcnk7Cgl9ICk7Cn0KCgoKdmFyCgoJLy8gTWFwIG92ZXIgalF1ZXJ5IGluIGNhc2Ugb2Ygb3ZlcndyaXRlCglfalF1ZXJ5ID0gd2luZG93LmpRdWVyeSwKCgkvLyBNYXAgb3ZlciB0aGUgJCBpbiBjYXNlIG9mIG92ZXJ3cml0ZQoJXyQgPSB3aW5kb3cuJDsKCmpRdWVyeS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24oIGRlZXAgKSB7CglpZiAoIHdpbmRvdy4kID09PSBqUXVlcnkgKSB7CgkJd2luZG93LiQgPSBfJDsKCX0KCglpZiAoIGRlZXAgJiYgd2luZG93LmpRdWVyeSA9PT0galF1ZXJ5ICkgewoJCXdpbmRvdy5qUXVlcnkgPSBfalF1ZXJ5OwoJfQoKCXJldHVybiBqUXVlcnk7Cn07CgovLyBFeHBvc2UgalF1ZXJ5IGFuZCAkIGlkZW50aWZpZXJzLCBldmVuIGluIEFNRAovLyAoIzcxMDIjY29tbWVudDoxMCwgaHR0cHM6Ly9naXRodWIuY29tL2pxdWVyeS9qcXVlcnkvcHVsbC81NTcpCi8vIGFuZCBDb21tb25KUyBmb3IgYnJvd3NlciBlbXVsYXRvcnMgKCMxMzU2NikKaWYgKCAhbm9HbG9iYWwgKSB7Cgl3aW5kb3cualF1ZXJ5ID0gd2luZG93LiQgPSBqUXVlcnk7Cn0KCnJldHVybiBqUXVlcnk7Cn0pKTsK"},{"meta":{"name":"jszip-min-js.js","url":"https://update.greasyfork.org/scripts/518632/1489865/jszip-min-js.js","ts":1770962851906,"mimetype":"text/javascript"},"source":"LyohCgpKU1ppcCB2My43LjEgLSBBIEphdmFTY3JpcHQgY2xhc3MgZm9yIGdlbmVyYXRpbmcgYW5kIHJlYWRpbmcgemlwIGZpbGVzCjxodHRwOi8vc3R1YXJ0ay5jb20vanN6aXA+CgooYykgMjAwOS0yMDE2IFN0dWFydCBLbmlnaHRsZXkgPHN0dWFydCBbYXRdIHN0dWFydGsuY29tPgpEdWFsIGxpY2VuY2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBvciBHUEx2My4gU2VlIGh0dHBzOi8vcmF3LmdpdGh1Yi5jb20vU3R1ay9qc3ppcC9tYXN0ZXIvTElDRU5TRS5tYXJrZG93bi4KCkpTWmlwIHVzZXMgdGhlIGxpYnJhcnkgcGFrbyByZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgOgpodHRwczovL2dpdGh1Yi5jb20vbm9kZWNhL3Bha28vYmxvYi9tYXN0ZXIvTElDRU5TRQoqLwoKIShmdW5jdGlvbiAodCkgewogIGlmICgib2JqZWN0IiA9PSB0eXBlb2YgZXhwb3J0cyAmJiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgbW9kdWxlKQogICAgbW9kdWxlLmV4cG9ydHMgPSB0KCk7CiAgZWxzZSBpZiAoImZ1bmN0aW9uIiA9PSB0eXBlb2YgZGVmaW5lICYmIGRlZmluZS5hbWQpIGRlZmluZShbXSwgdCk7CiAgZWxzZSB7CiAgICAoInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdwogICAgICA/IHdpbmRvdwogICAgICA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBnbG9iYWwKICAgICAgICA/IGdsb2JhbAogICAgICAgIDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIHNlbGYKICAgICAgICAgID8gc2VsZgogICAgICAgICAgOiB0aGlzCiAgICApLkpTWmlwID0gdCgpOwogIH0KfSkoZnVuY3Rpb24gKCkgewogIHJldHVybiAoZnVuY3Rpb24gcyhhLCBvLCBoKSB7CiAgICBmdW5jdGlvbiB1KHIsIHQpIHsKICAgICAgaWYgKCFvW3JdKSB7CiAgICAgICAgaWYgKCFhW3JdKSB7CiAgICAgICAgICB2YXIgZSA9ICJmdW5jdGlvbiIgPT0gdHlwZW9mIHJlcXVpcmUgJiYgcmVxdWlyZTsKICAgICAgICAgIGlmICghdCAmJiBlKSByZXR1cm4gZShyLCAhMCk7CiAgICAgICAgICBpZiAobCkgcmV0dXJuIGwociwgITApOwogICAgICAgICAgdmFyIGkgPSBuZXcgRXJyb3IoIkNhbm5vdCBmaW5kIG1vZHVsZSAnIiArIHIgKyAiJyIpOwogICAgICAgICAgdGhyb3cgKChpLmNvZGUgPSAiTU9EVUxFX05PVF9GT1VORCIpLCBpKTsKICAgICAgICB9CiAgICAgICAgdmFyIG4gPSAob1tyXSA9IHsgZXhwb3J0czoge30gfSk7CiAgICAgICAgYVtyXVswXS5jYWxsKAogICAgICAgICAgbi5leHBvcnRzLAogICAgICAgICAgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgdmFyIGUgPSBhW3JdWzFdW3RdOwogICAgICAgICAgICByZXR1cm4gdShlIHx8IHQpOwogICAgICAgICAgfSwKICAgICAgICAgIG4sCiAgICAgICAgICBuLmV4cG9ydHMsCiAgICAgICAgICBzLAogICAgICAgICAgYSwKICAgICAgICAgIG8sCiAgICAgICAgICBoLAogICAgICAgICk7CiAgICAgIH0KICAgICAgcmV0dXJuIG9bcl0uZXhwb3J0czsKICAgIH0KICAgIGZvciAoCiAgICAgIHZhciBsID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgcmVxdWlyZSAmJiByZXF1aXJlLCB0ID0gMDsKICAgICAgdCA8IGgubGVuZ3RoOwogICAgICB0KysKICAgICkKICAgICAgdShoW3RdKTsKICAgIHJldHVybiB1OwogIH0pKAogICAgewogICAgICAxOiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIHZhciBjID0gdCgiLi91dGlscyIpLAogICAgICAgICAgICBkID0gdCgiLi9zdXBwb3J0IiksCiAgICAgICAgICAgIHAgPQogICAgICAgICAgICAgICJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSI7CiAgICAgICAgICAoci5lbmNvZGUgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgIHZhciBlLAogICAgICAgICAgICAgICAgciwKICAgICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgICBuLAogICAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICAgIGEsCiAgICAgICAgICAgICAgICBvLAogICAgICAgICAgICAgICAgaCA9IFtdLAogICAgICAgICAgICAgICAgdSA9IDAsCiAgICAgICAgICAgICAgICBsID0gdC5sZW5ndGgsCiAgICAgICAgICAgICAgICBmID0gbCwKICAgICAgICAgICAgICAgIGQgPSAic3RyaW5nIiAhPT0gYy5nZXRUeXBlT2YodCk7CiAgICAgICAgICAgICAgdSA8IHQubGVuZ3RoOwoKICAgICAgICAgICAgKQogICAgICAgICAgICAgIChmID0gbCAtIHUpLAogICAgICAgICAgICAgICAgKGkgPSBkCiAgICAgICAgICAgICAgICAgID8gKChlID0gdFt1KytdKSwgKHIgPSB1IDwgbCA/IHRbdSsrXSA6IDApLCB1IDwgbCA/IHRbdSsrXSA6IDApCiAgICAgICAgICAgICAgICAgIDogKChlID0gdC5jaGFyQ29kZUF0KHUrKykpLAogICAgICAgICAgICAgICAgICAgIChyID0gdSA8IGwgPyB0LmNoYXJDb2RlQXQodSsrKSA6IDApLAogICAgICAgICAgICAgICAgICAgIHUgPCBsID8gdC5jaGFyQ29kZUF0KHUrKykgOiAwKSksCiAgICAgICAgICAgICAgICAobiA9IGUgPj4gMiksCiAgICAgICAgICAgICAgICAocyA9ICgoMyAmIGUpIDw8IDQpIHwgKHIgPj4gNCkpLAogICAgICAgICAgICAgICAgKGEgPSAxIDwgZiA/ICgoMTUgJiByKSA8PCAyKSB8IChpID4+IDYpIDogNjQpLAogICAgICAgICAgICAgICAgKG8gPSAyIDwgZiA/IDYzICYgaSA6IDY0KSwKICAgICAgICAgICAgICAgIGgucHVzaChwLmNoYXJBdChuKSArIHAuY2hhckF0KHMpICsgcC5jaGFyQXQoYSkgKyBwLmNoYXJBdChvKSk7CiAgICAgICAgICAgIHJldHVybiBoLmpvaW4oIiIpOwogICAgICAgICAgfSksCiAgICAgICAgICAgIChyLmRlY29kZSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIGUsCiAgICAgICAgICAgICAgICByLAogICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgICAgYSwKICAgICAgICAgICAgICAgIG8gPSAwLAogICAgICAgICAgICAgICAgaCA9IDAsCiAgICAgICAgICAgICAgICB1ID0gImRhdGE6IjsKICAgICAgICAgICAgICBpZiAodC5zdWJzdHIoMCwgdS5sZW5ndGgpID09PSB1KQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgICAgICAgICAgICAiSW52YWxpZCBiYXNlNjQgaW5wdXQsIGl0IGxvb2tzIGxpa2UgYSBkYXRhIHVybC4iLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB2YXIgbCwKICAgICAgICAgICAgICAgIGYgPSAoMyAqICh0ID0gdC5yZXBsYWNlKC9bXkEtWmEtejAtOVwrXC9cPV0vZywgIiIpKS5sZW5ndGgpIC8gNDsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAodC5jaGFyQXQodC5sZW5ndGggLSAxKSA9PT0gcC5jaGFyQXQoNjQpICYmIGYtLSwKICAgICAgICAgICAgICAgIHQuY2hhckF0KHQubGVuZ3RoIC0gMikgPT09IHAuY2hhckF0KDY0KSAmJiBmLS0sCiAgICAgICAgICAgICAgICBmICUgMSAhPSAwKQogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiSW52YWxpZCBiYXNlNjQgaW5wdXQsIGJhZCBjb250ZW50IGxlbmd0aC4iKTsKICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgbCA9IGQudWludDhhcnJheSA/IG5ldyBVaW50OEFycmF5KDAgfCBmKSA6IG5ldyBBcnJheSgwIHwgZik7CiAgICAgICAgICAgICAgICBvIDwgdC5sZW5ndGg7CgogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIChlID0KICAgICAgICAgICAgICAgICAgKHAuaW5kZXhPZih0LmNoYXJBdChvKyspKSA8PCAyKSB8CiAgICAgICAgICAgICAgICAgICgobiA9IHAuaW5kZXhPZih0LmNoYXJBdChvKyspKSkgPj4gNCkpLAogICAgICAgICAgICAgICAgICAociA9ICgoMTUgJiBuKSA8PCA0KSB8ICgocyA9IHAuaW5kZXhPZih0LmNoYXJBdChvKyspKSkgPj4gMikpLAogICAgICAgICAgICAgICAgICAoaSA9ICgoMyAmIHMpIDw8IDYpIHwgKGEgPSBwLmluZGV4T2YodC5jaGFyQXQobysrKSkpKSwKICAgICAgICAgICAgICAgICAgKGxbaCsrXSA9IGUpLAogICAgICAgICAgICAgICAgICA2NCAhPT0gcyAmJiAobFtoKytdID0gciksCiAgICAgICAgICAgICAgICAgIDY0ICE9PSBhICYmIChsW2grK10gPSBpKTsKICAgICAgICAgICAgICByZXR1cm4gbDsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICB7ICIuL3N1cHBvcnQiOiAzMCwgIi4vdXRpbHMiOiAzMiB9LAogICAgICBdLAogICAgICAyOiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIHZhciBpID0gdCgiLi9leHRlcm5hbCIpLAogICAgICAgICAgICBuID0gdCgiLi9zdHJlYW0vRGF0YVdvcmtlciIpLAogICAgICAgICAgICBzID0gdCgiLi9zdHJlYW0vQ3JjMzJQcm9iZSIpLAogICAgICAgICAgICBhID0gdCgiLi9zdHJlYW0vRGF0YUxlbmd0aFByb2JlIik7CiAgICAgICAgICBmdW5jdGlvbiBvKHQsIGUsIHIsIGksIG4pIHsKICAgICAgICAgICAgKHRoaXMuY29tcHJlc3NlZFNpemUgPSB0KSwKICAgICAgICAgICAgICAodGhpcy51bmNvbXByZXNzZWRTaXplID0gZSksCiAgICAgICAgICAgICAgKHRoaXMuY3JjMzIgPSByKSwKICAgICAgICAgICAgICAodGhpcy5jb21wcmVzc2lvbiA9IGkpLAogICAgICAgICAgICAgICh0aGlzLmNvbXByZXNzZWRDb250ZW50ID0gbik7CiAgICAgICAgICB9CiAgICAgICAgICAoby5wcm90b3R5cGUgPSB7CiAgICAgICAgICAgIGdldENvbnRlbnRXb3JrZXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgdCA9IG5ldyBuKGkuUHJvbWlzZS5yZXNvbHZlKHRoaXMuY29tcHJlc3NlZENvbnRlbnQpKQogICAgICAgICAgICAgICAgICAucGlwZSh0aGlzLmNvbXByZXNzaW9uLnVuY29tcHJlc3NXb3JrZXIoKSkKICAgICAgICAgICAgICAgICAgLnBpcGUobmV3IGEoImRhdGFfbGVuZ3RoIikpLAogICAgICAgICAgICAgICAgZSA9IHRoaXM7CiAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgIHQub24oImVuZCIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RyZWFtSW5mby5kYXRhX2xlbmd0aCAhPT0gZS51bmNvbXByZXNzZWRTaXplKQogICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiQnVnIDogdW5jb21wcmVzc2VkIGRhdGEgc2l6ZSBtaXNtYXRjaCIpOwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB0CiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZ2V0Q29tcHJlc3NlZFdvcmtlcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiBuZXcgbihpLlByb21pc2UucmVzb2x2ZSh0aGlzLmNvbXByZXNzZWRDb250ZW50KSkKICAgICAgICAgICAgICAgIC53aXRoU3RyZWFtSW5mbygiY29tcHJlc3NlZFNpemUiLCB0aGlzLmNvbXByZXNzZWRTaXplKQogICAgICAgICAgICAgICAgLndpdGhTdHJlYW1JbmZvKCJ1bmNvbXByZXNzZWRTaXplIiwgdGhpcy51bmNvbXByZXNzZWRTaXplKQogICAgICAgICAgICAgICAgLndpdGhTdHJlYW1JbmZvKCJjcmMzMiIsIHRoaXMuY3JjMzIpCiAgICAgICAgICAgICAgICAud2l0aFN0cmVhbUluZm8oImNvbXByZXNzaW9uIiwgdGhpcy5jb21wcmVzc2lvbik7CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KSwKICAgICAgICAgICAgKG8uY3JlYXRlV29ya2VyRnJvbSA9IGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHQKICAgICAgICAgICAgICAgIC5waXBlKG5ldyBzKCkpCiAgICAgICAgICAgICAgICAucGlwZShuZXcgYSgidW5jb21wcmVzc2VkU2l6ZSIpKQogICAgICAgICAgICAgICAgLnBpcGUoZS5jb21wcmVzc1dvcmtlcihyKSkKICAgICAgICAgICAgICAgIC5waXBlKG5ldyBhKCJjb21wcmVzc2VkU2l6ZSIpKQogICAgICAgICAgICAgICAgLndpdGhTdHJlYW1JbmZvKCJjb21wcmVzc2lvbiIsIGUpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGUuZXhwb3J0cyA9IG8pOwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIi4vZXh0ZXJuYWwiOiA2LAogICAgICAgICAgIi4vc3RyZWFtL0NyYzMyUHJvYmUiOiAyNSwKICAgICAgICAgICIuL3N0cmVhbS9EYXRhTGVuZ3RoUHJvYmUiOiAyNiwKICAgICAgICAgICIuL3N0cmVhbS9EYXRhV29ya2VyIjogMjcsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgMzogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9IHQoIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKTsKICAgICAgICAgIChyLlNUT1JFID0gewogICAgICAgICAgICBtYWdpYzogIlwwXDAiLAogICAgICAgICAgICBjb21wcmVzc1dvcmtlcjogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICByZXR1cm4gbmV3IGkoIlNUT1JFIGNvbXByZXNzaW9uIik7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHVuY29tcHJlc3NXb3JrZXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gbmV3IGkoIlNUT1JFIGRlY29tcHJlc3Npb24iKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5ERUZMQVRFID0gdCgiLi9mbGF0ZSIpKTsKICAgICAgICB9LAogICAgICAgIHsgIi4vZmxhdGUiOiA3LCAiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciI6IDI4IH0sCiAgICAgIF0sCiAgICAgIDQ6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIGkgPSB0KCIuL3V0aWxzIik7CiAgICAgICAgICB2YXIgbyA9IChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIGZvciAodmFyIHQsIGUgPSBbXSwgciA9IDA7IHIgPCAyNTY7IHIrKykgewogICAgICAgICAgICAgIHQgPSByOwogICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKQogICAgICAgICAgICAgICAgdCA9IDEgJiB0ID8gMzk4ODI5MjM4NCBeICh0ID4+PiAxKSA6IHQgPj4+IDE7CiAgICAgICAgICAgICAgZVtyXSA9IHQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGU7CiAgICAgICAgICB9KSgpOwogICAgICAgICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gdCAmJiB0Lmxlbmd0aAogICAgICAgICAgICAgID8gInN0cmluZyIgIT09IGkuZ2V0VHlwZU9mKHQpCiAgICAgICAgICAgICAgICA/IChmdW5jdGlvbiAodCwgZSwgciwgaSkgewogICAgICAgICAgICAgICAgICAgIHZhciBuID0gbywKICAgICAgICAgICAgICAgICAgICAgIHMgPSBpICsgcjsKICAgICAgICAgICAgICAgICAgICB0IF49IC0xOwogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGEgPSBpOyBhIDwgczsgYSsrKQogICAgICAgICAgICAgICAgICAgICAgdCA9ICh0ID4+PiA4KSBeIG5bMjU1ICYgKHQgXiBlW2FdKV07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xIF4gdDsKICAgICAgICAgICAgICAgICAgfSkoMCB8IGUsIHQsIHQubGVuZ3RoLCAwKQogICAgICAgICAgICAgICAgOiAoZnVuY3Rpb24gKHQsIGUsIHIsIGkpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IG8sCiAgICAgICAgICAgICAgICAgICAgICBzID0gaSArIHI7CiAgICAgICAgICAgICAgICAgICAgdCBePSAtMTsKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBhID0gaTsgYSA8IHM7IGErKykKICAgICAgICAgICAgICAgICAgICAgIHQgPSAodCA+Pj4gOCkgXiBuWzI1NSAmICh0IF4gZS5jaGFyQ29kZUF0KGEpKV07CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xIF4gdDsKICAgICAgICAgICAgICAgICAgfSkoMCB8IGUsIHQsIHQubGVuZ3RoLCAwKQogICAgICAgICAgICAgIDogMDsKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB7ICIuL3V0aWxzIjogMzIgfSwKICAgICAgXSwKICAgICAgNTogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICAoci5iYXNlNjQgPSAhMSksCiAgICAgICAgICAgIChyLmJpbmFyeSA9ICExKSwKICAgICAgICAgICAgKHIuZGlyID0gITEpLAogICAgICAgICAgICAoci5jcmVhdGVGb2xkZXJzID0gITApLAogICAgICAgICAgICAoci5kYXRlID0gbnVsbCksCiAgICAgICAgICAgIChyLmNvbXByZXNzaW9uID0gbnVsbCksCiAgICAgICAgICAgIChyLmNvbXByZXNzaW9uT3B0aW9ucyA9IG51bGwpLAogICAgICAgICAgICAoci5jb21tZW50ID0gbnVsbCksCiAgICAgICAgICAgIChyLnVuaXhQZXJtaXNzaW9ucyA9IG51bGwpLAogICAgICAgICAgICAoci5kb3NQZXJtaXNzaW9ucyA9IG51bGwpOwogICAgICAgIH0sCiAgICAgICAge30sCiAgICAgIF0sCiAgICAgIDY6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIGkgPSBudWxsOwogICAgICAgICAgKGkgPSAidW5kZWZpbmVkIiAhPSB0eXBlb2YgUHJvbWlzZSA/IFByb21pc2UgOiB0KCJsaWUiKSksCiAgICAgICAgICAgIChlLmV4cG9ydHMgPSB7IFByb21pc2U6IGkgfSk7CiAgICAgICAgfSwKICAgICAgICB7IGxpZTogMzcgfSwKICAgICAgXSwKICAgICAgNzogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9CiAgICAgICAgICAgICAgInVuZGVmaW5lZCIgIT0gdHlwZW9mIFVpbnQ4QXJyYXkgJiYKICAgICAgICAgICAgICAidW5kZWZpbmVkIiAhPSB0eXBlb2YgVWludDE2QXJyYXkgJiYKICAgICAgICAgICAgICAidW5kZWZpbmVkIiAhPSB0eXBlb2YgVWludDMyQXJyYXksCiAgICAgICAgICAgIG4gPSB0KCJwYWtvIiksCiAgICAgICAgICAgIHMgPSB0KCIuL3V0aWxzIiksCiAgICAgICAgICAgIGEgPSB0KCIuL3N0cmVhbS9HZW5lcmljV29ya2VyIiksCiAgICAgICAgICAgIG8gPSBpID8gInVpbnQ4YXJyYXkiIDogImFycmF5IjsKICAgICAgICAgIGZ1bmN0aW9uIGgodCwgZSkgewogICAgICAgICAgICBhLmNhbGwodGhpcywgIkZsYXRlV29ya2VyLyIgKyB0KSwKICAgICAgICAgICAgICAodGhpcy5fcGFrbyA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLl9wYWtvQWN0aW9uID0gdCksCiAgICAgICAgICAgICAgKHRoaXMuX3Bha29PcHRpb25zID0gZSksCiAgICAgICAgICAgICAgKHRoaXMubWV0YSA9IHt9KTsKICAgICAgICAgIH0KICAgICAgICAgIChyLm1hZ2ljID0gIlxiXDAiKSwKICAgICAgICAgICAgcy5pbmhlcml0cyhoLCBhKSwKICAgICAgICAgICAgKGgucHJvdG90eXBlLnByb2Nlc3NDaHVuayA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgKHRoaXMubWV0YSA9IHQubWV0YSksCiAgICAgICAgICAgICAgICBudWxsID09PSB0aGlzLl9wYWtvICYmIHRoaXMuX2NyZWF0ZVBha28oKSwKICAgICAgICAgICAgICAgIHRoaXMuX3Bha28ucHVzaChzLnRyYW5zZm9ybVRvKG8sIHQuZGF0YSksICExKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChoLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBhLnByb3RvdHlwZS5mbHVzaC5jYWxsKHRoaXMpLAogICAgICAgICAgICAgICAgbnVsbCA9PT0gdGhpcy5fcGFrbyAmJiB0aGlzLl9jcmVhdGVQYWtvKCksCiAgICAgICAgICAgICAgICB0aGlzLl9wYWtvLnB1c2goW10sICEwKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChoLnByb3RvdHlwZS5jbGVhblVwID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGEucHJvdG90eXBlLmNsZWFuVXAuY2FsbCh0aGlzKSwgKHRoaXMuX3Bha28gPSBudWxsKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChoLnByb3RvdHlwZS5fY3JlYXRlUGFrbyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB0aGlzLl9wYWtvID0gbmV3IG5bdGhpcy5fcGFrb0FjdGlvbl0oewogICAgICAgICAgICAgICAgcmF3OiAhMCwKICAgICAgICAgICAgICAgIGxldmVsOiB0aGlzLl9wYWtvT3B0aW9ucy5sZXZlbCB8fCAtMSwKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB2YXIgZSA9IHRoaXM7CiAgICAgICAgICAgICAgdGhpcy5fcGFrby5vbkRhdGEgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgZS5wdXNoKHsgZGF0YTogdCwgbWV0YTogZS5tZXRhIH0pOwogICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5jb21wcmVzc1dvcmtlciA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBoKCJEZWZsYXRlIiwgdCk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci51bmNvbXByZXNzV29ya2VyID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiBuZXcgaCgiSW5mbGF0ZSIsIHt9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICB7ICIuL3N0cmVhbS9HZW5lcmljV29ya2VyIjogMjgsICIuL3V0aWxzIjogMzIsIHBha286IDM4IH0sCiAgICAgIF0sCiAgICAgIDg6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgZnVuY3Rpb24gQSh0LCBlKSB7CiAgICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIGkgPSAiIjsKICAgICAgICAgICAgZm9yIChyID0gMDsgciA8IGU7IHIrKykKICAgICAgICAgICAgICAoaSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDI1NSAmIHQpKSwgKHQgPj4+PSA4KTsKICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBpKHQsIGUsIHIsIGksIG4sIHMpIHsKICAgICAgICAgICAgdmFyIGEsCiAgICAgICAgICAgICAgbywKICAgICAgICAgICAgICBoID0gdC5maWxlLAogICAgICAgICAgICAgIHUgPSB0LmNvbXByZXNzaW9uLAogICAgICAgICAgICAgIGwgPSBzICE9PSBPLnV0ZjhlbmNvZGUsCiAgICAgICAgICAgICAgZiA9IEkudHJhbnNmb3JtVG8oInN0cmluZyIsIHMoaC5uYW1lKSksCiAgICAgICAgICAgICAgZCA9IEkudHJhbnNmb3JtVG8oInN0cmluZyIsIE8udXRmOGVuY29kZShoLm5hbWUpKSwKICAgICAgICAgICAgICBjID0gaC5jb21tZW50LAogICAgICAgICAgICAgIHAgPSBJLnRyYW5zZm9ybVRvKCJzdHJpbmciLCBzKGMpKSwKICAgICAgICAgICAgICBtID0gSS50cmFuc2Zvcm1Ubygic3RyaW5nIiwgTy51dGY4ZW5jb2RlKGMpKSwKICAgICAgICAgICAgICBfID0gZC5sZW5ndGggIT09IGgubmFtZS5sZW5ndGgsCiAgICAgICAgICAgICAgZyA9IG0ubGVuZ3RoICE9PSBjLmxlbmd0aCwKICAgICAgICAgICAgICBiID0gIiIsCiAgICAgICAgICAgICAgdiA9ICIiLAogICAgICAgICAgICAgIHkgPSAiIiwKICAgICAgICAgICAgICB3ID0gaC5kaXIsCiAgICAgICAgICAgICAgayA9IGguZGF0ZSwKICAgICAgICAgICAgICB4ID0geyBjcmMzMjogMCwgY29tcHJlc3NlZFNpemU6IDAsIHVuY29tcHJlc3NlZFNpemU6IDAgfTsKICAgICAgICAgICAgKGUgJiYgIXIpIHx8CiAgICAgICAgICAgICAgKCh4LmNyYzMyID0gdC5jcmMzMiksCiAgICAgICAgICAgICAgKHguY29tcHJlc3NlZFNpemUgPSB0LmNvbXByZXNzZWRTaXplKSwKICAgICAgICAgICAgICAoeC51bmNvbXByZXNzZWRTaXplID0gdC51bmNvbXByZXNzZWRTaXplKSk7CiAgICAgICAgICAgIHZhciBTID0gMDsKICAgICAgICAgICAgZSAmJiAoUyB8PSA4KSwgbCB8fCAoIV8gJiYgIWcpIHx8IChTIHw9IDIwNDgpOwogICAgICAgICAgICB2YXIgeiA9IDAsCiAgICAgICAgICAgICAgQyA9IDA7CiAgICAgICAgICAgIHcgJiYgKHogfD0gMTYpLAogICAgICAgICAgICAgICJVTklYIiA9PT0gbgogICAgICAgICAgICAgICAgPyAoKEMgPSA3OTgpLAogICAgICAgICAgICAgICAgICAoeiB8PSAoZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgciA9IHQ7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHQgfHwgKHIgPSBlID8gMTY4OTMgOiAzMzIwNCksICg2NTUzNSAmIHIpIDw8IDE2OwogICAgICAgICAgICAgICAgICB9KShoLnVuaXhQZXJtaXNzaW9ucywgdykpKQogICAgICAgICAgICAgICAgOiAoKEMgPSAyMCksCiAgICAgICAgICAgICAgICAgICh6IHw9IChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiA2MyAmICh0IHx8IDApOwogICAgICAgICAgICAgICAgICB9KShoLmRvc1Blcm1pc3Npb25zKSkpLAogICAgICAgICAgICAgIChhID0gay5nZXRVVENIb3VycygpKSwKICAgICAgICAgICAgICAoYSA8PD0gNiksCiAgICAgICAgICAgICAgKGEgfD0gay5nZXRVVENNaW51dGVzKCkpLAogICAgICAgICAgICAgIChhIDw8PSA1KSwKICAgICAgICAgICAgICAoYSB8PSBrLmdldFVUQ1NlY29uZHMoKSAvIDIpLAogICAgICAgICAgICAgIChvID0gay5nZXRVVENGdWxsWWVhcigpIC0gMTk4MCksCiAgICAgICAgICAgICAgKG8gPDw9IDQpLAogICAgICAgICAgICAgIChvIHw9IGsuZ2V0VVRDTW9udGgoKSArIDEpLAogICAgICAgICAgICAgIChvIDw8PSA1KSwKICAgICAgICAgICAgICAobyB8PSBrLmdldFVUQ0RhdGUoKSksCiAgICAgICAgICAgICAgXyAmJgogICAgICAgICAgICAgICAgKCh2ID0gQSgxLCAxKSArIEEoQihmKSwgNCkgKyBkKSwKICAgICAgICAgICAgICAgIChiICs9ICJ1cCIgKyBBKHYubGVuZ3RoLCAyKSArIHYpKSwKICAgICAgICAgICAgICBnICYmCiAgICAgICAgICAgICAgICAoKHkgPSBBKDEsIDEpICsgQShCKHApLCA0KSArIG0pLAogICAgICAgICAgICAgICAgKGIgKz0gInVjIiArIEEoeS5sZW5ndGgsIDIpICsgeSkpOwogICAgICAgICAgICB2YXIgRSA9ICIiOwogICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgIChFICs9ICJcblwwIiksCiAgICAgICAgICAgICAgKEUgKz0gQShTLCAyKSksCiAgICAgICAgICAgICAgKEUgKz0gdS5tYWdpYyksCiAgICAgICAgICAgICAgKEUgKz0gQShhLCAyKSksCiAgICAgICAgICAgICAgKEUgKz0gQShvLCAyKSksCiAgICAgICAgICAgICAgKEUgKz0gQSh4LmNyYzMyLCA0KSksCiAgICAgICAgICAgICAgKEUgKz0gQSh4LmNvbXByZXNzZWRTaXplLCA0KSksCiAgICAgICAgICAgICAgKEUgKz0gQSh4LnVuY29tcHJlc3NlZFNpemUsIDQpKSwKICAgICAgICAgICAgICAoRSArPSBBKGYubGVuZ3RoLCAyKSksCiAgICAgICAgICAgICAgKEUgKz0gQShiLmxlbmd0aCwgMikpLAogICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIGZpbGVSZWNvcmQ6IFIuTE9DQUxfRklMRV9IRUFERVIgKyBFICsgZiArIGIsCiAgICAgICAgICAgICAgICBkaXJSZWNvcmQ6CiAgICAgICAgICAgICAgICAgIFIuQ0VOVFJBTF9GSUxFX0hFQURFUiArCiAgICAgICAgICAgICAgICAgIEEoQywgMikgKwogICAgICAgICAgICAgICAgICBFICsKICAgICAgICAgICAgICAgICAgQShwLmxlbmd0aCwgMikgKwogICAgICAgICAgICAgICAgICAiXDBcMFwwXDAiICsKICAgICAgICAgICAgICAgICAgQSh6LCA0KSArCiAgICAgICAgICAgICAgICAgIEEoaSwgNCkgKwogICAgICAgICAgICAgICAgICBmICsKICAgICAgICAgICAgICAgICAgYiArCiAgICAgICAgICAgICAgICAgIHAsCiAgICAgICAgICAgICAgfQogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICAgdmFyIEkgPSB0KCIuLi91dGlscyIpLAogICAgICAgICAgICBuID0gdCgiLi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKSwKICAgICAgICAgICAgTyA9IHQoIi4uL3V0ZjgiKSwKICAgICAgICAgICAgQiA9IHQoIi4uL2NyYzMyIiksCiAgICAgICAgICAgIFIgPSB0KCIuLi9zaWduYXR1cmUiKTsKICAgICAgICAgIGZ1bmN0aW9uIHModCwgZSwgciwgaSkgewogICAgICAgICAgICBuLmNhbGwodGhpcywgIlppcEZpbGVXb3JrZXIiKSwKICAgICAgICAgICAgICAodGhpcy5ieXRlc1dyaXR0ZW4gPSAwKSwKICAgICAgICAgICAgICAodGhpcy56aXBDb21tZW50ID0gZSksCiAgICAgICAgICAgICAgKHRoaXMuemlwUGxhdGZvcm0gPSByKSwKICAgICAgICAgICAgICAodGhpcy5lbmNvZGVGaWxlTmFtZSA9IGkpLAogICAgICAgICAgICAgICh0aGlzLnN0cmVhbUZpbGVzID0gdCksCiAgICAgICAgICAgICAgKHRoaXMuYWNjdW11bGF0ZSA9ICExKSwKICAgICAgICAgICAgICAodGhpcy5jb250ZW50QnVmZmVyID0gW10pLAogICAgICAgICAgICAgICh0aGlzLmRpclJlY29yZHMgPSBbXSksCiAgICAgICAgICAgICAgKHRoaXMuY3VycmVudFNvdXJjZU9mZnNldCA9IDApLAogICAgICAgICAgICAgICh0aGlzLmVudHJpZXNDb3VudCA9IDApLAogICAgICAgICAgICAgICh0aGlzLmN1cnJlbnRGaWxlID0gbnVsbCksCiAgICAgICAgICAgICAgKHRoaXMuX3NvdXJjZXMgPSBbXSk7CiAgICAgICAgICB9CiAgICAgICAgICBJLmluaGVyaXRzKHMsIG4pLAogICAgICAgICAgICAocy5wcm90b3R5cGUucHVzaCA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIGUgPSB0Lm1ldGEucGVyY2VudCB8fCAwLAogICAgICAgICAgICAgICAgciA9IHRoaXMuZW50cmllc0NvdW50LAogICAgICAgICAgICAgICAgaSA9IHRoaXMuX3NvdXJjZXMubGVuZ3RoOwogICAgICAgICAgICAgIHRoaXMuYWNjdW11bGF0ZQogICAgICAgICAgICAgICAgPyB0aGlzLmNvbnRlbnRCdWZmZXIucHVzaCh0KQogICAgICAgICAgICAgICAgOiAoKHRoaXMuYnl0ZXNXcml0dGVuICs9IHQuZGF0YS5sZW5ndGgpLAogICAgICAgICAgICAgICAgICBuLnByb3RvdHlwZS5wdXNoLmNhbGwodGhpcywgewogICAgICAgICAgICAgICAgICAgIGRhdGE6IHQuZGF0YSwKICAgICAgICAgICAgICAgICAgICBtZXRhOiB7CiAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50RmlsZTogdGhpcy5jdXJyZW50RmlsZSwKICAgICAgICAgICAgICAgICAgICAgIHBlcmNlbnQ6IHIgPyAoZSArIDEwMCAqIChyIC0gaSAtIDEpKSAvIHIgOiAxMDAsCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgfSkpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHMucHJvdG90eXBlLm9wZW5lZFNvdXJjZSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgKHRoaXMuY3VycmVudFNvdXJjZU9mZnNldCA9IHRoaXMuYnl0ZXNXcml0dGVuKSwKICAgICAgICAgICAgICAgICh0aGlzLmN1cnJlbnRGaWxlID0gdC5maWxlLm5hbWUpOwogICAgICAgICAgICAgIHZhciBlID0gdGhpcy5zdHJlYW1GaWxlcyAmJiAhdC5maWxlLmRpcjsKICAgICAgICAgICAgICBpZiAoZSkgewogICAgICAgICAgICAgICAgdmFyIHIgPSBpKAogICAgICAgICAgICAgICAgICB0LAogICAgICAgICAgICAgICAgICBlLAogICAgICAgICAgICAgICAgICAhMSwKICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50U291cmNlT2Zmc2V0LAogICAgICAgICAgICAgICAgICB0aGlzLnppcFBsYXRmb3JtLAogICAgICAgICAgICAgICAgICB0aGlzLmVuY29kZUZpbGVOYW1lLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7IGRhdGE6IHIuZmlsZVJlY29yZCwgbWV0YTogeyBwZXJjZW50OiAwIH0gfSk7CiAgICAgICAgICAgICAgfSBlbHNlIHRoaXMuYWNjdW11bGF0ZSA9ICEwOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHMucHJvdG90eXBlLmNsb3NlZFNvdXJjZSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdGhpcy5hY2N1bXVsYXRlID0gITE7CiAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLnN0cmVhbUZpbGVzICYmICF0LmZpbGUuZGlyLAogICAgICAgICAgICAgICAgciA9IGkoCiAgICAgICAgICAgICAgICAgIHQsCiAgICAgICAgICAgICAgICAgIGUsCiAgICAgICAgICAgICAgICAgICEwLAogICAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRTb3VyY2VPZmZzZXQsCiAgICAgICAgICAgICAgICAgIHRoaXMuemlwUGxhdGZvcm0sCiAgICAgICAgICAgICAgICAgIHRoaXMuZW5jb2RlRmlsZU5hbWUsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGlmICgodGhpcy5kaXJSZWNvcmRzLnB1c2goci5kaXJSZWNvcmQpLCBlKSkKICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7CiAgICAgICAgICAgICAgICAgIGRhdGE6IChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgICAgICAgICBSLkRBVEFfREVTQ1JJUFRPUiArCiAgICAgICAgICAgICAgICAgICAgICBBKHQuY3JjMzIsIDQpICsKICAgICAgICAgICAgICAgICAgICAgIEEodC5jb21wcmVzc2VkU2l6ZSwgNCkgKwogICAgICAgICAgICAgICAgICAgICAgQSh0LnVuY29tcHJlc3NlZFNpemUsIDQpCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgfSkodCksCiAgICAgICAgICAgICAgICAgIG1ldGE6IHsgcGVyY2VudDogMTAwIH0sCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgICB0aGlzLnB1c2goeyBkYXRhOiByLmZpbGVSZWNvcmQsIG1ldGE6IHsgcGVyY2VudDogMCB9IH0pOwogICAgICAgICAgICAgICAgICB0aGlzLmNvbnRlbnRCdWZmZXIubGVuZ3RoOwoKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgdGhpcy5wdXNoKHRoaXMuY29udGVudEJ1ZmZlci5zaGlmdCgpKTsKICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRGaWxlID0gbnVsbDsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChzLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLmJ5dGVzV3JpdHRlbiwgZSA9IDA7CiAgICAgICAgICAgICAgICBlIDwgdGhpcy5kaXJSZWNvcmRzLmxlbmd0aDsKICAgICAgICAgICAgICAgIGUrKwogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7IGRhdGE6IHRoaXMuZGlyUmVjb3Jkc1tlXSwgbWV0YTogeyBwZXJjZW50OiAxMDAgfSB9KTsKICAgICAgICAgICAgICB2YXIgciA9IHRoaXMuYnl0ZXNXcml0dGVuIC0gdCwKICAgICAgICAgICAgICAgIGkgPSAoZnVuY3Rpb24gKHQsIGUsIHIsIGksIG4pIHsKICAgICAgICAgICAgICAgICAgdmFyIHMgPSBJLnRyYW5zZm9ybVRvKCJzdHJpbmciLCBuKGkpKTsKICAgICAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICAgICBSLkNFTlRSQUxfRElSRUNUT1JZX0VORCArCiAgICAgICAgICAgICAgICAgICAgIlwwXDBcMFwwIiArCiAgICAgICAgICAgICAgICAgICAgQSh0LCAyKSArCiAgICAgICAgICAgICAgICAgICAgQSh0LCAyKSArCiAgICAgICAgICAgICAgICAgICAgQShlLCA0KSArCiAgICAgICAgICAgICAgICAgICAgQShyLCA0KSArCiAgICAgICAgICAgICAgICAgICAgQShzLmxlbmd0aCwgMikgKwogICAgICAgICAgICAgICAgICAgIHMKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0pKAogICAgICAgICAgICAgICAgICB0aGlzLmRpclJlY29yZHMubGVuZ3RoLAogICAgICAgICAgICAgICAgICByLAogICAgICAgICAgICAgICAgICB0LAogICAgICAgICAgICAgICAgICB0aGlzLnppcENvbW1lbnQsCiAgICAgICAgICAgICAgICAgIHRoaXMuZW5jb2RlRmlsZU5hbWUsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHRoaXMucHVzaCh7IGRhdGE6IGksIG1ldGE6IHsgcGVyY2VudDogMTAwIH0gfSk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAocy5wcm90b3R5cGUucHJlcGFyZU5leHRTb3VyY2UgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgKHRoaXMucHJldmlvdXMgPSB0aGlzLl9zb3VyY2VzLnNoaWZ0KCkpLAogICAgICAgICAgICAgICAgdGhpcy5vcGVuZWRTb3VyY2UodGhpcy5wcmV2aW91cy5zdHJlYW1JbmZvKSwKICAgICAgICAgICAgICAgIHRoaXMuaXNQYXVzZWQgPyB0aGlzLnByZXZpb3VzLnBhdXNlKCkgOiB0aGlzLnByZXZpb3VzLnJlc3VtZSgpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHMucHJvdG90eXBlLnJlZ2lzdGVyUHJldmlvdXMgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHRoaXMuX3NvdXJjZXMucHVzaCh0KTsKICAgICAgICAgICAgICB2YXIgZSA9IHRoaXM7CiAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgIHQub24oImRhdGEiLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICBlLnByb2Nlc3NDaHVuayh0KTsKICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgdC5vbigiZW5kIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBlLmNsb3NlZFNvdXJjZShlLnByZXZpb3VzLnN0cmVhbUluZm8pLAogICAgICAgICAgICAgICAgICAgIGUuX3NvdXJjZXMubGVuZ3RoID8gZS5wcmVwYXJlTmV4dFNvdXJjZSgpIDogZS5lbmQoKTsKICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgdC5vbigiZXJyb3IiLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICBlLmVycm9yKHQpOwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB0aGlzCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChzLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICEhbi5wcm90b3R5cGUucmVzdW1lLmNhbGwodGhpcykgJiYKICAgICAgICAgICAgICAgICghdGhpcy5wcmV2aW91cyAmJiB0aGlzLl9zb3VyY2VzLmxlbmd0aAogICAgICAgICAgICAgICAgICA/ICh0aGlzLnByZXBhcmVOZXh0U291cmNlKCksICEwKQogICAgICAgICAgICAgICAgICA6IHRoaXMucHJldmlvdXMgfHwgdGhpcy5fc291cmNlcy5sZW5ndGggfHwgdGhpcy5nZW5lcmF0ZWRFcnJvcgogICAgICAgICAgICAgICAgICAgID8gdm9pZCAwCiAgICAgICAgICAgICAgICAgICAgOiAodGhpcy5lbmQoKSwgITApKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAocy5wcm90b3R5cGUuZXJyb3IgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHZhciBlID0gdGhpcy5fc291cmNlczsKICAgICAgICAgICAgICBpZiAoIW4ucHJvdG90eXBlLmVycm9yLmNhbGwodGhpcywgdCkpIHJldHVybiAhMTsKICAgICAgICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IGUubGVuZ3RoOyByKyspCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICBlW3JdLmVycm9yKHQpOwogICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge30KICAgICAgICAgICAgICByZXR1cm4gITA7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAocy5wcm90b3R5cGUubG9jayA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBuLnByb3RvdHlwZS5sb2NrLmNhbGwodGhpcyk7CiAgICAgICAgICAgICAgZm9yICh2YXIgdCA9IHRoaXMuX3NvdXJjZXMsIGUgPSAwOyBlIDwgdC5sZW5ndGg7IGUrKykgdFtlXS5sb2NrKCk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoZS5leHBvcnRzID0gcyk7CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAiLi4vY3JjMzIiOiA0LAogICAgICAgICAgIi4uL3NpZ25hdHVyZSI6IDIzLAogICAgICAgICAgIi4uL3N0cmVhbS9HZW5lcmljV29ya2VyIjogMjgsCiAgICAgICAgICAiLi4vdXRmOCI6IDMxLAogICAgICAgICAgIi4uL3V0aWxzIjogMzIsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgOTogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgdSA9IHQoIi4uL2NvbXByZXNzaW9ucyIpLAogICAgICAgICAgICBpID0gdCgiLi9aaXBGaWxlV29ya2VyIik7CiAgICAgICAgICByLmdlbmVyYXRlV29ya2VyID0gZnVuY3Rpb24gKHQsIGEsIGUpIHsKICAgICAgICAgICAgdmFyIG8gPSBuZXcgaShhLnN0cmVhbUZpbGVzLCBlLCBhLnBsYXRmb3JtLCBhLmVuY29kZUZpbGVOYW1lKSwKICAgICAgICAgICAgICBoID0gMDsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICB0LmZvckVhY2goZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICAgIGgrKzsKICAgICAgICAgICAgICAgIHZhciByID0gKGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSB0IHx8IGUsCiAgICAgICAgICAgICAgICAgICAgICBpID0gdVtyXTsKICAgICAgICAgICAgICAgICAgICBpZiAoIWkpCiAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgICAgIHIgKyAiIGlzIG5vdCBhIHZhbGlkIGNvbXByZXNzaW9uIG1ldGhvZCAhIiwKICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgICAgICAgICAgIH0pKGUub3B0aW9ucy5jb21wcmVzc2lvbiwgYS5jb21wcmVzc2lvbiksCiAgICAgICAgICAgICAgICAgIGkgPQogICAgICAgICAgICAgICAgICAgIGUub3B0aW9ucy5jb21wcmVzc2lvbk9wdGlvbnMgfHwgYS5jb21wcmVzc2lvbk9wdGlvbnMgfHwge30sCiAgICAgICAgICAgICAgICAgIG4gPSBlLmRpciwKICAgICAgICAgICAgICAgICAgcyA9IGUuZGF0ZTsKICAgICAgICAgICAgICAgIGUuX2NvbXByZXNzV29ya2VyKHIsIGkpCiAgICAgICAgICAgICAgICAgIC53aXRoU3RyZWFtSW5mbygiZmlsZSIsIHsKICAgICAgICAgICAgICAgICAgICBuYW1lOiB0LAogICAgICAgICAgICAgICAgICAgIGRpcjogbiwKICAgICAgICAgICAgICAgICAgICBkYXRlOiBzLAogICAgICAgICAgICAgICAgICAgIGNvbW1lbnQ6IGUuY29tbWVudCB8fCAiIiwKICAgICAgICAgICAgICAgICAgICB1bml4UGVybWlzc2lvbnM6IGUudW5peFBlcm1pc3Npb25zLAogICAgICAgICAgICAgICAgICAgIGRvc1Blcm1pc3Npb25zOiBlLmRvc1Blcm1pc3Npb25zLAogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAucGlwZShvKTsKICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIChvLmVudHJpZXNDb3VudCA9IGgpOwogICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgby5lcnJvcih0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbzsKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB7ICIuLi9jb21wcmVzc2lvbnMiOiAzLCAiLi9aaXBGaWxlV29ya2VyIjogOCB9LAogICAgICBdLAogICAgICAxMDogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICBmdW5jdGlvbiBpKCkgewogICAgICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgaSkpIHJldHVybiBuZXcgaSgpOwogICAgICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkKICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAiVGhlIGNvbnN0cnVjdG9yIHdpdGggcGFyYW1ldGVycyBoYXMgYmVlbiByZW1vdmVkIGluIEpTWmlwIDMuMCwgcGxlYXNlIGNoZWNrIHRoZSB1cGdyYWRlIGd1aWRlLiIsCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgKHRoaXMuZmlsZXMgPSBPYmplY3QuY3JlYXRlKG51bGwpKSwKICAgICAgICAgICAgICAodGhpcy5jb21tZW50ID0gbnVsbCksCiAgICAgICAgICAgICAgKHRoaXMucm9vdCA9ICIiKSwKICAgICAgICAgICAgICAodGhpcy5jbG9uZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciB0ID0gbmV3IGkoKTsKICAgICAgICAgICAgICAgIGZvciAodmFyIGUgaW4gdGhpcykKICAgICAgICAgICAgICAgICAgImZ1bmN0aW9uIiAhPSB0eXBlb2YgdGhpc1tlXSAmJiAodFtlXSA9IHRoaXNbZV0pOwogICAgICAgICAgICAgICAgcmV0dXJuIHQ7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICAoKGkucHJvdG90eXBlID0gdCgiLi9vYmplY3QiKSkubG9hZEFzeW5jID0gdCgiLi9sb2FkIikpLAogICAgICAgICAgICAoaS5zdXBwb3J0ID0gdCgiLi9zdXBwb3J0IikpLAogICAgICAgICAgICAoaS5kZWZhdWx0cyA9IHQoIi4vZGVmYXVsdHMiKSksCiAgICAgICAgICAgIChpLnZlcnNpb24gPSAiMy43LjEiKSwKICAgICAgICAgICAgKGkubG9hZEFzeW5jID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICByZXR1cm4gbmV3IGkoKS5sb2FkQXN5bmModCwgZSk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoaS5leHRlcm5hbCA9IHQoIi4vZXh0ZXJuYWwiKSksCiAgICAgICAgICAgIChlLmV4cG9ydHMgPSBpKTsKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICIuL2RlZmF1bHRzIjogNSwKICAgICAgICAgICIuL2V4dGVybmFsIjogNiwKICAgICAgICAgICIuL2xvYWQiOiAxMSwKICAgICAgICAgICIuL29iamVjdCI6IDE1LAogICAgICAgICAgIi4vc3VwcG9ydCI6IDMwLAogICAgICAgIH0sCiAgICAgIF0sCiAgICAgIDExOiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIHZhciBpID0gdCgiLi91dGlscyIpLAogICAgICAgICAgICBuID0gdCgiLi9leHRlcm5hbCIpLAogICAgICAgICAgICBvID0gdCgiLi91dGY4IiksCiAgICAgICAgICAgIGggPSB0KCIuL3ppcEVudHJpZXMiKSwKICAgICAgICAgICAgcyA9IHQoIi4vc3RyZWFtL0NyYzMyUHJvYmUiKSwKICAgICAgICAgICAgdSA9IHQoIi4vbm9kZWpzVXRpbHMiKTsKICAgICAgICAgIGZ1bmN0aW9uIGwoaSkgewogICAgICAgICAgICByZXR1cm4gbmV3IG4uUHJvbWlzZShmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgIHZhciByID0gaS5kZWNvbXByZXNzZWQuZ2V0Q29udGVudFdvcmtlcigpLnBpcGUobmV3IHMoKSk7CiAgICAgICAgICAgICAgci5vbigiZXJyb3IiLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgZSh0KTsKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLm9uKCJlbmQiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHIuc3RyZWFtSW5mby5jcmMzMiAhPT0gaS5kZWNvbXByZXNzZWQuY3JjMzIKICAgICAgICAgICAgICAgICAgICA/IGUobmV3IEVycm9yKCJDb3JydXB0ZWQgemlwIDogQ1JDMzIgbWlzbWF0Y2giKSkKICAgICAgICAgICAgICAgICAgICA6IHQoKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAucmVzdW1lKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKHQsIHMpIHsKICAgICAgICAgICAgdmFyIGEgPSB0aGlzOwogICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgIChzID0gaS5leHRlbmQocyB8fCB7fSwgewogICAgICAgICAgICAgICAgYmFzZTY0OiAhMSwKICAgICAgICAgICAgICAgIGNoZWNrQ1JDMzI6ICExLAogICAgICAgICAgICAgICAgb3B0aW1pemVkQmluYXJ5U3RyaW5nOiAhMSwKICAgICAgICAgICAgICAgIGNyZWF0ZUZvbGRlcnM6ICExLAogICAgICAgICAgICAgICAgZGVjb2RlRmlsZU5hbWU6IG8udXRmOGRlY29kZSwKICAgICAgICAgICAgICB9KSksCiAgICAgICAgICAgICAgdS5pc05vZGUgJiYgdS5pc1N0cmVhbSh0KQogICAgICAgICAgICAgICAgPyBuLlByb21pc2UucmVqZWN0KAogICAgICAgICAgICAgICAgICAgIG5ldyBFcnJvcigKICAgICAgICAgICAgICAgICAgICAgICJKU1ppcCBjYW4ndCBhY2NlcHQgYSBzdHJlYW0gd2hlbiBsb2FkaW5nIGEgemlwIGZpbGUuIiwKICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICA6IGkKICAgICAgICAgICAgICAgICAgICAucHJlcGFyZUNvbnRlbnQoCiAgICAgICAgICAgICAgICAgICAgICAidGhlIGxvYWRlZCB6aXAgZmlsZSIsCiAgICAgICAgICAgICAgICAgICAgICB0LAogICAgICAgICAgICAgICAgICAgICAgITAsCiAgICAgICAgICAgICAgICAgICAgICBzLm9wdGltaXplZEJpbmFyeVN0cmluZywKICAgICAgICAgICAgICAgICAgICAgIHMuYmFzZTY0LAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBuZXcgaChzKTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlLmxvYWQodCksIGU7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSBbbi5Qcm9taXNlLnJlc29sdmUodCldLAogICAgICAgICAgICAgICAgICAgICAgICByID0gdC5maWxlczsKICAgICAgICAgICAgICAgICAgICAgIGlmIChzLmNoZWNrQ1JDMzIpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgci5sZW5ndGg7IGkrKykgZS5wdXNoKGwocltpXSkpOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4uUHJvbWlzZS5hbGwoZSk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSB0LnNoaWZ0KCksIHIgPSBlLmZpbGVzLCBpID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgaSA8IHIubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICBpKysKICAgICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgbiA9IHJbaV07CiAgICAgICAgICAgICAgICAgICAgICAgIGEuZmlsZShuLmZpbGVOYW1lU3RyLCBuLmRlY29tcHJlc3NlZCwgewogICAgICAgICAgICAgICAgICAgICAgICAgIGJpbmFyeTogITAsCiAgICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW1pemVkQmluYXJ5U3RyaW5nOiAhMCwKICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlOiBuLmRhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGlyOiBuLmRpciwKICAgICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50OiBuLmZpbGVDb21tZW50U3RyLmxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBuLmZpbGVDb21tZW50U3RyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IG51bGwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgdW5peFBlcm1pc3Npb25zOiBuLnVuaXhQZXJtaXNzaW9ucywKICAgICAgICAgICAgICAgICAgICAgICAgICBkb3NQZXJtaXNzaW9uczogbi5kb3NQZXJtaXNzaW9ucywKICAgICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVGb2xkZXJzOiBzLmNyZWF0ZUZvbGRlcnMsCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICAgICAgICAgZS56aXBDb21tZW50Lmxlbmd0aCAmJiAoYS5jb21tZW50ID0gZS56aXBDb21tZW50KSwgYQogICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICApOwogICAgICAgICAgfTsKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICIuL2V4dGVybmFsIjogNiwKICAgICAgICAgICIuL25vZGVqc1V0aWxzIjogMTQsCiAgICAgICAgICAiLi9zdHJlYW0vQ3JjMzJQcm9iZSI6IDI1LAogICAgICAgICAgIi4vdXRmOCI6IDMxLAogICAgICAgICAgIi4vdXRpbHMiOiAzMiwKICAgICAgICAgICIuL3ppcEVudHJpZXMiOiAzMywKICAgICAgICB9LAogICAgICBdLAogICAgICAxMjogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9IHQoIi4uL3V0aWxzIiksCiAgICAgICAgICAgIG4gPSB0KCIuLi9zdHJlYW0vR2VuZXJpY1dvcmtlciIpOwogICAgICAgICAgZnVuY3Rpb24gcyh0LCBlKSB7CiAgICAgICAgICAgIG4uY2FsbCh0aGlzLCAiTm9kZWpzIHN0cmVhbSBpbnB1dCBhZGFwdGVyIGZvciAiICsgdCksCiAgICAgICAgICAgICAgKHRoaXMuX3Vwc3RyZWFtRW5kZWQgPSAhMSksCiAgICAgICAgICAgICAgdGhpcy5fYmluZFN0cmVhbShlKTsKICAgICAgICAgIH0KICAgICAgICAgIGkuaW5oZXJpdHMocywgbiksCiAgICAgICAgICAgIChzLnByb3RvdHlwZS5fYmluZFN0cmVhbSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzOwogICAgICAgICAgICAgICh0aGlzLl9zdHJlYW0gPSB0KS5wYXVzZSgpLAogICAgICAgICAgICAgICAgdAogICAgICAgICAgICAgICAgICAub24oImRhdGEiLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgIGUucHVzaCh7IGRhdGE6IHQsIG1ldGE6IHsgcGVyY2VudDogMCB9IH0pOwogICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAub24oImVycm9yIiwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgICAgICBlLmlzUGF1c2VkID8gKHRoaXMuZ2VuZXJhdGVkRXJyb3IgPSB0KSA6IGUuZXJyb3IodCk7CiAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgIC5vbigiZW5kIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgIGUuaXNQYXVzZWQgPyAoZS5fdXBzdHJlYW1FbmRlZCA9ICEwKSA6IGUuZW5kKCk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHMucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgICAhIW4ucHJvdG90eXBlLnBhdXNlLmNhbGwodGhpcykgJiYgKHRoaXMuX3N0cmVhbS5wYXVzZSgpLCAhMCkKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHMucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgISFuLnByb3RvdHlwZS5yZXN1bWUuY2FsbCh0aGlzKSAmJgogICAgICAgICAgICAgICAgKHRoaXMuX3Vwc3RyZWFtRW5kZWQgPyB0aGlzLmVuZCgpIDogdGhpcy5fc3RyZWFtLnJlc3VtZSgpLCAhMCkKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGUuZXhwb3J0cyA9IHMpOwogICAgICAgIH0sCiAgICAgICAgeyAiLi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiOiAyOCwgIi4uL3V0aWxzIjogMzIgfSwKICAgICAgXSwKICAgICAgMTM6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIG4gPSB0KCJyZWFkYWJsZS1zdHJlYW0iKS5SZWFkYWJsZTsKICAgICAgICAgIGZ1bmN0aW9uIGkodCwgZSwgcikgewogICAgICAgICAgICBuLmNhbGwodGhpcywgZSksICh0aGlzLl9oZWxwZXIgPSB0KTsKICAgICAgICAgICAgdmFyIGkgPSB0aGlzOwogICAgICAgICAgICB0Lm9uKCJkYXRhIiwgZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICBpLnB1c2godCkgfHwgaS5faGVscGVyLnBhdXNlKCksIHIgJiYgcihlKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAub24oImVycm9yIiwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgIGkuZW1pdCgiZXJyb3IiLCB0KTsKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIC5vbigiZW5kIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgaS5wdXNoKG51bGwpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgdCgiLi4vdXRpbHMiKS5pbmhlcml0cyhpLCBuKSwKICAgICAgICAgICAgKGkucHJvdG90eXBlLl9yZWFkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHRoaXMuX2hlbHBlci5yZXN1bWUoKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChlLmV4cG9ydHMgPSBpKTsKICAgICAgICB9LAogICAgICAgIHsgIi4uL3V0aWxzIjogMzIsICJyZWFkYWJsZS1zdHJlYW0iOiAxNiB9LAogICAgICBdLAogICAgICAxNDogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICBlLmV4cG9ydHMgPSB7CiAgICAgICAgICAgIGlzTm9kZTogInVuZGVmaW5lZCIgIT0gdHlwZW9mIEJ1ZmZlciwKICAgICAgICAgICAgbmV3QnVmZmVyRnJvbTogZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICBpZiAoQnVmZmVyLmZyb20gJiYgQnVmZmVyLmZyb20gIT09IFVpbnQ4QXJyYXkuZnJvbSkKICAgICAgICAgICAgICAgIHJldHVybiBCdWZmZXIuZnJvbSh0LCBlKTsKICAgICAgICAgICAgICBpZiAoIm51bWJlciIgPT0gdHlwZW9mIHQpCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSAiZGF0YSIgYXJndW1lbnQgbXVzdCBub3QgYmUgYSBudW1iZXInKTsKICAgICAgICAgICAgICByZXR1cm4gbmV3IEJ1ZmZlcih0LCBlKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYWxsb2NCdWZmZXI6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgaWYgKEJ1ZmZlci5hbGxvYykgcmV0dXJuIEJ1ZmZlci5hbGxvYyh0KTsKICAgICAgICAgICAgICB2YXIgZSA9IG5ldyBCdWZmZXIodCk7CiAgICAgICAgICAgICAgcmV0dXJuIGUuZmlsbCgwKSwgZTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaXNCdWZmZXI6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIEJ1ZmZlci5pc0J1ZmZlcih0KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgaXNTdHJlYW06IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgIHQgJiYKICAgICAgICAgICAgICAgICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQub24gJiYKICAgICAgICAgICAgICAgICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQucGF1c2UgJiYKICAgICAgICAgICAgICAgICJmdW5jdGlvbiIgPT0gdHlwZW9mIHQucmVzdW1lCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB7fSwKICAgICAgXSwKICAgICAgMTU6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgZnVuY3Rpb24gcyh0LCBlLCByKSB7CiAgICAgICAgICAgIHZhciBpLAogICAgICAgICAgICAgIG4gPSB1LmdldFR5cGVPZihlKSwKICAgICAgICAgICAgICBzID0gdS5leHRlbmQociB8fCB7fSwgZik7CiAgICAgICAgICAgIChzLmRhdGUgPSBzLmRhdGUgfHwgbmV3IERhdGUoKSksCiAgICAgICAgICAgICAgbnVsbCAhPT0gcy5jb21wcmVzc2lvbiAmJgogICAgICAgICAgICAgICAgKHMuY29tcHJlc3Npb24gPSBzLmNvbXByZXNzaW9uLnRvVXBwZXJDYXNlKCkpLAogICAgICAgICAgICAgICJzdHJpbmciID09IHR5cGVvZiBzLnVuaXhQZXJtaXNzaW9ucyAmJgogICAgICAgICAgICAgICAgKHMudW5peFBlcm1pc3Npb25zID0gcGFyc2VJbnQocy51bml4UGVybWlzc2lvbnMsIDgpKSwKICAgICAgICAgICAgICBzLnVuaXhQZXJtaXNzaW9ucyAmJiAxNjM4NCAmIHMudW5peFBlcm1pc3Npb25zICYmIChzLmRpciA9ICEwKSwKICAgICAgICAgICAgICBzLmRvc1Blcm1pc3Npb25zICYmIDE2ICYgcy5kb3NQZXJtaXNzaW9ucyAmJiAocy5kaXIgPSAhMCksCiAgICAgICAgICAgICAgcy5kaXIgJiYgKHQgPSBnKHQpKSwKICAgICAgICAgICAgICBzLmNyZWF0ZUZvbGRlcnMgJiYgKGkgPSBfKHQpKSAmJiBiLmNhbGwodGhpcywgaSwgITApOwogICAgICAgICAgICB2YXIgYSA9ICJzdHJpbmciID09PSBuICYmICExID09PSBzLmJpbmFyeSAmJiAhMSA9PT0gcy5iYXNlNjQ7CiAgICAgICAgICAgIChyICYmIHZvaWQgMCAhPT0gci5iaW5hcnkpIHx8IChzLmJpbmFyeSA9ICFhKSwKICAgICAgICAgICAgICAoKGUgaW5zdGFuY2VvZiBkICYmIDAgPT09IGUudW5jb21wcmVzc2VkU2l6ZSkgfHwKICAgICAgICAgICAgICAgIHMuZGlyIHx8CiAgICAgICAgICAgICAgICAhZSB8fAogICAgICAgICAgICAgICAgMCA9PT0gZS5sZW5ndGgpICYmCiAgICAgICAgICAgICAgICAoKHMuYmFzZTY0ID0gITEpLAogICAgICAgICAgICAgICAgKHMuYmluYXJ5ID0gITApLAogICAgICAgICAgICAgICAgKGUgPSAiIiksCiAgICAgICAgICAgICAgICAocy5jb21wcmVzc2lvbiA9ICJTVE9SRSIpLAogICAgICAgICAgICAgICAgKG4gPSAic3RyaW5nIikpOwogICAgICAgICAgICB2YXIgbyA9IG51bGw7CiAgICAgICAgICAgIG8gPQogICAgICAgICAgICAgIGUgaW5zdGFuY2VvZiBkIHx8IGUgaW5zdGFuY2VvZiBsCiAgICAgICAgICAgICAgICA/IGUKICAgICAgICAgICAgICAgIDogcC5pc05vZGUgJiYgcC5pc1N0cmVhbShlKQogICAgICAgICAgICAgICAgICA/IG5ldyBtKHQsIGUpCiAgICAgICAgICAgICAgICAgIDogdS5wcmVwYXJlQ29udGVudCgKICAgICAgICAgICAgICAgICAgICAgIHQsCiAgICAgICAgICAgICAgICAgICAgICBlLAogICAgICAgICAgICAgICAgICAgICAgcy5iaW5hcnksCiAgICAgICAgICAgICAgICAgICAgICBzLm9wdGltaXplZEJpbmFyeVN0cmluZywKICAgICAgICAgICAgICAgICAgICAgIHMuYmFzZTY0LAogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIHZhciBoID0gbmV3IGModCwgbywgcyk7CiAgICAgICAgICAgIHRoaXMuZmlsZXNbdF0gPSBoOwogICAgICAgICAgfQogICAgICAgICAgdmFyIG4gPSB0KCIuL3V0ZjgiKSwKICAgICAgICAgICAgdSA9IHQoIi4vdXRpbHMiKSwKICAgICAgICAgICAgbCA9IHQoIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiKSwKICAgICAgICAgICAgYSA9IHQoIi4vc3RyZWFtL1N0cmVhbUhlbHBlciIpLAogICAgICAgICAgICBmID0gdCgiLi9kZWZhdWx0cyIpLAogICAgICAgICAgICBkID0gdCgiLi9jb21wcmVzc2VkT2JqZWN0IiksCiAgICAgICAgICAgIGMgPSB0KCIuL3ppcE9iamVjdCIpLAogICAgICAgICAgICBvID0gdCgiLi9nZW5lcmF0ZSIpLAogICAgICAgICAgICBwID0gdCgiLi9ub2RlanNVdGlscyIpLAogICAgICAgICAgICBtID0gdCgiLi9ub2RlanMvTm9kZWpzU3RyZWFtSW5wdXRBZGFwdGVyIiksCiAgICAgICAgICAgIF8gPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICIvIiA9PT0gdC5zbGljZSgtMSkgJiYgKHQgPSB0LnN1YnN0cmluZygwLCB0Lmxlbmd0aCAtIDEpKTsKICAgICAgICAgICAgICB2YXIgZSA9IHQubGFzdEluZGV4T2YoIi8iKTsKICAgICAgICAgICAgICByZXR1cm4gMCA8IGUgPyB0LnN1YnN0cmluZygwLCBlKSA6ICIiOwogICAgICAgICAgICB9LAogICAgICAgICAgICBnID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICByZXR1cm4gIi8iICE9PSB0LnNsaWNlKC0xKSAmJiAodCArPSAiLyIpLCB0OwogICAgICAgICAgICB9LAogICAgICAgICAgICBiID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgKGUgPSB2b2lkIDAgIT09IGUgPyBlIDogZi5jcmVhdGVGb2xkZXJzKSwKICAgICAgICAgICAgICAgICh0ID0gZyh0KSksCiAgICAgICAgICAgICAgICB0aGlzLmZpbGVzW3RdIHx8CiAgICAgICAgICAgICAgICAgIHMuY2FsbCh0aGlzLCB0LCBudWxsLCB7IGRpcjogITAsIGNyZWF0ZUZvbGRlcnM6IGUgfSksCiAgICAgICAgICAgICAgICB0aGlzLmZpbGVzW3RdCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfTsKICAgICAgICAgIGZ1bmN0aW9uIGgodCkgewogICAgICAgICAgICByZXR1cm4gIltvYmplY3QgUmVnRXhwXSIgPT09IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KTsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBpID0gewogICAgICAgICAgICBsb2FkOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgICAgICAgICAgIlRoaXMgbWV0aG9kIGhhcyBiZWVuIHJlbW92ZWQgaW4gSlNaaXAgMy4wLCBwbGVhc2UgY2hlY2sgdGhlIHVwZ3JhZGUgZ3VpZGUuIiwKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9LAogICAgICAgICAgICBmb3JFYWNoOiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHZhciBlLCByLCBpOwogICAgICAgICAgICAgIGZvciAoZSBpbiB0aGlzLmZpbGVzKQogICAgICAgICAgICAgICAgKGkgPSB0aGlzLmZpbGVzW2VdKSwKICAgICAgICAgICAgICAgICAgKHIgPSBlLnNsaWNlKHRoaXMucm9vdC5sZW5ndGgsIGUubGVuZ3RoKSkgJiYKICAgICAgICAgICAgICAgICAgICBlLnNsaWNlKDAsIHRoaXMucm9vdC5sZW5ndGgpID09PSB0aGlzLnJvb3QgJiYKICAgICAgICAgICAgICAgICAgICB0KHIsIGkpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBmaWx0ZXI6IGZ1bmN0aW9uIChyKSB7CiAgICAgICAgICAgICAgdmFyIGkgPSBbXTsKICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgdGhpcy5mb3JFYWNoKGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICAgIHIodCwgZSkgJiYgaS5wdXNoKGUpOwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICBpCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZmlsZTogZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICAgICBpZiAoMSAhPT0gYXJndW1lbnRzLmxlbmd0aCkKICAgICAgICAgICAgICAgIHJldHVybiAodCA9IHRoaXMucm9vdCArIHQpLCBzLmNhbGwodGhpcywgdCwgZSwgciksIHRoaXM7CiAgICAgICAgICAgICAgaWYgKGgodCkpIHsKICAgICAgICAgICAgICAgIHZhciBpID0gdDsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgICAgICByZXR1cm4gIWUuZGlyICYmIGkudGVzdCh0KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB2YXIgbiA9IHRoaXMuZmlsZXNbdGhpcy5yb290ICsgdF07CiAgICAgICAgICAgICAgcmV0dXJuIG4gJiYgIW4uZGlyID8gbiA6IG51bGw7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGZvbGRlcjogZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICBpZiAoIXIpIHJldHVybiB0aGlzOwogICAgICAgICAgICAgIGlmIChoKHIpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmlsdGVyKGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlLmRpciAmJiByLnRlc3QodCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB2YXIgdCA9IHRoaXMucm9vdCArIHIsCiAgICAgICAgICAgICAgICBlID0gYi5jYWxsKHRoaXMsIHQpLAogICAgICAgICAgICAgICAgaSA9IHRoaXMuY2xvbmUoKTsKICAgICAgICAgICAgICByZXR1cm4gKGkucm9vdCA9IGUubmFtZSksIGk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24gKHIpIHsKICAgICAgICAgICAgICByID0gdGhpcy5yb290ICsgcjsKICAgICAgICAgICAgICB2YXIgdCA9IHRoaXMuZmlsZXNbcl07CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgKHQgfHwgKCIvIiAhPT0gci5zbGljZSgtMSkgJiYgKHIgKz0gIi8iKSwgKHQgPSB0aGlzLmZpbGVzW3JdKSksCiAgICAgICAgICAgICAgICB0ICYmICF0LmRpcikKICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBkZWxldGUgdGhpcy5maWxlc1tyXTsKICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuZmlsdGVyKGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZS5uYW1lLnNsaWNlKDAsIHIubGVuZ3RoKSA9PT0gcjsKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICBpID0gMDsKICAgICAgICAgICAgICAgICAgaSA8IGUubGVuZ3RoOwogICAgICAgICAgICAgICAgICBpKysKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgZGVsZXRlIHRoaXMuZmlsZXNbZVtpXS5uYW1lXTsKICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZ2VuZXJhdGU6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgICAgICAgICAgIlRoaXMgbWV0aG9kIGhhcyBiZWVuIHJlbW92ZWQgaW4gSlNaaXAgMy4wLCBwbGVhc2UgY2hlY2sgdGhlIHVwZ3JhZGUgZ3VpZGUuIiwKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9LAogICAgICAgICAgICBnZW5lcmF0ZUludGVybmFsU3RyZWFtOiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHZhciBlLAogICAgICAgICAgICAgICAgciA9IHt9OwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICgoKHIgPSB1LmV4dGVuZCh0IHx8IHt9LCB7CiAgICAgICAgICAgICAgICAgICAgc3RyZWFtRmlsZXM6ICExLAogICAgICAgICAgICAgICAgICAgIGNvbXByZXNzaW9uOiAiU1RPUkUiLAogICAgICAgICAgICAgICAgICAgIGNvbXByZXNzaW9uT3B0aW9uczogbnVsbCwKICAgICAgICAgICAgICAgICAgICB0eXBlOiAiIiwKICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybTogIkRPUyIsCiAgICAgICAgICAgICAgICAgICAgY29tbWVudDogbnVsbCwKICAgICAgICAgICAgICAgICAgICBtaW1lVHlwZTogImFwcGxpY2F0aW9uL3ppcCIsCiAgICAgICAgICAgICAgICAgICAgZW5jb2RlRmlsZU5hbWU6IG4udXRmOGVuY29kZSwKICAgICAgICAgICAgICAgICAgfSkpLnR5cGUgPSByLnR5cGUudG9Mb3dlckNhc2UoKSksCiAgICAgICAgICAgICAgICAgIChyLmNvbXByZXNzaW9uID0gci5jb21wcmVzc2lvbi50b1VwcGVyQ2FzZSgpKSwKICAgICAgICAgICAgICAgICAgImJpbmFyeXN0cmluZyIgPT09IHIudHlwZSAmJiAoci50eXBlID0gInN0cmluZyIpLAogICAgICAgICAgICAgICAgICAhci50eXBlKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIk5vIG91dHB1dCB0eXBlIHNwZWNpZmllZC4iKTsKICAgICAgICAgICAgICAgIHUuY2hlY2tTdXBwb3J0KHIudHlwZSksCiAgICAgICAgICAgICAgICAgICgiZGFyd2luIiAhPT0gci5wbGF0Zm9ybSAmJgogICAgICAgICAgICAgICAgICAgICJmcmVlYnNkIiAhPT0gci5wbGF0Zm9ybSAmJgogICAgICAgICAgICAgICAgICAgICJsaW51eCIgIT09IHIucGxhdGZvcm0gJiYKICAgICAgICAgICAgICAgICAgICAic3Vub3MiICE9PSByLnBsYXRmb3JtKSB8fAogICAgICAgICAgICAgICAgICAgIChyLnBsYXRmb3JtID0gIlVOSVgiKSwKICAgICAgICAgICAgICAgICAgIndpbjMyIiA9PT0gci5wbGF0Zm9ybSAmJiAoci5wbGF0Zm9ybSA9ICJET1MiKTsKICAgICAgICAgICAgICAgIHZhciBpID0gci5jb21tZW50IHx8IHRoaXMuY29tbWVudCB8fCAiIjsKICAgICAgICAgICAgICAgIGUgPSBvLmdlbmVyYXRlV29ya2VyKHRoaXMsIHIsIGkpOwogICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgIChlID0gbmV3IGwoImVycm9yIikpLmVycm9yKHQpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gbmV3IGEoZSwgci50eXBlIHx8ICJzdHJpbmciLCByLm1pbWVUeXBlKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZ2VuZXJhdGVBc3luYzogZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZUludGVybmFsU3RyZWFtKHQpLmFjY3VtdWxhdGUoZSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGdlbmVyYXRlTm9kZVN0cmVhbTogZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgKHQgPSB0IHx8IHt9KS50eXBlIHx8ICh0LnR5cGUgPSAibm9kZWJ1ZmZlciIpLAogICAgICAgICAgICAgICAgdGhpcy5nZW5lcmF0ZUludGVybmFsU3RyZWFtKHQpLnRvTm9kZWpzU3RyZWFtKGUpCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH07CiAgICAgICAgICBlLmV4cG9ydHMgPSBpOwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIi4vY29tcHJlc3NlZE9iamVjdCI6IDIsCiAgICAgICAgICAiLi9kZWZhdWx0cyI6IDUsCiAgICAgICAgICAiLi9nZW5lcmF0ZSI6IDksCiAgICAgICAgICAiLi9ub2RlanMvTm9kZWpzU3RyZWFtSW5wdXRBZGFwdGVyIjogMTIsCiAgICAgICAgICAiLi9ub2RlanNVdGlscyI6IDE0LAogICAgICAgICAgIi4vc3RyZWFtL0dlbmVyaWNXb3JrZXIiOiAyOCwKICAgICAgICAgICIuL3N0cmVhbS9TdHJlYW1IZWxwZXIiOiAyOSwKICAgICAgICAgICIuL3V0ZjgiOiAzMSwKICAgICAgICAgICIuL3V0aWxzIjogMzIsCiAgICAgICAgICAiLi96aXBPYmplY3QiOiAzNSwKICAgICAgICB9LAogICAgICBdLAogICAgICAxNjogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICBlLmV4cG9ydHMgPSB0KCJzdHJlYW0iKTsKICAgICAgICB9LAogICAgICAgIHsgc3RyZWFtOiB2b2lkIDAgfSwKICAgICAgXSwKICAgICAgMTc6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIGkgPSB0KCIuL0RhdGFSZWFkZXIiKTsKICAgICAgICAgIGZ1bmN0aW9uIG4odCkgewogICAgICAgICAgICBpLmNhbGwodGhpcywgdCk7CiAgICAgICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgdGhpcy5kYXRhLmxlbmd0aDsgZSsrKSB0W2VdID0gMjU1ICYgdFtlXTsKICAgICAgICAgIH0KICAgICAgICAgIHQoIi4uL3V0aWxzIikuaW5oZXJpdHMobiwgaSksCiAgICAgICAgICAgIChuLnByb3RvdHlwZS5ieXRlQXQgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFbdGhpcy56ZXJvICsgdF07CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAobi5wcm90b3R5cGUubGFzdEluZGV4T2ZTaWduYXR1cmUgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICB2YXIgZSA9IHQuY2hhckNvZGVBdCgwKSwKICAgICAgICAgICAgICAgICAgciA9IHQuY2hhckNvZGVBdCgxKSwKICAgICAgICAgICAgICAgICAgaSA9IHQuY2hhckNvZGVBdCgyKSwKICAgICAgICAgICAgICAgICAgbiA9IHQuY2hhckNvZGVBdCgzKSwKICAgICAgICAgICAgICAgICAgcyA9IHRoaXMubGVuZ3RoIC0gNDsKICAgICAgICAgICAgICAgIDAgPD0gczsKICAgICAgICAgICAgICAgIC0tcwogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhW3NdID09PSBlICYmCiAgICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtzICsgMV0gPT09IHIgJiYKICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhW3MgKyAyXSA9PT0gaSAmJgogICAgICAgICAgICAgICAgICB0aGlzLmRhdGFbcyArIDNdID09PSBuCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIHJldHVybiBzIC0gdGhpcy56ZXJvOwogICAgICAgICAgICAgIHJldHVybiAtMTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChuLnByb3RvdHlwZS5yZWFkQW5kQ2hlY2tTaWduYXR1cmUgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHZhciBlID0gdC5jaGFyQ29kZUF0KDApLAogICAgICAgICAgICAgICAgciA9IHQuY2hhckNvZGVBdCgxKSwKICAgICAgICAgICAgICAgIGkgPSB0LmNoYXJDb2RlQXQoMiksCiAgICAgICAgICAgICAgICBuID0gdC5jaGFyQ29kZUF0KDMpLAogICAgICAgICAgICAgICAgcyA9IHRoaXMucmVhZERhdGEoNCk7CiAgICAgICAgICAgICAgcmV0dXJuIGUgPT09IHNbMF0gJiYgciA9PT0gc1sxXSAmJiBpID09PSBzWzJdICYmIG4gPT09IHNbM107CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAobi5wcm90b3R5cGUucmVhZERhdGEgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGlmICgodGhpcy5jaGVja09mZnNldCh0KSwgMCA9PT0gdCkpIHJldHVybiBbXTsKICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuZGF0YS5zbGljZSgKICAgICAgICAgICAgICAgIHRoaXMuemVybyArIHRoaXMuaW5kZXgsCiAgICAgICAgICAgICAgICB0aGlzLnplcm8gKyB0aGlzLmluZGV4ICsgdCwKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHJldHVybiAodGhpcy5pbmRleCArPSB0KSwgZTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChlLmV4cG9ydHMgPSBuKTsKICAgICAgICB9LAogICAgICAgIHsgIi4uL3V0aWxzIjogMzIsICIuL0RhdGFSZWFkZXIiOiAxOCB9LAogICAgICBdLAogICAgICAxODogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9IHQoIi4uL3V0aWxzIik7CiAgICAgICAgICBmdW5jdGlvbiBuKHQpIHsKICAgICAgICAgICAgKHRoaXMuZGF0YSA9IHQpLAogICAgICAgICAgICAgICh0aGlzLmxlbmd0aCA9IHQubGVuZ3RoKSwKICAgICAgICAgICAgICAodGhpcy5pbmRleCA9IDApLAogICAgICAgICAgICAgICh0aGlzLnplcm8gPSAwKTsKICAgICAgICAgIH0KICAgICAgICAgIChuLnByb3RvdHlwZSA9IHsKICAgICAgICAgICAgY2hlY2tPZmZzZXQ6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdGhpcy5jaGVja0luZGV4KHRoaXMuaW5kZXggKyB0KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgY2hlY2tJbmRleDogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBpZiAodGhpcy5sZW5ndGggPCB0aGlzLnplcm8gKyB0IHx8IHQgPCAwKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgICAgICAgICAgICAiRW5kIG9mIGRhdGEgcmVhY2hlZCAoZGF0YSBsZW5ndGggPSAiICsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxlbmd0aCArCiAgICAgICAgICAgICAgICAgICAgIiwgYXNrZWQgaW5kZXggPSAiICsKICAgICAgICAgICAgICAgICAgICB0ICsKICAgICAgICAgICAgICAgICAgICAiKS4gQ29ycnVwdGVkIHppcCA/IiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHNldEluZGV4OiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHRoaXMuY2hlY2tJbmRleCh0KSwgKHRoaXMuaW5kZXggPSB0KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgc2tpcDogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICB0aGlzLnNldEluZGV4KHRoaXMuaW5kZXggKyB0KTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYnl0ZUF0OiBmdW5jdGlvbiAodCkge30sCiAgICAgICAgICAgIHJlYWRJbnQ6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIGUsCiAgICAgICAgICAgICAgICByID0gMDsKICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgdGhpcy5jaGVja09mZnNldCh0KSwgZSA9IHRoaXMuaW5kZXggKyB0IC0gMTsKICAgICAgICAgICAgICAgIGUgPj0gdGhpcy5pbmRleDsKICAgICAgICAgICAgICAgIGUtLQogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHIgPSAociA8PCA4KSArIHRoaXMuYnl0ZUF0KGUpOwogICAgICAgICAgICAgIHJldHVybiAodGhpcy5pbmRleCArPSB0KSwgcjsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcmVhZFN0cmluZzogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICByZXR1cm4gaS50cmFuc2Zvcm1Ubygic3RyaW5nIiwgdGhpcy5yZWFkRGF0YSh0KSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlYWREYXRhOiBmdW5jdGlvbiAodCkge30sCiAgICAgICAgICAgIGxhc3RJbmRleE9mU2lnbmF0dXJlOiBmdW5jdGlvbiAodCkge30sCiAgICAgICAgICAgIHJlYWRBbmRDaGVja1NpZ25hdHVyZTogZnVuY3Rpb24gKHQpIHt9LAogICAgICAgICAgICByZWFkRGF0ZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHZhciB0ID0gdGhpcy5yZWFkSW50KDQpOwogICAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZSgKICAgICAgICAgICAgICAgIERhdGUuVVRDKAogICAgICAgICAgICAgICAgICAxOTgwICsgKCh0ID4+IDI1KSAmIDEyNyksCiAgICAgICAgICAgICAgICAgICgodCA+PiAyMSkgJiAxNSkgLSAxLAogICAgICAgICAgICAgICAgICAodCA+PiAxNikgJiAzMSwKICAgICAgICAgICAgICAgICAgKHQgPj4gMTEpICYgMzEsCiAgICAgICAgICAgICAgICAgICh0ID4+IDUpICYgNjMsCiAgICAgICAgICAgICAgICAgICgzMSAmIHQpIDw8IDEsCiAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KSwKICAgICAgICAgICAgKGUuZXhwb3J0cyA9IG4pOwogICAgICAgIH0sCiAgICAgICAgeyAiLi4vdXRpbHMiOiAzMiB9LAogICAgICBdLAogICAgICAxOTogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9IHQoIi4vVWludDhBcnJheVJlYWRlciIpOwogICAgICAgICAgZnVuY3Rpb24gbih0KSB7CiAgICAgICAgICAgIGkuY2FsbCh0aGlzLCB0KTsKICAgICAgICAgIH0KICAgICAgICAgIHQoIi4uL3V0aWxzIikuaW5oZXJpdHMobiwgaSksCiAgICAgICAgICAgIChuLnByb3RvdHlwZS5yZWFkRGF0YSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdGhpcy5jaGVja09mZnNldCh0KTsKICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuZGF0YS5zbGljZSgKICAgICAgICAgICAgICAgIHRoaXMuemVybyArIHRoaXMuaW5kZXgsCiAgICAgICAgICAgICAgICB0aGlzLnplcm8gKyB0aGlzLmluZGV4ICsgdCwKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHJldHVybiAodGhpcy5pbmRleCArPSB0KSwgZTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChlLmV4cG9ydHMgPSBuKTsKICAgICAgICB9LAogICAgICAgIHsgIi4uL3V0aWxzIjogMzIsICIuL1VpbnQ4QXJyYXlSZWFkZXIiOiAyMSB9LAogICAgICBdLAogICAgICAyMDogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9IHQoIi4vRGF0YVJlYWRlciIpOwogICAgICAgICAgZnVuY3Rpb24gbih0KSB7CiAgICAgICAgICAgIGkuY2FsbCh0aGlzLCB0KTsKICAgICAgICAgIH0KICAgICAgICAgIHQoIi4uL3V0aWxzIikuaW5oZXJpdHMobiwgaSksCiAgICAgICAgICAgIChuLnByb3RvdHlwZS5ieXRlQXQgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEuY2hhckNvZGVBdCh0aGlzLnplcm8gKyB0KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChuLnByb3RvdHlwZS5sYXN0SW5kZXhPZlNpZ25hdHVyZSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5sYXN0SW5kZXhPZih0KSAtIHRoaXMuemVybzsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChuLnByb3RvdHlwZS5yZWFkQW5kQ2hlY2tTaWduYXR1cmUgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHJldHVybiB0ID09PSB0aGlzLnJlYWREYXRhKDQpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKG4ucHJvdG90eXBlLnJlYWREYXRhID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICB0aGlzLmNoZWNrT2Zmc2V0KHQpOwogICAgICAgICAgICAgIHZhciBlID0gdGhpcy5kYXRhLnNsaWNlKAogICAgICAgICAgICAgICAgdGhpcy56ZXJvICsgdGhpcy5pbmRleCwKICAgICAgICAgICAgICAgIHRoaXMuemVybyArIHRoaXMuaW5kZXggKyB0LAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLmluZGV4ICs9IHQpLCBlOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGUuZXhwb3J0cyA9IG4pOwogICAgICAgIH0sCiAgICAgICAgeyAiLi4vdXRpbHMiOiAzMiwgIi4vRGF0YVJlYWRlciI6IDE4IH0sCiAgICAgIF0sCiAgICAgIDIxOiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIHZhciBpID0gdCgiLi9BcnJheVJlYWRlciIpOwogICAgICAgICAgZnVuY3Rpb24gbih0KSB7CiAgICAgICAgICAgIGkuY2FsbCh0aGlzLCB0KTsKICAgICAgICAgIH0KICAgICAgICAgIHQoIi4uL3V0aWxzIikuaW5oZXJpdHMobiwgaSksCiAgICAgICAgICAgIChuLnByb3RvdHlwZS5yZWFkRGF0YSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgaWYgKCh0aGlzLmNoZWNrT2Zmc2V0KHQpLCAwID09PSB0KSkgcmV0dXJuIG5ldyBVaW50OEFycmF5KDApOwogICAgICAgICAgICAgIHZhciBlID0gdGhpcy5kYXRhLnN1YmFycmF5KAogICAgICAgICAgICAgICAgdGhpcy56ZXJvICsgdGhpcy5pbmRleCwKICAgICAgICAgICAgICAgIHRoaXMuemVybyArIHRoaXMuaW5kZXggKyB0LAogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgcmV0dXJuICh0aGlzLmluZGV4ICs9IHQpLCBlOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGUuZXhwb3J0cyA9IG4pOwogICAgICAgIH0sCiAgICAgICAgeyAiLi4vdXRpbHMiOiAzMiwgIi4vQXJyYXlSZWFkZXIiOiAxNyB9LAogICAgICBdLAogICAgICAyMjogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9IHQoIi4uL3V0aWxzIiksCiAgICAgICAgICAgIG4gPSB0KCIuLi9zdXBwb3J0IiksCiAgICAgICAgICAgIHMgPSB0KCIuL0FycmF5UmVhZGVyIiksCiAgICAgICAgICAgIGEgPSB0KCIuL1N0cmluZ1JlYWRlciIpLAogICAgICAgICAgICBvID0gdCgiLi9Ob2RlQnVmZmVyUmVhZGVyIiksCiAgICAgICAgICAgIGggPSB0KCIuL1VpbnQ4QXJyYXlSZWFkZXIiKTsKICAgICAgICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHZhciBlID0gaS5nZXRUeXBlT2YodCk7CiAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgaS5jaGVja1N1cHBvcnQoZSksCiAgICAgICAgICAgICAgInN0cmluZyIgIT09IGUgfHwgbi51aW50OGFycmF5CiAgICAgICAgICAgICAgICA/ICJub2RlYnVmZmVyIiA9PT0gZQogICAgICAgICAgICAgICAgICA/IG5ldyBvKHQpCiAgICAgICAgICAgICAgICAgIDogbi51aW50OGFycmF5CiAgICAgICAgICAgICAgICAgICAgPyBuZXcgaChpLnRyYW5zZm9ybVRvKCJ1aW50OGFycmF5IiwgdCkpCiAgICAgICAgICAgICAgICAgICAgOiBuZXcgcyhpLnRyYW5zZm9ybVRvKCJhcnJheSIsIHQpKQogICAgICAgICAgICAgICAgOiBuZXcgYSh0KQogICAgICAgICAgICApOwogICAgICAgICAgfTsKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICIuLi9zdXBwb3J0IjogMzAsCiAgICAgICAgICAiLi4vdXRpbHMiOiAzMiwKICAgICAgICAgICIuL0FycmF5UmVhZGVyIjogMTcsCiAgICAgICAgICAiLi9Ob2RlQnVmZmVyUmVhZGVyIjogMTksCiAgICAgICAgICAiLi9TdHJpbmdSZWFkZXIiOiAyMCwKICAgICAgICAgICIuL1VpbnQ4QXJyYXlSZWFkZXIiOiAyMSwKICAgICAgICB9LAogICAgICBdLAogICAgICAyMzogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICAoci5MT0NBTF9GSUxFX0hFQURFUiA9ICJQSwMEIiksCiAgICAgICAgICAgIChyLkNFTlRSQUxfRklMRV9IRUFERVIgPSAiUEsBAiIpLAogICAgICAgICAgICAoci5DRU5UUkFMX0RJUkVDVE9SWV9FTkQgPSAiUEsFBiIpLAogICAgICAgICAgICAoci5aSVA2NF9DRU5UUkFMX0RJUkVDVE9SWV9MT0NBVE9SID0gIlBLBgciKSwKICAgICAgICAgICAgKHIuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfRU5EID0gIlBLBgYiKSwKICAgICAgICAgICAgKHIuREFUQV9ERVNDUklQVE9SID0gIlBLB1xiIik7CiAgICAgICAgfSwKICAgICAgICB7fSwKICAgICAgXSwKICAgICAgMjQ6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIGkgPSB0KCIuL0dlbmVyaWNXb3JrZXIiKSwKICAgICAgICAgICAgbiA9IHQoIi4uL3V0aWxzIik7CiAgICAgICAgICBmdW5jdGlvbiBzKHQpIHsKICAgICAgICAgICAgaS5jYWxsKHRoaXMsICJDb252ZXJ0V29ya2VyIHRvICIgKyB0KSwgKHRoaXMuZGVzdFR5cGUgPSB0KTsKICAgICAgICAgIH0KICAgICAgICAgIG4uaW5oZXJpdHMocywgaSksCiAgICAgICAgICAgIChzLnByb3RvdHlwZS5wcm9jZXNzQ2h1bmsgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHRoaXMucHVzaCh7CiAgICAgICAgICAgICAgICBkYXRhOiBuLnRyYW5zZm9ybVRvKHRoaXMuZGVzdFR5cGUsIHQuZGF0YSksCiAgICAgICAgICAgICAgICBtZXRhOiB0Lm1ldGEsCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoZS5leHBvcnRzID0gcyk7CiAgICAgICAgfSwKICAgICAgICB7ICIuLi91dGlscyI6IDMyLCAiLi9HZW5lcmljV29ya2VyIjogMjggfSwKICAgICAgXSwKICAgICAgMjU6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIGkgPSB0KCIuL0dlbmVyaWNXb3JrZXIiKSwKICAgICAgICAgICAgbiA9IHQoIi4uL2NyYzMyIik7CiAgICAgICAgICBmdW5jdGlvbiBzKCkgewogICAgICAgICAgICBpLmNhbGwodGhpcywgIkNyYzMyUHJvYmUiKSwgdGhpcy53aXRoU3RyZWFtSW5mbygiY3JjMzIiLCAwKTsKICAgICAgICAgIH0KICAgICAgICAgIHQoIi4uL3V0aWxzIikuaW5oZXJpdHMocywgaSksCiAgICAgICAgICAgIChzLnByb3RvdHlwZS5wcm9jZXNzQ2h1bmsgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICh0aGlzLnN0cmVhbUluZm8uY3JjMzIgPSBuKHQuZGF0YSwgdGhpcy5zdHJlYW1JbmZvLmNyYzMyIHx8IDApKSwKICAgICAgICAgICAgICAgIHRoaXMucHVzaCh0KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChlLmV4cG9ydHMgPSBzKTsKICAgICAgICB9LAogICAgICAgIHsgIi4uL2NyYzMyIjogNCwgIi4uL3V0aWxzIjogMzIsICIuL0dlbmVyaWNXb3JrZXIiOiAyOCB9LAogICAgICBdLAogICAgICAyNjogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9IHQoIi4uL3V0aWxzIiksCiAgICAgICAgICAgIG4gPSB0KCIuL0dlbmVyaWNXb3JrZXIiKTsKICAgICAgICAgIGZ1bmN0aW9uIHModCkgewogICAgICAgICAgICBuLmNhbGwodGhpcywgIkRhdGFMZW5ndGhQcm9iZSBmb3IgIiArIHQpLAogICAgICAgICAgICAgICh0aGlzLnByb3BOYW1lID0gdCksCiAgICAgICAgICAgICAgdGhpcy53aXRoU3RyZWFtSW5mbyh0LCAwKTsKICAgICAgICAgIH0KICAgICAgICAgIGkuaW5oZXJpdHMocywgbiksCiAgICAgICAgICAgIChzLnByb3RvdHlwZS5wcm9jZXNzQ2h1bmsgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGlmICh0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMuc3RyZWFtSW5mb1t0aGlzLnByb3BOYW1lXSB8fCAwOwogICAgICAgICAgICAgICAgdGhpcy5zdHJlYW1JbmZvW3RoaXMucHJvcE5hbWVdID0gZSArIHQuZGF0YS5sZW5ndGg7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIG4ucHJvdG90eXBlLnByb2Nlc3NDaHVuay5jYWxsKHRoaXMsIHQpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGUuZXhwb3J0cyA9IHMpOwogICAgICAgIH0sCiAgICAgICAgeyAiLi4vdXRpbHMiOiAzMiwgIi4vR2VuZXJpY1dvcmtlciI6IDI4IH0sCiAgICAgIF0sCiAgICAgIDI3OiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIHZhciBpID0gdCgiLi4vdXRpbHMiKSwKICAgICAgICAgICAgbiA9IHQoIi4vR2VuZXJpY1dvcmtlciIpOwogICAgICAgICAgZnVuY3Rpb24gcyh0KSB7CiAgICAgICAgICAgIG4uY2FsbCh0aGlzLCAiRGF0YVdvcmtlciIpOwogICAgICAgICAgICB2YXIgZSA9IHRoaXM7CiAgICAgICAgICAgICh0aGlzLmRhdGFJc1JlYWR5ID0gITEpLAogICAgICAgICAgICAgICh0aGlzLmluZGV4ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMubWF4ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuZGF0YSA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLnR5cGUgPSAiIiksCiAgICAgICAgICAgICAgKHRoaXMuX3RpY2tTY2hlZHVsZWQgPSAhMSksCiAgICAgICAgICAgICAgdC50aGVuKAogICAgICAgICAgICAgICAgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgICAgKGUuZGF0YUlzUmVhZHkgPSAhMCksCiAgICAgICAgICAgICAgICAgICAgKGUuZGF0YSA9IHQpLAogICAgICAgICAgICAgICAgICAgIChlLm1heCA9ICh0ICYmIHQubGVuZ3RoKSB8fCAwKSwKICAgICAgICAgICAgICAgICAgICAoZS50eXBlID0gaS5nZXRUeXBlT2YodCkpLAogICAgICAgICAgICAgICAgICAgIGUuaXNQYXVzZWQgfHwgZS5fdGlja0FuZFJlcGVhdCgpOwogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgIGUuZXJyb3IodCk7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgICBpLmluaGVyaXRzKHMsIG4pLAogICAgICAgICAgICAocy5wcm90b3R5cGUuY2xlYW5VcCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBuLnByb3RvdHlwZS5jbGVhblVwLmNhbGwodGhpcyksICh0aGlzLmRhdGEgPSBudWxsKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChzLnByb3RvdHlwZS5yZXN1bWUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICEhbi5wcm90b3R5cGUucmVzdW1lLmNhbGwodGhpcykgJiYKICAgICAgICAgICAgICAgICghdGhpcy5fdGlja1NjaGVkdWxlZCAmJgogICAgICAgICAgICAgICAgICB0aGlzLmRhdGFJc1JlYWR5ICYmCiAgICAgICAgICAgICAgICAgICgodGhpcy5fdGlja1NjaGVkdWxlZCA9ICEwKSwKICAgICAgICAgICAgICAgICAgaS5kZWxheSh0aGlzLl90aWNrQW5kUmVwZWF0LCBbXSwgdGhpcykpLAogICAgICAgICAgICAgICAgITApCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChzLnByb3RvdHlwZS5fdGlja0FuZFJlcGVhdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAodGhpcy5fdGlja1NjaGVkdWxlZCA9ICExKSwKICAgICAgICAgICAgICAgIHRoaXMuaXNQYXVzZWQgfHwKICAgICAgICAgICAgICAgICAgdGhpcy5pc0ZpbmlzaGVkIHx8CiAgICAgICAgICAgICAgICAgICh0aGlzLl90aWNrKCksCiAgICAgICAgICAgICAgICAgIHRoaXMuaXNGaW5pc2hlZCB8fAogICAgICAgICAgICAgICAgICAgIChpLmRlbGF5KHRoaXMuX3RpY2tBbmRSZXBlYXQsIFtdLCB0aGlzKSwKICAgICAgICAgICAgICAgICAgICAodGhpcy5fdGlja1NjaGVkdWxlZCA9ICEwKSkpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHMucHJvdG90eXBlLl90aWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGlmICh0aGlzLmlzUGF1c2VkIHx8IHRoaXMuaXNGaW5pc2hlZCkgcmV0dXJuICExOwogICAgICAgICAgICAgIHZhciB0ID0gbnVsbCwKICAgICAgICAgICAgICAgIGUgPSBNYXRoLm1pbih0aGlzLm1heCwgdGhpcy5pbmRleCArIDE2Mzg0KTsKICAgICAgICAgICAgICBpZiAodGhpcy5pbmRleCA+PSB0aGlzLm1heCkgcmV0dXJuIHRoaXMuZW5kKCk7CiAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnR5cGUpIHsKICAgICAgICAgICAgICAgIGNhc2UgInN0cmluZyI6CiAgICAgICAgICAgICAgICAgIHQgPSB0aGlzLmRhdGEuc3Vic3RyaW5nKHRoaXMuaW5kZXgsIGUpOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgInVpbnQ4YXJyYXkiOgogICAgICAgICAgICAgICAgICB0ID0gdGhpcy5kYXRhLnN1YmFycmF5KHRoaXMuaW5kZXgsIGUpOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgImFycmF5IjoKICAgICAgICAgICAgICAgIGNhc2UgIm5vZGVidWZmZXIiOgogICAgICAgICAgICAgICAgICB0ID0gdGhpcy5kYXRhLnNsaWNlKHRoaXMuaW5kZXgsIGUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgKHRoaXMuaW5kZXggPSBlKSwKICAgICAgICAgICAgICAgIHRoaXMucHVzaCh7CiAgICAgICAgICAgICAgICAgIGRhdGE6IHQsCiAgICAgICAgICAgICAgICAgIG1ldGE6IHsKICAgICAgICAgICAgICAgICAgICBwZXJjZW50OiB0aGlzLm1heCA/ICh0aGlzLmluZGV4IC8gdGhpcy5tYXgpICogMTAwIDogMCwKICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChlLmV4cG9ydHMgPSBzKTsKICAgICAgICB9LAogICAgICAgIHsgIi4uL3V0aWxzIjogMzIsICIuL0dlbmVyaWNXb3JrZXIiOiAyOCB9LAogICAgICBdLAogICAgICAyODogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICBmdW5jdGlvbiBpKHQpIHsKICAgICAgICAgICAgKHRoaXMubmFtZSA9IHQgfHwgImRlZmF1bHQiKSwKICAgICAgICAgICAgICAodGhpcy5zdHJlYW1JbmZvID0ge30pLAogICAgICAgICAgICAgICh0aGlzLmdlbmVyYXRlZEVycm9yID0gbnVsbCksCiAgICAgICAgICAgICAgKHRoaXMuZXh0cmFTdHJlYW1JbmZvID0ge30pLAogICAgICAgICAgICAgICh0aGlzLmlzUGF1c2VkID0gITApLAogICAgICAgICAgICAgICh0aGlzLmlzRmluaXNoZWQgPSAhMSksCiAgICAgICAgICAgICAgKHRoaXMuaXNMb2NrZWQgPSAhMSksCiAgICAgICAgICAgICAgKHRoaXMuX2xpc3RlbmVycyA9IHsgZGF0YTogW10sIGVuZDogW10sIGVycm9yOiBbXSB9KSwKICAgICAgICAgICAgICAodGhpcy5wcmV2aW91cyA9IG51bGwpOwogICAgICAgICAgfQogICAgICAgICAgKGkucHJvdG90eXBlID0gewogICAgICAgICAgICBwdXNoOiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHRoaXMuZW1pdCgiZGF0YSIsIHQpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBlbmQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBpZiAodGhpcy5pc0ZpbmlzaGVkKSByZXR1cm4gITE7CiAgICAgICAgICAgICAgdGhpcy5mbHVzaCgpOwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoImVuZCIpLCB0aGlzLmNsZWFuVXAoKSwgKHRoaXMuaXNGaW5pc2hlZCA9ICEwKTsKICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICB0aGlzLmVtaXQoImVycm9yIiwgdCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiAhMDsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICF0aGlzLmlzRmluaXNoZWQgJiYKICAgICAgICAgICAgICAgICh0aGlzLmlzUGF1c2VkCiAgICAgICAgICAgICAgICAgID8gKHRoaXMuZ2VuZXJhdGVkRXJyb3IgPSB0KQogICAgICAgICAgICAgICAgICA6ICgodGhpcy5pc0ZpbmlzaGVkID0gITApLAogICAgICAgICAgICAgICAgICAgIHRoaXMuZW1pdCgiZXJyb3IiLCB0KSwKICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpb3VzICYmIHRoaXMucHJldmlvdXMuZXJyb3IodCksCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbGVhblVwKCkpLAogICAgICAgICAgICAgICAgITApCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgb246IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xpc3RlbmVyc1t0XS5wdXNoKGUpLCB0aGlzOwogICAgICAgICAgICB9LAogICAgICAgICAgICBjbGVhblVwOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgKHRoaXMuc3RyZWFtSW5mbyA9CiAgICAgICAgICAgICAgICB0aGlzLmdlbmVyYXRlZEVycm9yID0KICAgICAgICAgICAgICAgIHRoaXMuZXh0cmFTdHJlYW1JbmZvID0KICAgICAgICAgICAgICAgICAgbnVsbCksCiAgICAgICAgICAgICAgICAodGhpcy5fbGlzdGVuZXJzID0gW10pOwogICAgICAgICAgICB9LAogICAgICAgICAgICBlbWl0OiBmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgIGlmICh0aGlzLl9saXN0ZW5lcnNbdF0pCiAgICAgICAgICAgICAgICBmb3IgKHZhciByID0gMDsgciA8IHRoaXMuX2xpc3RlbmVyc1t0XS5sZW5ndGg7IHIrKykKICAgICAgICAgICAgICAgICAgdGhpcy5fbGlzdGVuZXJzW3RdW3JdLmNhbGwodGhpcywgZSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHBpcGU6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHQucmVnaXN0ZXJQcmV2aW91cyh0aGlzKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcmVnaXN0ZXJQcmV2aW91czogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBpZiAodGhpcy5pc0xvY2tlZCkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgICAgICAgICAgICAgIlRoZSBzdHJlYW0gJyIgKyB0aGlzICsgIicgaGFzIGFscmVhZHkgYmVlbiB1c2VkLiIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICh0aGlzLnN0cmVhbUluZm8gPSB0LnN0cmVhbUluZm8pLAogICAgICAgICAgICAgICAgdGhpcy5tZXJnZVN0cmVhbUluZm8oKSwKICAgICAgICAgICAgICAgICh0aGlzLnByZXZpb3VzID0gdCk7CiAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzOwogICAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgICB0Lm9uKCJkYXRhIiwgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgICAgZS5wcm9jZXNzQ2h1bmsodCk7CiAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIHQub24oImVuZCIsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgZS5lbmQoKTsKICAgICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgdC5vbigiZXJyb3IiLCBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICBlLmVycm9yKHQpOwogICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICB0aGlzCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcGF1c2U6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgIXRoaXMuaXNQYXVzZWQgJiYKICAgICAgICAgICAgICAgICF0aGlzLmlzRmluaXNoZWQgJiYKICAgICAgICAgICAgICAgICgodGhpcy5pc1BhdXNlZCA9ICEwKSwKICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXMgJiYgdGhpcy5wcmV2aW91cy5wYXVzZSgpLAogICAgICAgICAgICAgICAgITApCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcmVzdW1lOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKCF0aGlzLmlzUGF1c2VkIHx8IHRoaXMuaXNGaW5pc2hlZCkgcmV0dXJuICExOwogICAgICAgICAgICAgIHZhciB0ID0gKHRoaXMuaXNQYXVzZWQgPSAhMSk7CiAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgIHRoaXMuZ2VuZXJhdGVkRXJyb3IgJiYKICAgICAgICAgICAgICAgICAgKHRoaXMuZXJyb3IodGhpcy5nZW5lcmF0ZWRFcnJvciksICh0ID0gITApKSwKICAgICAgICAgICAgICAgIHRoaXMucHJldmlvdXMgJiYgdGhpcy5wcmV2aW91cy5yZXN1bWUoKSwKICAgICAgICAgICAgICAgICF0CiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgZmx1c2g6IGZ1bmN0aW9uICgpIHt9LAogICAgICAgICAgICBwcm9jZXNzQ2h1bms6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdGhpcy5wdXNoKHQpOwogICAgICAgICAgICB9LAogICAgICAgICAgICB3aXRoU3RyZWFtSW5mbzogZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgKHRoaXMuZXh0cmFTdHJlYW1JbmZvW3RdID0gZSksIHRoaXMubWVyZ2VTdHJlYW1JbmZvKCksIHRoaXMKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9LAogICAgICAgICAgICBtZXJnZVN0cmVhbUluZm86IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBmb3IgKHZhciB0IGluIHRoaXMuZXh0cmFTdHJlYW1JbmZvKQogICAgICAgICAgICAgICAgdGhpcy5leHRyYVN0cmVhbUluZm8uaGFzT3duUHJvcGVydHkodCkgJiYKICAgICAgICAgICAgICAgICAgKHRoaXMuc3RyZWFtSW5mb1t0XSA9IHRoaXMuZXh0cmFTdHJlYW1JbmZvW3RdKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbG9jazogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGlmICh0aGlzLmlzTG9ja2VkKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgICAgICAgICAgICAiVGhlIHN0cmVhbSAnIiArIHRoaXMgKyAiJyBoYXMgYWxyZWFkeSBiZWVuIHVzZWQuIiwKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgKHRoaXMuaXNMb2NrZWQgPSAhMCksIHRoaXMucHJldmlvdXMgJiYgdGhpcy5wcmV2aW91cy5sb2NrKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRvU3RyaW5nOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIHQgPSAiV29ya2VyICIgKyB0aGlzLm5hbWU7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJldmlvdXMgPyB0aGlzLnByZXZpb3VzICsgIiAtPiAiICsgdCA6IHQ7CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KSwKICAgICAgICAgICAgKGUuZXhwb3J0cyA9IGkpOwogICAgICAgIH0sCiAgICAgICAge30sCiAgICAgIF0sCiAgICAgIDI5OiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIHZhciBoID0gdCgiLi4vdXRpbHMiKSwKICAgICAgICAgICAgbiA9IHQoIi4vQ29udmVydFdvcmtlciIpLAogICAgICAgICAgICBzID0gdCgiLi9HZW5lcmljV29ya2VyIiksCiAgICAgICAgICAgIHUgPSB0KCIuLi9iYXNlNjQiKSwKICAgICAgICAgICAgaSA9IHQoIi4uL3N1cHBvcnQiKSwKICAgICAgICAgICAgYSA9IHQoIi4uL2V4dGVybmFsIiksCiAgICAgICAgICAgIG8gPSBudWxsOwogICAgICAgICAgaWYgKGkubm9kZXN0cmVhbSkKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICBvID0gdCgiLi4vbm9kZWpzL05vZGVqc1N0cmVhbU91dHB1dEFkYXB0ZXIiKTsKICAgICAgICAgICAgfSBjYXRjaCAodCkge30KICAgICAgICAgIGZ1bmN0aW9uIGwodCwgbykgewogICAgICAgICAgICByZXR1cm4gbmV3IGEuUHJvbWlzZShmdW5jdGlvbiAoZSwgcikgewogICAgICAgICAgICAgIHZhciBpID0gW10sCiAgICAgICAgICAgICAgICBuID0gdC5faW50ZXJuYWxUeXBlLAogICAgICAgICAgICAgICAgcyA9IHQuX291dHB1dFR5cGUsCiAgICAgICAgICAgICAgICBhID0gdC5fbWltZVR5cGU7CiAgICAgICAgICAgICAgdC5vbigiZGF0YSIsIGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICBpLnB1c2godCksIG8gJiYgbyhlKTsKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLm9uKCJlcnJvciIsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgIChpID0gW10pLCByKHQpOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC5vbigiZW5kIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIHZhciB0ID0gKGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiYmxvYiI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGgubmV3QmxvYihoLnRyYW5zZm9ybVRvKCJhcnJheWJ1ZmZlciIsIGUpLCByKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiYmFzZTY0IjoKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdS5lbmNvZGUoZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGgudHJhbnNmb3JtVG8odCwgZSk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkoCiAgICAgICAgICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgICAgICAgICAgICAgIGkgPSAwLAogICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICAgIHMgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHIgPSAwOyByIDwgZS5sZW5ndGg7IHIrKykgcyArPSBlW3JdLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAic3RyaW5nIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlLmpvaW4oIiIpOwogICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImFycmF5IjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuY29uY2F0LmFwcGx5KFtdLCBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJ1aW50OGFycmF5IjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4gPSBuZXcgVWludDhBcnJheShzKSwgciA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIgPCBlLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcisrCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uc2V0KGVbcl0sIGkpLCAoaSArPSBlW3JdLmxlbmd0aCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbjsKICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJub2RlYnVmZmVyIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBCdWZmZXIuY29uY2F0KGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjb25jYXQgOiB1bnN1cHBvcnRlZCB0eXBlICciICsgdCArICInIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0pKG4sIGkpLAogICAgICAgICAgICAgICAgICAgICAgYSwKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIGUodCk7CiAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgICByKHQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIGkgPSBbXTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAucmVzdW1lKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gZih0LCBlLCByKSB7CiAgICAgICAgICAgIHZhciBpID0gZTsKICAgICAgICAgICAgc3dpdGNoIChlKSB7CiAgICAgICAgICAgICAgY2FzZSAiYmxvYiI6CiAgICAgICAgICAgICAgY2FzZSAiYXJyYXlidWZmZXIiOgogICAgICAgICAgICAgICAgaSA9ICJ1aW50OGFycmF5IjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgIGNhc2UgImJhc2U2NCI6CiAgICAgICAgICAgICAgICBpID0gInN0cmluZyI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAodGhpcy5faW50ZXJuYWxUeXBlID0gaSksCiAgICAgICAgICAgICAgICAodGhpcy5fb3V0cHV0VHlwZSA9IGUpLAogICAgICAgICAgICAgICAgKHRoaXMuX21pbWVUeXBlID0gciksCiAgICAgICAgICAgICAgICBoLmNoZWNrU3VwcG9ydChpKSwKICAgICAgICAgICAgICAgICh0aGlzLl93b3JrZXIgPSB0LnBpcGUobmV3IG4oaSkpKSwKICAgICAgICAgICAgICAgIHQubG9jaygpOwogICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgKHRoaXMuX3dvcmtlciA9IG5ldyBzKCJlcnJvciIpKSwgdGhpcy5fd29ya2VyLmVycm9yKHQpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAoZi5wcm90b3R5cGUgPSB7CiAgICAgICAgICAgIGFjY3VtdWxhdGU6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIGwodGhpcywgdCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uOiBmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgIHZhciByID0gdGhpczsKICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgImRhdGEiID09PSB0CiAgICAgICAgICAgICAgICAgID8gdGhpcy5fd29ya2VyLm9uKHQsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICBlLmNhbGwociwgdC5kYXRhLCB0Lm1ldGEpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgIDogdGhpcy5fd29ya2VyLm9uKHQsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIGguZGVsYXkoZSwgYXJndW1lbnRzLCByKTsKICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgIHRoaXMKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZXN1bWU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gaC5kZWxheSh0aGlzLl93b3JrZXIucmVzdW1lLCBbXSwgdGhpcy5fd29ya2VyKSwgdGhpczsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcGF1c2U6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fd29ya2VyLnBhdXNlKCksIHRoaXM7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHRvTm9kZWpzU3RyZWFtOiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIChoLmNoZWNrU3VwcG9ydCgibm9kZXN0cmVhbSIpLAogICAgICAgICAgICAgICAgIm5vZGVidWZmZXIiICE9PSB0aGlzLl9vdXRwdXRUeXBlKQogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgICAgICAgICAgICAgdGhpcy5fb3V0cHV0VHlwZSArICIgaXMgbm90IHN1cHBvcnRlZCBieSB0aGlzIG1ldGhvZCIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHJldHVybiBuZXcgbygKICAgICAgICAgICAgICAgIHRoaXMsCiAgICAgICAgICAgICAgICB7IG9iamVjdE1vZGU6ICJub2RlYnVmZmVyIiAhPT0gdGhpcy5fb3V0cHV0VHlwZSB9LAogICAgICAgICAgICAgICAgdCwKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9LAogICAgICAgICAgfSksCiAgICAgICAgICAgIChlLmV4cG9ydHMgPSBmKTsKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICIuLi9iYXNlNjQiOiAxLAogICAgICAgICAgIi4uL2V4dGVybmFsIjogNiwKICAgICAgICAgICIuLi9ub2RlanMvTm9kZWpzU3RyZWFtT3V0cHV0QWRhcHRlciI6IDEzLAogICAgICAgICAgIi4uL3N1cHBvcnQiOiAzMCwKICAgICAgICAgICIuLi91dGlscyI6IDMyLAogICAgICAgICAgIi4vQ29udmVydFdvcmtlciI6IDI0LAogICAgICAgICAgIi4vR2VuZXJpY1dvcmtlciI6IDI4LAogICAgICAgIH0sCiAgICAgIF0sCiAgICAgIDMwOiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIGlmICgKICAgICAgICAgICAgKChyLmJhc2U2NCA9ICEwKSwKICAgICAgICAgICAgKHIuYXJyYXkgPSAhMCksCiAgICAgICAgICAgIChyLnN0cmluZyA9ICEwKSwKICAgICAgICAgICAgKHIuYXJyYXlidWZmZXIgPQogICAgICAgICAgICAgICJ1bmRlZmluZWQiICE9IHR5cGVvZiBBcnJheUJ1ZmZlciAmJgogICAgICAgICAgICAgICJ1bmRlZmluZWQiICE9IHR5cGVvZiBVaW50OEFycmF5KSwKICAgICAgICAgICAgKHIubm9kZWJ1ZmZlciA9ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBCdWZmZXIpLAogICAgICAgICAgICAoci51aW50OGFycmF5ID0gInVuZGVmaW5lZCIgIT0gdHlwZW9mIFVpbnQ4QXJyYXkpLAogICAgICAgICAgICAidW5kZWZpbmVkIiA9PSB0eXBlb2YgQXJyYXlCdWZmZXIpCiAgICAgICAgICApCiAgICAgICAgICAgIHIuYmxvYiA9ICExOwogICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHZhciBpID0gbmV3IEFycmF5QnVmZmVyKDApOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHIuYmxvYiA9IDAgPT09IG5ldyBCbG9iKFtpXSwgeyB0eXBlOiAiYXBwbGljYXRpb24vemlwIiB9KS5zaXplOwogICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHZhciBuID0gbmV3IChzZWxmLkJsb2JCdWlsZGVyIHx8CiAgICAgICAgICAgICAgICAgIHNlbGYuV2ViS2l0QmxvYkJ1aWxkZXIgfHwKICAgICAgICAgICAgICAgICAgc2VsZi5Nb3pCbG9iQnVpbGRlciB8fAogICAgICAgICAgICAgICAgICBzZWxmLk1TQmxvYkJ1aWxkZXIpKCk7CiAgICAgICAgICAgICAgICBuLmFwcGVuZChpKSwgKHIuYmxvYiA9IDAgPT09IG4uZ2V0QmxvYigiYXBwbGljYXRpb24vemlwIikuc2l6ZSk7CiAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgci5ibG9iID0gITE7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICB0cnkgewogICAgICAgICAgICByLm5vZGVzdHJlYW0gPSAhIXQoInJlYWRhYmxlLXN0cmVhbSIpLlJlYWRhYmxlOwogICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICByLm5vZGVzdHJlYW0gPSAhMTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHsgInJlYWRhYmxlLXN0cmVhbSI6IDE2IH0sCiAgICAgIF0sCiAgICAgIDMxOiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHMpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIGZvciAoCiAgICAgICAgICAgIHZhciBvID0gdCgiLi91dGlscyIpLAogICAgICAgICAgICAgIGggPSB0KCIuL3N1cHBvcnQiKSwKICAgICAgICAgICAgICByID0gdCgiLi9ub2RlanNVdGlscyIpLAogICAgICAgICAgICAgIGkgPSB0KCIuL3N0cmVhbS9HZW5lcmljV29ya2VyIiksCiAgICAgICAgICAgICAgdSA9IG5ldyBBcnJheSgyNTYpLAogICAgICAgICAgICAgIG4gPSAwOwogICAgICAgICAgICBuIDwgMjU2OwogICAgICAgICAgICBuKysKICAgICAgICAgICkKICAgICAgICAgICAgdVtuXSA9CiAgICAgICAgICAgICAgMjUyIDw9IG4KICAgICAgICAgICAgICAgID8gNgogICAgICAgICAgICAgICAgOiAyNDggPD0gbgogICAgICAgICAgICAgICAgICA/IDUKICAgICAgICAgICAgICAgICAgOiAyNDAgPD0gbgogICAgICAgICAgICAgICAgICAgID8gNAogICAgICAgICAgICAgICAgICAgIDogMjI0IDw9IG4KICAgICAgICAgICAgICAgICAgICAgID8gMwogICAgICAgICAgICAgICAgICAgICAgOiAxOTIgPD0gbgogICAgICAgICAgICAgICAgICAgICAgICA/IDIKICAgICAgICAgICAgICAgICAgICAgICAgOiAxOwogICAgICAgICAgdVsyNTRdID0gdVsyNTRdID0gMTsKICAgICAgICAgIGZ1bmN0aW9uIGEoKSB7CiAgICAgICAgICAgIGkuY2FsbCh0aGlzLCAidXRmLTggZGVjb2RlIiksICh0aGlzLmxlZnRPdmVyID0gbnVsbCk7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBsKCkgewogICAgICAgICAgICBpLmNhbGwodGhpcywgInV0Zi04IGVuY29kZSIpOwogICAgICAgICAgfQogICAgICAgICAgKHMudXRmOGVuY29kZSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHJldHVybiBoLm5vZGVidWZmZXIKICAgICAgICAgICAgICA/IHIubmV3QnVmZmVyRnJvbSh0LCAidXRmLTgiKQogICAgICAgICAgICAgIDogKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgIHZhciBlLAogICAgICAgICAgICAgICAgICAgIHIsCiAgICAgICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgICAgICBuLAogICAgICAgICAgICAgICAgICAgIHMsCiAgICAgICAgICAgICAgICAgICAgYSA9IHQubGVuZ3RoLAogICAgICAgICAgICAgICAgICAgIG8gPSAwOwogICAgICAgICAgICAgICAgICBmb3IgKG4gPSAwOyBuIDwgYTsgbisrKQogICAgICAgICAgICAgICAgICAgIDU1Mjk2ID09ICg2NDUxMiAmIChyID0gdC5jaGFyQ29kZUF0KG4pKSkgJiYKICAgICAgICAgICAgICAgICAgICAgIG4gKyAxIDwgYSAmJgogICAgICAgICAgICAgICAgICAgICAgNTYzMjAgPT0gKDY0NTEyICYgKGkgPSB0LmNoYXJDb2RlQXQobiArIDEpKSkgJiYKICAgICAgICAgICAgICAgICAgICAgICgociA9IDY1NTM2ICsgKChyIC0gNTUyOTYpIDw8IDEwKSArIChpIC0gNTYzMjApKSwgbisrKSwKICAgICAgICAgICAgICAgICAgICAgIChvICs9IHIgPCAxMjggPyAxIDogciA8IDIwNDggPyAyIDogciA8IDY1NTM2ID8gMyA6IDQpOwogICAgICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgICAgIGUgPSBoLnVpbnQ4YXJyYXkgPyBuZXcgVWludDhBcnJheShvKSA6IG5ldyBBcnJheShvKSwKICAgICAgICAgICAgICAgICAgICAgIG4gPSBzID0gMDsKICAgICAgICAgICAgICAgICAgICBzIDwgbzsKICAgICAgICAgICAgICAgICAgICBuKysKICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIDU1Mjk2ID09ICg2NDUxMiAmIChyID0gdC5jaGFyQ29kZUF0KG4pKSkgJiYKICAgICAgICAgICAgICAgICAgICAgIG4gKyAxIDwgYSAmJgogICAgICAgICAgICAgICAgICAgICAgNTYzMjAgPT0gKDY0NTEyICYgKGkgPSB0LmNoYXJDb2RlQXQobiArIDEpKSkgJiYKICAgICAgICAgICAgICAgICAgICAgICgociA9IDY1NTM2ICsgKChyIC0gNTUyOTYpIDw8IDEwKSArIChpIC0gNTYzMjApKSwgbisrKSwKICAgICAgICAgICAgICAgICAgICAgIHIgPCAxMjgKICAgICAgICAgICAgICAgICAgICAgICAgPyAoZVtzKytdID0gcikKICAgICAgICAgICAgICAgICAgICAgICAgOiAociA8IDIwNDgKICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKGVbcysrXSA9IDE5MiB8IChyID4+PiA2KSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKHIgPCA2NTUzNgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKGVbcysrXSA9IDIyNCB8IChyID4+PiAxMikpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoKGVbcysrXSA9IDI0MCB8IChyID4+PiAxOCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVbcysrXSA9IDEyOCB8ICgociA+Pj4gMTIpICYgNjMpKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChlW3MrK10gPSAxMjggfCAoKHIgPj4+IDYpICYgNjMpKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKGVbcysrXSA9IDEyOCB8ICg2MyAmIHIpKSk7CiAgICAgICAgICAgICAgICAgIHJldHVybiBlOwogICAgICAgICAgICAgICAgfSkodCk7CiAgICAgICAgICB9KSwKICAgICAgICAgICAgKHMudXRmOGRlY29kZSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIGgubm9kZWJ1ZmZlcgogICAgICAgICAgICAgICAgPyBvLnRyYW5zZm9ybVRvKCJub2RlYnVmZmVyIiwgdCkudG9TdHJpbmcoInV0Zi04IikKICAgICAgICAgICAgICAgIDogKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGUsCiAgICAgICAgICAgICAgICAgICAgICByLAogICAgICAgICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgICAgICAgICBzID0gdC5sZW5ndGgsCiAgICAgICAgICAgICAgICAgICAgICBhID0gbmV3IEFycmF5KDIgKiBzKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKGUgPSByID0gMDsgZSA8IHM7ICkKICAgICAgICAgICAgICAgICAgICAgIGlmICgoaSA9IHRbZSsrXSkgPCAxMjgpIGFbcisrXSA9IGk7CiAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICg0IDwgKG4gPSB1W2ldKSkgKGFbcisrXSA9IDY1NTMzKSwgKGUgKz0gbiAtIDEpOwogICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgaSAmPSAyID09PSBuID8gMzEgOiAzID09PSBuID8gMTUgOiA3OwogICAgICAgICAgICAgICAgICAgICAgICAgIDEgPCBuICYmIGUgPCBzOwoKICAgICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICAgIChpID0gKGkgPDwgNikgfCAoNjMgJiB0W2UrK10pKSwgbi0tOwogICAgICAgICAgICAgICAgICAgICAgICAxIDwgbgogICAgICAgICAgICAgICAgICAgICAgICAgID8gKGFbcisrXSA9IDY1NTMzKQogICAgICAgICAgICAgICAgICAgICAgICAgIDogaSA8IDY1NTM2CiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IChhW3IrK10gPSBpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoKGkgLT0gNjU1MzYpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYVtyKytdID0gNTUyOTYgfCAoKGkgPj4gMTApICYgMTAyMykpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYVtyKytdID0gNTYzMjAgfCAoMTAyMyAmIGkpKSk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICAgICAgIGEubGVuZ3RoICE9PSByICYmCiAgICAgICAgICAgICAgICAgICAgICAgIChhLnN1YmFycmF5ID8gKGEgPSBhLnN1YmFycmF5KDAsIHIpKSA6IChhLmxlbmd0aCA9IHIpKSwKICAgICAgICAgICAgICAgICAgICAgIG8uYXBwbHlGcm9tQ2hhckNvZGUoYSkKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICB9KSgKICAgICAgICAgICAgICAgICAgICAodCA9IG8udHJhbnNmb3JtVG8oCiAgICAgICAgICAgICAgICAgICAgICBoLnVpbnQ4YXJyYXkgPyAidWludDhhcnJheSIgOiAiYXJyYXkiLAogICAgICAgICAgICAgICAgICAgICAgdCwKICAgICAgICAgICAgICAgICAgICApKSwKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIG8uaW5oZXJpdHMoYSwgaSksCiAgICAgICAgICAgIChhLnByb3RvdHlwZS5wcm9jZXNzQ2h1bmsgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHZhciBlID0gby50cmFuc2Zvcm1UbygKICAgICAgICAgICAgICAgIGgudWludDhhcnJheSA/ICJ1aW50OGFycmF5IiA6ICJhcnJheSIsCiAgICAgICAgICAgICAgICB0LmRhdGEsCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICBpZiAodGhpcy5sZWZ0T3ZlciAmJiB0aGlzLmxlZnRPdmVyLmxlbmd0aCkgewogICAgICAgICAgICAgICAgaWYgKGgudWludDhhcnJheSkgewogICAgICAgICAgICAgICAgICB2YXIgciA9IGU7CiAgICAgICAgICAgICAgICAgIChlID0gbmV3IFVpbnQ4QXJyYXkoci5sZW5ndGggKyB0aGlzLmxlZnRPdmVyLmxlbmd0aCkpLnNldCgKICAgICAgICAgICAgICAgICAgICB0aGlzLmxlZnRPdmVyLAogICAgICAgICAgICAgICAgICAgIDAsCiAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgZS5zZXQociwgdGhpcy5sZWZ0T3Zlci5sZW5ndGgpOwogICAgICAgICAgICAgICAgfSBlbHNlIGUgPSB0aGlzLmxlZnRPdmVyLmNvbmNhdChlKTsKICAgICAgICAgICAgICAgIHRoaXMubGVmdE92ZXIgPSBudWxsOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB2YXIgaSA9IChmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgICAgICB2YXIgcjsKICAgICAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgICAgICAoZSA9IGUgfHwgdC5sZW5ndGgpID4gdC5sZW5ndGggJiYgKGUgPSB0Lmxlbmd0aCksIHIgPSBlIC0gMTsKICAgICAgICAgICAgICAgICAgICAwIDw9IHIgJiYgMTI4ID09ICgxOTIgJiB0W3JdKTsKCiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICByLS07CiAgICAgICAgICAgICAgICAgIHJldHVybiByIDwgMCA/IGUgOiAwID09PSByID8gZSA6IHIgKyB1W3Rbcl1dID4gZSA/IHIgOiBlOwogICAgICAgICAgICAgICAgfSkoZSksCiAgICAgICAgICAgICAgICBuID0gZTsKICAgICAgICAgICAgICBpICE9PSBlLmxlbmd0aCAmJgogICAgICAgICAgICAgICAgKGgudWludDhhcnJheQogICAgICAgICAgICAgICAgICA/ICgobiA9IGUuc3ViYXJyYXkoMCwgaSkpLAogICAgICAgICAgICAgICAgICAgICh0aGlzLmxlZnRPdmVyID0gZS5zdWJhcnJheShpLCBlLmxlbmd0aCkpKQogICAgICAgICAgICAgICAgICA6ICgobiA9IGUuc2xpY2UoMCwgaSkpLAogICAgICAgICAgICAgICAgICAgICh0aGlzLmxlZnRPdmVyID0gZS5zbGljZShpLCBlLmxlbmd0aCkpKSksCiAgICAgICAgICAgICAgICB0aGlzLnB1c2goeyBkYXRhOiBzLnV0ZjhkZWNvZGUobiksIG1ldGE6IHQubWV0YSB9KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChhLnByb3RvdHlwZS5mbHVzaCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB0aGlzLmxlZnRPdmVyICYmCiAgICAgICAgICAgICAgICB0aGlzLmxlZnRPdmVyLmxlbmd0aCAmJgogICAgICAgICAgICAgICAgKHRoaXMucHVzaCh7IGRhdGE6IHMudXRmOGRlY29kZSh0aGlzLmxlZnRPdmVyKSwgbWV0YToge30gfSksCiAgICAgICAgICAgICAgICAodGhpcy5sZWZ0T3ZlciA9IG51bGwpKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChzLlV0ZjhEZWNvZGVXb3JrZXIgPSBhKSwKICAgICAgICAgICAgby5pbmhlcml0cyhsLCBpKSwKICAgICAgICAgICAgKGwucHJvdG90eXBlLnByb2Nlc3NDaHVuayA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdGhpcy5wdXNoKHsgZGF0YTogcy51dGY4ZW5jb2RlKHQuZGF0YSksIG1ldGE6IHQubWV0YSB9KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChzLlV0ZjhFbmNvZGVXb3JrZXIgPSBsKTsKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICIuL25vZGVqc1V0aWxzIjogMTQsCiAgICAgICAgICAiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciI6IDI4LAogICAgICAgICAgIi4vc3VwcG9ydCI6IDMwLAogICAgICAgICAgIi4vdXRpbHMiOiAzMiwKICAgICAgICB9LAogICAgICBdLAogICAgICAzMjogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCBhKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgbyA9IHQoIi4vc3VwcG9ydCIpLAogICAgICAgICAgICBoID0gdCgiLi9iYXNlNjQiKSwKICAgICAgICAgICAgciA9IHQoIi4vbm9kZWpzVXRpbHMiKSwKICAgICAgICAgICAgaSA9IHQoInNldC1pbW1lZGlhdGUtc2hpbSIpLAogICAgICAgICAgICB1ID0gdCgiLi9leHRlcm5hbCIpOwogICAgICAgICAgZnVuY3Rpb24gbih0KSB7CiAgICAgICAgICAgIHJldHVybiB0OwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gbCh0LCBlKSB7CiAgICAgICAgICAgIGZvciAodmFyIHIgPSAwOyByIDwgdC5sZW5ndGg7ICsrcikgZVtyXSA9IDI1NSAmIHQuY2hhckNvZGVBdChyKTsKICAgICAgICAgICAgcmV0dXJuIGU7CiAgICAgICAgICB9CiAgICAgICAgICBhLm5ld0Jsb2IgPSBmdW5jdGlvbiAoZSwgcikgewogICAgICAgICAgICBhLmNoZWNrU3VwcG9ydCgiYmxvYiIpOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJldHVybiBuZXcgQmxvYihbZV0sIHsgdHlwZTogciB9KTsKICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB2YXIgaSA9IG5ldyAoc2VsZi5CbG9iQnVpbGRlciB8fAogICAgICAgICAgICAgICAgICBzZWxmLldlYktpdEJsb2JCdWlsZGVyIHx8CiAgICAgICAgICAgICAgICAgIHNlbGYuTW96QmxvYkJ1aWxkZXIgfHwKICAgICAgICAgICAgICAgICAgc2VsZi5NU0Jsb2JCdWlsZGVyKSgpOwogICAgICAgICAgICAgICAgcmV0dXJuIGkuYXBwZW5kKGUpLCBpLmdldEJsb2Iocik7CiAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCJCdWcgOiBjYW4ndCBjb25zdHJ1Y3QgdGhlIEJsb2IuIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgICAgdmFyIHMgPSB7CiAgICAgICAgICAgIHN0cmluZ2lmeUJ5Q2h1bms6IGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAgICAgdmFyIGkgPSBbXSwKICAgICAgICAgICAgICAgIG4gPSAwLAogICAgICAgICAgICAgICAgcyA9IHQubGVuZ3RoOwogICAgICAgICAgICAgIGlmIChzIDw9IHIpIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIHQpOwogICAgICAgICAgICAgIGZvciAoOyBuIDwgczsgKQogICAgICAgICAgICAgICAgImFycmF5IiA9PT0gZSB8fCAibm9kZWJ1ZmZlciIgPT09IGUKICAgICAgICAgICAgICAgICAgPyBpLnB1c2goCiAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KAogICAgICAgICAgICAgICAgICAgICAgICBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB0LnNsaWNlKG4sIE1hdGgubWluKG4gKyByLCBzKSksCiAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgOiBpLnB1c2goCiAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KAogICAgICAgICAgICAgICAgICAgICAgICBudWxsLAogICAgICAgICAgICAgICAgICAgICAgICB0LnN1YmFycmF5KG4sIE1hdGgubWluKG4gKyByLCBzKSksCiAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgIChuICs9IHIpOwogICAgICAgICAgICAgIHJldHVybiBpLmpvaW4oIiIpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBzdHJpbmdpZnlCeUNoYXI6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgZm9yICh2YXIgZSA9ICIiLCByID0gMDsgciA8IHQubGVuZ3RoOyByKyspCiAgICAgICAgICAgICAgICBlICs9IFN0cmluZy5mcm9tQ2hhckNvZGUodFtyXSk7CiAgICAgICAgICAgICAgcmV0dXJuIGU7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGFwcGx5Q2FuQmVVc2VkOiB7CiAgICAgICAgICAgICAgdWludDhhcnJheTogKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgICAgICAgby51aW50OGFycmF5ICYmCiAgICAgICAgICAgICAgICAgICAgMSA9PT0KICAgICAgICAgICAgICAgICAgICAgIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQ4QXJyYXkoMSkpLmxlbmd0aAogICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSBjYXRjaCAodCkgewogICAgICAgICAgICAgICAgICByZXR1cm4gITE7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSkoKSwKICAgICAgICAgICAgICBub2RlYnVmZmVyOiAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICAgICBvLm5vZGVidWZmZXIgJiYKICAgICAgICAgICAgICAgICAgICAxID09PQogICAgICAgICAgICAgICAgICAgICAgU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCByLmFsbG9jQnVmZmVyKDEpKS5sZW5ndGgKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuICExOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pKCksCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9OwogICAgICAgICAgZnVuY3Rpb24gZih0KSB7CiAgICAgICAgICAgIHZhciBlID0gNjU1MzYsCiAgICAgICAgICAgICAgciA9IGEuZ2V0VHlwZU9mKHQpLAogICAgICAgICAgICAgIGkgPSAhMDsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICgidWludDhhcnJheSIgPT09IHIKICAgICAgICAgICAgICAgID8gKGkgPSBzLmFwcGx5Q2FuQmVVc2VkLnVpbnQ4YXJyYXkpCiAgICAgICAgICAgICAgICA6ICJub2RlYnVmZmVyIiA9PT0gciAmJiAoaSA9IHMuYXBwbHlDYW5CZVVzZWQubm9kZWJ1ZmZlciksCiAgICAgICAgICAgICAgaSkKICAgICAgICAgICAgKQogICAgICAgICAgICAgIGZvciAoOyAxIDwgZTsgKQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHMuc3RyaW5naWZ5QnlDaHVuayh0LCByLCBlKTsKICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgICAgICAgZSA9IE1hdGguZmxvb3IoZSAvIDIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gcy5zdHJpbmdpZnlCeUNoYXIodCk7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBkKHQsIGUpIHsKICAgICAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCB0Lmxlbmd0aDsgcisrKSBlW3JdID0gdFtyXTsKICAgICAgICAgICAgcmV0dXJuIGU7CiAgICAgICAgICB9CiAgICAgICAgICBhLmFwcGx5RnJvbUNoYXJDb2RlID0gZjsKICAgICAgICAgIHZhciBjID0ge307CiAgICAgICAgICAoYy5zdHJpbmcgPSB7CiAgICAgICAgICAgIHN0cmluZzogbiwKICAgICAgICAgICAgYXJyYXk6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIGwodCwgbmV3IEFycmF5KHQubGVuZ3RoKSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGFycmF5YnVmZmVyOiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHJldHVybiBjLnN0cmluZy51aW50OGFycmF5KHQpLmJ1ZmZlcjsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdWludDhhcnJheTogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICByZXR1cm4gbCh0LCBuZXcgVWludDhBcnJheSh0Lmxlbmd0aCkpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBub2RlYnVmZmVyOiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHJldHVybiBsKHQsIHIuYWxsb2NCdWZmZXIodC5sZW5ndGgpKTsKICAgICAgICAgICAgfSwKICAgICAgICAgIH0pLAogICAgICAgICAgICAoYy5hcnJheSA9IHsKICAgICAgICAgICAgICBzdHJpbmc6IGYsCiAgICAgICAgICAgICAgYXJyYXk6IG4sCiAgICAgICAgICAgICAgYXJyYXlidWZmZXI6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkodCkuYnVmZmVyOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgdWludDhhcnJheTogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh0KTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIG5vZGVidWZmZXI6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gci5uZXdCdWZmZXJGcm9tKHQpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoYy5hcnJheWJ1ZmZlciA9IHsKICAgICAgICAgICAgICBzdHJpbmc6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZihuZXcgVWludDhBcnJheSh0KSk7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBhcnJheTogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkKG5ldyBVaW50OEFycmF5KHQpLCBuZXcgQXJyYXkodC5ieXRlTGVuZ3RoKSk7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBhcnJheWJ1ZmZlcjogbiwKICAgICAgICAgICAgICB1aW50OGFycmF5OiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KHQpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgbm9kZWJ1ZmZlcjogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiByLm5ld0J1ZmZlckZyb20obmV3IFVpbnQ4QXJyYXkodCkpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoYy51aW50OGFycmF5ID0gewogICAgICAgICAgICAgIHN0cmluZzogZiwKICAgICAgICAgICAgICBhcnJheTogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkKHQsIG5ldyBBcnJheSh0Lmxlbmd0aCkpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgYXJyYXlidWZmZXI6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdC5idWZmZXI7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICB1aW50OGFycmF5OiBuLAogICAgICAgICAgICAgIG5vZGVidWZmZXI6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gci5uZXdCdWZmZXJGcm9tKHQpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoYy5ub2RlYnVmZmVyID0gewogICAgICAgICAgICAgIHN0cmluZzogZiwKICAgICAgICAgICAgICBhcnJheTogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkKHQsIG5ldyBBcnJheSh0Lmxlbmd0aCkpOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgYXJyYXlidWZmZXI6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYy5ub2RlYnVmZmVyLnVpbnQ4YXJyYXkodCkuYnVmZmVyOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgdWludDhhcnJheTogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkKHQsIG5ldyBVaW50OEFycmF5KHQubGVuZ3RoKSk7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBub2RlYnVmZmVyOiBuLAogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGEudHJhbnNmb3JtVG8gPSBmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgIGlmICgoKGUgPSBlIHx8ICIiKSwgIXQpKSByZXR1cm4gZTsKICAgICAgICAgICAgICBhLmNoZWNrU3VwcG9ydCh0KTsKICAgICAgICAgICAgICB2YXIgciA9IGEuZ2V0VHlwZU9mKGUpOwogICAgICAgICAgICAgIHJldHVybiBjW3JdW3RdKGUpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGEuZ2V0VHlwZU9mID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICByZXR1cm4gInN0cmluZyIgPT0gdHlwZW9mIHQKICAgICAgICAgICAgICAgID8gInN0cmluZyIKICAgICAgICAgICAgICAgIDogIltvYmplY3QgQXJyYXldIiA9PT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpCiAgICAgICAgICAgICAgICAgID8gImFycmF5IgogICAgICAgICAgICAgICAgICA6IG8ubm9kZWJ1ZmZlciAmJiByLmlzQnVmZmVyKHQpCiAgICAgICAgICAgICAgICAgICAgPyAibm9kZWJ1ZmZlciIKICAgICAgICAgICAgICAgICAgICA6IG8udWludDhhcnJheSAmJiB0IGluc3RhbmNlb2YgVWludDhBcnJheQogICAgICAgICAgICAgICAgICAgICAgPyAidWludDhhcnJheSIKICAgICAgICAgICAgICAgICAgICAgIDogby5hcnJheWJ1ZmZlciAmJiB0IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIKICAgICAgICAgICAgICAgICAgICAgICAgPyAiYXJyYXlidWZmZXIiCiAgICAgICAgICAgICAgICAgICAgICAgIDogdm9pZCAwOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGEuY2hlY2tTdXBwb3J0ID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBpZiAoIW9bdC50b0xvd2VyQ2FzZSgpXSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcih0ICsgIiBpcyBub3Qgc3VwcG9ydGVkIGJ5IHRoaXMgcGxhdGZvcm0iKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChhLk1BWF9WQUxVRV8xNkJJVFMgPSA2NTUzNSksCiAgICAgICAgICAgIChhLk1BWF9WQUxVRV8zMkJJVFMgPSAtMSksCiAgICAgICAgICAgIChhLnByZXR0eSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIGUsCiAgICAgICAgICAgICAgICByLAogICAgICAgICAgICAgICAgaSA9ICIiOwogICAgICAgICAgICAgIGZvciAociA9IDA7IHIgPCAodCB8fCAiIikubGVuZ3RoOyByKyspCiAgICAgICAgICAgICAgICBpICs9CiAgICAgICAgICAgICAgICAgICJcXHgiICsKICAgICAgICAgICAgICAgICAgKChlID0gdC5jaGFyQ29kZUF0KHIpKSA8IDE2ID8gIjAiIDogIiIpICsKICAgICAgICAgICAgICAgICAgZS50b1N0cmluZygxNikudG9VcHBlckNhc2UoKTsKICAgICAgICAgICAgICByZXR1cm4gaTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChhLmRlbGF5ID0gZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICAgICBpKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHQuYXBwbHkociB8fCBudWxsLCBlIHx8IFtdKTsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChhLmluaGVyaXRzID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICBmdW5jdGlvbiByKCkge30KICAgICAgICAgICAgICAoci5wcm90b3R5cGUgPSBlLnByb3RvdHlwZSksICh0LnByb3RvdHlwZSA9IG5ldyByKCkpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGEuZXh0ZW5kID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHZhciB0LAogICAgICAgICAgICAgICAgZSwKICAgICAgICAgICAgICAgIHIgPSB7fTsKICAgICAgICAgICAgICBmb3IgKHQgPSAwOyB0IDwgYXJndW1lbnRzLmxlbmd0aDsgdCsrKQogICAgICAgICAgICAgICAgZm9yIChlIGluIGFyZ3VtZW50c1t0XSkKICAgICAgICAgICAgICAgICAgYXJndW1lbnRzW3RdLmhhc093blByb3BlcnR5KGUpICYmCiAgICAgICAgICAgICAgICAgICAgdm9pZCAwID09PSByW2VdICYmCiAgICAgICAgICAgICAgICAgICAgKHJbZV0gPSBhcmd1bWVudHNbdF1bZV0pOwogICAgICAgICAgICAgIHJldHVybiByOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGEucHJlcGFyZUNvbnRlbnQgPSBmdW5jdGlvbiAociwgdCwgaSwgbiwgcykgewogICAgICAgICAgICAgIHJldHVybiB1LlByb21pc2UucmVzb2x2ZSh0KQogICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGkpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIG8uYmxvYiAmJgogICAgICAgICAgICAgICAgICAgIChpIGluc3RhbmNlb2YgQmxvYiB8fAogICAgICAgICAgICAgICAgICAgICAgLTEgIT09CiAgICAgICAgICAgICAgICAgICAgICAgIFsiW29iamVjdCBGaWxlXSIsICJbb2JqZWN0IEJsb2JdIl0uaW5kZXhPZigKICAgICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoaSksCiAgICAgICAgICAgICAgICAgICAgICAgICkpICYmCiAgICAgICAgICAgICAgICAgICAgInVuZGVmaW5lZCIgIT0gdHlwZW9mIEZpbGVSZWFkZXIKICAgICAgICAgICAgICAgICAgICA/IG5ldyB1LlByb21pc2UoZnVuY3Rpb24gKGUsIHIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICAgICAgICAgICAgICAgICAgICAodC5vbmxvYWQgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGUodC50YXJnZXQucmVzdWx0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKHQub25lcnJvciA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByKHQudGFyZ2V0LmVycm9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgICB0LnJlYWRBc0FycmF5QnVmZmVyKGkpOwogICAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICA6IGk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgICAgdmFyIGUgPSBhLmdldFR5cGVPZih0KTsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGUKICAgICAgICAgICAgICAgICAgICA/ICgiYXJyYXlidWZmZXIiID09PSBlCiAgICAgICAgICAgICAgICAgICAgICAgID8gKHQgPSBhLnRyYW5zZm9ybVRvKCJ1aW50OGFycmF5IiwgdCkpCiAgICAgICAgICAgICAgICAgICAgICAgIDogInN0cmluZyIgPT09IGUgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAocwogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAodCA9IGguZGVjb2RlKHQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBpICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICEwICE9PSBuICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICh0ID0gKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGwoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgby51aW50OGFycmF5CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gbmV3IFVpbnQ4QXJyYXkodC5sZW5ndGgpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogbmV3IEFycmF5KHQubGVuZ3RoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KSh0KSkpLAogICAgICAgICAgICAgICAgICAgICAgdCkKICAgICAgICAgICAgICAgICAgICA6IHUuUHJvbWlzZS5yZWplY3QoCiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBFcnJvcigKICAgICAgICAgICAgICAgICAgICAgICAgICAiQ2FuJ3QgcmVhZCB0aGUgZGF0YSBvZiAnIiArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByICsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICInLiBJcyBpdCBpbiBhIHN1cHBvcnRlZCBKYXZhU2NyaXB0IHR5cGUgKFN0cmluZywgQmxvYiwgQXJyYXlCdWZmZXIsIGV0YykgPyIsCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIi4vYmFzZTY0IjogMSwKICAgICAgICAgICIuL2V4dGVybmFsIjogNiwKICAgICAgICAgICIuL25vZGVqc1V0aWxzIjogMTQsCiAgICAgICAgICAiLi9zdXBwb3J0IjogMzAsCiAgICAgICAgICAic2V0LWltbWVkaWF0ZS1zaGltIjogNTQsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgMzM6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIGkgPSB0KCIuL3JlYWRlci9yZWFkZXJGb3IiKSwKICAgICAgICAgICAgbiA9IHQoIi4vdXRpbHMiKSwKICAgICAgICAgICAgcyA9IHQoIi4vc2lnbmF0dXJlIiksCiAgICAgICAgICAgIGEgPSB0KCIuL3ppcEVudHJ5IiksCiAgICAgICAgICAgIG8gPSAodCgiLi91dGY4IiksIHQoIi4vc3VwcG9ydCIpKTsKICAgICAgICAgIGZ1bmN0aW9uIGgodCkgewogICAgICAgICAgICAodGhpcy5maWxlcyA9IFtdKSwgKHRoaXMubG9hZE9wdGlvbnMgPSB0KTsKICAgICAgICAgIH0KICAgICAgICAgIChoLnByb3RvdHlwZSA9IHsKICAgICAgICAgICAgY2hlY2tTaWduYXR1cmU6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgaWYgKCF0aGlzLnJlYWRlci5yZWFkQW5kQ2hlY2tTaWduYXR1cmUodCkpIHsKICAgICAgICAgICAgICAgIHRoaXMucmVhZGVyLmluZGV4IC09IDQ7CiAgICAgICAgICAgICAgICB2YXIgZSA9IHRoaXMucmVhZGVyLnJlYWRTdHJpbmcoNCk7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAgICJDb3JydXB0ZWQgemlwIG9yIGJ1ZzogdW5leHBlY3RlZCBzaWduYXR1cmUgKCIgKwogICAgICAgICAgICAgICAgICAgIG4ucHJldHR5KGUpICsKICAgICAgICAgICAgICAgICAgICAiLCBleHBlY3RlZCAiICsKICAgICAgICAgICAgICAgICAgICBuLnByZXR0eSh0KSArCiAgICAgICAgICAgICAgICAgICAgIikiLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGlzU2lnbmF0dXJlOiBmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgIHZhciByID0gdGhpcy5yZWFkZXIuaW5kZXg7CiAgICAgICAgICAgICAgdGhpcy5yZWFkZXIuc2V0SW5kZXgodCk7CiAgICAgICAgICAgICAgdmFyIGkgPSB0aGlzLnJlYWRlci5yZWFkU3RyaW5nKDQpID09PSBlOwogICAgICAgICAgICAgIHJldHVybiB0aGlzLnJlYWRlci5zZXRJbmRleChyKSwgaTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcmVhZEJsb2NrRW5kT2ZDZW50cmFsOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgKHRoaXMuZGlza051bWJlciA9IHRoaXMucmVhZGVyLnJlYWRJbnQoMikpLAogICAgICAgICAgICAgICAgKHRoaXMuZGlza1dpdGhDZW50cmFsRGlyU3RhcnQgPSB0aGlzLnJlYWRlci5yZWFkSW50KDIpKSwKICAgICAgICAgICAgICAgICh0aGlzLmNlbnRyYWxEaXJSZWNvcmRzT25UaGlzRGlzayA9IHRoaXMucmVhZGVyLnJlYWRJbnQoMikpLAogICAgICAgICAgICAgICAgKHRoaXMuY2VudHJhbERpclJlY29yZHMgPSB0aGlzLnJlYWRlci5yZWFkSW50KDIpKSwKICAgICAgICAgICAgICAgICh0aGlzLmNlbnRyYWxEaXJTaXplID0gdGhpcy5yZWFkZXIucmVhZEludCg0KSksCiAgICAgICAgICAgICAgICAodGhpcy5jZW50cmFsRGlyT2Zmc2V0ID0gdGhpcy5yZWFkZXIucmVhZEludCg0KSksCiAgICAgICAgICAgICAgICAodGhpcy56aXBDb21tZW50TGVuZ3RoID0gdGhpcy5yZWFkZXIucmVhZEludCgyKSk7CiAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLnJlYWRlci5yZWFkRGF0YSh0aGlzLnppcENvbW1lbnRMZW5ndGgpLAogICAgICAgICAgICAgICAgZSA9IG8udWludDhhcnJheSA/ICJ1aW50OGFycmF5IiA6ICJhcnJheSIsCiAgICAgICAgICAgICAgICByID0gbi50cmFuc2Zvcm1UbyhlLCB0KTsKICAgICAgICAgICAgICB0aGlzLnppcENvbW1lbnQgPSB0aGlzLmxvYWRPcHRpb25zLmRlY29kZUZpbGVOYW1lKHIpOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZWFkQmxvY2taaXA2NEVuZE9mQ2VudHJhbDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICh0aGlzLnppcDY0RW5kT2ZDZW50cmFsU2l6ZSA9IHRoaXMucmVhZGVyLnJlYWRJbnQoOCkpLAogICAgICAgICAgICAgICAgdGhpcy5yZWFkZXIuc2tpcCg0KSwKICAgICAgICAgICAgICAgICh0aGlzLmRpc2tOdW1iZXIgPSB0aGlzLnJlYWRlci5yZWFkSW50KDQpKSwKICAgICAgICAgICAgICAgICh0aGlzLmRpc2tXaXRoQ2VudHJhbERpclN0YXJ0ID0gdGhpcy5yZWFkZXIucmVhZEludCg0KSksCiAgICAgICAgICAgICAgICAodGhpcy5jZW50cmFsRGlyUmVjb3Jkc09uVGhpc0Rpc2sgPSB0aGlzLnJlYWRlci5yZWFkSW50KDgpKSwKICAgICAgICAgICAgICAgICh0aGlzLmNlbnRyYWxEaXJSZWNvcmRzID0gdGhpcy5yZWFkZXIucmVhZEludCg4KSksCiAgICAgICAgICAgICAgICAodGhpcy5jZW50cmFsRGlyU2l6ZSA9IHRoaXMucmVhZGVyLnJlYWRJbnQoOCkpLAogICAgICAgICAgICAgICAgKHRoaXMuY2VudHJhbERpck9mZnNldCA9IHRoaXMucmVhZGVyLnJlYWRJbnQoOCkpLAogICAgICAgICAgICAgICAgKHRoaXMuemlwNjRFeHRlbnNpYmxlRGF0YSA9IHt9KTsKICAgICAgICAgICAgICBmb3IgKHZhciB0LCBlLCByLCBpID0gdGhpcy56aXA2NEVuZE9mQ2VudHJhbFNpemUgLSA0NDsgMCA8IGk7ICkKICAgICAgICAgICAgICAgICh0ID0gdGhpcy5yZWFkZXIucmVhZEludCgyKSksCiAgICAgICAgICAgICAgICAgIChlID0gdGhpcy5yZWFkZXIucmVhZEludCg0KSksCiAgICAgICAgICAgICAgICAgIChyID0gdGhpcy5yZWFkZXIucmVhZERhdGEoZSkpLAogICAgICAgICAgICAgICAgICAodGhpcy56aXA2NEV4dGVuc2libGVEYXRhW3RdID0gewogICAgICAgICAgICAgICAgICAgIGlkOiB0LAogICAgICAgICAgICAgICAgICAgIGxlbmd0aDogZSwKICAgICAgICAgICAgICAgICAgICB2YWx1ZTogciwKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlYWRCbG9ja1ppcDY0RW5kT2ZDZW50cmFsTG9jYXRvcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICgodGhpcy5kaXNrV2l0aFppcDY0Q2VudHJhbERpclN0YXJ0ID0gdGhpcy5yZWFkZXIucmVhZEludCg0KSksCiAgICAgICAgICAgICAgICAodGhpcy5yZWxhdGl2ZU9mZnNldEVuZE9mWmlwNjRDZW50cmFsRGlyID0KICAgICAgICAgICAgICAgICAgdGhpcy5yZWFkZXIucmVhZEludCg4KSksCiAgICAgICAgICAgICAgICAodGhpcy5kaXNrc0NvdW50ID0gdGhpcy5yZWFkZXIucmVhZEludCg0KSksCiAgICAgICAgICAgICAgICAxIDwgdGhpcy5kaXNrc0NvdW50KQogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiTXVsdGktdm9sdW1lcyB6aXAgYXJlIG5vdCBzdXBwb3J0ZWQiKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcmVhZExvY2FsRmlsZXM6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgdCwgZTsKICAgICAgICAgICAgICBmb3IgKHQgPSAwOyB0IDwgdGhpcy5maWxlcy5sZW5ndGg7IHQrKykKICAgICAgICAgICAgICAgIChlID0gdGhpcy5maWxlc1t0XSksCiAgICAgICAgICAgICAgICAgIHRoaXMucmVhZGVyLnNldEluZGV4KGUubG9jYWxIZWFkZXJPZmZzZXQpLAogICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrU2lnbmF0dXJlKHMuTE9DQUxfRklMRV9IRUFERVIpLAogICAgICAgICAgICAgICAgICBlLnJlYWRMb2NhbFBhcnQodGhpcy5yZWFkZXIpLAogICAgICAgICAgICAgICAgICBlLmhhbmRsZVVURjgoKSwKICAgICAgICAgICAgICAgICAgZS5wcm9jZXNzQXR0cmlidXRlcygpOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZWFkQ2VudHJhbERpcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHZhciB0OwogICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICB0aGlzLnJlYWRlci5zZXRJbmRleCh0aGlzLmNlbnRyYWxEaXJPZmZzZXQpOwogICAgICAgICAgICAgICAgdGhpcy5yZWFkZXIucmVhZEFuZENoZWNrU2lnbmF0dXJlKHMuQ0VOVFJBTF9GSUxFX0hFQURFUik7CgogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICh0ID0gbmV3IGEoCiAgICAgICAgICAgICAgICAgIHsgemlwNjQ6IHRoaXMuemlwNjQgfSwKICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkT3B0aW9ucywKICAgICAgICAgICAgICAgICkpLnJlYWRDZW50cmFsUGFydCh0aGlzLnJlYWRlciksCiAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZXMucHVzaCh0KTsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICB0aGlzLmNlbnRyYWxEaXJSZWNvcmRzICE9PSB0aGlzLmZpbGVzLmxlbmd0aCAmJgogICAgICAgICAgICAgICAgMCAhPT0gdGhpcy5jZW50cmFsRGlyUmVjb3JkcyAmJgogICAgICAgICAgICAgICAgMCA9PT0gdGhpcy5maWxlcy5sZW5ndGgKICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAgICJDb3JydXB0ZWQgemlwIG9yIGJ1ZzogZXhwZWN0ZWQgIiArCiAgICAgICAgICAgICAgICAgICAgdGhpcy5jZW50cmFsRGlyUmVjb3JkcyArCiAgICAgICAgICAgICAgICAgICAgIiByZWNvcmRzIGluIGNlbnRyYWwgZGlyLCBnb3QgIiArCiAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlcy5sZW5ndGgsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZWFkRW5kT2ZDZW50cmFsOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLnJlYWRlci5sYXN0SW5kZXhPZlNpZ25hdHVyZShzLkNFTlRSQUxfRElSRUNUT1JZX0VORCk7CiAgICAgICAgICAgICAgaWYgKHQgPCAwKQogICAgICAgICAgICAgICAgdGhyb3cgIXRoaXMuaXNTaWduYXR1cmUoMCwgcy5MT0NBTF9GSUxFX0hFQURFUikKICAgICAgICAgICAgICAgICAgPyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgICAiQ2FuJ3QgZmluZCBlbmQgb2YgY2VudHJhbCBkaXJlY3RvcnkgOiBpcyB0aGlzIGEgemlwIGZpbGUgPyBJZiBpdCBpcywgc2VlIGh0dHBzOi8vc3R1ay5naXRodWIuaW8vanN6aXAvZG9jdW1lbnRhdGlvbi9ob3d0by9yZWFkX3ppcC5odG1sIiwKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIDogbmV3IEVycm9yKAogICAgICAgICAgICAgICAgICAgICAgIkNvcnJ1cHRlZCB6aXA6IGNhbid0IGZpbmQgZW5kIG9mIGNlbnRyYWwgZGlyZWN0b3J5IiwKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIHRoaXMucmVhZGVyLnNldEluZGV4KHQpOwogICAgICAgICAgICAgIHZhciBlID0gdDsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAodGhpcy5jaGVja1NpZ25hdHVyZShzLkNFTlRSQUxfRElSRUNUT1JZX0VORCksCiAgICAgICAgICAgICAgICB0aGlzLnJlYWRCbG9ja0VuZE9mQ2VudHJhbCgpLAogICAgICAgICAgICAgICAgdGhpcy5kaXNrTnVtYmVyID09PSBuLk1BWF9WQUxVRV8xNkJJVFMgfHwKICAgICAgICAgICAgICAgICAgdGhpcy5kaXNrV2l0aENlbnRyYWxEaXJTdGFydCA9PT0gbi5NQVhfVkFMVUVfMTZCSVRTIHx8CiAgICAgICAgICAgICAgICAgIHRoaXMuY2VudHJhbERpclJlY29yZHNPblRoaXNEaXNrID09PSBuLk1BWF9WQUxVRV8xNkJJVFMgfHwKICAgICAgICAgICAgICAgICAgdGhpcy5jZW50cmFsRGlyUmVjb3JkcyA9PT0gbi5NQVhfVkFMVUVfMTZCSVRTIHx8CiAgICAgICAgICAgICAgICAgIHRoaXMuY2VudHJhbERpclNpemUgPT09IG4uTUFYX1ZBTFVFXzMyQklUUyB8fAogICAgICAgICAgICAgICAgICB0aGlzLmNlbnRyYWxEaXJPZmZzZXQgPT09IG4uTUFYX1ZBTFVFXzMyQklUUykKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgKCh0aGlzLnppcDY0ID0gITApLAogICAgICAgICAgICAgICAgICAodCA9IHRoaXMucmVhZGVyLmxhc3RJbmRleE9mU2lnbmF0dXJlKAogICAgICAgICAgICAgICAgICAgIHMuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfTE9DQVRPUiwKICAgICAgICAgICAgICAgICAgKSkgPCAwKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgIkNvcnJ1cHRlZCB6aXA6IGNhbid0IGZpbmQgdGhlIFpJUDY0IGVuZCBvZiBjZW50cmFsIGRpcmVjdG9yeSBsb2NhdG9yIiwKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgKHRoaXMucmVhZGVyLnNldEluZGV4KHQpLAogICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrU2lnbmF0dXJlKHMuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfTE9DQVRPUiksCiAgICAgICAgICAgICAgICAgIHRoaXMucmVhZEJsb2NrWmlwNjRFbmRPZkNlbnRyYWxMb2NhdG9yKCksCiAgICAgICAgICAgICAgICAgICF0aGlzLmlzU2lnbmF0dXJlKAogICAgICAgICAgICAgICAgICAgIHRoaXMucmVsYXRpdmVPZmZzZXRFbmRPZlppcDY0Q2VudHJhbERpciwKICAgICAgICAgICAgICAgICAgICBzLlpJUDY0X0NFTlRSQUxfRElSRUNUT1JZX0VORCwKICAgICAgICAgICAgICAgICAgKSAmJgogICAgICAgICAgICAgICAgICAgICgodGhpcy5yZWxhdGl2ZU9mZnNldEVuZE9mWmlwNjRDZW50cmFsRGlyID0KICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVhZGVyLmxhc3RJbmRleE9mU2lnbmF0dXJlKAogICAgICAgICAgICAgICAgICAgICAgICBzLlpJUDY0X0NFTlRSQUxfRElSRUNUT1JZX0VORCwKICAgICAgICAgICAgICAgICAgICAgICkpLAogICAgICAgICAgICAgICAgICAgIHRoaXMucmVsYXRpdmVPZmZzZXRFbmRPZlppcDY0Q2VudHJhbERpciA8IDApKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAgICAgIkNvcnJ1cHRlZCB6aXA6IGNhbid0IGZpbmQgdGhlIFpJUDY0IGVuZCBvZiBjZW50cmFsIGRpcmVjdG9yeSIsCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB0aGlzLnJlYWRlci5zZXRJbmRleCh0aGlzLnJlbGF0aXZlT2Zmc2V0RW5kT2ZaaXA2NENlbnRyYWxEaXIpLAogICAgICAgICAgICAgICAgICB0aGlzLmNoZWNrU2lnbmF0dXJlKHMuWklQNjRfQ0VOVFJBTF9ESVJFQ1RPUllfRU5EKSwKICAgICAgICAgICAgICAgICAgdGhpcy5yZWFkQmxvY2taaXA2NEVuZE9mQ2VudHJhbCgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB2YXIgciA9IHRoaXMuY2VudHJhbERpck9mZnNldCArIHRoaXMuY2VudHJhbERpclNpemU7CiAgICAgICAgICAgICAgdGhpcy56aXA2NCAmJiAoKHIgKz0gMjApLCAociArPSAxMiArIHRoaXMuemlwNjRFbmRPZkNlbnRyYWxTaXplKSk7CiAgICAgICAgICAgICAgdmFyIGkgPSBlIC0gcjsKICAgICAgICAgICAgICBpZiAoMCA8IGkpCiAgICAgICAgICAgICAgICB0aGlzLmlzU2lnbmF0dXJlKGUsIHMuQ0VOVFJBTF9GSUxFX0hFQURFUikgfHwKICAgICAgICAgICAgICAgICAgKHRoaXMucmVhZGVyLnplcm8gPSBpKTsKICAgICAgICAgICAgICBlbHNlIGlmIChpIDwgMCkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgICAgICAgICAgICAgIkNvcnJ1cHRlZCB6aXA6IG1pc3NpbmcgIiArIE1hdGguYWJzKGkpICsgIiBieXRlcy4iLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcHJlcGFyZVJlYWRlcjogZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICB0aGlzLnJlYWRlciA9IGkodCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGxvYWQ6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdGhpcy5wcmVwYXJlUmVhZGVyKHQpLAogICAgICAgICAgICAgICAgdGhpcy5yZWFkRW5kT2ZDZW50cmFsKCksCiAgICAgICAgICAgICAgICB0aGlzLnJlYWRDZW50cmFsRGlyKCksCiAgICAgICAgICAgICAgICB0aGlzLnJlYWRMb2NhbEZpbGVzKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KSwKICAgICAgICAgICAgKGUuZXhwb3J0cyA9IGgpOwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIi4vcmVhZGVyL3JlYWRlckZvciI6IDIyLAogICAgICAgICAgIi4vc2lnbmF0dXJlIjogMjMsCiAgICAgICAgICAiLi9zdXBwb3J0IjogMzAsCiAgICAgICAgICAiLi91dGY4IjogMzEsCiAgICAgICAgICAiLi91dGlscyI6IDMyLAogICAgICAgICAgIi4vemlwRW50cnkiOiAzNCwKICAgICAgICB9LAogICAgICBdLAogICAgICAzNDogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9IHQoIi4vcmVhZGVyL3JlYWRlckZvciIpLAogICAgICAgICAgICBzID0gdCgiLi91dGlscyIpLAogICAgICAgICAgICBuID0gdCgiLi9jb21wcmVzc2VkT2JqZWN0IiksCiAgICAgICAgICAgIGEgPSB0KCIuL2NyYzMyIiksCiAgICAgICAgICAgIG8gPSB0KCIuL3V0ZjgiKSwKICAgICAgICAgICAgaCA9IHQoIi4vY29tcHJlc3Npb25zIiksCiAgICAgICAgICAgIHUgPSB0KCIuL3N1cHBvcnQiKTsKICAgICAgICAgIGZ1bmN0aW9uIGwodCwgZSkgewogICAgICAgICAgICAodGhpcy5vcHRpb25zID0gdCksICh0aGlzLmxvYWRPcHRpb25zID0gZSk7CiAgICAgICAgICB9CiAgICAgICAgICAobC5wcm90b3R5cGUgPSB7CiAgICAgICAgICAgIGlzRW5jcnlwdGVkOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIDEgPT0gKDEgJiB0aGlzLmJpdEZsYWcpOwogICAgICAgICAgICB9LAogICAgICAgICAgICB1c2VVVEY4OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIDIwNDggPT0gKDIwNDggJiB0aGlzLmJpdEZsYWcpOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZWFkTG9jYWxQYXJ0OiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHZhciBlLCByOwogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICh0LnNraXAoMjIpLAogICAgICAgICAgICAgICAgKHRoaXMuZmlsZU5hbWVMZW5ndGggPSB0LnJlYWRJbnQoMikpLAogICAgICAgICAgICAgICAgKHIgPSB0LnJlYWRJbnQoMikpLAogICAgICAgICAgICAgICAgKHRoaXMuZmlsZU5hbWUgPSB0LnJlYWREYXRhKHRoaXMuZmlsZU5hbWVMZW5ndGgpKSwKICAgICAgICAgICAgICAgIHQuc2tpcChyKSwKICAgICAgICAgICAgICAgIC0xID09PSB0aGlzLmNvbXByZXNzZWRTaXplIHx8IC0xID09PSB0aGlzLnVuY29tcHJlc3NlZFNpemUpCiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgICAgICAgICAgICAiQnVnIG9yIGNvcnJ1cHRlZCB6aXAgOiBkaWRuJ3QgZ2V0IGVub3VnaCBpbmZvcm1hdGlvbiBmcm9tIHRoZSBjZW50cmFsIGRpcmVjdG9yeSAoY29tcHJlc3NlZFNpemUgPT09IC0xIHx8IHVuY29tcHJlc3NlZFNpemUgPT09IC0xKSIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgIG51bGwgPT09CiAgICAgICAgICAgICAgICAoZSA9IChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICBmb3IgKHZhciBlIGluIGgpCiAgICAgICAgICAgICAgICAgICAgaWYgKGguaGFzT3duUHJvcGVydHkoZSkgJiYgaFtlXS5tYWdpYyA9PT0gdCkgcmV0dXJuIGhbZV07CiAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfSkodGhpcy5jb21wcmVzc2lvbk1ldGhvZCkpCiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgICAgICAgICAgICAiQ29ycnVwdGVkIHppcCA6IGNvbXByZXNzaW9uICIgKwogICAgICAgICAgICAgICAgICAgIHMucHJldHR5KHRoaXMuY29tcHJlc3Npb25NZXRob2QpICsKICAgICAgICAgICAgICAgICAgICAiIHVua25vd24gKGlubmVyIGZpbGUgOiAiICsKICAgICAgICAgICAgICAgICAgICBzLnRyYW5zZm9ybVRvKCJzdHJpbmciLCB0aGlzLmZpbGVOYW1lKSArCiAgICAgICAgICAgICAgICAgICAgIikiLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICB0aGlzLmRlY29tcHJlc3NlZCA9IG5ldyBuKAogICAgICAgICAgICAgICAgdGhpcy5jb21wcmVzc2VkU2l6ZSwKICAgICAgICAgICAgICAgIHRoaXMudW5jb21wcmVzc2VkU2l6ZSwKICAgICAgICAgICAgICAgIHRoaXMuY3JjMzIsCiAgICAgICAgICAgICAgICBlLAogICAgICAgICAgICAgICAgdC5yZWFkRGF0YSh0aGlzLmNvbXByZXNzZWRTaXplKSwKICAgICAgICAgICAgICApOwogICAgICAgICAgICB9LAogICAgICAgICAgICByZWFkQ2VudHJhbFBhcnQ6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgKHRoaXMudmVyc2lvbk1hZGVCeSA9IHQucmVhZEludCgyKSksCiAgICAgICAgICAgICAgICB0LnNraXAoMiksCiAgICAgICAgICAgICAgICAodGhpcy5iaXRGbGFnID0gdC5yZWFkSW50KDIpKSwKICAgICAgICAgICAgICAgICh0aGlzLmNvbXByZXNzaW9uTWV0aG9kID0gdC5yZWFkU3RyaW5nKDIpKSwKICAgICAgICAgICAgICAgICh0aGlzLmRhdGUgPSB0LnJlYWREYXRlKCkpLAogICAgICAgICAgICAgICAgKHRoaXMuY3JjMzIgPSB0LnJlYWRJbnQoNCkpLAogICAgICAgICAgICAgICAgKHRoaXMuY29tcHJlc3NlZFNpemUgPSB0LnJlYWRJbnQoNCkpLAogICAgICAgICAgICAgICAgKHRoaXMudW5jb21wcmVzc2VkU2l6ZSA9IHQucmVhZEludCg0KSk7CiAgICAgICAgICAgICAgdmFyIGUgPSB0LnJlYWRJbnQoMik7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgKCh0aGlzLmV4dHJhRmllbGRzTGVuZ3RoID0gdC5yZWFkSW50KDIpKSwKICAgICAgICAgICAgICAgICh0aGlzLmZpbGVDb21tZW50TGVuZ3RoID0gdC5yZWFkSW50KDIpKSwKICAgICAgICAgICAgICAgICh0aGlzLmRpc2tOdW1iZXJTdGFydCA9IHQucmVhZEludCgyKSksCiAgICAgICAgICAgICAgICAodGhpcy5pbnRlcm5hbEZpbGVBdHRyaWJ1dGVzID0gdC5yZWFkSW50KDIpKSwKICAgICAgICAgICAgICAgICh0aGlzLmV4dGVybmFsRmlsZUF0dHJpYnV0ZXMgPSB0LnJlYWRJbnQoNCkpLAogICAgICAgICAgICAgICAgKHRoaXMubG9jYWxIZWFkZXJPZmZzZXQgPSB0LnJlYWRJbnQoNCkpLAogICAgICAgICAgICAgICAgdGhpcy5pc0VuY3J5cHRlZCgpKQogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigiRW5jcnlwdGVkIHppcCBhcmUgbm90IHN1cHBvcnRlZCIpOwogICAgICAgICAgICAgIHQuc2tpcChlKSwKICAgICAgICAgICAgICAgIHRoaXMucmVhZEV4dHJhRmllbGRzKHQpLAogICAgICAgICAgICAgICAgdGhpcy5wYXJzZVpJUDY0RXh0cmFGaWVsZCh0KSwKICAgICAgICAgICAgICAgICh0aGlzLmZpbGVDb21tZW50ID0gdC5yZWFkRGF0YSh0aGlzLmZpbGVDb21tZW50TGVuZ3RoKSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHByb2Nlc3NBdHRyaWJ1dGVzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgKHRoaXMudW5peFBlcm1pc3Npb25zID0gbnVsbCksICh0aGlzLmRvc1Blcm1pc3Npb25zID0gbnVsbCk7CiAgICAgICAgICAgICAgdmFyIHQgPSB0aGlzLnZlcnNpb25NYWRlQnkgPj4gODsKICAgICAgICAgICAgICAodGhpcy5kaXIgPSAhISgxNiAmIHRoaXMuZXh0ZXJuYWxGaWxlQXR0cmlidXRlcykpLAogICAgICAgICAgICAgICAgMCA9PSB0ICYmCiAgICAgICAgICAgICAgICAgICh0aGlzLmRvc1Blcm1pc3Npb25zID0gNjMgJiB0aGlzLmV4dGVybmFsRmlsZUF0dHJpYnV0ZXMpLAogICAgICAgICAgICAgICAgMyA9PSB0ICYmCiAgICAgICAgICAgICAgICAgICh0aGlzLnVuaXhQZXJtaXNzaW9ucyA9CiAgICAgICAgICAgICAgICAgICAgKHRoaXMuZXh0ZXJuYWxGaWxlQXR0cmlidXRlcyA+PiAxNikgJiA2NTUzNSksCiAgICAgICAgICAgICAgICB0aGlzLmRpciB8fAogICAgICAgICAgICAgICAgICAiLyIgIT09IHRoaXMuZmlsZU5hbWVTdHIuc2xpY2UoLTEpIHx8CiAgICAgICAgICAgICAgICAgICh0aGlzLmRpciA9ICEwKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgcGFyc2VaSVA2NEV4dHJhRmllbGQ6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMuZXh0cmFGaWVsZHNbMV0pIHsKICAgICAgICAgICAgICAgIHZhciBlID0gaSh0aGlzLmV4dHJhRmllbGRzWzFdLnZhbHVlKTsKICAgICAgICAgICAgICAgIHRoaXMudW5jb21wcmVzc2VkU2l6ZSA9PT0gcy5NQVhfVkFMVUVfMzJCSVRTICYmCiAgICAgICAgICAgICAgICAgICh0aGlzLnVuY29tcHJlc3NlZFNpemUgPSBlLnJlYWRJbnQoOCkpLAogICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzZWRTaXplID09PSBzLk1BWF9WQUxVRV8zMkJJVFMgJiYKICAgICAgICAgICAgICAgICAgICAodGhpcy5jb21wcmVzc2VkU2l6ZSA9IGUucmVhZEludCg4KSksCiAgICAgICAgICAgICAgICAgIHRoaXMubG9jYWxIZWFkZXJPZmZzZXQgPT09IHMuTUFYX1ZBTFVFXzMyQklUUyAmJgogICAgICAgICAgICAgICAgICAgICh0aGlzLmxvY2FsSGVhZGVyT2Zmc2V0ID0gZS5yZWFkSW50KDgpKSwKICAgICAgICAgICAgICAgICAgdGhpcy5kaXNrTnVtYmVyU3RhcnQgPT09IHMuTUFYX1ZBTFVFXzMyQklUUyAmJgogICAgICAgICAgICAgICAgICAgICh0aGlzLmRpc2tOdW1iZXJTdGFydCA9IGUucmVhZEludCg0KSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9LAogICAgICAgICAgICByZWFkRXh0cmFGaWVsZHM6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIGUsCiAgICAgICAgICAgICAgICByLAogICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgIG4gPSB0LmluZGV4ICsgdGhpcy5leHRyYUZpZWxkc0xlbmd0aDsKICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgdGhpcy5leHRyYUZpZWxkcyB8fCAodGhpcy5leHRyYUZpZWxkcyA9IHt9KTsKICAgICAgICAgICAgICAgIHQuaW5kZXggKyA0IDwgbjsKCiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKGUgPSB0LnJlYWRJbnQoMikpLAogICAgICAgICAgICAgICAgICAociA9IHQucmVhZEludCgyKSksCiAgICAgICAgICAgICAgICAgIChpID0gdC5yZWFkRGF0YShyKSksCiAgICAgICAgICAgICAgICAgICh0aGlzLmV4dHJhRmllbGRzW2VdID0geyBpZDogZSwgbGVuZ3RoOiByLCB2YWx1ZTogaSB9KTsKICAgICAgICAgICAgICB0LnNldEluZGV4KG4pOwogICAgICAgICAgICB9LAogICAgICAgICAgICBoYW5kbGVVVEY4OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIHQgPSB1LnVpbnQ4YXJyYXkgPyAidWludDhhcnJheSIgOiAiYXJyYXkiOwogICAgICAgICAgICAgIGlmICh0aGlzLnVzZVVURjgoKSkKICAgICAgICAgICAgICAgICh0aGlzLmZpbGVOYW1lU3RyID0gby51dGY4ZGVjb2RlKHRoaXMuZmlsZU5hbWUpKSwKICAgICAgICAgICAgICAgICAgKHRoaXMuZmlsZUNvbW1lbnRTdHIgPSBvLnV0ZjhkZWNvZGUodGhpcy5maWxlQ29tbWVudCkpOwogICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgdmFyIGUgPSB0aGlzLmZpbmRFeHRyYUZpZWxkVW5pY29kZVBhdGgoKTsKICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBlKSB0aGlzLmZpbGVOYW1lU3RyID0gZTsKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICB2YXIgciA9IHMudHJhbnNmb3JtVG8odCwgdGhpcy5maWxlTmFtZSk7CiAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZU5hbWVTdHIgPSB0aGlzLmxvYWRPcHRpb25zLmRlY29kZUZpbGVOYW1lKHIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmZpbmRFeHRyYUZpZWxkVW5pY29kZUNvbW1lbnQoKTsKICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBpKSB0aGlzLmZpbGVDb21tZW50U3RyID0gaTsKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICB2YXIgbiA9IHMudHJhbnNmb3JtVG8odCwgdGhpcy5maWxlQ29tbWVudCk7CiAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNvbW1lbnRTdHIgPSB0aGlzLmxvYWRPcHRpb25zLmRlY29kZUZpbGVOYW1lKG4pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgZmluZEV4dHJhRmllbGRVbmljb2RlUGF0aDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHZhciB0ID0gdGhpcy5leHRyYUZpZWxkc1syODc4OV07CiAgICAgICAgICAgICAgaWYgKHQpIHsKICAgICAgICAgICAgICAgIHZhciBlID0gaSh0LnZhbHVlKTsKICAgICAgICAgICAgICAgIHJldHVybiAxICE9PSBlLnJlYWRJbnQoMSkKICAgICAgICAgICAgICAgICAgPyBudWxsCiAgICAgICAgICAgICAgICAgIDogYSh0aGlzLmZpbGVOYW1lKSAhPT0gZS5yZWFkSW50KDQpCiAgICAgICAgICAgICAgICAgICAgPyBudWxsCiAgICAgICAgICAgICAgICAgICAgOiBvLnV0ZjhkZWNvZGUoZS5yZWFkRGF0YSh0Lmxlbmd0aCAtIDUpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGZpbmRFeHRyYUZpZWxkVW5pY29kZUNvbW1lbnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgdCA9IHRoaXMuZXh0cmFGaWVsZHNbMjU0NjFdOwogICAgICAgICAgICAgIGlmICh0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSA9IGkodC52YWx1ZSk7CiAgICAgICAgICAgICAgICByZXR1cm4gMSAhPT0gZS5yZWFkSW50KDEpCiAgICAgICAgICAgICAgICAgID8gbnVsbAogICAgICAgICAgICAgICAgICA6IGEodGhpcy5maWxlQ29tbWVudCkgIT09IGUucmVhZEludCg0KQogICAgICAgICAgICAgICAgICAgID8gbnVsbAogICAgICAgICAgICAgICAgICAgIDogby51dGY4ZGVjb2RlKGUucmVhZERhdGEodC5sZW5ndGggLSA1KSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICB9LAogICAgICAgICAgfSksCiAgICAgICAgICAgIChlLmV4cG9ydHMgPSBsKTsKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICIuL2NvbXByZXNzZWRPYmplY3QiOiAyLAogICAgICAgICAgIi4vY29tcHJlc3Npb25zIjogMywKICAgICAgICAgICIuL2NyYzMyIjogNCwKICAgICAgICAgICIuL3JlYWRlci9yZWFkZXJGb3IiOiAyMiwKICAgICAgICAgICIuL3N1cHBvcnQiOiAzMCwKICAgICAgICAgICIuL3V0ZjgiOiAzMSwKICAgICAgICAgICIuL3V0aWxzIjogMzIsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgMzU6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgZnVuY3Rpb24gaSh0LCBlLCByKSB7CiAgICAgICAgICAgICh0aGlzLm5hbWUgPSB0KSwKICAgICAgICAgICAgICAodGhpcy5kaXIgPSByLmRpciksCiAgICAgICAgICAgICAgKHRoaXMuZGF0ZSA9IHIuZGF0ZSksCiAgICAgICAgICAgICAgKHRoaXMuY29tbWVudCA9IHIuY29tbWVudCksCiAgICAgICAgICAgICAgKHRoaXMudW5peFBlcm1pc3Npb25zID0gci51bml4UGVybWlzc2lvbnMpLAogICAgICAgICAgICAgICh0aGlzLmRvc1Blcm1pc3Npb25zID0gci5kb3NQZXJtaXNzaW9ucyksCiAgICAgICAgICAgICAgKHRoaXMuX2RhdGEgPSBlKSwKICAgICAgICAgICAgICAodGhpcy5fZGF0YUJpbmFyeSA9IHIuYmluYXJ5KSwKICAgICAgICAgICAgICAodGhpcy5vcHRpb25zID0gewogICAgICAgICAgICAgICAgY29tcHJlc3Npb246IHIuY29tcHJlc3Npb24sCiAgICAgICAgICAgICAgICBjb21wcmVzc2lvbk9wdGlvbnM6IHIuY29tcHJlc3Npb25PcHRpb25zLAogICAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgdmFyIHMgPSB0KCIuL3N0cmVhbS9TdHJlYW1IZWxwZXIiKSwKICAgICAgICAgICAgbiA9IHQoIi4vc3RyZWFtL0RhdGFXb3JrZXIiKSwKICAgICAgICAgICAgYSA9IHQoIi4vdXRmOCIpLAogICAgICAgICAgICBvID0gdCgiLi9jb21wcmVzc2VkT2JqZWN0IiksCiAgICAgICAgICAgIGggPSB0KCIuL3N0cmVhbS9HZW5lcmljV29ya2VyIik7CiAgICAgICAgICBpLnByb3RvdHlwZSA9IHsKICAgICAgICAgICAgaW50ZXJuYWxTdHJlYW06IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIGUgPSBudWxsLAogICAgICAgICAgICAgICAgciA9ICJzdHJpbmciOwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZiAoIXQpIHRocm93IG5ldyBFcnJvcigiTm8gb3V0cHV0IHR5cGUgc3BlY2lmaWVkLiIpOwogICAgICAgICAgICAgICAgdmFyIGkgPSAic3RyaW5nIiA9PT0gKHIgPSB0LnRvTG93ZXJDYXNlKCkpIHx8ICJ0ZXh0IiA9PT0gcjsKICAgICAgICAgICAgICAgICgiYmluYXJ5c3RyaW5nIiAhPT0gciAmJiAidGV4dCIgIT09IHIpIHx8IChyID0gInN0cmluZyIpLAogICAgICAgICAgICAgICAgICAoZSA9IHRoaXMuX2RlY29tcHJlc3NXb3JrZXIoKSk7CiAgICAgICAgICAgICAgICB2YXIgbiA9ICF0aGlzLl9kYXRhQmluYXJ5OwogICAgICAgICAgICAgICAgbiAmJiAhaSAmJiAoZSA9IGUucGlwZShuZXcgYS5VdGY4RW5jb2RlV29ya2VyKCkpKSwKICAgICAgICAgICAgICAgICAgIW4gJiYgaSAmJiAoZSA9IGUucGlwZShuZXcgYS5VdGY4RGVjb2RlV29ya2VyKCkpKTsKICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICAoZSA9IG5ldyBoKCJlcnJvciIpKS5lcnJvcih0KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBzKGUsIHIsICIiKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgYXN5bmM6IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW50ZXJuYWxTdHJlYW0odCkuYWNjdW11bGF0ZShlKTsKICAgICAgICAgICAgfSwKICAgICAgICAgICAgbm9kZVN0cmVhbTogZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpcy5pbnRlcm5hbFN0cmVhbSh0IHx8ICJub2RlYnVmZmVyIikudG9Ob2RlanNTdHJlYW0oZSk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF9jb21wcmVzc1dvcmtlcjogZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICB0aGlzLl9kYXRhIGluc3RhbmNlb2YgbyAmJgogICAgICAgICAgICAgICAgdGhpcy5fZGF0YS5jb21wcmVzc2lvbi5tYWdpYyA9PT0gdC5tYWdpYwogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9kYXRhLmdldENvbXByZXNzZWRXb3JrZXIoKTsKICAgICAgICAgICAgICB2YXIgciA9IHRoaXMuX2RlY29tcHJlc3NXb3JrZXIoKTsKICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgdGhpcy5fZGF0YUJpbmFyeSB8fCAociA9IHIucGlwZShuZXcgYS5VdGY4RW5jb2RlV29ya2VyKCkpKSwKICAgICAgICAgICAgICAgIG8uY3JlYXRlV29ya2VyRnJvbShyLCB0LCBlKQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIF9kZWNvbXByZXNzV29ya2VyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGEgaW5zdGFuY2VvZiBvCiAgICAgICAgICAgICAgICA/IHRoaXMuX2RhdGEuZ2V0Q29udGVudFdvcmtlcigpCiAgICAgICAgICAgICAgICA6IHRoaXMuX2RhdGEgaW5zdGFuY2VvZiBoCiAgICAgICAgICAgICAgICAgID8gdGhpcy5fZGF0YQogICAgICAgICAgICAgICAgICA6IG5ldyBuKHRoaXMuX2RhdGEpOwogICAgICAgICAgICB9LAogICAgICAgICAgfTsKICAgICAgICAgIGZvciAoCiAgICAgICAgICAgIHZhciB1ID0gWwogICAgICAgICAgICAgICAgImFzVGV4dCIsCiAgICAgICAgICAgICAgICAiYXNCaW5hcnkiLAogICAgICAgICAgICAgICAgImFzTm9kZUJ1ZmZlciIsCiAgICAgICAgICAgICAgICAiYXNVaW50OEFycmF5IiwKICAgICAgICAgICAgICAgICJhc0FycmF5QnVmZmVyIiwKICAgICAgICAgICAgICBdLAogICAgICAgICAgICAgIGwgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoCiAgICAgICAgICAgICAgICAgICJUaGlzIG1ldGhvZCBoYXMgYmVlbiByZW1vdmVkIGluIEpTWmlwIDMuMCwgcGxlYXNlIGNoZWNrIHRoZSB1cGdyYWRlIGd1aWRlLiIsCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZiA9IDA7CiAgICAgICAgICAgIGYgPCB1Lmxlbmd0aDsKICAgICAgICAgICAgZisrCiAgICAgICAgICApCiAgICAgICAgICAgIGkucHJvdG90eXBlW3VbZl1dID0gbDsKICAgICAgICAgIGUuZXhwb3J0cyA9IGk7CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAiLi9jb21wcmVzc2VkT2JqZWN0IjogMiwKICAgICAgICAgICIuL3N0cmVhbS9EYXRhV29ya2VyIjogMjcsCiAgICAgICAgICAiLi9zdHJlYW0vR2VuZXJpY1dvcmtlciI6IDI4LAogICAgICAgICAgIi4vc3RyZWFtL1N0cmVhbUhlbHBlciI6IDI5LAogICAgICAgICAgIi4vdXRmOCI6IDMxLAogICAgICAgIH0sCiAgICAgIF0sCiAgICAgIDM2OiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGwsIGUpIHsKICAgICAgICAgIChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgdCA9IGUuTXV0YXRpb25PYnNlcnZlciB8fCBlLldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7CiAgICAgICAgICAgIGlmICh0KSB7CiAgICAgICAgICAgICAgdmFyIG4gPSAwLAogICAgICAgICAgICAgICAgcyA9IG5ldyB0KHUpLAogICAgICAgICAgICAgICAgYSA9IGUuZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiIpOwogICAgICAgICAgICAgIHMub2JzZXJ2ZShhLCB7IGNoYXJhY3RlckRhdGE6ICEwIH0pLAogICAgICAgICAgICAgICAgKHIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIGEuZGF0YSA9IG4gPSArK24gJSAyOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5zZXRJbW1lZGlhdGUgfHwgdm9pZCAwID09PSBlLk1lc3NhZ2VDaGFubmVsKQogICAgICAgICAgICAgIHIgPQogICAgICAgICAgICAgICAgImRvY3VtZW50IiBpbiBlICYmCiAgICAgICAgICAgICAgICAib25yZWFkeXN0YXRlY2hhbmdlIiBpbiBlLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpCiAgICAgICAgICAgICAgICAgID8gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBlLmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOwogICAgICAgICAgICAgICAgICAgICAgKHQub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgICB1KCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKHQub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICh0ID0gbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgICB9KSwKICAgICAgICAgICAgICAgICAgICAgICAgZS5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYXBwZW5kQ2hpbGQodCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQodSwgMCk7CiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgdmFyIG8gPSBuZXcgZS5NZXNzYWdlQ2hhbm5lbCgpOwogICAgICAgICAgICAgIChvLnBvcnQxLm9ubWVzc2FnZSA9IHUpLAogICAgICAgICAgICAgICAgKHIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIG8ucG9ydDIucG9zdE1lc3NhZ2UoMCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICB2YXIgaCA9IFtdOwogICAgICAgICAgICBmdW5jdGlvbiB1KCkgewogICAgICAgICAgICAgIHZhciB0LCBlOwogICAgICAgICAgICAgIGkgPSAhMDsKICAgICAgICAgICAgICBmb3IgKHZhciByID0gaC5sZW5ndGg7IHI7ICkgewogICAgICAgICAgICAgICAgZm9yIChlID0gaCwgaCA9IFtdLCB0ID0gLTE7ICsrdCA8IHI7ICkgZVt0XSgpOwogICAgICAgICAgICAgICAgciA9IGgubGVuZ3RoOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpID0gITE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbC5leHBvcnRzID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAxICE9PSBoLnB1c2godCkgfHwgaSB8fCByKCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KS5jYWxsKAogICAgICAgICAgICB0aGlzLAogICAgICAgICAgICAidW5kZWZpbmVkIiAhPSB0eXBlb2YgZ2xvYmFsCiAgICAgICAgICAgICAgPyBnbG9iYWwKICAgICAgICAgICAgICA6ICJ1bmRlZmluZWQiICE9IHR5cGVvZiBzZWxmCiAgICAgICAgICAgICAgICA/IHNlbGYKICAgICAgICAgICAgICAgIDogInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdwogICAgICAgICAgICAgICAgICA/IHdpbmRvdwogICAgICAgICAgICAgICAgICA6IHt9LAogICAgICAgICAgKTsKICAgICAgICB9LAogICAgICAgIHt9LAogICAgICBdLAogICAgICAzNzogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgbiA9IHQoImltbWVkaWF0ZSIpOwogICAgICAgICAgZnVuY3Rpb24gdSgpIHt9CiAgICAgICAgICB2YXIgbCA9IHt9LAogICAgICAgICAgICBzID0gWyJSRUpFQ1RFRCJdLAogICAgICAgICAgICBhID0gWyJGVUxGSUxMRUQiXSwKICAgICAgICAgICAgaSA9IFsiUEVORElORyJdOwogICAgICAgICAgZnVuY3Rpb24gbyh0KSB7CiAgICAgICAgICAgIGlmICgiZnVuY3Rpb24iICE9IHR5cGVvZiB0KQogICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoInJlc29sdmVyIG11c3QgYmUgYSBmdW5jdGlvbiIpOwogICAgICAgICAgICAodGhpcy5zdGF0ZSA9IGkpLAogICAgICAgICAgICAgICh0aGlzLnF1ZXVlID0gW10pLAogICAgICAgICAgICAgICh0aGlzLm91dGNvbWUgPSB2b2lkIDApLAogICAgICAgICAgICAgIHQgIT09IHUgJiYgYyh0aGlzLCB0KTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIGgodCwgZSwgcikgewogICAgICAgICAgICAodGhpcy5wcm9taXNlID0gdCksCiAgICAgICAgICAgICAgImZ1bmN0aW9uIiA9PSB0eXBlb2YgZSAmJgogICAgICAgICAgICAgICAgKCh0aGlzLm9uRnVsZmlsbGVkID0gZSksCiAgICAgICAgICAgICAgICAodGhpcy5jYWxsRnVsZmlsbGVkID0gdGhpcy5vdGhlckNhbGxGdWxmaWxsZWQpKSwKICAgICAgICAgICAgICAiZnVuY3Rpb24iID09IHR5cGVvZiByICYmCiAgICAgICAgICAgICAgICAoKHRoaXMub25SZWplY3RlZCA9IHIpLAogICAgICAgICAgICAgICAgKHRoaXMuY2FsbFJlamVjdGVkID0gdGhpcy5vdGhlckNhbGxSZWplY3RlZCkpOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gZihlLCByLCBpKSB7CiAgICAgICAgICAgIG4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHZhciB0OwogICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB0ID0gcihpKTsKICAgICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbC5yZWplY3QoZSwgdCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHQgPT09IGUKICAgICAgICAgICAgICAgID8gbC5yZWplY3QoCiAgICAgICAgICAgICAgICAgICAgZSwKICAgICAgICAgICAgICAgICAgICBuZXcgVHlwZUVycm9yKCJDYW5ub3QgcmVzb2x2ZSBwcm9taXNlIHdpdGggaXRzZWxmIiksCiAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIDogbC5yZXNvbHZlKGUsIHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIGQodCkgewogICAgICAgICAgICB2YXIgZSA9IHQgJiYgdC50aGVuOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgdCAmJgogICAgICAgICAgICAgICgib2JqZWN0IiA9PSB0eXBlb2YgdCB8fCAiZnVuY3Rpb24iID09IHR5cGVvZiB0KSAmJgogICAgICAgICAgICAgICJmdW5jdGlvbiIgPT0gdHlwZW9mIGUKICAgICAgICAgICAgKQogICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBlLmFwcGx5KHQsIGFyZ3VtZW50cyk7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIGMoZSwgdCkgewogICAgICAgICAgICB2YXIgciA9ICExOwogICAgICAgICAgICBmdW5jdGlvbiBpKHQpIHsKICAgICAgICAgICAgICByIHx8ICgociA9ICEwKSwgbC5yZWplY3QoZSwgdCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGZ1bmN0aW9uIG4odCkgewogICAgICAgICAgICAgIHIgfHwgKChyID0gITApLCBsLnJlc29sdmUoZSwgdCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciBzID0gcChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdChuLCBpKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICJlcnJvciIgPT09IHMuc3RhdHVzICYmIGkocy52YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBwKHQsIGUpIHsKICAgICAgICAgICAgdmFyIHIgPSB7fTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAoci52YWx1ZSA9IHQoZSkpLCAoci5zdGF0dXMgPSAic3VjY2VzcyIpOwogICAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgICAgKHIuc3RhdHVzID0gImVycm9yIiksIChyLnZhbHVlID0gdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgICB9CiAgICAgICAgICAoKGUuZXhwb3J0cyA9IG8pLnByb3RvdHlwZS5maW5hbGx5ID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgaWYgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGUpIHJldHVybiB0aGlzOwogICAgICAgICAgICB2YXIgciA9IHRoaXMuY29uc3RydWN0b3I7CiAgICAgICAgICAgIHJldHVybiB0aGlzLnRoZW4oCiAgICAgICAgICAgICAgZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgIHJldHVybiByLnJlc29sdmUoZSgpKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHQ7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gci5yZXNvbHZlKGUoKSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIHRocm93IHQ7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICApOwogICAgICAgICAgfSksCiAgICAgICAgICAgIChvLnByb3RvdHlwZS5jYXRjaCA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCB0KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChvLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAoImZ1bmN0aW9uIiAhPSB0eXBlb2YgdCAmJiB0aGlzLnN0YXRlID09PSBhKSB8fAogICAgICAgICAgICAgICAgKCJmdW5jdGlvbiIgIT0gdHlwZW9mIGUgJiYgdGhpcy5zdGF0ZSA9PT0gcykKICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgICB2YXIgciA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKHUpOwogICAgICAgICAgICAgIHRoaXMuc3RhdGUgIT09IGkKICAgICAgICAgICAgICAgID8gZihyLCB0aGlzLnN0YXRlID09PSBhID8gdCA6IGUsIHRoaXMub3V0Y29tZSkKICAgICAgICAgICAgICAgIDogdGhpcy5xdWV1ZS5wdXNoKG5ldyBoKHIsIHQsIGUpKTsKICAgICAgICAgICAgICByZXR1cm4gcjsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChoLnByb3RvdHlwZS5jYWxsRnVsZmlsbGVkID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBsLnJlc29sdmUodGhpcy5wcm9taXNlLCB0KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChoLnByb3RvdHlwZS5vdGhlckNhbGxGdWxmaWxsZWQgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGYodGhpcy5wcm9taXNlLCB0aGlzLm9uRnVsZmlsbGVkLCB0KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChoLnByb3RvdHlwZS5jYWxsUmVqZWN0ZWQgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGwucmVqZWN0KHRoaXMucHJvbWlzZSwgdCk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoaC5wcm90b3R5cGUub3RoZXJDYWxsUmVqZWN0ZWQgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIGYodGhpcy5wcm9taXNlLCB0aGlzLm9uUmVqZWN0ZWQsIHQpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKGwucmVzb2x2ZSA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgdmFyIHIgPSBwKGQsIGUpOwogICAgICAgICAgICAgIGlmICgiZXJyb3IiID09PSByLnN0YXR1cykgcmV0dXJuIGwucmVqZWN0KHQsIHIudmFsdWUpOwogICAgICAgICAgICAgIHZhciBpID0gci52YWx1ZTsKICAgICAgICAgICAgICBpZiAoaSkgYyh0LCBpKTsKICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICh0LnN0YXRlID0gYSksICh0Lm91dGNvbWUgPSBlKTsKICAgICAgICAgICAgICAgIGZvciAodmFyIG4gPSAtMSwgcyA9IHQucXVldWUubGVuZ3RoOyArK24gPCBzOyApCiAgICAgICAgICAgICAgICAgIHQucXVldWVbbl0uY2FsbEZ1bGZpbGxlZChlKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIHQ7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAobC5yZWplY3QgPSBmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgICh0LnN0YXRlID0gcyksICh0Lm91dGNvbWUgPSBlKTsKICAgICAgICAgICAgICBmb3IgKHZhciByID0gLTEsIGkgPSB0LnF1ZXVlLmxlbmd0aDsgKytyIDwgaTsgKQogICAgICAgICAgICAgICAgdC5xdWV1ZVtyXS5jYWxsUmVqZWN0ZWQoZSk7CiAgICAgICAgICAgICAgcmV0dXJuIHQ7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoby5yZXNvbHZlID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIHRoaXMpIHJldHVybiB0OwogICAgICAgICAgICAgIHJldHVybiBsLnJlc29sdmUobmV3IHRoaXModSksIHQpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKG8ucmVqZWN0ID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICB2YXIgZSA9IG5ldyB0aGlzKHUpOwogICAgICAgICAgICAgIHJldHVybiBsLnJlamVjdChlLCB0KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChvLmFsbCA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIHIgPSB0aGlzOwogICAgICAgICAgICAgIGlmICgiW29iamVjdCBBcnJheV0iICE9PSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCkpCiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5yZWplY3QobmV3IFR5cGVFcnJvcigibXVzdCBiZSBhbiBhcnJheSIpKTsKICAgICAgICAgICAgICB2YXIgaSA9IHQubGVuZ3RoLAogICAgICAgICAgICAgICAgbiA9ICExOwogICAgICAgICAgICAgIGlmICghaSkgcmV0dXJuIHRoaXMucmVzb2x2ZShbXSk7CiAgICAgICAgICAgICAgdmFyIHMgPSBuZXcgQXJyYXkoaSksCiAgICAgICAgICAgICAgICBhID0gMCwKICAgICAgICAgICAgICAgIGUgPSAtMSwKICAgICAgICAgICAgICAgIG8gPSBuZXcgdGhpcyh1KTsKICAgICAgICAgICAgICBmb3IgKDsgKytlIDwgaTsgKSBoKHRbZV0sIGUpOwogICAgICAgICAgICAgIHJldHVybiBvOwogICAgICAgICAgICAgIGZ1bmN0aW9uIGgodCwgZSkgewogICAgICAgICAgICAgICAgci5yZXNvbHZlKHQpLnRoZW4oCiAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgICAgKHNbZV0gPSB0KSwgKythICE9PSBpIHx8IG4gfHwgKChuID0gITApLCBsLnJlc29sdmUobywgcykpOwogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgIG4gfHwgKChuID0gITApLCBsLnJlamVjdChvLCB0KSk7CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChvLnJhY2UgPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIHZhciBlID0gdGhpczsKICAgICAgICAgICAgICBpZiAoIltvYmplY3QgQXJyYXldIiAhPT0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpKQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVqZWN0KG5ldyBUeXBlRXJyb3IoIm11c3QgYmUgYW4gYXJyYXkiKSk7CiAgICAgICAgICAgICAgdmFyIHIgPSB0Lmxlbmd0aCwKICAgICAgICAgICAgICAgIGkgPSAhMTsKICAgICAgICAgICAgICBpZiAoIXIpIHJldHVybiB0aGlzLnJlc29sdmUoW10pOwogICAgICAgICAgICAgIHZhciBuID0gLTEsCiAgICAgICAgICAgICAgICBzID0gbmV3IHRoaXModSk7CiAgICAgICAgICAgICAgZm9yICg7ICsrbiA8IHI7ICkKICAgICAgICAgICAgICAgIChhID0gdFtuXSksCiAgICAgICAgICAgICAgICAgIGUucmVzb2x2ZShhKS50aGVuKAogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICBpIHx8ICgoaSA9ICEwKSwgbC5yZXNvbHZlKHMsIHQpKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgICAgICBpIHx8ICgoaSA9ICEwKSwgbC5yZWplY3QocywgdCkpOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgdmFyIGE7CiAgICAgICAgICAgICAgcmV0dXJuIHM7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgeyBpbW1lZGlhdGU6IDM2IH0sCiAgICAgIF0sCiAgICAgIDM4OiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIHZhciBpID0ge307CiAgICAgICAgICAoMCwgdCgiLi9saWIvdXRpbHMvY29tbW9uIikuYXNzaWduKSgKICAgICAgICAgICAgaSwKICAgICAgICAgICAgdCgiLi9saWIvZGVmbGF0ZSIpLAogICAgICAgICAgICB0KCIuL2xpYi9pbmZsYXRlIiksCiAgICAgICAgICAgIHQoIi4vbGliL3psaWIvY29uc3RhbnRzIiksCiAgICAgICAgICApLAogICAgICAgICAgICAoZS5leHBvcnRzID0gaSk7CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAiLi9saWIvZGVmbGF0ZSI6IDM5LAogICAgICAgICAgIi4vbGliL2luZmxhdGUiOiA0MCwKICAgICAgICAgICIuL2xpYi91dGlscy9jb21tb24iOiA0MSwKICAgICAgICAgICIuL2xpYi96bGliL2NvbnN0YW50cyI6IDQ0LAogICAgICAgIH0sCiAgICAgIF0sCiAgICAgIDM5OiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIHZhciBhID0gdCgiLi96bGliL2RlZmxhdGUiKSwKICAgICAgICAgICAgbyA9IHQoIi4vdXRpbHMvY29tbW9uIiksCiAgICAgICAgICAgIGggPSB0KCIuL3V0aWxzL3N0cmluZ3MiKSwKICAgICAgICAgICAgbiA9IHQoIi4vemxpYi9tZXNzYWdlcyIpLAogICAgICAgICAgICBzID0gdCgiLi96bGliL3pzdHJlYW0iKSwKICAgICAgICAgICAgdSA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcsCiAgICAgICAgICAgIGwgPSAwLAogICAgICAgICAgICBmID0gLTEsCiAgICAgICAgICAgIGQgPSAwLAogICAgICAgICAgICBjID0gODsKICAgICAgICAgIGZ1bmN0aW9uIHAodCkgewogICAgICAgICAgICBpZiAoISh0aGlzIGluc3RhbmNlb2YgcCkpIHJldHVybiBuZXcgcCh0KTsKICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gby5hc3NpZ24oCiAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgbGV2ZWw6IGYsCiAgICAgICAgICAgICAgICBtZXRob2Q6IGMsCiAgICAgICAgICAgICAgICBjaHVua1NpemU6IDE2Mzg0LAogICAgICAgICAgICAgICAgd2luZG93Qml0czogMTUsCiAgICAgICAgICAgICAgICBtZW1MZXZlbDogOCwKICAgICAgICAgICAgICAgIHN0cmF0ZWd5OiBkLAogICAgICAgICAgICAgICAgdG86ICIiLAogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgdCB8fCB7fSwKICAgICAgICAgICAgKTsKICAgICAgICAgICAgdmFyIGUgPSB0aGlzLm9wdGlvbnM7CiAgICAgICAgICAgIGUucmF3ICYmIDAgPCBlLndpbmRvd0JpdHMKICAgICAgICAgICAgICA/IChlLndpbmRvd0JpdHMgPSAtZS53aW5kb3dCaXRzKQogICAgICAgICAgICAgIDogZS5nemlwICYmCiAgICAgICAgICAgICAgICAwIDwgZS53aW5kb3dCaXRzICYmCiAgICAgICAgICAgICAgICBlLndpbmRvd0JpdHMgPCAxNiAmJgogICAgICAgICAgICAgICAgKGUud2luZG93Qml0cyArPSAxNiksCiAgICAgICAgICAgICAgKHRoaXMuZXJyID0gMCksCiAgICAgICAgICAgICAgKHRoaXMubXNnID0gIiIpLAogICAgICAgICAgICAgICh0aGlzLmVuZGVkID0gITEpLAogICAgICAgICAgICAgICh0aGlzLmNodW5rcyA9IFtdKSwKICAgICAgICAgICAgICAodGhpcy5zdHJtID0gbmV3IHMoKSksCiAgICAgICAgICAgICAgKHRoaXMuc3RybS5hdmFpbF9vdXQgPSAwKTsKICAgICAgICAgICAgdmFyIHIgPSBhLmRlZmxhdGVJbml0MigKICAgICAgICAgICAgICB0aGlzLnN0cm0sCiAgICAgICAgICAgICAgZS5sZXZlbCwKICAgICAgICAgICAgICBlLm1ldGhvZCwKICAgICAgICAgICAgICBlLndpbmRvd0JpdHMsCiAgICAgICAgICAgICAgZS5tZW1MZXZlbCwKICAgICAgICAgICAgICBlLnN0cmF0ZWd5LAogICAgICAgICAgICApOwogICAgICAgICAgICBpZiAociAhPT0gbCkgdGhyb3cgbmV3IEVycm9yKG5bcl0pOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgKGUuaGVhZGVyICYmIGEuZGVmbGF0ZVNldEhlYWRlcih0aGlzLnN0cm0sIGUuaGVhZGVyKSwKICAgICAgICAgICAgICBlLmRpY3Rpb25hcnkpCiAgICAgICAgICAgICkgewogICAgICAgICAgICAgIHZhciBpOwogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICgoaSA9CiAgICAgICAgICAgICAgICAgICJzdHJpbmciID09IHR5cGVvZiBlLmRpY3Rpb25hcnkKICAgICAgICAgICAgICAgICAgICA/IGguc3RyaW5nMmJ1ZihlLmRpY3Rpb25hcnkpCiAgICAgICAgICAgICAgICAgICAgOiAiW29iamVjdCBBcnJheUJ1ZmZlcl0iID09PSB1LmNhbGwoZS5kaWN0aW9uYXJ5KQogICAgICAgICAgICAgICAgICAgICAgPyBuZXcgVWludDhBcnJheShlLmRpY3Rpb25hcnkpCiAgICAgICAgICAgICAgICAgICAgICA6IGUuZGljdGlvbmFyeSksCiAgICAgICAgICAgICAgICAociA9IGEuZGVmbGF0ZVNldERpY3Rpb25hcnkodGhpcy5zdHJtLCBpKSkgIT09IGwpCiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKG5bcl0pOwogICAgICAgICAgICAgIHRoaXMuX2RpY3Rfc2V0ID0gITA7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIGkodCwgZSkgewogICAgICAgICAgICB2YXIgciA9IG5ldyBwKGUpOwogICAgICAgICAgICBpZiAoKHIucHVzaCh0LCAhMCksIHIuZXJyKSkgdGhyb3cgci5tc2cgfHwgbltyLmVycl07CiAgICAgICAgICAgIHJldHVybiByLnJlc3VsdDsKICAgICAgICAgIH0KICAgICAgICAgIChwLnByb3RvdHlwZS5wdXNoID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgdmFyIHIsCiAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICBuID0gdGhpcy5zdHJtLAogICAgICAgICAgICAgIHMgPSB0aGlzLm9wdGlvbnMuY2h1bmtTaXplOwogICAgICAgICAgICBpZiAodGhpcy5lbmRlZCkgcmV0dXJuICExOwogICAgICAgICAgICAoaSA9IGUgPT09IH5+ZSA/IGUgOiAhMCA9PT0gZSA/IDQgOiAwKSwKICAgICAgICAgICAgICAic3RyaW5nIiA9PSB0eXBlb2YgdAogICAgICAgICAgICAgICAgPyAobi5pbnB1dCA9IGguc3RyaW5nMmJ1Zih0KSkKICAgICAgICAgICAgICAgIDogIltvYmplY3QgQXJyYXlCdWZmZXJdIiA9PT0gdS5jYWxsKHQpCiAgICAgICAgICAgICAgICAgID8gKG4uaW5wdXQgPSBuZXcgVWludDhBcnJheSh0KSkKICAgICAgICAgICAgICAgICAgOiAobi5pbnB1dCA9IHQpLAogICAgICAgICAgICAgIChuLm5leHRfaW4gPSAwKSwKICAgICAgICAgICAgICAobi5hdmFpbF9pbiA9IG4uaW5wdXQubGVuZ3RoKTsKICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICgwID09PSBuLmF2YWlsX291dCAmJgogICAgICAgICAgICAgICAgICAoKG4ub3V0cHV0ID0gbmV3IG8uQnVmOChzKSksCiAgICAgICAgICAgICAgICAgIChuLm5leHRfb3V0ID0gMCksCiAgICAgICAgICAgICAgICAgIChuLmF2YWlsX291dCA9IHMpKSwKICAgICAgICAgICAgICAgIDEgIT09IChyID0gYS5kZWZsYXRlKG4sIGkpKSAmJiByICE9PSBsKQogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLm9uRW5kKHIpLCAhKHRoaXMuZW5kZWQgPSAhMCk7CiAgICAgICAgICAgICAgKDAgIT09IG4uYXZhaWxfb3V0ICYmCiAgICAgICAgICAgICAgICAoMCAhPT0gbi5hdmFpbF9pbiB8fCAoNCAhPT0gaSAmJiAyICE9PSBpKSkpIHx8CiAgICAgICAgICAgICAgICAoInN0cmluZyIgPT09IHRoaXMub3B0aW9ucy50bwogICAgICAgICAgICAgICAgICA/IHRoaXMub25EYXRhKAogICAgICAgICAgICAgICAgICAgICAgaC5idWYyYmluc3RyaW5nKG8uc2hyaW5rQnVmKG4ub3V0cHV0LCBuLm5leHRfb3V0KSksCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICA6IHRoaXMub25EYXRhKG8uc2hyaW5rQnVmKG4ub3V0cHV0LCBuLm5leHRfb3V0KSkpOwogICAgICAgICAgICB9IHdoaWxlICgoMCA8IG4uYXZhaWxfaW4gfHwgMCA9PT0gbi5hdmFpbF9vdXQpICYmIDEgIT09IHIpOwogICAgICAgICAgICByZXR1cm4gNCA9PT0gaQogICAgICAgICAgICAgID8gKChyID0gYS5kZWZsYXRlRW5kKHRoaXMuc3RybSkpLAogICAgICAgICAgICAgICAgdGhpcy5vbkVuZChyKSwKICAgICAgICAgICAgICAgICh0aGlzLmVuZGVkID0gITApLAogICAgICAgICAgICAgICAgciA9PT0gbCkKICAgICAgICAgICAgICA6IDIgIT09IGkgfHwgKHRoaXMub25FbmQobCksICEobi5hdmFpbF9vdXQgPSAwKSk7CiAgICAgICAgICB9KSwKICAgICAgICAgICAgKHAucHJvdG90eXBlLm9uRGF0YSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdGhpcy5jaHVua3MucHVzaCh0KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChwLnByb3RvdHlwZS5vbkVuZCA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdCA9PT0gbCAmJgogICAgICAgICAgICAgICAgKCJzdHJpbmciID09PSB0aGlzLm9wdGlvbnMudG8KICAgICAgICAgICAgICAgICAgPyAodGhpcy5yZXN1bHQgPSB0aGlzLmNodW5rcy5qb2luKCIiKSkKICAgICAgICAgICAgICAgICAgOiAodGhpcy5yZXN1bHQgPSBvLmZsYXR0ZW5DaHVua3ModGhpcy5jaHVua3MpKSksCiAgICAgICAgICAgICAgICAodGhpcy5jaHVua3MgPSBbXSksCiAgICAgICAgICAgICAgICAodGhpcy5lcnIgPSB0KSwKICAgICAgICAgICAgICAgICh0aGlzLm1zZyA9IHRoaXMuc3RybS5tc2cpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHIuRGVmbGF0ZSA9IHApLAogICAgICAgICAgICAoci5kZWZsYXRlID0gaSksCiAgICAgICAgICAgIChyLmRlZmxhdGVSYXcgPSBmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgIHJldHVybiAoKGUgPSBlIHx8IHt9KS5yYXcgPSAhMCksIGkodCwgZSk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5nemlwID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICByZXR1cm4gKChlID0gZSB8fCB7fSkuZ3ppcCA9ICEwKSwgaSh0LCBlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAiLi91dGlscy9jb21tb24iOiA0MSwKICAgICAgICAgICIuL3V0aWxzL3N0cmluZ3MiOiA0MiwKICAgICAgICAgICIuL3psaWIvZGVmbGF0ZSI6IDQ2LAogICAgICAgICAgIi4vemxpYi9tZXNzYWdlcyI6IDUxLAogICAgICAgICAgIi4vemxpYi96c3RyZWFtIjogNTMsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgNDA6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIGQgPSB0KCIuL3psaWIvaW5mbGF0ZSIpLAogICAgICAgICAgICBjID0gdCgiLi91dGlscy9jb21tb24iKSwKICAgICAgICAgICAgcCA9IHQoIi4vdXRpbHMvc3RyaW5ncyIpLAogICAgICAgICAgICBtID0gdCgiLi96bGliL2NvbnN0YW50cyIpLAogICAgICAgICAgICBpID0gdCgiLi96bGliL21lc3NhZ2VzIiksCiAgICAgICAgICAgIG4gPSB0KCIuL3psaWIvenN0cmVhbSIpLAogICAgICAgICAgICBzID0gdCgiLi96bGliL2d6aGVhZGVyIiksCiAgICAgICAgICAgIF8gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nOwogICAgICAgICAgZnVuY3Rpb24gYSh0KSB7CiAgICAgICAgICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBhKSkgcmV0dXJuIG5ldyBhKHQpOwogICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBjLmFzc2lnbigKICAgICAgICAgICAgICB7IGNodW5rU2l6ZTogMTYzODQsIHdpbmRvd0JpdHM6IDAsIHRvOiAiIiB9LAogICAgICAgICAgICAgIHQgfHwge30sCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHZhciBlID0gdGhpcy5vcHRpb25zOwogICAgICAgICAgICBlLnJhdyAmJgogICAgICAgICAgICAgIDAgPD0gZS53aW5kb3dCaXRzICYmCiAgICAgICAgICAgICAgZS53aW5kb3dCaXRzIDwgMTYgJiYKICAgICAgICAgICAgICAoKGUud2luZG93Qml0cyA9IC1lLndpbmRvd0JpdHMpLAogICAgICAgICAgICAgIDAgPT09IGUud2luZG93Qml0cyAmJiAoZS53aW5kb3dCaXRzID0gLTE1KSksCiAgICAgICAgICAgICAgISgwIDw9IGUud2luZG93Qml0cyAmJiBlLndpbmRvd0JpdHMgPCAxNikgfHwKICAgICAgICAgICAgICAgICh0ICYmIHQud2luZG93Qml0cykgfHwKICAgICAgICAgICAgICAgIChlLndpbmRvd0JpdHMgKz0gMzIpLAogICAgICAgICAgICAgIDE1IDwgZS53aW5kb3dCaXRzICYmCiAgICAgICAgICAgICAgICBlLndpbmRvd0JpdHMgPCA0OCAmJgogICAgICAgICAgICAgICAgMCA9PSAoMTUgJiBlLndpbmRvd0JpdHMpICYmCiAgICAgICAgICAgICAgICAoZS53aW5kb3dCaXRzIHw9IDE1KSwKICAgICAgICAgICAgICAodGhpcy5lcnIgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5tc2cgPSAiIiksCiAgICAgICAgICAgICAgKHRoaXMuZW5kZWQgPSAhMSksCiAgICAgICAgICAgICAgKHRoaXMuY2h1bmtzID0gW10pLAogICAgICAgICAgICAgICh0aGlzLnN0cm0gPSBuZXcgbigpKSwKICAgICAgICAgICAgICAodGhpcy5zdHJtLmF2YWlsX291dCA9IDApOwogICAgICAgICAgICB2YXIgciA9IGQuaW5mbGF0ZUluaXQyKHRoaXMuc3RybSwgZS53aW5kb3dCaXRzKTsKICAgICAgICAgICAgaWYgKHIgIT09IG0uWl9PSykgdGhyb3cgbmV3IEVycm9yKGlbcl0pOwogICAgICAgICAgICAodGhpcy5oZWFkZXIgPSBuZXcgcygpKSwgZC5pbmZsYXRlR2V0SGVhZGVyKHRoaXMuc3RybSwgdGhpcy5oZWFkZXIpOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gbyh0LCBlKSB7CiAgICAgICAgICAgIHZhciByID0gbmV3IGEoZSk7CiAgICAgICAgICAgIGlmICgoci5wdXNoKHQsICEwKSwgci5lcnIpKSB0aHJvdyByLm1zZyB8fCBpW3IuZXJyXTsKICAgICAgICAgICAgcmV0dXJuIHIucmVzdWx0OwogICAgICAgICAgfQogICAgICAgICAgKGEucHJvdG90eXBlLnB1c2ggPSBmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICB2YXIgciwKICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICBhLAogICAgICAgICAgICAgIG8sCiAgICAgICAgICAgICAgaCA9IHRoaXMuc3RybSwKICAgICAgICAgICAgICB1ID0gdGhpcy5vcHRpb25zLmNodW5rU2l6ZSwKICAgICAgICAgICAgICBsID0gdGhpcy5vcHRpb25zLmRpY3Rpb25hcnksCiAgICAgICAgICAgICAgZiA9ICExOwogICAgICAgICAgICBpZiAodGhpcy5lbmRlZCkgcmV0dXJuICExOwogICAgICAgICAgICAoaSA9IGUgPT09IH5+ZSA/IGUgOiAhMCA9PT0gZSA/IG0uWl9GSU5JU0ggOiBtLlpfTk9fRkxVU0gpLAogICAgICAgICAgICAgICJzdHJpbmciID09IHR5cGVvZiB0CiAgICAgICAgICAgICAgICA/IChoLmlucHV0ID0gcC5iaW5zdHJpbmcyYnVmKHQpKQogICAgICAgICAgICAgICAgOiAiW29iamVjdCBBcnJheUJ1ZmZlcl0iID09PSBfLmNhbGwodCkKICAgICAgICAgICAgICAgICAgPyAoaC5pbnB1dCA9IG5ldyBVaW50OEFycmF5KHQpKQogICAgICAgICAgICAgICAgICA6IChoLmlucHV0ID0gdCksCiAgICAgICAgICAgICAgKGgubmV4dF9pbiA9IDApLAogICAgICAgICAgICAgIChoLmF2YWlsX2luID0gaC5pbnB1dC5sZW5ndGgpOwogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgKDAgPT09IGguYXZhaWxfb3V0ICYmCiAgICAgICAgICAgICAgICAgICgoaC5vdXRwdXQgPSBuZXcgYy5CdWY4KHUpKSwKICAgICAgICAgICAgICAgICAgKGgubmV4dF9vdXQgPSAwKSwKICAgICAgICAgICAgICAgICAgKGguYXZhaWxfb3V0ID0gdSkpLAogICAgICAgICAgICAgICAgKHIgPSBkLmluZmxhdGUoaCwgbS5aX05PX0ZMVVNIKSkgPT09IG0uWl9ORUVEX0RJQ1QgJiYKICAgICAgICAgICAgICAgICAgbCAmJgogICAgICAgICAgICAgICAgICAoKG8gPQogICAgICAgICAgICAgICAgICAgICJzdHJpbmciID09IHR5cGVvZiBsCiAgICAgICAgICAgICAgICAgICAgICA/IHAuc3RyaW5nMmJ1ZihsKQogICAgICAgICAgICAgICAgICAgICAgOiAiW29iamVjdCBBcnJheUJ1ZmZlcl0iID09PSBfLmNhbGwobCkKICAgICAgICAgICAgICAgICAgICAgICAgPyBuZXcgVWludDhBcnJheShsKQogICAgICAgICAgICAgICAgICAgICAgICA6IGwpLAogICAgICAgICAgICAgICAgICAociA9IGQuaW5mbGF0ZVNldERpY3Rpb25hcnkodGhpcy5zdHJtLCBvKSkpLAogICAgICAgICAgICAgICAgciA9PT0gbS5aX0JVRl9FUlJPUiAmJiAhMCA9PT0gZiAmJiAoKHIgPSBtLlpfT0spLCAoZiA9ICExKSksCiAgICAgICAgICAgICAgICByICE9PSBtLlpfU1RSRUFNX0VORCAmJiByICE9PSBtLlpfT0spCiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMub25FbmQociksICEodGhpcy5lbmRlZCA9ICEwKTsKICAgICAgICAgICAgICBoLm5leHRfb3V0ICYmCiAgICAgICAgICAgICAgICAoKDAgIT09IGguYXZhaWxfb3V0ICYmCiAgICAgICAgICAgICAgICAgIHIgIT09IG0uWl9TVFJFQU1fRU5EICYmCiAgICAgICAgICAgICAgICAgICgwICE9PSBoLmF2YWlsX2luIHx8CiAgICAgICAgICAgICAgICAgICAgKGkgIT09IG0uWl9GSU5JU0ggJiYgaSAhPT0gbS5aX1NZTkNfRkxVU0gpKSkgfHwKICAgICAgICAgICAgICAgICAgKCJzdHJpbmciID09PSB0aGlzLm9wdGlvbnMudG8KICAgICAgICAgICAgICAgICAgICA/ICgobiA9IHAudXRmOGJvcmRlcihoLm91dHB1dCwgaC5uZXh0X291dCkpLAogICAgICAgICAgICAgICAgICAgICAgKHMgPSBoLm5leHRfb3V0IC0gbiksCiAgICAgICAgICAgICAgICAgICAgICAoYSA9IHAuYnVmMnN0cmluZyhoLm91dHB1dCwgbikpLAogICAgICAgICAgICAgICAgICAgICAgKGgubmV4dF9vdXQgPSBzKSwKICAgICAgICAgICAgICAgICAgICAgIChoLmF2YWlsX291dCA9IHUgLSBzKSwKICAgICAgICAgICAgICAgICAgICAgIHMgJiYgYy5hcnJheVNldChoLm91dHB1dCwgaC5vdXRwdXQsIG4sIHMsIDApLAogICAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRhdGEoYSkpCiAgICAgICAgICAgICAgICAgICAgOiB0aGlzLm9uRGF0YShjLnNocmlua0J1ZihoLm91dHB1dCwgaC5uZXh0X291dCkpKSksCiAgICAgICAgICAgICAgICAwID09PSBoLmF2YWlsX2luICYmIDAgPT09IGguYXZhaWxfb3V0ICYmIChmID0gITApOwogICAgICAgICAgICB9IHdoaWxlICgKICAgICAgICAgICAgICAoMCA8IGguYXZhaWxfaW4gfHwgMCA9PT0gaC5hdmFpbF9vdXQpICYmCiAgICAgICAgICAgICAgciAhPT0gbS5aX1NUUkVBTV9FTkQKICAgICAgICAgICAgKTsKICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICByID09PSBtLlpfU1RSRUFNX0VORCAmJiAoaSA9IG0uWl9GSU5JU0gpLAogICAgICAgICAgICAgIGkgPT09IG0uWl9GSU5JU0gKICAgICAgICAgICAgICAgID8gKChyID0gZC5pbmZsYXRlRW5kKHRoaXMuc3RybSkpLAogICAgICAgICAgICAgICAgICB0aGlzLm9uRW5kKHIpLAogICAgICAgICAgICAgICAgICAodGhpcy5lbmRlZCA9ICEwKSwKICAgICAgICAgICAgICAgICAgciA9PT0gbS5aX09LKQogICAgICAgICAgICAgICAgOiBpICE9PSBtLlpfU1lOQ19GTFVTSCB8fAogICAgICAgICAgICAgICAgICAodGhpcy5vbkVuZChtLlpfT0spLCAhKGguYXZhaWxfb3V0ID0gMCkpCiAgICAgICAgICAgICk7CiAgICAgICAgICB9KSwKICAgICAgICAgICAgKGEucHJvdG90eXBlLm9uRGF0YSA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdGhpcy5jaHVua3MucHVzaCh0KTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChhLnByb3RvdHlwZS5vbkVuZCA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdCA9PT0gbS5aX09LICYmCiAgICAgICAgICAgICAgICAoInN0cmluZyIgPT09IHRoaXMub3B0aW9ucy50bwogICAgICAgICAgICAgICAgICA/ICh0aGlzLnJlc3VsdCA9IHRoaXMuY2h1bmtzLmpvaW4oIiIpKQogICAgICAgICAgICAgICAgICA6ICh0aGlzLnJlc3VsdCA9IGMuZmxhdHRlbkNodW5rcyh0aGlzLmNodW5rcykpKSwKICAgICAgICAgICAgICAgICh0aGlzLmNodW5rcyA9IFtdKSwKICAgICAgICAgICAgICAgICh0aGlzLmVyciA9IHQpLAogICAgICAgICAgICAgICAgKHRoaXMubXNnID0gdGhpcy5zdHJtLm1zZyk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5JbmZsYXRlID0gYSksCiAgICAgICAgICAgIChyLmluZmxhdGUgPSBvKSwKICAgICAgICAgICAgKHIuaW5mbGF0ZVJhdyA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgcmV0dXJuICgoZSA9IGUgfHwge30pLnJhdyA9ICEwKSwgbyh0LCBlKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIChyLnVuZ3ppcCA9IG8pOwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgIi4vdXRpbHMvY29tbW9uIjogNDEsCiAgICAgICAgICAiLi91dGlscy9zdHJpbmdzIjogNDIsCiAgICAgICAgICAiLi96bGliL2NvbnN0YW50cyI6IDQ0LAogICAgICAgICAgIi4vemxpYi9nemhlYWRlciI6IDQ3LAogICAgICAgICAgIi4vemxpYi9pbmZsYXRlIjogNDksCiAgICAgICAgICAiLi96bGliL21lc3NhZ2VzIjogNTEsCiAgICAgICAgICAiLi96bGliL3pzdHJlYW0iOiA1MywKICAgICAgICB9LAogICAgICBdLAogICAgICA0MTogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgaSA9CiAgICAgICAgICAgICJ1bmRlZmluZWQiICE9IHR5cGVvZiBVaW50OEFycmF5ICYmCiAgICAgICAgICAgICJ1bmRlZmluZWQiICE9IHR5cGVvZiBVaW50MTZBcnJheSAmJgogICAgICAgICAgICAidW5kZWZpbmVkIiAhPSB0eXBlb2YgSW50MzJBcnJheTsKICAgICAgICAgIChyLmFzc2lnbiA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIGZvciAodmFyIGUgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpOyBlLmxlbmd0aDsgKSB7CiAgICAgICAgICAgICAgdmFyIHIgPSBlLnNoaWZ0KCk7CiAgICAgICAgICAgICAgaWYgKHIpIHsKICAgICAgICAgICAgICAgIGlmICgib2JqZWN0IiAhPSB0eXBlb2YgcikKICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihyICsgIm11c3QgYmUgbm9uLW9iamVjdCIpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByKSByLmhhc093blByb3BlcnR5KGkpICYmICh0W2ldID0gcltpXSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0OwogICAgICAgICAgfSksCiAgICAgICAgICAgIChyLnNocmlua0J1ZiA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHQubGVuZ3RoID09PSBlCiAgICAgICAgICAgICAgICA/IHQKICAgICAgICAgICAgICAgIDogdC5zdWJhcnJheQogICAgICAgICAgICAgICAgICA/IHQuc3ViYXJyYXkoMCwgZSkKICAgICAgICAgICAgICAgICAgOiAoKHQubGVuZ3RoID0gZSksIHQpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIHZhciBuID0gewogICAgICAgICAgICAgIGFycmF5U2V0OiBmdW5jdGlvbiAodCwgZSwgciwgaSwgbikgewogICAgICAgICAgICAgICAgaWYgKGUuc3ViYXJyYXkgJiYgdC5zdWJhcnJheSkgdC5zZXQoZS5zdWJhcnJheShyLCByICsgaSksIG4pOwogICAgICAgICAgICAgICAgZWxzZSBmb3IgKHZhciBzID0gMDsgcyA8IGk7IHMrKykgdFtuICsgc10gPSBlW3IgKyBzXTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGZsYXR0ZW5DaHVua3M6IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICB2YXIgZSwgciwgaSwgbiwgcywgYTsKICAgICAgICAgICAgICAgIGZvciAoZSA9IGkgPSAwLCByID0gdC5sZW5ndGg7IGUgPCByOyBlKyspIGkgKz0gdFtlXS5sZW5ndGg7CiAgICAgICAgICAgICAgICBmb3IgKGEgPSBuZXcgVWludDhBcnJheShpKSwgZSA9IG4gPSAwLCByID0gdC5sZW5ndGg7IGUgPCByOyBlKyspCiAgICAgICAgICAgICAgICAgIChzID0gdFtlXSksIGEuc2V0KHMsIG4pLCAobiArPSBzLmxlbmd0aCk7CiAgICAgICAgICAgICAgICByZXR1cm4gYTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9LAogICAgICAgICAgICBzID0gewogICAgICAgICAgICAgIGFycmF5U2V0OiBmdW5jdGlvbiAodCwgZSwgciwgaSwgbikgewogICAgICAgICAgICAgICAgZm9yICh2YXIgcyA9IDA7IHMgPCBpOyBzKyspIHRbbiArIHNdID0gZVtyICsgc107CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBmbGF0dGVuQ2h1bmtzOiBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgcmV0dXJuIFtdLmNvbmNhdC5hcHBseShbXSwgdCk7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfTsKICAgICAgICAgIChyLnNldFR5cGVkID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgdAogICAgICAgICAgICAgID8gKChyLkJ1ZjggPSBVaW50OEFycmF5KSwKICAgICAgICAgICAgICAgIChyLkJ1ZjE2ID0gVWludDE2QXJyYXkpLAogICAgICAgICAgICAgICAgKHIuQnVmMzIgPSBJbnQzMkFycmF5KSwKICAgICAgICAgICAgICAgIHIuYXNzaWduKHIsIG4pKQogICAgICAgICAgICAgIDogKChyLkJ1ZjggPSBBcnJheSksCiAgICAgICAgICAgICAgICAoci5CdWYxNiA9IEFycmF5KSwKICAgICAgICAgICAgICAgIChyLkJ1ZjMyID0gQXJyYXkpLAogICAgICAgICAgICAgICAgci5hc3NpZ24ociwgcykpOwogICAgICAgICAgfSksCiAgICAgICAgICAgIHIuc2V0VHlwZWQoaSk7CiAgICAgICAgfSwKICAgICAgICB7fSwKICAgICAgXSwKICAgICAgNDI6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIGggPSB0KCIuL2NvbW1vbiIpLAogICAgICAgICAgICBuID0gITAsCiAgICAgICAgICAgIHMgPSAhMDsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgWzBdKTsKICAgICAgICAgIH0gY2F0Y2ggKHQpIHsKICAgICAgICAgICAgbiA9ICExOwogICAgICAgICAgfQogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgU3RyaW5nLmZyb21DaGFyQ29kZS5hcHBseShudWxsLCBuZXcgVWludDhBcnJheSgxKSk7CiAgICAgICAgICB9IGNhdGNoICh0KSB7CiAgICAgICAgICAgIHMgPSAhMTsKICAgICAgICAgIH0KICAgICAgICAgIGZvciAodmFyIHUgPSBuZXcgaC5CdWY4KDI1NiksIGkgPSAwOyBpIDwgMjU2OyBpKyspCiAgICAgICAgICAgIHVbaV0gPQogICAgICAgICAgICAgIDI1MiA8PSBpCiAgICAgICAgICAgICAgICA/IDYKICAgICAgICAgICAgICAgIDogMjQ4IDw9IGkKICAgICAgICAgICAgICAgICAgPyA1CiAgICAgICAgICAgICAgICAgIDogMjQwIDw9IGkKICAgICAgICAgICAgICAgICAgICA/IDQKICAgICAgICAgICAgICAgICAgICA6IDIyNCA8PSBpCiAgICAgICAgICAgICAgICAgICAgICA/IDMKICAgICAgICAgICAgICAgICAgICAgIDogMTkyIDw9IGkKICAgICAgICAgICAgICAgICAgICAgICAgPyAyCiAgICAgICAgICAgICAgICAgICAgICAgIDogMTsKICAgICAgICAgIGZ1bmN0aW9uIGwodCwgZSkgewogICAgICAgICAgICBpZiAoZSA8IDY1NTM3ICYmICgodC5zdWJhcnJheSAmJiBzKSB8fCAoIXQuc3ViYXJyYXkgJiYgbikpKQogICAgICAgICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlLmFwcGx5KG51bGwsIGguc2hyaW5rQnVmKHQsIGUpKTsKICAgICAgICAgICAgZm9yICh2YXIgciA9ICIiLCBpID0gMDsgaSA8IGU7IGkrKykgciArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHRbaV0pOwogICAgICAgICAgICByZXR1cm4gcjsKICAgICAgICAgIH0KICAgICAgICAgICh1WzI1NF0gPSB1WzI1NF0gPSAxKSwKICAgICAgICAgICAgKHIuc3RyaW5nMmJ1ZiA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIGUsCiAgICAgICAgICAgICAgICByLAogICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgICAgYSA9IHQubGVuZ3RoLAogICAgICAgICAgICAgICAgbyA9IDA7CiAgICAgICAgICAgICAgZm9yIChuID0gMDsgbiA8IGE7IG4rKykKICAgICAgICAgICAgICAgIDU1Mjk2ID09ICg2NDUxMiAmIChyID0gdC5jaGFyQ29kZUF0KG4pKSkgJiYKICAgICAgICAgICAgICAgICAgbiArIDEgPCBhICYmCiAgICAgICAgICAgICAgICAgIDU2MzIwID09ICg2NDUxMiAmIChpID0gdC5jaGFyQ29kZUF0KG4gKyAxKSkpICYmCiAgICAgICAgICAgICAgICAgICgociA9IDY1NTM2ICsgKChyIC0gNTUyOTYpIDw8IDEwKSArIChpIC0gNTYzMjApKSwgbisrKSwKICAgICAgICAgICAgICAgICAgKG8gKz0gciA8IDEyOCA/IDEgOiByIDwgMjA0OCA/IDIgOiByIDwgNjU1MzYgPyAzIDogNCk7CiAgICAgICAgICAgICAgZm9yIChlID0gbmV3IGguQnVmOChvKSwgbiA9IHMgPSAwOyBzIDwgbzsgbisrKQogICAgICAgICAgICAgICAgNTUyOTYgPT0gKDY0NTEyICYgKHIgPSB0LmNoYXJDb2RlQXQobikpKSAmJgogICAgICAgICAgICAgICAgICBuICsgMSA8IGEgJiYKICAgICAgICAgICAgICAgICAgNTYzMjAgPT0gKDY0NTEyICYgKGkgPSB0LmNoYXJDb2RlQXQobiArIDEpKSkgJiYKICAgICAgICAgICAgICAgICAgKChyID0gNjU1MzYgKyAoKHIgLSA1NTI5NikgPDwgMTApICsgKGkgLSA1NjMyMCkpLCBuKyspLAogICAgICAgICAgICAgICAgICByIDwgMTI4CiAgICAgICAgICAgICAgICAgICAgPyAoZVtzKytdID0gcikKICAgICAgICAgICAgICAgICAgICA6IChyIDwgMjA0OAogICAgICAgICAgICAgICAgICAgICAgICA/IChlW3MrK10gPSAxOTIgfCAociA+Pj4gNikpCiAgICAgICAgICAgICAgICAgICAgICAgIDogKHIgPCA2NTUzNgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAoZVtzKytdID0gMjI0IHwgKHIgPj4+IDEyKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogKChlW3MrK10gPSAyNDAgfCAociA+Pj4gMTgpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGVbcysrXSA9IDEyOCB8ICgociA+Pj4gMTIpICYgNjMpKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKGVbcysrXSA9IDEyOCB8ICgociA+Pj4gNikgJiA2MykpKSwKICAgICAgICAgICAgICAgICAgICAgIChlW3MrK10gPSAxMjggfCAoNjMgJiByKSkpOwogICAgICAgICAgICAgIHJldHVybiBlOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHIuYnVmMmJpbnN0cmluZyA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgcmV0dXJuIGwodCwgdC5sZW5ndGgpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHIuYmluc3RyaW5nMmJ1ZiA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgIHZhciBlID0gbmV3IGguQnVmOCh0Lmxlbmd0aCksIHIgPSAwLCBpID0gZS5sZW5ndGg7CiAgICAgICAgICAgICAgICByIDwgaTsKICAgICAgICAgICAgICAgIHIrKwogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGVbcl0gPSB0LmNoYXJDb2RlQXQocik7CiAgICAgICAgICAgICAgcmV0dXJuIGU7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5idWYyc3RyaW5nID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICB2YXIgciwKICAgICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgICBuLAogICAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICAgIGEgPSBlIHx8IHQubGVuZ3RoLAogICAgICAgICAgICAgICAgbyA9IG5ldyBBcnJheSgyICogYSk7CiAgICAgICAgICAgICAgZm9yIChyID0gaSA9IDA7IHIgPCBhOyApCiAgICAgICAgICAgICAgICBpZiAoKG4gPSB0W3IrK10pIDwgMTI4KSBvW2krK10gPSBuOwogICAgICAgICAgICAgICAgZWxzZSBpZiAoNCA8IChzID0gdVtuXSkpIChvW2krK10gPSA2NTUzMyksIChyICs9IHMgLSAxKTsKICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICBmb3IgKG4gJj0gMiA9PT0gcyA/IDMxIDogMyA9PT0gcyA/IDE1IDogNzsgMSA8IHMgJiYgciA8IGE7ICkKICAgICAgICAgICAgICAgICAgICAobiA9IChuIDw8IDYpIHwgKDYzICYgdFtyKytdKSksIHMtLTsKICAgICAgICAgICAgICAgICAgMSA8IHMKICAgICAgICAgICAgICAgICAgICA/IChvW2krK10gPSA2NTUzMykKICAgICAgICAgICAgICAgICAgICA6IG4gPCA2NTUzNgogICAgICAgICAgICAgICAgICAgICAgPyAob1tpKytdID0gbikKICAgICAgICAgICAgICAgICAgICAgIDogKChuIC09IDY1NTM2KSwKICAgICAgICAgICAgICAgICAgICAgICAgKG9baSsrXSA9IDU1Mjk2IHwgKChuID4+IDEwKSAmIDEwMjMpKSwKICAgICAgICAgICAgICAgICAgICAgICAgKG9baSsrXSA9IDU2MzIwIHwgKDEwMjMgJiBuKSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBsKG8sIGkpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHIudXRmOGJvcmRlciA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgdmFyIHI7CiAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgIChlID0gZSB8fCB0Lmxlbmd0aCkgPiB0Lmxlbmd0aCAmJiAoZSA9IHQubGVuZ3RoKSwgciA9IGUgLSAxOwogICAgICAgICAgICAgICAgMCA8PSByICYmIDEyOCA9PSAoMTkyICYgdFtyXSk7CgogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIHItLTsKICAgICAgICAgICAgICByZXR1cm4gciA8IDAgPyBlIDogMCA9PT0gciA/IGUgOiByICsgdVt0W3JdXSA+IGUgPyByIDogZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICB7ICIuL2NvbW1vbiI6IDQxIH0sCiAgICAgIF0sCiAgICAgIDQzOiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0LCBlLCByLCBpKSB7CiAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgdmFyIG4gPSAoNjU1MzUgJiB0KSB8IDAsIHMgPSAoKHQgPj4+IDE2KSAmIDY1NTM1KSB8IDAsIGEgPSAwOwogICAgICAgICAgICAgIDAgIT09IHI7CgogICAgICAgICAgICApIHsKICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgciAtPSBhID0gMmUzIDwgciA/IDJlMyA6IHI7CiAgICAgICAgICAgICAgICAocyA9IChzICsgKG4gPSAobiArIGVbaSsrXSkgfCAwKSkgfCAwKSwgLS1hOwoKICAgICAgICAgICAgICApOwogICAgICAgICAgICAgIChuICU9IDY1NTIxKSwgKHMgJT0gNjU1MjEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBuIHwgKHMgPDwgMTYpIHwgMDsKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB7fSwKICAgICAgXSwKICAgICAgNDQ6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgZS5leHBvcnRzID0gewogICAgICAgICAgICBaX05PX0ZMVVNIOiAwLAogICAgICAgICAgICBaX1BBUlRJQUxfRkxVU0g6IDEsCiAgICAgICAgICAgIFpfU1lOQ19GTFVTSDogMiwKICAgICAgICAgICAgWl9GVUxMX0ZMVVNIOiAzLAogICAgICAgICAgICBaX0ZJTklTSDogNCwKICAgICAgICAgICAgWl9CTE9DSzogNSwKICAgICAgICAgICAgWl9UUkVFUzogNiwKICAgICAgICAgICAgWl9PSzogMCwKICAgICAgICAgICAgWl9TVFJFQU1fRU5EOiAxLAogICAgICAgICAgICBaX05FRURfRElDVDogMiwKICAgICAgICAgICAgWl9FUlJOTzogLTEsCiAgICAgICAgICAgIFpfU1RSRUFNX0VSUk9SOiAtMiwKICAgICAgICAgICAgWl9EQVRBX0VSUk9SOiAtMywKICAgICAgICAgICAgWl9CVUZfRVJST1I6IC01LAogICAgICAgICAgICBaX05PX0NPTVBSRVNTSU9OOiAwLAogICAgICAgICAgICBaX0JFU1RfU1BFRUQ6IDEsCiAgICAgICAgICAgIFpfQkVTVF9DT01QUkVTU0lPTjogOSwKICAgICAgICAgICAgWl9ERUZBVUxUX0NPTVBSRVNTSU9OOiAtMSwKICAgICAgICAgICAgWl9GSUxURVJFRDogMSwKICAgICAgICAgICAgWl9IVUZGTUFOX09OTFk6IDIsCiAgICAgICAgICAgIFpfUkxFOiAzLAogICAgICAgICAgICBaX0ZJWEVEOiA0LAogICAgICAgICAgICBaX0RFRkFVTFRfU1RSQVRFR1k6IDAsCiAgICAgICAgICAgIFpfQklOQVJZOiAwLAogICAgICAgICAgICBaX1RFWFQ6IDEsCiAgICAgICAgICAgIFpfVU5LTk9XTjogMiwKICAgICAgICAgICAgWl9ERUZMQVRFRDogOCwKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB7fSwKICAgICAgXSwKICAgICAgNDU6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIG8gPSAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBmb3IgKHZhciB0LCBlID0gW10sIHIgPSAwOyByIDwgMjU2OyByKyspIHsKICAgICAgICAgICAgICB0ID0gcjsKICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykKICAgICAgICAgICAgICAgIHQgPSAxICYgdCA/IDM5ODgyOTIzODQgXiAodCA+Pj4gMSkgOiB0ID4+PiAxOwogICAgICAgICAgICAgIGVbcl0gPSB0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBlOwogICAgICAgICAgfSkoKTsKICAgICAgICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0LCBlLCByLCBpKSB7CiAgICAgICAgICAgIHZhciBuID0gbywKICAgICAgICAgICAgICBzID0gaSArIHI7CiAgICAgICAgICAgIHQgXj0gLTE7CiAgICAgICAgICAgIGZvciAodmFyIGEgPSBpOyBhIDwgczsgYSsrKSB0ID0gKHQgPj4+IDgpIF4gblsyNTUgJiAodCBeIGVbYV0pXTsKICAgICAgICAgICAgcmV0dXJuIC0xIF4gdDsKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB7fSwKICAgICAgXSwKICAgICAgNDY6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIGgsCiAgICAgICAgICAgIGQgPSB0KCIuLi91dGlscy9jb21tb24iKSwKICAgICAgICAgICAgdSA9IHQoIi4vdHJlZXMiKSwKICAgICAgICAgICAgYyA9IHQoIi4vYWRsZXIzMiIpLAogICAgICAgICAgICBwID0gdCgiLi9jcmMzMiIpLAogICAgICAgICAgICBpID0gdCgiLi9tZXNzYWdlcyIpLAogICAgICAgICAgICBsID0gMCwKICAgICAgICAgICAgZiA9IDQsCiAgICAgICAgICAgIG0gPSAwLAogICAgICAgICAgICBfID0gLTIsCiAgICAgICAgICAgIGcgPSAtMSwKICAgICAgICAgICAgYiA9IDQsCiAgICAgICAgICAgIG4gPSAyLAogICAgICAgICAgICB2ID0gOCwKICAgICAgICAgICAgeSA9IDksCiAgICAgICAgICAgIHMgPSAyODYsCiAgICAgICAgICAgIGEgPSAzMCwKICAgICAgICAgICAgbyA9IDE5LAogICAgICAgICAgICB3ID0gMiAqIHMgKyAxLAogICAgICAgICAgICBrID0gMTUsCiAgICAgICAgICAgIHggPSAzLAogICAgICAgICAgICBTID0gMjU4LAogICAgICAgICAgICB6ID0gUyArIHggKyAxLAogICAgICAgICAgICBDID0gNDIsCiAgICAgICAgICAgIEUgPSAxMTMsCiAgICAgICAgICAgIEEgPSAxLAogICAgICAgICAgICBJID0gMiwKICAgICAgICAgICAgTyA9IDMsCiAgICAgICAgICAgIEIgPSA0OwogICAgICAgICAgZnVuY3Rpb24gUih0LCBlKSB7CiAgICAgICAgICAgIHJldHVybiAodC5tc2cgPSBpW2VdKSwgZTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIFQodCkgewogICAgICAgICAgICByZXR1cm4gKHQgPDwgMSkgLSAoNCA8IHQgPyA5IDogMCk7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBEKHQpIHsKICAgICAgICAgICAgZm9yICh2YXIgZSA9IHQubGVuZ3RoOyAwIDw9IC0tZTsgKSB0W2VdID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIEYodCkgewogICAgICAgICAgICB2YXIgZSA9IHQuc3RhdGUsCiAgICAgICAgICAgICAgciA9IGUucGVuZGluZzsKICAgICAgICAgICAgciA+IHQuYXZhaWxfb3V0ICYmIChyID0gdC5hdmFpbF9vdXQpLAogICAgICAgICAgICAgIDAgIT09IHIgJiYKICAgICAgICAgICAgICAgIChkLmFycmF5U2V0KAogICAgICAgICAgICAgICAgICB0Lm91dHB1dCwKICAgICAgICAgICAgICAgICAgZS5wZW5kaW5nX2J1ZiwKICAgICAgICAgICAgICAgICAgZS5wZW5kaW5nX291dCwKICAgICAgICAgICAgICAgICAgciwKICAgICAgICAgICAgICAgICAgdC5uZXh0X291dCwKICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAodC5uZXh0X291dCArPSByKSwKICAgICAgICAgICAgICAgIChlLnBlbmRpbmdfb3V0ICs9IHIpLAogICAgICAgICAgICAgICAgKHQudG90YWxfb3V0ICs9IHIpLAogICAgICAgICAgICAgICAgKHQuYXZhaWxfb3V0IC09IHIpLAogICAgICAgICAgICAgICAgKGUucGVuZGluZyAtPSByKSwKICAgICAgICAgICAgICAgIDAgPT09IGUucGVuZGluZyAmJiAoZS5wZW5kaW5nX291dCA9IDApKTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIE4odCwgZSkgewogICAgICAgICAgICB1Ll90cl9mbHVzaF9ibG9jaygKICAgICAgICAgICAgICB0LAogICAgICAgICAgICAgIDAgPD0gdC5ibG9ja19zdGFydCA/IHQuYmxvY2tfc3RhcnQgOiAtMSwKICAgICAgICAgICAgICB0LnN0cnN0YXJ0IC0gdC5ibG9ja19zdGFydCwKICAgICAgICAgICAgICBlLAogICAgICAgICAgICApLAogICAgICAgICAgICAgICh0LmJsb2NrX3N0YXJ0ID0gdC5zdHJzdGFydCksCiAgICAgICAgICAgICAgRih0LnN0cm0pOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gVSh0LCBlKSB7CiAgICAgICAgICAgIHQucGVuZGluZ19idWZbdC5wZW5kaW5nKytdID0gZTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIFAodCwgZSkgewogICAgICAgICAgICAodC5wZW5kaW5nX2J1Zlt0LnBlbmRpbmcrK10gPSAoZSA+Pj4gOCkgJiAyNTUpLAogICAgICAgICAgICAgICh0LnBlbmRpbmdfYnVmW3QucGVuZGluZysrXSA9IDI1NSAmIGUpOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gTCh0LCBlKSB7CiAgICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgbiA9IHQubWF4X2NoYWluX2xlbmd0aCwKICAgICAgICAgICAgICBzID0gdC5zdHJzdGFydCwKICAgICAgICAgICAgICBhID0gdC5wcmV2X2xlbmd0aCwKICAgICAgICAgICAgICBvID0gdC5uaWNlX21hdGNoLAogICAgICAgICAgICAgIGggPSB0LnN0cnN0YXJ0ID4gdC53X3NpemUgLSB6ID8gdC5zdHJzdGFydCAtICh0Lndfc2l6ZSAtIHopIDogMCwKICAgICAgICAgICAgICB1ID0gdC53aW5kb3csCiAgICAgICAgICAgICAgbCA9IHQud19tYXNrLAogICAgICAgICAgICAgIGYgPSB0LnByZXYsCiAgICAgICAgICAgICAgZCA9IHQuc3Ryc3RhcnQgKyBTLAogICAgICAgICAgICAgIGMgPSB1W3MgKyBhIC0gMV0sCiAgICAgICAgICAgICAgcCA9IHVbcyArIGFdOwogICAgICAgICAgICB0LnByZXZfbGVuZ3RoID49IHQuZ29vZF9tYXRjaCAmJiAobiA+Pj0gMiksCiAgICAgICAgICAgICAgbyA+IHQubG9va2FoZWFkICYmIChvID0gdC5sb29rYWhlYWQpOwogICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgdVsociA9IGUpICsgYV0gPT09IHAgJiYKICAgICAgICAgICAgICAgIHVbciArIGEgLSAxXSA9PT0gYyAmJgogICAgICAgICAgICAgICAgdVtyXSA9PT0gdVtzXSAmJgogICAgICAgICAgICAgICAgdVsrK3JdID09PSB1W3MgKyAxXQogICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgKHMgKz0gMiksIHIrKzsKICAgICAgICAgICAgICAgIGRvIHt9IHdoaWxlICgKICAgICAgICAgICAgICAgICAgdVsrK3NdID09PSB1Wysrcl0gJiYKICAgICAgICAgICAgICAgICAgdVsrK3NdID09PSB1Wysrcl0gJiYKICAgICAgICAgICAgICAgICAgdVsrK3NdID09PSB1Wysrcl0gJiYKICAgICAgICAgICAgICAgICAgdVsrK3NdID09PSB1Wysrcl0gJiYKICAgICAgICAgICAgICAgICAgdVsrK3NdID09PSB1Wysrcl0gJiYKICAgICAgICAgICAgICAgICAgdVsrK3NdID09PSB1Wysrcl0gJiYKICAgICAgICAgICAgICAgICAgdVsrK3NdID09PSB1Wysrcl0gJiYKICAgICAgICAgICAgICAgICAgdVsrK3NdID09PSB1Wysrcl0gJiYKICAgICAgICAgICAgICAgICAgcyA8IGQKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBpZiAoKChpID0gUyAtIChkIC0gcykpLCAocyA9IGQgLSBTKSwgYSA8IGkpKSB7CiAgICAgICAgICAgICAgICAgIGlmICgoKHQubWF0Y2hfc3RhcnQgPSBlKSwgbyA8PSAoYSA9IGkpKSkgYnJlYWs7CiAgICAgICAgICAgICAgICAgIChjID0gdVtzICsgYSAtIDFdKSwgKHAgPSB1W3MgKyBhXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IHdoaWxlICgoZSA9IGZbZSAmIGxdKSA+IGggJiYgMCAhPSAtLW4pOwogICAgICAgICAgICByZXR1cm4gYSA8PSB0Lmxvb2thaGVhZCA/IGEgOiB0Lmxvb2thaGVhZDsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIGoodCkgewogICAgICAgICAgICB2YXIgZSwKICAgICAgICAgICAgICByLAogICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgIGEsCiAgICAgICAgICAgICAgbywKICAgICAgICAgICAgICBoLAogICAgICAgICAgICAgIHUsCiAgICAgICAgICAgICAgbCwKICAgICAgICAgICAgICBmID0gdC53X3NpemU7CiAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAoKG4gPSB0LndpbmRvd19zaXplIC0gdC5sb29rYWhlYWQgLSB0LnN0cnN0YXJ0KSwKICAgICAgICAgICAgICAgIHQuc3Ryc3RhcnQgPj0gZiArIChmIC0geikpCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgICBkLmFycmF5U2V0KHQud2luZG93LCB0LndpbmRvdywgZiwgZiwgMCksCiAgICAgICAgICAgICAgICAgICAgdC5tYXRjaF9zdGFydCAtPSBmLAogICAgICAgICAgICAgICAgICAgIHQuc3Ryc3RhcnQgLT0gZiwKICAgICAgICAgICAgICAgICAgICB0LmJsb2NrX3N0YXJ0IC09IGYsCiAgICAgICAgICAgICAgICAgICAgZSA9IHIgPSB0Lmhhc2hfc2l6ZTsKICAgICAgICAgICAgICAgICAgKGkgPSB0LmhlYWRbLS1lXSksICh0LmhlYWRbZV0gPSBmIDw9IGkgPyBpIC0gZiA6IDApLCAtLXI7CgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgIGUgPSByID0gZjsKICAgICAgICAgICAgICAgICAgKGkgPSB0LnByZXZbLS1lXSksICh0LnByZXZbZV0gPSBmIDw9IGkgPyBpIC0gZiA6IDApLCAtLXI7CgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIG4gKz0gZjsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKDAgPT09IHQuc3RybS5hdmFpbF9pbikgYnJlYWs7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgKChhID0gdC5zdHJtKSwKICAgICAgICAgICAgICAgIChvID0gdC53aW5kb3cpLAogICAgICAgICAgICAgICAgKGggPSB0LnN0cnN0YXJ0ICsgdC5sb29rYWhlYWQpLAogICAgICAgICAgICAgICAgKHUgPSBuKSwKICAgICAgICAgICAgICAgIChsID0gdm9pZCAwKSwKICAgICAgICAgICAgICAgIChsID0gYS5hdmFpbF9pbiksCiAgICAgICAgICAgICAgICB1IDwgbCAmJiAobCA9IHUpLAogICAgICAgICAgICAgICAgKHIgPQogICAgICAgICAgICAgICAgICAwID09PSBsCiAgICAgICAgICAgICAgICAgICAgPyAwCiAgICAgICAgICAgICAgICAgICAgOiAoKGEuYXZhaWxfaW4gLT0gbCksCiAgICAgICAgICAgICAgICAgICAgICBkLmFycmF5U2V0KG8sIGEuaW5wdXQsIGEubmV4dF9pbiwgbCwgaCksCiAgICAgICAgICAgICAgICAgICAgICAxID09PSBhLnN0YXRlLndyYXAKICAgICAgICAgICAgICAgICAgICAgICAgPyAoYS5hZGxlciA9IGMoYS5hZGxlciwgbywgbCwgaCkpCiAgICAgICAgICAgICAgICAgICAgICAgIDogMiA9PT0gYS5zdGF0ZS53cmFwICYmIChhLmFkbGVyID0gcChhLmFkbGVyLCBvLCBsLCBoKSksCiAgICAgICAgICAgICAgICAgICAgICAoYS5uZXh0X2luICs9IGwpLAogICAgICAgICAgICAgICAgICAgICAgKGEudG90YWxfaW4gKz0gbCksCiAgICAgICAgICAgICAgICAgICAgICBsKSksCiAgICAgICAgICAgICAgICAodC5sb29rYWhlYWQgKz0gciksCiAgICAgICAgICAgICAgICB0Lmxvb2thaGVhZCArIHQuaW5zZXJ0ID49IHgpCiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgICAgcyA9IHQuc3Ryc3RhcnQgLSB0Lmluc2VydCwKICAgICAgICAgICAgICAgICAgICB0Lmluc19oID0gdC53aW5kb3dbc10sCiAgICAgICAgICAgICAgICAgICAgdC5pbnNfaCA9CiAgICAgICAgICAgICAgICAgICAgICAoKHQuaW5zX2ggPDwgdC5oYXNoX3NoaWZ0KSBeIHQud2luZG93W3MgKyAxXSkgJgogICAgICAgICAgICAgICAgICAgICAgdC5oYXNoX21hc2s7CiAgICAgICAgICAgICAgICAgIHQuaW5zZXJ0ICYmCiAgICAgICAgICAgICAgICAgICgodC5pbnNfaCA9CiAgICAgICAgICAgICAgICAgICAgKCh0Lmluc19oIDw8IHQuaGFzaF9zaGlmdCkgXiB0LndpbmRvd1tzICsgeCAtIDFdKSAmCiAgICAgICAgICAgICAgICAgICAgdC5oYXNoX21hc2spLAogICAgICAgICAgICAgICAgICAodC5wcmV2W3MgJiB0LndfbWFza10gPSB0LmhlYWRbdC5pbnNfaF0pLAogICAgICAgICAgICAgICAgICAodC5oZWFkW3QuaW5zX2hdID0gcyksCiAgICAgICAgICAgICAgICAgIHMrKywKICAgICAgICAgICAgICAgICAgdC5pbnNlcnQtLSwKICAgICAgICAgICAgICAgICAgISh0Lmxvb2thaGVhZCArIHQuaW5zZXJ0IDwgeCkpOwoKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0gd2hpbGUgKHQubG9va2FoZWFkIDwgeiAmJiAwICE9PSB0LnN0cm0uYXZhaWxfaW4pOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gWih0LCBlKSB7CiAgICAgICAgICAgIGZvciAodmFyIHIsIGk7IDsgKSB7CiAgICAgICAgICAgICAgaWYgKHQubG9va2FoZWFkIDwgeikgewogICAgICAgICAgICAgICAgaWYgKChqKHQpLCB0Lmxvb2thaGVhZCA8IHogJiYgZSA9PT0gbCkpIHJldHVybiBBOwogICAgICAgICAgICAgICAgaWYgKDAgPT09IHQubG9va2FoZWFkKSBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgKChyID0gMCksCiAgICAgICAgICAgICAgICB0Lmxvb2thaGVhZCA+PSB4ICYmCiAgICAgICAgICAgICAgICAgICgodC5pbnNfaCA9CiAgICAgICAgICAgICAgICAgICAgKCh0Lmluc19oIDw8IHQuaGFzaF9zaGlmdCkgXiB0LndpbmRvd1t0LnN0cnN0YXJ0ICsgeCAtIDFdKSAmCiAgICAgICAgICAgICAgICAgICAgdC5oYXNoX21hc2spLAogICAgICAgICAgICAgICAgICAociA9IHQucHJldlt0LnN0cnN0YXJ0ICYgdC53X21hc2tdID0gdC5oZWFkW3QuaW5zX2hdKSwKICAgICAgICAgICAgICAgICAgKHQuaGVhZFt0Lmluc19oXSA9IHQuc3Ryc3RhcnQpKSwKICAgICAgICAgICAgICAgIDAgIT09IHIgJiYKICAgICAgICAgICAgICAgICAgdC5zdHJzdGFydCAtIHIgPD0gdC53X3NpemUgLSB6ICYmCiAgICAgICAgICAgICAgICAgICh0Lm1hdGNoX2xlbmd0aCA9IEwodCwgcikpLAogICAgICAgICAgICAgICAgdC5tYXRjaF9sZW5ndGggPj0geCkKICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICgoaSA9IHUuX3RyX3RhbGx5KAogICAgICAgICAgICAgICAgICAgIHQsCiAgICAgICAgICAgICAgICAgICAgdC5zdHJzdGFydCAtIHQubWF0Y2hfc3RhcnQsCiAgICAgICAgICAgICAgICAgICAgdC5tYXRjaF9sZW5ndGggLSB4LAogICAgICAgICAgICAgICAgICApKSwKICAgICAgICAgICAgICAgICAgKHQubG9va2FoZWFkIC09IHQubWF0Y2hfbGVuZ3RoKSwKICAgICAgICAgICAgICAgICAgdC5tYXRjaF9sZW5ndGggPD0gdC5tYXhfbGF6eV9tYXRjaCAmJiB0Lmxvb2thaGVhZCA+PSB4KQogICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgICAgdC5tYXRjaF9sZW5ndGgtLTsKICAgICAgICAgICAgICAgICAgICB0LnN0cnN0YXJ0KyssCiAgICAgICAgICAgICAgICAgICAgICAodC5pbnNfaCA9CiAgICAgICAgICAgICAgICAgICAgICAgICgodC5pbnNfaCA8PCB0Lmhhc2hfc2hpZnQpIF4KICAgICAgICAgICAgICAgICAgICAgICAgICB0LndpbmRvd1t0LnN0cnN0YXJ0ICsgeCAtIDFdKSAmCiAgICAgICAgICAgICAgICAgICAgICAgIHQuaGFzaF9tYXNrKSwKICAgICAgICAgICAgICAgICAgICAgIChyID0gdC5wcmV2W3Quc3Ryc3RhcnQgJiB0LndfbWFza10gPSB0LmhlYWRbdC5pbnNfaF0pLAogICAgICAgICAgICAgICAgICAgICAgKHQuaGVhZFt0Lmluc19oXSA9IHQuc3Ryc3RhcnQpLAogICAgICAgICAgICAgICAgICAgICAgMCAhPSAtLXQubWF0Y2hfbGVuZ3RoOwoKICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgdC5zdHJzdGFydCsrOwogICAgICAgICAgICAgICAgfSBlbHNlCiAgICAgICAgICAgICAgICAgICh0LnN0cnN0YXJ0ICs9IHQubWF0Y2hfbGVuZ3RoKSwKICAgICAgICAgICAgICAgICAgICAodC5tYXRjaF9sZW5ndGggPSAwKSwKICAgICAgICAgICAgICAgICAgICAodC5pbnNfaCA9IHQud2luZG93W3Quc3Ryc3RhcnRdKSwKICAgICAgICAgICAgICAgICAgICAodC5pbnNfaCA9CiAgICAgICAgICAgICAgICAgICAgICAoKHQuaW5zX2ggPDwgdC5oYXNoX3NoaWZ0KSBeIHQud2luZG93W3Quc3Ryc3RhcnQgKyAxXSkgJgogICAgICAgICAgICAgICAgICAgICAgdC5oYXNoX21hc2spOwogICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgIChpID0gdS5fdHJfdGFsbHkodCwgMCwgdC53aW5kb3dbdC5zdHJzdGFydF0pKSwKICAgICAgICAgICAgICAgICAgdC5sb29rYWhlYWQtLSwKICAgICAgICAgICAgICAgICAgdC5zdHJzdGFydCsrOwogICAgICAgICAgICAgIGlmIChpICYmIChOKHQsICExKSwgMCA9PT0gdC5zdHJtLmF2YWlsX291dCkpIHJldHVybiBBOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgKHQuaW5zZXJ0ID0gdC5zdHJzdGFydCA8IHggLSAxID8gdC5zdHJzdGFydCA6IHggLSAxKSwKICAgICAgICAgICAgICBlID09PSBmCiAgICAgICAgICAgICAgICA/IChOKHQsICEwKSwgMCA9PT0gdC5zdHJtLmF2YWlsX291dCA/IE8gOiBCKQogICAgICAgICAgICAgICAgOiB0Lmxhc3RfbGl0ICYmIChOKHQsICExKSwgMCA9PT0gdC5zdHJtLmF2YWlsX291dCkKICAgICAgICAgICAgICAgICAgPyBBCiAgICAgICAgICAgICAgICAgIDogSQogICAgICAgICAgICApOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gVyh0LCBlKSB7CiAgICAgICAgICAgIGZvciAodmFyIHIsIGksIG47IDsgKSB7CiAgICAgICAgICAgICAgaWYgKHQubG9va2FoZWFkIDwgeikgewogICAgICAgICAgICAgICAgaWYgKChqKHQpLCB0Lmxvb2thaGVhZCA8IHogJiYgZSA9PT0gbCkpIHJldHVybiBBOwogICAgICAgICAgICAgICAgaWYgKDAgPT09IHQubG9va2FoZWFkKSBicmVhazsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgKChyID0gMCksCiAgICAgICAgICAgICAgICB0Lmxvb2thaGVhZCA+PSB4ICYmCiAgICAgICAgICAgICAgICAgICgodC5pbnNfaCA9CiAgICAgICAgICAgICAgICAgICAgKCh0Lmluc19oIDw8IHQuaGFzaF9zaGlmdCkgXiB0LndpbmRvd1t0LnN0cnN0YXJ0ICsgeCAtIDFdKSAmCiAgICAgICAgICAgICAgICAgICAgdC5oYXNoX21hc2spLAogICAgICAgICAgICAgICAgICAociA9IHQucHJldlt0LnN0cnN0YXJ0ICYgdC53X21hc2tdID0gdC5oZWFkW3QuaW5zX2hdKSwKICAgICAgICAgICAgICAgICAgKHQuaGVhZFt0Lmluc19oXSA9IHQuc3Ryc3RhcnQpKSwKICAgICAgICAgICAgICAgICh0LnByZXZfbGVuZ3RoID0gdC5tYXRjaF9sZW5ndGgpLAogICAgICAgICAgICAgICAgKHQucHJldl9tYXRjaCA9IHQubWF0Y2hfc3RhcnQpLAogICAgICAgICAgICAgICAgKHQubWF0Y2hfbGVuZ3RoID0geCAtIDEpLAogICAgICAgICAgICAgICAgMCAhPT0gciAmJgogICAgICAgICAgICAgICAgICB0LnByZXZfbGVuZ3RoIDwgdC5tYXhfbGF6eV9tYXRjaCAmJgogICAgICAgICAgICAgICAgICB0LnN0cnN0YXJ0IC0gciA8PSB0Lndfc2l6ZSAtIHogJiYKICAgICAgICAgICAgICAgICAgKCh0Lm1hdGNoX2xlbmd0aCA9IEwodCwgcikpLAogICAgICAgICAgICAgICAgICB0Lm1hdGNoX2xlbmd0aCA8PSA1ICYmCiAgICAgICAgICAgICAgICAgICAgKDEgPT09IHQuc3RyYXRlZ3kgfHwKICAgICAgICAgICAgICAgICAgICAgICh0Lm1hdGNoX2xlbmd0aCA9PT0geCAmJgogICAgICAgICAgICAgICAgICAgICAgICA0MDk2IDwgdC5zdHJzdGFydCAtIHQubWF0Y2hfc3RhcnQpKSAmJgogICAgICAgICAgICAgICAgICAgICh0Lm1hdGNoX2xlbmd0aCA9IHggLSAxKSksCiAgICAgICAgICAgICAgICB0LnByZXZfbGVuZ3RoID49IHggJiYgdC5tYXRjaF9sZW5ndGggPD0gdC5wcmV2X2xlbmd0aCkKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgIG4gPSB0LnN0cnN0YXJ0ICsgdC5sb29rYWhlYWQgLSB4LAogICAgICAgICAgICAgICAgICAgIGkgPSB1Ll90cl90YWxseSgKICAgICAgICAgICAgICAgICAgICAgIHQsCiAgICAgICAgICAgICAgICAgICAgICB0LnN0cnN0YXJ0IC0gMSAtIHQucHJldl9tYXRjaCwKICAgICAgICAgICAgICAgICAgICAgIHQucHJldl9sZW5ndGggLSB4LAogICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgdC5sb29rYWhlYWQgLT0gdC5wcmV2X2xlbmd0aCAtIDEsCiAgICAgICAgICAgICAgICAgICAgdC5wcmV2X2xlbmd0aCAtPSAyOwogICAgICAgICAgICAgICAgICArK3Quc3Ryc3RhcnQgPD0gbiAmJgogICAgICAgICAgICAgICAgICAgICgodC5pbnNfaCA9CiAgICAgICAgICAgICAgICAgICAgICAoKHQuaW5zX2ggPDwgdC5oYXNoX3NoaWZ0KSBeCiAgICAgICAgICAgICAgICAgICAgICAgIHQud2luZG93W3Quc3Ryc3RhcnQgKyB4IC0gMV0pICYKICAgICAgICAgICAgICAgICAgICAgIHQuaGFzaF9tYXNrKSwKICAgICAgICAgICAgICAgICAgICAociA9IHQucHJldlt0LnN0cnN0YXJ0ICYgdC53X21hc2tdID0gdC5oZWFkW3QuaW5zX2hdKSwKICAgICAgICAgICAgICAgICAgICAodC5oZWFkW3QuaW5zX2hdID0gdC5zdHJzdGFydCkpLAogICAgICAgICAgICAgICAgICAgIDAgIT0gLS10LnByZXZfbGVuZ3RoOwoKICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICgodC5tYXRjaF9hdmFpbGFibGUgPSAwKSwKICAgICAgICAgICAgICAgICAgKHQubWF0Y2hfbGVuZ3RoID0geCAtIDEpLAogICAgICAgICAgICAgICAgICB0LnN0cnN0YXJ0KyssCiAgICAgICAgICAgICAgICAgIGkgJiYgKE4odCwgITEpLCAwID09PSB0LnN0cm0uYXZhaWxfb3V0KSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgcmV0dXJuIEE7CiAgICAgICAgICAgICAgfSBlbHNlIGlmICh0Lm1hdGNoX2F2YWlsYWJsZSkgewogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAoKGkgPSB1Ll90cl90YWxseSh0LCAwLCB0LndpbmRvd1t0LnN0cnN0YXJ0IC0gMV0pKSAmJgogICAgICAgICAgICAgICAgICAgIE4odCwgITEpLAogICAgICAgICAgICAgICAgICB0LnN0cnN0YXJ0KyssCiAgICAgICAgICAgICAgICAgIHQubG9va2FoZWFkLS0sCiAgICAgICAgICAgICAgICAgIDAgPT09IHQuc3RybS5hdmFpbF9vdXQpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIHJldHVybiBBOwogICAgICAgICAgICAgIH0gZWxzZSAodC5tYXRjaF9hdmFpbGFibGUgPSAxKSwgdC5zdHJzdGFydCsrLCB0Lmxvb2thaGVhZC0tOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgdC5tYXRjaF9hdmFpbGFibGUgJiYKICAgICAgICAgICAgICAgICgoaSA9IHUuX3RyX3RhbGx5KHQsIDAsIHQud2luZG93W3Quc3Ryc3RhcnQgLSAxXSkpLAogICAgICAgICAgICAgICAgKHQubWF0Y2hfYXZhaWxhYmxlID0gMCkpLAogICAgICAgICAgICAgICh0Lmluc2VydCA9IHQuc3Ryc3RhcnQgPCB4IC0gMSA/IHQuc3Ryc3RhcnQgOiB4IC0gMSksCiAgICAgICAgICAgICAgZSA9PT0gZgogICAgICAgICAgICAgICAgPyAoTih0LCAhMCksIDAgPT09IHQuc3RybS5hdmFpbF9vdXQgPyBPIDogQikKICAgICAgICAgICAgICAgIDogdC5sYXN0X2xpdCAmJiAoTih0LCAhMSksIDAgPT09IHQuc3RybS5hdmFpbF9vdXQpCiAgICAgICAgICAgICAgICAgID8gQQogICAgICAgICAgICAgICAgICA6IEkKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIE0odCwgZSwgciwgaSwgbikgewogICAgICAgICAgICAodGhpcy5nb29kX2xlbmd0aCA9IHQpLAogICAgICAgICAgICAgICh0aGlzLm1heF9sYXp5ID0gZSksCiAgICAgICAgICAgICAgKHRoaXMubmljZV9sZW5ndGggPSByKSwKICAgICAgICAgICAgICAodGhpcy5tYXhfY2hhaW4gPSBpKSwKICAgICAgICAgICAgICAodGhpcy5mdW5jID0gbik7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBIKCkgewogICAgICAgICAgICAodGhpcy5zdHJtID0gbnVsbCksCiAgICAgICAgICAgICAgKHRoaXMuc3RhdHVzID0gMCksCiAgICAgICAgICAgICAgKHRoaXMucGVuZGluZ19idWYgPSBudWxsKSwKICAgICAgICAgICAgICAodGhpcy5wZW5kaW5nX2J1Zl9zaXplID0gMCksCiAgICAgICAgICAgICAgKHRoaXMucGVuZGluZ19vdXQgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5wZW5kaW5nID0gMCksCiAgICAgICAgICAgICAgKHRoaXMud3JhcCA9IDApLAogICAgICAgICAgICAgICh0aGlzLmd6aGVhZCA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLmd6aW5kZXggPSAwKSwKICAgICAgICAgICAgICAodGhpcy5tZXRob2QgPSB2KSwKICAgICAgICAgICAgICAodGhpcy5sYXN0X2ZsdXNoID0gLTEpLAogICAgICAgICAgICAgICh0aGlzLndfc2l6ZSA9IDApLAogICAgICAgICAgICAgICh0aGlzLndfYml0cyA9IDApLAogICAgICAgICAgICAgICh0aGlzLndfbWFzayA9IDApLAogICAgICAgICAgICAgICh0aGlzLndpbmRvdyA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLndpbmRvd19zaXplID0gMCksCiAgICAgICAgICAgICAgKHRoaXMucHJldiA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLmhlYWQgPSBudWxsKSwKICAgICAgICAgICAgICAodGhpcy5pbnNfaCA9IDApLAogICAgICAgICAgICAgICh0aGlzLmhhc2hfc2l6ZSA9IDApLAogICAgICAgICAgICAgICh0aGlzLmhhc2hfYml0cyA9IDApLAogICAgICAgICAgICAgICh0aGlzLmhhc2hfbWFzayA9IDApLAogICAgICAgICAgICAgICh0aGlzLmhhc2hfc2hpZnQgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5ibG9ja19zdGFydCA9IDApLAogICAgICAgICAgICAgICh0aGlzLm1hdGNoX2xlbmd0aCA9IDApLAogICAgICAgICAgICAgICh0aGlzLnByZXZfbWF0Y2ggPSAwKSwKICAgICAgICAgICAgICAodGhpcy5tYXRjaF9hdmFpbGFibGUgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5zdHJzdGFydCA9IDApLAogICAgICAgICAgICAgICh0aGlzLm1hdGNoX3N0YXJ0ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMubG9va2FoZWFkID0gMCksCiAgICAgICAgICAgICAgKHRoaXMucHJldl9sZW5ndGggPSAwKSwKICAgICAgICAgICAgICAodGhpcy5tYXhfY2hhaW5fbGVuZ3RoID0gMCksCiAgICAgICAgICAgICAgKHRoaXMubWF4X2xhenlfbWF0Y2ggPSAwKSwKICAgICAgICAgICAgICAodGhpcy5sZXZlbCA9IDApLAogICAgICAgICAgICAgICh0aGlzLnN0cmF0ZWd5ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuZ29vZF9tYXRjaCA9IDApLAogICAgICAgICAgICAgICh0aGlzLm5pY2VfbWF0Y2ggPSAwKSwKICAgICAgICAgICAgICAodGhpcy5keW5fbHRyZWUgPSBuZXcgZC5CdWYxNigyICogdykpLAogICAgICAgICAgICAgICh0aGlzLmR5bl9kdHJlZSA9IG5ldyBkLkJ1ZjE2KDIgKiAoMiAqIGEgKyAxKSkpLAogICAgICAgICAgICAgICh0aGlzLmJsX3RyZWUgPSBuZXcgZC5CdWYxNigyICogKDIgKiBvICsgMSkpKSwKICAgICAgICAgICAgICBEKHRoaXMuZHluX2x0cmVlKSwKICAgICAgICAgICAgICBEKHRoaXMuZHluX2R0cmVlKSwKICAgICAgICAgICAgICBEKHRoaXMuYmxfdHJlZSksCiAgICAgICAgICAgICAgKHRoaXMubF9kZXNjID0gbnVsbCksCiAgICAgICAgICAgICAgKHRoaXMuZF9kZXNjID0gbnVsbCksCiAgICAgICAgICAgICAgKHRoaXMuYmxfZGVzYyA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLmJsX2NvdW50ID0gbmV3IGQuQnVmMTYoayArIDEpKSwKICAgICAgICAgICAgICAodGhpcy5oZWFwID0gbmV3IGQuQnVmMTYoMiAqIHMgKyAxKSksCiAgICAgICAgICAgICAgRCh0aGlzLmhlYXApLAogICAgICAgICAgICAgICh0aGlzLmhlYXBfbGVuID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuaGVhcF9tYXggPSAwKSwKICAgICAgICAgICAgICAodGhpcy5kZXB0aCA9IG5ldyBkLkJ1ZjE2KDIgKiBzICsgMSkpLAogICAgICAgICAgICAgIEQodGhpcy5kZXB0aCksCiAgICAgICAgICAgICAgKHRoaXMubF9idWYgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5saXRfYnVmc2l6ZSA9IDApLAogICAgICAgICAgICAgICh0aGlzLmxhc3RfbGl0ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuZF9idWYgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5vcHRfbGVuID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuc3RhdGljX2xlbiA9IDApLAogICAgICAgICAgICAgICh0aGlzLm1hdGNoZXMgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5pbnNlcnQgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5iaV9idWYgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5iaV92YWxpZCA9IDApOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gRyh0KSB7CiAgICAgICAgICAgIHZhciBlOwogICAgICAgICAgICByZXR1cm4gdCAmJiB0LnN0YXRlCiAgICAgICAgICAgICAgPyAoKHQudG90YWxfaW4gPSB0LnRvdGFsX291dCA9IDApLAogICAgICAgICAgICAgICAgKHQuZGF0YV90eXBlID0gbiksCiAgICAgICAgICAgICAgICAoKGUgPSB0LnN0YXRlKS5wZW5kaW5nID0gMCksCiAgICAgICAgICAgICAgICAoZS5wZW5kaW5nX291dCA9IDApLAogICAgICAgICAgICAgICAgZS53cmFwIDwgMCAmJiAoZS53cmFwID0gLWUud3JhcCksCiAgICAgICAgICAgICAgICAoZS5zdGF0dXMgPSBlLndyYXAgPyBDIDogRSksCiAgICAgICAgICAgICAgICAodC5hZGxlciA9IDIgPT09IGUud3JhcCA/IDAgOiAxKSwKICAgICAgICAgICAgICAgIChlLmxhc3RfZmx1c2ggPSBsKSwKICAgICAgICAgICAgICAgIHUuX3RyX2luaXQoZSksCiAgICAgICAgICAgICAgICBtKQogICAgICAgICAgICAgIDogUih0LCBfKTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIEsodCkgewogICAgICAgICAgICB2YXIgZSA9IEcodCk7CiAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgZSA9PT0gbSAmJgogICAgICAgICAgICAgICAgKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgICh0LndpbmRvd19zaXplID0gMiAqIHQud19zaXplKSwKICAgICAgICAgICAgICAgICAgICBEKHQuaGVhZCksCiAgICAgICAgICAgICAgICAgICAgKHQubWF4X2xhenlfbWF0Y2ggPSBoW3QubGV2ZWxdLm1heF9sYXp5KSwKICAgICAgICAgICAgICAgICAgICAodC5nb29kX21hdGNoID0gaFt0LmxldmVsXS5nb29kX2xlbmd0aCksCiAgICAgICAgICAgICAgICAgICAgKHQubmljZV9tYXRjaCA9IGhbdC5sZXZlbF0ubmljZV9sZW5ndGgpLAogICAgICAgICAgICAgICAgICAgICh0Lm1heF9jaGFpbl9sZW5ndGggPSBoW3QubGV2ZWxdLm1heF9jaGFpbiksCiAgICAgICAgICAgICAgICAgICAgKHQuc3Ryc3RhcnQgPSAwKSwKICAgICAgICAgICAgICAgICAgICAodC5ibG9ja19zdGFydCA9IDApLAogICAgICAgICAgICAgICAgICAgICh0Lmxvb2thaGVhZCA9IDApLAogICAgICAgICAgICAgICAgICAgICh0Lmluc2VydCA9IDApLAogICAgICAgICAgICAgICAgICAgICh0Lm1hdGNoX2xlbmd0aCA9IHQucHJldl9sZW5ndGggPSB4IC0gMSksCiAgICAgICAgICAgICAgICAgICAgKHQubWF0Y2hfYXZhaWxhYmxlID0gMCksCiAgICAgICAgICAgICAgICAgICAgKHQuaW5zX2ggPSAwKTsKICAgICAgICAgICAgICAgIH0pKHQuc3RhdGUpLAogICAgICAgICAgICAgIGUKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIFkodCwgZSwgciwgaSwgbiwgcykgewogICAgICAgICAgICBpZiAoIXQpIHJldHVybiBfOwogICAgICAgICAgICB2YXIgYSA9IDE7CiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAoZSA9PT0gZyAmJiAoZSA9IDYpLAogICAgICAgICAgICAgIGkgPCAwID8gKChhID0gMCksIChpID0gLWkpKSA6IDE1IDwgaSAmJiAoKGEgPSAyKSwgKGkgLT0gMTYpKSwKICAgICAgICAgICAgICBuIDwgMSB8fAogICAgICAgICAgICAgICAgeSA8IG4gfHwKICAgICAgICAgICAgICAgIHIgIT09IHYgfHwKICAgICAgICAgICAgICAgIGkgPCA4IHx8CiAgICAgICAgICAgICAgICAxNSA8IGkgfHwKICAgICAgICAgICAgICAgIGUgPCAwIHx8CiAgICAgICAgICAgICAgICA5IDwgZSB8fAogICAgICAgICAgICAgICAgcyA8IDAgfHwKICAgICAgICAgICAgICAgIGIgPCBzKQogICAgICAgICAgICApCiAgICAgICAgICAgICAgcmV0dXJuIFIodCwgXyk7CiAgICAgICAgICAgIDggPT09IGkgJiYgKGkgPSA5KTsKICAgICAgICAgICAgdmFyIG8gPSBuZXcgSCgpOwogICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICgodC5zdGF0ZSA9IG8pLnN0cm0gPSB0KSwKICAgICAgICAgICAgICAoby53cmFwID0gYSksCiAgICAgICAgICAgICAgKG8uZ3poZWFkID0gbnVsbCksCiAgICAgICAgICAgICAgKG8ud19iaXRzID0gaSksCiAgICAgICAgICAgICAgKG8ud19zaXplID0gMSA8PCBvLndfYml0cyksCiAgICAgICAgICAgICAgKG8ud19tYXNrID0gby53X3NpemUgLSAxKSwKICAgICAgICAgICAgICAoby5oYXNoX2JpdHMgPSBuICsgNyksCiAgICAgICAgICAgICAgKG8uaGFzaF9zaXplID0gMSA8PCBvLmhhc2hfYml0cyksCiAgICAgICAgICAgICAgKG8uaGFzaF9tYXNrID0gby5oYXNoX3NpemUgLSAxKSwKICAgICAgICAgICAgICAoby5oYXNoX3NoaWZ0ID0gfn4oKG8uaGFzaF9iaXRzICsgeCAtIDEpIC8geCkpLAogICAgICAgICAgICAgIChvLndpbmRvdyA9IG5ldyBkLkJ1ZjgoMiAqIG8ud19zaXplKSksCiAgICAgICAgICAgICAgKG8uaGVhZCA9IG5ldyBkLkJ1ZjE2KG8uaGFzaF9zaXplKSksCiAgICAgICAgICAgICAgKG8ucHJldiA9IG5ldyBkLkJ1ZjE2KG8ud19zaXplKSksCiAgICAgICAgICAgICAgKG8ubGl0X2J1ZnNpemUgPSAxIDw8IChuICsgNikpLAogICAgICAgICAgICAgIChvLnBlbmRpbmdfYnVmX3NpemUgPSA0ICogby5saXRfYnVmc2l6ZSksCiAgICAgICAgICAgICAgKG8ucGVuZGluZ19idWYgPSBuZXcgZC5CdWY4KG8ucGVuZGluZ19idWZfc2l6ZSkpLAogICAgICAgICAgICAgIChvLmRfYnVmID0gMSAqIG8ubGl0X2J1ZnNpemUpLAogICAgICAgICAgICAgIChvLmxfYnVmID0gMyAqIG8ubGl0X2J1ZnNpemUpLAogICAgICAgICAgICAgIChvLmxldmVsID0gZSksCiAgICAgICAgICAgICAgKG8uc3RyYXRlZ3kgPSBzKSwKICAgICAgICAgICAgICAoby5tZXRob2QgPSByKSwKICAgICAgICAgICAgICBLKHQpCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgICAoaCA9IFsKICAgICAgICAgICAgbmV3IE0oMCwgMCwgMCwgMCwgZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICB2YXIgciA9IDY1NTM1OwogICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICByID4gdC5wZW5kaW5nX2J1Zl9zaXplIC0gNSAmJiAociA9IHQucGVuZGluZ19idWZfc2l6ZSAtIDUpOwogICAgICAgICAgICAgICAgOwoKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIGlmICh0Lmxvb2thaGVhZCA8PSAxKSB7CiAgICAgICAgICAgICAgICAgIGlmICgoaih0KSwgMCA9PT0gdC5sb29rYWhlYWQgJiYgZSA9PT0gbCkpIHJldHVybiBBOwogICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gdC5sb29rYWhlYWQpIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKHQuc3Ryc3RhcnQgKz0gdC5sb29rYWhlYWQpLCAodC5sb29rYWhlYWQgPSAwKTsKICAgICAgICAgICAgICAgIHZhciBpID0gdC5ibG9ja19zdGFydCArIHI7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICgwID09PSB0LnN0cnN0YXJ0IHx8IHQuc3Ryc3RhcnQgPj0gaSkgJiYKICAgICAgICAgICAgICAgICAgKCh0Lmxvb2thaGVhZCA9IHQuc3Ryc3RhcnQgLSBpKSwKICAgICAgICAgICAgICAgICAgKHQuc3Ryc3RhcnQgPSBpKSwKICAgICAgICAgICAgICAgICAgTih0LCAhMSksCiAgICAgICAgICAgICAgICAgIDAgPT09IHQuc3RybS5hdmFpbF9vdXQpCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgIHJldHVybiBBOwogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICB0LnN0cnN0YXJ0IC0gdC5ibG9ja19zdGFydCA+PSB0Lndfc2l6ZSAtIHogJiYKICAgICAgICAgICAgICAgICAgKE4odCwgITEpLCAwID09PSB0LnN0cm0uYXZhaWxfb3V0KQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICByZXR1cm4gQTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgICh0Lmluc2VydCA9IDApLAogICAgICAgICAgICAgICAgZSA9PT0gZgogICAgICAgICAgICAgICAgICA/IChOKHQsICEwKSwgMCA9PT0gdC5zdHJtLmF2YWlsX291dCA/IE8gOiBCKQogICAgICAgICAgICAgICAgICA6ICh0LnN0cnN0YXJ0ID4gdC5ibG9ja19zdGFydCAmJiAoTih0LCAhMSksIHQuc3RybS5hdmFpbF9vdXQpLAogICAgICAgICAgICAgICAgICAgIEEpCiAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgIG5ldyBNKDQsIDQsIDgsIDQsIFopLAogICAgICAgICAgICBuZXcgTSg0LCA1LCAxNiwgOCwgWiksCiAgICAgICAgICAgIG5ldyBNKDQsIDYsIDMyLCAzMiwgWiksCiAgICAgICAgICAgIG5ldyBNKDQsIDQsIDE2LCAxNiwgVyksCiAgICAgICAgICAgIG5ldyBNKDgsIDE2LCAzMiwgMzIsIFcpLAogICAgICAgICAgICBuZXcgTSg4LCAxNiwgMTI4LCAxMjgsIFcpLAogICAgICAgICAgICBuZXcgTSg4LCAzMiwgMTI4LCAyNTYsIFcpLAogICAgICAgICAgICBuZXcgTSgzMiwgMTI4LCAyNTgsIDEwMjQsIFcpLAogICAgICAgICAgICBuZXcgTSgzMiwgMjU4LCAyNTgsIDQwOTYsIFcpLAogICAgICAgICAgXSksCiAgICAgICAgICAgIChyLmRlZmxhdGVJbml0ID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICByZXR1cm4gWSh0LCBlLCB2LCAxNSwgOCwgMCk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5kZWZsYXRlSW5pdDIgPSBZKSwKICAgICAgICAgICAgKHIuZGVmbGF0ZVJlc2V0ID0gSyksCiAgICAgICAgICAgIChyLmRlZmxhdGVSZXNldEtlZXAgPSBHKSwKICAgICAgICAgICAgKHIuZGVmbGF0ZVNldEhlYWRlciA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHQgJiYgdC5zdGF0ZQogICAgICAgICAgICAgICAgPyAyICE9PSB0LnN0YXRlLndyYXAKICAgICAgICAgICAgICAgICAgPyBfCiAgICAgICAgICAgICAgICAgIDogKCh0LnN0YXRlLmd6aGVhZCA9IGUpLCBtKQogICAgICAgICAgICAgICAgOiBfOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHIuZGVmbGF0ZSA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgdmFyIHIsIGksIG4sIHM7CiAgICAgICAgICAgICAgaWYgKCF0IHx8ICF0LnN0YXRlIHx8IDUgPCBlIHx8IGUgPCAwKSByZXR1cm4gdCA/IFIodCwgXykgOiBfOwogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICgoaSA9IHQuc3RhdGUpLAogICAgICAgICAgICAgICAgIXQub3V0cHV0IHx8CiAgICAgICAgICAgICAgICAgICghdC5pbnB1dCAmJiAwICE9PSB0LmF2YWlsX2luKSB8fAogICAgICAgICAgICAgICAgICAoNjY2ID09PSBpLnN0YXR1cyAmJiBlICE9PSBmKSkKICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICByZXR1cm4gUih0LCAwID09PSB0LmF2YWlsX291dCA/IC01IDogXyk7CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgKChpLnN0cm0gPSB0KSwKICAgICAgICAgICAgICAgIChyID0gaS5sYXN0X2ZsdXNoKSwKICAgICAgICAgICAgICAgIChpLmxhc3RfZmx1c2ggPSBlKSwKICAgICAgICAgICAgICAgIGkuc3RhdHVzID09PSBDKQogICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIGlmICgyID09PSBpLndyYXApCiAgICAgICAgICAgICAgICAgICh0LmFkbGVyID0gMCksCiAgICAgICAgICAgICAgICAgICAgVShpLCAzMSksCiAgICAgICAgICAgICAgICAgICAgVShpLCAxMzkpLAogICAgICAgICAgICAgICAgICAgIFUoaSwgOCksCiAgICAgICAgICAgICAgICAgICAgaS5nemhlYWQKICAgICAgICAgICAgICAgICAgICAgID8gKFUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICAoaS5nemhlYWQudGV4dCA/IDEgOiAwKSArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoaS5nemhlYWQuaGNyYyA/IDIgOiAwKSArCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoaS5nemhlYWQuZXh0cmEgPyA0IDogMCkgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKGkuZ3poZWFkLm5hbWUgPyA4IDogMCkgKwogICAgICAgICAgICAgICAgICAgICAgICAgICAgKGkuZ3poZWFkLmNvbW1lbnQgPyAxNiA6IDApLAogICAgICAgICAgICAgICAgICAgICAgICApLAogICAgICAgICAgICAgICAgICAgICAgICBVKGksIDI1NSAmIGkuZ3poZWFkLnRpbWUpLAogICAgICAgICAgICAgICAgICAgICAgICBVKGksIChpLmd6aGVhZC50aW1lID4+IDgpICYgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgVShpLCAoaS5nemhlYWQudGltZSA+PiAxNikgJiAyNTUpLAogICAgICAgICAgICAgICAgICAgICAgICBVKGksIChpLmd6aGVhZC50aW1lID4+IDI0KSAmIDI1NSksCiAgICAgICAgICAgICAgICAgICAgICAgIFUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgICAgICAgICAgICA5ID09PSBpLmxldmVsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA/IDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogMiA8PSBpLnN0cmF0ZWd5IHx8IGkubGV2ZWwgPCAyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gNAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IDAsCiAgICAgICAgICAgICAgICAgICAgICAgICksCiAgICAgICAgICAgICAgICAgICAgICAgIFUoaSwgMjU1ICYgaS5nemhlYWQub3MpLAogICAgICAgICAgICAgICAgICAgICAgICBpLmd6aGVhZC5leHRyYSAmJgogICAgICAgICAgICAgICAgICAgICAgICAgIGkuZ3poZWFkLmV4dHJhLmxlbmd0aCAmJgogICAgICAgICAgICAgICAgICAgICAgICAgIChVKGksIDI1NSAmIGkuZ3poZWFkLmV4dHJhLmxlbmd0aCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgVShpLCAoaS5nemhlYWQuZXh0cmEubGVuZ3RoID4+IDgpICYgMjU1KSksCiAgICAgICAgICAgICAgICAgICAgICAgIGkuZ3poZWFkLmhjcmMgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAodC5hZGxlciA9IHAodC5hZGxlciwgaS5wZW5kaW5nX2J1ZiwgaS5wZW5kaW5nLCAwKSksCiAgICAgICAgICAgICAgICAgICAgICAgIChpLmd6aW5kZXggPSAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgKGkuc3RhdHVzID0gNjkpKQogICAgICAgICAgICAgICAgICAgICAgOiAoVShpLCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgVShpLCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgVShpLCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgVShpLCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgVShpLCAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgVSgKICAgICAgICAgICAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgICAgICAgICAgIDkgPT09IGkubGV2ZWwKICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gMgogICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAyIDw9IGkuc3RyYXRlZ3kgfHwgaS5sZXZlbCA8IDIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyA0CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogMCwKICAgICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgICAgVShpLCAzKSwKICAgICAgICAgICAgICAgICAgICAgICAgKGkuc3RhdHVzID0gRSkpOwogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgIHZhciBhID0gKHYgKyAoKGkud19iaXRzIC0gOCkgPDwgNCkpIDw8IDg7CiAgICAgICAgICAgICAgICAgIChhIHw9CiAgICAgICAgICAgICAgICAgICAgKDIgPD0gaS5zdHJhdGVneSB8fCBpLmxldmVsIDwgMgogICAgICAgICAgICAgICAgICAgICAgPyAwCiAgICAgICAgICAgICAgICAgICAgICA6IGkubGV2ZWwgPCA2CiAgICAgICAgICAgICAgICAgICAgICAgID8gMQogICAgICAgICAgICAgICAgICAgICAgICA6IDYgPT09IGkubGV2ZWwKICAgICAgICAgICAgICAgICAgICAgICAgICA/IDIKICAgICAgICAgICAgICAgICAgICAgICAgICA6IDMpIDw8IDYpLAogICAgICAgICAgICAgICAgICAgIDAgIT09IGkuc3Ryc3RhcnQgJiYgKGEgfD0gMzIpLAogICAgICAgICAgICAgICAgICAgIChhICs9IDMxIC0gKGEgJSAzMSkpLAogICAgICAgICAgICAgICAgICAgIChpLnN0YXR1cyA9IEUpLAogICAgICAgICAgICAgICAgICAgIFAoaSwgYSksCiAgICAgICAgICAgICAgICAgICAgMCAhPT0gaS5zdHJzdGFydCAmJgogICAgICAgICAgICAgICAgICAgICAgKFAoaSwgdC5hZGxlciA+Pj4gMTYpLCBQKGksIDY1NTM1ICYgdC5hZGxlcikpLAogICAgICAgICAgICAgICAgICAgICh0LmFkbGVyID0gMSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKDY5ID09PSBpLnN0YXR1cykKICAgICAgICAgICAgICAgIGlmIChpLmd6aGVhZC5leHRyYSkgewogICAgICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgICAgIG4gPSBpLnBlbmRpbmc7CiAgICAgICAgICAgICAgICAgICAgaS5nemluZGV4IDwgKDY1NTM1ICYgaS5nemhlYWQuZXh0cmEubGVuZ3RoKSAmJgogICAgICAgICAgICAgICAgICAgIChpLnBlbmRpbmcgIT09IGkucGVuZGluZ19idWZfc2l6ZSB8fAogICAgICAgICAgICAgICAgICAgICAgKGkuZ3poZWFkLmhjcmMgJiYKICAgICAgICAgICAgICAgICAgICAgICAgaS5wZW5kaW5nID4gbiAmJgogICAgICAgICAgICAgICAgICAgICAgICAodC5hZGxlciA9IHAodC5hZGxlciwgaS5wZW5kaW5nX2J1ZiwgaS5wZW5kaW5nIC0gbiwgbikpLAogICAgICAgICAgICAgICAgICAgICAgRih0KSwKICAgICAgICAgICAgICAgICAgICAgIChuID0gaS5wZW5kaW5nKSwKICAgICAgICAgICAgICAgICAgICAgIGkucGVuZGluZyAhPT0gaS5wZW5kaW5nX2J1Zl9zaXplKSk7CgogICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgVShpLCAyNTUgJiBpLmd6aGVhZC5leHRyYVtpLmd6aW5kZXhdKSwgaS5nemluZGV4Kys7CiAgICAgICAgICAgICAgICAgIGkuZ3poZWFkLmhjcmMgJiYKICAgICAgICAgICAgICAgICAgICBpLnBlbmRpbmcgPiBuICYmCiAgICAgICAgICAgICAgICAgICAgKHQuYWRsZXIgPSBwKHQuYWRsZXIsIGkucGVuZGluZ19idWYsIGkucGVuZGluZyAtIG4sIG4pKSwKICAgICAgICAgICAgICAgICAgICBpLmd6aW5kZXggPT09IGkuZ3poZWFkLmV4dHJhLmxlbmd0aCAmJgogICAgICAgICAgICAgICAgICAgICAgKChpLmd6aW5kZXggPSAwKSwgKGkuc3RhdHVzID0gNzMpKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpLnN0YXR1cyA9IDczOwogICAgICAgICAgICAgIGlmICg3MyA9PT0gaS5zdGF0dXMpCiAgICAgICAgICAgICAgICBpZiAoaS5nemhlYWQubmFtZSkgewogICAgICAgICAgICAgICAgICBuID0gaS5wZW5kaW5nOwogICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgaS5wZW5kaW5nID09PSBpLnBlbmRpbmdfYnVmX3NpemUgJiYKICAgICAgICAgICAgICAgICAgICAgIChpLmd6aGVhZC5oY3JjICYmCiAgICAgICAgICAgICAgICAgICAgICAgIGkucGVuZGluZyA+IG4gJiYKICAgICAgICAgICAgICAgICAgICAgICAgKHQuYWRsZXIgPSBwKHQuYWRsZXIsIGkucGVuZGluZ19idWYsIGkucGVuZGluZyAtIG4sIG4pKSwKICAgICAgICAgICAgICAgICAgICAgIEYodCksCiAgICAgICAgICAgICAgICAgICAgICAobiA9IGkucGVuZGluZyksCiAgICAgICAgICAgICAgICAgICAgICBpLnBlbmRpbmcgPT09IGkucGVuZGluZ19idWZfc2l6ZSkKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgIHMgPSAxOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIChzID0KICAgICAgICAgICAgICAgICAgICAgIGkuZ3ppbmRleCA8IGkuZ3poZWFkLm5hbWUubGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgID8gMjU1ICYgaS5nemhlYWQubmFtZS5jaGFyQ29kZUF0KGkuZ3ppbmRleCsrKQogICAgICAgICAgICAgICAgICAgICAgICA6IDApLAogICAgICAgICAgICAgICAgICAgICAgVShpLCBzKTsKICAgICAgICAgICAgICAgICAgfSB3aGlsZSAoMCAhPT0gcyk7CiAgICAgICAgICAgICAgICAgIGkuZ3poZWFkLmhjcmMgJiYKICAgICAgICAgICAgICAgICAgICBpLnBlbmRpbmcgPiBuICYmCiAgICAgICAgICAgICAgICAgICAgKHQuYWRsZXIgPSBwKHQuYWRsZXIsIGkucGVuZGluZ19idWYsIGkucGVuZGluZyAtIG4sIG4pKSwKICAgICAgICAgICAgICAgICAgICAwID09PSBzICYmICgoaS5nemluZGV4ID0gMCksIChpLnN0YXR1cyA9IDkxKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaS5zdGF0dXMgPSA5MTsKICAgICAgICAgICAgICBpZiAoOTEgPT09IGkuc3RhdHVzKQogICAgICAgICAgICAgICAgaWYgKGkuZ3poZWFkLmNvbW1lbnQpIHsKICAgICAgICAgICAgICAgICAgbiA9IGkucGVuZGluZzsKICAgICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgIGkucGVuZGluZyA9PT0gaS5wZW5kaW5nX2J1Zl9zaXplICYmCiAgICAgICAgICAgICAgICAgICAgICAoaS5nemhlYWQuaGNyYyAmJgogICAgICAgICAgICAgICAgICAgICAgICBpLnBlbmRpbmcgPiBuICYmCiAgICAgICAgICAgICAgICAgICAgICAgICh0LmFkbGVyID0gcCh0LmFkbGVyLCBpLnBlbmRpbmdfYnVmLCBpLnBlbmRpbmcgLSBuLCBuKSksCiAgICAgICAgICAgICAgICAgICAgICBGKHQpLAogICAgICAgICAgICAgICAgICAgICAgKG4gPSBpLnBlbmRpbmcpLAogICAgICAgICAgICAgICAgICAgICAgaS5wZW5kaW5nID09PSBpLnBlbmRpbmdfYnVmX3NpemUpCiAgICAgICAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICAgICAgICBzID0gMTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAocyA9CiAgICAgICAgICAgICAgICAgICAgICBpLmd6aW5kZXggPCBpLmd6aGVhZC5jb21tZW50Lmxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICA/IDI1NSAmIGkuZ3poZWFkLmNvbW1lbnQuY2hhckNvZGVBdChpLmd6aW5kZXgrKykKICAgICAgICAgICAgICAgICAgICAgICAgOiAwKSwKICAgICAgICAgICAgICAgICAgICAgIFUoaSwgcyk7CiAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKDAgIT09IHMpOwogICAgICAgICAgICAgICAgICBpLmd6aGVhZC5oY3JjICYmCiAgICAgICAgICAgICAgICAgICAgaS5wZW5kaW5nID4gbiAmJgogICAgICAgICAgICAgICAgICAgICh0LmFkbGVyID0gcCh0LmFkbGVyLCBpLnBlbmRpbmdfYnVmLCBpLnBlbmRpbmcgLSBuLCBuKSksCiAgICAgICAgICAgICAgICAgICAgMCA9PT0gcyAmJiAoaS5zdGF0dXMgPSAxMDMpOwogICAgICAgICAgICAgICAgfSBlbHNlIGkuc3RhdHVzID0gMTAzOwogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICgxMDMgPT09IGkuc3RhdHVzICYmCiAgICAgICAgICAgICAgICAgIChpLmd6aGVhZC5oY3JjCiAgICAgICAgICAgICAgICAgICAgPyAoaS5wZW5kaW5nICsgMiA+IGkucGVuZGluZ19idWZfc2l6ZSAmJiBGKHQpLAogICAgICAgICAgICAgICAgICAgICAgaS5wZW5kaW5nICsgMiA8PSBpLnBlbmRpbmdfYnVmX3NpemUgJiYKICAgICAgICAgICAgICAgICAgICAgICAgKFUoaSwgMjU1ICYgdC5hZGxlciksCiAgICAgICAgICAgICAgICAgICAgICAgIFUoaSwgKHQuYWRsZXIgPj4gOCkgJiAyNTUpLAogICAgICAgICAgICAgICAgICAgICAgICAodC5hZGxlciA9IDApLAogICAgICAgICAgICAgICAgICAgICAgICAoaS5zdGF0dXMgPSBFKSkpCiAgICAgICAgICAgICAgICAgICAgOiAoaS5zdGF0dXMgPSBFKSksCiAgICAgICAgICAgICAgICAwICE9PSBpLnBlbmRpbmcpCiAgICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICBpZiAoKEYodCksIDAgPT09IHQuYXZhaWxfb3V0KSkgcmV0dXJuIChpLmxhc3RfZmx1c2ggPSAtMSksIG07CiAgICAgICAgICAgICAgfSBlbHNlIGlmICgwID09PSB0LmF2YWlsX2luICYmIFQoZSkgPD0gVChyKSAmJiBlICE9PSBmKQogICAgICAgICAgICAgICAgcmV0dXJuIFIodCwgLTUpOwogICAgICAgICAgICAgIGlmICg2NjYgPT09IGkuc3RhdHVzICYmIDAgIT09IHQuYXZhaWxfaW4pIHJldHVybiBSKHQsIC01KTsKICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAwICE9PSB0LmF2YWlsX2luIHx8CiAgICAgICAgICAgICAgICAwICE9PSBpLmxvb2thaGVhZCB8fAogICAgICAgICAgICAgICAgKGUgIT09IGwgJiYgNjY2ICE9PSBpLnN0YXR1cykKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIHZhciBvID0KICAgICAgICAgICAgICAgICAgMiA9PT0gaS5zdHJhdGVneQogICAgICAgICAgICAgICAgICAgID8gKGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHI7IDsgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IHQubG9va2FoZWFkICYmIChqKHQpLCAwID09PSB0Lmxvb2thaGVhZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlID09PSBsKSByZXR1cm4gQTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoKHQubWF0Y2hfbGVuZ3RoID0gMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAociA9IHUuX3RyX3RhbGx5KHQsIDAsIHQud2luZG93W3Quc3Ryc3RhcnRdKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0Lmxvb2thaGVhZC0tLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5zdHJzdGFydCsrLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgciAmJiAoTih0LCAhMSksIDAgPT09IHQuc3RybS5hdmFpbF9vdXQpKQogICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgKHQuaW5zZXJ0ID0gMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9PT0gZgogICAgICAgICAgICAgICAgICAgICAgICAgICAgPyAoTih0LCAhMCksIDAgPT09IHQuc3RybS5hdmFpbF9vdXQgPyBPIDogQikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdC5sYXN0X2xpdCAmJiAoTih0LCAhMSksIDAgPT09IHQuc3RybS5hdmFpbF9vdXQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gQQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IEkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgIH0pKGksIGUpCiAgICAgICAgICAgICAgICAgICAgOiAzID09PSBpLnN0cmF0ZWd5CiAgICAgICAgICAgICAgICAgICAgICA/IChmdW5jdGlvbiAodCwgZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHIsIGksIG4sIHMsIGEgPSB0LndpbmRvdzsgOyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0Lmxvb2thaGVhZCA8PSBTKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoaih0KSwgdC5sb29rYWhlYWQgPD0gUyAmJiBlID09PSBsKSkgcmV0dXJuIEE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSB0Lmxvb2thaGVhZCkgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgodC5tYXRjaF9sZW5ndGggPSAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5sb29rYWhlYWQgPj0geCAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAgPCB0LnN0cnN0YXJ0ICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGkgPSBhWyhuID0gdC5zdHJzdGFydCAtIDEpXSkgPT09IGFbKytuXSAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPT09IGFbKytuXSAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgPT09IGFbKytuXSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzID0gdC5zdHJzdGFydCArIFM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvIHt9IHdoaWxlICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID09PSBhWysrbl0gJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID09PSBhWysrbl0gJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID09PSBhWysrbl0gJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID09PSBhWysrbl0gJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID09PSBhWysrbl0gJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID09PSBhWysrbl0gJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID09PSBhWysrbl0gJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpID09PSBhWysrbl0gJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuIDwgcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodC5tYXRjaF9sZW5ndGggPSBTIC0gKHMgLSBuKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC5tYXRjaF9sZW5ndGggPiB0Lmxvb2thaGVhZCAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHQubWF0Y2hfbGVuZ3RoID0gdC5sb29rYWhlYWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodC5tYXRjaF9sZW5ndGggPj0geAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKChyID0gdS5fdHJfdGFsbHkodCwgMSwgdC5tYXRjaF9sZW5ndGggLSB4KSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAodC5sb29rYWhlYWQgLT0gdC5tYXRjaF9sZW5ndGgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHQuc3Ryc3RhcnQgKz0gdC5tYXRjaF9sZW5ndGgpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHQubWF0Y2hfbGVuZ3RoID0gMCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAoKHIgPSB1Ll90cl90YWxseSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdC53aW5kb3dbdC5zdHJzdGFydF0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICApKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQubG9va2FoZWFkLS0sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LnN0cnN0YXJ0KyspLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByICYmIChOKHQsICExKSwgMCA9PT0gdC5zdHJtLmF2YWlsX291dCkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBBOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKHQuaW5zZXJ0ID0gMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID09PSBmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgID8gKE4odCwgITApLCAwID09PSB0LnN0cm0uYXZhaWxfb3V0ID8gTyA6IEIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDogdC5sYXN0X2xpdCAmJiAoTih0LCAhMSksIDAgPT09IHQuc3RybS5hdmFpbF9vdXQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBBCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiBJCiAgICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSkoaSwgZSkKICAgICAgICAgICAgICAgICAgICAgIDogaFtpLmxldmVsXS5mdW5jKGksIGUpOwogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAoKG8gIT09IE8gJiYgbyAhPT0gQikgfHwgKGkuc3RhdHVzID0gNjY2KSwgbyA9PT0gQSB8fCBvID09PSBPKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICByZXR1cm4gMCA9PT0gdC5hdmFpbF9vdXQgJiYgKGkubGFzdF9mbHVzaCA9IC0xKSwgbTsKICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgbyA9PT0gSSAmJgogICAgICAgICAgICAgICAgICAoMSA9PT0gZQogICAgICAgICAgICAgICAgICAgID8gdS5fdHJfYWxpZ24oaSkKICAgICAgICAgICAgICAgICAgICA6IDUgIT09IGUgJiYKICAgICAgICAgICAgICAgICAgICAgICh1Ll90cl9zdG9yZWRfYmxvY2soaSwgMCwgMCwgITEpLAogICAgICAgICAgICAgICAgICAgICAgMyA9PT0gZSAmJgogICAgICAgICAgICAgICAgICAgICAgICAoRChpLmhlYWQpLAogICAgICAgICAgICAgICAgICAgICAgICAwID09PSBpLmxvb2thaGVhZCAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICgoaS5zdHJzdGFydCA9IDApLAogICAgICAgICAgICAgICAgICAgICAgICAgIChpLmJsb2NrX3N0YXJ0ID0gMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKGkuaW5zZXJ0ID0gMCkpKSksCiAgICAgICAgICAgICAgICAgIEYodCksCiAgICAgICAgICAgICAgICAgIDAgPT09IHQuYXZhaWxfb3V0KQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICByZXR1cm4gKGkubGFzdF9mbHVzaCA9IC0xKSwgbTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuIGUgIT09IGYKICAgICAgICAgICAgICAgID8gbQogICAgICAgICAgICAgICAgOiBpLndyYXAgPD0gMAogICAgICAgICAgICAgICAgICA/IDEKICAgICAgICAgICAgICAgICAgOiAoMiA9PT0gaS53cmFwCiAgICAgICAgICAgICAgICAgICAgICA/IChVKGksIDI1NSAmIHQuYWRsZXIpLAogICAgICAgICAgICAgICAgICAgICAgICBVKGksICh0LmFkbGVyID4+IDgpICYgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgVShpLCAodC5hZGxlciA+PiAxNikgJiAyNTUpLAogICAgICAgICAgICAgICAgICAgICAgICBVKGksICh0LmFkbGVyID4+IDI0KSAmIDI1NSksCiAgICAgICAgICAgICAgICAgICAgICAgIFUoaSwgMjU1ICYgdC50b3RhbF9pbiksCiAgICAgICAgICAgICAgICAgICAgICAgIFUoaSwgKHQudG90YWxfaW4gPj4gOCkgJiAyNTUpLAogICAgICAgICAgICAgICAgICAgICAgICBVKGksICh0LnRvdGFsX2luID4+IDE2KSAmIDI1NSksCiAgICAgICAgICAgICAgICAgICAgICAgIFUoaSwgKHQudG90YWxfaW4gPj4gMjQpICYgMjU1KSkKICAgICAgICAgICAgICAgICAgICAgIDogKFAoaSwgdC5hZGxlciA+Pj4gMTYpLCBQKGksIDY1NTM1ICYgdC5hZGxlcikpLAogICAgICAgICAgICAgICAgICAgIEYodCksCiAgICAgICAgICAgICAgICAgICAgMCA8IGkud3JhcCAmJiAoaS53cmFwID0gLWkud3JhcCksCiAgICAgICAgICAgICAgICAgICAgMCAhPT0gaS5wZW5kaW5nID8gbSA6IDEpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHIuZGVmbGF0ZUVuZCA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgdmFyIGU7CiAgICAgICAgICAgICAgcmV0dXJuIHQgJiYgdC5zdGF0ZQogICAgICAgICAgICAgICAgPyAoZSA9IHQuc3RhdGUuc3RhdHVzKSAhPT0gQyAmJgogICAgICAgICAgICAgICAgICA2OSAhPT0gZSAmJgogICAgICAgICAgICAgICAgICA3MyAhPT0gZSAmJgogICAgICAgICAgICAgICAgICA5MSAhPT0gZSAmJgogICAgICAgICAgICAgICAgICAxMDMgIT09IGUgJiYKICAgICAgICAgICAgICAgICAgZSAhPT0gRSAmJgogICAgICAgICAgICAgICAgICA2NjYgIT09IGUKICAgICAgICAgICAgICAgICAgPyBSKHQsIF8pCiAgICAgICAgICAgICAgICAgIDogKCh0LnN0YXRlID0gbnVsbCksIGUgPT09IEUgPyBSKHQsIC0zKSA6IG0pCiAgICAgICAgICAgICAgICA6IF87CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5kZWZsYXRlU2V0RGljdGlvbmFyeSA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgdmFyIHIsCiAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICAgIHMsCiAgICAgICAgICAgICAgICBhLAogICAgICAgICAgICAgICAgbywKICAgICAgICAgICAgICAgIGgsCiAgICAgICAgICAgICAgICB1LAogICAgICAgICAgICAgICAgbCA9IGUubGVuZ3RoOwogICAgICAgICAgICAgIGlmICghdCB8fCAhdC5zdGF0ZSkgcmV0dXJuIF87CiAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgMiA9PT0gKHMgPSAociA9IHQuc3RhdGUpLndyYXApIHx8CiAgICAgICAgICAgICAgICAoMSA9PT0gcyAmJiByLnN0YXR1cyAhPT0gQykgfHwKICAgICAgICAgICAgICAgIHIubG9va2FoZWFkCiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgcmV0dXJuIF87CiAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgIDEgPT09IHMgJiYgKHQuYWRsZXIgPSBjKHQuYWRsZXIsIGUsIGwsIDApKSwKICAgICAgICAgICAgICAgICAgci53cmFwID0gMCwKICAgICAgICAgICAgICAgICAgbCA+PSByLndfc2l6ZSAmJgogICAgICAgICAgICAgICAgICAgICgwID09PSBzICYmCiAgICAgICAgICAgICAgICAgICAgICAoRChyLmhlYWQpLAogICAgICAgICAgICAgICAgICAgICAgKHIuc3Ryc3RhcnQgPSAwKSwKICAgICAgICAgICAgICAgICAgICAgIChyLmJsb2NrX3N0YXJ0ID0gMCksCiAgICAgICAgICAgICAgICAgICAgICAoci5pbnNlcnQgPSAwKSksCiAgICAgICAgICAgICAgICAgICAgKHUgPSBuZXcgZC5CdWY4KHIud19zaXplKSksCiAgICAgICAgICAgICAgICAgICAgZC5hcnJheVNldCh1LCBlLCBsIC0gci53X3NpemUsIHIud19zaXplLCAwKSwKICAgICAgICAgICAgICAgICAgICAoZSA9IHUpLAogICAgICAgICAgICAgICAgICAgIChsID0gci53X3NpemUpKSwKICAgICAgICAgICAgICAgICAgYSA9IHQuYXZhaWxfaW4sCiAgICAgICAgICAgICAgICAgIG8gPSB0Lm5leHRfaW4sCiAgICAgICAgICAgICAgICAgIGggPSB0LmlucHV0LAogICAgICAgICAgICAgICAgICB0LmF2YWlsX2luID0gbCwKICAgICAgICAgICAgICAgICAgdC5uZXh0X2luID0gMCwKICAgICAgICAgICAgICAgICAgdC5pbnB1dCA9IGUsCiAgICAgICAgICAgICAgICAgIGoocik7CiAgICAgICAgICAgICAgICByLmxvb2thaGVhZCA+PSB4OwoKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgIGkgPSByLnN0cnN0YXJ0LCBuID0gci5sb29rYWhlYWQgLSAoeCAtIDEpOwogICAgICAgICAgICAgICAgICAoci5pbnNfaCA9CiAgICAgICAgICAgICAgICAgICAgKChyLmluc19oIDw8IHIuaGFzaF9zaGlmdCkgXiByLndpbmRvd1tpICsgeCAtIDFdKSAmCiAgICAgICAgICAgICAgICAgICAgci5oYXNoX21hc2spLAogICAgICAgICAgICAgICAgICAgIChyLnByZXZbaSAmIHIud19tYXNrXSA9IHIuaGVhZFtyLmluc19oXSksCiAgICAgICAgICAgICAgICAgICAgKHIuaGVhZFtyLmluc19oXSA9IGkpLAogICAgICAgICAgICAgICAgICAgIGkrKywKICAgICAgICAgICAgICAgICAgICAtLW47CgogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIChyLnN0cnN0YXJ0ID0gaSksIChyLmxvb2thaGVhZCA9IHggLSAxKSwgaihyKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAgIChyLnN0cnN0YXJ0ICs9IHIubG9va2FoZWFkKSwKICAgICAgICAgICAgICAgIChyLmJsb2NrX3N0YXJ0ID0gci5zdHJzdGFydCksCiAgICAgICAgICAgICAgICAoci5pbnNlcnQgPSByLmxvb2thaGVhZCksCiAgICAgICAgICAgICAgICAoci5sb29rYWhlYWQgPSAwKSwKICAgICAgICAgICAgICAgIChyLm1hdGNoX2xlbmd0aCA9IHIucHJldl9sZW5ndGggPSB4IC0gMSksCiAgICAgICAgICAgICAgICAoci5tYXRjaF9hdmFpbGFibGUgPSAwKSwKICAgICAgICAgICAgICAgICh0Lm5leHRfaW4gPSBvKSwKICAgICAgICAgICAgICAgICh0LmlucHV0ID0gaCksCiAgICAgICAgICAgICAgICAodC5hdmFpbF9pbiA9IGEpLAogICAgICAgICAgICAgICAgKHIud3JhcCA9IHMpLAogICAgICAgICAgICAgICAgbQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5kZWZsYXRlSW5mbyA9ICJwYWtvIGRlZmxhdGUgKGZyb20gTm9kZWNhIHByb2plY3QpIik7CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAiLi4vdXRpbHMvY29tbW9uIjogNDEsCiAgICAgICAgICAiLi9hZGxlcjMyIjogNDMsCiAgICAgICAgICAiLi9jcmMzMiI6IDQ1LAogICAgICAgICAgIi4vbWVzc2FnZXMiOiA1MSwKICAgICAgICAgICIuL3RyZWVzIjogNTIsCiAgICAgICAgfSwKICAgICAgXSwKICAgICAgNDc6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgZS5leHBvcnRzID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAodGhpcy50ZXh0ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMudGltZSA9IDApLAogICAgICAgICAgICAgICh0aGlzLnhmbGFncyA9IDApLAogICAgICAgICAgICAgICh0aGlzLm9zID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuZXh0cmEgPSBudWxsKSwKICAgICAgICAgICAgICAodGhpcy5leHRyYV9sZW4gPSAwKSwKICAgICAgICAgICAgICAodGhpcy5uYW1lID0gIiIpLAogICAgICAgICAgICAgICh0aGlzLmNvbW1lbnQgPSAiIiksCiAgICAgICAgICAgICAgKHRoaXMuaGNyYyA9IDApLAogICAgICAgICAgICAgICh0aGlzLmRvbmUgPSAhMSk7CiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAge30sCiAgICAgIF0sCiAgICAgIDQ4OiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICBzLAogICAgICAgICAgICAgIGEsCiAgICAgICAgICAgICAgbywKICAgICAgICAgICAgICBoLAogICAgICAgICAgICAgIHUsCiAgICAgICAgICAgICAgbCwKICAgICAgICAgICAgICBmLAogICAgICAgICAgICAgIGQsCiAgICAgICAgICAgICAgYywKICAgICAgICAgICAgICBwLAogICAgICAgICAgICAgIG0sCiAgICAgICAgICAgICAgXywKICAgICAgICAgICAgICBnLAogICAgICAgICAgICAgIGIsCiAgICAgICAgICAgICAgdiwKICAgICAgICAgICAgICB5LAogICAgICAgICAgICAgIHcsCiAgICAgICAgICAgICAgaywKICAgICAgICAgICAgICB4LAogICAgICAgICAgICAgIFMsCiAgICAgICAgICAgICAgeiwKICAgICAgICAgICAgICBDOwogICAgICAgICAgICAociA9IHQuc3RhdGUpLAogICAgICAgICAgICAgIChpID0gdC5uZXh0X2luKSwKICAgICAgICAgICAgICAoeiA9IHQuaW5wdXQpLAogICAgICAgICAgICAgIChuID0gaSArICh0LmF2YWlsX2luIC0gNSkpLAogICAgICAgICAgICAgIChzID0gdC5uZXh0X291dCksCiAgICAgICAgICAgICAgKEMgPSB0Lm91dHB1dCksCiAgICAgICAgICAgICAgKGEgPSBzIC0gKGUgLSB0LmF2YWlsX291dCkpLAogICAgICAgICAgICAgIChvID0gcyArICh0LmF2YWlsX291dCAtIDI1NykpLAogICAgICAgICAgICAgIChoID0gci5kbWF4KSwKICAgICAgICAgICAgICAodSA9IHIud3NpemUpLAogICAgICAgICAgICAgIChsID0gci53aGF2ZSksCiAgICAgICAgICAgICAgKGYgPSByLnduZXh0KSwKICAgICAgICAgICAgICAoZCA9IHIud2luZG93KSwKICAgICAgICAgICAgICAoYyA9IHIuaG9sZCksCiAgICAgICAgICAgICAgKHAgPSByLmJpdHMpLAogICAgICAgICAgICAgIChtID0gci5sZW5jb2RlKSwKICAgICAgICAgICAgICAoXyA9IHIuZGlzdGNvZGUpLAogICAgICAgICAgICAgIChnID0gKDEgPDwgci5sZW5iaXRzKSAtIDEpLAogICAgICAgICAgICAgIChiID0gKDEgPDwgci5kaXN0Yml0cykgLSAxKTsKICAgICAgICAgICAgdDogZG8gewogICAgICAgICAgICAgIHAgPCAxNSAmJgogICAgICAgICAgICAgICAgKChjICs9IHpbaSsrXSA8PCBwKSwgKHAgKz0gOCksIChjICs9IHpbaSsrXSA8PCBwKSwgKHAgKz0gOCkpLAogICAgICAgICAgICAgICAgKHYgPSBtW2MgJiBnXSk7CiAgICAgICAgICAgICAgZTogZm9yICg7OykgewogICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAoKGMgPj4+PSB5ID0gdiA+Pj4gMjQpLAogICAgICAgICAgICAgICAgICAocCAtPSB5KSwKICAgICAgICAgICAgICAgICAgMCA9PT0gKHkgPSAodiA+Pj4gMTYpICYgMjU1KSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgQ1tzKytdID0gNjU1MzUgJiB2OwogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgIGlmICghKDE2ICYgeSkpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PSAoNjQgJiB5KSkgewogICAgICAgICAgICAgICAgICAgICAgdiA9IG1bKDY1NTM1ICYgdikgKyAoYyAmICgoMSA8PCB5KSAtIDEpKV07CiAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSBlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoMzIgJiB5KSB7CiAgICAgICAgICAgICAgICAgICAgICByLm1vZGUgPSAxMjsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RoIGNvZGUiKSwgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICBicmVhayB0OwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICh3ID0gNjU1MzUgJiB2KSwKICAgICAgICAgICAgICAgICAgICAoeSAmPSAxNSkgJiYKICAgICAgICAgICAgICAgICAgICAgIChwIDwgeSAmJiAoKGMgKz0geltpKytdIDw8IHApLCAocCArPSA4KSksCiAgICAgICAgICAgICAgICAgICAgICAodyArPSBjICYgKCgxIDw8IHkpIC0gMSkpLAogICAgICAgICAgICAgICAgICAgICAgKGMgPj4+PSB5KSwKICAgICAgICAgICAgICAgICAgICAgIChwIC09IHkpKSwKICAgICAgICAgICAgICAgICAgICBwIDwgMTUgJiYKICAgICAgICAgICAgICAgICAgICAgICgoYyArPSB6W2krK10gPDwgcCksCiAgICAgICAgICAgICAgICAgICAgICAocCArPSA4KSwKICAgICAgICAgICAgICAgICAgICAgIChjICs9IHpbaSsrXSA8PCBwKSwKICAgICAgICAgICAgICAgICAgICAgIChwICs9IDgpKSwKICAgICAgICAgICAgICAgICAgICAodiA9IF9bYyAmIGJdKTsKICAgICAgICAgICAgICAgICAgcjogZm9yICg7OykgewogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICgoYyA+Pj49IHkgPSB2ID4+PiAyNCksCiAgICAgICAgICAgICAgICAgICAgICAocCAtPSB5KSwKICAgICAgICAgICAgICAgICAgICAgICEoMTYgJiAoeSA9ICh2ID4+PiAxNikgJiAyNTUpKSkKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09ICg2NCAmIHkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHYgPSBfWyg2NTUzNSAmIHYpICsgKGMgJiAoKDEgPDwgeSkgLSAxKSldOwogICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZSByOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gImludmFsaWQgZGlzdGFuY2UgY29kZSIpLCAoci5tb2RlID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgKChrID0gNjU1MzUgJiB2KSwKICAgICAgICAgICAgICAgICAgICAgIHAgPCAoeSAmPSAxNSkgJiYKICAgICAgICAgICAgICAgICAgICAgICAgKChjICs9IHpbaSsrXSA8PCBwKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHAgKz0gOCkgPCB5ICYmICgoYyArPSB6W2krK10gPDwgcCksIChwICs9IDgpKSksCiAgICAgICAgICAgICAgICAgICAgICBoIDwgKGsgKz0gYyAmICgoMSA8PCB5KSAtIDEpKSkKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFjayIpLCAoci5tb2RlID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCgoYyA+Pj49IHkpLCAocCAtPSB5KSwgKHkgPSBzIC0gYSkgPCBrKSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKGwgPCAoeSA9IGsgLSB5KSAmJiByLnNhbmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrIiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGlmICgoKFMgPSBkKSwgKHggPSAwKSA9PT0gZikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCgoeCArPSB1IC0geSksIHkgPCB3KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodyAtPSB5OyAoQ1tzKytdID0gZFt4KytdKSwgLS15OyApOwogICAgICAgICAgICAgICAgICAgICAgICAgICh4ID0gcyAtIGspLCAoUyA9IEMpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGYgPCB5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoKHggKz0gdSArIGYgLSB5KSwgKHkgLT0gZikgPCB3KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodyAtPSB5OyAoQ1tzKytdID0gZFt4KytdKSwgLS15OyApOwogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoKHggPSAwKSwgZiA8IHcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHcgLT0geSA9IGY7IChDW3MrK10gPSBkW3grK10pLCAtLXk7ICk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoeCA9IHMgLSBrKSwgKFMgPSBDKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKCh4ICs9IGYgLSB5KSwgeSA8IHcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodyAtPSB5OyAoQ1tzKytdID0gZFt4KytdKSwgLS15OyApOwogICAgICAgICAgICAgICAgICAgICAgICAoeCA9IHMgLSBrKSwgKFMgPSBDKTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyAyIDwgdzsgKQogICAgICAgICAgICAgICAgICAgICAgICAoQ1tzKytdID0gU1t4KytdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAoQ1tzKytdID0gU1t4KytdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAoQ1tzKytdID0gU1t4KytdKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAodyAtPSAzKTsKICAgICAgICAgICAgICAgICAgICAgIHcgJiYgKChDW3MrK10gPSBTW3grK10pLCAxIDwgdyAmJiAoQ1tzKytdID0gU1t4KytdKSk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgICAgICAgIHggPSBzIC0gazsKICAgICAgICAgICAgICAgICAgICAgICAgKENbcysrXSA9IENbeCsrXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKENbcysrXSA9IENbeCsrXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKENbcysrXSA9IENbeCsrXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgMiA8ICh3IC09IDMpOwoKICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgICB3ICYmICgoQ1tzKytdID0gQ1t4KytdKSwgMSA8IHcgJiYgKENbcysrXSA9IENbeCsrXSkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IHdoaWxlIChpIDwgbiAmJiBzIDwgbyk7CiAgICAgICAgICAgIChpIC09IHcgPSBwID4+IDMpLAogICAgICAgICAgICAgIChjICY9ICgxIDw8IChwIC09IHcgPDwgMykpIC0gMSksCiAgICAgICAgICAgICAgKHQubmV4dF9pbiA9IGkpLAogICAgICAgICAgICAgICh0Lm5leHRfb3V0ID0gcyksCiAgICAgICAgICAgICAgKHQuYXZhaWxfaW4gPSBpIDwgbiA/IG4gLSBpICsgNSA6IDUgLSAoaSAtIG4pKSwKICAgICAgICAgICAgICAodC5hdmFpbF9vdXQgPSBzIDwgbyA/IG8gLSBzICsgMjU3IDogMjU3IC0gKHMgLSBvKSksCiAgICAgICAgICAgICAgKHIuaG9sZCA9IGMpLAogICAgICAgICAgICAgIChyLmJpdHMgPSBwKTsKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB7fSwKICAgICAgXSwKICAgICAgNDk6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgdmFyIEkgPSB0KCIuLi91dGlscy9jb21tb24iKSwKICAgICAgICAgICAgTyA9IHQoIi4vYWRsZXIzMiIpLAogICAgICAgICAgICBCID0gdCgiLi9jcmMzMiIpLAogICAgICAgICAgICBSID0gdCgiLi9pbmZmYXN0IiksCiAgICAgICAgICAgIFQgPSB0KCIuL2luZnRyZWVzIiksCiAgICAgICAgICAgIEQgPSAxLAogICAgICAgICAgICBGID0gMiwKICAgICAgICAgICAgTiA9IDAsCiAgICAgICAgICAgIFUgPSAtMiwKICAgICAgICAgICAgUCA9IDEsCiAgICAgICAgICAgIGkgPSA4NTIsCiAgICAgICAgICAgIG4gPSA1OTI7CiAgICAgICAgICBmdW5jdGlvbiBMKHQpIHsKICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICAoKHQgPj4+IDI0KSAmIDI1NSkgKwogICAgICAgICAgICAgICgodCA+Pj4gOCkgJiA2NTI4MCkgKwogICAgICAgICAgICAgICgoNjUyODAgJiB0KSA8PCA4KSArCiAgICAgICAgICAgICAgKCgyNTUgJiB0KSA8PCAyNCkKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIHMoKSB7CiAgICAgICAgICAgICh0aGlzLm1vZGUgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5sYXN0ID0gITEpLAogICAgICAgICAgICAgICh0aGlzLndyYXAgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5oYXZlZGljdCA9ICExKSwKICAgICAgICAgICAgICAodGhpcy5mbGFncyA9IDApLAogICAgICAgICAgICAgICh0aGlzLmRtYXggPSAwKSwKICAgICAgICAgICAgICAodGhpcy5jaGVjayA9IDApLAogICAgICAgICAgICAgICh0aGlzLnRvdGFsID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuaGVhZCA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLndiaXRzID0gMCksCiAgICAgICAgICAgICAgKHRoaXMud3NpemUgPSAwKSwKICAgICAgICAgICAgICAodGhpcy53aGF2ZSA9IDApLAogICAgICAgICAgICAgICh0aGlzLnduZXh0ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMud2luZG93ID0gbnVsbCksCiAgICAgICAgICAgICAgKHRoaXMuaG9sZCA9IDApLAogICAgICAgICAgICAgICh0aGlzLmJpdHMgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5sZW5ndGggPSAwKSwKICAgICAgICAgICAgICAodGhpcy5vZmZzZXQgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5leHRyYSA9IDApLAogICAgICAgICAgICAgICh0aGlzLmxlbmNvZGUgPSBudWxsKSwKICAgICAgICAgICAgICAodGhpcy5kaXN0Y29kZSA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLmxlbmJpdHMgPSAwKSwKICAgICAgICAgICAgICAodGhpcy5kaXN0Yml0cyA9IDApLAogICAgICAgICAgICAgICh0aGlzLm5jb2RlID0gMCksCiAgICAgICAgICAgICAgKHRoaXMubmxlbiA9IDApLAogICAgICAgICAgICAgICh0aGlzLm5kaXN0ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuaGF2ZSA9IDApLAogICAgICAgICAgICAgICh0aGlzLm5leHQgPSBudWxsKSwKICAgICAgICAgICAgICAodGhpcy5sZW5zID0gbmV3IEkuQnVmMTYoMzIwKSksCiAgICAgICAgICAgICAgKHRoaXMud29yayA9IG5ldyBJLkJ1ZjE2KDI4OCkpLAogICAgICAgICAgICAgICh0aGlzLmxlbmR5biA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLmRpc3RkeW4gPSBudWxsKSwKICAgICAgICAgICAgICAodGhpcy5zYW5lID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuYmFjayA9IDApLAogICAgICAgICAgICAgICh0aGlzLndhcyA9IDApOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gYSh0KSB7CiAgICAgICAgICAgIHZhciBlOwogICAgICAgICAgICByZXR1cm4gdCAmJiB0LnN0YXRlCiAgICAgICAgICAgICAgPyAoKGUgPSB0LnN0YXRlKSwKICAgICAgICAgICAgICAgICh0LnRvdGFsX2luID0gdC50b3RhbF9vdXQgPSBlLnRvdGFsID0gMCksCiAgICAgICAgICAgICAgICAodC5tc2cgPSAiIiksCiAgICAgICAgICAgICAgICBlLndyYXAgJiYgKHQuYWRsZXIgPSAxICYgZS53cmFwKSwKICAgICAgICAgICAgICAgIChlLm1vZGUgPSBQKSwKICAgICAgICAgICAgICAgIChlLmxhc3QgPSAwKSwKICAgICAgICAgICAgICAgIChlLmhhdmVkaWN0ID0gMCksCiAgICAgICAgICAgICAgICAoZS5kbWF4ID0gMzI3NjgpLAogICAgICAgICAgICAgICAgKGUuaGVhZCA9IG51bGwpLAogICAgICAgICAgICAgICAgKGUuaG9sZCA9IDApLAogICAgICAgICAgICAgICAgKGUuYml0cyA9IDApLAogICAgICAgICAgICAgICAgKGUubGVuY29kZSA9IGUubGVuZHluID0gbmV3IEkuQnVmMzIoaSkpLAogICAgICAgICAgICAgICAgKGUuZGlzdGNvZGUgPSBlLmRpc3RkeW4gPSBuZXcgSS5CdWYzMihuKSksCiAgICAgICAgICAgICAgICAoZS5zYW5lID0gMSksCiAgICAgICAgICAgICAgICAoZS5iYWNrID0gLTEpLAogICAgICAgICAgICAgICAgTikKICAgICAgICAgICAgICA6IFU7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBvKHQpIHsKICAgICAgICAgICAgdmFyIGU7CiAgICAgICAgICAgIHJldHVybiB0ICYmIHQuc3RhdGUKICAgICAgICAgICAgICA/ICgoKGUgPSB0LnN0YXRlKS53c2l6ZSA9IDApLCAoZS53aGF2ZSA9IDApLCAoZS53bmV4dCA9IDApLCBhKHQpKQogICAgICAgICAgICAgIDogVTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIGgodCwgZSkgewogICAgICAgICAgICB2YXIgciwgaTsKICAgICAgICAgICAgcmV0dXJuIHQgJiYgdC5zdGF0ZQogICAgICAgICAgICAgID8gKChpID0gdC5zdGF0ZSksCiAgICAgICAgICAgICAgICBlIDwgMAogICAgICAgICAgICAgICAgICA/ICgociA9IDApLCAoZSA9IC1lKSkKICAgICAgICAgICAgICAgICAgOiAoKHIgPSAxICsgKGUgPj4gNCkpLCBlIDwgNDggJiYgKGUgJj0gMTUpKSwKICAgICAgICAgICAgICAgIGUgJiYgKGUgPCA4IHx8IDE1IDwgZSkKICAgICAgICAgICAgICAgICAgPyBVCiAgICAgICAgICAgICAgICAgIDogKG51bGwgIT09IGkud2luZG93ICYmIGkud2JpdHMgIT09IGUgJiYgKGkud2luZG93ID0gbnVsbCksCiAgICAgICAgICAgICAgICAgICAgKGkud3JhcCA9IHIpLAogICAgICAgICAgICAgICAgICAgIChpLndiaXRzID0gZSksCiAgICAgICAgICAgICAgICAgICAgbyh0KSkpCiAgICAgICAgICAgICAgOiBVOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gdSh0LCBlKSB7CiAgICAgICAgICAgIHZhciByLCBpOwogICAgICAgICAgICByZXR1cm4gdAogICAgICAgICAgICAgID8gKChpID0gbmV3IHMoKSksCiAgICAgICAgICAgICAgICAoKHQuc3RhdGUgPSBpKS53aW5kb3cgPSBudWxsKSwKICAgICAgICAgICAgICAgIChyID0gaCh0LCBlKSkgIT09IE4gJiYgKHQuc3RhdGUgPSBudWxsKSwKICAgICAgICAgICAgICAgIHIpCiAgICAgICAgICAgICAgOiBVOwogICAgICAgICAgfQogICAgICAgICAgdmFyIGwsCiAgICAgICAgICAgIGYsCiAgICAgICAgICAgIGQgPSAhMDsKICAgICAgICAgIGZ1bmN0aW9uIGoodCkgewogICAgICAgICAgICBpZiAoZCkgewogICAgICAgICAgICAgIHZhciBlOwogICAgICAgICAgICAgIGZvciAobCA9IG5ldyBJLkJ1ZjMyKDUxMiksIGYgPSBuZXcgSS5CdWYzMigzMiksIGUgPSAwOyBlIDwgMTQ0OyApCiAgICAgICAgICAgICAgICB0LmxlbnNbZSsrXSA9IDg7CiAgICAgICAgICAgICAgZm9yICg7IGUgPCAyNTY7ICkgdC5sZW5zW2UrK10gPSA5OwogICAgICAgICAgICAgIGZvciAoOyBlIDwgMjgwOyApIHQubGVuc1tlKytdID0gNzsKICAgICAgICAgICAgICBmb3IgKDsgZSA8IDI4ODsgKSB0LmxlbnNbZSsrXSA9IDg7CiAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgIFQoRCwgdC5sZW5zLCAwLCAyODgsIGwsIDAsIHQud29yaywgeyBiaXRzOiA5IH0pLCBlID0gMDsKICAgICAgICAgICAgICAgIGUgPCAzMjsKCiAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgdC5sZW5zW2UrK10gPSA1OwogICAgICAgICAgICAgIFQoRiwgdC5sZW5zLCAwLCAzMiwgZiwgMCwgdC53b3JrLCB7IGJpdHM6IDUgfSksIChkID0gITEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgICh0LmxlbmNvZGUgPSBsKSwKICAgICAgICAgICAgICAodC5sZW5iaXRzID0gOSksCiAgICAgICAgICAgICAgKHQuZGlzdGNvZGUgPSBmKSwKICAgICAgICAgICAgICAodC5kaXN0Yml0cyA9IDUpOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gWih0LCBlLCByLCBpKSB7CiAgICAgICAgICAgIHZhciBuLAogICAgICAgICAgICAgIHMgPSB0LnN0YXRlOwogICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgIG51bGwgPT09IHMud2luZG93ICYmCiAgICAgICAgICAgICAgICAoKHMud3NpemUgPSAxIDw8IHMud2JpdHMpLAogICAgICAgICAgICAgICAgKHMud25leHQgPSAwKSwKICAgICAgICAgICAgICAgIChzLndoYXZlID0gMCksCiAgICAgICAgICAgICAgICAocy53aW5kb3cgPSBuZXcgSS5CdWY4KHMud3NpemUpKSksCiAgICAgICAgICAgICAgaSA+PSBzLndzaXplCiAgICAgICAgICAgICAgICA/IChJLmFycmF5U2V0KHMud2luZG93LCBlLCByIC0gcy53c2l6ZSwgcy53c2l6ZSwgMCksCiAgICAgICAgICAgICAgICAgIChzLnduZXh0ID0gMCksCiAgICAgICAgICAgICAgICAgIChzLndoYXZlID0gcy53c2l6ZSkpCiAgICAgICAgICAgICAgICA6IChpIDwgKG4gPSBzLndzaXplIC0gcy53bmV4dCkgJiYgKG4gPSBpKSwKICAgICAgICAgICAgICAgICAgSS5hcnJheVNldChzLndpbmRvdywgZSwgciAtIGksIG4sIHMud25leHQpLAogICAgICAgICAgICAgICAgICAoaSAtPSBuKQogICAgICAgICAgICAgICAgICAgID8gKEkuYXJyYXlTZXQocy53aW5kb3csIGUsIHIgLSBpLCBpLCAwKSwKICAgICAgICAgICAgICAgICAgICAgIChzLnduZXh0ID0gaSksCiAgICAgICAgICAgICAgICAgICAgICAocy53aGF2ZSA9IHMud3NpemUpKQogICAgICAgICAgICAgICAgICAgIDogKChzLnduZXh0ICs9IG4pLAogICAgICAgICAgICAgICAgICAgICAgcy53bmV4dCA9PT0gcy53c2l6ZSAmJiAocy53bmV4dCA9IDApLAogICAgICAgICAgICAgICAgICAgICAgcy53aGF2ZSA8IHMud3NpemUgJiYgKHMud2hhdmUgKz0gbikpKSwKICAgICAgICAgICAgICAwCiAgICAgICAgICAgICk7CiAgICAgICAgICB9CiAgICAgICAgICAoci5pbmZsYXRlUmVzZXQgPSBvKSwKICAgICAgICAgICAgKHIuaW5mbGF0ZVJlc2V0MiA9IGgpLAogICAgICAgICAgICAoci5pbmZsYXRlUmVzZXRLZWVwID0gYSksCiAgICAgICAgICAgIChyLmluZmxhdGVJbml0ID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICByZXR1cm4gdSh0LCAxNSk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5pbmZsYXRlSW5pdDIgPSB1KSwKICAgICAgICAgICAgKHIuaW5mbGF0ZSA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgdmFyIHIsCiAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICAgIHMsCiAgICAgICAgICAgICAgICBhLAogICAgICAgICAgICAgICAgbywKICAgICAgICAgICAgICAgIGgsCiAgICAgICAgICAgICAgICB1LAogICAgICAgICAgICAgICAgbCwKICAgICAgICAgICAgICAgIGYsCiAgICAgICAgICAgICAgICBkLAogICAgICAgICAgICAgICAgYywKICAgICAgICAgICAgICAgIHAsCiAgICAgICAgICAgICAgICBtLAogICAgICAgICAgICAgICAgXywKICAgICAgICAgICAgICAgIGcsCiAgICAgICAgICAgICAgICBiLAogICAgICAgICAgICAgICAgdiwKICAgICAgICAgICAgICAgIHksCiAgICAgICAgICAgICAgICB3LAogICAgICAgICAgICAgICAgaywKICAgICAgICAgICAgICAgIHgsCiAgICAgICAgICAgICAgICBTLAogICAgICAgICAgICAgICAgeiwKICAgICAgICAgICAgICAgIEMgPSAwLAogICAgICAgICAgICAgICAgRSA9IG5ldyBJLkJ1ZjgoNCksCiAgICAgICAgICAgICAgICBBID0gWwogICAgICAgICAgICAgICAgICAxNiwgMTcsIDE4LCAwLCA4LCA3LCA5LCA2LCAxMCwgNSwgMTEsIDQsIDEyLCAzLCAxMywgMiwgMTQsIDEsCiAgICAgICAgICAgICAgICAgIDE1LAogICAgICAgICAgICAgICAgXTsKICAgICAgICAgICAgICBpZiAoIXQgfHwgIXQuc3RhdGUgfHwgIXQub3V0cHV0IHx8ICghdC5pbnB1dCAmJiAwICE9PSB0LmF2YWlsX2luKSkKICAgICAgICAgICAgICAgIHJldHVybiBVOwogICAgICAgICAgICAgIDEyID09PSAociA9IHQuc3RhdGUpLm1vZGUgJiYgKHIubW9kZSA9IDEzKSwKICAgICAgICAgICAgICAgIChhID0gdC5uZXh0X291dCksCiAgICAgICAgICAgICAgICAobiA9IHQub3V0cHV0KSwKICAgICAgICAgICAgICAgIChoID0gdC5hdmFpbF9vdXQpLAogICAgICAgICAgICAgICAgKHMgPSB0Lm5leHRfaW4pLAogICAgICAgICAgICAgICAgKGkgPSB0LmlucHV0KSwKICAgICAgICAgICAgICAgIChvID0gdC5hdmFpbF9pbiksCiAgICAgICAgICAgICAgICAodSA9IHIuaG9sZCksCiAgICAgICAgICAgICAgICAobCA9IHIuYml0cyksCiAgICAgICAgICAgICAgICAoZiA9IG8pLAogICAgICAgICAgICAgICAgKGQgPSBoKSwKICAgICAgICAgICAgICAgICh4ID0gTik7CiAgICAgICAgICAgICAgdDogZm9yICg7OykKICAgICAgICAgICAgICAgIHN3aXRjaCAoci5tb2RlKSB7CiAgICAgICAgICAgICAgICAgIGNhc2UgUDoKICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gci53cmFwKSB7CiAgICAgICAgICAgICAgICAgICAgICByLm1vZGUgPSAxMzsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBmb3IgKDsgbCA8IDE2OyApIHsKICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgby0tLCAodSArPSBpW3MrK10gPDwgbCksIChsICs9IDgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoMiAmIHIud3JhcCAmJiAzNTYxNSA9PT0gdSkgewogICAgICAgICAgICAgICAgICAgICAgKEVbKHIuY2hlY2sgPSAwKV0gPSAyNTUgJiB1KSwKICAgICAgICAgICAgICAgICAgICAgICAgKEVbMV0gPSAodSA+Pj4gOCkgJiAyNTUpLAogICAgICAgICAgICAgICAgICAgICAgICAoci5jaGVjayA9IEIoci5jaGVjaywgRSwgMiwgMCkpLAogICAgICAgICAgICAgICAgICAgICAgICAobCA9IHUgPSAwKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHIubW9kZSA9IDIpOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICgoci5mbGFncyA9IDApLAogICAgICAgICAgICAgICAgICAgICAgci5oZWFkICYmIChyLmhlYWQuZG9uZSA9ICExKSwKICAgICAgICAgICAgICAgICAgICAgICEoMSAmIHIud3JhcCkgfHwgKCgoMjU1ICYgdSkgPDwgOCkgKyAodSA+PiA4KSkgJSAzMSkKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJpbmNvcnJlY3QgaGVhZGVyIGNoZWNrIiksIChyLm1vZGUgPSAzMCk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKDggIT0gKDE1ICYgdSkpIHsKICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJ1bmtub3duIGNvbXByZXNzaW9uIG1ldGhvZCIpLCAoci5tb2RlID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICgoKGwgLT0gNCksIChrID0gOCArICgxNSAmICh1ID4+Pj0gNCkpKSwgMCA9PT0gci53Yml0cykpCiAgICAgICAgICAgICAgICAgICAgICByLndiaXRzID0gazsKICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChrID4gci53Yml0cykgewogICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gImludmFsaWQgd2luZG93IHNpemUiKSwgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAoci5kbWF4ID0gMSA8PCBrKSwKICAgICAgICAgICAgICAgICAgICAgICh0LmFkbGVyID0gci5jaGVjayA9IDEpLAogICAgICAgICAgICAgICAgICAgICAgKHIubW9kZSA9IDUxMiAmIHUgPyAxMCA6IDEyKSwKICAgICAgICAgICAgICAgICAgICAgIChsID0gdSA9IDApOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgZm9yICg7IGwgPCAxNjsgKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgKz0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCgoci5mbGFncyA9IHUpLCA4ICE9ICgyNTUgJiByLmZsYWdzKSkpIHsKICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJ1bmtub3duIGNvbXByZXNzaW9uIG1ldGhvZCIpLCAoci5tb2RlID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICg1NzM0NCAmIHIuZmxhZ3MpIHsKICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJ1bmtub3duIGhlYWRlciBmbGFncyBzZXQiKSwgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByLmhlYWQgJiYgKHIuaGVhZC50ZXh0ID0gKHUgPj4gOCkgJiAxKSwKICAgICAgICAgICAgICAgICAgICAgIDUxMiAmIHIuZmxhZ3MgJiYKICAgICAgICAgICAgICAgICAgICAgICAgKChFWzBdID0gMjU1ICYgdSksCiAgICAgICAgICAgICAgICAgICAgICAgIChFWzFdID0gKHUgPj4+IDgpICYgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgKHIuY2hlY2sgPSBCKHIuY2hlY2ssIEUsIDIsIDApKSksCiAgICAgICAgICAgICAgICAgICAgICAobCA9IHUgPSAwKSwKICAgICAgICAgICAgICAgICAgICAgIChyLm1vZGUgPSAzKTsKICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgIGZvciAoOyBsIDwgMzI7ICkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgICBvLS0sICh1ICs9IGlbcysrXSA8PCBsKSwgKGwgKz0gOCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHIuaGVhZCAmJiAoci5oZWFkLnRpbWUgPSB1KSwKICAgICAgICAgICAgICAgICAgICAgIDUxMiAmIHIuZmxhZ3MgJiYKICAgICAgICAgICAgICAgICAgICAgICAgKChFWzBdID0gMjU1ICYgdSksCiAgICAgICAgICAgICAgICAgICAgICAgIChFWzFdID0gKHUgPj4+IDgpICYgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgKEVbMl0gPSAodSA+Pj4gMTYpICYgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgKEVbM10gPSAodSA+Pj4gMjQpICYgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgKHIuY2hlY2sgPSBCKHIuY2hlY2ssIEUsIDQsIDApKSksCiAgICAgICAgICAgICAgICAgICAgICAobCA9IHUgPSAwKSwKICAgICAgICAgICAgICAgICAgICAgIChyLm1vZGUgPSA0KTsKICAgICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgIGZvciAoOyBsIDwgMTY7ICkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgICBvLS0sICh1ICs9IGlbcysrXSA8PCBsKSwgKGwgKz0gOCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHIuaGVhZCAmJiAoKHIuaGVhZC54ZmxhZ3MgPSAyNTUgJiB1KSwgKHIuaGVhZC5vcyA9IHUgPj4gOCkpLAogICAgICAgICAgICAgICAgICAgICAgNTEyICYgci5mbGFncyAmJgogICAgICAgICAgICAgICAgICAgICAgICAoKEVbMF0gPSAyNTUgJiB1KSwKICAgICAgICAgICAgICAgICAgICAgICAgKEVbMV0gPSAodSA+Pj4gOCkgJiAyNTUpLAogICAgICAgICAgICAgICAgICAgICAgICAoci5jaGVjayA9IEIoci5jaGVjaywgRSwgMiwgMCkpKSwKICAgICAgICAgICAgICAgICAgICAgIChsID0gdSA9IDApLAogICAgICAgICAgICAgICAgICAgICAgKHIubW9kZSA9IDUpOwogICAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgICAgaWYgKDEwMjQgJiByLmZsYWdzKSB7CiAgICAgICAgICAgICAgICAgICAgICBmb3IgKDsgbCA8IDE2OyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgKz0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIChyLmxlbmd0aCA9IHUpLAogICAgICAgICAgICAgICAgICAgICAgICByLmhlYWQgJiYgKHIuaGVhZC5leHRyYV9sZW4gPSB1KSwKICAgICAgICAgICAgICAgICAgICAgICAgNTEyICYgci5mbGFncyAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICgoRVswXSA9IDI1NSAmIHUpLAogICAgICAgICAgICAgICAgICAgICAgICAgIChFWzFdID0gKHUgPj4+IDgpICYgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAoci5jaGVjayA9IEIoci5jaGVjaywgRSwgMiwgMCkpKSwKICAgICAgICAgICAgICAgICAgICAgICAgKGwgPSB1ID0gMCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHIuaGVhZCAmJiAoci5oZWFkLmV4dHJhID0gbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgci5tb2RlID0gNjsKICAgICAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgIDEwMjQgJiByLmZsYWdzICYmCiAgICAgICAgICAgICAgICAgICAgICAobyA8IChjID0gci5sZW5ndGgpICYmIChjID0gbyksCiAgICAgICAgICAgICAgICAgICAgICBjICYmCiAgICAgICAgICAgICAgICAgICAgICAgIChyLmhlYWQgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAoKGsgPSByLmhlYWQuZXh0cmFfbGVuIC0gci5sZW5ndGgpLAogICAgICAgICAgICAgICAgICAgICAgICAgIHIuaGVhZC5leHRyYSB8fAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKHIuaGVhZC5leHRyYSA9IG5ldyBBcnJheShyLmhlYWQuZXh0cmFfbGVuKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgSS5hcnJheVNldChyLmhlYWQuZXh0cmEsIGksIHMsIGMsIGspKSwKICAgICAgICAgICAgICAgICAgICAgICAgNTEyICYgci5mbGFncyAmJiAoci5jaGVjayA9IEIoci5jaGVjaywgaSwgYywgcykpLAogICAgICAgICAgICAgICAgICAgICAgICAobyAtPSBjKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHMgKz0gYyksCiAgICAgICAgICAgICAgICAgICAgICAgIChyLmxlbmd0aCAtPSBjKSksCiAgICAgICAgICAgICAgICAgICAgICByLmxlbmd0aCkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICBicmVhayB0OwogICAgICAgICAgICAgICAgICAgIChyLmxlbmd0aCA9IDApLCAoci5tb2RlID0gNyk7CiAgICAgICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgICAgICBpZiAoMjA0OCAmIHIuZmxhZ3MpIHsKICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgICAgICAgICAgYyA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgIChrID0gaVtzICsgYysrXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgci5oZWFkICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLmxlbmd0aCA8IDY1NTM2ICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoci5oZWFkLm5hbWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShrKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgayAmJiBjIDwgbzsKCiAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICAoNTEyICYgci5mbGFncyAmJiAoci5jaGVjayA9IEIoci5jaGVjaywgaSwgYywgcykpLAogICAgICAgICAgICAgICAgICAgICAgICAobyAtPSBjKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHMgKz0gYyksCiAgICAgICAgICAgICAgICAgICAgICAgIGspCiAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHIuaGVhZCAmJiAoci5oZWFkLm5hbWUgPSBudWxsKTsKICAgICAgICAgICAgICAgICAgICAoci5sZW5ndGggPSAwKSwgKHIubW9kZSA9IDgpOwogICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgaWYgKDQwOTYgJiByLmZsYWdzKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgICAgICAgIGMgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAoayA9IGlbcyArIGMrK10pLAogICAgICAgICAgICAgICAgICAgICAgICAgIHIuaGVhZCAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgayAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgci5sZW5ndGggPCA2NTUzNiAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgKHIuaGVhZC5jb21tZW50ICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoaykpLAogICAgICAgICAgICAgICAgICAgICAgICAgIGsgJiYgYyA8IG87CgogICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgKDUxMiAmIHIuZmxhZ3MgJiYgKHIuY2hlY2sgPSBCKHIuY2hlY2ssIGksIGMsIHMpKSwKICAgICAgICAgICAgICAgICAgICAgICAgKG8gLT0gYyksCiAgICAgICAgICAgICAgICAgICAgICAgIChzICs9IGMpLAogICAgICAgICAgICAgICAgICAgICAgICBrKQogICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICBicmVhayB0OwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSByLmhlYWQgJiYgKHIuaGVhZC5jb21tZW50ID0gbnVsbCk7CiAgICAgICAgICAgICAgICAgICAgci5tb2RlID0gOTsKICAgICAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgICAgIGlmICg1MTIgJiByLmZsYWdzKSB7CiAgICAgICAgICAgICAgICAgICAgICBmb3IgKDsgbCA8IDE2OyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgKz0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGlmICh1ICE9PSAoNjU1MzUgJiByLmNoZWNrKSkgewogICAgICAgICAgICAgICAgICAgICAgICAodC5tc2cgPSAiaGVhZGVyIGNyYyBtaXNtYXRjaCIpLCAoci5tb2RlID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGwgPSB1ID0gMDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgci5oZWFkICYmCiAgICAgICAgICAgICAgICAgICAgICAoKHIuaGVhZC5oY3JjID0gKHIuZmxhZ3MgPj4gOSkgJiAxKSwgKHIuaGVhZC5kb25lID0gITApKSwKICAgICAgICAgICAgICAgICAgICAgICh0LmFkbGVyID0gci5jaGVjayA9IDApLAogICAgICAgICAgICAgICAgICAgICAgKHIubW9kZSA9IDEyKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICAgICAgICBmb3IgKDsgbCA8IDMyOyApIHsKICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgby0tLCAodSArPSBpW3MrK10gPDwgbCksIChsICs9IDgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAodC5hZGxlciA9IHIuY2hlY2sgPSBMKHUpKSwgKGwgPSB1ID0gMCksIChyLm1vZGUgPSAxMSk7CiAgICAgICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IHIuaGF2ZWRpY3QpCiAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgICAgICAgICAodC5uZXh0X291dCA9IGEpLAogICAgICAgICAgICAgICAgICAgICAgICAodC5hdmFpbF9vdXQgPSBoKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHQubmV4dF9pbiA9IHMpLAogICAgICAgICAgICAgICAgICAgICAgICAodC5hdmFpbF9pbiA9IG8pLAogICAgICAgICAgICAgICAgICAgICAgICAoci5ob2xkID0gdSksCiAgICAgICAgICAgICAgICAgICAgICAgIChyLmJpdHMgPSBsKSwKICAgICAgICAgICAgICAgICAgICAgICAgMgogICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAodC5hZGxlciA9IHIuY2hlY2sgPSAxKSwgKHIubW9kZSA9IDEyKTsKICAgICAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgICAgICBpZiAoNSA9PT0gZSB8fCA2ID09PSBlKSBicmVhayB0OwogICAgICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgICAgIGlmIChyLmxhc3QpIHsKICAgICAgICAgICAgICAgICAgICAgICh1ID4+Pj0gNyAmIGwpLCAobCAtPSA3ICYgbCksIChyLm1vZGUgPSAyNyk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZm9yICg7IGwgPCAzOyApIHsKICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgby0tLCAodSArPSBpW3MrK10gPDwgbCksIChsICs9IDgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCgoci5sYXN0ID0gMSAmIHUpLCAobCAtPSAxKSwgMyAmICh1ID4+Pj0gMSkpKSB7CiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgIHIubW9kZSA9IDE0OwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChqKHIpLCAoci5tb2RlID0gMjApLCA2ICE9PSBlKSkgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICh1ID4+Pj0gMiksIChsIC09IDIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICByLm1vZGUgPSAxNzsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJpbnZhbGlkIGJsb2NrIHR5cGUiKSwgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKHUgPj4+PSAyKSwgKGwgLT0gMik7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICAgICAgZm9yICh1ID4+Pj0gNyAmIGwsIGwgLT0gNyAmIGw7IGwgPCAzMjsgKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgKz0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCg2NTUzNSAmIHUpICE9ICgodSA+Pj4gMTYpIF4gNjU1MzUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAodC5tc2cgPSAiaW52YWxpZCBzdG9yZWQgYmxvY2sgbGVuZ3RocyIpLCAoci5tb2RlID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICgoci5sZW5ndGggPSA2NTUzNSAmIHUpLAogICAgICAgICAgICAgICAgICAgICAgKGwgPSB1ID0gMCksCiAgICAgICAgICAgICAgICAgICAgICAoci5tb2RlID0gMTUpLAogICAgICAgICAgICAgICAgICAgICAgNiA9PT0gZSkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgICBicmVhayB0OwogICAgICAgICAgICAgICAgICBjYXNlIDE1OgogICAgICAgICAgICAgICAgICAgIHIubW9kZSA9IDE2OwogICAgICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgICAgIGlmICgoYyA9IHIubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKChvIDwgYyAmJiAoYyA9IG8pLCBoIDwgYyAmJiAoYyA9IGgpLCAwID09PSBjKSkKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgIEkuYXJyYXlTZXQobiwgaSwgcywgYywgYSksCiAgICAgICAgICAgICAgICAgICAgICAgIChvIC09IGMpLAogICAgICAgICAgICAgICAgICAgICAgICAocyArPSBjKSwKICAgICAgICAgICAgICAgICAgICAgICAgKGggLT0gYyksCiAgICAgICAgICAgICAgICAgICAgICAgIChhICs9IGMpLAogICAgICAgICAgICAgICAgICAgICAgICAoci5sZW5ndGggLT0gYyk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgci5tb2RlID0gMTI7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgIGNhc2UgMTc6CiAgICAgICAgICAgICAgICAgICAgZm9yICg7IGwgPCAxNDsgKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgKz0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgKChyLm5sZW4gPSAyNTcgKyAoMzEgJiB1KSksCiAgICAgICAgICAgICAgICAgICAgICAodSA+Pj49IDUpLAogICAgICAgICAgICAgICAgICAgICAgKGwgLT0gNSksCiAgICAgICAgICAgICAgICAgICAgICAoci5uZGlzdCA9IDEgKyAoMzEgJiB1KSksCiAgICAgICAgICAgICAgICAgICAgICAodSA+Pj49IDUpLAogICAgICAgICAgICAgICAgICAgICAgKGwgLT0gNSksCiAgICAgICAgICAgICAgICAgICAgICAoci5uY29kZSA9IDQgKyAoMTUgJiB1KSksCiAgICAgICAgICAgICAgICAgICAgICAodSA+Pj49IDQpLAogICAgICAgICAgICAgICAgICAgICAgKGwgLT0gNCksCiAgICAgICAgICAgICAgICAgICAgICAyODYgPCByLm5sZW4gfHwgMzAgPCByLm5kaXN0KQogICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gInRvbyBtYW55IGxlbmd0aCBvciBkaXN0YW5jZSBzeW1ib2xzIiksCiAgICAgICAgICAgICAgICAgICAgICAgIChyLm1vZGUgPSAzMCk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKHIuaGF2ZSA9IDApLCAoci5tb2RlID0gMTgpOwogICAgICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgICAgIGZvciAoOyByLmhhdmUgPCByLm5jb2RlOyApIHsKICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyBsIDwgMzsgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgICBvLS0sICh1ICs9IGlbcysrXSA8PCBsKSwgKGwgKz0gOCk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAoci5sZW5zW0Fbci5oYXZlKytdXSA9IDcgJiB1KSwgKHUgPj4+PSAzKSwgKGwgLT0gMyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGZvciAoOyByLmhhdmUgPCAxOTsgKSByLmxlbnNbQVtyLmhhdmUrK11dID0gMDsKICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAoKHIubGVuY29kZSA9IHIubGVuZHluKSwKICAgICAgICAgICAgICAgICAgICAgIChyLmxlbmJpdHMgPSA3KSwKICAgICAgICAgICAgICAgICAgICAgIChTID0geyBiaXRzOiByLmxlbmJpdHMgfSksCiAgICAgICAgICAgICAgICAgICAgICAoeCA9IFQoMCwgci5sZW5zLCAwLCAxOSwgci5sZW5jb2RlLCAwLCByLndvcmssIFMpKSwKICAgICAgICAgICAgICAgICAgICAgIChyLmxlbmJpdHMgPSBTLmJpdHMpLAogICAgICAgICAgICAgICAgICAgICAgeCkKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJpbnZhbGlkIGNvZGUgbGVuZ3RocyBzZXQiKSwgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAoci5oYXZlID0gMCksIChyLm1vZGUgPSAxOSk7CiAgICAgICAgICAgICAgICAgIGNhc2UgMTk6CiAgICAgICAgICAgICAgICAgICAgZm9yICg7IHIuaGF2ZSA8IHIubmxlbiArIHIubmRpc3Q7ICkgewogICAgICAgICAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgICAgICAgICAoZyA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgKChDID0gci5sZW5jb2RlW3UgJiAoKDEgPDwgci5sZW5iaXRzKSAtIDEpXSkgPj4+IDE2KSAmCiAgICAgICAgICAgICAgICAgICAgICAgICAgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAoYiA9IDY1NTM1ICYgQyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgISgoXyA9IEMgPj4+IDI0KSA8PSBsKTsKCiAgICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgKz0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGlmIChiIDwgMTYpICh1ID4+Pj0gXyksIChsIC09IF8pLCAoci5sZW5zW3IuaGF2ZSsrXSA9IGIpOwogICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgxNiA9PT0gYikgewogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeiA9IF8gKyAyOyBsIDwgejsgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgKz0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCgodSA+Pj49IF8pLCAobCAtPSBfKSwgMCA9PT0gci5oYXZlKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gImludmFsaWQgYml0IGxlbmd0aCByZXBlYXQiKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAoayA9IHIubGVuc1tyLmhhdmUgLSAxXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYyA9IDMgKyAoMyAmIHUpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICh1ID4+Pj0gMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAobCAtPSAyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgxNyA9PT0gYikgewogICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeiA9IF8gKyAzOyBsIDwgejsgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgKz0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgKGwgLT0gXyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoayA9IDApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKGMgPSAzICsgKDcgJiAodSA+Pj49IF8pKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAodSA+Pj49IDMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKGwgLT0gMyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh6ID0gXyArIDc7IGwgPCB6OyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgby0tLCAodSArPSBpW3MrK10gPDwgbCksIChsICs9IDgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAobCAtPSBfKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIChrID0gMCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYyA9IDExICsgKDEyNyAmICh1ID4+Pj0gXykpKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICh1ID4+Pj0gNyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAobCAtPSA3KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoci5oYXZlICsgYyA+IHIubmxlbiArIHIubmRpc3QpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAodC5tc2cgPSAiaW52YWxpZCBiaXQgbGVuZ3RoIHJlcGVhdCIpLCAoci5tb2RlID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyBjLS07ICkgci5sZW5zW3IuaGF2ZSsrXSA9IGs7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICgzMCA9PT0gci5tb2RlKSBicmVhazsKICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gci5sZW5zWzI1Nl0pIHsKICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJpbnZhbGlkIGNvZGUgLS0gbWlzc2luZyBlbmQtb2YtYmxvY2siKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAoKHIubGVuYml0cyA9IDkpLAogICAgICAgICAgICAgICAgICAgICAgKFMgPSB7IGJpdHM6IHIubGVuYml0cyB9KSwKICAgICAgICAgICAgICAgICAgICAgICh4ID0gVChELCByLmxlbnMsIDAsIHIubmxlbiwgci5sZW5jb2RlLCAwLCByLndvcmssIFMpKSwKICAgICAgICAgICAgICAgICAgICAgIChyLmxlbmJpdHMgPSBTLmJpdHMpLAogICAgICAgICAgICAgICAgICAgICAgeCkKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJpbnZhbGlkIGxpdGVyYWwvbGVuZ3RocyBzZXQiKSwgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAoKHIuZGlzdGJpdHMgPSA2KSwKICAgICAgICAgICAgICAgICAgICAgIChyLmRpc3Rjb2RlID0gci5kaXN0ZHluKSwKICAgICAgICAgICAgICAgICAgICAgIChTID0geyBiaXRzOiByLmRpc3RiaXRzIH0pLAogICAgICAgICAgICAgICAgICAgICAgKHggPSBUKAogICAgICAgICAgICAgICAgICAgICAgICBGLAogICAgICAgICAgICAgICAgICAgICAgICByLmxlbnMsCiAgICAgICAgICAgICAgICAgICAgICAgIHIubmxlbiwKICAgICAgICAgICAgICAgICAgICAgICAgci5uZGlzdCwKICAgICAgICAgICAgICAgICAgICAgICAgci5kaXN0Y29kZSwKICAgICAgICAgICAgICAgICAgICAgICAgMCwKICAgICAgICAgICAgICAgICAgICAgICAgci53b3JrLAogICAgICAgICAgICAgICAgICAgICAgICBTLAogICAgICAgICAgICAgICAgICAgICAgKSksCiAgICAgICAgICAgICAgICAgICAgICAoci5kaXN0Yml0cyA9IFMuYml0cyksCiAgICAgICAgICAgICAgICAgICAgICB4KQogICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gImludmFsaWQgZGlzdGFuY2VzIHNldCIpLCAoci5tb2RlID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICgoKHIubW9kZSA9IDIwKSwgNiA9PT0gZSkpIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgIGNhc2UgMjA6CiAgICAgICAgICAgICAgICAgICAgci5tb2RlID0gMjE7CiAgICAgICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICAgICAgaWYgKDYgPD0gbyAmJiAyNTggPD0gaCkgewogICAgICAgICAgICAgICAgICAgICAgKHQubmV4dF9vdXQgPSBhKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHQuYXZhaWxfb3V0ID0gaCksCiAgICAgICAgICAgICAgICAgICAgICAgICh0Lm5leHRfaW4gPSBzKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHQuYXZhaWxfaW4gPSBvKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHIuaG9sZCA9IHUpLAogICAgICAgICAgICAgICAgICAgICAgICAoci5iaXRzID0gbCksCiAgICAgICAgICAgICAgICAgICAgICAgIFIodCwgZCksCiAgICAgICAgICAgICAgICAgICAgICAgIChhID0gdC5uZXh0X291dCksCiAgICAgICAgICAgICAgICAgICAgICAgIChuID0gdC5vdXRwdXQpLAogICAgICAgICAgICAgICAgICAgICAgICAoaCA9IHQuYXZhaWxfb3V0KSwKICAgICAgICAgICAgICAgICAgICAgICAgKHMgPSB0Lm5leHRfaW4pLAogICAgICAgICAgICAgICAgICAgICAgICAoaSA9IHQuaW5wdXQpLAogICAgICAgICAgICAgICAgICAgICAgICAobyA9IHQuYXZhaWxfaW4pLAogICAgICAgICAgICAgICAgICAgICAgICAodSA9IHIuaG9sZCksCiAgICAgICAgICAgICAgICAgICAgICAgIChsID0gci5iaXRzKSwKICAgICAgICAgICAgICAgICAgICAgICAgMTIgPT09IHIubW9kZSAmJiAoci5iYWNrID0gLTEpOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgICAgICByLmJhY2sgPSAwOwogICAgICAgICAgICAgICAgICAgICAgKGcgPQogICAgICAgICAgICAgICAgICAgICAgICAoKEMgPSByLmxlbmNvZGVbdSAmICgoMSA8PCByLmxlbmJpdHMpIC0gMSldKSA+Pj4gMTYpICYKICAgICAgICAgICAgICAgICAgICAgICAgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgKGIgPSA2NTUzNSAmIEMpLAogICAgICAgICAgICAgICAgICAgICAgICAhKChfID0gQyA+Pj4gMjQpIDw9IGwpOwoKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgby0tLCAodSArPSBpW3MrK10gPDwgbCksIChsICs9IDgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoZyAmJiAwID09ICgyNDAgJiBnKSkgewogICAgICAgICAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgICAgICAgICAgdiA9IF8sIHkgPSBnLCB3ID0gYjsKICAgICAgICAgICAgICAgICAgICAgICAgKGcgPQogICAgICAgICAgICAgICAgICAgICAgICAgICgoQyA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByLmxlbmNvZGVbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHcgKyAoKHUgJiAoKDEgPDwgKHYgKyB5KSkgLSAxKSkgPj4gdikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF0pID4+PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgMTYpICYKICAgICAgICAgICAgICAgICAgICAgICAgICAyNTUpLAogICAgICAgICAgICAgICAgICAgICAgICAgIChiID0gNjU1MzUgJiBDKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAhKHYgKyAoXyA9IEMgPj4+IDI0KSA8PSBsKTsKCiAgICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgKz0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICh1ID4+Pj0gdiksIChsIC09IHYpLCAoci5iYWNrICs9IHYpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAgICAoKHUgPj4+PSBfKSwKICAgICAgICAgICAgICAgICAgICAgIChsIC09IF8pLAogICAgICAgICAgICAgICAgICAgICAgKHIuYmFjayArPSBfKSwKICAgICAgICAgICAgICAgICAgICAgIChyLmxlbmd0aCA9IGIpLAogICAgICAgICAgICAgICAgICAgICAgMCA9PT0gZykKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgIHIubW9kZSA9IDI2OwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICgzMiAmIGcpIHsKICAgICAgICAgICAgICAgICAgICAgIChyLmJhY2sgPSAtMSksIChyLm1vZGUgPSAxMik7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKDY0ICYgZykgewogICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gImludmFsaWQgbGl0ZXJhbC9sZW5ndGggY29kZSIpLCAoci5tb2RlID0gMzApOwogICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIChyLmV4dHJhID0gMTUgJiBnKSwgKHIubW9kZSA9IDIyKTsKICAgICAgICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICAgICAgICBpZiAoci5leHRyYSkgewogICAgICAgICAgICAgICAgICAgICAgZm9yICh6ID0gci5leHRyYTsgbCA8IHo7ICkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgICAgby0tLCAodSArPSBpW3MrK10gPDwgbCksIChsICs9IDgpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgKHIubGVuZ3RoICs9IHUgJiAoKDEgPDwgci5leHRyYSkgLSAxKSksCiAgICAgICAgICAgICAgICAgICAgICAgICh1ID4+Pj0gci5leHRyYSksCiAgICAgICAgICAgICAgICAgICAgICAgIChsIC09IHIuZXh0cmEpLAogICAgICAgICAgICAgICAgICAgICAgICAoci5iYWNrICs9IHIuZXh0cmEpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAoci53YXMgPSByLmxlbmd0aCksIChyLm1vZGUgPSAyMyk7CiAgICAgICAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgICAgICAgIDsKICAgICAgICAgICAgICAgICAgICAgIChnID0KICAgICAgICAgICAgICAgICAgICAgICAgKChDID0gci5kaXN0Y29kZVt1ICYgKCgxIDw8IHIuZGlzdGJpdHMpIC0gMSldKSA+Pj4gMTYpICYKICAgICAgICAgICAgICAgICAgICAgICAgMjU1KSwKICAgICAgICAgICAgICAgICAgICAgICAgKGIgPSA2NTUzNSAmIEMpLAogICAgICAgICAgICAgICAgICAgICAgICAhKChfID0gQyA+Pj4gMjQpIDw9IGwpOwoKICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgby0tLCAodSArPSBpW3MrK10gPDwgbCksIChsICs9IDgpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PSAoMjQwICYgZykpIHsKICAgICAgICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgICAgICAgIHYgPSBfLCB5ID0gZywgdyA9IGI7CiAgICAgICAgICAgICAgICAgICAgICAgIChnID0KICAgICAgICAgICAgICAgICAgICAgICAgICAoKEMgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgci5kaXN0Y29kZVsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdyArICgodSAmICgoMSA8PCAodiArIHkpKSAtIDEpKSA+PiB2KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgXSkgPj4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAxNikgJgogICAgICAgICAgICAgICAgICAgICAgICAgIDI1NSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKGIgPSA2NTUzNSAmIEMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICEodiArIChfID0gQyA+Pj4gMjQpIDw9IGwpOwoKICAgICAgICAgICAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgICAgby0tLCAodSArPSBpW3MrK10gPDwgbCksIChsICs9IDgpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgKHUgPj4+PSB2KSwgKGwgLT0gdiksIChyLmJhY2sgKz0gdik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmICgoKHUgPj4+PSBfKSwgKGwgLT0gXyksIChyLmJhY2sgKz0gXyksIDY0ICYgZykpIHsKICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJpbnZhbGlkIGRpc3RhbmNlIGNvZGUiKSwgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAoci5vZmZzZXQgPSBiKSwgKHIuZXh0cmEgPSAxNSAmIGcpLCAoci5tb2RlID0gMjQpOwogICAgICAgICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgICAgICAgIGlmIChyLmV4dHJhKSB7CiAgICAgICAgICAgICAgICAgICAgICBmb3IgKHogPSByLmV4dHJhOyBsIDwgejsgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBvKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgICAgICBvLS0sICh1ICs9IGlbcysrXSA8PCBsKSwgKGwgKz0gOCk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAoci5vZmZzZXQgKz0gdSAmICgoMSA8PCByLmV4dHJhKSAtIDEpKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHUgPj4+PSByLmV4dHJhKSwKICAgICAgICAgICAgICAgICAgICAgICAgKGwgLT0gci5leHRyYSksCiAgICAgICAgICAgICAgICAgICAgICAgIChyLmJhY2sgKz0gci5leHRyYSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChyLm9mZnNldCA+IHIuZG1heCkgewogICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gImludmFsaWQgZGlzdGFuY2UgdG9vIGZhciBiYWNrIiksIChyLm1vZGUgPSAzMCk7CiAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgci5tb2RlID0gMjU7CiAgICAgICAgICAgICAgICAgIGNhc2UgMjU6CiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IGgpIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgaWYgKCgoYyA9IGQgLSBoKSwgci5vZmZzZXQgPiBjKSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKChjID0gci5vZmZzZXQgLSBjKSA+IHIud2hhdmUgJiYgci5zYW5lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICh0Lm1zZyA9ICJpbnZhbGlkIGRpc3RhbmNlIHRvbyBmYXIgYmFjayIpLAogICAgICAgICAgICAgICAgICAgICAgICAgIChyLm1vZGUgPSAzMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgKHAgPQogICAgICAgICAgICAgICAgICAgICAgICBjID4gci53bmV4dAogICAgICAgICAgICAgICAgICAgICAgICAgID8gKChjIC09IHIud25leHQpLCByLndzaXplIC0gYykKICAgICAgICAgICAgICAgICAgICAgICAgICA6IHIud25leHQgLSBjKSwKICAgICAgICAgICAgICAgICAgICAgICAgYyA+IHIubGVuZ3RoICYmIChjID0gci5sZW5ndGgpLAogICAgICAgICAgICAgICAgICAgICAgICAobSA9IHIud2luZG93KTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgKG0gPSBuKSwgKHAgPSBhIC0gci5vZmZzZXQpLCAoYyA9IHIubGVuZ3RoKTsKICAgICAgICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgICAgICAgaCA8IGMgJiYgKGMgPSBoKSwgaCAtPSBjLCByLmxlbmd0aCAtPSBjOwogICAgICAgICAgICAgICAgICAgICAgKG5bYSsrXSA9IG1bcCsrXSksIC0tYzsKCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAwID09PSByLmxlbmd0aCAmJiAoci5tb2RlID0gMjEpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICBjYXNlIDI2OgogICAgICAgICAgICAgICAgICAgIGlmICgwID09PSBoKSBicmVhayB0OwogICAgICAgICAgICAgICAgICAgIChuW2ErK10gPSByLmxlbmd0aCksIGgtLSwgKHIubW9kZSA9IDIxKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgICAgICAgICBpZiAoci53cmFwKSB7CiAgICAgICAgICAgICAgICAgICAgICBmb3IgKDsgbCA8IDMyOyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT09IG8pIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG8tLSwgKHUgfD0gaVtzKytdIDw8IGwpLCAobCArPSA4KTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICAgICAgICAgKChkIC09IGgpLAogICAgICAgICAgICAgICAgICAgICAgICAodC50b3RhbF9vdXQgKz0gZCksCiAgICAgICAgICAgICAgICAgICAgICAgIChyLnRvdGFsICs9IGQpLAogICAgICAgICAgICAgICAgICAgICAgICBkICYmCiAgICAgICAgICAgICAgICAgICAgICAgICAgKHQuYWRsZXIgPSByLmNoZWNrID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHIuZmxhZ3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBCKHIuY2hlY2ssIG4sIGQsIGEgLSBkKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IE8oci5jaGVjaywgbiwgZCwgYSAtIGQpKSwKICAgICAgICAgICAgICAgICAgICAgICAgKGQgPSBoKSwKICAgICAgICAgICAgICAgICAgICAgICAgKHIuZmxhZ3MgPyB1IDogTCh1KSkgIT09IHIuY2hlY2spCiAgICAgICAgICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gImluY29ycmVjdCBkYXRhIGNoZWNrIiksIChyLm1vZGUgPSAzMCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgbCA9IHUgPSAwOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByLm1vZGUgPSAyODsKICAgICAgICAgICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgICAgICAgICBpZiAoci53cmFwICYmIHIuZmxhZ3MpIHsKICAgICAgICAgICAgICAgICAgICAgIGZvciAoOyBsIDwgMzI7ICkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PT0gbykgYnJlYWsgdDsKICAgICAgICAgICAgICAgICAgICAgICAgby0tLCAodSArPSBpW3MrK10gPDwgbCksIChsICs9IDgpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgaWYgKHUgIT09ICg0Mjk0OTY3Mjk1ICYgci50b3RhbCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgKHQubXNnID0gImluY29ycmVjdCBsZW5ndGggY2hlY2siKSwgKHIubW9kZSA9IDMwKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICBsID0gdSA9IDA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHIubW9kZSA9IDI5OwogICAgICAgICAgICAgICAgICBjYXNlIDI5OgogICAgICAgICAgICAgICAgICAgIHggPSAxOwogICAgICAgICAgICAgICAgICAgIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgIGNhc2UgMzA6CiAgICAgICAgICAgICAgICAgICAgeCA9IC0zOwogICAgICAgICAgICAgICAgICAgIGJyZWFrIHQ7CiAgICAgICAgICAgICAgICAgIGNhc2UgMzE6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC00OwogICAgICAgICAgICAgICAgICBjYXNlIDMyOgogICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIHJldHVybiBVOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICAgICAodC5uZXh0X291dCA9IGEpLAogICAgICAgICAgICAgICAgKHQuYXZhaWxfb3V0ID0gaCksCiAgICAgICAgICAgICAgICAodC5uZXh0X2luID0gcyksCiAgICAgICAgICAgICAgICAodC5hdmFpbF9pbiA9IG8pLAogICAgICAgICAgICAgICAgKHIuaG9sZCA9IHUpLAogICAgICAgICAgICAgICAgKHIuYml0cyA9IGwpLAogICAgICAgICAgICAgICAgKHIud3NpemUgfHwKICAgICAgICAgICAgICAgICAgKGQgIT09IHQuYXZhaWxfb3V0ICYmCiAgICAgICAgICAgICAgICAgICAgci5tb2RlIDwgMzAgJiYKICAgICAgICAgICAgICAgICAgICAoci5tb2RlIDwgMjcgfHwgNCAhPT0gZSkpKSAmJgogICAgICAgICAgICAgICAgWih0LCB0Lm91dHB1dCwgdC5uZXh0X291dCwgZCAtIHQuYXZhaWxfb3V0KQogICAgICAgICAgICAgICAgICA/ICgoci5tb2RlID0gMzEpLCAtNCkKICAgICAgICAgICAgICAgICAgOiAoKGYgLT0gdC5hdmFpbF9pbiksCiAgICAgICAgICAgICAgICAgICAgKGQgLT0gdC5hdmFpbF9vdXQpLAogICAgICAgICAgICAgICAgICAgICh0LnRvdGFsX2luICs9IGYpLAogICAgICAgICAgICAgICAgICAgICh0LnRvdGFsX291dCArPSBkKSwKICAgICAgICAgICAgICAgICAgICAoci50b3RhbCArPSBkKSwKICAgICAgICAgICAgICAgICAgICByLndyYXAgJiYKICAgICAgICAgICAgICAgICAgICAgIGQgJiYKICAgICAgICAgICAgICAgICAgICAgICh0LmFkbGVyID0gci5jaGVjayA9CiAgICAgICAgICAgICAgICAgICAgICAgIHIuZmxhZ3MKICAgICAgICAgICAgICAgICAgICAgICAgICA/IEIoci5jaGVjaywgbiwgZCwgdC5uZXh0X291dCAtIGQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgOiBPKHIuY2hlY2ssIG4sIGQsIHQubmV4dF9vdXQgLSBkKSksCiAgICAgICAgICAgICAgICAgICAgKHQuZGF0YV90eXBlID0KICAgICAgICAgICAgICAgICAgICAgIHIuYml0cyArCiAgICAgICAgICAgICAgICAgICAgICAoci5sYXN0ID8gNjQgOiAwKSArCiAgICAgICAgICAgICAgICAgICAgICAoMTIgPT09IHIubW9kZSA/IDEyOCA6IDApICsKICAgICAgICAgICAgICAgICAgICAgICgyMCA9PT0gci5tb2RlIHx8IDE1ID09PSByLm1vZGUgPyAyNTYgOiAwKSksCiAgICAgICAgICAgICAgICAgICAgKCgwID09IGYgJiYgMCA9PT0gZCkgfHwgNCA9PT0gZSkgJiYgeCA9PT0gTiAmJiAoeCA9IC01KSwKICAgICAgICAgICAgICAgICAgICB4KQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5pbmZsYXRlRW5kID0gZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICBpZiAoIXQgfHwgIXQuc3RhdGUpIHJldHVybiBVOwogICAgICAgICAgICAgIHZhciBlID0gdC5zdGF0ZTsKICAgICAgICAgICAgICByZXR1cm4gZS53aW5kb3cgJiYgKGUud2luZG93ID0gbnVsbCksICh0LnN0YXRlID0gbnVsbCksIE47CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5pbmZsYXRlR2V0SGVhZGVyID0gZnVuY3Rpb24gKHQsIGUpIHsKICAgICAgICAgICAgICB2YXIgcjsKICAgICAgICAgICAgICByZXR1cm4gdCAmJiB0LnN0YXRlCiAgICAgICAgICAgICAgICA/IDAgPT0gKDIgJiAociA9IHQuc3RhdGUpLndyYXApCiAgICAgICAgICAgICAgICAgID8gVQogICAgICAgICAgICAgICAgICA6ICgoKHIuaGVhZCA9IGUpLmRvbmUgPSAhMSksIE4pCiAgICAgICAgICAgICAgICA6IFU7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5pbmZsYXRlU2V0RGljdGlvbmFyeSA9IGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgdmFyIHIsCiAgICAgICAgICAgICAgICBpID0gZS5sZW5ndGg7CiAgICAgICAgICAgICAgcmV0dXJuIHQgJiYgdC5zdGF0ZQogICAgICAgICAgICAgICAgPyAwICE9PSAociA9IHQuc3RhdGUpLndyYXAgJiYgMTEgIT09IHIubW9kZQogICAgICAgICAgICAgICAgICA/IFUKICAgICAgICAgICAgICAgICAgOiAxMSA9PT0gci5tb2RlICYmIE8oMSwgZSwgaSwgMCkgIT09IHIuY2hlY2sKICAgICAgICAgICAgICAgICAgICA/IC0zCiAgICAgICAgICAgICAgICAgICAgOiBaKHQsIGUsIGksIGkpCiAgICAgICAgICAgICAgICAgICAgICA/ICgoci5tb2RlID0gMzEpLCAtNCkKICAgICAgICAgICAgICAgICAgICAgIDogKChyLmhhdmVkaWN0ID0gMSksIE4pCiAgICAgICAgICAgICAgICA6IFU7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5pbmZsYXRlSW5mbyA9ICJwYWtvIGluZmxhdGUgKGZyb20gTm9kZWNhIHByb2plY3QpIik7CiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAiLi4vdXRpbHMvY29tbW9uIjogNDEsCiAgICAgICAgICAiLi9hZGxlcjMyIjogNDMsCiAgICAgICAgICAiLi9jcmMzMiI6IDQ1LAogICAgICAgICAgIi4vaW5mZmFzdCI6IDQ4LAogICAgICAgICAgIi4vaW5mdHJlZXMiOiA1MCwKICAgICAgICB9LAogICAgICBdLAogICAgICA1MDogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgRCA9IHQoIi4uL3V0aWxzL2NvbW1vbiIpLAogICAgICAgICAgICBGID0gWwogICAgICAgICAgICAgIDMsIDQsIDUsIDYsIDcsIDgsIDksIDEwLCAxMSwgMTMsIDE1LCAxNywgMTksIDIzLCAyNywgMzEsIDM1LCA0MywKICAgICAgICAgICAgICA1MSwgNTksIDY3LCA4MywgOTksIDExNSwgMTMxLCAxNjMsIDE5NSwgMjI3LCAyNTgsIDAsIDAsCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIE4gPSBbCiAgICAgICAgICAgICAgMTYsIDE2LCAxNiwgMTYsIDE2LCAxNiwgMTYsIDE2LCAxNywgMTcsIDE3LCAxNywgMTgsIDE4LCAxOCwgMTgsCiAgICAgICAgICAgICAgMTksIDE5LCAxOSwgMTksIDIwLCAyMCwgMjAsIDIwLCAyMSwgMjEsIDIxLCAyMSwgMTYsIDcyLCA3OCwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgVSA9IFsKICAgICAgICAgICAgICAxLCAyLCAzLCA0LCA1LCA3LCA5LCAxMywgMTcsIDI1LCAzMywgNDksIDY1LCA5NywgMTI5LCAxOTMsIDI1NywKICAgICAgICAgICAgICAzODUsIDUxMywgNzY5LCAxMDI1LCAxNTM3LCAyMDQ5LCAzMDczLCA0MDk3LCA2MTQ1LCA4MTkzLCAxMjI4OSwKICAgICAgICAgICAgICAxNjM4NSwgMjQ1NzcsIDAsIDAsCiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIFAgPSBbCiAgICAgICAgICAgICAgMTYsIDE2LCAxNiwgMTYsIDE3LCAxNywgMTgsIDE4LCAxOSwgMTksIDIwLCAyMCwgMjEsIDIxLCAyMiwgMjIsCiAgICAgICAgICAgICAgMjMsIDIzLCAyNCwgMjQsIDI1LCAyNSwgMjYsIDI2LCAyNywgMjcsIDI4LCAyOCwgMjksIDI5LCA2NCwgNjQsCiAgICAgICAgICAgIF07CiAgICAgICAgICBlLmV4cG9ydHMgPSBmdW5jdGlvbiAodCwgZSwgciwgaSwgbiwgcywgYSwgbykgewogICAgICAgICAgICB2YXIgaCwKICAgICAgICAgICAgICB1LAogICAgICAgICAgICAgIGwsCiAgICAgICAgICAgICAgZiwKICAgICAgICAgICAgICBkLAogICAgICAgICAgICAgIGMsCiAgICAgICAgICAgICAgcCwKICAgICAgICAgICAgICBtLAogICAgICAgICAgICAgIF8sCiAgICAgICAgICAgICAgZyA9IG8uYml0cywKICAgICAgICAgICAgICBiID0gMCwKICAgICAgICAgICAgICB2ID0gMCwKICAgICAgICAgICAgICB5ID0gMCwKICAgICAgICAgICAgICB3ID0gMCwKICAgICAgICAgICAgICBrID0gMCwKICAgICAgICAgICAgICB4ID0gMCwKICAgICAgICAgICAgICBTID0gMCwKICAgICAgICAgICAgICB6ID0gMCwKICAgICAgICAgICAgICBDID0gMCwKICAgICAgICAgICAgICBFID0gMCwKICAgICAgICAgICAgICBBID0gbnVsbCwKICAgICAgICAgICAgICBJID0gMCwKICAgICAgICAgICAgICBPID0gbmV3IEQuQnVmMTYoMTYpLAogICAgICAgICAgICAgIEIgPSBuZXcgRC5CdWYxNigxNiksCiAgICAgICAgICAgICAgUiA9IG51bGwsCiAgICAgICAgICAgICAgVCA9IDA7CiAgICAgICAgICAgIGZvciAoYiA9IDA7IGIgPD0gMTU7IGIrKykgT1tiXSA9IDA7CiAgICAgICAgICAgIGZvciAodiA9IDA7IHYgPCBpOyB2KyspIE9bZVtyICsgdl1dKys7CiAgICAgICAgICAgIGZvciAoayA9IGcsIHcgPSAxNTsgMSA8PSB3ICYmIDAgPT09IE9bd107IHctLSk7CiAgICAgICAgICAgIGlmICgodyA8IGsgJiYgKGsgPSB3KSwgMCA9PT0gdykpCiAgICAgICAgICAgICAgcmV0dXJuIChuW3MrK10gPSAyMDk3MTUyMCksIChuW3MrK10gPSAyMDk3MTUyMCksIChvLmJpdHMgPSAxKSwgMDsKICAgICAgICAgICAgZm9yICh5ID0gMTsgeSA8IHcgJiYgMCA9PT0gT1t5XTsgeSsrKTsKICAgICAgICAgICAgZm9yIChrIDwgeSAmJiAoayA9IHkpLCBiID0geiA9IDE7IGIgPD0gMTU7IGIrKykKICAgICAgICAgICAgICBpZiAoKCh6IDw8PSAxKSwgKHogLT0gT1tiXSkgPCAwKSkgcmV0dXJuIC0xOwogICAgICAgICAgICBpZiAoMCA8IHogJiYgKDAgPT09IHQgfHwgMSAhPT0gdykpIHJldHVybiAtMTsKICAgICAgICAgICAgZm9yIChCWzFdID0gMCwgYiA9IDE7IGIgPCAxNTsgYisrKSBCW2IgKyAxXSA9IEJbYl0gKyBPW2JdOwogICAgICAgICAgICBmb3IgKHYgPSAwOyB2IDwgaTsgdisrKSAwICE9PSBlW3IgKyB2XSAmJiAoYVtCW2VbciArIHZdXSsrXSA9IHYpOwogICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgKChjID0KICAgICAgICAgICAgICAgIDAgPT09IHQKICAgICAgICAgICAgICAgICAgPyAoKEEgPSBSID0gYSksIDE5KQogICAgICAgICAgICAgICAgICA6IDEgPT09IHQKICAgICAgICAgICAgICAgICAgICA/ICgoQSA9IEYpLCAoSSAtPSAyNTcpLCAoUiA9IE4pLCAoVCAtPSAyNTcpLCAyNTYpCiAgICAgICAgICAgICAgICAgICAgOiAoKEEgPSBVKSwgKFIgPSBQKSwgLTEpKSwKICAgICAgICAgICAgICAoYiA9IHkpLAogICAgICAgICAgICAgIChkID0gcyksCiAgICAgICAgICAgICAgKFMgPSB2ID0gRSA9IDApLAogICAgICAgICAgICAgIChsID0gLTEpLAogICAgICAgICAgICAgIChmID0gKEMgPSAxIDw8ICh4ID0gaykpIC0gMSksCiAgICAgICAgICAgICAgKDEgPT09IHQgJiYgODUyIDwgQykgfHwgKDIgPT09IHQgJiYgNTkyIDwgQykpCiAgICAgICAgICAgICkKICAgICAgICAgICAgICByZXR1cm4gMTsKICAgICAgICAgICAgZm9yICg7OykgewogICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICBwID0gYiAtIFMsCiAgICAgICAgICAgICAgICAgIF8gPQogICAgICAgICAgICAgICAgICAgIGFbdl0gPCBjCiAgICAgICAgICAgICAgICAgICAgICA/ICgobSA9IDApLCBhW3ZdKQogICAgICAgICAgICAgICAgICAgICAgOiBhW3ZdID4gYwogICAgICAgICAgICAgICAgICAgICAgICA/ICgobSA9IFJbVCArIGFbdl1dKSwgQVtJICsgYVt2XV0pCiAgICAgICAgICAgICAgICAgICAgICAgIDogKChtID0gOTYpLCAwKSwKICAgICAgICAgICAgICAgICAgaCA9IDEgPDwgKGIgLSBTKSwKICAgICAgICAgICAgICAgICAgeSA9IHUgPSAxIDw8IHg7CiAgICAgICAgICAgICAgICAobltkICsgKEUgPj4gUykgKyAodSAtPSBoKV0gPSAocCA8PCAyNCkgfCAobSA8PCAxNikgfCBfIHwgMCksCiAgICAgICAgICAgICAgICAgIDAgIT09IHU7CgogICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgZm9yIChoID0gMSA8PCAoYiAtIDEpOyBFICYgaDsgKSBoID4+PSAxOwogICAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICgwICE9PSBoID8gKChFICY9IGggLSAxKSwgKEUgKz0gaCkpIDogKEUgPSAwKSwgdisrLCAwID09IC0tT1tiXSkKICAgICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIGlmIChiID09PSB3KSBicmVhazsKICAgICAgICAgICAgICAgIGIgPSBlW3IgKyBhW3ZdXTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKGsgPCBiICYmIChFICYgZikgIT09IGwpIHsKICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgIDAgPT09IFMgJiYgKFMgPSBrKSwgZCArPSB5LCB6ID0gMSA8PCAoeCA9IGIgLSBTKTsKICAgICAgICAgICAgICAgICAgeCArIFMgPCB3ICYmICEoKHogLT0gT1t4ICsgU10pIDw9IDApOwoKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgeCsrLCAoeiA8PD0gMSk7CiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICgoQyArPSAxIDw8IHgpLCAoMSA9PT0gdCAmJiA4NTIgPCBDKSB8fCAoMiA9PT0gdCAmJiA1OTIgPCBDKSkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICAgICAgICBuWyhsID0gRSAmIGYpXSA9IChrIDw8IDI0KSB8ICh4IDw8IDE2KSB8IChkIC0gcykgfCAwOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgIDAgIT09IEUgJiYgKG5bZCArIEVdID0gKChiIC0gUykgPDwgMjQpIHwgKDY0IDw8IDE2KSB8IDApLAogICAgICAgICAgICAgIChvLmJpdHMgPSBrKSwKICAgICAgICAgICAgICAwCiAgICAgICAgICAgICk7CiAgICAgICAgICB9OwogICAgICAgIH0sCiAgICAgICAgeyAiLi4vdXRpbHMvY29tbW9uIjogNDEgfSwKICAgICAgXSwKICAgICAgNTE6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgZS5leHBvcnRzID0gewogICAgICAgICAgICAyOiAibmVlZCBkaWN0aW9uYXJ5IiwKICAgICAgICAgICAgMTogInN0cmVhbSBlbmQiLAogICAgICAgICAgICAwOiAiIiwKICAgICAgICAgICAgIi0xIjogImZpbGUgZXJyb3IiLAogICAgICAgICAgICAiLTIiOiAic3RyZWFtIGVycm9yIiwKICAgICAgICAgICAgIi0zIjogImRhdGEgZXJyb3IiLAogICAgICAgICAgICAiLTQiOiAiaW5zdWZmaWNpZW50IG1lbW9yeSIsCiAgICAgICAgICAgICItNSI6ICJidWZmZXIgZXJyb3IiLAogICAgICAgICAgICAiLTYiOiAiaW5jb21wYXRpYmxlIHZlcnNpb24iLAogICAgICAgICAgfTsKICAgICAgICB9LAogICAgICAgIHt9LAogICAgICBdLAogICAgICA1MjogWwogICAgICAgIGZ1bmN0aW9uICh0LCBlLCByKSB7CiAgICAgICAgICAidXNlIHN0cmljdCI7CiAgICAgICAgICB2YXIgbiA9IHQoIi4uL3V0aWxzL2NvbW1vbiIpLAogICAgICAgICAgICBvID0gMCwKICAgICAgICAgICAgaCA9IDE7CiAgICAgICAgICBmdW5jdGlvbiBpKHQpIHsKICAgICAgICAgICAgZm9yICh2YXIgZSA9IHQubGVuZ3RoOyAwIDw9IC0tZTsgKSB0W2VdID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIHZhciBzID0gMCwKICAgICAgICAgICAgYSA9IDI5LAogICAgICAgICAgICB1ID0gMjU2LAogICAgICAgICAgICBsID0gdSArIDEgKyBhLAogICAgICAgICAgICBmID0gMzAsCiAgICAgICAgICAgIGQgPSAxOSwKICAgICAgICAgICAgXyA9IDIgKiBsICsgMSwKICAgICAgICAgICAgZyA9IDE1LAogICAgICAgICAgICBjID0gMTYsCiAgICAgICAgICAgIHAgPSA3LAogICAgICAgICAgICBtID0gMjU2LAogICAgICAgICAgICBiID0gMTYsCiAgICAgICAgICAgIHYgPSAxNywKICAgICAgICAgICAgeSA9IDE4LAogICAgICAgICAgICB3ID0gWwogICAgICAgICAgICAgIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDEsIDEsIDIsIDIsIDIsIDIsIDMsIDMsIDMsIDMsIDQsIDQsCiAgICAgICAgICAgICAgNCwgNCwgNSwgNSwgNSwgNSwgMCwKICAgICAgICAgICAgXSwKICAgICAgICAgICAgayA9IFsKICAgICAgICAgICAgICAwLCAwLCAwLCAwLCAxLCAxLCAyLCAyLCAzLCAzLCA0LCA0LCA1LCA1LCA2LCA2LCA3LCA3LCA4LCA4LCA5LCA5LAogICAgICAgICAgICAgIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywKICAgICAgICAgICAgXSwKICAgICAgICAgICAgeCA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAyLCAzLCA3XSwKICAgICAgICAgICAgUyA9IFsKICAgICAgICAgICAgICAxNiwgMTcsIDE4LCAwLCA4LCA3LCA5LCA2LCAxMCwgNSwgMTEsIDQsIDEyLCAzLCAxMywgMiwgMTQsIDEsIDE1LAogICAgICAgICAgICBdLAogICAgICAgICAgICB6ID0gbmV3IEFycmF5KDIgKiAobCArIDIpKTsKICAgICAgICAgIGkoeik7CiAgICAgICAgICB2YXIgQyA9IG5ldyBBcnJheSgyICogZik7CiAgICAgICAgICBpKEMpOwogICAgICAgICAgdmFyIEUgPSBuZXcgQXJyYXkoNTEyKTsKICAgICAgICAgIGkoRSk7CiAgICAgICAgICB2YXIgQSA9IG5ldyBBcnJheSgyNTYpOwogICAgICAgICAgaShBKTsKICAgICAgICAgIHZhciBJID0gbmV3IEFycmF5KGEpOwogICAgICAgICAgaShJKTsKICAgICAgICAgIHZhciBPLAogICAgICAgICAgICBCLAogICAgICAgICAgICBSLAogICAgICAgICAgICBUID0gbmV3IEFycmF5KGYpOwogICAgICAgICAgZnVuY3Rpb24gRCh0LCBlLCByLCBpLCBuKSB7CiAgICAgICAgICAgICh0aGlzLnN0YXRpY190cmVlID0gdCksCiAgICAgICAgICAgICAgKHRoaXMuZXh0cmFfYml0cyA9IGUpLAogICAgICAgICAgICAgICh0aGlzLmV4dHJhX2Jhc2UgPSByKSwKICAgICAgICAgICAgICAodGhpcy5lbGVtcyA9IGkpLAogICAgICAgICAgICAgICh0aGlzLm1heF9sZW5ndGggPSBuKSwKICAgICAgICAgICAgICAodGhpcy5oYXNfc3RyZWUgPSB0ICYmIHQubGVuZ3RoKTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIEYodCwgZSkgewogICAgICAgICAgICAodGhpcy5keW5fdHJlZSA9IHQpLCAodGhpcy5tYXhfY29kZSA9IDApLCAodGhpcy5zdGF0X2Rlc2MgPSBlKTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIE4odCkgewogICAgICAgICAgICByZXR1cm4gdCA8IDI1NiA/IEVbdF0gOiBFWzI1NiArICh0ID4+PiA3KV07CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBVKHQsIGUpIHsKICAgICAgICAgICAgKHQucGVuZGluZ19idWZbdC5wZW5kaW5nKytdID0gMjU1ICYgZSksCiAgICAgICAgICAgICAgKHQucGVuZGluZ19idWZbdC5wZW5kaW5nKytdID0gKGUgPj4+IDgpICYgMjU1KTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIFAodCwgZSwgcikgewogICAgICAgICAgICB0LmJpX3ZhbGlkID4gYyAtIHIKICAgICAgICAgICAgICA/ICgodC5iaV9idWYgfD0gKGUgPDwgdC5iaV92YWxpZCkgJiA2NTUzNSksCiAgICAgICAgICAgICAgICBVKHQsIHQuYmlfYnVmKSwKICAgICAgICAgICAgICAgICh0LmJpX2J1ZiA9IGUgPj4gKGMgLSB0LmJpX3ZhbGlkKSksCiAgICAgICAgICAgICAgICAodC5iaV92YWxpZCArPSByIC0gYykpCiAgICAgICAgICAgICAgOiAoKHQuYmlfYnVmIHw9IChlIDw8IHQuYmlfdmFsaWQpICYgNjU1MzUpLCAodC5iaV92YWxpZCArPSByKSk7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBMKHQsIGUsIHIpIHsKICAgICAgICAgICAgUCh0LCByWzIgKiBlXSwgclsyICogZSArIDFdKTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIGoodCwgZSkgewogICAgICAgICAgICBmb3IgKHZhciByID0gMDsgKHIgfD0gMSAmIHQpLCAodCA+Pj49IDEpLCAociA8PD0gMSksIDAgPCAtLWU7ICk7CiAgICAgICAgICAgIHJldHVybiByID4+PiAxOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gWih0LCBlLCByKSB7CiAgICAgICAgICAgIHZhciBpLAogICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgcyA9IG5ldyBBcnJheShnICsgMSksCiAgICAgICAgICAgICAgYSA9IDA7CiAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPD0gZzsgaSsrKSBzW2ldID0gYSA9IChhICsgcltpIC0gMV0pIDw8IDE7CiAgICAgICAgICAgIGZvciAobiA9IDA7IG4gPD0gZTsgbisrKSB7CiAgICAgICAgICAgICAgdmFyIG8gPSB0WzIgKiBuICsgMV07CiAgICAgICAgICAgICAgMCAhPT0gbyAmJiAodFsyICogbl0gPSBqKHNbb10rKywgbykpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBXKHQpIHsKICAgICAgICAgICAgdmFyIGU7CiAgICAgICAgICAgIGZvciAoZSA9IDA7IGUgPCBsOyBlKyspIHQuZHluX2x0cmVlWzIgKiBlXSA9IDA7CiAgICAgICAgICAgIGZvciAoZSA9IDA7IGUgPCBmOyBlKyspIHQuZHluX2R0cmVlWzIgKiBlXSA9IDA7CiAgICAgICAgICAgIGZvciAoZSA9IDA7IGUgPCBkOyBlKyspIHQuYmxfdHJlZVsyICogZV0gPSAwOwogICAgICAgICAgICAodC5keW5fbHRyZWVbMiAqIG1dID0gMSksCiAgICAgICAgICAgICAgKHQub3B0X2xlbiA9IHQuc3RhdGljX2xlbiA9IDApLAogICAgICAgICAgICAgICh0Lmxhc3RfbGl0ID0gdC5tYXRjaGVzID0gMCk7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBNKHQpIHsKICAgICAgICAgICAgOCA8IHQuYmlfdmFsaWQKICAgICAgICAgICAgICA/IFUodCwgdC5iaV9idWYpCiAgICAgICAgICAgICAgOiAwIDwgdC5iaV92YWxpZCAmJiAodC5wZW5kaW5nX2J1Zlt0LnBlbmRpbmcrK10gPSB0LmJpX2J1ZiksCiAgICAgICAgICAgICAgKHQuYmlfYnVmID0gMCksCiAgICAgICAgICAgICAgKHQuYmlfdmFsaWQgPSAwKTsKICAgICAgICAgIH0KICAgICAgICAgIGZ1bmN0aW9uIEgodCwgZSwgciwgaSkgewogICAgICAgICAgICB2YXIgbiA9IDIgKiBlLAogICAgICAgICAgICAgIHMgPSAyICogcjsKICAgICAgICAgICAgcmV0dXJuIHRbbl0gPCB0W3NdIHx8ICh0W25dID09PSB0W3NdICYmIGlbZV0gPD0gaVtyXSk7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBHKHQsIGUsIHIpIHsKICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICB2YXIgaSA9IHQuaGVhcFtyXSwgbiA9IHIgPDwgMTsKICAgICAgICAgICAgICBuIDw9IHQuaGVhcF9sZW4gJiYKICAgICAgICAgICAgICAobiA8IHQuaGVhcF9sZW4gJiYgSChlLCB0LmhlYXBbbiArIDFdLCB0LmhlYXBbbl0sIHQuZGVwdGgpICYmIG4rKywKICAgICAgICAgICAgICAhSChlLCBpLCB0LmhlYXBbbl0sIHQuZGVwdGgpKTsKCiAgICAgICAgICAgICkKICAgICAgICAgICAgICAodC5oZWFwW3JdID0gdC5oZWFwW25dKSwgKHIgPSBuKSwgKG4gPDw9IDEpOwogICAgICAgICAgICB0LmhlYXBbcl0gPSBpOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gSyh0LCBlLCByKSB7CiAgICAgICAgICAgIHZhciBpLAogICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICBhLAogICAgICAgICAgICAgIG8gPSAwOwogICAgICAgICAgICBpZiAoMCAhPT0gdC5sYXN0X2xpdCkKICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgOwogICAgICAgICAgICAgICAgKGkgPQogICAgICAgICAgICAgICAgICAodC5wZW5kaW5nX2J1Zlt0LmRfYnVmICsgMiAqIG9dIDw8IDgpIHwKICAgICAgICAgICAgICAgICAgdC5wZW5kaW5nX2J1Zlt0LmRfYnVmICsgMiAqIG8gKyAxXSksCiAgICAgICAgICAgICAgICAgIChuID0gdC5wZW5kaW5nX2J1Zlt0LmxfYnVmICsgb10pLAogICAgICAgICAgICAgICAgICBvKyssCiAgICAgICAgICAgICAgICAgIDAgPT09IGkKICAgICAgICAgICAgICAgICAgICA/IEwodCwgbiwgZSkKICAgICAgICAgICAgICAgICAgICA6IChMKHQsIChzID0gQVtuXSkgKyB1ICsgMSwgZSksCiAgICAgICAgICAgICAgICAgICAgICAwICE9PSAoYSA9IHdbc10pICYmIFAodCwgKG4gLT0gSVtzXSksIGEpLAogICAgICAgICAgICAgICAgICAgICAgTCh0LCAocyA9IE4oLS1pKSksIHIpLAogICAgICAgICAgICAgICAgICAgICAgMCAhPT0gKGEgPSBrW3NdKSAmJiBQKHQsIChpIC09IFRbc10pLCBhKSksCiAgICAgICAgICAgICAgICAgIG8gPCB0Lmxhc3RfbGl0OwoKICAgICAgICAgICAgICApOwogICAgICAgICAgICBMKHQsIG0sIGUpOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gWSh0LCBlKSB7CiAgICAgICAgICAgIHZhciByLAogICAgICAgICAgICAgIGksCiAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICBzID0gZS5keW5fdHJlZSwKICAgICAgICAgICAgICBhID0gZS5zdGF0X2Rlc2Muc3RhdGljX3RyZWUsCiAgICAgICAgICAgICAgbyA9IGUuc3RhdF9kZXNjLmhhc19zdHJlZSwKICAgICAgICAgICAgICBoID0gZS5zdGF0X2Rlc2MuZWxlbXMsCiAgICAgICAgICAgICAgdSA9IC0xOwogICAgICAgICAgICBmb3IgKHQuaGVhcF9sZW4gPSAwLCB0LmhlYXBfbWF4ID0gXywgciA9IDA7IHIgPCBoOyByKyspCiAgICAgICAgICAgICAgMCAhPT0gc1syICogcl0KICAgICAgICAgICAgICAgID8gKCh0LmhlYXBbKyt0LmhlYXBfbGVuXSA9IHUgPSByKSwgKHQuZGVwdGhbcl0gPSAwKSkKICAgICAgICAgICAgICAgIDogKHNbMiAqIHIgKyAxXSA9IDApOwogICAgICAgICAgICBmb3IgKDsgdC5oZWFwX2xlbiA8IDI7ICkKICAgICAgICAgICAgICAoc1syICogKG4gPSB0LmhlYXBbKyt0LmhlYXBfbGVuXSA9IHUgPCAyID8gKyt1IDogMCldID0gMSksCiAgICAgICAgICAgICAgICAodC5kZXB0aFtuXSA9IDApLAogICAgICAgICAgICAgICAgdC5vcHRfbGVuLS0sCiAgICAgICAgICAgICAgICBvICYmICh0LnN0YXRpY19sZW4gLT0gYVsyICogbiArIDFdKTsKICAgICAgICAgICAgZm9yIChlLm1heF9jb2RlID0gdSwgciA9IHQuaGVhcF9sZW4gPj4gMTsgMSA8PSByOyByLS0pIEcodCwgcywgcik7CiAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgbiA9IGg7CiAgICAgICAgICAgICAgKHIgPSB0LmhlYXBbMV0pLAogICAgICAgICAgICAgICAgKHQuaGVhcFsxXSA9IHQuaGVhcFt0LmhlYXBfbGVuLS1dKSwKICAgICAgICAgICAgICAgIEcodCwgcywgMSksCiAgICAgICAgICAgICAgICAoaSA9IHQuaGVhcFsxXSksCiAgICAgICAgICAgICAgICAodC5oZWFwWy0tdC5oZWFwX21heF0gPSByKSwKICAgICAgICAgICAgICAgICh0LmhlYXBbLS10LmhlYXBfbWF4XSA9IGkpLAogICAgICAgICAgICAgICAgKHNbMiAqIG5dID0gc1syICogcl0gKyBzWzIgKiBpXSksCiAgICAgICAgICAgICAgICAodC5kZXB0aFtuXSA9CiAgICAgICAgICAgICAgICAgICh0LmRlcHRoW3JdID49IHQuZGVwdGhbaV0gPyB0LmRlcHRoW3JdIDogdC5kZXB0aFtpXSkgKyAxKSwKICAgICAgICAgICAgICAgIChzWzIgKiByICsgMV0gPSBzWzIgKiBpICsgMV0gPSBuKSwKICAgICAgICAgICAgICAgICh0LmhlYXBbMV0gPSBuKyspLAogICAgICAgICAgICAgICAgRyh0LCBzLCAxKSwKICAgICAgICAgICAgICAgIDIgPD0gdC5oZWFwX2xlbjsKCiAgICAgICAgICAgICk7CiAgICAgICAgICAgICh0LmhlYXBbLS10LmhlYXBfbWF4XSA9IHQuaGVhcFsxXSksCiAgICAgICAgICAgICAgKGZ1bmN0aW9uICh0LCBlKSB7CiAgICAgICAgICAgICAgICB2YXIgciwKICAgICAgICAgICAgICAgICAgaSwKICAgICAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICAgICAgYSwKICAgICAgICAgICAgICAgICAgbywKICAgICAgICAgICAgICAgICAgaCA9IGUuZHluX3RyZWUsCiAgICAgICAgICAgICAgICAgIHUgPSBlLm1heF9jb2RlLAogICAgICAgICAgICAgICAgICBsID0gZS5zdGF0X2Rlc2Muc3RhdGljX3RyZWUsCiAgICAgICAgICAgICAgICAgIGYgPSBlLnN0YXRfZGVzYy5oYXNfc3RyZWUsCiAgICAgICAgICAgICAgICAgIGQgPSBlLnN0YXRfZGVzYy5leHRyYV9iaXRzLAogICAgICAgICAgICAgICAgICBjID0gZS5zdGF0X2Rlc2MuZXh0cmFfYmFzZSwKICAgICAgICAgICAgICAgICAgcCA9IGUuc3RhdF9kZXNjLm1heF9sZW5ndGgsCiAgICAgICAgICAgICAgICAgIG0gPSAwOwogICAgICAgICAgICAgICAgZm9yIChzID0gMDsgcyA8PSBnOyBzKyspIHQuYmxfY291bnRbc10gPSAwOwogICAgICAgICAgICAgICAgZm9yICgKICAgICAgICAgICAgICAgICAgaFsyICogdC5oZWFwW3QuaGVhcF9tYXhdICsgMV0gPSAwLCByID0gdC5oZWFwX21heCArIDE7CiAgICAgICAgICAgICAgICAgIHIgPCBfOwogICAgICAgICAgICAgICAgICByKysKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgcCA8IChzID0gaFsyICogaFsyICogKGkgPSB0LmhlYXBbcl0pICsgMV0gKyAxXSArIDEpICYmCiAgICAgICAgICAgICAgICAgICAgKChzID0gcCksIG0rKyksCiAgICAgICAgICAgICAgICAgICAgKGhbMiAqIGkgKyAxXSA9IHMpLAogICAgICAgICAgICAgICAgICAgIHUgPCBpIHx8CiAgICAgICAgICAgICAgICAgICAgICAodC5ibF9jb3VudFtzXSsrLAogICAgICAgICAgICAgICAgICAgICAgKGEgPSAwKSwKICAgICAgICAgICAgICAgICAgICAgIGMgPD0gaSAmJiAoYSA9IGRbaSAtIGNdKSwKICAgICAgICAgICAgICAgICAgICAgIChvID0gaFsyICogaV0pLAogICAgICAgICAgICAgICAgICAgICAgKHQub3B0X2xlbiArPSBvICogKHMgKyBhKSksCiAgICAgICAgICAgICAgICAgICAgICBmICYmICh0LnN0YXRpY19sZW4gKz0gbyAqIChsWzIgKiBpICsgMV0gKyBhKSkpOwogICAgICAgICAgICAgICAgaWYgKDAgIT09IG0pIHsKICAgICAgICAgICAgICAgICAgZG8gewogICAgICAgICAgICAgICAgICAgIGZvciAocyA9IHAgLSAxOyAwID09PSB0LmJsX2NvdW50W3NdOyApIHMtLTsKICAgICAgICAgICAgICAgICAgICB0LmJsX2NvdW50W3NdLS0sCiAgICAgICAgICAgICAgICAgICAgICAodC5ibF9jb3VudFtzICsgMV0gKz0gMiksCiAgICAgICAgICAgICAgICAgICAgICB0LmJsX2NvdW50W3BdLS0sCiAgICAgICAgICAgICAgICAgICAgICAobSAtPSAyKTsKICAgICAgICAgICAgICAgICAgfSB3aGlsZSAoMCA8IG0pOwogICAgICAgICAgICAgICAgICBmb3IgKHMgPSBwOyAwICE9PSBzOyBzLS0pCiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gdC5ibF9jb3VudFtzXTsgMCAhPT0gaTsgKQogICAgICAgICAgICAgICAgICAgICAgdSA8IChuID0gdC5oZWFwWy0tcl0pIHx8CiAgICAgICAgICAgICAgICAgICAgICAgIChoWzIgKiBuICsgMV0gIT09IHMgJiYKICAgICAgICAgICAgICAgICAgICAgICAgICAoKHQub3B0X2xlbiArPSAocyAtIGhbMiAqIG4gKyAxXSkgKiBoWzIgKiBuXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgKGhbMiAqIG4gKyAxXSA9IHMpKSwKICAgICAgICAgICAgICAgICAgICAgICAgaS0tKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KSh0LCBlKSwKICAgICAgICAgICAgICBaKHMsIHUsIHQuYmxfY291bnQpOwogICAgICAgICAgfQogICAgICAgICAgZnVuY3Rpb24gWCh0LCBlLCByKSB7CiAgICAgICAgICAgIHZhciBpLAogICAgICAgICAgICAgIG4sCiAgICAgICAgICAgICAgcyA9IC0xLAogICAgICAgICAgICAgIGEgPSBlWzFdLAogICAgICAgICAgICAgIG8gPSAwLAogICAgICAgICAgICAgIGggPSA3LAogICAgICAgICAgICAgIHUgPSA0OwogICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgIDAgPT09IGEgJiYgKChoID0gMTM4KSwgKHUgPSAzKSksCiAgICAgICAgICAgICAgICBlWzIgKiAociArIDEpICsgMV0gPSA2NTUzNSwKICAgICAgICAgICAgICAgIGkgPSAwOwogICAgICAgICAgICAgIGkgPD0gcjsKICAgICAgICAgICAgICBpKysKICAgICAgICAgICAgKQogICAgICAgICAgICAgIChuID0gYSksCiAgICAgICAgICAgICAgICAoYSA9IGVbMiAqIChpICsgMSkgKyAxXSksCiAgICAgICAgICAgICAgICAoKytvIDwgaCAmJiBuID09PSBhKSB8fAogICAgICAgICAgICAgICAgICAobyA8IHUKICAgICAgICAgICAgICAgICAgICA/ICh0LmJsX3RyZWVbMiAqIG5dICs9IG8pCiAgICAgICAgICAgICAgICAgICAgOiAwICE9PSBuCiAgICAgICAgICAgICAgICAgICAgICA/IChuICE9PSBzICYmIHQuYmxfdHJlZVsyICogbl0rKywgdC5ibF90cmVlWzIgKiBiXSsrKQogICAgICAgICAgICAgICAgICAgICAgOiBvIDw9IDEwCiAgICAgICAgICAgICAgICAgICAgICAgID8gdC5ibF90cmVlWzIgKiB2XSsrCiAgICAgICAgICAgICAgICAgICAgICAgIDogdC5ibF90cmVlWzIgKiB5XSsrLAogICAgICAgICAgICAgICAgICAocyA9IG4pLAogICAgICAgICAgICAgICAgICAodSA9CiAgICAgICAgICAgICAgICAgICAgKG8gPSAwKSA9PT0gYQogICAgICAgICAgICAgICAgICAgICAgPyAoKGggPSAxMzgpLCAzKQogICAgICAgICAgICAgICAgICAgICAgOiBuID09PSBhCiAgICAgICAgICAgICAgICAgICAgICAgID8gKChoID0gNiksIDMpCiAgICAgICAgICAgICAgICAgICAgICAgIDogKChoID0gNyksIDQpKSk7CiAgICAgICAgICB9CiAgICAgICAgICBmdW5jdGlvbiBWKHQsIGUsIHIpIHsKICAgICAgICAgICAgdmFyIGksCiAgICAgICAgICAgICAgbiwKICAgICAgICAgICAgICBzID0gLTEsCiAgICAgICAgICAgICAgYSA9IGVbMV0sCiAgICAgICAgICAgICAgbyA9IDAsCiAgICAgICAgICAgICAgaCA9IDcsCiAgICAgICAgICAgICAgdSA9IDQ7CiAgICAgICAgICAgIGZvciAoMCA9PT0gYSAmJiAoKGggPSAxMzgpLCAodSA9IDMpKSwgaSA9IDA7IGkgPD0gcjsgaSsrKQogICAgICAgICAgICAgIGlmICgoKG4gPSBhKSwgKGEgPSBlWzIgKiAoaSArIDEpICsgMV0pLCAhKCsrbyA8IGggJiYgbiA9PT0gYSkpKSB7CiAgICAgICAgICAgICAgICBpZiAobyA8IHUpIGZvciAoOyBMKHQsIG4sIHQuYmxfdHJlZSksIDAgIT0gLS1vOyApOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAwICE9PSBuCiAgICAgICAgICAgICAgICAgICAgPyAobiAhPT0gcyAmJiAoTCh0LCBuLCB0LmJsX3RyZWUpLCBvLS0pLAogICAgICAgICAgICAgICAgICAgICAgTCh0LCBiLCB0LmJsX3RyZWUpLAogICAgICAgICAgICAgICAgICAgICAgUCh0LCBvIC0gMywgMikpCiAgICAgICAgICAgICAgICAgICAgOiBvIDw9IDEwCiAgICAgICAgICAgICAgICAgICAgICA/IChMKHQsIHYsIHQuYmxfdHJlZSksIFAodCwgbyAtIDMsIDMpKQogICAgICAgICAgICAgICAgICAgICAgOiAoTCh0LCB5LCB0LmJsX3RyZWUpLCBQKHQsIG8gLSAxMSwgNykpOwogICAgICAgICAgICAgICAgKHMgPSBuKSwKICAgICAgICAgICAgICAgICAgKHUgPQogICAgICAgICAgICAgICAgICAgIChvID0gMCkgPT09IGEKICAgICAgICAgICAgICAgICAgICAgID8gKChoID0gMTM4KSwgMykKICAgICAgICAgICAgICAgICAgICAgIDogbiA9PT0gYQogICAgICAgICAgICAgICAgICAgICAgICA/ICgoaCA9IDYpLCAzKQogICAgICAgICAgICAgICAgICAgICAgICA6ICgoaCA9IDcpLCA0KSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgaShUKTsKICAgICAgICAgIHZhciBxID0gITE7CiAgICAgICAgICBmdW5jdGlvbiBKKHQsIGUsIHIsIGkpIHsKICAgICAgICAgICAgUCh0LCAocyA8PCAxKSArIChpID8gMSA6IDApLCAzKSwKICAgICAgICAgICAgICAoZnVuY3Rpb24gKHQsIGUsIHIsIGkpIHsKICAgICAgICAgICAgICAgIE0odCksCiAgICAgICAgICAgICAgICAgIGkgJiYgKFUodCwgciksIFUodCwgfnIpKSwKICAgICAgICAgICAgICAgICAgbi5hcnJheVNldCh0LnBlbmRpbmdfYnVmLCB0LndpbmRvdywgZSwgciwgdC5wZW5kaW5nKSwKICAgICAgICAgICAgICAgICAgKHQucGVuZGluZyArPSByKTsKICAgICAgICAgICAgICB9KSh0LCBlLCByLCAhMCk7CiAgICAgICAgICB9CiAgICAgICAgICAoci5fdHJfaW5pdCA9IGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgIHEgfHwKICAgICAgICAgICAgICAoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHZhciB0LAogICAgICAgICAgICAgICAgICBlLAogICAgICAgICAgICAgICAgICByLAogICAgICAgICAgICAgICAgICBpLAogICAgICAgICAgICAgICAgICBuLAogICAgICAgICAgICAgICAgICBzID0gbmV3IEFycmF5KGcgKyAxKTsKICAgICAgICAgICAgICAgIGZvciAoaSA9IHIgPSAwOyBpIDwgYSAtIDE7IGkrKykKICAgICAgICAgICAgICAgICAgZm9yIChJW2ldID0gciwgdCA9IDA7IHQgPCAxIDw8IHdbaV07IHQrKykgQVtyKytdID0gaTsKICAgICAgICAgICAgICAgIGZvciAoQVtyIC0gMV0gPSBpLCBpID0gbiA9IDA7IGkgPCAxNjsgaSsrKQogICAgICAgICAgICAgICAgICBmb3IgKFRbaV0gPSBuLCB0ID0gMDsgdCA8IDEgPDwga1tpXTsgdCsrKSBFW24rK10gPSBpOwogICAgICAgICAgICAgICAgZm9yIChuID4+PSA3OyBpIDwgZjsgaSsrKQogICAgICAgICAgICAgICAgICBmb3IgKFRbaV0gPSBuIDw8IDcsIHQgPSAwOyB0IDwgMSA8PCAoa1tpXSAtIDcpOyB0KyspCiAgICAgICAgICAgICAgICAgICAgRVsyNTYgKyBuKytdID0gaTsKICAgICAgICAgICAgICAgIGZvciAoZSA9IDA7IGUgPD0gZzsgZSsrKSBzW2VdID0gMDsKICAgICAgICAgICAgICAgIGZvciAodCA9IDA7IHQgPD0gMTQzOyApICh6WzIgKiB0ICsgMV0gPSA4KSwgdCsrLCBzWzhdKys7CiAgICAgICAgICAgICAgICBmb3IgKDsgdCA8PSAyNTU7ICkgKHpbMiAqIHQgKyAxXSA9IDkpLCB0KyssIHNbOV0rKzsKICAgICAgICAgICAgICAgIGZvciAoOyB0IDw9IDI3OTsgKSAoelsyICogdCArIDFdID0gNyksIHQrKywgc1s3XSsrOwogICAgICAgICAgICAgICAgZm9yICg7IHQgPD0gMjg3OyApICh6WzIgKiB0ICsgMV0gPSA4KSwgdCsrLCBzWzhdKys7CiAgICAgICAgICAgICAgICBmb3IgKFooeiwgbCArIDEsIHMpLCB0ID0gMDsgdCA8IGY7IHQrKykKICAgICAgICAgICAgICAgICAgKENbMiAqIHQgKyAxXSA9IDUpLCAoQ1syICogdF0gPSBqKHQsIDUpKTsKICAgICAgICAgICAgICAgIChPID0gbmV3IEQoeiwgdywgdSArIDEsIGwsIGcpKSwKICAgICAgICAgICAgICAgICAgKEIgPSBuZXcgRChDLCBrLCAwLCBmLCBnKSksCiAgICAgICAgICAgICAgICAgIChSID0gbmV3IEQobmV3IEFycmF5KDApLCB4LCAwLCBkLCBwKSk7CiAgICAgICAgICAgICAgfSkoKSwKICAgICAgICAgICAgICAocSA9ICEwKSksCiAgICAgICAgICAgICAgKHQubF9kZXNjID0gbmV3IEYodC5keW5fbHRyZWUsIE8pKSwKICAgICAgICAgICAgICAodC5kX2Rlc2MgPSBuZXcgRih0LmR5bl9kdHJlZSwgQikpLAogICAgICAgICAgICAgICh0LmJsX2Rlc2MgPSBuZXcgRih0LmJsX3RyZWUsIFIpKSwKICAgICAgICAgICAgICAodC5iaV9idWYgPSAwKSwKICAgICAgICAgICAgICAodC5iaV92YWxpZCA9IDApLAogICAgICAgICAgICAgIFcodCk7CiAgICAgICAgICB9KSwKICAgICAgICAgICAgKHIuX3RyX3N0b3JlZF9ibG9jayA9IEopLAogICAgICAgICAgICAoci5fdHJfZmx1c2hfYmxvY2sgPSBmdW5jdGlvbiAodCwgZSwgciwgaSkgewogICAgICAgICAgICAgIHZhciBuLAogICAgICAgICAgICAgICAgcywKICAgICAgICAgICAgICAgIGEgPSAwOwogICAgICAgICAgICAgIDAgPCB0LmxldmVsCiAgICAgICAgICAgICAgICA/ICgyID09PSB0LnN0cm0uZGF0YV90eXBlICYmCiAgICAgICAgICAgICAgICAgICAgKHQuc3RybS5kYXRhX3R5cGUgPSAoZnVuY3Rpb24gKHQpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciBlLAogICAgICAgICAgICAgICAgICAgICAgICByID0gNDA5MzYyNDQ0NzsKICAgICAgICAgICAgICAgICAgICAgIGZvciAoZSA9IDA7IGUgPD0gMzE7IGUrKywgciA+Pj49IDEpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgxICYgciAmJiAwICE9PSB0LmR5bl9sdHJlZVsyICogZV0pIHJldHVybiBvOwogICAgICAgICAgICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgICAgICAgICAwICE9PSB0LmR5bl9sdHJlZVsxOF0gfHwKICAgICAgICAgICAgICAgICAgICAgICAgMCAhPT0gdC5keW5fbHRyZWVbMjBdIHx8CiAgICAgICAgICAgICAgICAgICAgICAgIDAgIT09IHQuZHluX2x0cmVlWzI2XQogICAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaDsKICAgICAgICAgICAgICAgICAgICAgIGZvciAoZSA9IDMyOyBlIDwgdTsgZSsrKQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoMCAhPT0gdC5keW5fbHRyZWVbMiAqIGVdKSByZXR1cm4gaDsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvOwogICAgICAgICAgICAgICAgICAgIH0pKHQpKSwKICAgICAgICAgICAgICAgICAgWSh0LCB0LmxfZGVzYyksCiAgICAgICAgICAgICAgICAgIFkodCwgdC5kX2Rlc2MpLAogICAgICAgICAgICAgICAgICAoYSA9IChmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgICAgICAgIHZhciBlOwogICAgICAgICAgICAgICAgICAgIGZvciAoCiAgICAgICAgICAgICAgICAgICAgICBYKHQsIHQuZHluX2x0cmVlLCB0LmxfZGVzYy5tYXhfY29kZSksCiAgICAgICAgICAgICAgICAgICAgICAgIFgodCwgdC5keW5fZHRyZWUsIHQuZF9kZXNjLm1heF9jb2RlKSwKICAgICAgICAgICAgICAgICAgICAgICAgWSh0LCB0LmJsX2Rlc2MpLAogICAgICAgICAgICAgICAgICAgICAgICBlID0gZCAtIDE7CiAgICAgICAgICAgICAgICAgICAgICAzIDw9IGUgJiYgMCA9PT0gdC5ibF90cmVlWzIgKiBTW2VdICsgMV07CiAgICAgICAgICAgICAgICAgICAgICBlLS0KICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAodC5vcHRfbGVuICs9IDMgKiAoZSArIDEpICsgNSArIDUgKyA0KSwgZTsKICAgICAgICAgICAgICAgICAgfSkodCkpLAogICAgICAgICAgICAgICAgICAobiA9ICh0Lm9wdF9sZW4gKyAzICsgNykgPj4+IDMpLAogICAgICAgICAgICAgICAgICAocyA9ICh0LnN0YXRpY19sZW4gKyAzICsgNykgPj4+IDMpIDw9IG4gJiYgKG4gPSBzKSkKICAgICAgICAgICAgICAgIDogKG4gPSBzID0gciArIDUpLAogICAgICAgICAgICAgICAgciArIDQgPD0gbiAmJiAtMSAhPT0gZQogICAgICAgICAgICAgICAgICA/IEoodCwgZSwgciwgaSkKICAgICAgICAgICAgICAgICAgOiA0ID09PSB0LnN0cmF0ZWd5IHx8IHMgPT09IG4KICAgICAgICAgICAgICAgICAgICA/IChQKHQsIDIgKyAoaSA/IDEgOiAwKSwgMyksIEsodCwgeiwgQykpCiAgICAgICAgICAgICAgICAgICAgOiAoUCh0LCA0ICsgKGkgPyAxIDogMCksIDMpLAogICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICh0LCBlLCByLCBpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuOwogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKAogICAgICAgICAgICAgICAgICAgICAgICAgIFAodCwgZSAtIDI1NywgNSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQKHQsIHIgLSAxLCA1KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFAodCwgaSAtIDQsIDQpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbiA9IDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgbiA8IGk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgbisrCiAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICBQKHQsIHQuYmxfdHJlZVsyICogU1tuXSArIDFdLCAzKTsKICAgICAgICAgICAgICAgICAgICAgICAgVih0LCB0LmR5bl9sdHJlZSwgZSAtIDEpLCBWKHQsIHQuZHluX2R0cmVlLCByIC0gMSk7CiAgICAgICAgICAgICAgICAgICAgICB9KSgKICAgICAgICAgICAgICAgICAgICAgICAgdCwKICAgICAgICAgICAgICAgICAgICAgICAgdC5sX2Rlc2MubWF4X2NvZGUgKyAxLAogICAgICAgICAgICAgICAgICAgICAgICB0LmRfZGVzYy5tYXhfY29kZSArIDEsCiAgICAgICAgICAgICAgICAgICAgICAgIGEgKyAxLAogICAgICAgICAgICAgICAgICAgICAgKSwKICAgICAgICAgICAgICAgICAgICAgIEsodCwgdC5keW5fbHRyZWUsIHQuZHluX2R0cmVlKSksCiAgICAgICAgICAgICAgICBXKHQpLAogICAgICAgICAgICAgICAgaSAmJiBNKHQpOwogICAgICAgICAgICB9KSwKICAgICAgICAgICAgKHIuX3RyX3RhbGx5ID0gZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAgICAgKHQucGVuZGluZ19idWZbdC5kX2J1ZiArIDIgKiB0Lmxhc3RfbGl0XSA9IChlID4+PiA4KSAmIDI1NSksCiAgICAgICAgICAgICAgICAodC5wZW5kaW5nX2J1Zlt0LmRfYnVmICsgMiAqIHQubGFzdF9saXQgKyAxXSA9IDI1NSAmIGUpLAogICAgICAgICAgICAgICAgKHQucGVuZGluZ19idWZbdC5sX2J1ZiArIHQubGFzdF9saXRdID0gMjU1ICYgciksCiAgICAgICAgICAgICAgICB0Lmxhc3RfbGl0KyssCiAgICAgICAgICAgICAgICAwID09PSBlCiAgICAgICAgICAgICAgICAgID8gdC5keW5fbHRyZWVbMiAqIHJdKysKICAgICAgICAgICAgICAgICAgOiAodC5tYXRjaGVzKyssCiAgICAgICAgICAgICAgICAgICAgZS0tLAogICAgICAgICAgICAgICAgICAgIHQuZHluX2x0cmVlWzIgKiAoQVtyXSArIHUgKyAxKV0rKywKICAgICAgICAgICAgICAgICAgICB0LmR5bl9kdHJlZVsyICogTihlKV0rKyksCiAgICAgICAgICAgICAgICB0Lmxhc3RfbGl0ID09PSB0LmxpdF9idWZzaXplIC0gMQogICAgICAgICAgICAgICk7CiAgICAgICAgICAgIH0pLAogICAgICAgICAgICAoci5fdHJfYWxpZ24gPSBmdW5jdGlvbiAodCkgewogICAgICAgICAgICAgIFAodCwgMiwgMyksCiAgICAgICAgICAgICAgICBMKHQsIG0sIHopLAogICAgICAgICAgICAgICAgKGZ1bmN0aW9uICh0KSB7CiAgICAgICAgICAgICAgICAgIDE2ID09PSB0LmJpX3ZhbGlkCiAgICAgICAgICAgICAgICAgICAgPyAoVSh0LCB0LmJpX2J1ZiksICh0LmJpX2J1ZiA9IDApLCAodC5iaV92YWxpZCA9IDApKQogICAgICAgICAgICAgICAgICAgIDogOCA8PSB0LmJpX3ZhbGlkICYmCiAgICAgICAgICAgICAgICAgICAgICAoKHQucGVuZGluZ19idWZbdC5wZW5kaW5nKytdID0gMjU1ICYgdC5iaV9idWYpLAogICAgICAgICAgICAgICAgICAgICAgKHQuYmlfYnVmID4+PSA4KSwKICAgICAgICAgICAgICAgICAgICAgICh0LmJpX3ZhbGlkIC09IDgpKTsKICAgICAgICAgICAgICAgIH0pKHQpOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIHsgIi4uL3V0aWxzL2NvbW1vbiI6IDQxIH0sCiAgICAgIF0sCiAgICAgIDUzOiBbCiAgICAgICAgZnVuY3Rpb24gKHQsIGUsIHIpIHsKICAgICAgICAgICJ1c2Ugc3RyaWN0IjsKICAgICAgICAgIGUuZXhwb3J0cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgKHRoaXMuaW5wdXQgPSBudWxsKSwKICAgICAgICAgICAgICAodGhpcy5uZXh0X2luID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuYXZhaWxfaW4gPSAwKSwKICAgICAgICAgICAgICAodGhpcy50b3RhbF9pbiA9IDApLAogICAgICAgICAgICAgICh0aGlzLm91dHB1dCA9IG51bGwpLAogICAgICAgICAgICAgICh0aGlzLm5leHRfb3V0ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMuYXZhaWxfb3V0ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMudG90YWxfb3V0ID0gMCksCiAgICAgICAgICAgICAgKHRoaXMubXNnID0gIiIpLAogICAgICAgICAgICAgICh0aGlzLnN0YXRlID0gbnVsbCksCiAgICAgICAgICAgICAgKHRoaXMuZGF0YV90eXBlID0gMiksCiAgICAgICAgICAgICAgKHRoaXMuYWRsZXIgPSAwKTsKICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB7fSwKICAgICAgXSwKICAgICAgNTQ6IFsKICAgICAgICBmdW5jdGlvbiAodCwgZSwgcikgewogICAgICAgICAgInVzZSBzdHJpY3QiOwogICAgICAgICAgZS5leHBvcnRzID0KICAgICAgICAgICAgImZ1bmN0aW9uIiA9PSB0eXBlb2Ygc2V0SW1tZWRpYXRlCiAgICAgICAgICAgICAgPyBzZXRJbW1lZGlhdGUKICAgICAgICAgICAgICA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgdmFyIHQgPSBbXS5zbGljZS5hcHBseShhcmd1bWVudHMpOwogICAgICAgICAgICAgICAgICB0LnNwbGljZSgxLCAwLCAwKSwgc2V0VGltZW91dC5hcHBseShudWxsLCB0KTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgfSwKICAgICAgICB7fSwKICAgICAgXSwKICAgIH0sCiAgICB7fSwKICAgIFsxMF0sCiAgKSgxMCk7Cn0pOwo="},{"meta":{"name":"FileSaver.js","url":"https://update.greasyfork.org/scripts/498746/1399668/FileSaver.js","ts":1770962851873,"mimetype":"text/javascript"},"source":"KGZ1bmN0aW9uIChhLCBiKSB7CiAgaWYgKCJmdW5jdGlvbiIgPT0gdHlwZW9mIGRlZmluZSAmJiBkZWZpbmUuYW1kKSBkZWZpbmUoW10sIGIpOwogIGVsc2UgaWYgKCJ1bmRlZmluZWQiICE9IHR5cGVvZiBleHBvcnRzKSBiKCk7CiAgZWxzZSB7CiAgICBiKCksIChhLkZpbGVTYXZlciA9IHsgZXhwb3J0czoge30gfS5leHBvcnRzKTsKICB9Cn0pKHRoaXMsIGZ1bmN0aW9uICgpIHsKICAidXNlIHN0cmljdCI7CiAgZnVuY3Rpb24gYihhLCBiKSB7CiAgICByZXR1cm4gKAogICAgICAidW5kZWZpbmVkIiA9PSB0eXBlb2YgYgogICAgICAgID8gKGIgPSB7IGF1dG9Cb206ICExIH0pCiAgICAgICAgOiAib2JqZWN0IiAhPSB0eXBlb2YgYiAmJgogICAgICAgICAgKGNvbnNvbGUud2FybigiRGVwcmVjYXRlZDogRXhwZWN0ZWQgdGhpcmQgYXJndW1lbnQgdG8gYmUgYSBvYmplY3QiKSwKICAgICAgICAgIChiID0geyBhdXRvQm9tOiAhYiB9KSksCiAgICAgIGIuYXV0b0JvbSAmJgogICAgICAvXlxzKig/OnRleHRcL1xTKnxhcHBsaWNhdGlvblwveG1sfFxTKlwvXFMqXCt4bWwpXHMqOy4qY2hhcnNldFxzKj1ccyp1dGYtOC9pLnRlc3QoCiAgICAgICAgYS50eXBlCiAgICAgICkKICAgICAgICA/IG5ldyBCbG9iKFsiXHVGRUZGIiwgYV0sIHsgdHlwZTogYS50eXBlIH0pCiAgICAgICAgOiBhCiAgICApOwogIH0KICBmdW5jdGlvbiBjKGEsIGIsIGMpIHsKICAgIHZhciBkID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICBkLm9wZW4oIkdFVCIsIGEpLAogICAgICAoZC5yZXNwb25zZVR5cGUgPSAiYmxvYiIpLAogICAgICAoZC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgZyhkLnJlc3BvbnNlLCBiLCBjKTsKICAgICAgfSksCiAgICAgIChkLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiY291bGQgbm90IGRvd25sb2FkIGZpbGUiKTsKICAgICAgfSksCiAgICAgIGQuc2VuZCgpOwogIH0KICBmdW5jdGlvbiBkKGEpIHsKICAgIHZhciBiID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICBiLm9wZW4oIkhFQUQiLCBhLCAhMSk7CiAgICB0cnkgewogICAgICBiLnNlbmQoKTsKICAgIH0gY2F0Y2ggKGEpIHt9CiAgICByZXR1cm4gMjAwIDw9IGIuc3RhdHVzICYmIDI5OSA+PSBiLnN0YXR1czsKICB9CiAgZnVuY3Rpb24gZShhKSB7CiAgICB0cnkgewogICAgICBhLmRpc3BhdGNoRXZlbnQobmV3IE1vdXNlRXZlbnQoImNsaWNrIikpOwogICAgfSBjYXRjaCAoYykgewogICAgICB2YXIgYiA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCJNb3VzZUV2ZW50cyIpOwogICAgICBiLmluaXRNb3VzZUV2ZW50KAogICAgICAgICJjbGljayIsCiAgICAgICAgITAsCiAgICAgICAgITAsCiAgICAgICAgd2luZG93LAogICAgICAgIDAsCiAgICAgICAgMCwKICAgICAgICAwLAogICAgICAgIDgwLAogICAgICAgIDIwLAogICAgICAgICExLAogICAgICAgICExLAogICAgICAgICExLAogICAgICAgICExLAogICAgICAgIDAsCiAgICAgICAgbnVsbAogICAgICApLAogICAgICAgIGEuZGlzcGF0Y2hFdmVudChiKTsKICAgIH0KICB9CiAgdmFyIGYgPQogICAgICAib2JqZWN0IiA9PSB0eXBlb2Ygd2luZG93ICYmIHdpbmRvdy53aW5kb3cgPT09IHdpbmRvdwogICAgICAgID8gd2luZG93CiAgICAgICAgOiAib2JqZWN0IiA9PSB0eXBlb2Ygc2VsZiAmJiBzZWxmLnNlbGYgPT09IHNlbGYKICAgICAgICA/IHNlbGYKICAgICAgICA6ICJvYmplY3QiID09IHR5cGVvZiBnbG9iYWwgJiYgZ2xvYmFsLmdsb2JhbCA9PT0gZ2xvYmFsCiAgICAgICAgPyBnbG9iYWwKICAgICAgICA6IHZvaWQgMCwKICAgIGEgPQogICAgICBmLm5hdmlnYXRvciAmJgogICAgICAvTWFjaW50b3NoLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpICYmCiAgICAgIC9BcHBsZVdlYktpdC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSAmJgogICAgICAhL1NhZmFyaS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSwKICAgIGcgPQogICAgICBmLnNhdmVBcyB8fAogICAgICAoIm9iamVjdCIgIT0gdHlwZW9mIHdpbmRvdyB8fCB3aW5kb3cgIT09IGYKICAgICAgICA/IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgOiAiZG93bmxvYWQiIGluIEhUTUxBbmNob3JFbGVtZW50LnByb3RvdHlwZSAmJiAhYQogICAgICAgID8gZnVuY3Rpb24gKGIsIGcsIGgpIHsKICAgICAgICAgICAgdmFyIGkgPSBmLlVSTCB8fCBmLndlYmtpdFVSTCwKICAgICAgICAgICAgICBqID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICAgICAgICAoZyA9IGcgfHwgYi5uYW1lIHx8ICJkb3dubG9hZCIpLAogICAgICAgICAgICAgIChqLmRvd25sb2FkID0gZyksCiAgICAgICAgICAgICAgKGoucmVsID0gIm5vb3BlbmVyIiksCiAgICAgICAgICAgICAgInN0cmluZyIgPT0gdHlwZW9mIGIKICAgICAgICAgICAgICAgID8gKChqLmhyZWYgPSBiKSwKICAgICAgICAgICAgICAgICAgai5vcmlnaW4gPT09IGxvY2F0aW9uLm9yaWdpbgogICAgICAgICAgICAgICAgICAgID8gZShqKQogICAgICAgICAgICAgICAgICAgIDogZChqLmhyZWYpCiAgICAgICAgICAgICAgICAgICAgPyBjKGIsIGcsIGgpCiAgICAgICAgICAgICAgICAgICAgOiBlKGosIChqLnRhcmdldCA9ICJfYmxhbmsiKSkpCiAgICAgICAgICAgICAgICA6ICgoai5ocmVmID0gaS5jcmVhdGVPYmplY3RVUkwoYikpLAogICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBpLnJldm9rZU9iamVjdFVSTChqLmhyZWYpOwogICAgICAgICAgICAgICAgICB9LCA0ZTQpLAogICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBlKGopOwogICAgICAgICAgICAgICAgICB9LCAwKSk7CiAgICAgICAgICB9CiAgICAgICAgOiAibXNTYXZlT3JPcGVuQmxvYiIgaW4gbmF2aWdhdG9yCiAgICAgICAgPyBmdW5jdGlvbiAoZiwgZywgaCkgewogICAgICAgICAgICBpZiAoKChnID0gZyB8fCBmLm5hbWUgfHwgImRvd25sb2FkIiksICJzdHJpbmciICE9IHR5cGVvZiBmKSkKICAgICAgICAgICAgICBuYXZpZ2F0b3IubXNTYXZlT3JPcGVuQmxvYihiKGYsIGgpLCBnKTsKICAgICAgICAgICAgZWxzZSBpZiAoZChmKSkgYyhmLCBnLCBoKTsKICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgdmFyIGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIik7CiAgICAgICAgICAgICAgKGkuaHJlZiA9IGYpLAogICAgICAgICAgICAgICAgKGkudGFyZ2V0ID0gIl9ibGFuayIpLAogICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgIGUoaSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIDogZnVuY3Rpb24gKGIsIGQsIGUsIGcpIHsKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICgoZyA9IGcgfHwgb3BlbigiIiwgIl9ibGFuayIpKSwKICAgICAgICAgICAgICBnICYmCiAgICAgICAgICAgICAgICAoZy5kb2N1bWVudC50aXRsZSA9IGcuZG9jdW1lbnQuYm9keS5pbm5lclRleHQgPQogICAgICAgICAgICAgICAgICAiZG93bmxvYWRpbmcuLi4iKSwKICAgICAgICAgICAgICAic3RyaW5nIiA9PSB0eXBlb2YgYikKICAgICAgICAgICAgKQogICAgICAgICAgICAgIHJldHVybiBjKGIsIGQsIGUpOwogICAgICAgICAgICB2YXIgaCA9ICJhcHBsaWNhdGlvbi9vY3RldC1zdHJlYW0iID09PSBiLnR5cGUsCiAgICAgICAgICAgICAgaSA9IC9jb25zdHJ1Y3Rvci9pLnRlc3QoZi5IVE1MRWxlbWVudCkgfHwgZi5zYWZhcmksCiAgICAgICAgICAgICAgaiA9IC9DcmlPU1wvW1xkXSsvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgICAgICAgICAgIGlmICgoaiB8fCAoaCAmJiBpKSB8fCBhKSAmJiAidW5kZWZpbmVkIiAhPSB0eXBlb2YgRmlsZVJlYWRlcikgewogICAgICAgICAgICAgIHZhciBrID0gbmV3IEZpbGVSZWFkZXIoKTsKICAgICAgICAgICAgICAoay5vbmxvYWRlbmQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICB2YXIgYSA9IGsucmVzdWx0OwogICAgICAgICAgICAgICAgKGEgPSBqCiAgICAgICAgICAgICAgICAgID8gYQogICAgICAgICAgICAgICAgICA6IGEucmVwbGFjZSgvXmRhdGE6W147XSo7LywgImRhdGE6YXR0YWNobWVudC9maWxlOyIpKSwKICAgICAgICAgICAgICAgICAgZyA/IChnLmxvY2F0aW9uLmhyZWYgPSBhKSA6IChsb2NhdGlvbiA9IGEpLAogICAgICAgICAgICAgICAgICAoZyA9IG51bGwpOwogICAgICAgICAgICAgIH0pLAogICAgICAgICAgICAgICAgay5yZWFkQXNEYXRhVVJMKGIpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHZhciBsID0gZi5VUkwgfHwgZi53ZWJraXRVUkwsCiAgICAgICAgICAgICAgICBtID0gbC5jcmVhdGVPYmplY3RVUkwoYik7CiAgICAgICAgICAgICAgZyA/IChnLmxvY2F0aW9uID0gbSkgOiAobG9jYXRpb24uaHJlZiA9IG0pLAogICAgICAgICAgICAgICAgKGcgPSBudWxsKSwKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBsLnJldm9rZU9iamVjdFVSTChtKTsKICAgICAgICAgICAgICAgIH0sIDRlNCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogIChmLnNhdmVBcyA9IGcuc2F2ZUFzID0gZyksCiAgICAidW5kZWZpbmVkIiAhPSB0eXBlb2YgbW9kdWxlICYmIChtb2R1bGUuZXhwb3J0cyA9IGcpOwp9KTsKCi8vIyBzb3VyY2VNYXBwaW5nVVJMPUZpbGVTYXZlci5taW4uanMubWFwCg=="},{"meta":{"name":"gifjs.js","url":"https://greasyfork.org/scripts/2963-gif-js/code/gifjs.js?version=8596","ts":1770962852632,"mimetype":"text/javascript"},"source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgIGdpZi5qcwovLyBAbmFtZXNwYWNlICAgaHR0cDovL21maXNoLnR3YmJzLm9yZy8KLy8gQHZlcnNpb24gICAgIDAuMS42Ci8vIEBncmFudCAgICAgICBub25lCi8vID09L1VzZXJTY3JpcHQ9PQoKLyoqCiAqIAogKiBJIGRpZG4ndCBjcmVhdGUgdGhpcywganVzdCBtb2RpZmllZCBpdCB0byBhbGxvdyBpdCBydW5uaW5nIGluIHVzZXJzY3JpcHQuCiAqIEF1dGhlciA6IGh0dHBzOi8vZ2l0aHViLmNvbS9qbm9yZGJlcmcvZ2lmLmpzCiAqCiAqLwoKdmFyIEdJRl93b3JrZXJfVVJMID0gKGZ1bmN0aW9uICgpIHsKICAgIHZhciB3b3JrZXJTY3JpcHQgPSAiKGZ1bmN0aW9uKGIpe2Z1bmN0aW9uIGEoYixkKXtpZih7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGEuY2FjaGUsYikpcmV0dXJuIGEuY2FjaGVbYl07dmFyIGU9YS5yZXNvbHZlKGIpO2lmKCFlKXRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHJlc29sdmUgbW9kdWxlICcrYik7dmFyIGM9e2lkOmIscmVxdWlyZTphLGZpbGVuYW1lOmIsZXhwb3J0czp7fSxsb2FkZWQ6ITEscGFyZW50OmQsY2hpbGRyZW46W119O2QmJmQuY2hpbGRyZW4ucHVzaChjKTt2YXIgZj1iLnNsaWNlKDAsYi5sYXN0SW5kZXhPZignLycpKzEpO3JldHVybiBhLmNhY2hlW2JdPWMuZXhwb3J0cyxlLmNhbGwoYy5leHBvcnRzLGMsYy5leHBvcnRzLGYsYiksYy5sb2FkZWQ9ITAsYS5jYWNoZVtiXT1jLmV4cG9ydHN9YS5tb2R1bGVzPXt9LGEuY2FjaGU9e30sYS5yZXNvbHZlPWZ1bmN0aW9uKGIpe3JldHVybnt9Lmhhc093blByb3BlcnR5LmNhbGwoYS5tb2R1bGVzLGIpP2EubW9kdWxlc1tiXTp2b2lkIDB9LGEuZGVmaW5lPWZ1bmN0aW9uKGIsYyl7YS5tb2R1bGVzW2JdPWN9LGEuZGVmaW5lKCcvZ2lmLndvcmtlci5jb2ZmZWUnLGZ1bmN0aW9uKGQsZSxmLGcpe3ZhciBiLGM7Yj1hKCcvR0lGRW5jb2Rlci5qcycsZCksYz1mdW5jdGlvbihhKXt2YXIgYyxlLGQsZjtyZXR1cm4gYz1uZXcgYihhLndpZHRoLGEuaGVpZ2h0KSxhLmluZGV4PT09MD9jLndyaXRlSGVhZGVyKCk6Yy5maXJzdEZyYW1lPSExLGMuc2V0VHJhbnNwYXJlbnQoYS50cmFuc3BhcmVudCksYy5zZXRSZXBlYXQoYS5yZXBlYXQpLGMuc2V0RGVsYXkoYS5kZWxheSksYy5zZXRRdWFsaXR5KGEucXVhbGl0eSksYy5hZGRGcmFtZShhLmRhdGEpLGEubGFzdCYmYy5maW5pc2goKSxkPWMuc3RyZWFtKCksYS5kYXRhPWQucGFnZXMsYS5jdXJzb3I9ZC5jdXJzb3IsYS5wYWdlU2l6ZT1kLmNvbnN0cnVjdG9yLnBhZ2VTaXplLGEuY2FuVHJhbnNmZXI/KGY9ZnVuY3Rpb24oYyl7Zm9yKHZhciBiPTAsZD1hLmRhdGEubGVuZ3RoO2I8ZDsrK2IpZT1hLmRhdGFbYl0sYy5wdXNoKGUuYnVmZmVyKTtyZXR1cm4gY30uY2FsbCh0aGlzLFtdKSxzZWxmLnBvc3RNZXNzYWdlKGEsZikpOnNlbGYucG9zdE1lc3NhZ2UoYSl9LHNlbGYub25tZXNzYWdlPWZ1bmN0aW9uKGEpe3JldHVybiBjKGEuZGF0YSl9fSksYS5kZWZpbmUoJy9HSUZFbmNvZGVyLmpzJyxmdW5jdGlvbihlLGgsaSxqKXtmdW5jdGlvbiBjKCl7dGhpcy5wYWdlPS0xLHRoaXMucGFnZXM9W10sdGhpcy5uZXdQYWdlKCl9ZnVuY3Rpb24gYihhLGIpe3RoaXMud2lkdGg9fn5hLHRoaXMuaGVpZ2h0PX5+Yix0aGlzLnRyYW5zcGFyZW50PW51bGwsdGhpcy50cmFuc0luZGV4PTAsdGhpcy5yZXBlYXQ9LTEsdGhpcy5kZWxheT0wLHRoaXMuaW1hZ2U9bnVsbCx0aGlzLnBpeGVscz1udWxsLHRoaXMuaW5kZXhlZFBpeGVscz1udWxsLHRoaXMuY29sb3JEZXB0aD1udWxsLHRoaXMuY29sb3JUYWI9bnVsbCx0aGlzLnVzZWRFbnRyeT1uZXcgQXJyYXksdGhpcy5wYWxTaXplPTcsdGhpcy5kaXNwb3NlPS0xLHRoaXMuZmlyc3RGcmFtZT0hMCx0aGlzLnNhbXBsZT0xMCx0aGlzLm91dD1uZXcgY312YXIgZj1hKCcvVHlwZWROZXVRdWFudC5qcycsZSksZz1hKCcvTFpXRW5jb2Rlci5qcycsZSk7Yy5wYWdlU2l6ZT00MDk2LGMuY2hhck1hcD17fTtmb3IodmFyIGQ9MDtkPDI1NjtkKyspYy5jaGFyTWFwW2RdPVN0cmluZy5mcm9tQ2hhckNvZGUoZCk7Yy5wcm90b3R5cGUubmV3UGFnZT1mdW5jdGlvbigpe3RoaXMucGFnZXNbKyt0aGlzLnBhZ2VdPW5ldyBVaW50OEFycmF5KGMucGFnZVNpemUpLHRoaXMuY3Vyc29yPTB9LGMucHJvdG90eXBlLmdldERhdGE9ZnVuY3Rpb24oKXt2YXIgZD0nJztmb3IodmFyIGE9MDthPHRoaXMucGFnZXMubGVuZ3RoO2ErKylmb3IodmFyIGI9MDtiPGMucGFnZVNpemU7YisrKWQrPWMuY2hhck1hcFt0aGlzLnBhZ2VzW2FdW2JdXTtyZXR1cm4gZH0sYy5wcm90b3R5cGUud3JpdGVCeXRlPWZ1bmN0aW9uKGEpe3RoaXMuY3Vyc29yPj1jLnBhZ2VTaXplJiZ0aGlzLm5ld1BhZ2UoKSx0aGlzLnBhZ2VzW3RoaXMucGFnZV1bdGhpcy5jdXJzb3IrK109YX0sYy5wcm90b3R5cGUud3JpdGVVVEZCeXRlcz1mdW5jdGlvbihiKXtmb3IodmFyIGM9Yi5sZW5ndGgsYT0wO2E8YzthKyspdGhpcy53cml0ZUJ5dGUoYi5jaGFyQ29kZUF0KGEpKX0sYy5wcm90b3R5cGUud3JpdGVCeXRlcz1mdW5jdGlvbihiLGQsZSl7Zm9yKHZhciBjPWV8fGIubGVuZ3RoLGE9ZHx8MDthPGM7YSsrKXRoaXMud3JpdGVCeXRlKGJbYV0pfSxiLnByb3RvdHlwZS5zZXREZWxheT1mdW5jdGlvbihhKXt0aGlzLmRlbGF5PU1hdGgucm91bmQoYS8xMCl9LGIucHJvdG90eXBlLnNldEZyYW1lUmF0ZT1mdW5jdGlvbihhKXt0aGlzLmRlbGF5PU1hdGgucm91bmQoMTAwL2EpfSxiLnByb3RvdHlwZS5zZXREaXNwb3NlPWZ1bmN0aW9uKGEpe2E+PTAmJih0aGlzLmRpc3Bvc2U9YSl9LGIucHJvdG90eXBlLnNldFJlcGVhdD1mdW5jdGlvbihhKXt0aGlzLnJlcGVhdD1hfSxiLnByb3RvdHlwZS5zZXRUcmFuc3BhcmVudD1mdW5jdGlvbihhKXt0aGlzLnRyYW5zcGFyZW50PWF9LGIucHJvdG90eXBlLmFkZEZyYW1lPWZ1bmN0aW9uKGEpe3RoaXMuaW1hZ2U9YSx0aGlzLmdldEltYWdlUGl4ZWxzKCksdGhpcy5hbmFseXplUGl4ZWxzKCksdGhpcy5maXJzdEZyYW1lJiYodGhpcy53cml0ZUxTRCgpLHRoaXMud3JpdGVQYWxldHRlKCksdGhpcy5yZXBlYXQ+PTAmJnRoaXMud3JpdGVOZXRzY2FwZUV4dCgpKSx0aGlzLndyaXRlR3JhcGhpY0N0cmxFeHQoKSx0aGlzLndyaXRlSW1hZ2VEZXNjKCksdGhpcy5maXJzdEZyYW1lfHx0aGlzLndyaXRlUGFsZXR0ZSgpLHRoaXMud3JpdGVQaXhlbHMoKSx0aGlzLmZpcnN0RnJhbWU9ITF9LGIucHJvdG90eXBlLmZpbmlzaD1mdW5jdGlvbigpe3RoaXMub3V0LndyaXRlQnl0ZSg1OSl9LGIucHJvdG90eXBlLnNldFF1YWxpdHk9ZnVuY3Rpb24oYSl7YTwxJiYoYT0xKSx0aGlzLnNhbXBsZT1hfSxiLnByb3RvdHlwZS53cml0ZUhlYWRlcj1mdW5jdGlvbigpe3RoaXMub3V0LndyaXRlVVRGQnl0ZXMoJ0dJRjg5YScpfSxiLnByb3RvdHlwZS5hbmFseXplUGl4ZWxzPWZ1bmN0aW9uKCl7dmFyIGc9dGhpcy5waXhlbHMubGVuZ3RoLGQ9Zy8zO3RoaXMuaW5kZXhlZFBpeGVscz1uZXcgVWludDhBcnJheShkKTt2YXIgYT1uZXcgZih0aGlzLnBpeGVscyx0aGlzLnNhbXBsZSk7YS5idWlsZENvbG9ybWFwKCksdGhpcy5jb2xvclRhYj1hLmdldENvbG9ybWFwKCk7dmFyIGI9MDtmb3IodmFyIGM9MDtjPGQ7YysrKXt2YXIgZT1hLmxvb2t1cFJHQih0aGlzLnBpeGVsc1tiKytdJjI1NSx0aGlzLnBpeGVsc1tiKytdJjI1NSx0aGlzLnBpeGVsc1tiKytdJjI1NSk7dGhpcy51c2VkRW50cnlbZV09ITAsdGhpcy5pbmRleGVkUGl4ZWxzW2NdPWV9dGhpcy5waXhlbHM9bnVsbCx0aGlzLmNvbG9yRGVwdGg9OCx0aGlzLnBhbFNpemU9Nyx0aGlzLnRyYW5zcGFyZW50IT09bnVsbCYmKHRoaXMudHJhbnNJbmRleD10aGlzLmZpbmRDbG9zZXN0KHRoaXMudHJhbnNwYXJlbnQpKX0sYi5wcm90b3R5cGUuZmluZENsb3Nlc3Q9ZnVuY3Rpb24oZSl7aWYodGhpcy5jb2xvclRhYj09PW51bGwpcmV0dXJuLTE7dmFyIGs9KGUmMTY3MTE2ODApPj4xNixsPShlJjY1MjgwKT4+OCxtPWUmMjU1LGM9MCxkPTE2Nzc3MjE2LGo9dGhpcy5jb2xvclRhYi5sZW5ndGg7Zm9yKHZhciBhPTA7YTxqOyl7dmFyIGY9ay0odGhpcy5jb2xvclRhYlthKytdJjI1NSksZz1sLSh0aGlzLmNvbG9yVGFiW2ErK10mMjU1KSxoPW0tKHRoaXMuY29sb3JUYWJbYV0mMjU1KSxpPWYqZitnKmcraCpoLGI9cGFyc2VJbnQoYS8zKTt0aGlzLnVzZWRFbnRyeVtiXSYmaTxkJiYoZD1pLGM9YiksYSsrfXJldHVybiBjfSxiLnByb3RvdHlwZS5nZXRJbWFnZVBpeGVscz1mdW5jdGlvbigpe3ZhciBhPXRoaXMud2lkdGgsZz10aGlzLmhlaWdodDt0aGlzLnBpeGVscz1uZXcgVWludDhBcnJheShhKmcqMyk7dmFyIGI9dGhpcy5pbWFnZSxjPTA7Zm9yKHZhciBkPTA7ZDxnO2QrKylmb3IodmFyIGU9MDtlPGE7ZSsrKXt2YXIgZj1kKmEqNCtlKjQ7dGhpcy5waXhlbHNbYysrXT1iW2ZdLHRoaXMucGl4ZWxzW2MrK109YltmKzFdLHRoaXMucGl4ZWxzW2MrK109YltmKzJdfX0sYi5wcm90b3R5cGUud3JpdGVHcmFwaGljQ3RybEV4dD1mdW5jdGlvbigpe3RoaXMub3V0LndyaXRlQnl0ZSgzMyksdGhpcy5vdXQud3JpdGVCeXRlKDI0OSksdGhpcy5vdXQud3JpdGVCeXRlKDQpO3ZhciBiLGE7dGhpcy50cmFuc3BhcmVudD09PW51bGw/KGI9MCxhPTApOihiPTEsYT0yKSx0aGlzLmRpc3Bvc2U+PTAmJihhPWRpc3Bvc2UmNyksYTw8PTIsdGhpcy5vdXQud3JpdGVCeXRlKDB8YXwwfGIpLHRoaXMud3JpdGVTaG9ydCh0aGlzLmRlbGF5KSx0aGlzLm91dC53cml0ZUJ5dGUodGhpcy50cmFuc0luZGV4KSx0aGlzLm91dC53cml0ZUJ5dGUoMCl9LGIucHJvdG90eXBlLndyaXRlSW1hZ2VEZXNjPWZ1bmN0aW9uKCl7dGhpcy5vdXQud3JpdGVCeXRlKDQ0KSx0aGlzLndyaXRlU2hvcnQoMCksdGhpcy53cml0ZVNob3J0KDApLHRoaXMud3JpdGVTaG9ydCh0aGlzLndpZHRoKSx0aGlzLndyaXRlU2hvcnQodGhpcy5oZWlnaHQpLHRoaXMuZmlyc3RGcmFtZT90aGlzLm91dC53cml0ZUJ5dGUoMCk6dGhpcy5vdXQud3JpdGVCeXRlKDEyOHx0aGlzLnBhbFNpemUpfSxiLnByb3RvdHlwZS53cml0ZUxTRD1mdW5jdGlvbigpe3RoaXMud3JpdGVTaG9ydCh0aGlzLndpZHRoKSx0aGlzLndyaXRlU2hvcnQodGhpcy5oZWlnaHQpLHRoaXMub3V0LndyaXRlQnl0ZSgyNDB8dGhpcy5wYWxTaXplKSx0aGlzLm91dC53cml0ZUJ5dGUoMCksdGhpcy5vdXQud3JpdGVCeXRlKDApfSxiLnByb3RvdHlwZS53cml0ZU5ldHNjYXBlRXh0PWZ1bmN0aW9uKCl7dGhpcy5vdXQud3JpdGVCeXRlKDMzKSx0aGlzLm91dC53cml0ZUJ5dGUoMjU1KSx0aGlzLm91dC53cml0ZUJ5dGUoMTEpLHRoaXMub3V0LndyaXRlVVRGQnl0ZXMoJ05FVFNDQVBFMi4wJyksdGhpcy5vdXQud3JpdGVCeXRlKDMpLHRoaXMub3V0LndyaXRlQnl0ZSgxKSx0aGlzLndyaXRlU2hvcnQodGhpcy5yZXBlYXQpLHRoaXMub3V0LndyaXRlQnl0ZSgwKX0sYi5wcm90b3R5cGUud3JpdGVQYWxldHRlPWZ1bmN0aW9uKCl7dGhpcy5vdXQud3JpdGVCeXRlcyh0aGlzLmNvbG9yVGFiKTt2YXIgYj03NjgtdGhpcy5jb2xvclRhYi5sZW5ndGg7Zm9yKHZhciBhPTA7YTxiO2ErKyl0aGlzLm91dC53cml0ZUJ5dGUoMCl9LGIucHJvdG90eXBlLndyaXRlU2hvcnQ9ZnVuY3Rpb24oYSl7dGhpcy5vdXQud3JpdGVCeXRlKGEmMjU1KSx0aGlzLm91dC53cml0ZUJ5dGUoYT4+OCYyNTUpfSxiLnByb3RvdHlwZS53cml0ZVBpeGVscz1mdW5jdGlvbigpe3ZhciBhPW5ldyBnKHRoaXMud2lkdGgsdGhpcy5oZWlnaHQsdGhpcy5pbmRleGVkUGl4ZWxzLHRoaXMuY29sb3JEZXB0aCk7YS5lbmNvZGUodGhpcy5vdXQpfSxiLnByb3RvdHlwZS5zdHJlYW09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5vdXR9LGUuZXhwb3J0cz1ifSksYS5kZWZpbmUoJy9MWldFbmNvZGVyLmpzJyxmdW5jdGlvbihlLGcsaCxpKXtmdW5jdGlvbiBmKHksRCxDLEIpe2Z1bmN0aW9uIHcoYSxiKXtyW2YrK109YSxmPj0yNTQmJnQoYil9ZnVuY3Rpb24geChiKXt1KGEpLGs9aSsyLGo9ITAsbChpLGIpfWZ1bmN0aW9uIHUoYil7Zm9yKHZhciBhPTA7YTxiOysrYSloW2FdPS0xfWZ1bmN0aW9uIEEoeixyKXt2YXIgZyx0LGQsZSx5LHcscztmb3IocT16LGo9ITEsbl9iaXRzPXEsbT1wKG5fYml0cyksaT0xPDx6LTEsbz1pKzEsaz1pKzIsZj0wLGU9digpLHM9MCxnPWE7Zzw2NTUzNjtnKj0yKSsrcztzPTgtcyx3PWEsdSh3KSxsKGkscik7YTp3aGlsZSgodD12KCkpIT1jKXtpZihnPSh0PDxiKStlLGQ9dDw8c15lLGhbZF09PT1nKXtlPW5bZF07Y29udGludWV9aWYoaFtkXT49MCl7eT13LWQsZD09PTAmJih5PTEpO2RvIGlmKChkLT15KTwwJiYoZCs9dyksaFtkXT09PWcpe2U9bltkXTtjb250aW51ZSBhfXdoaWxlKGhbZF0+PTApfWwoZSxyKSxlPXQsazwxPDxiPyhuW2RdPWsrKyxoW2RdPWcpOngocil9bChlLHIpLGwobyxyKX1mdW5jdGlvbiB6KGEpe2Eud3JpdGVCeXRlKHMpLHJlbWFpbmluZz15KkQsY3VyUGl4ZWw9MCxBKHMrMSxhKSxhLndyaXRlQnl0ZSgwKX1mdW5jdGlvbiB0KGEpe2Y+MCYmKGEud3JpdGVCeXRlKGYpLGEud3JpdGVCeXRlcyhyLDAsZiksZj0wKX1mdW5jdGlvbiBwKGEpe3JldHVybigxPDxhKS0xfWZ1bmN0aW9uIHYoKXtpZihyZW1haW5pbmc9PT0wKXJldHVybiBjOy0tcmVtYWluaW5nO3ZhciBhPUNbY3VyUGl4ZWwrK107cmV0dXJuIGEmMjU1fWZ1bmN0aW9uIGwoYSxjKXtnJj1kW2VdLGU+MD9nfD1hPDxlOmc9YSxlKz1uX2JpdHM7d2hpbGUoZT49OCl3KGcmMjU1LGMpLGc+Pj04LGUtPTg7aWYoKGs+bXx8aikmJihqPyhtPXAobl9iaXRzPXEpLGo9ITEpOigrK25fYml0cyxuX2JpdHM9PWI/bT0xPDxiOm09cChuX2JpdHMpKSksYT09byl7d2hpbGUoZT4wKXcoZyYyNTUsYyksZz4+PTgsZS09ODt0KGMpfX12YXIgcz1NYXRoLm1heCgyLEIpLHI9bmV3IFVpbnQ4QXJyYXkoMjU2KSxoPW5ldyBJbnQzMkFycmF5KGEpLG49bmV3IEludDMyQXJyYXkoYSksZyxlPTAsZixrPTAsbSxqPSExLHEsaSxvO3RoaXMuZW5jb2RlPXp9dmFyIGM9LTEsYj0xMixhPTUwMDMsZD1bMCwxLDMsNywxNSwzMSw2MywxMjcsMjU1LDUxMSwxMDIzLDIwNDcsNDA5NSw4MTkxLDE2MzgzLDMyNzY3LDY1NTM1XTtlLmV4cG9ydHM9Zn0pLGEuZGVmaW5lKCcvVHlwZWROZXVRdWFudC5qcycsZnVuY3Rpb24oQSxGLEUsRCl7ZnVuY3Rpb24gQyhBLEIpe2Z1bmN0aW9uIEkoKXtvPVtdLHE9bmV3IEludDMyQXJyYXkoMjU2KSx0PW5ldyBJbnQzMkFycmF5KGEpLHk9bmV3IEludDMyQXJyYXkoYSksej1uZXcgSW50MzJBcnJheShhPj4zKTt2YXIgYyxkO2ZvcihjPTA7YzxhO2MrKylkPShjPDxiKzgpL2Esb1tjXT1uZXcgRmxvYXQ2NEFycmF5KFtkLGQsZCwwXSkseVtjXT1lL2EsdFtjXT0wfWZ1bmN0aW9uIEooKXtmb3IodmFyIGM9MDtjPGE7YysrKW9bY11bMF0+Pj1iLG9bY11bMV0+Pj1iLG9bY11bMl0+Pj1iLG9bY11bM109Y31mdW5jdGlvbiBLKGIsYSxjLGUsZil7b1thXVswXS09Yioob1thXVswXS1jKS9kLG9bYV1bMV0tPWIqKG9bYV1bMV0tZSkvZCxvW2FdWzJdLT1iKihvW2FdWzJdLWYpL2R9ZnVuY3Rpb24gTChqLGUsbixsLGspe3ZhciBoPU1hdGguYWJzKGUtaiksaT1NYXRoLm1pbihlK2osYSksZz1lKzEsZj1lLTEsbT0xLGIsZDt3aGlsZShnPGl8fGY+aClkPXpbbSsrXSxnPGkmJihiPW9bZysrXSxiWzBdLT1kKihiWzBdLW4pL2MsYlsxXS09ZCooYlsxXS1sKS9jLGJbMl0tPWQqKGJbMl0taykvYyksZj5oJiYoYj1vW2YtLV0sYlswXS09ZCooYlswXS1uKS9jLGJbMV0tPWQqKGJbMV0tbCkvYyxiWzJdLT1kKihiWzJdLWspL2MpfWZ1bmN0aW9uIEMocCxzLHEpe3ZhciBoPTIxNDc0ODM2NDcsaz1oLGQ9LTEsbT1kLGMsaixlLG4sbDtmb3IoYz0wO2M8YTtjKyspaj1vW2NdLGU9TWF0aC5hYnMoalswXS1wKStNYXRoLmFicyhqWzFdLXMpK01hdGguYWJzKGpbMl0tcSksZTxoJiYoaD1lLGQ9Yyksbj1lLSh0W2NdPj5pLWIpLG48ayYmKGs9bixtPWMpLGw9eVtjXT4+Zyx5W2NdLT1sLHRbY10rPWw8PGY7cmV0dXJuIHlbZF0rPXgsdFtkXS09cixtfWZ1bmN0aW9uIEQoKXt2YXIgZCxiLGUsYyxoLGcsZj0wLGk9MDtmb3IoZD0wO2Q8YTtkKyspe2ZvcihlPW9bZF0saD1kLGc9ZVsxXSxiPWQrMTtiPGE7YisrKWM9b1tiXSxjWzFdPGcmJihoPWIsZz1jWzFdKTtpZihjPW9baF0sZCE9aCYmKGI9Y1swXSxjWzBdPWVbMF0sZVswXT1iLGI9Y1sxXSxjWzFdPWVbMV0sZVsxXT1iLGI9Y1syXSxjWzJdPWVbMl0sZVsyXT1iLGI9Y1szXSxjWzNdPWVbM10sZVszXT1iKSxnIT1mKXtmb3IocVtmXT1pK2Q+PjEsYj1mKzE7YjxnO2IrKylxW2JdPWQ7Zj1nLGk9ZH19Zm9yKHFbZl09aStuPj4xLGI9ZisxO2I8MjU2O2IrKylxW2JdPW59ZnVuY3Rpb24gRShqLGksayl7dmFyIGIsZCxjLGU9MWUzLGg9LTEsZj1xW2ldLGc9Zi0xO3doaWxlKGY8YXx8Zz49MClmPGEmJihkPW9bZl0sYz1kWzFdLWksYz49ZT9mPWE6KGYrKyxjPDAmJihjPS1jKSxiPWRbMF0taixiPDAmJihiPS1iKSxjKz1iLGM8ZSYmKGI9ZFsyXS1rLGI8MCYmKGI9LWIpLGMrPWIsYzxlJiYoZT1jLGg9ZFszXSkpKSksZz49MCYmKGQ9b1tnXSxjPWktZFsxXSxjPj1lP2c9LTE6KGctLSxjPDAmJihjPS1jKSxiPWRbMF0taixiPDAmJihiPS1iKSxjKz1iLGM8ZSYmKGI9ZFsyXS1rLGI8MCYmKGI9LWIpLGMrPWIsYzxlJiYoZT1jLGg9ZFszXSkpKSk7cmV0dXJuIGh9ZnVuY3Rpb24gRigpe3ZhciBjLGY9QS5sZW5ndGgsRD0zMCsoQi0xKS8zLHk9Zi8oMypCKSxxPX5+KHkvdyksbj1kLG89dSxhPW8+Pmg7Zm9yKGE8PTEmJihhPTApLGM9MDtjPGE7YysrKXpbY109biooKGEqYS1jKmMpKm0vKGEqYSkpO3ZhciBpO2Y8cz8oQj0xLGk9Myk6ZiVsIT09MD9pPTMqbDpmJWshPT0wP2k9MyprOmYlcCE9PTA/aT0zKnA6aT0zKmo7dmFyIHIsdCx4LGUsZz0wO2M9MDt3aGlsZShjPHkpaWYocj0oQVtnXSYyNTUpPDxiLHQ9KEFbZysxXSYyNTUpPDxiLHg9KEFbZysyXSYyNTUpPDxiLGU9QyhyLHQseCksSyhuLGUscix0LHgpLGEhPT0wJiZMKGEsZSxyLHQseCksZys9aSxnPj1mJiYoZy09ZiksYysrLHE9PT0wJiYocT0xKSxjJXE9PT0wKWZvcihuLT1uL0Qsby09by92LGE9bz4+aCxhPD0xJiYoYT0wKSxlPTA7ZTxhO2UrKyl6W2VdPW4qKChhKmEtZSplKSptLyhhKmEpKX1mdW5jdGlvbiBHKCl7SSgpLEYoKSxKKCksRCgpfWZ1bmN0aW9uIEgoKXt2YXIgYj1bXSxnPVtdO2Zvcih2YXIgYz0wO2M8YTtjKyspZ1tvW2NdWzNdXT1jO3ZhciBkPTA7Zm9yKHZhciBlPTA7ZTxhO2UrKyl7dmFyIGY9Z1tlXTtiW2QrK109b1tmXVswXSxiW2QrK109b1tmXVsxXSxiW2QrK109b1tmXVsyXX1yZXR1cm4gYn12YXIgbyxxLHQseSx6O3RoaXMuYnVpbGRDb2xvcm1hcD1HLHRoaXMuZ2V0Q29sb3JtYXA9SCx0aGlzLmxvb2t1cFJHQj1FfXZhciB3PTEwMCxhPTI1NixuPWEtMSxiPTQsaT0xNixlPTE8PGksZj0xMCxCPTE8PGYsZz0xMCx4PWU+Pmcscj1lPDxmLWcsej1hPj4zLGg9Nix0PTE8PGgsdT16KnQsdj0zMCxvPTEwLGQ9MTw8byxxPTgsbT0xPDxxLHk9bytxLGM9MTw8eSxsPTQ5OSxrPTQ5MSxwPTQ4NyxqPTUwMyxzPTMqajtBLmV4cG9ydHM9Q30pLGEoJy9naWYud29ya2VyLmNvZmZlZScpfS5jYWxsKHRoaXMsdGhpcykpIjsKICAgIGZ1bmN0aW9uIGdldFVybCAoYmxvYikgewogICAgICAgIHJldHVybiBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOwogICAgfQogICAgZnVuY3Rpb24gY3JlYXRlQmxvYiAodGV4dCwgTUlNRSkgewogICAgICAgIHZhciBhRmlsZVBhcnRzID0gW3RleHRdOwogICAgICAgIHZhciBvTXlCbG9iID0gbmV3IEJsb2IoYUZpbGVQYXJ0cywge3R5cGUgOiBNSU1FfSk7CiAgICAgICAgcmV0dXJuIG9NeUJsb2I7CiAgICB9CiAgICB2YXIgd29ya2VyVVJMID0gZ2V0VXJsKGNyZWF0ZUJsb2Iod29ya2VyU2NyaXB0LCAnYXBwbGljYXRpb24veC1qYXZhc2NyaXB0JykpOwogICAgcmV0dXJuIHdvcmtlclVSTDsKfSgpKTsKKGZ1bmN0aW9uKGMpe2Z1bmN0aW9uIGEoYixkKXtpZih7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGEuY2FjaGUsYikpcmV0dXJuIGEuY2FjaGVbYl07dmFyIGU9YS5yZXNvbHZlKGIpO2lmKCFlKXRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIHJlc29sdmUgbW9kdWxlICcrYik7dmFyIGM9e2lkOmIscmVxdWlyZTphLGZpbGVuYW1lOmIsZXhwb3J0czp7fSxsb2FkZWQ6ITEscGFyZW50OmQsY2hpbGRyZW46W119O2QmJmQuY2hpbGRyZW4ucHVzaChjKTt2YXIgZj1iLnNsaWNlKDAsYi5sYXN0SW5kZXhPZignLycpKzEpO3JldHVybiBhLmNhY2hlW2JdPWMuZXhwb3J0cyxlLmNhbGwoYy5leHBvcnRzLGMsYy5leHBvcnRzLGYsYiksYy5sb2FkZWQ9ITAsYS5jYWNoZVtiXT1jLmV4cG9ydHN9YS5tb2R1bGVzPXt9LGEuY2FjaGU9e30sYS5yZXNvbHZlPWZ1bmN0aW9uKGIpe3JldHVybnt9Lmhhc093blByb3BlcnR5LmNhbGwoYS5tb2R1bGVzLGIpP2EubW9kdWxlc1tiXTp2b2lkIDB9LGEuZGVmaW5lPWZ1bmN0aW9uKGIsYyl7YS5tb2R1bGVzW2JdPWN9O3ZhciBiPWZ1bmN0aW9uKGEpe3JldHVybiBhPScvJyx7dGl0bGU6J2Jyb3dzZXInLHZlcnNpb246J3YwLjEwLjI2Jyxicm93c2VyOiEwLGVudjp7fSxhcmd2OltdLG5leHRUaWNrOmMuc2V0SW1tZWRpYXRlfHxmdW5jdGlvbihhKXtzZXRUaW1lb3V0KGEsMCl9LGN3ZDpmdW5jdGlvbigpe3JldHVybiBhfSxjaGRpcjpmdW5jdGlvbihiKXthPWJ9fX0oKTthLmRlZmluZSgnL2dpZi5jb2ZmZWUnLGZ1bmN0aW9uKGQsbSxsLGspe2Z1bmN0aW9uIGcoYSxiKXtyZXR1cm57fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGEsYil9ZnVuY3Rpb24gaihkLGIpe2Zvcih2YXIgYT0wLGM9Yi5sZW5ndGg7YTxjOysrYSlpZihhIGluIGImJmJbYV09PT1kKXJldHVybiEwO3JldHVybiExfWZ1bmN0aW9uIGkoYSxiKXtmdW5jdGlvbiBkKCl7dGhpcy5jb25zdHJ1Y3Rvcj1hfWZvcih2YXIgYyBpbiBiKWcoYixjKSYmKGFbY109YltjXSk7cmV0dXJuIGQucHJvdG90eXBlPWIucHJvdG90eXBlLGEucHJvdG90eXBlPW5ldyBkLGEuX19zdXBlcl9fPWIucHJvdG90eXBlLGF9dmFyIGgsYyxmLGIsZTtmPWEoJ2V2ZW50cycsZCkuRXZlbnRFbWl0dGVyLGg9YSgnL2Jyb3dzZXIuY29mZmVlJyxkKSxlPWZ1bmN0aW9uKGQpe2Z1bmN0aW9uIGEoZCl7dmFyIGEsYjt0aGlzLnJ1bm5pbmc9ITEsdGhpcy5vcHRpb25zPXt9LHRoaXMuZnJhbWVzPVtdLHRoaXMuZnJlZVdvcmtlcnM9W10sdGhpcy5hY3RpdmVXb3JrZXJzPVtdLHRoaXMuc2V0T3B0aW9ucyhkKTtmb3IoYSBpbiBjKWI9Y1thXSxudWxsIT10aGlzLm9wdGlvbnNbYV0/dGhpcy5vcHRpb25zW2FdOnRoaXMub3B0aW9uc1thXT1ifXJldHVybiBpKGEsZCksYz17d29ya2VyU2NyaXB0OidnaWYud29ya2VyLmpzJyx3b3JrZXJzOjIscmVwZWF0OjAsYmFja2dyb3VuZDonI2ZmZicscXVhbGl0eToxMCx3aWR0aDpudWxsLGhlaWdodDpudWxsLHRyYW5zcGFyZW50Om51bGx9LGI9e2RlbGF5OjUwMCxjb3B5OiExfSxhLnByb3RvdHlwZS5zZXRPcHRpb249ZnVuY3Rpb24oYSxiKXtyZXR1cm4gdGhpcy5vcHRpb25zW2FdPWIsbnVsbCE9dGhpcy5fY2FudmFzJiYoYT09PSd3aWR0aCd8fGE9PT0naGVpZ2h0Jyk/dGhpcy5fY2FudmFzW2FdPWI6dm9pZCAwfSxhLnByb3RvdHlwZS5zZXRPcHRpb25zPWZ1bmN0aW9uKGIpe3ZhciBhLGM7cmV0dXJuIGZ1bmN0aW9uKGQpe2ZvcihhIGluIGIpe2lmKCFnKGIsYSkpY29udGludWU7Yz1iW2FdLGQucHVzaCh0aGlzLnNldE9wdGlvbihhLGMpKX1yZXR1cm4gZH0uY2FsbCh0aGlzLFtdKX0sYS5wcm90b3R5cGUuYWRkRnJhbWU9ZnVuY3Rpb24oYSxkKXt2YXIgYyxlO251bGw9PWQmJihkPXt9KSxjPXt9LGMudHJhbnNwYXJlbnQ9dGhpcy5vcHRpb25zLnRyYW5zcGFyZW50O2ZvcihlIGluIGIpY1tlXT1kW2VdfHxiW2VdO2lmKG51bGwhPXRoaXMub3B0aW9ucy53aWR0aHx8dGhpcy5zZXRPcHRpb24oJ3dpZHRoJyxhLndpZHRoKSxudWxsIT10aGlzLm9wdGlvbnMuaGVpZ2h0fHx0aGlzLnNldE9wdGlvbignaGVpZ2h0JyxhLmhlaWdodCksJ3VuZGVmaW5lZCchPT10eXBlb2YgSW1hZ2VEYXRhJiZudWxsIT1JbWFnZURhdGEmJmEgaW5zdGFuY2VvZiBJbWFnZURhdGEpYy5kYXRhPWEuZGF0YTtlbHNlIGlmKCd1bmRlZmluZWQnIT09dHlwZW9mIENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCYmbnVsbCE9Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEJiZhIGluc3RhbmNlb2YgQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfHwndW5kZWZpbmVkJyE9PXR5cGVvZiBXZWJHTFJlbmRlcmluZ0NvbnRleHQmJm51bGwhPVdlYkdMUmVuZGVyaW5nQ29udGV4dCYmYSBpbnN0YW5jZW9mIFdlYkdMUmVuZGVyaW5nQ29udGV4dClkLmNvcHk/Yy5kYXRhPXRoaXMuZ2V0Q29udGV4dERhdGEoYSk6Yy5jb250ZXh0PWE7ZWxzZSBpZihudWxsIT1hLmNoaWxkTm9kZXMpZC5jb3B5P2MuZGF0YT10aGlzLmdldEltYWdlRGF0YShhKTpjLmltYWdlPWE7ZWxzZSB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgaW1hZ2UnKTtyZXR1cm4gdGhpcy5mcmFtZXMucHVzaChjKX0sYS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKCl7dmFyIGQsYTtpZih0aGlzLnJ1bm5pbmcpdGhyb3cgbmV3IEVycm9yKCdBbHJlYWR5IHJ1bm5pbmcnKTtpZighKG51bGwhPXRoaXMub3B0aW9ucy53aWR0aCYmbnVsbCE9dGhpcy5vcHRpb25zLmhlaWdodCkpdGhyb3cgbmV3IEVycm9yKCdXaWR0aCBhbmQgaGVpZ2h0IG11c3QgYmUgc2V0IHByaW9yIHRvIHJlbmRlcmluZycpO3RoaXMucnVubmluZz0hMCx0aGlzLm5leHRGcmFtZT0wLHRoaXMuZmluaXNoZWRGcmFtZXM9MCx0aGlzLmltYWdlUGFydHM9ZnVuY3Rpb24oYyl7Zm9yKHZhciBiPWZ1bmN0aW9uKCl7dmFyIGI7Yj1bXTtmb3IodmFyIGE9MDswPD10aGlzLmZyYW1lcy5sZW5ndGg/YTx0aGlzLmZyYW1lcy5sZW5ndGg6YT50aGlzLmZyYW1lcy5sZW5ndGg7MDw9dGhpcy5mcmFtZXMubGVuZ3RoPysrYTotLWEpYi5wdXNoKGEpO3JldHVybiBifS5hcHBseSh0aGlzLGFyZ3VtZW50cyksYT0wLGU9Yi5sZW5ndGg7YTxlOysrYSlkPWJbYV0sYy5wdXNoKG51bGwpO3JldHVybiBjfS5jYWxsKHRoaXMsW10pLGE9dGhpcy5zcGF3bldvcmtlcnMoKTtmb3IodmFyIGM9ZnVuY3Rpb24oKXt2YXIgYztjPVtdO2Zvcih2YXIgYj0wOzA8PWE/YjxhOmI+YTswPD1hPysrYjotLWIpYy5wdXNoKGIpO3JldHVybiBjfS5hcHBseSh0aGlzLGFyZ3VtZW50cyksYj0wLGU9Yy5sZW5ndGg7YjxlOysrYilkPWNbYl0sdGhpcy5yZW5kZXJOZXh0RnJhbWUoKTtyZXR1cm4gdGhpcy5lbWl0KCdzdGFydCcpLHRoaXMuZW1pdCgncHJvZ3Jlc3MnLDApfSxhLnByb3RvdHlwZS5hYm9ydD1mdW5jdGlvbigpe3ZhciBhO3doaWxlKCEwKXtpZihhPXRoaXMuYWN0aXZlV29ya2Vycy5zaGlmdCgpLCEobnVsbCE9YSkpYnJlYWs7Y29uc29sZS5sb2coJ2tpbGxpbmcgYWN0aXZlIHdvcmtlcicpLGEudGVybWluYXRlKCl9cmV0dXJuIHRoaXMucnVubmluZz0hMSx0aGlzLmVtaXQoJ2Fib3J0Jyl9LGEucHJvdG90eXBlLnNwYXduV29ya2Vycz1mdW5jdGlvbigpe3ZhciBhO3JldHVybiBhPU1hdGgubWluKHRoaXMub3B0aW9ucy53b3JrZXJzLHRoaXMuZnJhbWVzLmxlbmd0aCksZnVuY3Rpb24oKXt2YXIgYztjPVtdO2Zvcih2YXIgYj10aGlzLmZyZWVXb3JrZXJzLmxlbmd0aDt0aGlzLmZyZWVXb3JrZXJzLmxlbmd0aDw9YT9iPGE6Yj5hO3RoaXMuZnJlZVdvcmtlcnMubGVuZ3RoPD1hPysrYjotLWIpYy5wdXNoKGIpO3JldHVybiBjfS5hcHBseSh0aGlzLGFyZ3VtZW50cykuZm9yRWFjaChmdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oYyl7dmFyIGI7cmV0dXJuIGNvbnNvbGUubG9nKCdzcGF3bmluZyB3b3JrZXIgJytjKSxiPW5ldyBXb3JrZXIoYS5vcHRpb25zLndvcmtlclNjcmlwdCksYi5vbm1lc3NhZ2U9ZnVuY3Rpb24oYSl7cmV0dXJuIGZ1bmN0aW9uKGMpe3JldHVybiBhLmFjdGl2ZVdvcmtlcnMuc3BsaWNlKGEuYWN0aXZlV29ya2Vycy5pbmRleE9mKGIpLDEpLGEuZnJlZVdvcmtlcnMucHVzaChiKSxhLmZyYW1lRmluaXNoZWQoYy5kYXRhKX19KGEpLGEuZnJlZVdvcmtlcnMucHVzaChiKX19KHRoaXMpKSxhfSxhLnByb3RvdHlwZS5mcmFtZUZpbmlzaGVkPWZ1bmN0aW9uKGEpe3JldHVybiBjb25zb2xlLmxvZygnZnJhbWUgJythLmluZGV4KycgZmluaXNoZWQgLSAnK3RoaXMuYWN0aXZlV29ya2Vycy5sZW5ndGgrJyBhY3RpdmUnKSx0aGlzLmZpbmlzaGVkRnJhbWVzKyssdGhpcy5lbWl0KCdwcm9ncmVzcycsdGhpcy5maW5pc2hlZEZyYW1lcy90aGlzLmZyYW1lcy5sZW5ndGgpLHRoaXMuaW1hZ2VQYXJ0c1thLmluZGV4XT1hLGoobnVsbCx0aGlzLmltYWdlUGFydHMpP3RoaXMucmVuZGVyTmV4dEZyYW1lKCk6dGhpcy5maW5pc2hSZW5kZXJpbmcoKX0sYS5wcm90b3R5cGUuZmluaXNoUmVuZGVyaW5nPWZ1bmN0aW9uKCl7dmFyIGUsYSxrLG0sYixkLGg7Yj0wO2Zvcih2YXIgZj0wLGo9dGhpcy5pbWFnZVBhcnRzLmxlbmd0aDtmPGo7KytmKWE9dGhpcy5pbWFnZVBhcnRzW2ZdLGIrPShhLmRhdGEubGVuZ3RoLTEpKmEucGFnZVNpemUrYS5jdXJzb3I7Yis9YS5wYWdlU2l6ZS1hLmN1cnNvcixjb25zb2xlLmxvZygncmVuZGVyaW5nIGZpbmlzaGVkIC0gZmlsZXNpemUgJytNYXRoLnJvdW5kKGIvMWUzKSsna2InKSxlPW5ldyBVaW50OEFycmF5KGIpLGQ9MDtmb3IodmFyIGc9MCxsPXRoaXMuaW1hZ2VQYXJ0cy5sZW5ndGg7ZzxsOysrZyl7YT10aGlzLmltYWdlUGFydHNbZ107Zm9yKHZhciBjPTAsaT1hLmRhdGEubGVuZ3RoO2M8aTsrK2MpaD1hLmRhdGFbY10saz1jLGUuc2V0KGgsZCksaz09PWEuZGF0YS5sZW5ndGgtMT9kKz1hLmN1cnNvcjpkKz1hLnBhZ2VTaXplfXJldHVybiBtPW5ldyBCbG9iKFtlXSx7dHlwZTonaW1hZ2UvZ2lmJ30pLHRoaXMuZW1pdCgnZmluaXNoZWQnLG0sZSl9LGEucHJvdG90eXBlLnJlbmRlck5leHRGcmFtZT1mdW5jdGlvbigpe3ZhciBjLGEsYjtpZih0aGlzLmZyZWVXb3JrZXJzLmxlbmd0aD09PTApdGhyb3cgbmV3IEVycm9yKCdObyBmcmVlIHdvcmtlcnMnKTtyZXR1cm4gdGhpcy5uZXh0RnJhbWU+PXRoaXMuZnJhbWVzLmxlbmd0aD92b2lkIDA6KGM9dGhpcy5mcmFtZXNbdGhpcy5uZXh0RnJhbWUrK10sYj10aGlzLmZyZWVXb3JrZXJzLnNoaWZ0KCksYT10aGlzLmdldFRhc2soYyksY29uc29sZS5sb2coJ3N0YXJ0aW5nIGZyYW1lICcrKGEuaW5kZXgrMSkrJyBvZiAnK3RoaXMuZnJhbWVzLmxlbmd0aCksdGhpcy5hY3RpdmVXb3JrZXJzLnB1c2goYiksYi5wb3N0TWVzc2FnZShhKSl9LGEucHJvdG90eXBlLmdldENvbnRleHREYXRhPWZ1bmN0aW9uKGEpe3JldHVybiBhLmdldEltYWdlRGF0YSgwLDAsdGhpcy5vcHRpb25zLndpZHRoLHRoaXMub3B0aW9ucy5oZWlnaHQpLmRhdGF9LGEucHJvdG90eXBlLmdldEltYWdlRGF0YT1mdW5jdGlvbihiKXt2YXIgYTtyZXR1cm4gbnVsbCE9dGhpcy5fY2FudmFzfHwodGhpcy5fY2FudmFzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpLHRoaXMuX2NhbnZhcy53aWR0aD10aGlzLm9wdGlvbnMud2lkdGgsdGhpcy5fY2FudmFzLmhlaWdodD10aGlzLm9wdGlvbnMuaGVpZ2h0KSxhPXRoaXMuX2NhbnZhcy5nZXRDb250ZXh0KCcyZCcpLGEuc2V0RmlsbD10aGlzLm9wdGlvbnMuYmFja2dyb3VuZCxhLmZpbGxSZWN0KDAsMCx0aGlzLm9wdGlvbnMud2lkdGgsdGhpcy5vcHRpb25zLmhlaWdodCksYS5kcmF3SW1hZ2UoYiwwLDApLHRoaXMuZ2V0Q29udGV4dERhdGEoYSl9LGEucHJvdG90eXBlLmdldFRhc2s9ZnVuY3Rpb24oYSl7dmFyIGMsYjtpZihjPXRoaXMuZnJhbWVzLmluZGV4T2YoYSksYj17aW5kZXg6YyxsYXN0OmM9PT10aGlzLmZyYW1lcy5sZW5ndGgtMSxkZWxheTphLmRlbGF5LHRyYW5zcGFyZW50OmEudHJhbnNwYXJlbnQsd2lkdGg6dGhpcy5vcHRpb25zLndpZHRoLGhlaWdodDp0aGlzLm9wdGlvbnMuaGVpZ2h0LHF1YWxpdHk6dGhpcy5vcHRpb25zLnF1YWxpdHkscmVwZWF0OnRoaXMub3B0aW9ucy5yZXBlYXQsY2FuVHJhbnNmZXI6aC5uYW1lPT09J2Nocm9tZSd9LG51bGwhPWEuZGF0YSliLmRhdGE9YS5kYXRhO2Vsc2UgaWYobnVsbCE9YS5jb250ZXh0KWIuZGF0YT10aGlzLmdldENvbnRleHREYXRhKGEuY29udGV4dCk7ZWxzZSBpZihudWxsIT1hLmltYWdlKWIuZGF0YT10aGlzLmdldEltYWdlRGF0YShhLmltYWdlKTtlbHNlIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBmcmFtZScpO3JldHVybiBifSxhfShmKSxkLmV4cG9ydHM9ZX0pLGEuZGVmaW5lKCcvYnJvd3Nlci5jb2ZmZWUnLGZ1bmN0aW9uKGYsZyxoLGkpe3ZhciBhLGQsZSxjLGI7Yz1uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCksZT1uYXZpZ2F0b3IucGxhdGZvcm0udG9Mb3dlckNhc2UoKSxiPWMubWF0Y2goLyhvcGVyYXxpZXxmaXJlZm94fGNocm9tZXx2ZXJzaW9uKVtcc1wvOl0oW1x3XGRcLl0rKT8uKj8oc2FmYXJpfHZlcnNpb25bXHNcLzpdKFtcd1xkXC5dKyl8JCkvKXx8W251bGwsJ3Vua25vd24nLDBdLGQ9YlsxXT09PSdpZScmJmRvY3VtZW50LmRvY3VtZW50TW9kZSxhPXtuYW1lOmJbMV09PT0ndmVyc2lvbic/YlszXTpiWzFdLHZlcnNpb246ZHx8cGFyc2VGbG9hdChiWzFdPT09J29wZXJhJyYmYls0XT9iWzRdOmJbMl0pLHBsYXRmb3JtOntuYW1lOmMubWF0Y2goL2lwKD86YWR8b2R8aG9uZSkvKT8naW9zJzooYy5tYXRjaCgvKD86d2Vib3N8YW5kcm9pZCkvKXx8ZS5tYXRjaCgvbWFjfHdpbnxsaW51eC8pfHxbJ290aGVyJ10pWzBdfX0sYVthLm5hbWVdPSEwLGFbYS5uYW1lK3BhcnNlSW50KGEudmVyc2lvbiwxMCldPSEwLGEucGxhdGZvcm1bYS5wbGF0Zm9ybS5uYW1lXT0hMCxmLmV4cG9ydHM9YX0pLGEuZGVmaW5lKCdldmVudHMnLGZ1bmN0aW9uKGYsZSxnLGgpe2IuRXZlbnRFbWl0dGVyfHwoYi5FdmVudEVtaXR0ZXI9ZnVuY3Rpb24oKXt9KTt2YXIgYT1lLkV2ZW50RW1pdHRlcj1iLkV2ZW50RW1pdHRlcixjPXR5cGVvZiBBcnJheS5pc0FycmF5PT09J2Z1bmN0aW9uJz9BcnJheS5pc0FycmF5OmZ1bmN0aW9uKGEpe3JldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoYSk9PT0nW29iamVjdCBBcnJheV0nfSxkPTEwO2EucHJvdG90eXBlLnNldE1heExpc3RlbmVycz1mdW5jdGlvbihhKXt0aGlzLl9ldmVudHN8fCh0aGlzLl9ldmVudHM9e30pLHRoaXMuX2V2ZW50cy5tYXhMaXN0ZW5lcnM9YX0sYS5wcm90b3R5cGUuZW1pdD1mdW5jdGlvbihmKXtpZihmPT09J2Vycm9yJyYmKCEodGhpcy5fZXZlbnRzJiZ0aGlzLl9ldmVudHMuZXJyb3IpfHxjKHRoaXMuX2V2ZW50cy5lcnJvcikmJiF0aGlzLl9ldmVudHMuZXJyb3IubGVuZ3RoKSl0aHJvdyBhcmd1bWVudHNbMV1pbnN0YW5jZW9mIEVycm9yP2FyZ3VtZW50c1sxXTpuZXcgRXJyb3IoIlVuY2F1Z2h0LCB1bnNwZWNpZmllZCAnZXJyb3InIGV2ZW50LiIpO2lmKCF0aGlzLl9ldmVudHMpcmV0dXJuITE7dmFyIGE9dGhpcy5fZXZlbnRzW2ZdO2lmKCFhKXJldHVybiExO2lmKCEodHlwZW9mIGE9PSdmdW5jdGlvbicpKWlmKGMoYSkpe3ZhciBiPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywxKSxlPWEuc2xpY2UoKTtmb3IodmFyIGQ9MCxnPWUubGVuZ3RoO2Q8ZztkKyspZVtkXS5hcHBseSh0aGlzLGIpO3JldHVybiEwfWVsc2UgcmV0dXJuITE7c3dpdGNoKGFyZ3VtZW50cy5sZW5ndGgpe2Nhc2UgMTphLmNhbGwodGhpcyk7YnJlYWs7Y2FzZSAyOmEuY2FsbCh0aGlzLGFyZ3VtZW50c1sxXSk7YnJlYWs7Y2FzZSAzOmEuY2FsbCh0aGlzLGFyZ3VtZW50c1sxXSxhcmd1bWVudHNbMl0pO2JyZWFrO2RlZmF1bHQ6dmFyIGI9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO2EuYXBwbHkodGhpcyxiKX1yZXR1cm4hMH0sYS5wcm90b3R5cGUuYWRkTGlzdGVuZXI9ZnVuY3Rpb24oYSxiKXtpZignZnVuY3Rpb24nIT09dHlwZW9mIGIpdGhyb3cgbmV3IEVycm9yKCdhZGRMaXN0ZW5lciBvbmx5IHRha2VzIGluc3RhbmNlcyBvZiBGdW5jdGlvbicpO2lmKHRoaXMuX2V2ZW50c3x8KHRoaXMuX2V2ZW50cz17fSksdGhpcy5lbWl0KCduZXdMaXN0ZW5lcicsYSxiKSwhdGhpcy5fZXZlbnRzW2FdKXRoaXMuX2V2ZW50c1thXT1iO2Vsc2UgaWYoYyh0aGlzLl9ldmVudHNbYV0pKXtpZighdGhpcy5fZXZlbnRzW2FdLndhcm5lZCl7dmFyIGU7dGhpcy5fZXZlbnRzLm1heExpc3RlbmVycyE9PXVuZGVmaW5lZD9lPXRoaXMuX2V2ZW50cy5tYXhMaXN0ZW5lcnM6ZT1kLGUmJmU+MCYmdGhpcy5fZXZlbnRzW2FdLmxlbmd0aD5lJiYodGhpcy5fZXZlbnRzW2FdLndhcm5lZD0hMCxjb25zb2xlLmVycm9yKCcobm9kZSkgd2FybmluZzogcG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSBsZWFrIGRldGVjdGVkLiAlZCBsaXN0ZW5lcnMgYWRkZWQuIFVzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LicsdGhpcy5fZXZlbnRzW2FdLmxlbmd0aCksY29uc29sZS50cmFjZSgpKX10aGlzLl9ldmVudHNbYV0ucHVzaChiKX1lbHNlIHRoaXMuX2V2ZW50c1thXT1bdGhpcy5fZXZlbnRzW2FdLGJdO3JldHVybiB0aGlzfSxhLnByb3RvdHlwZS5vbj1hLnByb3RvdHlwZS5hZGRMaXN0ZW5lcixhLnByb3RvdHlwZS5vbmNlPWZ1bmN0aW9uKGIsYyl7dmFyIGE9dGhpcztyZXR1cm4gYS5vbihiLGZ1bmN0aW9uIGQoKXthLnJlbW92ZUxpc3RlbmVyKGIsZCksYy5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KSx0aGlzfSxhLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lcj1mdW5jdGlvbihhLGQpe2lmKCdmdW5jdGlvbichPT10eXBlb2YgZCl0aHJvdyBuZXcgRXJyb3IoJ3JlbW92ZUxpc3RlbmVyIG9ubHkgdGFrZXMgaW5zdGFuY2VzIG9mIEZ1bmN0aW9uJyk7aWYoISh0aGlzLl9ldmVudHMmJnRoaXMuX2V2ZW50c1thXSkpcmV0dXJuIHRoaXM7dmFyIGI9dGhpcy5fZXZlbnRzW2FdO2lmKGMoYikpe3ZhciBlPWIuaW5kZXhPZihkKTtpZihlPDApcmV0dXJuIHRoaXM7Yi5zcGxpY2UoZSwxKSxiLmxlbmd0aD09MCYmZGVsZXRlIHRoaXMuX2V2ZW50c1thXX1lbHNlIHRoaXMuX2V2ZW50c1thXT09PWQmJmRlbGV0ZSB0aGlzLl9ldmVudHNbYV07cmV0dXJuIHRoaXN9LGEucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycz1mdW5jdGlvbihhKXtyZXR1cm4gYSYmdGhpcy5fZXZlbnRzJiZ0aGlzLl9ldmVudHNbYV0mJih0aGlzLl9ldmVudHNbYV09bnVsbCksdGhpc30sYS5wcm90b3R5cGUubGlzdGVuZXJzPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLl9ldmVudHN8fCh0aGlzLl9ldmVudHM9e30pLHRoaXMuX2V2ZW50c1thXXx8KHRoaXMuX2V2ZW50c1thXT1bXSksYyh0aGlzLl9ldmVudHNbYV0pfHwodGhpcy5fZXZlbnRzW2FdPVt0aGlzLl9ldmVudHNbYV1dKSx0aGlzLl9ldmVudHNbYV19fSksYy5HSUY9YSgnL2dpZi5jb2ZmZWUnKX0uY2FsbCh0aGlzLHRoaXMpKQovLyMgc291cmNlTWFwcGluZ1VSTD1naWYuanMubWFwCi8vIGdpZi5qcyAwLjEuNiAtIGh0dHBzOi8vZ2l0aHViLmNvbS9qbm9yZGJlcmcvZ2lmLmpzCgovKioKICogc291cmNlIGFuZCBzb3VyY2UgbWFwIGZyb20gCiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9qbm9yZGJlcmcvZ2lmLmpzL3RyZWUvbWFzdGVyL2Rpc3QKICov"},{"meta":{"name":"gm4-polyfill-101.js","url":"https://greasyfork.org/scripts/375359-gm4-polyfill-1-0-1/code/gm4-polyfill-101.js?version=652238","ts":1770962852632,"mimetype":"text/javascript"},"source":"LyogZ200LXBvbHlmaWxsLmpzIHYxLjAuMSAqLwoKLy8gPT1Vc2VyTGlicmFyeT09Ci8vIEBwc2V1ZG9IZWFkZXIKLy8gQHZlcnNpb24gICAgIDEuMC4xCi8vIEBuYW1lICAgICAgICBHTTQgUG9seUZpbGwKLy8gPT0vVXNlckxpYnJhcnk9PQoKLyogICBUaGlzIGhlbHBlciBzY3JpcHQgYnJpZGdlcyBiYWNrd2FyZGx5IGNvbXBhdGliaWxpdHkgYmV0d2VlbiB0aGUgR3JlYXNlbW9ua2V5IDQgQVBJcyBhbmQKICAgZXhpc3RpbmcvbGVnYWN5IEFQSXMuICBTYXkgZm9yIGV4YW1wbGUgeW91ciB1c2VyIHNjcmlwdCBpbmNsdWRlcwogICAKICAgLy8gQGdyYW50IEdNX2dldFZhbHVlCiAgIAogICBBbmQgeW91J2QgbGlrZSB0byBiZSBjb21wYXRpYmxlIHdpdGggYm90aCBHcmVhc2Vtb25rZXkgMyBhbmQgR3JlYXNlbW9ua2V5IDQKICAgKGFuZCBmb3IgdGhhdCBtYXR0ZXIgYWxsIHZlcnNpb25zIG9mIFZpb2xlbnRtb25rZXksIFRhbXBlcm1vbmtleSwgYW5kIGFueSBvdGhlcgogICB1c2VyIHNjcmlwdCBlbmdpbmUpLiAgQWRkOgogICAKICAgLy8gQGdyYW50IEdNLmdldFZhbHVlCiAgIC8vIEByZXF1aXJlICAgICBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vU2xvYW5lRm94L2NvZGUvbWFzdGVyL2dtNC1wb2x5ZmlsbC5qcwogICAKICAgRWcsIHRoaXMgd2lsbCBkZWZpbmUgR00uZ2V0VmFsdWUgaW4gb2xkZXIgR00gdmVyc2lvbnMsIHNvIHVwZGF0ZWQgY29kZSB3aWxsIGJlIGJhY2t3YXJkIGNvbXBhdGlibGUKICAgdG8gb2xkZXIgR00gdmVyc2lvbnMuICBJdCB3aWxsIG5vdCBkZWZpbmUgR01fZ2V0VmFsdWUgaW4gbmV3ZXIgR00gdmVyc2lvbnMuCiAgIE1pc3NpbmcgZnVuY3Rpb25zIGZyb20gdGhlIG5ldyBHTSBhcGkgYXJlIGFkZGVkLCBoZW5jZSBHTS5yZWdpc3Rlck1lbnVDb21tYW5kIGFuZCBHTS5hZGRTdHlsZSBhcmUgZGVmaW5lZC4KCiAgIEluY2x1ZGUgYWJvdmUgYW5kIHJlY29kZSB1c2Vyc2NyaXB0IHRvIHRoZSBuZXcgKEdNLWRvdCkgQVBJcywgd2hpY2ggcmV0dXJuIHByb21pc2VzLiAgSWYgeW91ciBzY3JpcHQKICAgaXMgcnVubmluZyBpbiBhbiBlbmdpbmUgdGhhdCBkb2VzIG5vdCBwcm92aWRlIHRoZSBuZXcgYXN5bmNocm9ub3VzIEFQSXMsIHRoaXMKICAgaGVscGVyIHdpbGwgYWRkIHRoZW0sIGJhc2VkIG9uIHRoZSBvbGQgQVBJcy4KICAgCiAgIElmIHlvdSB1c2UgYGF3YWl0YCBhdCB0aGUgdG9wIGxldmVsLCB5b3UnbGwgbmVlZCB0byB3cmFwIHlvdXIgc2NyaXB0IGluIGFuCiAgIGBhc3luY2AgZnVuY3Rpb24gdG8gYmUgY29tcGF0aWJsZSB3aXRoIGFueSB1c2VyIHNjcmlwdCBlbmdpbmUgYmVzaWRlcwogICBHcmVhc2Vtb25rZXkgNC4KICAgCiAgIHZhciBnVmFsdWU7CiAgIGFzeW5jIGZ1bmN0aW9uIGluaXRfZ2xvYmFscygpIHsgZ1ZhbHVlID0gYXdhaXQgR00uZ2V0VmFsdWUoJ3gnKTsgfQogICBhc3luYyBtYWluKCkgeyBhd2FpdCBpbml0X2dsb2JhbHMoKTsgfQogICBhZGRFdmVudExpc3RlbmVyKCJsb2FkIixtYWluKTsKCiovCiAKaWYgKHR5cGVvZiBHTSA9PSAndW5kZWZpbmVkJykKCWV2YWwoInZhciBHTSA9IHt9OyIpOyAgLy8gRGVmaW5lZCBpbiB0aGUgY2xvc3VyZSBnaXZlbiB3aGVuIGxvYWRlZC9pbmplY3RlZCBwcmV2ZW50cyBpbnRyYS1zY3JpcHQgY2xvYmJlcmluZy4gIEV2YWwgbmVlZGVkIGR1ZSB0byBHTSdzIGRlY2xhcmF0aW9uIGFzIGEgY29uc3QgaW4gc2NvcGUgd3JhcHBlciAuCgoKaWYgKHR5cGVvZiBHTV9hZGRTdHlsZSA9PSAndW5kZWZpbmVkJykgewoJdGhpcy5HTV9hZGRTdHlsZSA9IChhQ3NzKSA9PiB7CgkJJ3VzZSBzdHJpY3QnOwoJCWxldCBoZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXTsKCQlpZiAoaGVhZCkgewoJCQlsZXQgc3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpOwoJCQlzdHlsZS5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGV4dC9jc3MnKTsKCQkJc3R5bGUudGV4dENvbnRlbnQgPSBhQ3NzOwoJCQloZWFkLmFwcGVuZENoaWxkKHN0eWxlKTsKCQkJcmV0dXJuIHN0eWxlOwoJCX0KCQlyZXR1cm4gbnVsbDsKCX07Cn0KR00uYWRkU3R5bGU9dGhpcy5HTV9hZGRTdHlsZTsKCmlmICh0eXBlb2YgR01fZ2V0UmVzb3VyY2VUZXh0ID09ICd1bmRlZmluZWQnKQoJdGhpcy5HTV9nZXRSZXNvdXJjZVRleHQgPSBhc3luYyBhUmVzb3VyY2VOYW1lID0+CgkoIGF3YWl0IGZldGNoKGF3YWl0IEdNLmdldFJlc291cmNlVXJsKGFSZXNvdXJjZU5hbWUpKSApLnRleHQoKTsgCgppZiAodHlwZW9mIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQ9PSJmdW5jdGlvbiIgJiYgL2lzIG5vdCBzdXBwb3J0ZWRbXl17MCwxMDB9JC8udGVzdChHTV9yZWdpc3Rlck1lbnVDb21tYW5kLnRvU3RyaW5nKCkpKQoJR01fcmVnaXN0ZXJNZW51Q29tbWFuZD11bmRlZmluZWQ7CgpHTS5yZWdpc3Rlck1lbnVDb21tYW5kID0gZnVuY3Rpb24gKGNhcHRpb24sIGNvbW1hbmRGdW5jLCBhY2Nlc3NLZXkpIHsKCWxldCBib2R5PWRvY3VtZW50LmJvZHk7CglpZiAoIWJvZHkpIHRocm93ICJHTSByZWdpc3Rlck1lbnVDb21tYW5kIGFpbnQgZ290IG5vIGJvZHkgaW4gZG9jdW1lbnQsIGNhbGwgYWdhaW4gbGF0ZXIuIjsKCWxldCBjb250ZXh0TWVudSA9IGJvZHkuZ2V0QXR0cmlidXRlKCdjb250ZXh0bWVudScpOwoJbGV0IG1lbnUgPSAoY29udGV4dE1lbnUgPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdtZW51IycgKyBjb250ZXh0TWVudSkgOiBudWxsKTsKCWlmICghbWVudSkgewoJCW1lbnUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdtZW51Jyk7CgkJbWVudS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2dtLXJlZ2lzdGVyZWQtbWVudScpOwoJCW1lbnUuc2V0QXR0cmlidXRlKCd0eXBlJywgJ2NvbnRleHQnKTsKCQlib2R5Lmluc2VydEJlZm9yZShtZW51LGJvZHkuZmlyc3RDaGlsZCk7CgkJYm9keS5zZXRBdHRyaWJ1dGUoJ2NvbnRleHRtZW51JywgJ2dtLXJlZ2lzdGVyZWQtbWVudScpOwoJfQoJbGV0IG1lbnVJdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWVudWl0ZW0nKTsKCW1lbnVJdGVtLnNldEF0dHJpYnV0ZSgibGFiZWwiLGNhcHRpb24pOwoJbWVudUl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjb21tYW5kRnVuYywgdHJ1ZSk7CgltZW51LmFwcGVuZENoaWxkKG1lbnVJdGVtKTsKCXJldHVybiBtZW51SXRlbTsgICAgLy8gVGhlIHJlYWwgR01fcmVnaXN0ZXJNZW51Q29tbWFuZCByZXR1cm5zIHVuZGVmaW5lZC4gIEhlcmUgdXNlciBjYW4gY2hhbmdlIGVnLCBsYWJlbCBhdHRyaWJ1dGUgb2YgcmV0dXJuZWQgbWVudUl0ZW0uCn07CgppZiAodHlwZW9mIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQgPT0gJ3VuZGVmaW5lZCcpIHRoaXMuR01fcmVnaXN0ZXJNZW51Q29tbWFuZD1HTS5yZWdpc3Rlck1lbnVDb21tYW5kOwoKT2JqZWN0LmVudHJpZXMoewoJJ2xvZyc6IGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSksCgknaW5mbyc6IHR5cGVvZiBHTV9pbmZvID09ICJ1bmRlZmluZWQiID8gbnVsbCA6IEdNX2luZm8gCn0pLmZvckVhY2goKFtuZXdLZXksIG9sZF0pID0+IHsKCWlmIChvbGQgJiYgKHR5cGVvZiBHTVtuZXdLZXldID09ICd1bmRlZmluZWQnKSkgewoJCUdNW25ld0tleV0gPSBvbGQ7Cgl9Cn0pOwoKT2JqZWN0LmVudHJpZXMoeyAgICAgICAgICAvLyBPYmplY3QuZW50cmllcygpIHJldHVybnMgYSAyLWQgYXJyYXkgb2YgYWxsIHRoZSBnaXZlbiBvYmplY3QncyBuYW1lIHZhbHVlIHBhaXJzLgoJJ0dNX2FkZFN0eWxlJzogJ2FkZFN0eWxlJywKCSdHTV9kZWxldGVWYWx1ZSc6ICdkZWxldGVWYWx1ZScsCgknR01fZ2V0UmVzb3VyY2VVUkwnOiAnZ2V0UmVzb3VyY2VVcmwnLAoJJ0dNX2dldFZhbHVlJzogJ2dldFZhbHVlJywKCSdHTV9saXN0VmFsdWVzJzogJ2xpc3RWYWx1ZXMnLAoJJ0dNX25vdGlmaWNhdGlvbic6ICdub3RpZmljYXRpb24nLAoJJ0dNX29wZW5JblRhYic6ICdvcGVuSW5UYWInLAoJJ0dNX3JlZ2lzdGVyTWVudUNvbW1hbmQnOiAncmVnaXN0ZXJNZW51Q29tbWFuZCcsCgknR01fc2V0Q2xpcGJvYXJkJzogJ3NldENsaXBib2FyZCcsCgknR01fc2V0VmFsdWUnOiAnc2V0VmFsdWUnLAoJJ0dNX3htbGh0dHBSZXF1ZXN0JzogJ3htbEh0dHBSZXF1ZXN0JywKCSdHTV9nZXRSZXNvdXJjZVRleHQnOiAnZ2V0UmVzb3VyY2VUZXh0Jwp9KS5mb3JFYWNoKChbb2xkS2V5LCBuZXdLZXldKSA9PiB7ICAgICAgICAgLy8gRW5hYmxlcyBlZywgImF3YWl0IEdNLmdldFZhbHVlIiB0byBydW4gb2sgb24gcHJlIEdNNC4gQnV0IG5vdCB2aWNlIHZlcnNhLCBpZSwgaXQgZGVmaW5lcyBubyBHTV9nZXRWYWx1ZSBpbiBuZXdlciBHTS4KCWxldCBvbGQgPSB0aGlzW29sZEtleV07CglpZiAob2xkICYmICh0eXBlb2YgR01bbmV3S2V5XSA9PSAndW5kZWZpbmVkJykpIHsKCQlHTVtuZXdLZXldID0gZnVuY3Rpb24oLi4uYXJncykgewoJCQlyZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7IHRyeSB7CgkJCQlyZXNvbHZlKG9sZC5hcHBseSh0aGlzLCBhcmdzKSk7CgkJCX0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9CgkJCQkJCQkJCQkJCQkJIH0pOwoJCX07Ly9HTVtuZXdLZXldPWZ1bmMKCX0KfSk7Ly9mb3JFYWNoKCkKCgo="}]},{"name":"Teng ","options":{"check_for_updates":true,"comment":null,"compat_foreach":false,"compat_metadata":false,"compat_powerful_this":null,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":["baidu.com","baidupcs.com","aliyundrive.com","alipan.com","189.cn","xunlei.com","quark.cn","youxiaohou.com","yun.139.com","caiyun.139.com","localhost","*"],"orig_excludes":[],"orig_includes":[],"orig_matches":["*://pan.baidu.com/disk/home*","*://yun.baidu.com/disk/home*","*://pan.baidu.com/disk/main*","*://yun.baidu.com/disk/main*","*://pan.baidu.com/s/*","*://yun.baidu.com/s/*","*://pan.baidu.com/share/*","*://yun.baidu.com/share/*","*://openapi.baidu.com/*","*://www.aliyundrive.com/s/*","*://www.aliyundrive.com/drive*","*://www.alipan.com/s/*","*://www.alipan.com/drive*","*://cloud.189.cn/web/*","*://pan.xunlei.com/*","*://pan.quark.cn/*","*://yun.139.com/*","*://caiyun.139.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","orig_run_in":[],"orig_tags":[],"use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null,"run_in":null,"sandbox":null,"tags":[],"unwrap":null,"user_modified":null},"storage":{"ts":1771160577240,"data":{"license":"sAGPL3","setting_init_code":"s865746","setting_rpc_dir":"sD:","setting_rpc_domain":"shttp://localhost","setting_rpc_path":"s/jsonrpc","setting_rpc_port":"s16800","setting_rpc_token":"s","setting_terminal_type":"swc","setting_theme_color":"s#09AAFF"}},"enabled":true,"position":4,"file_url":"https://update.greasyfork.org/scripts/533835/Teng%20%E7%BD%91%E7%9B%98%E7%9B%B4%E9%93%BE%E4%B8%8B%E8%BD%BD%E5%8A%A9%E6%89%8B%E3%80%90%E5%85%8D%E9%AA%8C%E8%AF%81%E7%A0%81%E3%80%91.user.js","uuid":"f651fec9-8b6d-4405-a180-15863ca27c41","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICAgICAgIFRlbmcg572R55uY55u06ZO+5LiL6L295Yqp5omL44CQ5YWN6aqM6K+B56CB44CRCi8vIEBuYW1lc3BhY2UgICAgICAgICBUZW5nCi8vIEB2ZXJzaW9uICAgICAgICAgICA2LjIuNwovLyBAYXV0aG9yICAgICAgICAgICAgVGVuZwovLyBAZGVzY3JpcHRpb24gICAgICAg5L615Yig77yb5Y6f5L2c6ICFIOayueWwj+eMtCDwn5GG8J+RhvCfkYbwn5GG8J+RhvCfkYbwn5GGIC0g5pSv5oyB5om56YeP6I635Y+WIOKcheeZvuW6pue9keebmCDinIXpmL/ph4zkupHnm5gg4pyF5aSp57+85LqR55uYIOKchei/hembt+S6keebmCDinIXlpLjlhYvnvZHnm5gg4pyF56e75Yqo5LqR55uYIOWFreWkp+e9keebmOeahOebtOmTvuS4i+i9veWcsOWdgO+8jOmFjeWQiCBJRE3vvIxYZG93bu+8jEFyaWEy77yMQ3VybO+8jOavlOeJueW9l+aYn+etieW3peWFt+mrmOaViPCfmoDwn5qA8J+agOS4i+i9ve+8jOWujOe+jumAgumFjSBDaHJvbWXvvIxFZGdl77yMRmlyZUZveO+8jDM2MO+8jFFR77yM5pCc54uX77yM55m+5YiG77yM6YGo5ri477yM5pif5oS/77yMT3BlcmHvvIznjI7osbnvvIxWaXZhbGRp77yMWWFuZGV477yMS2l3aSDnrYkgMTgg56eN5rWP6KeI5Zmo44CC5Y+v5Zyo5peg5rOV5a6J6KOF5a6i5oi356uv55qE546v5aKD5LiL5L2/55So77yM5Yqp5omL5YWN6LS55byA5rqQ44CC8J+YjgovLyBAbGljZW5zZSAgICAgICAgICAgQUdQTC0zLjAtb3ItbGF0ZXIKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9wYW4uYmFpZHUuY29tL2Rpc2svaG9tZSoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly95dW4uYmFpZHUuY29tL2Rpc2svaG9tZSoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9wYW4uYmFpZHUuY29tL2Rpc2svbWFpbioKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly95dW4uYmFpZHUuY29tL2Rpc2svbWFpbioKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9wYW4uYmFpZHUuY29tL3MvKgovLyBAbWF0Y2ggICAgICAgICAgICAgKjovL3l1bi5iYWlkdS5jb20vcy8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vcGFuLmJhaWR1LmNvbS9zaGFyZS8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8veXVuLmJhaWR1LmNvbS9zaGFyZS8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vb3BlbmFwaS5iYWlkdS5jb20vKgovLyBAbWF0Y2ggICAgICAgICAgICAgKjovL3d3dy5hbGl5dW5kcml2ZS5jb20vcy8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vd3d3LmFsaXl1bmRyaXZlLmNvbS9kcml2ZSoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly93d3cuYWxpcGFuLmNvbS9zLyoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly93d3cuYWxpcGFuLmNvbS9kcml2ZSoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9jbG91ZC4xODkuY24vd2ViLyoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly9wYW4ueHVubGVpLmNvbS8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vcGFuLnF1YXJrLmNuLyoKLy8gQG1hdGNoICAgICAgICAgICAgICo6Ly95dW4uMTM5LmNvbS8qCi8vIEBtYXRjaCAgICAgICAgICAgICAqOi8vY2FpeXVuLjEzOS5jb20vKgovLyBAcmVxdWlyZSAgICAgICAgICAgaHR0cHM6Ly91bnBrZy5jb20vanF1ZXJ5QDMuNy4wL2Rpc3QvanF1ZXJ5Lm1pbi5qcwovLyBAcmVxdWlyZSAgICAgICAgICAgaHR0cHM6Ly91bnBrZy5jb20vc3dlZXRhbGVydDJAMTAuMTYuNi9kaXN0L3N3ZWV0YWxlcnQyLmFsbC5taW4uanMKLy8gQHJlcXVpcmUgICAgICAgICAgIGh0dHBzOi8vdW5wa2cuY29tL2pzLW1kNUAwLjcuMy9idWlsZC9tZDUubWluLmpzCi8vIEBjb25uZWN0ICAgICAgICAgICBiYWlkdS5jb20KLy8gQGNvbm5lY3QgICAgICAgICAgIGJhaWR1cGNzLmNvbQovLyBAY29ubmVjdCAgICAgICAgICAgYWxpeXVuZHJpdmUuY29tCi8vIEBjb25uZWN0ICAgICAgICAgICBhbGlwYW4uY29tCi8vIEBjb25uZWN0ICAgICAgICAgICAxODkuY24KLy8gQGNvbm5lY3QgICAgICAgICAgIHh1bmxlaS5jb20KLy8gQGNvbm5lY3QgICAgICAgICAgIHF1YXJrLmNuCi8vIEBjb25uZWN0ICAgICAgICAgICB5b3V4aWFvaG91LmNvbQovLyBAY29ubmVjdCAgICAgICAgICAgeXVuLjEzOS5jb20KLy8gQGNvbm5lY3QgICAgICAgICAgIGNhaXl1bi4xMzkuY29tCi8vIEBjb25uZWN0ICAgICAgICAgICBsb2NhbGhvc3QKLy8gQGNvbm5lY3QgICAgICAgICAgICoKLy8gQHJ1bi1hdCAgICAgICAgICAgIGRvY3VtZW50LWlkbGUKLy8gQGdyYW50ICAgICAgICAgICAgIHVuc2FmZVdpbmRvdwovLyBAZ3JhbnQgICAgICAgICAgICAgR01feG1saHR0cFJlcXVlc3QKLy8gQGdyYW50ICAgICAgICAgICAgIEdNX3NldENsaXBib2FyZAovLyBAZ3JhbnQgICAgICAgICAgICAgR01fc2V0VmFsdWUKLy8gQGdyYW50ICAgICAgICAgICAgIEdNX2dldFZhbHVlCi8vIEBncmFudCAgICAgICAgICAgICBHTV9kZWxldGVWYWx1ZQovLyBAZ3JhbnQgICAgICAgICAgICAgR01fb3BlbkluVGFiCi8vIEBncmFudCAgICAgICAgICAgICBHTV9pbmZvCi8vIEBncmFudCAgICAgICAgICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kCi8vIEBncmFudCAgICAgICAgICAgICBHTV9jb29raWUKLy8gQGdyYW50ICAgICAgICAgICAgIHdpbmRvdy5jbG9zZQovLyBAaWNvbiAgICAgICAgICAgICAgZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M015NXZjbWN2TWpBd01DOXpkbWNpSUhacFpYZENiM2c5SWpBZ01DQXhNamdnTVRJNElqNDhjR0YwYUNCa1BTSk5NVEF6TGpZZ01UQTNMalJqTXk0MUxUSXVNaUE0TGprdE5pNHhJREV6TGpndE1USXVOWE0zTGpNdE1USXVOU0E0TGpVdE1UWXVOV011TlMweExqY2dNaTR5TFRjdU5TQXlMakl0TVRRdU55QXdMVEV3TGpFdE15NHpMVEkxTGpFdE1UVXVOQzB6Tmk0NExURTBMalV0TVRRdE16SXVNUzB4TkM0ekxUTTFMamN0TVRRdU15MDRJREF0TVRVdU55QXhMamt0TWpJdU5pQTFMakpETkRRZ01qTWdNelV1TnlBek1TNDBJRE13TGpnZ05ERXVOMk10TVM0eklESXVPQzAwSURRdU55MDNMakVnTlMwMElDNHpMVGN1TlNBMExqUXRPQzQ1SURrdU5pMHVOU0F4TGprdE1TNDJJRE11TlMwekxqRWdOQzQzUXpRdU5DQTJOaTQ0SURBZ056VXVOeUF3SURnMVl6QWdOaTQ0SURJdU15QXhNeTR4SURZdU1TQXhPQzR5SURVdU5TQTNMalFnTVRRdU1pQXhNaTR5SURJMElERXlMakpvTkRjdU1XTTBMalFnTUNBeE1TMHVOU0F4T0M0ekxUTXVOU0F6TGpJdE1TNDBJRFV1T1MweklEZ3VNUzAwTGpWNklpQm1hV3hzUFNJak5EUTBJaTgrUEhCaGRHZ2daRDBpVFRFeE9TNDRJRFkwTGpOakxqRXRNVGN1TVMweE1DNDBMVEk0TFRFeUxqVXRNekF1TVVNNU5TQXlNaTR4SURjNUxqa2dNakV1T0NBM05pNDVJREl4TGpoakxURTNMallnTUMwek15NHpJREV3TGpVdE16a3VPU0F5Tmk0M0xTNDJJREV1TXkweExqZ2dNaTR6TFRNdU5DQXlMak5vTFM0MFl5MDFMamdnTUMweE1DNDJJRFF1T0MweE1DNDJJREV3TGpkMkxqVmpNQ0F4TGpRdExqZ2dNaTQyTFRFdU9TQXpMak5ETVRNdU5DQTJPU0E0TGpnZ056WXVPQ0E0TGpnZ09EVmpNQ0F4TWk0eUlEa3VPU0F5TWk0eklESXlMaklnTWpJdU0yZzBOUzR5WXpNdU5pMHVNU0F4Tnk0MkxTNDVJREk1TGpZdE1USWdNaTQ1TFRJdU9DQXhNeTQ1TFRFekxqY2dNVFF0TXpGNklpQm1hV3hzUFNJak1UTTVOMlE0SWk4K1BIQmhkR2dnWkQwaVRURXhNQzQ0SURVM0xqUnNMaklnTXk0ell6QWdNUzR6TFRFdU1TQXlMalF0TWk0eklESXVOQzB4TGpNZ01DMHlMak10TVM0eExUSXVNeTB5TGpSc0xTNHhMVEl1T0hZdExqTmpNQzB4TGpJdU9TMHlMaklnTWk0eExUSXVNMmd1TTJNdU55QXdJREV1TXk0eklERXVOeTQzTFM0eUxqRXVNeTQxTGpRZ01TNDBlbTB0TXk0ekxURXdMak5qTUNBeExqSXRNU0F5TGpNdE1pNHlJREl1TTJndExqRmpMUzQ0SURBdE1TNDJMUzQxTFRJdE1TNHlMVFF1TmkwNExqTXRNVE11TXkweE15NDFMVEl5TGpndE1UTXVOUzB4TGpJZ01DMHlMak10TVMweUxqTXRNaTR5ZGkwdU1XTXdMVEV1TWlBeExUSXVNeUF5TGpJdE1pNHphQzR4WVRNd0xqTTNJRE13TGpNM0lEQWdNQ0F4SURFMUxqZ2dOQzQwWXpRdU5pQXlMamdnT0M0MElEWXVPQ0F4TVM0eElERXhMalV1TVM0ekxqSXVOeTR5SURFdU1YcE5PRGd1TXlBM015NDRURGN6TGpVZ09UTXVNbU10TVM0MUlERXVPUzB6TGpVZ015NHhMVFV1TnlBekxqVm9MUzR5WXkwdU5DNHhMUzQ0TGpFdE1TNHlMakV0TGpZZ01DMHhMakV0TGpFdE1TNDJMUzR5TFRJdU1pMHVOQzAwTGpJdE1TNDNMVFV1TmkwekxqVk1ORFF1TXlBM015NDVZeTB5TFRJdU5pMHlMalV0TlM0MExURXVOQzAzTGpjdU1TMHVNUzR4TFM0eUxqSXRMaklnTVM0eUxUSWdNeTQxTFRNdU1pQTJMalF0TXk0eWFEWXVObll0TlM0M1l6QXROaTQ0SURRdU55MHhNaUF4TUM0NUxURXlJRFF1T0NBd0lEZ3VOU0F5TGpZZ01UQXVNeUEzTGpJdU5TQXhMak10TGpJZ01pNDNMVEV1TlNBekxqSnpMVEl1T0MwdU1TMHpMak10TVM0MFl5MHhMakV0TWk0M0xUSXVPUzAwTFRVdU5TMDBMVE11TlNBd0xUWWdNeTAySURkMk9DNHhZekFnTGpVdExqSWdNUzB1TmlBeExqUXRMall1TnkweExqY2dNUzR4TFRJdU5pQXhMakZvTFRndU5HTXRNUzR6SURBdE1pQXVOQzB5TGpFdU55MHVNaTQwSURBZ01TNHpMamtnTWk0MFREWXpMakVnT1RCakxqa2dNUzR5SURJdU1TQXhMamdnTXk0eklERXVPSE15TGpNdExqWWdNeTR4TFRFdU4yd3hOQzQ0TFRFNUxqTmpMamt0TVM0eElERXVNUzB5SUM0NUxUSXVOQzB1TWkwdU15MHVPUzB1TnkweUxqRXRMamRvTFRjdU5tTXRMamtnTUMweExqY3RMalV0TWk0eExURXVNaTB1TXkwdU5DMHVOQzB1T0MwdU5DMHhMak1nTUMweExqUWdNUzR4TFRJdU5TQXlMalV0TWk0MWFEY3VObU16TGpFZ01DQTFMalVnTVM0eklEWXVOaUF6TGpWc0xqTXVOMk11TnlBeUxqRXVNU0EwTGpZdE1TNDNJRFl1T1hvaUlHWnBiR3c5SWlNME5EUWlMejQ4TDNOMlp6ND0KLy8gQGRvd25sb2FkVVJMIGh0dHBzOi8vdXBkYXRlLmdyZWFzeWZvcmsub3JnL3NjcmlwdHMvNTMzODM1L1RlbmclMjAlRTclQkQlOTElRTclOUIlOTglRTclOUIlQjQlRTklOTMlQkUlRTQlQjglOEIlRTglQkQlQkQlRTUlOEElQTklRTYlODklOEIlRTMlODAlOTAlRTUlODUlOEQlRTklQUElOEMlRTglQUYlODElRTclQTAlODElRTMlODAlOTEudXNlci5qcwovLyBAdXBkYXRlVVJMIGh0dHBzOi8vdXBkYXRlLmdyZWFzeWZvcmsub3JnL3NjcmlwdHMvNTMzODM1L1RlbmclMjAlRTclQkQlOTElRTclOUIlOTglRTclOUIlQjQlRTklOTMlQkUlRTQlQjglOEIlRTglQkQlQkQlRTUlOEElQTklRTYlODklOEIlRTMlODAlOTAlRTUlODUlOEQlRTklQUElOEMlRTglQUYlODElRTclQTAlODElRTMlODAlOTEubWV0YS5qcwovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbiAoKSB7CiAgICAndXNlIHN0cmljdCc7CgogICAgbGV0IHB0ID0gJycsIHNlbGVjdExpc3QgPSBbXSwgcGFyYW1zID0ge30sIG1vZGUgPSAnJywgd2lkdGggPSA4MDAsIHBhbiA9IHt9LCBjb2xvciA9ICcnLAogICAgICAgIGRvYyA9ICQoZG9jdW1lbnQpLCBwcm9ncmVzcyA9IHt9LCByZXF1ZXN0ID0ge30sIGlucyA9IHt9LCBpZG0gPSB7fTsKICAgIGNvbnN0IHNjcmlwdEluZm8gPSBHTV9pbmZvLnNjcmlwdDsKICAgIGNvbnN0IHZlcnNpb24gPSBzY3JpcHRJbmZvLnZlcnNpb247CiAgICBjb25zdCBhdXRob3IgPSBzY3JpcHRJbmZvLmF1dGhvcjsKICAgIGNvbnN0IG5hbWUgPSBzY3JpcHRJbmZvLm5hbWU7CiAgICBjb25zdCBtYW5hZ2VIYW5kbGVyID0gR01faW5mby5zY3JpcHRIYW5kbGVyOwogICAgY29uc3QgbWFuYWdlVmVyc2lvbiA9IEdNX2luZm8udmVyc2lvbjsKICAgIGNvbnN0IGN1c3RvbUNsYXNzID0gewogICAgICAgIHBvcHVwOiAncGwtcG9wdXAnLAogICAgICAgIGhlYWRlcjogJ3BsLWhlYWRlcicsCiAgICAgICAgdGl0bGU6ICdwbC10aXRsZScsCiAgICAgICAgY2xvc2VCdXR0b246ICdwbC1jbG9zZScsCiAgICAgICAgY29udGVudDogJ3BsLWNvbnRlbnQnLAogICAgICAgIGlucHV0OiAncGwtaW5wdXQnLAogICAgICAgIGZvb3RlcjogJ3BsLWZvb3RlcicKICAgIH07CgogICAgY29uc3QgdGVybWluYWxUeXBlID0gewogICAgICAgIHdjOiAiV2luZG93cyBDTUQiLAogICAgICAgIHdwOiAiV2luZG93cyBQb3dlclNoZWxsIiwKICAgICAgICBsdDogIkxpbnV4IOe7iOerryIsCiAgICAgICAgbHM6ICJMaW51eCBTaGVsbCIsCiAgICAgICAgbXQ6ICJNYWNPUyDnu4jnq68iLAogICAgfTsKCiAgICBsZXQgdG9hc3QgPSBTd2FsLm1peGluKHsKICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICBwb3NpdGlvbjogJ3RvcCcsCiAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgIHRpbWVyOiAzNTAwLAogICAgICAgIHRpbWVyUHJvZ3Jlc3NCYXI6IGZhbHNlLAogICAgICAgIGRpZE9wZW46ICh0b2FzdCkgPT4gewogICAgICAgICAgICB0b2FzdC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgU3dhbC5zdG9wVGltZXIpOwogICAgICAgICAgICB0b2FzdC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgU3dhbC5yZXN1bWVUaW1lcik7CiAgICAgICAgfQogICAgfSk7CgogICAgY29uc3QgbWVzc2FnZSA9IHsKICAgICAgICBzdWNjZXNzOiAodGV4dCkgPT4gewogICAgICAgICAgICB0b2FzdC5maXJlKHt0aXRsZTogdGV4dCwgaWNvbjogJ3N1Y2Nlc3MnfSk7CiAgICAgICAgfSwKICAgICAgICBlcnJvcjogKHRleHQpID0+IHsKICAgICAgICAgICAgdG9hc3QuZmlyZSh7dGl0bGU6IHRleHQsIGljb246ICdlcnJvcid9KTsKICAgICAgICB9LAogICAgICAgIHdhcm5pbmc6ICh0ZXh0KSA9PiB7CiAgICAgICAgICAgIHRvYXN0LmZpcmUoe3RpdGxlOiB0ZXh0LCBpY29uOiAnd2FybmluZyd9KTsKICAgICAgICB9LAogICAgICAgIGluZm86ICh0ZXh0KSA9PiB7CiAgICAgICAgICAgIHRvYXN0LmZpcmUoe3RpdGxlOiB0ZXh0LCBpY29uOiAnaW5mbyd9KTsKICAgICAgICB9LAogICAgICAgIHF1ZXN0aW9uOiAodGV4dCkgPT4gewogICAgICAgICAgICB0b2FzdC5maXJlKHt0aXRsZTogdGV4dCwgaWNvbjogJ3F1ZXN0aW9uJ30pOwogICAgICAgIH0KICAgIH07CgogICAgbGV0IGJhc2UgPSB7CgogICAgICAgIGdldENvb2tpZShuYW1lKSB7CiAgICAgICAgICAgIGxldCBjbmFtZSA9IG5hbWUgKyAiPSI7CiAgICAgICAgICAgIGxldCBjYSA9IGRvY3VtZW50LmNvb2tpZS5zcGxpdCgnOycpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGNhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBsZXQgYyA9IGNhW2ldLnRyaW0oKTsKICAgICAgICAgICAgICAgIGlmIChjLmluZGV4T2YoY25hbWUpID09IDApIHJldHVybiBjLnN1YnN0cmluZyhjbmFtZS5sZW5ndGgsIGMubGVuZ3RoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgfSwKCiAgICAgICAgaXNUeXBlKG9iaikgewogICAgICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikucmVwbGFjZSgvXlxbb2JqZWN0ICguKylcXSQvLCAnJDEnKS50b0xvd2VyQ2FzZSgpOwogICAgICAgIH0sCgogICAgICAgIGdldFZhbHVlKG5hbWUpIHsKICAgICAgICAgICAgcmV0dXJuIEdNX2dldFZhbHVlKG5hbWUpOwogICAgICAgIH0sCgogICAgICAgIHNldFZhbHVlKG5hbWUsIHZhbHVlKSB7CiAgICAgICAgICAgIEdNX3NldFZhbHVlKG5hbWUsIHZhbHVlKTsKICAgICAgICB9LAoKICAgICAgICBkZWxldGVWYWx1ZShuYW1lKSB7CiAgICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlKG5hbWUpOwogICAgICAgIH0sCgogICAgICAgIGdldFN0b3JhZ2Uoa2V5KSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGxvY2FsU3RvcmFnZS5nZXRJdGVtKGtleSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBzZXRTdG9yYWdlKGtleSwgdmFsdWUpIHsKICAgICAgICAgICAgaWYgKHRoaXMuaXNUeXBlKHZhbHVlKSA9PT0gJ29iamVjdCcgfHwgdGhpcy5pc1R5cGUodmFsdWUpID09PSAnYXJyYXknKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbG9jYWxTdG9yYWdlLnNldEl0ZW0oa2V5LCBKU09OLnN0cmluZ2lmeSh2YWx1ZSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrZXksIHZhbHVlKTsKICAgICAgICB9LAoKICAgICAgICBzZXRDbGlwYm9hcmQodGV4dCkgewogICAgICAgICAgICBHTV9zZXRDbGlwYm9hcmQodGV4dCwgJ3RleHQnKTsKICAgICAgICB9LAoKICAgICAgICBlKHN0cikgewogICAgICAgICAgICByZXR1cm4gYnRvYSh1bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoc3RyKSkpOwogICAgICAgIH0sCgogICAgICAgIGQoc3RyKSB7CiAgICAgICAgICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGF0b2Ioc3RyKSkpOwogICAgICAgIH0sCgogICAgICAgIGdldEV4dGVuc2lvbihuYW1lKSB7CiAgICAgICAgICAgIGNvbnN0IHJlZyA9IC8oPyFcLilcdyskLzsKICAgICAgICAgICAgaWYgKHJlZy50ZXN0KG5hbWUpKSB7CiAgICAgICAgICAgICAgICBsZXQgbWF0Y2ggPSBuYW1lLm1hdGNoKHJlZyk7CiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hbMF0udG9VcHBlckNhc2UoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSwKCiAgICAgICAgc2l6ZUZvcm1hdCh2YWx1ZSkgewogICAgICAgICAgICBpZiAodmFsdWUgPT09ICt2YWx1ZSkgewogICAgICAgICAgICAgICAgbGV0IHVuaXQgPSBbIkIiLCAiS0IiLCAiTUIiLCAiR0IiLCAiVEIiLCAiUEIiLCAiRUIiLCAiWkIiLCAiWUIiXTsKICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IE1hdGguZmxvb3IoTWF0aC5sb2codmFsdWUpIC8gTWF0aC5sb2coMTAyNCkpOwogICAgICAgICAgICAgICAgbGV0IHNpemUgPSB2YWx1ZSAvIE1hdGgucG93KDEwMjQsIGluZGV4KTsKICAgICAgICAgICAgICAgIHNpemUgPSBzaXplLnRvRml4ZWQoMSk7CiAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZSArIHVuaXRbaW5kZXhdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9LAoKICAgICAgICBzb3J0QnlOYW1lKGFycikgewogICAgICAgICAgICBjb25zdCBoYW5kbGUgPSAoKSA9PiB7CiAgICAgICAgICAgICAgICByZXR1cm4gKGEsIGIpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBwMSA9IGEuZmlsZW5hbWUgPyBhLmZpbGVuYW1lIDogYS5zZXJ2ZXJfZmlsZW5hbWU7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgcDIgPSBiLmZpbGVuYW1lID8gYi5maWxlbmFtZSA6IGIuc2VydmVyX2ZpbGVuYW1lOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBwMS5sb2NhbGVDb21wYXJlKHAyLCAiemgtQ04iKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGFyci5zb3J0KGhhbmRsZSgpKTsKICAgICAgICB9LAoKICAgICAgICBmaXhGaWxlbmFtZShuYW1lKSB7CiAgICAgICAgICAgIHJldHVybiBuYW1lLnJlcGxhY2UoL1shPyZ8YCInKlwvOjw+XFxdL2csICdfJyk7CiAgICAgICAgfSwKCiAgICAgICAgYmxvYkRvd25sb2FkKGJsb2IsIGZpbGVuYW1lKSB7CiAgICAgICAgICAgIGlmIChibG9iIGluc3RhbmNlb2YgQmxvYikgewogICAgICAgICAgICAgICAgY29uc3QgdXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgICAgICAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgICAgICAgICBhLmhyZWYgPSB1cmw7CiAgICAgICAgICAgICAgICBhLmRvd25sb2FkID0gZmlsZW5hbWU7CiAgICAgICAgICAgICAgICBhLmNsaWNrKCk7CiAgICAgICAgICAgICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKHVybCk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBwb3N0KHVybCwgZGF0YSwgaGVhZGVycywgdHlwZSkgewogICAgICAgICAgICBpZiAodGhpcy5pc1R5cGUoZGF0YSkgPT09ICdvYmplY3QnKSB7CiAgICAgICAgICAgICAgICBkYXRhID0gSlNPTi5zdHJpbmdpZnkoZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICAgICAgICAgIEdNX3htbGh0dHBSZXF1ZXN0KHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwgdXJsLCBoZWFkZXJzLCBkYXRhLAogICAgICAgICAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogdHlwZSB8fCAnanNvbicsCiAgICAgICAgICAgICAgICAgICAgb25sb2FkOiAocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPT09ICdibG9iJyA/IHJlc29sdmUocmVzKSA6IHJlc29sdmUocmVzLnJlc3BvbnNlIHx8IHJlcy5yZXNwb25zZVRleHQpOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgb25lcnJvcjogKGVycikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGdldCh1cmwsIGhlYWRlcnMsIHR5cGUsIGV4dHJhKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgcmVxdWVzdE9iaiA9IEdNX3htbGh0dHBSZXF1ZXN0KHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJHRVQiLCB1cmwsIGhlYWRlcnMsCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VUeXBlOiB0eXBlIHx8ICdqc29uJywKICAgICAgICAgICAgICAgICAgICBvbmxvYWQ6IChyZXMpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwNCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVxdWVzdE9iai5hYm9ydCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWRtW2V4dHJhLmluZGV4XSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdibG9iJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzLnN0YXR1cyA9PT0gMjAwICYmIGJhc2UuYmxvYkRvd25sb2FkKHJlcy5yZXNwb25zZSwgZXh0cmEuZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXMpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXMucmVzcG9uc2UgfHwgcmVzLnJlc3BvbnNlVGV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIG9ucHJvZ3Jlc3M6IChyZXMpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV4dHJhICYmIGV4dHJhLmZpbGVuYW1lICYmIGV4dHJhLmluZGV4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXMudG90YWwgPiAwID8gcHJvZ3Jlc3NbZXh0cmEuaW5kZXhdID0gKHJlcy5sb2FkZWQgKiAxMDAgLyByZXMudG90YWwpLnRvRml4ZWQoMikgOiBwcm9ncmVzc1tleHRyYS5pbmRleF0gPSAwLjAwOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvbmxvYWRzdGFydCgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZXh0cmEgJiYgZXh0cmEuZmlsZW5hbWUgJiYgZXh0cmEuaW5kZXggJiYgKHJlcXVlc3RbZXh0cmEuaW5kZXhdID0gcmVxdWVzdE9iaik7CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBvbmVycm9yOiAoZXJyKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgZ2V0RmluYWxVcmwodXJsLCBoZWFkZXJzKSB7CiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgcmVxdWVzdE9iaiA9IEdNX3htbGh0dHBSZXF1ZXN0KHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJHRVQiLCB1cmwsIGhlYWRlcnMsCiAgICAgICAgICAgICAgICAgICAgb25sb2FkOiAocmVzKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzLmZpbmFsVXJsKQogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgb25lcnJvcjogKGVycikgPT4gewogICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgc3RyaW5naWZ5KG9iaikgewogICAgICAgICAgICBsZXQgc3RyID0gJyc7CiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBvYmopIHsKICAgICAgICAgICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IG9ialtrZXldOwogICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgKz0gZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWVbaV0pICsgJyYnOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyICs9IGVuY29kZVVSSUNvbXBvbmVudChrZXkpICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICcmJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHN0ci5zbGljZSgwLCAtMSk7IC8vIOWOu+aOieacq+WwvueahCAiJiIKICAgICAgICB9LAoKICAgICAgICBhZGRTdHlsZShpZCwgdGFnLCBjc3MpIHsKICAgICAgICAgICAgdGFnID0gdGFnIHx8ICdzdHlsZSc7CiAgICAgICAgICAgIGxldCBkb2MgPSBkb2N1bWVudCwgc3R5bGVEb20gPSBkb2MuZ2V0RWxlbWVudEJ5SWQoaWQpOwogICAgICAgICAgICBpZiAoc3R5bGVEb20pIHJldHVybjsKICAgICAgICAgICAgbGV0IHN0eWxlID0gZG9jLmNyZWF0ZUVsZW1lbnQodGFnKTsKICAgICAgICAgICAgc3R5bGUucmVsID0gJ3N0eWxlc2hlZXQnOwogICAgICAgICAgICBzdHlsZS5pZCA9IGlkOwogICAgICAgICAgICB0YWcgPT09ICdzdHlsZScgPyBzdHlsZS5pbm5lckhUTUwgPSBjc3MgOiBzdHlsZS5ocmVmID0gY3NzOwogICAgICAgICAgICBkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXS5hcHBlbmRDaGlsZChzdHlsZSk7CiAgICAgICAgfSwKCiAgICAgICAgc2xlZXAodGltZSkgewogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIHRpbWUpKTsKICAgICAgICB9LAoKICAgICAgICBnZXRNYWpvclZlcnNpb24odmVyc2lvbikgewogICAgICAgICAgICBjb25zdCBbbWFqb3JdID0gKHZlcnNpb24gfHwgJycpLnNwbGl0KCcuJyk7CiAgICAgICAgICAgIHJldHVybiAvXlxkKyQvLnRlc3QobWFqb3IpID8gbWFqb3IgOiBudWxsOwogICAgICAgIH0sCgogICAgICAgIGZpbmRSZWFjdChkb20sIHRyYXZlcnNlVXAgPSAwKSB7CiAgICAgICAgICAgIGNvbnN0IGtleSA9IE9iamVjdC5rZXlzKGRvbSkuZmluZChrZXkgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIGtleS5zdGFydHNXaXRoKCJfX3JlYWN0RmliZXIkIikKICAgICAgICAgICAgICAgICAgICB8fCBrZXkuc3RhcnRzV2l0aCgiX19yZWFjdEludGVybmFsSW5zdGFuY2UkIik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb25zdCBkb21GaWJlciA9IGRvbVtrZXldOwogICAgICAgICAgICBpZiAoZG9tRmliZXIgPT0gbnVsbCkgcmV0dXJuIG51bGw7CgogICAgICAgICAgICBpZiAoZG9tRmliZXIuX2N1cnJlbnRFbGVtZW50KSB7CiAgICAgICAgICAgICAgICBsZXQgY29tcEZpYmVyID0gZG9tRmliZXIuX2N1cnJlbnRFbGVtZW50Ll9vd25lcjsKICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdHJhdmVyc2VVcDsgaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgY29tcEZpYmVyID0gY29tcEZpYmVyLl9jdXJyZW50RWxlbWVudC5fb3duZXI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gY29tcEZpYmVyLl9pbnN0YW5jZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY29uc3QgR2V0Q29tcEZpYmVyID0gZmliZXIgPT4gewogICAgICAgICAgICAgICAgbGV0IHBhcmVudEZpYmVyID0gZmliZXIucmV0dXJuOwogICAgICAgICAgICAgICAgd2hpbGUgKHR5cGVvZiBwYXJlbnRGaWJlci50eXBlID09ICJzdHJpbmciKSB7CiAgICAgICAgICAgICAgICAgICAgcGFyZW50RmliZXIgPSBwYXJlbnRGaWJlci5yZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50RmliZXI7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGxldCBjb21wRmliZXIgPSBHZXRDb21wRmliZXIoZG9tRmliZXIpOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRyYXZlcnNlVXA7IGkrKykgewogICAgICAgICAgICAgICAgY29tcEZpYmVyID0gR2V0Q29tcEZpYmVyKGNvbXBGaWJlcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGNvbXBGaWJlci5zdGF0ZU5vZGUgfHwgY29tcEZpYmVyOwogICAgICAgIH0sCgogICAgICAgIGluaXREZWZhdWx0Q29uZmlnKCkgewogICAgICAgICAgICBsZXQgdmFsdWUgPSBbewogICAgICAgICAgICAgICAgbmFtZTogJ3NldHRpbmdfcnBjX2RvbWFpbicsCiAgICAgICAgICAgICAgICB2YWx1ZTogJ2h0dHA6Ly9sb2NhbGhvc3QnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIG5hbWU6ICdzZXR0aW5nX3JwY19wb3J0JywKICAgICAgICAgICAgICAgIHZhbHVlOiAnMTY4MDAnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIG5hbWU6ICdzZXR0aW5nX3JwY19wYXRoJywKICAgICAgICAgICAgICAgIHZhbHVlOiAnL2pzb25ycGMnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIG5hbWU6ICdzZXR0aW5nX3JwY190b2tlbicsCiAgICAgICAgICAgICAgICB2YWx1ZTogJycKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgbmFtZTogJ3NldHRpbmdfcnBjX2RpcicsCiAgICAgICAgICAgICAgICB2YWx1ZTogJ0Q6JwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBuYW1lOiAnc2V0dGluZ190ZXJtaW5hbF90eXBlJywKICAgICAgICAgICAgICAgIHZhbHVlOiAnd2MnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIG5hbWU6ICdzZXR0aW5nX3RoZW1lX2NvbG9yJywKICAgICAgICAgICAgICAgIHZhbHVlOiAnIzA5QUFGRicKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgbmFtZTogJ3NldHRpbmdfaW5pdF9jb2RlJywKICAgICAgICAgICAgICAgIHZhbHVlOiAnJwogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICBuYW1lOiAnbGljZW5zZScsCiAgICAgICAgICAgICAgICB2YWx1ZTogJycKICAgICAgICAgICAgfV07CgogICAgICAgICAgICB2YWx1ZS5mb3JFYWNoKCh2KSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLmdldFZhbHVlKHYubmFtZSkgPT09IHVuZGVmaW5lZCAmJiBiYXNlLnNldFZhbHVlKHYubmFtZSwgdi52YWx1ZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIHNob3dTZXR0aW5nKCkgewogICAgICAgICAgICBsZXQgZG9tID0gJycsIGJ0biA9ICcnLAogICAgICAgICAgICAgICAgY29sb3JMaXN0ID0gWycjMDlBQUZGJywgJyNjYzMyMzUnLCAnIzUyNmVmYScsICcjNTE4YzE3JywgJyNlZDk0NGInLCAnI2Y5NjlhNScsICcjYmNhMjgwJ107CiAgICAgICAgICAgIGRvbSArPSBgPGxhYmVsIGNsYXNzPSJwbC1zZXR0aW5nLWxhYmVsIj48ZGl2IGNsYXNzPSJwbC1sYWJlbCI+UlBD5Li75py6PC9kaXY+PGlucHV0IHR5cGU9InRleHQiICBwbGFjZWhvbGRlcj0i5Li75py65Zyw5Z2A77yM6ZyA5bim5LiKaHR0cChzKTovLyIgY2xhc3M9InBsLWlucHV0IGxpc3RlbmVyLWRvbWFpbiIgdmFsdWU9IiR7YmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJyl9Ij48L2xhYmVsPmA7CiAgICAgICAgICAgIGRvbSArPSBgPGxhYmVsIGNsYXNzPSJwbC1zZXR0aW5nLWxhYmVsIj48ZGl2IGNsYXNzPSJwbC1sYWJlbCI+UlBD56uv5Y+jPC9kaXY+PGlucHV0IHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSLnq6/lj6Plj7fvvIzkvovlpoLvvJpNb3RyaXjkuLoxNjgwMCIgY2xhc3M9InBsLWlucHV0IGxpc3RlbmVyLXBvcnQiIHZhbHVlPSIke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKX0iPjwvbGFiZWw+YDsKICAgICAgICAgICAgZG9tICs9IGA8bGFiZWwgY2xhc3M9InBsLXNldHRpbmctbGFiZWwiPjxkaXYgY2xhc3M9InBsLWxhYmVsIj5SUEPot6/lvoQ8L2Rpdj48aW5wdXQgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9Iui3r+W+hO+8jOm7mOiupOS4ui9qc29ucnBjIiBjbGFzcz0icGwtaW5wdXQgbGlzdGVuZXItcGF0aCIgdmFsdWU9IiR7YmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcGF0aCcpfSI+PC9sYWJlbD5gOwogICAgICAgICAgICBkb20gKz0gYDxsYWJlbCBjbGFzcz0icGwtc2V0dGluZy1sYWJlbCI+PGRpdiBjbGFzcz0icGwtbGFiZWwiPlJQQ+WvhumSpTwvZGl2PjxpbnB1dCB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0i5peg5a+G6ZKl5peg6ZyA5aGr5YaZIiBjbGFzcz0icGwtaW5wdXQgbGlzdGVuZXItdG9rZW4iIHZhbHVlPSIke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyl9Ij48L2xhYmVsPmA7CiAgICAgICAgICAgIGRvbSArPSBgPGxhYmVsIGNsYXNzPSJwbC1zZXR0aW5nLWxhYmVsIj48ZGl2IGNsYXNzPSJwbC1sYWJlbCI+5L+d5a2Y6Lev5b6EPC9kaXY+PGlucHV0IHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSLmlofku7bkuIvovb3lkI7kv53lrZjot6/lvoTvvIzkvovlpoLvvJpEOiIgY2xhc3M9InBsLWlucHV0IGxpc3RlbmVyLWRpciIgdmFsdWU9IiR7YmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZGlyJyl9Ij48L2xhYmVsPmA7CgogICAgICAgICAgICBjb2xvckxpc3QuZm9yRWFjaCgodikgPT4gewogICAgICAgICAgICAgICAgYnRuICs9IGA8ZGl2IGRhdGEtY29sb3I9IiR7dn0iIHN0eWxlPSJiYWNrZ3JvdW5kOiAke3Z9O2JvcmRlcjogMXB4IHNvbGlkICR7dn0iIGNsYXNzPSJwbC1jb2xvci1ib3ggbGlzdGVuZXItY29sb3IgJHt2ID09PSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3RoZW1lX2NvbG9yJykgPyAnY2hlY2tlZCcgOiAnJ30iPjwvZGl2PmA7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb20gKz0gYDxsYWJlbCBjbGFzcz0icGwtc2V0dGluZy1sYWJlbCI+PGRpdiBjbGFzcz0icGwtbGFiZWwiPue7iOerr+exu+WeizwvZGl2PjxzZWxlY3QgY2xhc3M9InBsLWlucHV0IGxpc3RlbmVyLXRlcm1pbmFsIj5gOwogICAgICAgICAgICBPYmplY3Qua2V5cyh0ZXJtaW5hbFR5cGUpLmZvckVhY2goayA9PiB7CiAgICAgICAgICAgICAgICBkb20gKz0gYDxvcHRpb24gdmFsdWU9IiR7a30iICR7YmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190ZXJtaW5hbF90eXBlJykgPT09IGsgPyAnc2VsZWN0ZWQnIDogJyd9PiR7dGVybWluYWxUeXBlW2tdfTwvb3B0aW9uPmA7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb20gKz0gYDwvc2VsZWN0PjwvbGFiZWw+YDsKICAgICAgICAgICAgZG9tICs9IGA8bGFiZWwgY2xhc3M9InBsLXNldHRpbmctbGFiZWwiPjxkaXYgY2xhc3M9InBsLWxhYmVsIj7kuLvpopjpopzoibI8L2Rpdj4gPGRpdiBjbGFzcz0icGwtY29sb3IiPiR7YnRufTxkaXY+PC9sYWJlbD5gOwogICAgICAgICAgICBkb20gPSAnPGRpdj4nICsgZG9tICsgJzwvZGl2Pic7CgogICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgdGl0bGU6ICfliqnmiYvphY3nva4nLAogICAgICAgICAgICAgICAgaHRtbDogZG9tLAogICAgICAgICAgICAgICAgaWNvbjogJ2luZm8nLAogICAgICAgICAgICAgICAgc2hvd0Nsb3NlQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlLAogICAgICAgICAgICAgICAgZm9vdGVyOiBwYW4uZm9vdGVyLAogICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgIG1lc3NhZ2Uuc3VjY2Vzcygn6K6+572u5oiQ5Yqf77yBJyk7CiAgICAgICAgICAgICAgICBoaXN0b3J5LmdvKDApOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWNvbG9yJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2V0VmFsdWUoJ3NldHRpbmdfdGhlbWVfY29sb3InLCBlLnRhcmdldC5kYXRhc2V0LmNvbG9yKTsKICAgICAgICAgICAgICAgIG1lc3NhZ2Uuc3VjY2Vzcygn6K6+572u5oiQ5Yqf77yBJyk7CiAgICAgICAgICAgICAgICBoaXN0b3J5LmdvKDApOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdpbnB1dCcsICcubGlzdGVuZXItZG9tYWluJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicsIGUudGFyZ2V0LnZhbHVlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignaW5wdXQnLCAnLmxpc3RlbmVyLXBvcnQnLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgYmFzZS5zZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcsIGUudGFyZ2V0LnZhbHVlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignaW5wdXQnLCAnLmxpc3RlbmVyLXBhdGgnLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgYmFzZS5zZXRWYWx1ZSgnc2V0dGluZ19ycGNfcGF0aCcsIGUudGFyZ2V0LnZhbHVlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignaW5wdXQnLCAnLmxpc3RlbmVyLXRva2VuJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJywgZS50YXJnZXQudmFsdWUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdpbnB1dCcsICcubGlzdGVuZXItZGlyJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RpcicsIGUudGFyZ2V0LnZhbHVlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2hhbmdlJywgJy5saXN0ZW5lci10ZXJtaW5hbCcsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnLCBlLnRhcmdldC52YWx1ZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIHJlZ2lzdGVyTWVudUNvbW1hbmQoKSB7CiAgICAgICAgICAgIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQoJ+Kame+4jyDorr7nva4nLCAoKSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dTZXR0aW5nKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGNyZWF0ZVRpcCgpIHsKICAgICAgICAgICAgJCgnYm9keScpLmFwcGVuZCgnPGRpdiBjbGFzcz0icGwtdG9vbHRpcCI+PC9kaXY+Jyk7CgogICAgICAgICAgICBkb2Mub24oJ21vdXNlZW50ZXIgbW91c2VsZWF2ZScsICcubGlzdGVuZXItdGlwJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIGlmIChlLnR5cGUgPT09ICdtb3VzZWVudGVyJykgewogICAgICAgICAgICAgICAgICAgIGxldCBmaWxlbmFtZSA9IGUuY3VycmVudFRhcmdldC5pbm5lclRleHQ7CiAgICAgICAgICAgICAgICAgICAgbGV0IHNpemUgPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5zaXplOwogICAgICAgICAgICAgICAgICAgIGxldCB0aXAgPSBgJHtmaWxlbmFtZX08c3BhbiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7Y29sb3I6ICNmNTZjNmM7Ij4ke3NpemV9PC9zcGFuPmA7CiAgICAgICAgICAgICAgICAgICAgJChlLmN1cnJlbnRUYXJnZXQpLmNzcyh7b3BhY2l0eTogJzAuNSd9KTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtdG9vbHRpcCcpLmh0bWwodGlwKS5jc3MoewogICAgICAgICAgICAgICAgICAgICAgICAnbGVmdCc6IGUucGFnZVggKyAxMCArICdweCcsCiAgICAgICAgICAgICAgICAgICAgICAgICd0b3AnOiBlLnBhZ2VZIC0gZS5jdXJyZW50VGFyZ2V0Lm9mZnNldFRvcCA+IDE0ID8gZS5wYWdlWSArICdweCcgOiBlLnBhZ2VZICsgMjAgKyAncHgnCiAgICAgICAgICAgICAgICAgICAgfSkuc2hvdygpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkKGUuY3VycmVudFRhcmdldCkuY3NzKHtvcGFjaXR5OiAnMSd9KTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtdG9vbHRpcCcpLmhpZGUoMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGNyZWF0ZUxvYWRpbmcoKSB7CiAgICAgICAgICAgIHJldHVybiAkKCc8ZGl2IGNsYXNzPSJwbC1sb2FkaW5nIj48ZGl2IGNsYXNzPSJwbC1sb2FkaW5nLWJveCI+PGRpdj48ZGl2PjwvZGl2PjxkaXY+PC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+Jyk7CiAgICAgICAgfSwKCiAgICAgICAgY3JlYXRlRG93bmxvYWRJZnJhbWUoKSB7CiAgICAgICAgICAgIGxldCAkZGl2ID0gJCgnPGRpdiBzdHlsZT0icGFkZGluZzowO21hcmdpbjowO2Rpc3BsYXk6YmxvY2siPjwvZGl2PicpOwogICAgICAgICAgICBsZXQgJGlmcmFtZSA9ICQoJzxpZnJhbWUgc3JjPSJqYXZhc2NyaXB0OjsiIGlkPSJkb3dubG9hZElmcmFtZSIgc3R5bGU9ImRpc3BsYXk6bm9uZSI+PC9pZnJhbWU+Jyk7CiAgICAgICAgICAgICRkaXYuYXBwZW5kKCRpZnJhbWUpOwogICAgICAgICAgICAkKCdib2R5JykuYXBwZW5kKCRkaXYpOwogICAgICAgIH0sCgogICAgICAgIGdldE1pcnJvckxpc3QobGluaywgbWlycm9yLCB0aHJlYWQgPSAyKSB7CiAgICAgICAgICAgIGxldCBob3N0ID0gbmV3IFVSTChsaW5rKS5ob3N0OwogICAgICAgICAgICBsZXQgbWlycm9ycyA9IFtdOwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG1pcnJvci5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aHJlYWQ7IGorKykgewogICAgICAgICAgICAgICAgICAgIGxldCBpdGVtID0gbGluay5yZXBsYWNlKGhvc3QsIG1pcnJvcltpXSkgKyAnJicucmVwZWF0KGopOwogICAgICAgICAgICAgICAgICAgIG1pcnJvcnMucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gbWlycm9ycy5qb2luKCdcbicpOwogICAgICAgIH0sCgogICAgICAgIGxpc3RlbkVsZW1lbnQoZWxlbWVudCwgY2FsbGJhY2spIHsKICAgICAgICAgICAgY29uc3QgY2hlY2tJbnRlcnZhbCA9IDUwMDsgLy8g5qOA5p+l5YWD57Sg55qE6Ze06ZqU5pe26Ze077yI5q+r56eS77yJCiAgICAgICAgICAgIGxldCB3YXNFbGVtZW50Rm91bmQgPSBmYWxzZTsgLy8g55So5LqO6Lef6Liq5YWD57Sg5piv5ZCm5LmL5YmN5bey57uP5om+5YiwCgogICAgICAgICAgICBmdW5jdGlvbiBjaGVja0VsZW1lbnQoKSB7CiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbGVtZW50KSkgewogICAgICAgICAgICAgICAgICAgIHdhc0VsZW1lbnRGb3VuZCA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAod2FzRWxlbWVudEZvdW5kKSB7CiAgICAgICAgICAgICAgICAgICAgd2FzRWxlbWVudEZvdW5kID0gZmFsc2U7IC8vIOWFg+e0oOa2iOWkseWQjumHjee9ruagh+W/lwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoY2hlY2tFbGVtZW50LCBjaGVja0ludGVydmFsKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgY2hlY2tFbGVtZW50KCk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkUGFuTGlua2VyU3R5bGUoKSB7CiAgICAgICAgICAgIGNvbG9yID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190aGVtZV9jb2xvcicpOwogICAgICAgICAgICBsZXQgY3NzID0gYAogICAgICAgICAgICBib2R5Ojotd2Via2l0LXNjcm9sbGJhciB7IGRpc3BsYXk6IG5vbmUgfQogICAgICAgICAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyIHsgd2lkdGg6IDZweDsgaGVpZ2h0OiAxMHB4IH0KICAgICAgICAgICAgOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7IGJvcmRlci1yYWRpdXM6IDA7IGJhY2tncm91bmQ6IG5vbmUgfQogICAgICAgICAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsgYmFja2dyb3VuZC1jb2xvcjogcmdiYSg4NSw4NSw4NSwuNCkgfQogICAgICAgICAgICA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iLDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIgeyBib3JkZXItcmFkaXVzOiA1cHg7IC13ZWJraXQtYm94LXNoYWRvdzogaW5zZXQgMCAwIDZweCByZ2JhKDAsMCwwLC4yKSB9CiAgICAgICAgICAgIDo6LXdlYmtpdC1zY3JvbGxiYXItdGh1bWI6aG92ZXIgeyBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDg1LDg1LDg1LC4zKSB9CiAgICAgICAgICAgIC5zd2FsMi1wb3B1cCB7IGZvbnQtc2l6ZTogMTZweCAhaW1wb3J0YW50OyB9CiAgICAgICAgICAgIC5wbC1wb3B1cCB7IGZvbnQtc2l6ZTogMTJweCAhaW1wb3J0YW50OyB9CiAgICAgICAgICAgIC5wbC1wb3B1cCBhIHsgY29sb3I6ICR7Y29sb3J9ICFpbXBvcnRhbnQ7IH0KICAgICAgICAgICAgLnBsLWhlYWRlciB7IHBhZGRpbmc6IDAhaW1wb3J0YW50O2FsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0IWltcG9ydGFudDsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlZWUhaW1wb3J0YW50OyBtYXJnaW46IDAgMCAxMHB4IWltcG9ydGFudDsgcGFkZGluZzogMCAwIDVweCFpbXBvcnRhbnQ7IH0KICAgICAgICAgICAgLnBsLXRpdGxlIHsgZm9udC1zaXplOiAxNnB4IWltcG9ydGFudDsgbGluZS1oZWlnaHQ6IDEhaW1wb3J0YW50O3doaXRlLXNwYWNlOiBub3dyYXAhaW1wb3J0YW50OyB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcyFpbXBvcnRhbnQ7fQogICAgICAgICAgICAucGwtY29udGVudCB7IHBhZGRpbmc6IDAgIWltcG9ydGFudDsgZm9udC1zaXplOiAxMnB4IWltcG9ydGFudDsgfQogICAgICAgICAgICAucGwtbWFpbiB7IG1heC1oZWlnaHQ6IDQwMHB4O292ZXJmbG93LXk6c2Nyb2xsOyB9CiAgICAgICAgICAgIC5wbC1mb290ZXIge2ZvbnQtc2l6ZTogMTJweCFpbXBvcnRhbnQ7anVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0IWltcG9ydGFudDsgbWFyZ2luOiAxMHB4IDAgMCFpbXBvcnRhbnQ7IHBhZGRpbmc6IDVweCAwIDAhaW1wb3J0YW50OyBjb2xvcjogI2Y1NmM2YyFpbXBvcnRhbnQ7IH0KICAgICAgICAgICAgLnBsLWl0ZW0geyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBsaW5lLWhlaWdodDogMjJweDsgfQogICAgICAgICAgICAucGwtaXRlbS1uYW1lIHsgZmxleDogMCAwIDE1MHB4OyB0ZXh0LWFsaWduOiBsZWZ0O21hcmdpbi1yaWdodDogMTBweDsgb3ZlcmZsb3c6IGhpZGRlbjsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7IGN1cnNvcjpkZWZhdWx0OyB9CiAgICAgICAgICAgIC5wbC1pdGVtLWxpbmsgeyBmbGV4OiAxOyBvdmVyZmxvdzogaGlkZGVuOyB0ZXh0LWFsaWduOiBsZWZ0OyB3aGl0ZS1zcGFjZTogbm93cmFwOyB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztjdXJzb3I6cG9pbnRlciB9CiAgICAgICAgICAgIC5wbC1pdGVtLWJ0biB7IGJhY2tncm91bmQ6ICR7Y29sb3J9OyBwYWRkaW5nOiA0cHggNXB4OyBib3JkZXItcmFkaXVzOiAzcHg7IGxpbmUtaGVpZ2h0OiAxOyBjdXJzb3I6IHBvaW50ZXI7IGNvbG9yOiAjZmZmOyB9CiAgICAgICAgICAgIC5wbC1pdGVtLXRpcCB7IGRpc3BsYXk6IGZsZXg7IGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtmbGV4OiAxOyB9CiAgICAgICAgICAgIC5wbC1iYWNrIHsgd2lkdGg6IDcwcHg7IGJhY2tncm91bmQ6ICNkZGQ7IGJvcmRlci1yYWRpdXM6IDNweDsgY3Vyc29yOnBvaW50ZXI7IG1hcmdpbjoxcHggMDsgfQogICAgICAgICAgICAucGwtZXh0IHsgZGlzcGxheTogaW5saW5lLWJsb2NrOyB3aWR0aDogNDRweDsgYmFja2dyb3VuZDogIzk5OTsgY29sb3I6ICNmZmY7IGhlaWdodDogMTZweDsgbGluZS1oZWlnaHQ6IDE2cHg7IGZvbnQtc2l6ZTogMTJweDsgYm9yZGVyLXJhZGl1czogM3B4O30KICAgICAgICAgICAgLnBsLXJldHJ5IHtwYWRkaW5nOiAzcHggMTBweDsgYmFja2dyb3VuZDogI2NjMzIzNTsgY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDNweDsgY3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgLnBsLWJyb3dzZXJkb3dubG9hZCB7IHBhZGRpbmc6IDNweCAxMHB4OyBiYWNrZ3JvdW5kOiAke2NvbG9yfTsgY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDNweDsgY3Vyc29yOiBwb2ludGVyO30KICAgICAgICAgICAgLnBsLWl0ZW0tcHJvZ3Jlc3MgeyBkaXNwbGF5OmZsZXg7ZmxleDogMTthbGlnbi1pdGVtczpjZW50ZXJ9CiAgICAgICAgICAgIC5wbC1wcm9ncmVzcyB7IGRpc3BsYXk6IGlubGluZS1ibG9jazt2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO3dpZHRoOiAxMDAlOyBib3gtc2l6aW5nOiBib3JkZXItYm94O2xpbmUtaGVpZ2h0OiAxO3Bvc2l0aW9uOiByZWxhdGl2ZTtoZWlnaHQ6MTVweDsgZmxleDogMX0KICAgICAgICAgICAgLnBsLXByb2dyZXNzLW91dGVyIHsgaGVpZ2h0OiAxNXB4O2JvcmRlci1yYWRpdXM6IDEwMHB4O2JhY2tncm91bmQtY29sb3I6ICNlYmVlZjU7b3ZlcmZsb3c6IGhpZGRlbjtwb3NpdGlvbjogcmVsYXRpdmU7dmVydGljYWwtYWxpZ246IG1pZGRsZTt9CiAgICAgICAgICAgIC5wbC1wcm9ncmVzcy1pbm5lcnsgcG9zaXRpb246IGFic29sdXRlO2xlZnQ6IDA7dG9wOiAwO2JhY2tncm91bmQtY29sb3I6ICM0MDllZmY7dGV4dC1hbGlnbjogcmlnaHQ7Ym9yZGVyLXJhZGl1czogMTAwcHg7bGluZS1oZWlnaHQ6IDE7d2hpdGUtc3BhY2U6IG5vd3JhcDt0cmFuc2l0aW9uOiB3aWR0aCAuNnMgZWFzZTt9CiAgICAgICAgICAgIC5wbC1wcm9ncmVzcy1pbm5lci10ZXh0IHsgZGlzcGxheTogaW5saW5lLWJsb2NrO3ZlcnRpY2FsLWFsaWduOiBtaWRkbGU7Y29sb3I6ICNkMWQxZDE7Zm9udC1zaXplOiAxMnB4O21hcmdpbjogMCA1cHg7aGVpZ2h0OiAxNXB4fQogICAgICAgICAgICAucGwtcHJvZ3Jlc3MtdGlweyBmbGV4OjE7dGV4dC1hbGlnbjpyaWdodH0KICAgICAgICAgICAgLnBsLXByb2dyZXNzLWhvd3sgZmxleDogMCAwIDkwcHg7IGJhY2tncm91bmQ6ICNkZGQ7IGJvcmRlci1yYWRpdXM6IDNweDsgbWFyZ2luLWxlZnQ6IDEwcHg7IGN1cnNvcjogcG9pbnRlcjsgdGV4dC1hbGlnbjogY2VudGVyO30KICAgICAgICAgICAgLnBsLXByb2dyZXNzLXN0b3B7IGZsZXg6IDAgMCA1MHB4OyBwYWRkaW5nOiAwIDEwcHg7IGJhY2tncm91bmQ6ICNjYzMyMzU7IGNvbG9yOiAjZmZmOyBib3JkZXItcmFkaXVzOiAzcHg7IGN1cnNvcjogcG9pbnRlcjttYXJnaW4tbGVmdDoxMHB4O2hlaWdodDoyMHB4fQogICAgICAgICAgICAucGwtcHJvZ3Jlc3MtaW5uZXItdGV4dDphZnRlciB7IGRpc3BsYXk6IGlubGluZS1ibG9jaztjb250ZW50OiAiIjtoZWlnaHQ6IDEwMCU7dmVydGljYWwtYWxpZ246IG1pZGRsZTt9CiAgICAgICAgICAgIC5wbC1idG4tcHJpbWFyeSB7IGJhY2tncm91bmQ6ICR7Y29sb3J9OyBib3JkZXI6IDA7IGJvcmRlci1yYWRpdXM6IDRweDsgY29sb3I6ICNmZmZmZmY7IGN1cnNvcjogcG9pbnRlcjsgZm9udC1zaXplOiAxMnB4OyBvdXRsaW5lOiBub25lOyBkaXNwbGF5OmZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGp1c3RpZnktY29udGVudDogY2VudGVyOyBtYXJnaW46IDJweCAwOyBwYWRkaW5nOiA2cHggMDt0cmFuc2l0aW9uOiAwLjNzIG9wYWNpdHk7IH0KICAgICAgICAgICAgLnBsLWJ0bi1wcmltYXJ5OmhvdmVyIHsgb3BhY2l0eTogMC45O3RyYW5zaXRpb246IDAuM3Mgb3BhY2l0eTsgfQogICAgICAgICAgICAucGwtYnRuLXN1Y2Nlc3MgeyBiYWNrZ3JvdW5kOiAjNTVhZjI4OyBhbmltYXRpb246IGVhc2VPcGFjaXR5IDEuMnMgMjsgYW5pbWF0aW9uLWZpbGwtbW9kZTpmb3J3YXJkcyB9CiAgICAgICAgICAgIC5wbC1idG4taW5mbyB7IGJhY2tncm91bmQ6ICM2MDYyNjY7IH0KICAgICAgICAgICAgLnBsLWJ0bi13YXJuaW5nIHsgYmFja2dyb3VuZDogI2RhOTMyODsgfQogICAgICAgICAgICAucGwtYnRuLXdhcm5pbmcgeyBiYWNrZ3JvdW5kOiAjZGE5MzI4OyB9CiAgICAgICAgICAgIC5wbC1idG4tZGFuZ2VyIHsgYmFja2dyb3VuZDogI2NjMzIzNTsgfQogICAgICAgICAgICAuYWxpLWJ1dHRvbiB7ZGlzcGxheTogaW5saW5lLWZsZXg7YWxpZ24taXRlbXM6IGNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtib3JkZXI6IDAgc29saWQgdHJhbnNwYXJlbnQ7Ym9yZGVyLXJhZGl1czogNXB4O2JveC1zaGFkb3c6IDAgMCAwIDAgdHJhbnNwYXJlbnQ7d2lkdGg6IGZpdC1jb250ZW50O3doaXRlLXNwYWNlOiBub3dyYXA7ZmxleC1zaHJpbms6IDA7Zm9udC1zaXplOiAxNHB4O2xpbmUtaGVpZ2h0OiAxLjU7b3V0bGluZTogMDt0b3VjaC1hY3Rpb246IG1hbmlwdWxhdGlvbjt0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kIC4zcyBlYXNlLGNvbG9yIC4zcyBlYXNlLGJvcmRlciAuM3MgZWFzZSxib3gtc2hhZG93IC4zcyBlYXNlO2NvbG9yOiAjZmZmO2JhY2tncm91bmQ6IHJnYig5OSAxMjUgMjU1KTttYXJnaW4tbGVmdDogMjBweDtwYWRkaW5nOiAxcHggMTJweDtwb3NpdGlvbjogcmVsYXRpdmU7IGN1cnNvcjpwb2ludGVyOyBoZWlnaHQ6IDMycHg7fQogICAgICAgICAgICAuYWxpLWJ1dHRvbjpob3ZlciB7YmFja2dyb3VuZDogcmdiKDEyMiwgMTQ0LCAyNTUpfQogICAgICAgICAgICAudGlhbnlpLWJ1dHRvbiB7bWFyZ2luLXJpZ2h0OiAyMHB4OyBwYWRkaW5nOiA0cHggMTJweDsgYm9yZGVyLXJhZGl1czogNHB4OyBjb2xvcjogI2ZmZjsgZm9udC1zaXplOiAxMnB4OyBib3JkZXI6IDFweCBzb2xpZCAjMDA3M2UzOyBiYWNrZ3JvdW5kOiAjMmI4OWVhOyBjdXJzb3I6IHBvaW50ZXI7IHBvc2l0aW9uOiByZWxhdGl2ZTt9CiAgICAgICAgICAgIC50aWFueWktYnV0dG9uOmhvdmVyIHtib3JkZXItY29sb3I6ICMxODc0ZDM7IGJhY2tncm91bmQ6ICMzNjk5ZmY7fQogICAgICAgICAgICAueWlkb25nLWJ1dHRvbiB7ZmxvYXQ6IGxlZnQ7IHBvc2l0aW9uOiByZWxhdGl2ZTsgbWFyZ2luOiAyMHB4IDI0cHggMjBweCAwOyB3aWR0aDogOThweDsgaGVpZ2h0OiAzNnB4OyBiYWNrZ3JvdW5kOiAjMzE4MWY5OyBib3JkZXItcmFkaXVzOiAycHg7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICNmZmY7IGxpbmUtaGVpZ2h0OiAzOXB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IGN1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgIC55aWRvbmctc2hhcmUtYnV0dG9uIHtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHBvc2l0aW9uOiByZWxhdGl2ZTsgZm9udC1zaXplOiAxNHB4OyBsaW5lLWhlaWdodDogMzZweDsgaGVpZ2h0OiAzNnB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IGNvbG9yOiAjZmZmOyBib3JkZXI6IDFweCBzb2xpZCAjNWE5YWZhOyBib3JkZXItcmFkaXVzOiAycHg7IHBhZGRpbmc6IDAgMjRweDsgbWFyZ2luLWxlZnQ6IDI0cHg7IGJhY2tncm91bmQ6ICMzMTgxZjk7IGN1cnNvcjogcG9pbnRlcjt9CiAgICAgICAgICAgIC55aWRvbmctYnV0dG9uOmhvdmVyIHtiYWNrZ3JvdW5kOiAjMmQ3NmU1O30KICAgICAgICAgICAgLnh1bmxlaS1idXR0b24ge2Rpc3BsYXk6IGlubGluZS1mbGV4O2FsaWduLWl0ZW1zOiBjZW50ZXI7anVzdGlmeS1jb250ZW50OiBjZW50ZXI7Ym9yZGVyOiAwIHNvbGlkIHRyYW5zcGFyZW50O2JvcmRlci1yYWRpdXM6IDVweDtib3gtc2hhZG93OiAwIDAgMCAwIHRyYW5zcGFyZW50O3dpZHRoOiBmaXQtY29udGVudDt3aGl0ZS1zcGFjZTogbm93cmFwO2ZsZXgtc2hyaW5rOiAwO2ZvbnQtc2l6ZTogMTRweDtsaW5lLWhlaWdodDogMS41O291dGxpbmU6IDA7dG91Y2gtYWN0aW9uOiBtYW5pcHVsYXRpb247dHJhbnNpdGlvbjogYmFja2dyb3VuZCAuM3MgZWFzZSxjb2xvciAuM3MgZWFzZSxib3JkZXIgLjNzIGVhc2UsYm94LXNoYWRvdyAuM3MgZWFzZTtjb2xvcjogI2ZmZjtiYWNrZ3JvdW5kOiAjM2Y4NWZmO21hcmdpbi1sZWZ0OiAxMnB4O3BhZGRpbmc6IDBweCAxMnB4O3Bvc2l0aW9uOiByZWxhdGl2ZTsgY3Vyc29yOnBvaW50ZXI7IGhlaWdodDogMzZweDt9CiAgICAgICAgICAgIC54dW5sZWktYnV0dG9uOmhvdmVyIHtiYWNrZ3JvdW5kOiAjNjE5YmZmfQogICAgICAgICAgICAucXVhcmstYnV0dG9uIHtkaXNwbGF5OiBpbmxpbmUtZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsganVzdGlmeS1jb250ZW50OiBjZW50ZXI7IGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7IGJvcmRlci1yYWRpdXM6IDhweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgZmxleC1zaHJpbms6IDA7IGZvbnQtc2l6ZTogMTRweDsgbGluZS1oZWlnaHQ6IDEuNTsgb3V0bGluZTogMDsgY29sb3I6ICMzMzM7IGJhY2tncm91bmQ6ICNmZmY7IG1hcmdpbi1yaWdodDogMTBweDsgcGFkZGluZzogMHB4IDE0cHg7IHBvc2l0aW9uOiByZWxhdGl2ZTsgY3Vyc29yOiBwb2ludGVyOyBoZWlnaHQ6IDM2cHg7fQogICAgICAgICAgICAucXVhcmstYnV0dG9uOmhvdmVyIHsgYmFja2dyb3VuZDojZjZmNmY2IH0KICAgICAgICAgICAgLnBsLWRyb3Bkb3duLW1lbnUge3Bvc2l0aW9uOiBhYnNvbHV0ZTtyaWdodDogMDt0b3A6IDMwcHg7cGFkZGluZzogNXB4IDA7Y29sb3I6IHJnYigzNywgMzgsIDQzKTtiYWNrZ3JvdW5kOiAjZmZmO3otaW5kZXg6IDk5OTt3aWR0aDogMTAycHg7Ym9yZGVyOiAxcHggc29saWQgI2RkZDtib3JkZXItcmFkaXVzOiAxMHB4OyBib3gtc2hhZG93OiAwIDAgMXB4IDFweCByZ2IoMjggMjggMzIgLyA1JSksIDAgOHB4IDI0cHggcmdiKDI4IDI4IDMyIC8gMTIlKTt9CiAgICAgICAgICAgIC5wbC1kcm9wZG93bi1tZW51LWl0ZW0geyBoZWlnaHQ6IDMwcHg7ZGlzcGxheTogZmxleDthbGlnbi1pdGVtczogY2VudGVyO2p1c3RpZnktY29udGVudDogY2VudGVyO2N1cnNvcjpwb2ludGVyIH0KICAgICAgICAgICAgLnBsLWRyb3Bkb3duLW1lbnUtaXRlbTpob3ZlciB7IGJhY2tncm91bmQtY29sb3I6IHJnYmEoMTMyLDEzMywxNDEsMC4wOCk7fQogICAgICAgICAgICAucGwtYnV0dG9uIC5wbC1kcm9wZG93bi1tZW51IHsgZGlzcGxheTogbm9uZTsgfQogICAgICAgICAgICAucGwtYnV0dG9uOmhvdmVyIC5wbC1kcm9wZG93bi1tZW51IHsgZGlzcGxheTogYmxvY2shaW1wb3J0YW50OyB9CiAgICAgICAgICAgIC5wbC1idXR0b24taW5pdCB7IG9wYWNpdHk6IDAuNTsgYW5pbWF0aW9uOiBlYXNlSW5pdE9wYWNpdHkgMS4ycyAzOyBhbmltYXRpb24tZmlsbC1tb2RlOmZvcndhcmRzIH0KICAgICAgICAgICAgIEBrZXlmcmFtZXMgZWFzZUluaXRPcGFjaXR5IHsgZnJvbSB7IG9wYWNpdHk6IDAuNTsgfSA1MCUgeyBvcGFjaXR5OiAxIH0gdG8geyBvcGFjaXR5OiAwLjU7IH0gfQogICAgICAgICAgICAgQGtleWZyYW1lcyBlYXNlT3BhY2l0eSB7IGZyb20geyBvcGFjaXR5OiAxOyB9IDUwJSB7IG9wYWNpdHk6IDAuMzUgfSB0byB7IG9wYWNpdHk6IDE7IH0gfQogICAgICAgICAgICAuZWxlbWVudC1jbGlja2VkIHsgb3BhY2l0eTogMC41OyB9CiAgICAgICAgICAgIC5wbC1leHRyYSB7IG1hcmdpbi10b3A6IDEwcHg7ZGlzcGxheTpmbGV4fQogICAgICAgICAgICAucGwtZXh0cmEgYnV0dG9uIHsgZmxleDogMX0KICAgICAgICAgICAgLnBvaW50ZXIgeyBjdXJzb3I6cG9pbnRlciB9CiAgICAgICAgICAgIC5wbC1zZXR0aW5nLWxhYmVsIHsgZGlzcGxheTogZmxleDthbGlnbi1pdGVtczogY2VudGVyO2p1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtwYWRkaW5nLXRvcDogMTBweDsgfQogICAgICAgICAgICAucGwtbGFiZWwgeyBmbGV4OiAwIDAgMTAwcHg7dGV4dC1hbGlnbjpsZWZ0OyB9CiAgICAgICAgICAgIC5wbC1pbnB1dCB7IGZsZXg6IDE7IHBhZGRpbmc6IDhweCAxMHB4OyBib3JkZXI6IDFweCBzb2xpZCAjYzJjMmMyOyBib3JkZXItcmFkaXVzOiA1cHg7IGZvbnQtc2l6ZTogMTRweCB9CiAgICAgICAgICAgIC5wbC1jb2xvciB7IGZsZXg6IDE7ZGlzcGxheTogZmxleDtmbGV4LXdyYXA6IHdyYXA7IG1hcmdpbi1yaWdodDogLTEwcHg7fQogICAgICAgICAgICAucGwtY29sb3ItYm94IHsgd2lkdGg6IDM1cHg7aGVpZ2h0OiAzNXB4O21hcmdpbjoxMHB4IDEwcHggMCAwOzsgYm94LXNpemluZzogYm9yZGVyLWJveDtib3JkZXI6MXB4IHNvbGlkICNmZmY7Y3Vyc29yOnBvaW50ZXIgfQogICAgICAgICAgICAucGwtY29sb3ItYm94LmNoZWNrZWQgeyBib3JkZXI6M3B4IGRhc2hlZCAjMTExIWltcG9ydGFudCB9CiAgICAgICAgICAgIC5wbC1jbG9zZTpmb2N1cyB7IG91dGxpbmU6IDA7IGJveC1zaGFkb3c6IG5vbmU7IH0KICAgICAgICAgICAgLnRhZy1kYW5nZXIge2NvbG9yOiNjYzMyMzU7bWFyZ2luOiAwIDVweDt9CiAgICAgICAgICAgIC5wbC10b29sdGlwIHsgcG9zaXRpb246IGFic29sdXRlOyBjb2xvcjogI2ZmZmZmZjsgbWF4LXdpZHRoOiA2MDBweDsgZm9udC1zaXplOiAxMnB4OyBwYWRkaW5nOiA1cHggMTBweDsgYmFja2dyb3VuZDogIzMzMzsgYm9yZGVyLXJhZGl1czogNXB4OyB6LWluZGV4OiAxMTAwMDA7IGxpbmUtaGVpZ2h0OiAxLjM7IGRpc3BsYXk6bm9uZTsgd29yZC1icmVhazogYnJlYWstYWxsO30KICAgICAgICAgICAgIEBrZXlmcmFtZXMgbG9hZCB7IDAlIHsgdHJhbnNmb3JtOiByb3RhdGUoMGRlZykgfSAxMDAlIHsgdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKSB9IH0KICAgICAgICAgICAgLnBsLWxvYWRpbmctYm94ID4gZGl2ID4gZGl2IHsgcG9zaXRpb246IGFic29sdXRlO2JvcmRlci1yYWRpdXM6IDUwJTt9CiAgICAgICAgICAgIC5wbC1sb2FkaW5nLWJveCA+IGRpdiA+IGRpdjpudGgtY2hpbGQoMSkgeyB0b3A6IDlweDtsZWZ0OiA5cHg7d2lkdGg6IDgycHg7aGVpZ2h0OiA4MnB4O2JhY2tncm91bmQ6ICNmZmZmZmY7fQogICAgICAgICAgICAucGwtbG9hZGluZy1ib3ggPiBkaXYgPiBkaXY6bnRoLWNoaWxkKDIpIHsgdG9wOiAxNHB4O2xlZnQ6IDM4cHg7d2lkdGg6IDI1cHg7aGVpZ2h0OiAyNXB4O2JhY2tncm91bmQ6ICM2NjY2NjY7YW5pbWF0aW9uOiBsb2FkIDFzIGxpbmVhciBpbmZpbml0ZTt0cmFuc2Zvcm0tb3JpZ2luOiAxMnB4IDM2cHg7fQogICAgICAgICAgICAucGwtbG9hZGluZyB7IHdpZHRoOiAxNnB4O2hlaWdodDogMTZweDtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7b3ZlcmZsb3c6IGhpZGRlbjtiYWNrZ3JvdW5kOiBub25lO30KICAgICAgICAgICAgLnBsLWxvYWRpbmctYm94IHsgd2lkdGg6IDEwMCU7aGVpZ2h0OiAxMDAlO3Bvc2l0aW9uOiByZWxhdGl2ZTt0cmFuc2Zvcm06IHRyYW5zbGF0ZVooMCkgc2NhbGUoMC4xNik7YmFja2ZhY2UtdmlzaWJpbGl0eTogaGlkZGVuO3RyYW5zZm9ybS1vcmlnaW46IDAgMDt9CiAgICAgICAgICAgIC5wbC1sb2FkaW5nLWJveCBkaXYgeyBib3gtc2l6aW5nOiBjb250ZW50LWJveDsgfQogICAgICAgICAgICAuc3dhbDItY29udGFpbmVyIHsgei1pbmRleDoxMDAwMDAhaW1wb3J0YW50OyB9CiAgICAgICAgICAgIGJvZHkuc3dhbDItaGVpZ2h0LWF1dG8geyBoZWlnaHQ6IGluaGVyaXQhaW1wb3J0YW50OyB9CiAgICAgICAgICAgIC5idG4tb3BlcmF0ZSAuYnRuLW1haW4geyBkaXNwbGF5OmZsZXg7IGFsaWduLWl0ZW1zOmNlbnRlcjsgfQogICAgICAgICAgICBgOwogICAgICAgICAgICB0aGlzLmFkZFN0eWxlKCdwYW5saW5rZXItc3R5bGUnLCAnc3R5bGUnLCBjc3MpOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGluaXREaWFsb2coKSB7CiAgICAgICAgICAgIC8v5L+u5pS55byA5aeLIFNhbXVlbAogICAgICAgICAgICBiYXNlLnNldFZhbHVlKCdzZXR0aW5nX2luaXRfY29kZScsIHBhbi5udW0pOwogICAgICAgICAgICBiYXNlLnNldFZhbHVlKCdsaWNlbnNlJywgcGFuLmxpY2Vuc2UpOwogICAgICAgICAgICBtZXNzYWdlLnN1Y2Nlc3MocGFuLmluaXRbMl0pOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGhpc3RvcnkuZ28oMCk7CiAgICAgICAgICAgIH0sIDE1MDApOwogICAgICAgICAgICAvL+S/ruaUuee7k+adnyBTYW11ZWwKICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICB0aXRsZTogcGFuLmluaXRbMF0sCiAgICAgICAgICAgICAgICBodG1sOiBgPGRpdj48aW1nIHN0eWxlPSJ3aWR0aDogMjUwcHg7bWFyZ2luLWJvdHRvbTogMTBweDsiIHNyYz0iJHtwYW4uaW1nfSIgYWx0PSIke3Bhbi5pbWd9Ij48aW5wdXQgY2xhc3M9InN3YWwyLWlucHV0IiBpZD0iaW5pdCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IiR7cGFuLmluaXRbMV19Ij48L2Rpdj5gLAogICAgICAgICAgICAgICAgYWxsb3dPdXRzaWRlQ2xpY2s6IGZhbHNlLAogICAgICAgICAgICAgICAgc2hvd0Nsb3NlQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAocmVzdWx0LmlzRGlzbWlzc2VkICYmIHJlc3VsdC5kaXNtaXNzID09PSAnY2xvc2UnKSByZXR1cm47CiAgICAgICAgICAgIGlmIChwYW4ubnVtID09PSAkKCcjaW5pdCcpLnZhbCgpIHx8IHBhbi5saWNlbnNlID09PSAkKCcjaW5pdCcpLnZhbCgpKSB7CiAgICAgICAgICAgICAgICBiYXNlLnNldFZhbHVlKCdzZXR0aW5nX2luaXRfY29kZScsIHBhbi5udW0pOwogICAgICAgICAgICAgICAgYmFzZS5zZXRWYWx1ZSgnbGljZW5zZScsIHBhbi5saWNlbnNlKTsKICAgICAgICAgICAgICAgIG1lc3NhZ2Uuc3VjY2VzcyhwYW4uaW5pdFsyXSk7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBoaXN0b3J5LmdvKDApOwogICAgICAgICAgICAgICAgfSwgMTUwMCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhd2FpdCBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgICAgIHRpdGxlOiBwYW4uaW5pdFszXSwKICAgICAgICAgICAgICAgICAgICB0ZXh0OiBwYW4uaW5pdFs0XSwKICAgICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+mHjeaWsOi+k+WFpScsCiAgICAgICAgICAgICAgICAgICAgaW1hZ2VVcmw6IHBhbi5pbWcsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuaW5pdERpYWxvZygpOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgIH07CgogICAgbGV0IGJhaWR1ID0gewoKICAgICAgICBfZ2V0RXh0cmEoKSB7CiAgICAgICAgICAgIGxldCBzZUtleSA9IGRlY29kZVVSSUNvbXBvbmVudChiYXNlLmdldENvb2tpZSgnQkRDTE5EJykpOwogICAgICAgICAgICByZXR1cm4gJ3snICsgJyJzZWtleSI6IicgKyBzZUtleSArICciJyArICJ9IjsKICAgICAgICB9LAoKICAgICAgICBfZ2V0U3VybCgpIHsKICAgICAgICAgICAgbGV0IHJlZyA9IC8oPzw9c1wvfHN1cmw9KShbYS16QS1aMC05Xy1dKykvZzsKICAgICAgICAgICAgaWYgKHJlZy50ZXN0KGxvY2F0aW9uLmhyZWYpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbG9jYXRpb24uaHJlZi5tYXRjaChyZWcpWzBdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9LAoKICAgICAgICBfZ2V0RmlkTGlzdCgpIHsKICAgICAgICAgICAgbGV0IGZpZGxpc3QgPSBbXTsKICAgICAgICAgICAgc2VsZWN0TGlzdC5mb3JFYWNoKHYgPT4gewogICAgICAgICAgICAgICAgaWYgKCt2LmlzZGlyID09PSAxKSByZXR1cm47CiAgICAgICAgICAgICAgICBmaWRsaXN0LnB1c2godi5mc19pZCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICByZXR1cm4gJ1snICsgZmlkbGlzdCArICddJzsKICAgICAgICB9LAoKICAgICAgICBfcmVzZXREYXRhKCkgewogICAgICAgICAgICBwcm9ncmVzcyA9IHt9OwogICAgICAgICAgICAkLmVhY2gocmVxdWVzdCwgKGtleSkgPT4gewogICAgICAgICAgICAgICAgKHJlcXVlc3Rba2V5XSkuYWJvcnQoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICQuZWFjaChpbnMsIChrZXkpID0+IHsKICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW5zW2tleV0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWRtID0ge307CiAgICAgICAgICAgIGlucyA9IHt9OwogICAgICAgICAgICByZXF1ZXN0ID0ge307CiAgICAgICAgfSwKCiAgICAgICAgc2V0QkRVU1MoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBHTV9jb29raWUgJiYgR01fY29va2llKCdsaXN0Jywge25hbWU6ICdCRFVTUyd9LCAoY29va2llcywgZXJyb3IpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoIWVycm9yKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBCRFVTUyA9IGNvb2tpZXM/LlswXT8udmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChCRFVTUykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmFzZS5zZXRTdG9yYWdlKCJiYWlkdXl1blBsdWdpbl9CRFVTUyIsIHtCRFVTU30pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGdldEJEVVNTKCkgewogICAgICAgICAgICBsZXQgYmFpZHV5dW5QbHVnaW5fQkRVU1MgPSBiYXNlLmdldFN0b3JhZ2UoJ2JhaWR1eXVuUGx1Z2luX0JEVVNTJykgPyBiYXNlLmdldFN0b3JhZ2UoJ2JhaWR1eXVuUGx1Z2luX0JEVVNTJykgOiAneyJiYWlkdXl1blBsdWdpbl9CRFVTUyI6IiJ9JzsKICAgICAgICAgICAgcmV0dXJuIGJhaWR1eXVuUGx1Z2luX0JEVVNTLkJEVVNTIHx8ICcnOwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9BcmlhKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBsZXQgQkRVU1MgPSB0aGlzLmdldEJEVVNTKCk7CiAgICAgICAgICAgIGlmICghIUJEVVNTKSB7CiAgICAgICAgICAgICAgICBmaWxlbmFtZSA9IGJhc2UuZml4RmlsZW5hbWUoZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgYXJpYTJjICIke2xpbmt9IiAtLW91dCAiJHtmaWxlbmFtZX0iIC0taGVhZGVyICJVc2VyLUFnZW50OiAke3VhfSIgLS1oZWFkZXIgIkNvb2tpZTogQkRVU1M9JHtCRFVTU30iYCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGxpbms6IHBhbi5hc3Npc3RhbnQsCiAgICAgICAgICAgICAgICB0ZXh0OiBwYW4uaW5pdFs1XQogICAgICAgICAgICB9OwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9CQyhsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgbGV0IEJEVVNTID0gdGhpcy5nZXRCRFVTUygpOwogICAgICAgICAgICBpZiAoISFCRFVTUykgewogICAgICAgICAgICAgICAgbGV0IGNvb2tpZSA9IGBCRFVTUz0ke0JEVVNTfWA7CiAgICAgICAgICAgICAgICBsZXQgYmMgPSBgQUEvJHtlbmNvZGVVUklDb21wb25lbnQoZmlsZW5hbWUpfS8/dXJsPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGxpbmspfSZjb29raWU9JHtlbmNvZGVVUklDb21wb25lbnQoY29va2llKX0mdXNlcl9hZ2VudD0ke2VuY29kZVVSSUNvbXBvbmVudCh1YSl9WlpgOwogICAgICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgYmM6Ly9odHRwLyR7YmFzZS5lKGJjKX1gKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgbGluazogcGFuLmFzc2lzdGFudCwKICAgICAgICAgICAgICAgIHRleHQ6IHBhbi5pbml0WzVdCiAgICAgICAgICAgIH07CiAgICAgICAgfSwKCiAgICAgICAgY29udmVydExpbmtUb0N1cmwobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGxldCBCRFVTUyA9IHRoaXMuZ2V0QkRVU1MoKTsKICAgICAgICAgICAgaWYgKCEhQkRVU1MpIHsKICAgICAgICAgICAgICAgIGxldCB0ZXJtaW5hbCA9IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGVybWluYWxfdHlwZScpOwogICAgICAgICAgICAgICAgZmlsZW5hbWUgPSBiYXNlLmZpeEZpbGVuYW1lKGZpbGVuYW1lKTsKICAgICAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYCR7dGVybWluYWwgIT09ICd3cCcgPyAnY3VybCcgOiAnY3VybC5leGUnfSAtTCAtQyAtICIke2xpbmt9IiAtbyAiJHtmaWxlbmFtZX0iIC1BICIke3VhfSIgLWIgIkJEVVNTPSR7QkRVU1N9ImApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICBsaW5rOiBwYW4uYXNzaXN0YW50LAogICAgICAgICAgICAgICAgdGV4dDogcGFuLmluaXRbNV0KICAgICAgICAgICAgfTsKICAgICAgICB9LAoKICAgICAgICBhZGRQYWdlTGlzdGVuZXIoKSB7CiAgICAgICAgICAgIGZ1bmN0aW9uIF9mYWN0b3J5KGUpIHsKICAgICAgICAgICAgICAgIGxldCB0YXJnZXQgPSAkKGUudGFyZ2V0KTsKICAgICAgICAgICAgICAgIGxldCBpdGVtID0gdGFyZ2V0LnBhcmVudHMoJy5wbC1pdGVtJyk7CiAgICAgICAgICAgICAgICBsZXQgbGluayA9IGl0ZW0uZmluZCgnLnBsLWl0ZW0tbGluaycpOwogICAgICAgICAgICAgICAgbGV0IHByb2dyZXNzID0gaXRlbS5maW5kKCcucGwtaXRlbS1wcm9ncmVzcycpOwogICAgICAgICAgICAgICAgbGV0IHRpcCA9IGl0ZW0uZmluZCgnLnBsLWl0ZW0tdGlwJyk7CiAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgIGl0ZW0sIGxpbmssIHByb2dyZXNzLCB0aXAsIHRhcmdldCwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZ1bmN0aW9uIF9yZXNldChpKSB7CiAgICAgICAgICAgICAgICBpbnNbaV0gJiYgY2xlYXJJbnRlcnZhbChpbnNbaV0pOwogICAgICAgICAgICAgICAgcmVxdWVzdFtpXSAmJiByZXF1ZXN0W2ldLmFib3J0KCk7CiAgICAgICAgICAgICAgICBwcm9ncmVzc1tpXSA9IDA7CiAgICAgICAgICAgICAgICBpZG1baV0gPSBmYWxzZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZG9jLm9uKCdtb3VzZWVudGVyIG1vdXNlbGVhdmUgY2xpY2snLCAnLnBsLWJ1dHRvbi5nLWRyb3Bkb3duLWJ1dHRvbicsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoZS50eXBlID09PSAnbW91c2VsZWF2ZScpIHsKICAgICAgICAgICAgICAgICAgICAkKGUuY3VycmVudFRhcmdldCkucmVtb3ZlQ2xhc3MoJ2J1dHRvbi1vcGVuJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS5hZGRDbGFzcygnYnV0dG9uLW9wZW4nKTsKICAgICAgICAgICAgICAgICAgICAkKGUuY3VycmVudFRhcmdldCkuZmluZCgnLnBsLWRyb3Bkb3duLW1lbnUnKS5zaG93KCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ21vdXNlbGVhdmUnLCAnLnBsLWJ1dHRvbi5nLWRyb3Bkb3duLWJ1dHRvbiAucGwtZHJvcGRvd24tbWVudScsIChlKSA9PiB7CiAgICAgICAgICAgICAgICAkKGUuY3VycmVudFRhcmdldCkuaGlkZSgpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLnBsLWJ1dHRvbi1tb2RlJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIG1vZGUgPSBlLnRhcmdldC5kYXRhc2V0Lm1vZGU7CiAgICAgICAgICAgICAgICBTd2FsLnNob3dMb2FkaW5nKCk7CiAgICAgICAgICAgICAgICB0aGlzLmdldFBDU0xpbmsoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYXBpJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIGxldCBvID0gX2ZhY3RvcnkoZSk7CiAgICAgICAgICAgICAgICBsZXQgJHdpZHRoID0gby5pdGVtLmZpbmQoJy5wbC1wcm9ncmVzcy1pbm5lcicpOwogICAgICAgICAgICAgICAgbGV0ICR0ZXh0ID0gby5pdGVtLmZpbmQoJy5wbC1wcm9ncmVzcy1pbm5lci10ZXh0Jyk7CiAgICAgICAgICAgICAgICBsZXQgZmlsZW5hbWUgPSBvLmxpbmtbMF0uZGF0YXNldC5maWxlbmFtZTsKICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IG8ubGlua1swXS5kYXRhc2V0LmluZGV4OwogICAgICAgICAgICAgICAgX3Jlc2V0KGluZGV4KTsKICAgICAgICAgICAgICAgIGJhc2UuZ2V0KG8ubGlua1swXS5kYXRhc2V0LmxpbmssIHsiVXNlci1BZ2VudCI6IHBhbi51YX0sICdibG9iJywge2ZpbGVuYW1lLCBpbmRleH0pOwogICAgICAgICAgICAgICAgaW5zW2luZGV4XSA9IHNldEludGVydmFsKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBsZXQgcHJvZyA9ICtwcm9ncmVzc1tpbmRleF0gfHwgMDsKICAgICAgICAgICAgICAgICAgICBsZXQgaXNJRE0gPSBpZG1baW5kZXhdIHx8IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmIChpc0lETSkgewogICAgICAgICAgICAgICAgICAgICAgICBvLnRpcC5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG8ucHJvZ3Jlc3MuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICBvLmxpbmsudGV4dCgn5bey5oiQ5Yqf5ZSk6LW3SURN77yM6K+35p+l55yLSURN5LiL6L295qGG77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpLnNob3coKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChpbnNbaW5kZXhdKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWRtW2luZGV4XSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIG8ubGluay5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIG8udGlwLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICAgICAgby5wcm9ncmVzcy5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICR3aWR0aC5jc3MoJ3dpZHRoJywgcHJvZyArICclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgICR0ZXh0LnRleHQocHJvZyArICclJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9nID09PSAxMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW5zW2luZGV4XSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9ncmVzc1tpbmRleF0gPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgby5pdGVtLmZpbmQoJy5wbC1wcm9ncmVzcy1zdG9wJykuaGlkZSgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgby5pdGVtLmZpbmQoJy5wbC1wcm9ncmVzcy10aXAnKS5odG1sKCfkuIvovb3lrozmiJDvvIzmraPlnKjlvLnlh7rmtY/op4jlmajkuIvovb3moYbvvIEnKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0sIDUwMCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1yZXRyeScsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgbyA9IF9mYWN0b3J5KGUpOwogICAgICAgICAgICAgICAgby50aXAuaGlkZSgpOwogICAgICAgICAgICAgICAgby5saW5rLnNob3coKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWhvdycsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgbyA9IF9mYWN0b3J5KGUpOwogICAgICAgICAgICAgICAgbGV0IGluZGV4ID0gby5saW5rWzBdLmRhdGFzZXQuaW5kZXg7CiAgICAgICAgICAgICAgICBpZiAocmVxdWVzdFtpbmRleF0pIHsKICAgICAgICAgICAgICAgICAgICByZXF1ZXN0W2luZGV4XS5hYm9ydCgpOwogICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW5zW2luZGV4XSk7CiAgICAgICAgICAgICAgICAgICAgby5wcm9ncmVzcy5oaWRlKCk7CiAgICAgICAgICAgICAgICAgICAgby50aXAuc2hvdygpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXN0b3AnLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgbGV0IG8gPSBfZmFjdG9yeShlKTsKICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IG8ubGlua1swXS5kYXRhc2V0LmluZGV4OwogICAgICAgICAgICAgICAgaWYgKHJlcXVlc3RbaW5kZXhdKSB7CiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdFtpbmRleF0uYWJvcnQoKTsKICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGluc1tpbmRleF0pOwogICAgICAgICAgICAgICAgICAgIG8udGlwLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICBvLnByb2dyZXNzLmhpZGUoKTsKICAgICAgICAgICAgICAgICAgICBvLmxpbmsuc2hvdygwKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWJhY2snLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgbGV0IG8gPSBfZmFjdG9yeShlKTsKICAgICAgICAgICAgICAgIG8udGlwLmhpZGUoKTsKICAgICAgICAgICAgICAgIG8ubGluay5zaG93KCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWFyaWEsIC5saXN0ZW5lci1jb3B5LWFsbCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBpZiAoIWUudGFyZ2V0LmRhdGFzZXQubGluaykgewogICAgICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnJlbW92ZUNsYXNzKCdsaXN0ZW5lci1jb3B5LWFsbCcpLmFkZENsYXNzKCdwbC1idG4tZGFuZ2VyJykuaHRtbChgJHtwYW4uaW5pdFs1XX3wn5GJPGEgaHJlZj0iJHtwYW4uYXNzaXN0YW50fSIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJwbC1hIj7ngrnlh7vmraTlpITlronoo4U8L2E+8J+RiGApOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBiYXNlLnNldENsaXBib2FyZChkZWNvZGVVUklDb21wb25lbnQoZS50YXJnZXQuZGF0YXNldC5saW5rKSk7CiAgICAgICAgICAgICAgICAgICAgJChlLnRhcmdldCkudGV4dCgn5aSN5Yi25oiQ5Yqf77yM5b+r5Y6757KY6LS05ZCn77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1ycGMnLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgbGV0IHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTsKICAgICAgICAgICAgICAgIHRhcmdldC5maW5kKCcuaWNvbicpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5wbC1sb2FkaW5nJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQucHJlcGVuZChiYXNlLmNyZWF0ZUxvYWRpbmcoKSk7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy5zZW5kTGlua1RvUlBDKGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmZpbGVuYW1lLCBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5saW5rKTsKICAgICAgICAgICAgICAgIGlmIChyZXMgPT09ICdzdWNjZXNzJykgewogICAgICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1ycGMtdGFzaycpLnNob3coKTsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQucmVtb3ZlQ2xhc3MoJ3BsLWJ0bi1kYW5nZXInKS5odG1sKCflj5HpgIHmiJDlip/vvIzlv6vljrvnnIvnnIvlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcyA9PT0gJ2Fzc2lzdGFudCcpIHsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuYWRkQ2xhc3MoJ3BsLWJ0bi1kYW5nZXInKS5odG1sKGAke3Bhbi5pbml0WzVdffCfkYk8YSBocmVmPSIke3Bhbi5hc3Npc3RhbnR9IiB0YXJnZXQ9Il9ibGFuayIgY2xhc3M9InBsLWEiPueCueWHu+atpOWkhOWuieijhTwvYT7wn5GIYCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRhcmdldC5hZGRDbGFzcygncGwtYnRuLWRhbmdlcicpLnRleHQoJ+WPkemAgeWksei0pe+8jOivt+ajgOafpeaCqOeahFJQQ+mFjee9ruS/oeaBr++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXNlbmQtcnBjJywgKGUpID0+IHsKICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1saW5rLXJwYycpLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflj5HpgIHlrozmiJDvvIzlj5HpgIHnu5Pmnpzop4HkuIrmlrnmjInpkq7vvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1vcGVuLXNldHRpbmcnLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNob3dTZXR0aW5nKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1ycGMtdGFzaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGxldCBycGMgPSBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgICAgICBwb3J0OiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JyksCiAgICAgICAgICAgICAgICB9KSwgdXJsID0gYCR7cGFuLmR9Lz9ycGM9JHtiYXNlLmUocnBjKX0jJHtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpfWA7CiAgICAgICAgICAgICAgICBHTV9vcGVuSW5UYWIodXJsLCB7YWN0aXZlOiB0cnVlfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQubm9kZU5hbWUgPT09ICdBJyAmJiB+ZS50YXJnZXQuY2xhc3NOYW1lLmluZGV4T2YoJ3BsLWEnKSkgewogICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHRydWUpOwogICAgICAgIH0sCgogICAgICAgIGFkZEJ1dHRvbigpIHsKICAgICAgICAgICAgaWYgKCFwdCkgcmV0dXJuOwogICAgICAgICAgICBsZXQgJHRvb2xXcmFwOwogICAgICAgICAgICBsZXQgJGJ1dHRvbiA9ICQoYDxkaXYgY2xhc3M9ImctZHJvcGRvd24tYnV0dG9uIHBvaW50ZXIgcGwtYnV0dG9uIj48ZGl2IHN0eWxlPSJjb2xvcjojZmZmO2JhY2tncm91bmQ6ICR7Y29sb3J9O2JvcmRlci1jb2xvcjoke2NvbG9yfSIgY2xhc3M9ImctYnV0dG9uIGctYnV0dG9uLWJsdWUiPjxzcGFuIGNsYXNzPSJnLWJ1dHRvbi1yaWdodCI+PGVtIGNsYXNzPSJpY29uIGljb24tZG93bmxvYWQiPjwvZW0+PHNwYW4gY2xhc3M9InRleHQiIHN0eWxlPSJ3aWR0aDogNjBweDsiPuS4i+i9veWKqeaJizwvc3Bhbj48L3NwYW4+PC9kaXY+PGRpdiBjbGFzcz0ibWVudSIgc3R5bGU9IndpZHRoOmF1dG87ei1pbmRleDo0MTtib3JkZXItY29sb3I6JHtjb2xvcn0iPjxkaXYgc3R5bGU9ImNvbG9yOiR7Y29sb3J9IiBjbGFzcz0iZy1idXR0b24tbWVudSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcGkiPkFQSeS4i+i9vTwvZGl2PjxkaXYgc3R5bGU9ImNvbG9yOiR7Y29sb3J9IiBjbGFzcz0iZy1idXR0b24tbWVudSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcmlhIj5Bcmlh5LiL6L29PC9kaXY+PGRpdiBzdHlsZT0iY29sb3I6JHtjb2xvcn0iIGNsYXNzPSJnLWJ1dHRvbi1tZW51IHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9InJwYyI+UlBD5LiL6L29PC9kaXY+PGRpdiBzdHlsZT0iY29sb3I6JHtjb2xvcn0iIGNsYXNzPSJnLWJ1dHRvbi1tZW51IHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImN1cmwiPmNVUkzkuIvovb08L2Rpdj48ZGl2IHN0eWxlPSJjb2xvcjoke2NvbG9yfSIgY2xhc3M9ImctYnV0dG9uLW1lbnUgcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYmMiPkJD5LiL6L29PC9kaXY+PGxpIGNsYXNzPSJnLWJ1dHRvbi1tZW51IHBsLWJ1dHRvbi1tb2RlIGxpc3RlbmVyLW9wZW4tc2V0dGluZyI+5Yqp5omL6K6+572uPC9saT4ke3Bhbi5jb2RlID09IDIwMCAmJiB2ZXJzaW9uIDwgcGFuLnZlcnNpb24gPyBwYW4ubmV3IDogJyd9PC9kaXY+PC9kaXY+YCk7CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ2hvbWUnKSAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ21haW4nKSB7CiAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4ubWFpbik7CiAgICAgICAgICAgICAgICAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0icGwtYnV0dG9uIiBzdHlsZT0icG9zaXRpb246IHJlbGF0aXZlOyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IG1hcmdpbi1yaWdodDogOHB4OyI+PGJ1dHRvbiBjbGFzcz0idS1idXR0b24gdS1idXR0b24tLXByaW1hcnkgdS1idXR0b24tLXNtYWxsIGlzLXJvdW5kIGlzLWhhcy1pY29uIiBzdHlsZT0iYmFja2dyb3VuZDogJHtjb2xvcn07Ym9yZGVyLWNvbG9yOiAke2NvbG9yfTtmb250LXNpemU6IDE0cHg7IHBhZGRpbmc6IDhweCAxNnB4OyBib3JkZXI6IG5vbmU7Ij48aSBjbGFzcz0idS1pY29uIHUtaWNvbi1kb3dubG9hZCI+PC9pPjxzcGFuPuS4i+i9veWKqeaJizwvc3Bhbj48L2J1dHRvbj48dWwgY2xhc3M9ImRyb3Bkb3duLWxpc3QgbmQtY29tbW9uLWZsb2F0LW1lbnUgcGwtZHJvcGRvd24tbWVudSI+PGxpIGNsYXNzPSJzdWIgY3Vyc29yLXAgcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYXBpIj5BUEnkuIvovb08L2xpPjxsaSBjbGFzcz0ic3ViIGN1cnNvci1wIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFyaWEiPkFyaWHkuIvovb08L2xpPjxsaSBjbGFzcz0ic3ViIGN1cnNvci1wIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9InJwYyI+UlBD5LiL6L29PC9saT48bGkgY2xhc3M9InN1YiBjdXJzb3ItcCBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJjdXJsIj5jVVJM5LiL6L29PC9saT48bGkgY2xhc3M9InN1YiBjdXJzb3ItcCBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJiYyIgPkJD5LiL6L29PC9saT48bGkgY2xhc3M9InN1YiBjdXJzb3ItcCBwbC1idXR0b24tbW9kZSBsaXN0ZW5lci1vcGVuLXNldHRpbmciPuWKqeaJi+iuvue9rjwvbGk+JHtwYW4uY29kZSA9PSAyMDAgJiYgdmVyc2lvbiA8IHBhbi52ZXJzaW9uID8gcGFuLm5ld1ggOiAnJ308L3VsPjwvZGl2PmApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgJHRvb2xXcmFwID0gJChwYW4uYnRuLnNoYXJlKTsKICAgICAgICAgICAgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgIHRoaXMuc2V0QkRVU1MoKTsKICAgICAgICAgICAgdGhpcy5hZGRQYWdlTGlzdGVuZXIoKTsKICAgICAgICB9LAoKICAgICAgICBhZGRJbml0QnV0dG9uKCkgewogICAgICAgICAgICBpZiAoIXB0KSByZXR1cm47CiAgICAgICAgICAgIGxldCAkdG9vbFdyYXA7CiAgICAgICAgICAgIGxldCAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0iZy1kcm9wZG93bi1idXR0b24gcG9pbnRlciBwbC1idXR0b24taW5pdCIgc3R5bGU9Im9wYWNpdHk6LjUiPjxkaXYgc3R5bGU9ImNvbG9yOiNmZmY7YmFja2dyb3VuZDogJHtjb2xvcn07Ym9yZGVyLWNvbG9yOiR7Y29sb3J9IiBjbGFzcz0iZy1idXR0b24gZy1idXR0b24tYmx1ZSI+PHNwYW4gY2xhc3M9ImctYnV0dG9uLXJpZ2h0Ij48ZW0gY2xhc3M9Imljb24gaWNvbi1kb3dubG9hZCI+PC9lbT48c3BhbiBjbGFzcz0idGV4dCIgc3R5bGU9IndpZHRoOiA2MHB4OyI+5LiL6L295Yqp5omLPC9zcGFuPjwvc3Bhbj48L2Rpdj48L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpICR0b29sV3JhcCA9ICQocGFuLmJ0bi5ob21lKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnbWFpbicpIHsKICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5tYWluKTsKICAgICAgICAgICAgICAgICRidXR0b24gPSAkKGA8ZGl2IGNsYXNzPSJwbC1idXR0b24taW5pdCIgc3R5bGU9Im9wYWNpdHk6LjU7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgbWFyZ2luLXJpZ2h0OiA4cHg7Ij48YnV0dG9uIGNsYXNzPSJ1LWJ1dHRvbiB1LWJ1dHRvbi0tcHJpbWFyeSB1LWJ1dHRvbi0tc21hbGwgaXMtcm91bmQgaXMtaGFzLWljb24iIHN0eWxlPSJiYWNrZ3JvdW5kOiAke2NvbG9yfTtib3JkZXItY29sb3I6ICR7Y29sb3J9O2ZvbnQtc2l6ZTogMTRweDsgcGFkZGluZzogOHB4IDE2cHg7IGJvcmRlcjogbm9uZTsiPjxpIGNsYXNzPSJ1LWljb24gdS1pY29uLWRvd25sb2FkIj48L2k+PHNwYW4+5LiL6L295Yqp5omLPC9zcGFuPjwvYnV0dG9uPjwvZGl2PmApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgJHRvb2xXcmFwID0gJChwYW4uYnRuLnNoYXJlKTsKICAgICAgICAgICAgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICRidXR0b24uY2xpY2soKCkgPT4gYmFzZS5pbml0RGlhbG9nKCkpOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGdldFRva2VuKCkgewogICAgICAgICAgICBjb25zdCBvcGVuVGFiID0gKCkgPT4gewogICAgICAgICAgICAgICAgR01fb3BlbkluVGFiKHBhbi5wY3NbM10sIHthY3RpdmU6IGZhbHNlLCBpbnNlcnQ6IHRydWUsIHNldFBhcmVudDogdHJ1ZX0pOwogICAgICAgICAgICAgICAgYmFzZS5kZWxldGVWYWx1ZSgnYmFpZHVfYWNjZXNzX3Rva2VuJyk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICBjb25zdCB3YWl0Rm9yVG9rZW4gPSAoKSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gewogICAgICAgICAgICAgICAgbGV0IGF0dGVtcHRzID0gMDsKICAgICAgICAgICAgICAgIGNvbnN0IGludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRva2VuID0gYmFzZS5nZXRWYWx1ZSgnYmFpZHVfYWNjZXNzX3Rva2VuJyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRva2VuKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYXR0ZW1wdHMrKzsKICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ZW1wdHMgPiA2MCkgewogICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgnJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgaWYgKG1hbmFnZUhhbmRsZXIgPT09ICdUYW1wZXJtb25rZXknICYmIGJhc2UuZ2V0TWFqb3JWZXJzaW9uKG1hbmFnZVZlcnNpb24pID49IDUpIHsKICAgICAgICAgICAgICAgIG9wZW5UYWIoKTsKICAgICAgICAgICAgICAgIHJldHVybiB3YWl0Rm9yVG9rZW4oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5nZXRGaW5hbFVybChwYW4ucGNzWzNdKTsKCiAgICAgICAgICAgIGlmICghcmVzLmluY2x1ZGVzKCdhdXRob3JpemUnKSAmJiAhcmVzLmluY2x1ZGVzKCdhY2Nlc3NfdG9rZW49JykpIHsKICAgICAgICAgICAgICAgIG9wZW5UYWIoKTsKICAgICAgICAgICAgICAgIHJldHVybiB3YWl0Rm9yVG9rZW4oKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocmVzLmluY2x1ZGVzKCdhdXRob3JpemUnKSkgewogICAgICAgICAgICAgICAgbGV0IGh0bWwgPSBhd2FpdCBiYXNlLmdldChwYW4ucGNzWzNdLCB7fSwgJ3RleHQnKTsKICAgICAgICAgICAgICAgIGxldCBiZHN0b2tlbiA9IGh0bWwubWF0Y2goL25hbWU9ImJkc3Rva2VuIlxzK3ZhbHVlPSIoW14iXSspIi8pPy5bMV07CiAgICAgICAgICAgICAgICBsZXQgY2xpZW50X2lkID0gaHRtbC5tYXRjaCgvbmFtZT0iY2xpZW50X2lkIlxzK3ZhbHVlPSIoW14iXSspIi8pPy5bMV07CiAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgICBncmFudF9wZXJtaXNzaW9uc19hcnI6ICduZXRkaXNrJywKICAgICAgICAgICAgICAgICAgICBiZHN0b2tlbjogYmRzdG9rZW4sCiAgICAgICAgICAgICAgICAgICAgY2xpZW50X2lkOiBjbGllbnRfaWQsCiAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2VfdHlwZTogInRva2VuIiwKICAgICAgICAgICAgICAgICAgICBkaXNwbGF5OiAicGFnZSIsCiAgICAgICAgICAgICAgICAgICAgZ3JhbnRfcGVybWlzc2lvbnM6ICJiYXNpYyxuZXRkaXNrIgogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIGF3YWl0IGJhc2UucG9zdChwYW4ucGNzWzNdLCBiYXNlLnN0cmluZ2lmeShkYXRhKSwgewogICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJywKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbGV0IHJlczIgPSBhd2FpdCBiYXNlLmdldEZpbmFsVXJsKHBhbi5wY3NbM10pOwogICAgICAgICAgICAgICAgbGV0IGFjY2Vzc1Rva2VuID0gcmVzMi5tYXRjaCgvYWNjZXNzX3Rva2VuPShbXiZdKykvKT8uWzFdOwogICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4gJiYgYmFzZS5zZXRWYWx1ZSgnYmFpZHVfYWNjZXNzX3Rva2VuJywgYWNjZXNzVG9rZW4pOwogICAgICAgICAgICAgICAgcmV0dXJuIGFjY2Vzc1Rva2VuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBhY2Nlc3NUb2tlbiA9IHJlcy5tYXRjaCgvYWNjZXNzX3Rva2VuPShbXiZdKykvKT8uWzFdOwogICAgICAgICAgICBhY2Nlc3NUb2tlbiAmJiBiYXNlLnNldFZhbHVlKCdiYWlkdV9hY2Nlc3NfdG9rZW4nLCBhY2Nlc3NUb2tlbik7CiAgICAgICAgICAgIHJldHVybiBhY2Nlc3NUb2tlbjsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRQQ1NMaW5rKG1heFJlcXVlc3RUaW1lID0gMSkgewogICAgICAgICAgICBzZWxlY3RMaXN0ID0gdGhpcy5nZXRTZWxlY3RlZExpc3QoKTsKICAgICAgICAgICAgbGV0IGZpZExpc3QgPSB0aGlzLl9nZXRGaWRMaXN0KCksIHVybCwgcmVzOwoKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScgfHwgcHQgPT09ICdtYWluJykgewogICAgICAgICAgICAgICAgaWYgKHNlbGVjdExpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+WFiOWLvumAieimgeS4i+i9veeahOaWh+S7tu+8gScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGZpZExpc3QubGVuZ3RoID09PSAyKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+aJk+W8gOaWh+S7tuWkueWQjuWLvumAieaWh+S7tu+8gScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZmlkTGlzdCA9IGVuY29kZVVSSUNvbXBvbmVudChmaWRMaXN0KTsKICAgICAgICAgICAgICAgIGxldCBhY2Nlc3NUb2tlbiA9IGJhc2UuZ2V0VmFsdWUoJ2JhaWR1X2FjY2Vzc190b2tlbicpIHx8IGF3YWl0IHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgICAgIHVybCA9IGAke3Bhbi5wY3NbMF19JmZzaWRzPSR7ZmlkTGlzdH0mYWNjZXNzX3Rva2VuPSR7YWNjZXNzVG9rZW59YDsKICAgICAgICAgICAgICAgIHJlcyA9IGF3YWl0IGJhc2UuZ2V0KHVybCwgeyJVc2VyLUFnZW50IjogcGFuLnVhfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICB0aGlzLmdldFNoYXJlRGF0YSgpOwogICAgICAgICAgICAgICAgaWYgKCFwYXJhbXMuYmRzdG9rZW4pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI55m75b2V572R55uY77yBJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0TGlzdC5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI5Yu+6YCJ6KaB5LiL6L2955qE5paH5Lu277yBJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoZmlkTGlzdC5sZW5ndGggPT09IDIpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35omT5byA5paH5Lu25aS55ZCO5Yu+6YCJ5paH5Lu277yBJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBsZXQgZGlhbG9nID0gYXdhaXQgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mbycsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGDmj5DnpLrvvJror7flsIbmlofku7Y8c3BhbiBjbGFzcz0idGFnLWRhbmdlciI+W+S/neWtmOWIsOe9keebmF08L3NwYW4+8J+RieWJjeW+gDxzcGFuIGNsYXNzPSJ0YWctZGFuZ2VyIj5b5oiR55qE572R55uYXTwvc3Bhbj7kuK3kuIvovb3vvIFgLAogICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn54K55Ye75L+d5a2YJywKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcCcsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmIChkaWFsb2cuaXNDb25maXJtZWQpIHsKICAgICAgICAgICAgICAgICAgICAkKCcudG9vbHMtc2hhcmUtc2F2ZS1oYicpWzBdLmNsaWNrKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHJlcy5lcnJubyA9PT0gMCkgewogICAgICAgICAgICAgICAgbGV0IGh0bWwgPSB0aGlzLmdlbmVyYXRlRG9tKHJlcy5saXN0KTsKICAgICAgICAgICAgICAgIHRoaXMuc2hvd01haW5EaWFsb2cocGFuW21vZGVdWzBdLCBodG1sLCBwYW5bbW9kZV1bMV0pOwogICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5lcnJubyA9PT0gMTEyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6aG16Z2i6L+H5pyf77yM6K+35Yi35paw6YeN6K+V77yBJyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLmVycm5vID09PSA5MDE5KSB7CiAgICAgICAgICAgICAgICBtYXhSZXF1ZXN0VGltZS0tOwogICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5nZXRUb2tlbigpOwogICAgICAgICAgICAgICAgaWYgKG1heFJlcXVlc3RUaW1lID4gMCkgewogICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0UENTTGluayhtYXhSZXF1ZXN0VGltZSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muiOt+WPluS4i+i9vemTvuaOpeWksei0pe+8geivt+WIt+aWsOe9kemhteWQjumHjeivle+8gScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYmFzZS5kZWxldGVWYWx1ZSgnYmFpZHVfYWNjZXNzX3Rva2VuJyk7CiAgICAgICAgICAgICAgICBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJrojrflj5bkuIvovb3pk77mjqXlpLHotKXvvIHor7fliLfmlrDnvZHpobXlkI7ph43or5XvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGdlbmVyYXRlRG9tKGxpc3QpIHsKICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSAnPGRpdiBjbGFzcz0icGwtbWFpbiI+JzsKICAgICAgICAgICAgbGV0IGFsaW5rQWxsVGV4dCA9ICcnOwogICAgICAgICAgICBiYXNlLnNvcnRCeU5hbWUobGlzdCk7CiAgICAgICAgICAgIGxpc3QuZm9yRWFjaCgodiwgaSkgPT4gewogICAgICAgICAgICAgICAgaWYgKHYuaXNkaXIgPT09IDEpIHJldHVybjsKICAgICAgICAgICAgICAgIGxldCBmaWxlbmFtZSA9IHYuc2VydmVyX2ZpbGVuYW1lIHx8IHYuZmlsZW5hbWU7CiAgICAgICAgICAgICAgICBsZXQgZXh0ID0gYmFzZS5nZXRFeHRlbnNpb24oZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgbGV0IHNpemUgPSBiYXNlLnNpemVGb3JtYXQodi5zaXplKTsKICAgICAgICAgICAgICAgIGxldCBkbGluayA9IHYuZGxpbmsgKyAnJmFjY2Vzc190b2tlbj0nICsgYmFzZS5nZXRWYWx1ZSgnYmFpZHVfYWNjZXNzX3Rva2VuJyk7CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FwaScpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBwbC1hIGxpc3RlbmVyLWxpbmstYXBpIiBocmVmPSIke2RsaW5rfSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHtkbGlua30iIGRhdGEtaW5kZXg9IiR7aX0iPiR7ZGxpbmt9PC9hPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tdGlwIiBzdHlsZT0iZGlzcGxheTogbm9uZSI+PHNwYW4+6Iul5rKh5pyJ5by55Ye6SURN5LiL6L295qGG77yM5om+5YiwSURNIDxiPumAiemhuTwvYj4gLT4gPGI+5paH5Lu257G75Z6LPC9iPiAtPiA8Yj7nrKzkuIDkuKrmoYY8L2I+IOS4rea3u+WKoOWQjue8gCA8c3BhbiBjbGFzcz0icGwtZXh0Ij4ke2V4dH08L3NwYW4+77yMPGEgaHJlZj0iJHtwYW4uaWRtfSIgdGFyZ2V0PSJfYmxhbmsiIGNsYXNzPSJwbC1hIj7or6bop4HmraTlpIQ8L2E+PC9zcGFuPiA8c3BhbiBjbGFzcz0icGwtYmFjayBsaXN0ZW5lci1iYWNrIj7ov5Tlm548L3NwYW4+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1wcm9ncmVzcyIgc3R5bGU9ImRpc3BsYXk6IG5vbmUiPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1wcm9ncmVzcyI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1wcm9ncmVzcy1vdXRlciI+PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1wcm9ncmVzcy1pbm5lciIgc3R5bGU9IndpZHRoOjUlIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtcHJvZ3Jlc3MtaW5uZXItdGV4dCI+MCU8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPHNwYW4gY2xhc3M9InBsLXByb2dyZXNzLXN0b3AgbGlzdGVuZXItc3RvcCI+5Y+W5raI5LiL6L29PC9zcGFuPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0icGwtcHJvZ3Jlc3MtdGlwIj7mnKrlj5HnjrBJRE3vvIzkvb/nlKjoh6rluKbmtY/op4jlmajkuIvovb08L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJwbC1wcm9ncmVzcy1ob3cgbGlzdGVuZXItaG93Ij7lpoLkvZXllKTotbdJRE3vvJ88L3NwYW4+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+PC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYXJpYScpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9BcmlhKGRsaW5rLCBmaWxlbmFtZSwgcGFuLnVhKTsKICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChhbGluaykgPT09ICdvYmplY3QnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIHBsLWEiIHRhcmdldD0iX2JsYW5rIiBocmVmPSIke2FsaW5rLmxpbmt9IiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rLmxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluay50ZXh0KX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxpbmtBbGxUZXh0ICs9IGFsaW5rICsgJ1xyXG4nOwogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBwbC1hIGxpc3RlbmVyLWxpbmstYXJpYSIgaHJlZj0iJHthbGlua30iIHRpdGxlPSLngrnlh7vlpI3liLZhcmlhMmPpk77mjqUiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAncnBjJykgewogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YnV0dG9uIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1ycGMgcGwtYnRuLXByaW1hcnkgcGwtYnRuLWluZm8iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9Ij48ZW0gY2xhc3M9Imljb24gaWNvbi1kZXZpY2UiPjwvZW0+PHNwYW4gc3R5bGU9Im1hcmdpbi1sZWZ0OiA1cHg7Ij7mjqjpgIHliLAgUlBDIOS4i+i9veWZqDwvc3Bhbj48L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdjdXJsJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0N1cmwoZGxpbmssIGZpbGVuYW1lLCBwYW4udWEpOwogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKGFsaW5rKSA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgcGwtYSIgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9IiR7YWxpbmsubGlua30iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmsubGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rLnRleHQpfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIHBsLWEgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmN1cmzpk77mjqUiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYmMnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQkMoZGxpbmssIGZpbGVuYW1lLCBwYW4udWEpOwogICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKGFsaW5rKSA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgcGwtYSIgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9IiR7YWxpbmsubGlua30iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmsubGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rLnRleHQpfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBwbC1hIiBocmVmPSIke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9IiB0aXRsZT0i54K55Ye755So5q+U54m55b2X5pif5LiL6L29IiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29udGVudCArPSAnPC9kaXY+JzsKICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcmlhJykKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1jb3B5LWFsbCIgZGF0YS1saW5rPSIke2FsaW5rQWxsVGV4dH0iPuWkjeWItuWFqOmDqOmTvuaOpTwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgIGlmIChtb2RlID09PSAncnBjJykgewogICAgICAgICAgICAgICAgbGV0IHJwYyA9IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpICsgJzonICsgYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcpICsgYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcGF0aCcpOwogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLXNlbmQtcnBjIj7lj5HpgIHlhajpg6jpk77mjqU8L2J1dHRvbj48YnV0dG9uIHRpdGxlPSIke3JwY30iIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4td2FybmluZyBsaXN0ZW5lci1vcGVuLXNldHRpbmciIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweCI+6K6+572uIFJQQyDlj4LmlbDvvIjlvZPliY3kuLrvvJoke3JwY33vvIk8L2J1dHRvbj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4tc3VjY2VzcyBsaXN0ZW5lci1ycGMtdGFzayIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4O2Rpc3BsYXk6IG5vbmUiPuafpeeci+S4i+i9veS7u+WKoTwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdjdXJsJykKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1jb3B5LWFsbCIgZGF0YS1saW5rPSIke2FsaW5rQWxsVGV4dH0iPuWkjeWItuWFqOmDqOmTvuaOpTwvYnV0dG9uPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi13YXJuaW5nIGxpc3RlbmVyLW9wZW4tc2V0dGluZyIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4OyI+6K6+572u57uI56uv57G75Z6L77yI5b2T5YmN5Li677yaJHt0ZXJtaW5hbFR5cGVbYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190ZXJtaW5hbF90eXBlJyldfe+8iTwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgIHJldHVybiBjb250ZW50OwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIHNlbmRMaW5rVG9SUEMoZmlsZW5hbWUsIGxpbmspIHsKICAgICAgICAgICAgbGV0IHJwYyA9IHsKICAgICAgICAgICAgICAgIGRvbWFpbjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJyksCiAgICAgICAgICAgICAgICBwb3J0OiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JyksCiAgICAgICAgICAgICAgICBwYXRoOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wYXRoJyksCiAgICAgICAgICAgICAgICB0b2tlbjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfdG9rZW4nKSwKICAgICAgICAgICAgICAgIGRpcjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZGlyJyksCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGxldCBCRFVTUyA9IHRoaXMuZ2V0QkRVU1MoKTsKICAgICAgICAgICAgaWYgKCFCRFVTUykgcmV0dXJuICdhc3Npc3RhbnQnOwoKICAgICAgICAgICAgbGV0IHVybCA9IGAke3JwYy5kb21haW59OiR7cnBjLnBvcnR9JHtycGMucGF0aH1gOwogICAgICAgICAgICBsZXQgcnBjRGF0YSA9IHsKICAgICAgICAgICAgICAgIGlkOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKICAgICAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLAogICAgICAgICAgICAgICAgbWV0aG9kOiAnYXJpYTIuYWRkVXJpJywKICAgICAgICAgICAgICAgIHBhcmFtczogW2B0b2tlbjoke3JwYy50b2tlbn1gLCBbbGlua10sIHsKICAgICAgICAgICAgICAgICAgICBkaXI6IHJwYy5kaXIsCiAgICAgICAgICAgICAgICAgICAgb3V0OiBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IFtgVXNlci1BZ2VudDogJHtwYW4udWF9YCwgYENvb2tpZTogQkRVU1M9JHtCRFVTU31gXQogICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QodXJsLCBycGNEYXRhLCB7IlVzZXItQWdlbnQiOiBwYW4udWF9LCAnJyk7CiAgICAgICAgICAgICAgICBpZiAocmVzLnJlc3VsdCkgcmV0dXJuICdzdWNjZXNzJzsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBnZXRTZWxlY3RlZExpc3QoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVxdWlyZSgnc3lzdGVtLWNvcmU6Y29udGV4dC9jb250ZXh0LmpzJykuaW5zdGFuY2VGb3JTeXN0ZW0ubGlzdC5nZXRTZWxlY3RlZCgpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndwLXMtY29yZS1wYW4nKS5fX3Z1ZV9fLnNlbGVjdGVkTGlzdDsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGdldExvZ2lkKCkgewogICAgICAgICAgICBsZXQgdXQgPSByZXF1aXJlKCJzeXN0ZW0tY29yZTpjb250ZXh0L2NvbnRleHQuanMiKS5pbnN0YW5jZUZvclN5c3RlbS50b29scy5iYXNlU2VydmljZTsKICAgICAgICAgICAgcmV0dXJuIHV0LmJhc2U2NEVuY29kZShiYXNlLmdldENvb2tpZSgiQkFJRFVJRCIpKTsKICAgICAgICB9LAoKICAgICAgICBnZXRTaGFyZURhdGEoKSB7CiAgICAgICAgICAgIGxldCByZXMgPSBsb2NhbHMuZHVtcCgpOwogICAgICAgICAgICBwYXJhbXMuc2hhcmVUeXBlID0gJ3NlY3JldCc7CiAgICAgICAgICAgIHBhcmFtcy5zaWduID0gJyc7CiAgICAgICAgICAgIHBhcmFtcy50aW1lc3RhbXAgPSAnJzsKICAgICAgICAgICAgcGFyYW1zLmJkc3Rva2VuID0gcmVzLmJkc3Rva2VuLnZhbHVlOwogICAgICAgICAgICBwYXJhbXMuY2hhbm5lbCA9ICdjaHVubGVpJzsKICAgICAgICAgICAgcGFyYW1zLmNsaWVudHR5cGUgPSAwOwogICAgICAgICAgICBwYXJhbXMud2ViID0gMTsKICAgICAgICAgICAgcGFyYW1zLmFwcF9pZCA9IDI1MDUyODsKICAgICAgICAgICAgcGFyYW1zLmVuY3J5cHQgPSAwOwogICAgICAgICAgICBwYXJhbXMucHJvZHVjdCA9ICdzaGFyZSc7CiAgICAgICAgICAgIHBhcmFtcy5sb2dpZCA9IHRoaXMuZ2V0TG9naWQoKTsKICAgICAgICAgICAgcGFyYW1zLnByaW1hcnlpZCA9IHJlcy5zaGFyZWlkLnZhbHVlOwogICAgICAgICAgICBwYXJhbXMudWsgPSByZXMuc2hhcmVfdWsudmFsdWU7CiAgICAgICAgICAgIHBhcmFtcy5zaGFyZVR5cGUgPT09ICdzZWNyZXQnICYmIChwYXJhbXMuZXh0cmEgPSB0aGlzLl9nZXRFeHRyYSgpKTsKICAgICAgICAgICAgcGFyYW1zLnN1cmwgPSB0aGlzLl9nZXRTdXJsKCk7CiAgICAgICAgfSwKCiAgICAgICAgZGV0ZWN0UGFnZSgpIHsKICAgICAgICAgICAgbGV0IHBhdGggPSBsb2NhdGlvbi5wYXRobmFtZTsKICAgICAgICAgICAgaWYgKC9eXC9kaXNrXC9ob21lLy50ZXN0KHBhdGgpKSByZXR1cm4gJ2hvbWUnOwogICAgICAgICAgICBpZiAoL15cL2Rpc2tcL21haW4vLnRlc3QocGF0aCkpIHJldHVybiAnbWFpbic7CiAgICAgICAgICAgIGlmICgvXlwvKHN8c2hhcmUpXC8vLnRlc3QocGF0aCkpIHJldHVybiAnc2hhcmUnOwogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9LAoKICAgICAgICBzaG93TWFpbkRpYWxvZyh0aXRsZSwgaHRtbCwgZm9vdGVyKSB7CiAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICB0aXRsZSwKICAgICAgICAgICAgICAgIGh0bWwsCiAgICAgICAgICAgICAgICBmb290ZXIsCiAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q2xvc2VCdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcCcsCiAgICAgICAgICAgICAgICB3aWR0aCwKICAgICAgICAgICAgICAgIHBhZGRpbmc6ICcxNXB4IDIwcHggNXB4JywKICAgICAgICAgICAgICAgIGN1c3RvbUNsYXNzLAogICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuX3Jlc2V0RGF0YSgpOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBpbml0UGFuTGlua2VyKCkgewogICAgICAgICAgICBiYXNlLmluaXREZWZhdWx0Q29uZmlnKCk7CiAgICAgICAgICAgIGJhc2UuYWRkUGFuTGlua2VyU3R5bGUoKTsKICAgICAgICAgICAgcHQgPSB0aGlzLmRldGVjdFBhZ2UoKTsKICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdAogICAgICAgICAgICAoYGh0dHBzOi8vYXBpLnlvdXhpYW9ob3UuY29tL2NvbmZpZy92Mj92ZXI9JHt2ZXJzaW9ufSZhPSR7YXV0aG9yfWAsIHt9LCB7fSwgJ3RleHQnKTsKICAgICAgICAgICAgcGFuID0gSlNPTi5wYXJzZShiYXNlLmQocmVzKSk7CiAgICAgICAgICAgIE9iamVjdC5mcmVlemUgJiYgT2JqZWN0LmZyZWV6ZShwYW4pOwogICAgICAgICAgICBwYW4ubnVtID09PSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX2luaXRfY29kZScpIHx8CiAgICAgICAgICAgIHBhbi5saWNlbnNlID09PSBiYXNlLmdldFZhbHVlKCdsaWNlbnNlJykgPyB0aGlzLmFkZEJ1dHRvbigpIDogdGhpcy5hZGRJbml0QnV0dG9uKCk7CiAgICAgICAgICAgIGJhc2UuY3JlYXRlVGlwKCk7CiAgICAgICAgICAgIGJhc2UucmVnaXN0ZXJNZW51Q29tbWFuZCgpOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGluaXRBdXRob3JpemUoKSB7CiAgICAgICAgICAgIGxldCBpbnMgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoL29wZW5hcGkuYmFpZHUuY29tXC9vYXV0aFwvMi4wXC9hdXRob3JpemUvLnRlc3QobG9jYXRpb24uaHJlZikpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgY29uZmlybUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNhdXRoLWFsbG93Jyk7CiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1CdXR0b24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvbi5jbGljaygpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKC9vcGVuYXBpLmJhaWR1LmNvbVwvb2F1dGhcLzIuMFwvbG9naW5fc3VjY2Vzcy8udGVzdChsb2NhdGlvbi5ocmVmKSkgewogICAgICAgICAgICAgICAgICAgIGlmIChsb2NhdGlvbi5ocmVmLmluY2x1ZGVzKCdhY2Nlc3NfdG9rZW4nKSkgewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG9rZW4gPSBsb2NhdGlvbi5ocmVmLm1hdGNoKC9hY2Nlc3NfdG9rZW49KC4qPykmLylbMV07CiAgICAgICAgICAgICAgICAgICAgICAgIGJhc2Uuc2V0VmFsdWUoJ2JhaWR1X2FjY2Vzc190b2tlbicsIHRva2VuKTsKICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsb3NlKCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIDIwMCkKICAgICAgICB9CiAgICB9OwoKICAgIGxldCBhbGkgPSB7CgogICAgICAgIGNvbnZlcnRMaW5rVG9BcmlhKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBmaWxlbmFtZSA9IGJhc2UuZml4RmlsZW5hbWUoZmlsZW5hbWUpOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBhcmlhMmMgIiR7bGlua30iIC0tb3V0ICIke2ZpbGVuYW1lfSIgLS1oZWFkZXIgIlJlZmVyZXI6IGh0dHBzOi8vd3d3LmFsaXl1bmRyaXZlLmNvbS8iYCk7CiAgICAgICAgfSwKCiAgICAgICAgY29udmVydExpbmtUb0JDKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBsZXQgYmMgPSBgQUEvJHtlbmNvZGVVUklDb21wb25lbnQoZmlsZW5hbWUpfS8/dXJsPSR7ZW5jb2RlVVJJQ29tcG9uZW50KGxpbmspfSZyZWZlcj0ke2VuY29kZVVSSUNvbXBvbmVudCgnaHR0cHM6Ly93d3cuYWxpeXVuZHJpdmUuY29tLycpfVpaYDsKICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgYmM6Ly9odHRwLyR7YmFzZS5lKGJjKX1gKTsKICAgICAgICB9LAoKICAgICAgICBjb252ZXJ0TGlua1RvQ3VybChsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgbGV0IHRlcm1pbmFsID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190ZXJtaW5hbF90eXBlJyk7CiAgICAgICAgICAgIGZpbGVuYW1lID0gYmFzZS5maXhGaWxlbmFtZShmaWxlbmFtZSk7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYCR7dGVybWluYWwgIT09ICd3cCcgPyAnY3VybCcgOiAnY3VybC5leGUnfSAtTCAtQyAtICIke2xpbmt9IiAtbyAiJHtmaWxlbmFtZX0iIC1lICJodHRwczovL3d3dy5hbGl5dW5kcml2ZS5jb20vImApOwogICAgICAgIH0sCgogICAgICAgIGFkZFBhZ2VMaXN0ZW5lcigpIHsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcucGwtYnV0dG9uLW1vZGUnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgbW9kZSA9IGUudGFyZ2V0LmRhdGFzZXQubW9kZTsKICAgICAgICAgICAgICAgIFN3YWwuc2hvd0xvYWRpbmcoKTsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0UENTTGluaygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcGknLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgbGV0IGRhdGFzZXQgPSBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldDsKICAgICAgICAgICAgICAgIGxldCBocmVmID0gZGF0YXNldC5saW5rOwogICAgICAgICAgICAgICAgLy8gbGV0IHVybCA9IGF3YWl0IHRoaXMuZ2V0UmVhbExpbmsoZGF0YXNldC5kaWQsIGRhdGFzZXQuZmlkKTsKICAgICAgICAgICAgICAgIC8vIGlmICh1cmwpIGhyZWYgPSB1cmw7CiAgICAgICAgICAgICAgICAkKCcjZG93bmxvYWRJZnJhbWUnKS5hdHRyKCdzcmMnLCBocmVmKTsKICAgICAgICAgICAgICAgIC8vIGxldCBkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYSIpOwogICAgICAgICAgICAgICAgLy8gZC5kb3dubG9hZCA9IGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmZpbGVuYW1lOwogICAgICAgICAgICAgICAgLy8gZC5yZWwgPSAibm9vcGVuZXIiOwogICAgICAgICAgICAgICAgLy8gZC5ocmVmID0gaHJlZjsKICAgICAgICAgICAgICAgIC8vIGQuZGlzcGF0Y2hFdmVudChuZXcgTW91c2VFdmVudCgiY2xpY2siKSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWFwaS1idG4nLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgYmFzZS5zZXRDbGlwYm9hcmQoZS50YXJnZXQuZGF0YXNldC5maWxlbmFtZSk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflpI3liLbmiJDlip8nKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWFyaWEsIC5saXN0ZW5lci1jb3B5LWFsbCcsIChlKSA9PiB7CiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgICAgICAgICBiYXNlLnNldENsaXBib2FyZChkZWNvZGVVUklDb21wb25lbnQoZS50YXJnZXQuZGF0YXNldC5saW5rKSk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflpI3liLbmiJDlip/vvIzlv6vljrvnspjotLTlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLXJwYycsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5pY29uJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQuZmluZCgnLnBsLWxvYWRpbmcnKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHRhcmdldC5wcmVwZW5kKGJhc2UuY3JlYXRlTG9hZGluZygpKTsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCB0aGlzLnNlbmRMaW5rVG9SUEMoZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuZmlsZW5hbWUsIGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmxpbmspOwogICAgICAgICAgICAgICAgaWYgKHJlcyA9PT0gJ3N1Y2Nlc3MnKSB7CiAgICAgICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLXJwYy10YXNrJykuc2hvdygpOwogICAgICAgICAgICAgICAgICAgIHRhcmdldC5yZW1vdmVDbGFzcygncGwtYnRuLWRhbmdlcicpLmh0bWwoJ+WPkemAgeaIkOWKn++8jOW/q+WOu+eci+eci+WQp++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LmFkZENsYXNzKCdwbC1idG4tZGFuZ2VyJykudGV4dCgn5Y+R6YCB5aSx6LSl77yM6K+35qOA5p+l5oKo55qEUlBD6YWN572u5L+h5oGv77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItc2VuZC1ycGMnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgJCgnLmxpc3RlbmVyLWxpbmstcnBjJykuY2xpY2soKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WPkemAgeWujOaIkO+8jOWPkemAgee7k+aenOingeS4iuaWueaMiemSru+8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLW9wZW4tc2V0dGluZycsICgpID0+IHsKICAgICAgICAgICAgICAgIGJhc2Uuc2hvd1NldHRpbmcoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXJwYy10YXNrJywgKCkgPT4gewogICAgICAgICAgICAgICAgbGV0IHJwYyA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgICAgICBkb21haW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpLAogICAgICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIH0pLCB1cmwgPSBgJHtwYW4uZH0vP3JwYz0ke2Jhc2UuZShycGMpfSMke2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyl9YDsKICAgICAgICAgICAgICAgIEdNX29wZW5JblRhYih1cmwsIHthY3RpdmU6IHRydWV9KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZ2V0UmVhbExpbmsoZCwgZikgewogICAgICAgICAgICBsZXQgYXV0aG9yaXphdGlvbiA9IGAke2Jhc2UuZ2V0U3RvcmFnZSgndG9rZW4nKS50b2tlbl90eXBlfSAke2Jhc2UuZ2V0U3RvcmFnZSgndG9rZW4nKS5hY2Nlc3NfdG9rZW59YDsKICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdChwYW4ucGNzWzFdLCB7CiAgICAgICAgICAgICAgICBkcml2ZV9pZDogZCwKICAgICAgICAgICAgICAgIGZpbGVfaWQ6IGYKICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbiwKICAgICAgICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04IiwKICAgICAgICAgICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vd3d3LmFsaXl1bmRyaXZlLmNvbS8iLAogICAgICAgICAgICAgICAgIngtY2FuYXJ5IjogImNsaWVudD13aW5kb3dzLGFwcD1hZHJpdmUsdmVyc2lvbj12Ni4wLjAiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAocmVzLmNvZGUgPT09ICdBY2Nlc3NUb2tlbkludmFsaWQnKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677yaVG9rZW7ov4fmnJ/vvIzor7fliLfmlrDnvZHpobXlkI7ph43or5XvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocmVzLnVybCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHJlcy51cmw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0sCgogICAgICAgIGFkZEJ1dHRvbigpIHsKICAgICAgICAgICAgaWYgKCFwdCkgcmV0dXJuOwogICAgICAgICAgICBsZXQgJHRvb2xXcmFwOwogICAgICAgICAgICBsZXQgJGJ1dHRvbiA9ICQoYDxkaXYgY2xhc3M9ImFsaS1idXR0b24gcGwtYnV0dG9uIj48c3ZnIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ij48cGF0aCBkPSJNODUzLjMzMyA5MzguNjY3SDE3MC42NjdhODUuMzMzIDg1LjMzMyAwIDAgMS04NS4zMzQtODUuMzM0di0zODRBODUuMzMzIDg1LjMzMyAwIDAgMSAxNzAuNjY3IDM4NEgyODhhMzIgMzIgMCAwIDEgMCA2NEgxNzAuNjY3YTIxLjMzMyAyMS4zMzMgMCAwIDAtMjEuMzM0IDIxLjMzM3YzODRhMjEuMzMzIDIxLjMzMyAwIDAgMCAyMS4zMzQgMjEuMzM0aDY4Mi42NjZhMjEuMzMzIDIxLjMzMyAwIDAgMCAyMS4zMzQtMjEuMzM0di0zODRBMjEuMzMzIDIxLjMzMyAwIDAgMCA4NTMuMzMzIDQ0OEg3MzZhMzIgMzIgMCAwIDEgMC02NGgxMTcuMzMzYTg1LjMzMyA4NS4zMzMgMCAwIDEgODUuMzM0IDg1LjMzM3YzODRhODUuMzMzIDg1LjMzMyAwIDAgMS04NS4zMzQgODUuMzM0eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik03MTUuMDMgNTQzLjU1MmEzMi44MSAzMi44MSAwIDAgMC00Ni4yNTEgMEw1NTQuMDA1IDY1Ny44MTN2LTU0MC40OGEzMiAzMiAwIDAgMC02NCAwdjUzOS43MzRMMzc1Ljg5MyA1NDMuNDg4YTMyLjc5IDMyLjc5IDAgMCAwLTQ2LjIyOSAwIDMyLjQyNyAzMi40MjcgMCAwIDAgMCA0Ni4wMzdsMTY5LjU1NyAxNjguODExYTMyLjgxIDMyLjgxIDAgMCAwIDQ2LjI1MSAwbDE2OS41NTctMTY4LjgxYTMyLjQ3IDMyLjQ3IDAgMCAwIDAtNDUuOTc0eiIgZmlsbD0iI0ZGOUMwMCIvPjwvc3ZnPjxzcGFuPuS4i+i9veWKqeaJizwvc3Bhbj48dWwgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUiPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFwaSI+QVBJ5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcmlhIiA+QXJpYeS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0icnBjIj5SUEPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImN1cmwiPmNVUkzkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImJjIiA+QkPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIGxpc3RlbmVyLW9wZW4tc2V0dGluZyI+5Yqp5omL6K6+572uPC9saT4ke3Bhbi5jb2RlID09IDIwMCAmJiB2ZXJzaW9uIDwgcGFuLnZlcnNpb24gPyBwYW4ubmV3IDogJyd9PC91bD48L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpIHsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLmhvbWUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAuYXBwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHQgPT09ICdzaGFyZScpIHsKICAgICAgICAgICAgICAgICRidXR0b24uY3NzKHsnbWFyZ2luLXJpZ2h0JzogJzEwcHgnfSk7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5zaGFyZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5zaGFyZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgYmFzZS5jcmVhdGVEb3dubG9hZElmcmFtZSgpOwogICAgICAgICAgICB0aGlzLmFkZFBhZ2VMaXN0ZW5lcigpOwogICAgICAgIH0sCgogICAgICAgIGFkZEluaXRCdXR0b24oKSB7CiAgICAgICAgICAgIGlmICghcHQpIHJldHVybjsKICAgICAgICAgICAgbGV0ICR0b29sV3JhcDsKICAgICAgICAgICAgbGV0ICRidXR0b24gPSAkKGA8ZGl2IGNsYXNzPSJhbGktYnV0dG9uIHBsLWJ1dHRvbi1pbml0Ij48c3ZnIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ij48cGF0aCBkPSJNODUzLjMzMyA5MzguNjY3SDE3MC42NjdhODUuMzMzIDg1LjMzMyAwIDAgMS04NS4zMzQtODUuMzM0di0zODRBODUuMzMzIDg1LjMzMyAwIDAgMSAxNzAuNjY3IDM4NEgyODhhMzIgMzIgMCAwIDEgMCA2NEgxNzAuNjY3YTIxLjMzMyAyMS4zMzMgMCAwIDAtMjEuMzM0IDIxLjMzM3YzODRhMjEuMzMzIDIxLjMzMyAwIDAgMCAyMS4zMzQgMjEuMzM0aDY4Mi42NjZhMjEuMzMzIDIxLjMzMyAwIDAgMCAyMS4zMzQtMjEuMzM0di0zODRBMjEuMzMzIDIxLjMzMyAwIDAgMCA4NTMuMzMzIDQ0OEg3MzZhMzIgMzIgMCAwIDEgMC02NGgxMTcuMzMzYTg1LjMzMyA4NS4zMzMgMCAwIDEgODUuMzM0IDg1LjMzM3YzODRhODUuMzMzIDg1LjMzMyAwIDAgMS04NS4zMzQgODUuMzM0eiIgZmlsbD0iI2ZmZiIvPjxwYXRoIGQ9Ik03MTUuMDMgNTQzLjU1MmEzMi44MSAzMi44MSAwIDAgMC00Ni4yNTEgMEw1NTQuMDA1IDY1Ny44MTN2LTU0MC40OGEzMiAzMiAwIDAgMC02NCAwdjUzOS43MzRMMzc1Ljg5MyA1NDMuNDg4YTMyLjc5IDMyLjc5IDAgMCAwLTQ2LjIyOSAwIDMyLjQyNyAzMi40MjcgMCAwIDAgMCA0Ni4wMzdsMTY5LjU1NyAxNjguODExYTMyLjgxIDMyLjgxIDAgMCAwIDQ2LjI1MSAwbDE2OS41NTctMTY4LjgxYTMyLjQ3IDMyLjQ3IDAgMCAwIDAtNDUuOTc0eiIgZmlsbD0iI0ZGOUMwMCIvPjwvc3ZnPjxzcGFuPuS4i+i9veWKqeaJizwvc3Bhbj48L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpIHsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLmhvbWUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbi1pbml0JykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5hcHBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgewogICAgICAgICAgICAgICAgJGJ1dHRvbi5jc3MoeydtYXJnaW4tcmlnaHQnOiAnMTBweCd9KTsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLnNoYXJlLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLnNoYXJlKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG8taW5pdCcpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGJ1dHRvbi5jbGljaygoKSA9PiBiYXNlLmluaXREaWFsb2coKSk7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZ2V0UENTTGluaygpIHsKICAgICAgICAgICAgbGV0IHJlYWN0RG9tR3JpZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocGFuLmRvbS5ncmlkKTsKICAgICAgICAgICAgaWYgKHJlYWN0RG9tR3JpZCkgewogICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfmj5DnpLonLAogICAgICAgICAgICAgICAgICAgIGh0bWw6ICc8ZGl2IHN0eWxlPSJkaXNwbGF5OiBmbGV4O2FsaWduLWl0ZW1zOiBjZW50ZXI7anVzdGlmeS1jb250ZW50OiBjZW50ZXI7Ij7or7flhYjliIfmjaLliLAgPGI+5YiX6KGo6KeG5Zu+PC9iPu+8iDxzdmcgY2xhc3M9Imljb24iIHZpZXdCb3g9IjAgMCAxMDI0IDEwMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2Ij48cGF0aCBkPSJNMTMyIDkyOGMtMzIuOCAwLTU5LjItMjYuNC01OS4yLTU5LjJzMjYuNC01OS4yIDU5LjItNTkuMmg3NjBjMzIuOCAwIDU5LjIgMjYuNCA1OS4yIDU5LjJTOTI0LjggOTI4IDg5MiA5MjhIMTMyem0wLTM1Ni44Yy0zMi44IDAtNTkuMi0yNi40LTU5LjItNTkuMnMyNi40LTU5LjIgNTkuMi01OS4yaDc2MGMzMi44IDAgNTkuMiAyNi40IDU5LjIgNTkuMnMtMjYuNCA1OS4yLTU5LjIgNTkuMkgxMzJ6bTAtMzU2Yy0zMi44IDAtNTkuMi0yNi40LTU5LjItNTkuMlM5OS4yIDk2LjggMTMyIDk2LjhoNzYwYzMyLjggMCA1OS4yIDI2LjQgNTkuMiA1OS4ycy0yNi40IDU5LjItNTkuMiA1OS4ySDEzMnoiLz48L3N2Zz7vvInlkI7ojrflj5bvvIE8L2Rpdj4nLAogICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn54K55Ye75YiH5o2iJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihwYW4uZG9tLnN3aXRjaCkuY2xpY2soKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5zdWNjZXNzKCfliIfmjaLmiJDlip/vvIzor7fph43mlrDojrflj5bkuIvovb3pk77mjqXvvIEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICBzZWxlY3RMaXN0ID0gdGhpcy5nZXRTZWxlY3RlZExpc3QoKTsKICAgICAgICAgICAgaWYgKHNlbGVjdExpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI5Yu+6YCJ6KaB5LiL6L2955qE5paH5Lu277yBJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRoaXMuaXNPbmx5Rm9sZGVyKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7fmiZPlvIDmlofku7blpLnlkI7li77pgInmlofku7bvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHQgPT09ICdzaGFyZScpIHsKICAgICAgICAgICAgICAgIGlmIChzZWxlY3RMaXN0Lmxlbmd0aCA+IDIwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muWNleasoeacgOWkmuWPr+WLvumAiSAyMCDkuKrmlofku7bvvIEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGF1dGhvcml6YXRpb24gPSBgJHtiYXNlLmdldFN0b3JhZ2UoJ3Rva2VuJykudG9rZW5fdHlwZX0gJHtiYXNlLmdldFN0b3JhZ2UoJ3Rva2VuJykuYWNjZXNzX3Rva2VufWA7CiAgICAgICAgICAgICAgICAgICAgbGV0IHhTaGFyZVRva2VuID0gYmFzZS5nZXRTdG9yYWdlKCdzaGFyZVRva2VuJykuc2hhcmVfdG9rZW47CgogICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0TGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0KHBhbi5wY3NbMF0sIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZV9zZWM6IDYwMCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVfaWQ6IHNlbGVjdExpc3RbaV0uZmlsZUlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hhcmVfaWQ6IHNlbGVjdExpc3RbaV0uc2hhcmVJZAogICAgICAgICAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdXRob3JpemF0aW9uLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIngtc2hhcmUtdG9rZW4iOiB4U2hhcmVUb2tlbgogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kb3dubG9hZF91cmwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdExpc3RbaV0uZG93bmxvYWRVcmwgPSByZXMuZG93bmxvYWRfdXJsOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7flhYjnmbvlvZXnvZHnm5jvvIEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChzZWxlY3RMaXN0Lmxlbmd0aCA+IDIwKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muWNleasoeacgOWkmuWPr+WLvumAiSAyMCDkuKrmlofku7bvvIEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxldCBub1VybFNlbGVjdExpc3QgPSBzZWxlY3RMaXN0LmZpbHRlcih2ID0+ICFCb29sZWFuKHYudXJsKSkKICAgICAgICAgICAgICAgIGxldCBxdWV1ZSA9IFtdOwogICAgICAgICAgICAgICAgbm9VcmxTZWxlY3RMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcXVldWUucHVzaCh0aGlzLmdldFJlYWxMaW5rKGl0ZW0uZHJpdmVJZCwgaXRlbS5maWxlSWQpKTsKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IFByb21pc2UuYWxsKHF1ZXVlKTsKICAgICAgICAgICAgICAgIHJlcy5mb3JFYWNoKCh2YWwsIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgbm9VcmxTZWxlY3RMaXN0W2luZGV4XS51cmwgPSB2YWw7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGh0bWwgPSB0aGlzLmdlbmVyYXRlRG9tKHNlbGVjdExpc3QpOwogICAgICAgICAgICB0aGlzLnNob3dNYWluRGlhbG9nKHBhblttb2RlXVswXSwgaHRtbCwgcGFuW21vZGVdWzFdKTsKICAgICAgICB9LAoKICAgICAgICBnZW5lcmF0ZURvbShsaXN0KSB7CiAgICAgICAgICAgIGxldCBjb250ZW50ID0gJzxkaXYgY2xhc3M9InBsLW1haW4iPic7CiAgICAgICAgICAgIGxldCBhbGlua0FsbFRleHQgPSAnJzsKICAgICAgICAgICAgbGlzdC5mb3JFYWNoKCh2LCBpKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodi50eXBlID09PSAnZm9sZGVyJykgcmV0dXJuOwogICAgICAgICAgICAgICAgbGV0IGZpbGVuYW1lID0gdi5uYW1lOwogICAgICAgICAgICAgICAgbGV0IGZpZCA9IHYuZmlsZUlkOwogICAgICAgICAgICAgICAgbGV0IGRpZCA9IHYuZHJpdmVJZDsKICAgICAgICAgICAgICAgIGxldCBzaXplID0gYmFzZS5zaXplRm9ybWF0KHYuc2l6ZSk7CiAgICAgICAgICAgICAgICBsZXQgZGxpbmsgPSB2LmRvd25sb2FkVXJsIHx8IHYudXJsOwogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcGknKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcGkiIGRhdGEtZGlkPSIke2RpZH0iIGRhdGEtZmlkPSIke2ZpZH0iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9IiBkYXRhLWluZGV4PSIke2l9Ij4ke2RsaW5rfTwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLWJ0biBsaXN0ZW5lci1saW5rLWFwaS1idG4iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9Ij7lpI3liLbmlofku7blkI08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcmlhJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0FyaWEoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmFyaWEyY+mTvuaOpSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JwYycpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstcnBjIHBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1pbmZvIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2RsaW5rfSI+PGVtIGNsYXNzPSJpY29uIGljb24tZGV2aWNlIj48L2VtPjxzcGFuIHN0eWxlPSJtYXJnaW4tbGVmdDogNXB4OyI+5o6o6YCB5YiwIFJQQyDkuIvovb3lmag8L3NwYW4+PC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnY3VybCcpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9DdXJsKGRsaW5rLCBmaWxlbmFtZSwgbmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgICAgICAgICAgICAgICAgICAgYWxpbmtBbGxUZXh0ICs9IGFsaW5rICsgJ1xyXG4nOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstYXJpYSIgaHJlZj0iJHthbGlua30iIHRpdGxlPSLngrnlh7vlpI3liLZjdXJs6ZO+5o6lIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYmMnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQkMoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayIgaHJlZj0iJHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfSIgdGl0bGU9IueCueWHu+eUqOavlOeJueW9l+aYn+S4i+i9vSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb250ZW50ICs9ICc8L2Rpdj4nOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FyaWEnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdycGMnKSB7CiAgICAgICAgICAgICAgICBsZXQgcnBjID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJykgKyAnOicgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JykgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wYXRoJyk7CiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItc2VuZC1ycGMiPuWPkemAgeWFqOmDqOmTvuaOpTwvYnV0dG9uPjxidXR0b24gdGl0bGU9IiR7cnBjfSIgY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi13YXJuaW5nIGxpc3RlbmVyLW9wZW4tc2V0dGluZyIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4Ij7orr7nva4gUlBDIOWPguaVsO+8iOW9k+WJjeS4uu+8miR7cnBjfe+8iTwvYnV0dG9uPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1zdWNjZXNzIGxpc3RlbmVyLXJwYy10YXNrIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7ZGlzcGxheTogbm9uZSI+5p+l55yL5LiL6L295Lu75YqhPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2N1cmwnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXdhcm5pbmcgbGlzdGVuZXItb3Blbi1zZXR0aW5nIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7Ij7orr7nva7nu4jnq6/nsbvlnovvvIjlvZPliY3kuLrvvJoke3Rlcm1pbmFsVHlwZVtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnKV1977yJPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgc2VuZExpbmtUb1JQQyhmaWxlbmFtZSwgbGluaykgewogICAgICAgICAgICBsZXQgcnBjID0gewogICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIHBhdGg6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKSwKICAgICAgICAgICAgICAgIHRva2VuOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpLAogICAgICAgICAgICAgICAgZGlyOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kaXInKSwKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGxldCB1cmwgPSBgJHtycGMuZG9tYWlufToke3JwYy5wb3J0fSR7cnBjLnBhdGh9YDsKICAgICAgICAgICAgbGV0IHJwY0RhdGEgPSB7CiAgICAgICAgICAgICAgICBpZDogbmV3IERhdGUoKS5nZXRUaW1lKCksCiAgICAgICAgICAgICAgICBqc29ucnBjOiAnMi4wJywKICAgICAgICAgICAgICAgIG1ldGhvZDogJ2FyaWEyLmFkZFVyaScsCiAgICAgICAgICAgICAgICBwYXJhbXM6IFtgdG9rZW46JHtycGMudG9rZW59YCwgW2xpbmtdLCB7CiAgICAgICAgICAgICAgICAgICAgZGlyOiBycGMuZGlyLAogICAgICAgICAgICAgICAgICAgIG91dDogZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBbYFJlZmVyZXI6IGh0dHBzOi8vd3d3LmFsaXl1bmRyaXZlLmNvbS9gXQogICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QodXJsLCBycGNEYXRhLCB7IlJlZmVyZXIiOiAiaHR0cHM6Ly93d3cuYWxpeXVuZHJpdmUuY29tLyJ9LCAnJyk7CiAgICAgICAgICAgICAgICBpZiAocmVzLnJlc3VsdCkgcmV0dXJuICdzdWNjZXNzJzsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBnZXRTZWxlY3RlZExpc3QoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRMaXN0ID0gW107CiAgICAgICAgICAgICAgICBsZXQgcmVhY3REb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBhbi5kb20ubGlzdCk7CiAgICAgICAgICAgICAgICBsZXQgcmVhY3RPYmogPSBiYXNlLmZpbmRSZWFjdChyZWFjdERvbSwgMSk7CiAgICAgICAgICAgICAgICBsZXQgcHJvcHMgPSByZWFjdE9iai5wZW5kaW5nUHJvcHM7CiAgICAgICAgICAgICAgICBpZiAocHJvcHMpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgZmlsZUxpc3QgPSBwcm9wcy5kYXRhU291cmNlIHx8IFtdOwogICAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZEtleXMgPSBwcm9wcy5zZWxlY3RlZEtleXMuc3BsaXQoJywnKTsKICAgICAgICAgICAgICAgICAgICBmaWxlTGlzdC5mb3JFYWNoKCh2YWwpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkS2V5cy5pbmNsdWRlcyh2YWwuZmlsZUlkKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRMaXN0LnB1c2godmFsKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkTGlzdDsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZGV0ZWN0UGFnZSgpIHsKICAgICAgICAgICAgbGV0IHBhdGggPSBsb2NhdGlvbi5wYXRobmFtZTsKICAgICAgICAgICAgaWYgKC9eXC8oZHJpdmUpLy50ZXN0KHBhdGgpKSByZXR1cm4gJ2hvbWUnOwogICAgICAgICAgICBpZiAoL15cLyhzfHNoYXJlKVwvLy50ZXN0KHBhdGgpKSByZXR1cm4gJ3NoYXJlJzsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0sCgogICAgICAgIGlzT25seUZvbGRlcigpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0TGlzdFtpXS50eXBlID09PSAnZmlsZScpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9LAoKICAgICAgICBzaG93TWFpbkRpYWxvZyh0aXRsZSwgaHRtbCwgZm9vdGVyKSB7CiAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICB0aXRsZSwKICAgICAgICAgICAgICAgIGh0bWwsCiAgICAgICAgICAgICAgICBmb290ZXIsCiAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q2xvc2VCdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcCcsCiAgICAgICAgICAgICAgICB3aWR0aCwKICAgICAgICAgICAgICAgIHBhZGRpbmc6ICcxNXB4IDIwcHggNXB4JywKICAgICAgICAgICAgICAgIGN1c3RvbUNsYXNzLAogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBpbml0UGFuTGlua2VyKCkgewogICAgICAgICAgICBiYXNlLmluaXREZWZhdWx0Q29uZmlnKCk7CiAgICAgICAgICAgIGJhc2UuYWRkUGFuTGlua2VyU3R5bGUoKTsKICAgICAgICAgICAgcHQgPSB0aGlzLmRldGVjdFBhZ2UoKTsKICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdAogICAgICAgICAgICAoYGh0dHBzOi8vYXBpLnlvdXhpYW9ob3UuY29tL2NvbmZpZy92Mi9hbGk/dmVyPSR7dmVyc2lvbn0mYT0ke2F1dGhvcn1gLCB7fSwge30sICd0ZXh0Jyk7CiAgICAgICAgICAgIHBhbiA9IEpTT04ucGFyc2UoYmFzZS5kKHJlcykpOwogICAgICAgICAgICBPYmplY3QuZnJlZXplICYmIE9iamVjdC5mcmVlemUocGFuKTsKICAgICAgICAgICAgcGFuLm51bSA9PT0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19pbml0X2NvZGUnKSB8fAogICAgICAgICAgICBwYW4ubGljZW5zZSA9PT0gYmFzZS5nZXRWYWx1ZSgnbGljZW5zZScpID8gdGhpcy5hZGRCdXR0b24oKSA6IHRoaXMuYWRkSW5pdEJ1dHRvbigpOwogICAgICAgICAgICBiYXNlLmNyZWF0ZVRpcCgpOwogICAgICAgICAgICBiYXNlLnJlZ2lzdGVyTWVudUNvbW1hbmQoKTsKICAgICAgICB9CiAgICB9OwoKICAgIGxldCB0aWFueWkgPSB7CgogICAgICAgIGNvbnZlcnRMaW5rVG9BcmlhKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBmaWxlbmFtZSA9IGJhc2UuZml4RmlsZW5hbWUoZmlsZW5hbWUpOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBhcmlhMmMgIiR7bGlua30iIC0tb3V0ICIke2ZpbGVuYW1lfSJgKTsKICAgICAgICB9LAoKICAgICAgICBjb252ZXJ0TGlua1RvQkMobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGxldCBiYyA9IGBBQS8ke2VuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZSl9Lz91cmw9JHtlbmNvZGVVUklDb21wb25lbnQobGluayl9WlpgOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBiYzovL2h0dHAvJHtiYXNlLmUoYmMpfWApOwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9DdXJsKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBsZXQgdGVybWluYWwgPSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnKTsKICAgICAgICAgICAgZmlsZW5hbWUgPSBiYXNlLmZpeEZpbGVuYW1lKGZpbGVuYW1lKTsKICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgJHt0ZXJtaW5hbCAhPT0gJ3dwJyA/ICdjdXJsJyA6ICdjdXJsLmV4ZSd9IC1MIC1DIC0gIiR7bGlua30iIC1vICIke2ZpbGVuYW1lfSJgKTsKICAgICAgICB9LAoKICAgICAgICBhZGRQYWdlTGlzdGVuZXIoKSB7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLnBsLWJ1dHRvbi1tb2RlJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIG1vZGUgPSBlLnRhcmdldC5kYXRhc2V0Lm1vZGU7CiAgICAgICAgICAgICAgICBTd2FsLnNob3dMb2FkaW5nKCk7CiAgICAgICAgICAgICAgICB0aGlzLmdldFBDU0xpbmsoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYXBpJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICQoJyNkb3dubG9hZElmcmFtZScpLmF0dHIoJ3NyYycsIGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmxpbmspOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcmlhLCAubGlzdGVuZXItY29weS1hbGwnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgYmFzZS5zZXRDbGlwYm9hcmQoZGVjb2RlVVJJQ29tcG9uZW50KGUudGFyZ2V0LmRhdGFzZXQubGluaykpOwogICAgICAgICAgICAgICAgJChlLnRhcmdldCkudGV4dCgn5aSN5Yi25oiQ5Yqf77yM5b+r5Y6757KY6LS05ZCn77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1ycGMnLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgbGV0IHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTsKICAgICAgICAgICAgICAgIHRhcmdldC5maW5kKCcuaWNvbicpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5wbC1sb2FkaW5nJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQucHJlcGVuZChiYXNlLmNyZWF0ZUxvYWRpbmcoKSk7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy5zZW5kTGlua1RvUlBDKGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmZpbGVuYW1lLCBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5saW5rKTsKICAgICAgICAgICAgICAgIGlmIChyZXMgPT09ICdzdWNjZXNzJykgewogICAgICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1ycGMtdGFzaycpLnNob3coKTsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQucmVtb3ZlQ2xhc3MoJ3BsLWJ0bi1kYW5nZXInKS5odG1sKCflj5HpgIHmiJDlip/vvIzlv6vljrvnnIvnnIvlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRhcmdldC5hZGRDbGFzcygncGwtYnRuLWRhbmdlcicpLnRleHQoJ+WPkemAgeWksei0pe+8jOivt+ajgOafpeaCqOeahFJQQ+mFjee9ruS/oeaBr++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXNlbmQtcnBjJywgKGUpID0+IHsKICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1saW5rLXJwYycpLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflj5HpgIHlrozmiJDvvIzlj5HpgIHnu5Pmnpzop4HkuIrmlrnmjInpkq7vvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1vcGVuLXNldHRpbmcnLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNob3dTZXR0aW5nKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1ycGMtdGFzaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGxldCBycGMgPSBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgICAgICBwb3J0OiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JyksCiAgICAgICAgICAgICAgICB9KSwgdXJsID0gYCR7cGFuLmR9Lz9ycGM9JHtiYXNlLmUocnBjKX0jJHtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpfWA7CiAgICAgICAgICAgICAgICBHTV9vcGVuSW5UYWIodXJsLCB7YWN0aXZlOiB0cnVlfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFkZEJ1dHRvbigpIHsKICAgICAgICAgICAgaWYgKCFwdCkgcmV0dXJuOwogICAgICAgICAgICBsZXQgJHRvb2xXcmFwOwogICAgICAgICAgICBsZXQgJGJ1dHRvbiA9ICQoYDxkaXYgY2xhc3M9InRpYW55aS1idXR0b24gcGwtYnV0dG9uIj7kuIvovb3liqnmiYs8dWwgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUiIHN0eWxlPSJ0b3A6IDI2cHg7Ij48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcGkiPkFQSeS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYXJpYSIgPkFyaWHkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9InJwYyI+UlBD5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJjdXJsIj5jVVJM5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJiYyIgPkJD5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSBsaXN0ZW5lci1vcGVuLXNldHRpbmciPuWKqeaJi+iuvue9rjwvbGk+JHtwYW4uY29kZSA9PSAyMDAgJiYgdmVyc2lvbiA8IHBhbi52ZXJzaW9uID8gcGFuLm5ldyA6ICcnfTwvdWw+PC9kaXY+YCk7CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ2hvbWUnKSB7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5ob21lLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLmhvbWUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24nKS5sZW5ndGggPT09IDAgJiYgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgewogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uc2hhcmUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24nKS5sZW5ndGggPT09IDAgJiYgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGJhc2UuY3JlYXRlRG93bmxvYWRJZnJhbWUoKTsKICAgICAgICAgICAgdGhpcy5hZGRQYWdlTGlzdGVuZXIoKTsKICAgICAgICB9LAoKICAgICAgICBhZGRJbml0QnV0dG9uKCkgewogICAgICAgICAgICBpZiAoIXB0KSByZXR1cm47CiAgICAgICAgICAgIGxldCAkdG9vbFdyYXA7CiAgICAgICAgICAgIGxldCAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0idGlhbnlpLWJ1dHRvbiBwbC1idXR0b24taW5pdCI+5LiL6L295Yqp5omLPC9kaXY+YCk7CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ2hvbWUnKSB7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5ob21lLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLmhvbWUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24taW5pdCcpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICAkYnV0dG9uLmNzcyh7J21hcmdpbi1yaWdodCc6ICcxMHB4J30pOwogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uc2hhcmUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24taW5pdCcpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGJ1dHRvbi5jbGljaygoKSA9PiBiYXNlLmluaXREaWFsb2coKSk7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZ2V0VG9rZW4oKSB7CiAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLmdldEZpbmFsVXJsKHBhbi5wY3NbMV0sIHt9KTsKICAgICAgICAgICAgbGV0IGFjY2Vzc1Rva2VuID0gcmVzLm1hdGNoKC9hY2Nlc3NUb2tlbj0oXHcrKS8pPy5bMV07CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuICYmIGJhc2Uuc2V0U3RvcmFnZSgnYWNjZXNzVG9rZW4nLCBhY2Nlc3NUb2tlbik7CiAgICAgICAgICAgIHJldHVybiBhY2Nlc3NUb2tlbjsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRGaWxlVXJsQnlPbmNlKGl0ZW0sIGluZGV4LCB0b2tlbikgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKGl0ZW0uZG93bmxvYWRVcmwpIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6IGl0ZW0uZG93bmxvYWRVcmwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBsZXQgdGltZSA9IERhdGUubm93KCksCiAgICAgICAgICAgICAgICAgICAgZmlsZUlkID0gaXRlbS5maWxlSWQsCiAgICAgICAgICAgICAgICAgICAgbyA9ICJBY2Nlc3NUb2tlbj0iICsgdG9rZW4gKyAiJlRpbWVzdGFtcD0iICsgdGltZSArICImZmlsZUlkPSIgKyBmaWxlSWQsCiAgICAgICAgICAgICAgICAgICAgdXJsID0gcGFuLnBjc1syXSArICc/ZmlsZUlkPScgKyBmaWxlSWQ7CiAgICAgICAgICAgICAgICBpZiAoaXRlbS5zaGFyZUlkKSB7CiAgICAgICAgICAgICAgICAgICAgbyA9ICJBY2Nlc3NUb2tlbj0iICsgdG9rZW4gKyAiJlRpbWVzdGFtcD0iICsgdGltZSArICImZHQ9MSZmaWxlSWQ9IiArIGZpbGVJZCArICImc2hhcmVJZD0iICsgaXRlbS5zaGFyZUlkOwogICAgICAgICAgICAgICAgICAgIHVybCArPSAnJmR0PTEmc2hhcmVJZD0nICsgaXRlbS5zaGFyZUlkOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHNpZ24gPSBtZDUobykudG9TdHJpbmcoKTsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLmdldCh1cmwsIHsKICAgICAgICAgICAgICAgICAgICAiYWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOCIsCiAgICAgICAgICAgICAgICAgICAgInNpZ24tdHlwZSI6IDEsCiAgICAgICAgICAgICAgICAgICAgImFjY2Vzc3Rva2VuIjogdG9rZW4sCiAgICAgICAgICAgICAgICAgICAgInRpbWVzdGFtcCI6IHRpbWUsCiAgICAgICAgICAgICAgICAgICAgInNpZ25hdHVyZSI6IHNpZ24KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKHJlcy5yZXNfY29kZSA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4LAogICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFVybDogcmVzLmZpbGVEb3dubG9hZFVybAogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5lcnJvckNvZGUgPT09ICdJbnZhbGlkU2Vzc2lvbktleScpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6ICfmj5DnpLrvvJror7flhYjnmbvlvZXnvZHnm5jvvIEnCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLnJlc19jb2RlID09PSAnU2hhcmVOb3RGb3VuZEZsYXREaXInKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiAn5o+Q56S677ya6K+35YWIW+i9rOWtmF3mlofku7bvvIzwn5GJ5YmN5b6AW+aIkeeahOe9keebmF3kuK3kuIvovb3vvIEnCiAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiAn6I635Y+W5LiL6L295Zyw5Z2A5aSx6LSl77yM6K+35Yi35paw6YeN6K+V77yBJwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6ICfojrflj5bkuIvovb3lnLDlnYDlpLHotKXvvIzor7fliLfmlrDph43or5XvvIEnCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZ2V0UENTTGluaygpIHsKICAgICAgICAgICAgc2VsZWN0TGlzdCA9IHRoaXMuZ2V0U2VsZWN0ZWRMaXN0KCk7CiAgICAgICAgICAgIGlmIChzZWxlY3RMaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+WFiOWLvumAieimgeS4i+i9veeahOaWh+S7tu+8gScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0aGlzLmlzT25seUZvbGRlcigpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35omT5byA5paH5Lu25aS55ZCO5Yu+6YCJ5paH5Lu277yBJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IHRva2VuID0gYmFzZS5nZXRTdG9yYWdlKCdhY2Nlc3NUb2tlbicpIHx8IGF3YWl0IHRoaXMuZ2V0VG9rZW4oKTsKICAgICAgICAgICAgaWYgKCF0b2tlbikgewogICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+WFiOeZu+W9lee9keebmO+8gScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBxdWV1ZSA9IFtdOwogICAgICAgICAgICBzZWxlY3RMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICBxdWV1ZS5wdXNoKHRoaXMuZ2V0RmlsZVVybEJ5T25jZShpdGVtLCBpbmRleCwgdG9rZW4pKTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBQcm9taXNlLmFsbChxdWV1ZSk7CiAgICAgICAgICAgIHJlcy5mb3JFYWNoKHZhbCA9PiB7CiAgICAgICAgICAgICAgICBzZWxlY3RMaXN0W3ZhbC5pbmRleF0uZG93bmxvYWRVcmwgPSB2YWwuZG93bmxvYWRVcmw7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgbGV0IGh0bWwgPSB0aGlzLmdlbmVyYXRlRG9tKHNlbGVjdExpc3QpOwogICAgICAgICAgICB0aGlzLnNob3dNYWluRGlhbG9nKHBhblttb2RlXVswXSwgaHRtbCwgcGFuW21vZGVdWzFdKTsKICAgICAgICB9LAoKICAgICAgICBnZW5lcmF0ZURvbShsaXN0KSB7CiAgICAgICAgICAgIGxldCBjb250ZW50ID0gJzxkaXYgY2xhc3M9InBsLW1haW4iPic7CiAgICAgICAgICAgIGxldCBhbGlua0FsbFRleHQgPSAnJzsKICAgICAgICAgICAgbGlzdC5mb3JFYWNoKCh2LCBpKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodi5pc0ZvbGRlcikgcmV0dXJuOwogICAgICAgICAgICAgICAgbGV0IGZpbGVuYW1lID0gdi5maWxlTmFtZTsKICAgICAgICAgICAgICAgIGxldCBzaXplID0gYmFzZS5zaXplRm9ybWF0KHYuc2l6ZSk7CiAgICAgICAgICAgICAgICBsZXQgZGxpbmsgPSB2LmRvd25sb2FkVXJsOwogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcGknKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcGkiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9IiBkYXRhLWluZGV4PSIke2l9Ij4ke2RsaW5rfTwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcmlhJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0FyaWEoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmFyaWEyY+mTvuaOpSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JwYycpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstcnBjIHBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1pbmZvIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2RsaW5rfSI+PGVtIGNsYXNzPSJpY29uIGljb24tZGV2aWNlIj48L2VtPjxzcGFuIHN0eWxlPSJtYXJnaW4tbGVmdDogNXB4OyI+5o6o6YCB5YiwIFJQQyDkuIvovb3lmag8L3NwYW4+PC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnY3VybCcpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9DdXJsKGRsaW5rLCBmaWxlbmFtZSwgbmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgICAgICAgICAgICAgICAgICAgYWxpbmtBbGxUZXh0ICs9IGFsaW5rICsgJ1xyXG4nOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstYXJpYSIgaHJlZj0iJHthbGlua30iIHRpdGxlPSLngrnlh7vlpI3liLZjdXJs6ZO+5o6lIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYmMnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQkMoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayIgaHJlZj0iJHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfSIgdGl0bGU9IueCueWHu+eUqOavlOeJueW9l+aYn+S4i+i9vSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb250ZW50ICs9ICc8L2Rpdj4nOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FyaWEnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdycGMnKSB7CiAgICAgICAgICAgICAgICBsZXQgcnBjID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJykgKyAnOicgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JykgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wYXRoJyk7CiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItc2VuZC1ycGMiPuWPkemAgeWFqOmDqOmTvuaOpTwvYnV0dG9uPjxidXR0b24gdGl0bGU9IiR7cnBjfSIgY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi13YXJuaW5nIGxpc3RlbmVyLW9wZW4tc2V0dGluZyIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4Ij7orr7nva4gUlBDIOWPguaVsO+8iOW9k+WJjeS4uu+8miR7cnBjfe+8iTwvYnV0dG9uPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1zdWNjZXNzIGxpc3RlbmVyLXJwYy10YXNrIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7ZGlzcGxheTogbm9uZSI+5p+l55yL5LiL6L295Lu75YqhPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2N1cmwnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXdhcm5pbmcgbGlzdGVuZXItb3Blbi1zZXR0aW5nIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7Ij7orr7nva7nu4jnq6/nsbvlnovvvIjlvZPliY3kuLrvvJoke3Rlcm1pbmFsVHlwZVtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnKV1977yJPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgc2VuZExpbmtUb1JQQyhmaWxlbmFtZSwgbGluaykgewogICAgICAgICAgICBsZXQgcnBjID0gewogICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIHBhdGg6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKSwKICAgICAgICAgICAgICAgIHRva2VuOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpLAogICAgICAgICAgICAgICAgZGlyOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kaXInKSwKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGxldCB1cmwgPSBgJHtycGMuZG9tYWlufToke3JwYy5wb3J0fSR7cnBjLnBhdGh9YDsKICAgICAgICAgICAgbGV0IHJwY0RhdGEgPSB7CiAgICAgICAgICAgICAgICBpZDogbmV3IERhdGUoKS5nZXRUaW1lKCksCiAgICAgICAgICAgICAgICBqc29ucnBjOiAnMi4wJywKICAgICAgICAgICAgICAgIG1ldGhvZDogJ2FyaWEyLmFkZFVyaScsCiAgICAgICAgICAgICAgICBwYXJhbXM6IFtgdG9rZW46JHtycGMudG9rZW59YCwgW2xpbmtdLCB7CiAgICAgICAgICAgICAgICAgICAgZGlyOiBycGMuZGlyLAogICAgICAgICAgICAgICAgICAgIG91dDogZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBbXQogICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QodXJsLCBycGNEYXRhLCB7fSwgJycpOwogICAgICAgICAgICAgICAgaWYgKHJlcy5yZXN1bHQpIHJldHVybiAnc3VjY2Vzcyc7CiAgICAgICAgICAgICAgICByZXR1cm4gJ2ZhaWwnOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJ2ZhaWwnOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZ2V0U2VsZWN0ZWRMaXN0KCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgcmV0dXJuIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5jLWZpbGUtbGlzdCIpLl9fdnVlX18uc2VsZWN0ZWRMaXN0OwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gW2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIi5pbmZvLWRldGFpbCIpLl9fdnVlX18uZmlsZURldGFpbF07CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBkZXRlY3RQYWdlKCkgewogICAgICAgICAgICBsZXQgcGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgICBpZiAoL15cL3dlYlwvbWFpbi8udGVzdChwYXRoKSkgcmV0dXJuICdob21lJzsKICAgICAgICAgICAgaWYgKC9eXC93ZWJcL3NoYXJlLy50ZXN0KHBhdGgpKSByZXR1cm4gJ3NoYXJlJzsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0sCgogICAgICAgIGlzT25seUZvbGRlcigpIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgICBpZiAoIXNlbGVjdExpc3RbaV0uaXNGb2xkZXIpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9LAoKICAgICAgICBzaG93TWFpbkRpYWxvZyh0aXRsZSwgaHRtbCwgZm9vdGVyKSB7CiAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICB0aXRsZSwKICAgICAgICAgICAgICAgIGh0bWwsCiAgICAgICAgICAgICAgICBmb290ZXIsCiAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q2xvc2VCdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcCcsCiAgICAgICAgICAgICAgICB3aWR0aCwKICAgICAgICAgICAgICAgIHBhZGRpbmc6ICcxNXB4IDIwcHggNXB4JywKICAgICAgICAgICAgICAgIGN1c3RvbUNsYXNzLAogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBpbml0UGFuTGlua2VyKCkgewogICAgICAgICAgICBiYXNlLmluaXREZWZhdWx0Q29uZmlnKCk7CiAgICAgICAgICAgIGJhc2UuYWRkUGFuTGlua2VyU3R5bGUoKTsKICAgICAgICAgICAgcHQgPSB0aGlzLmRldGVjdFBhZ2UoKTsKICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdAogICAgICAgICAgICAoYGh0dHBzOi8vYXBpLnlvdXhpYW9ob3UuY29tL2NvbmZpZy92Mi90aWFueWk/dmVyPSR7dmVyc2lvbn0mYT0ke2F1dGhvcn1gLCB7fSwge30sICd0ZXh0Jyk7CiAgICAgICAgICAgIHBhbiA9IEpTT04ucGFyc2UoYmFzZS5kKHJlcykpOwogICAgICAgICAgICBPYmplY3QuZnJlZXplICYmIE9iamVjdC5mcmVlemUocGFuKTsKICAgICAgICAgICAgcGFuLm51bSA9PT0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19pbml0X2NvZGUnKSB8fAogICAgICAgICAgICBwYW4ubGljZW5zZSA9PT0gYmFzZS5nZXRWYWx1ZSgnbGljZW5zZScpID8gdGhpcy5hZGRCdXR0b24oKSA6IHRoaXMuYWRkSW5pdEJ1dHRvbigpOwogICAgICAgICAgICB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgIGJhc2UuY3JlYXRlVGlwKCk7CiAgICAgICAgICAgIGJhc2UucmVnaXN0ZXJNZW51Q29tbWFuZCgpOwogICAgICAgIH0KICAgIH07CgogICAgbGV0IHh1bmxlaSA9IHsKCiAgICAgICAgY29udmVydExpbmtUb0FyaWEobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGZpbGVuYW1lID0gYmFzZS5maXhGaWxlbmFtZShmaWxlbmFtZSk7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYGFyaWEyYyAiJHtsaW5rfSIgLS1vdXQgIiR7ZmlsZW5hbWV9ImApOwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9CQyhsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgbGV0IGJjID0gYEFBLyR7ZW5jb2RlVVJJQ29tcG9uZW50KGZpbGVuYW1lKX0vP3VybD0ke2VuY29kZVVSSUNvbXBvbmVudChsaW5rKX1aWmA7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYGJjOi8vaHR0cC8ke2Jhc2UuZShiYyl9YCk7CiAgICAgICAgfSwKCiAgICAgICAgY29udmVydExpbmtUb0N1cmwobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGxldCB0ZXJtaW5hbCA9IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGVybWluYWxfdHlwZScpOwogICAgICAgICAgICBmaWxlbmFtZSA9IGJhc2UuZml4RmlsZW5hbWUoZmlsZW5hbWUpOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGAke3Rlcm1pbmFsICE9PSAnd3AnID8gJ2N1cmwnIDogJ2N1cmwuZXhlJ30gLUwgLUMgLSAiJHtsaW5rfSIgLW8gIiR7ZmlsZW5hbWV9ImApOwogICAgICAgIH0sCgogICAgICAgIGFkZFBhZ2VMaXN0ZW5lcigpIHsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcucGwtYnV0dG9uLW1vZGUnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgbW9kZSA9IGUudGFyZ2V0LmRhdGFzZXQubW9kZTsKICAgICAgICAgICAgICAgIFN3YWwuc2hvd0xvYWRpbmcoKTsKICAgICAgICAgICAgICAgIHRoaXMuZ2V0UENTTGluaygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcGknLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgJCgnI2Rvd25sb2FkSWZyYW1lJykuYXR0cignc3JjJywgZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQubGluayk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWFwaS1idG4nLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgYmFzZS5zZXRDbGlwYm9hcmQoZS50YXJnZXQuZGF0YXNldC5maWxlbmFtZSk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflpI3liLbmiJDlip8nKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1saW5rLWJjLWJ0bicsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgbWlycm9yID0gYmFzZS5nZXRNaXJyb3JMaXN0KGUudGFyZ2V0LmRhdGFzZXQuZGxpbmssIHBhbi5taXJyb3IpOwogICAgICAgICAgICAgICAgYmFzZS5zZXRDbGlwYm9hcmQobWlycm9yKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WkjeWItuaIkOWKnycpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYXJpYSwgLmxpc3RlbmVyLWNvcHktYWxsJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgIGJhc2Uuc2V0Q2xpcGJvYXJkKGRlY29kZVVSSUNvbXBvbmVudChlLnRhcmdldC5kYXRhc2V0LmxpbmspKTsKICAgICAgICAgICAgICAgICQoZS50YXJnZXQpLnRleHQoJ+WkjeWItuaIkOWKn++8jOW/q+WOu+eymOi0tOWQp++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstcnBjJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGxldCB0YXJnZXQgPSAkKGUuY3VycmVudFRhcmdldCk7CiAgICAgICAgICAgICAgICB0YXJnZXQuZmluZCgnLmljb24nKS5yZW1vdmUoKTsKICAgICAgICAgICAgICAgIHRhcmdldC5maW5kKCcucGwtbG9hZGluZycpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgdGFyZ2V0LnByZXBlbmQoYmFzZS5jcmVhdGVMb2FkaW5nKCkpOwogICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IHRoaXMuc2VuZExpbmtUb1JQQyhlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5maWxlbmFtZSwgZS5jdXJyZW50VGFyZ2V0LmRhdGFzZXQubGluayk7CiAgICAgICAgICAgICAgICBpZiAocmVzID09PSAnc3VjY2VzcycpIHsKICAgICAgICAgICAgICAgICAgICAkKCcubGlzdGVuZXItcnBjLXRhc2snKS5zaG93KCk7CiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZUNsYXNzKCdwbC1idG4tZGFuZ2VyJykuaHRtbCgn5Y+R6YCB5oiQ5Yqf77yM5b+r5Y6755yL55yL5ZCn77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQuYWRkQ2xhc3MoJ3BsLWJ0bi1kYW5nZXInKS50ZXh0KCflj5HpgIHlpLHotKXvvIzor7fmo4Dmn6XmgqjnmoRSUEPphY3nva7kv6Hmga/vvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1zZW5kLXJwYycsIChlKSA9PiB7CiAgICAgICAgICAgICAgICAkKCcubGlzdGVuZXItbGluay1ycGMnKS5jbGljaygpOwogICAgICAgICAgICAgICAgJChlLnRhcmdldCkudGV4dCgn5Y+R6YCB5a6M5oiQ77yM5Y+R6YCB57uT5p6c6KeB5LiK5pa55oyJ6ZKu77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItb3Blbi1zZXR0aW5nJywgKCkgPT4gewogICAgICAgICAgICAgICAgYmFzZS5zaG93U2V0dGluZygpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItcnBjLXRhc2snLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgcnBjID0gSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgIGRvbWFpbjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJyksCiAgICAgICAgICAgICAgICAgICAgcG9ydDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcpLAogICAgICAgICAgICAgICAgfSksIHVybCA9IGAke3Bhbi5kfS8/cnBjPSR7YmFzZS5lKHJwYyl9IyR7YmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfdG9rZW4nKX1gOwogICAgICAgICAgICAgICAgR01fb3BlbkluVGFiKHVybCwge2FjdGl2ZTogdHJ1ZX0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBhZGRCdXR0b24oKSB7CiAgICAgICAgICAgIGlmICghcHQpIHJldHVybjsKICAgICAgICAgICAgbGV0ICR0b29sV3JhcDsKICAgICAgICAgICAgbGV0ICRidXR0b24gPSAkKGA8ZGl2IGNsYXNzPSJ4dW5sZWktYnV0dG9uIHBsLWJ1dHRvbiI+PGkgY2xhc3M9InhscGZvbnQgeGxwLWRvd25sb2FkIj48L2k+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTogMTNweDttYXJnaW4tbGVmdDogNnB4OyI+5LiL6L295Yqp5omLPC9zcGFuPjx1bCBjbGFzcz0icGwtZHJvcGRvd24tbWVudSIgc3R5bGU9InRvcDogMzRweDsiPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFwaSI+QVBJ5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcmlhIiA+QXJpYeS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0icnBjIj5SUEPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImN1cmwiPmNVUkzkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImJjIiA+QkPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIGxpc3RlbmVyLW9wZW4tc2V0dGluZyI+5Yqp5omL6K6+572uPC9saT4ke3Bhbi5jb2RlID09IDIwMCAmJiB2ZXJzaW9uIDwgcGFuLnZlcnNpb24gPyBwYW4ubmV3IDogJyd9PC91bD48L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpIHsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLmhvbWUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICAkYnV0dG9uLmNzcyh7J21hcmdpbi1yaWdodCc6ICcxMHB4J30pOwogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uc2hhcmUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24nKS5sZW5ndGggPT09IDAgJiYgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGJhc2UuY3JlYXRlRG93bmxvYWRJZnJhbWUoKTsKICAgICAgICAgICAgdGhpcy5hZGRQYWdlTGlzdGVuZXIoKTsKICAgICAgICB9LAoKICAgICAgICBhZGRJbml0QnV0dG9uKCkgewogICAgICAgICAgICBpZiAoIXB0KSByZXR1cm47CiAgICAgICAgICAgIGxldCAkdG9vbFdyYXA7CiAgICAgICAgICAgIGxldCAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0ieHVubGVpLWJ1dHRvbiBwbC1idXR0b24taW5pdCI+PGkgY2xhc3M9InhscGZvbnQgeGxwLWRvd25sb2FkIj48L2k+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTogMTNweDttYXJnaW4tbGVmdDogNnB4OyI+5LiL6L295Yqp5omLPC9zcGFuPjwvZGl2PmApOwogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJykgewogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uaG9tZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5ob21lKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uLWluaXQnKS5sZW5ndGggPT09IDAgJiYgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgewogICAgICAgICAgICAgICAgJGJ1dHRvbi5jc3MoeydtYXJnaW4tcmlnaHQnOiAnMTBweCd9KTsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLnNoYXJlLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLnNoYXJlKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uLWluaXQnKS5sZW5ndGggPT09IDAgJiYgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgICRidXR0b24uY2xpY2soKCkgPT4gYmFzZS5pbml0RGlhbG9nKCkpOwogICAgICAgIH0sCgogICAgICAgIGdldFRva2VuKCkgewogICAgICAgICAgICBsZXQgY3JlZGVudGlhbHMgPSB7fSwgY2FwdGNoYSA9IHt9OwogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxvY2FsU3RvcmFnZS5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKC9eY3JlZGVudGlhbHNfLy50ZXN0KGxvY2FsU3RvcmFnZS5rZXkoaSkpKSB7CiAgICAgICAgICAgICAgICAgICAgY3JlZGVudGlhbHMgPSBiYXNlLmdldFN0b3JhZ2UobG9jYWxTdG9yYWdlLmtleShpKSk7CiAgICAgICAgICAgICAgICAgICAgYmFzZS5zZXRTdG9yYWdlKCcnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICgvXmNhcHRjaGFfW1x3XXsxNn0vLnRlc3QobG9jYWxTdG9yYWdlLmtleShpKSkpIHsKICAgICAgICAgICAgICAgICAgICBjYXB0Y2hhID0gYmFzZS5nZXRTdG9yYWdlKGxvY2FsU3RvcmFnZS5rZXkoaSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGxldCBkZXZpY2VpZCA9IC8oXHd7MzJ9KS8uZXhlYyhiYXNlLmdldFN0b3JhZ2UoJ2RldmljZWlkJykuc3BsaXQoJywnKSlbMF07CiAgICAgICAgICAgIGxldCB0b2tlbiA9IHsKICAgICAgICAgICAgICAgIGNyZWRlbnRpYWxzLAogICAgICAgICAgICAgICAgY2FwdGNoYSwKICAgICAgICAgICAgICAgIGRldmljZWlkCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHJldHVybiB0b2tlbjsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRGaWxlVXJsQnlPbmNlKGl0ZW0sIGluZGV4LCB0b2tlbikgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKGl0ZW0uZG93bmxvYWRVcmwpIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6IGl0ZW0uZG93bmxvYWRVcmwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5nZXQocGFuLnBjc1swXSArIGl0ZW0uaWQsIHsKICAgICAgICAgICAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGAke3Rva2VuLmNyZWRlbnRpYWxzLnRva2VuX3R5cGV9ICR7dG9rZW4uY3JlZGVudGlhbHMuYWNjZXNzX3Rva2VufWAsCiAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgICAgICAgICAneC1jYXB0Y2hhLXRva2VuJzogdG9rZW4uY2FwdGNoYS50b2tlbiwKICAgICAgICAgICAgICAgICAgICAneC1kZXZpY2UtaWQnOiB0b2tlbi5kZXZpY2VpZCwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKHJlcy53ZWJfY29udGVudF9saW5rKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiByZXMud2ViX2NvbnRlbnRfbGluawogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4LAogICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFVybDogJ+iOt+WPluS4i+i9veWcsOWdgOWksei0pe+8jOivt+WIt+aWsOmHjeivle+8gScKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI55m75b2V572R55uY5ZCO5Yi35paw6aG16Z2i77yBJyk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRQQ1NMaW5rKCkgewogICAgICAgICAgICBzZWxlY3RMaXN0ID0gdGhpcy5nZXRTZWxlY3RlZExpc3QoKTsKICAgICAgICAgICAgaWYgKHNlbGVjdExpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI5Yu+6YCJ6KaB5LiL6L2955qE5paH5Lu277yBJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRoaXMuaXNPbmx5Rm9sZGVyKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7fmiZPlvIDmlofku7blpLnlkI7li77pgInmlofku7bvvIEnKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJykgewogICAgICAgICAgICAgICAgbGV0IHF1ZXVlID0gW107CiAgICAgICAgICAgICAgICBsZXQgdG9rZW4gPSB0aGlzLmdldFRva2VuKCk7CiAgICAgICAgICAgICAgICBzZWxlY3RMaXN0LmZvckVhY2goKGl0ZW0sIGluZGV4KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcXVldWUucHVzaCh0aGlzLmdldEZpbGVVcmxCeU9uY2UoaXRlbSwgaW5kZXgsIHRva2VuKSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IFByb21pc2UuYWxsKHF1ZXVlKTsKICAgICAgICAgICAgICAgIHJlcy5mb3JFYWNoKHZhbCA9PiB7CiAgICAgICAgICAgICAgICAgICAgc2VsZWN0TGlzdFt2YWwuaW5kZXhdLmRvd25sb2FkVXJsID0gdmFsLmRvd25sb2FkVXJsOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBsZXQgZGlhbG9nID0gYXdhaXQgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mbycsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IGDmj5DnpLrvvJror7flsIbmlofku7Y8c3BhbiBjbGFzcz0idGFnLWRhbmdlciI+W+S/neWtmOWIsOe9keebmF08L3NwYW4+8J+RieWJjeW+gDxzcGFuIGNsYXNzPSJ0YWctZGFuZ2VyIj5b5oiR55qE572R55uYXTwvc3Bhbj7kuK3kuIvovb3vvIFgLAogICAgICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn54K55Ye75L+d5a2YJywKICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcCcsCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGlmIChkaWFsb2cuaXNDb25maXJtZWQpIHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2F2ZVRvQ2xvdWQnKS5jbGljaygpOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgaHRtbCA9IHRoaXMuZ2VuZXJhdGVEb20oc2VsZWN0TGlzdCk7CiAgICAgICAgICAgIHRoaXMuc2hvd01haW5EaWFsb2cocGFuW21vZGVdWzBdLCBodG1sLCBwYW5bbW9kZV1bMV0pOwoKICAgICAgICB9LAoKICAgICAgICBnZW5lcmF0ZURvbShsaXN0KSB7CiAgICAgICAgICAgIGxldCBjb250ZW50ID0gJzxkaXYgY2xhc3M9InBsLW1haW4iPic7CiAgICAgICAgICAgIGxldCBhbGlua0FsbFRleHQgPSAnJzsKICAgICAgICAgICAgbGlzdC5mb3JFYWNoKCh2LCBpKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAodi5raW5kID09PSAnZHJpdmUjZm9sZGVyJykgcmV0dXJuOwogICAgICAgICAgICAgICAgbGV0IGZpbGVuYW1lID0gdi5uYW1lOwogICAgICAgICAgICAgICAgbGV0IHNpemUgPSBiYXNlLnNpemVGb3JtYXQoK3Yuc2l6ZSk7CiAgICAgICAgICAgICAgICBsZXQgZGxpbmsgPSB2LmRvd25sb2FkVXJsOwogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcGknKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcGkiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9IiBkYXRhLWluZGV4PSIke2l9Ij4ke2RsaW5rfTwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLWJ0biBsaXN0ZW5lci1saW5rLWFwaS1idG4iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9Ij7lpI3liLbmlofku7blkI08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcmlhJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0FyaWEoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmFyaWEyY+mTvuaOpSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JwYycpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstcnBjIHBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1pbmZvIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2RsaW5rfSI+PGVtIGNsYXNzPSJpY29uIGljb24tZGV2aWNlIj48L2VtPjxzcGFuIHN0eWxlPSJtYXJnaW4tbGVmdDogNXB4OyI+5o6o6YCB5YiwIFJQQyDkuIvovb3lmag8L3NwYW4+PC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnY3VybCcpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9DdXJsKGRsaW5rLCBmaWxlbmFtZSwgbmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgICAgICAgICAgICAgICAgICAgYWxpbmtBbGxUZXh0ICs9IGFsaW5rICsgJ1xyXG4nOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstYXJpYSIgaHJlZj0iJHthbGlua30iIHRpdGxlPSLngrnlh7vlpI3liLZjdXJs6ZO+5o6lIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYmMnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQkMoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayIgaHJlZj0iJHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfSIgdGl0bGU9IueCueWHu+eUqOavlOeJueW9l+aYn+S4i+i9vSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tYnRuIGxpc3RlbmVyLWxpbmstYmMtYnRuIiBkYXRhLWRsaW5rPSIke2RsaW5rfSI+5aSN5Yi26ZWc5YOP5Zyw5Z2APC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnRlbnQgKz0gJzwvZGl2Pic7CiAgICAgICAgICAgIGlmIChtb2RlID09PSAnYXJpYScpCiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItY29weS1hbGwiIGRhdGEtbGluaz0iJHthbGlua0FsbFRleHR9Ij7lpI3liLblhajpg6jpk77mjqU8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JwYycpIHsKICAgICAgICAgICAgICAgIGxldCBycGMgPSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSArICc6JyArIGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSArIGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKTsKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1zZW5kLXJwYyI+5Y+R6YCB5YWo6YOo6ZO+5o6lPC9idXR0b24+PGJ1dHRvbiB0aXRsZT0iJHtycGN9IiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXdhcm5pbmcgbGlzdGVuZXItb3Blbi1zZXR0aW5nIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHgiPuiuvue9riBSUEMg5Y+C5pWw77yI5b2T5YmN5Li677yaJHtycGN977yJPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXN1Y2Nlc3MgbGlzdGVuZXItcnBjLXRhc2siIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweDtkaXNwbGF5OiBub25lIj7mn6XnnIvkuIvovb3ku7vliqE8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChtb2RlID09PSAnY3VybCcpCiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItY29weS1hbGwiIGRhdGEtbGluaz0iJHthbGlua0FsbFRleHR9Ij7lpI3liLblhajpg6jpk77mjqU8L2J1dHRvbj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4td2FybmluZyBsaXN0ZW5lci1vcGVuLXNldHRpbmciIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweDsiPuiuvue9rue7iOerr+exu+Wei++8iOW9k+WJjeS4uu+8miR7dGVybWluYWxUeXBlW2Jhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfdGVybWluYWxfdHlwZScpXX3vvIk8L2J1dHRvbj48L2Rpdj5gOwogICAgICAgICAgICByZXR1cm4gY29udGVudDsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBzZW5kTGlua1RvUlBDKGZpbGVuYW1lLCBsaW5rKSB7CiAgICAgICAgICAgIGxldCBycGMgPSB7CiAgICAgICAgICAgICAgICBkb21haW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpLAogICAgICAgICAgICAgICAgcG9ydDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcpLAogICAgICAgICAgICAgICAgcGF0aDogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcGF0aCcpLAogICAgICAgICAgICAgICAgdG9rZW46IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3Rva2VuJyksCiAgICAgICAgICAgICAgICBkaXI6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RpcicpLAogICAgICAgICAgICB9OwoKICAgICAgICAgICAgbGV0IHVybCA9IGAke3JwYy5kb21haW59OiR7cnBjLnBvcnR9JHtycGMucGF0aH1gOwogICAgICAgICAgICBsZXQgcnBjRGF0YSA9IHsKICAgICAgICAgICAgICAgIGlkOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKICAgICAgICAgICAgICAgIGpzb25ycGM6ICcyLjAnLAogICAgICAgICAgICAgICAgbWV0aG9kOiAnYXJpYTIuYWRkVXJpJywKICAgICAgICAgICAgICAgIHBhcmFtczogW2B0b2tlbjoke3JwYy50b2tlbn1gLCBbbGlua10sIHsKICAgICAgICAgICAgICAgICAgICBkaXI6IHJwYy5kaXIsCiAgICAgICAgICAgICAgICAgICAgb3V0OiBmaWxlbmFtZSwKICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IFtdCiAgICAgICAgICAgICAgICB9XQogICAgICAgICAgICB9OwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdCh1cmwsIHJwY0RhdGEsIHt9LCAnJyk7CiAgICAgICAgICAgICAgICBpZiAocmVzLnJlc3VsdCkgcmV0dXJuICdzdWNjZXNzJzsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBnZXRTZWxlY3RlZExpc3QoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgZG9tcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5Tb3VyY2VMaXN0SXRlbV9faXRlbS0tWHhwT0MnKTsKICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZExpc3QgPSBbXTsKICAgICAgICAgICAgICAgIGZvciAobGV0IGRvbSBvZiBkb21zKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGRvbVZ1ZSA9IGRvbS5fX3Z1ZV9fOwogICAgICAgICAgICAgICAgICAgIGlmIChkb21WdWUuc2VsZWN0ZWQuaW5jbHVkZXMoZG9tVnVlLmluZm8uaWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkTGlzdC5wdXNoKGRvbVZ1ZS5pbmZvKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRMaXN0OwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBkZXRlY3RQYWdlKCkgewogICAgICAgICAgICBsZXQgcGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgICBpZiAoL15cLyQvLnRlc3QocGF0aCkpIHJldHVybiAnaG9tZSc7CiAgICAgICAgICAgIGlmICgvXlwvKHN8c2hhcmUpXC8vLnRlc3QocGF0aCkpIHJldHVybiAnc2hhcmUnOwogICAgICAgICAgICByZXR1cm4gJyc7CiAgICAgICAgfSwKCiAgICAgICAgaXNPbmx5Rm9sZGVyKCkgewogICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlbGVjdExpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIGlmIChzZWxlY3RMaXN0W2ldLmtpbmQgPT09ICdkcml2ZSNmaWxlJykgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCgogICAgICAgIHNob3dNYWluRGlhbG9nKHRpdGxlLCBodG1sLCBmb290ZXIpIHsKICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlLAogICAgICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgICAgIGZvb3RlciwKICAgICAgICAgICAgICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgICAgIHdpZHRoLAogICAgICAgICAgICAgICAgcGFkZGluZzogJzE1cHggMjBweCA1cHgnLAogICAgICAgICAgICAgICAgY3VzdG9tQ2xhc3MsCiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGluaXRQYW5MaW5rZXIoKSB7CiAgICAgICAgICAgIGJhc2UuaW5pdERlZmF1bHRDb25maWcoKTsKICAgICAgICAgICAgYmFzZS5hZGRQYW5MaW5rZXJTdHlsZSgpOwogICAgICAgICAgICBwdCA9IHRoaXMuZGV0ZWN0UGFnZSgpOwogICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0CiAgICAgICAgICAgIChgaHR0cHM6Ly9hcGkueW91eGlhb2hvdS5jb20vY29uZmlnL3YyL3h1bmxlaT92ZXI9JHt2ZXJzaW9ufSZhPSR7YXV0aG9yfWAsIHt9LCB7fSwgJ3RleHQnKTsKICAgICAgICAgICAgcGFuID0gSlNPTi5wYXJzZShiYXNlLmQocmVzKSk7CiAgICAgICAgICAgIE9iamVjdC5mcmVlemUgJiYgT2JqZWN0LmZyZWV6ZShwYW4pOwogICAgICAgICAgICBwYW4ubnVtID09PSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX2luaXRfY29kZScpIHx8CiAgICAgICAgICAgIHBhbi5saWNlbnNlID09PSBiYXNlLmdldFZhbHVlKCdsaWNlbnNlJykgPyB0aGlzLmFkZEJ1dHRvbigpIDogdGhpcy5hZGRJbml0QnV0dG9uKCk7CiAgICAgICAgICAgIGJhc2UuY3JlYXRlVGlwKCk7CiAgICAgICAgICAgIGJhc2UucmVnaXN0ZXJNZW51Q29tbWFuZCgpOwogICAgICAgIH0KICAgIH07CgogICAgbGV0IHF1YXJrID0gewoKICAgICAgICBjb252ZXJ0TGlua1RvQXJpYShsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgZmlsZW5hbWUgPSBiYXNlLmZpeEZpbGVuYW1lKGZpbGVuYW1lKTsKICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgYXJpYTJjICIke2xpbmt9IiAtLW91dCAiJHtmaWxlbmFtZX0iIC0taGVhZGVyICJDb29raWU6ICR7ZG9jdW1lbnQuY29va2llfSJgKTsKICAgICAgICB9LAoKICAgICAgICBjb252ZXJ0TGlua1RvQkMobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGxldCBiYyA9IGBBQS8ke2VuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZSl9Lz91cmw9JHtlbmNvZGVVUklDb21wb25lbnQobGluayl9JmNvb2tpZT0ke2VuY29kZVVSSUNvbXBvbmVudChkb2N1bWVudC5jb29raWUpfVpaYDsKICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgYmM6Ly9odHRwLyR7YmFzZS5lKGJjKX1gKTsKICAgICAgICB9LAoKICAgICAgICBjb252ZXJ0TGlua1RvQ3VybChsaW5rLCBmaWxlbmFtZSwgdWEpIHsKICAgICAgICAgICAgbGV0IHRlcm1pbmFsID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190ZXJtaW5hbF90eXBlJyk7CiAgICAgICAgICAgIGZpbGVuYW1lID0gYmFzZS5maXhGaWxlbmFtZShmaWxlbmFtZSk7CiAgICAgICAgICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoYCR7dGVybWluYWwgIT09ICd3cCcgPyAnY3VybCcgOiAnY3VybC5leGUnfSAtTCAtQyAtICIke2xpbmt9IiAtbyAiJHtmaWxlbmFtZX0iIC1iICIke2RvY3VtZW50LmNvb2tpZX0iYCk7CiAgICAgICAgfSwKCiAgICAgICAgYWRkUGFnZUxpc3RlbmVyKCkgewogICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIGFzeW5jIChlKSA9PiB7CiAgICAgICAgICAgICAgICBsZXQgaG9tZSA9ICdodHRwczovL3Bhbi5xdWFyay5jbi9saXN0Iy8nLCBhbGwgPSAnaHR0cHM6Ly9wYW4ucXVhcmsuY24vbGlzdCMvbGlzdC9hbGwnOwogICAgICAgICAgICAgICAgaWYgKGUub2xkVVJMID09PSBob21lICYmIGUubmV3VVJMID09PSBhbGwpIHJldHVybjsKICAgICAgICAgICAgICAgIGF3YWl0IGJhc2Uuc2xlZXAoMTUwKTsKICAgICAgICAgICAgICAgIGlmICgkKCcucXVhcmstYnV0dG9uJykubGVuZ3RoID4gMCkgcmV0dXJuOwogICAgICAgICAgICAgICAgcGFuLm51bSA9PT0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19pbml0X2NvZGUnKSB8fAogICAgICAgICAgICAgICAgcGFuLmxpY2Vuc2UgPT09IGJhc2UuZ2V0VmFsdWUoJ2xpY2Vuc2UnKSA/IHRoaXMuYWRkQnV0dG9uKCkgOiB0aGlzLmFkZEluaXRCdXR0b24oKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLnBsLWJ1dHRvbi1tb2RlJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIG1vZGUgPSBlLnRhcmdldC5kYXRhc2V0Lm1vZGU7CiAgICAgICAgICAgICAgICBTd2FsLnNob3dMb2FkaW5nKCk7CiAgICAgICAgICAgICAgICB0aGlzLmdldFBDU0xpbmsoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYXBpJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICQoJyNkb3dubG9hZElmcmFtZScpLmF0dHIoJ3NyYycsIGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmxpbmspOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcmlhLCAubGlzdGVuZXItY29weS1hbGwnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgYmFzZS5zZXRDbGlwYm9hcmQoZGVjb2RlVVJJQ29tcG9uZW50KGUudGFyZ2V0LmRhdGFzZXQubGluaykpOwogICAgICAgICAgICAgICAgJChlLnRhcmdldCkudGV4dCgn5aSN5Yi25oiQ5Yqf77yM5b+r5Y6757KY6LS05ZCn77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1ycGMnLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgbGV0IHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTsKICAgICAgICAgICAgICAgIHRhcmdldC5maW5kKCcuaWNvbicpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5wbC1sb2FkaW5nJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQucHJlcGVuZChiYXNlLmNyZWF0ZUxvYWRpbmcoKSk7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy5zZW5kTGlua1RvUlBDKGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmZpbGVuYW1lLCBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5saW5rKTsKICAgICAgICAgICAgICAgIGlmIChyZXMgPT09ICdzdWNjZXNzJykgewogICAgICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1ycGMtdGFzaycpLnNob3coKTsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQucmVtb3ZlQ2xhc3MoJ3BsLWJ0bi1kYW5nZXInKS5odG1sKCflj5HpgIHmiJDlip/vvIzlv6vljrvnnIvnnIvlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRhcmdldC5hZGRDbGFzcygncGwtYnRuLWRhbmdlcicpLnRleHQoJ+WPkemAgeWksei0pe+8jOivt+ajgOafpeaCqOeahFJQQ+mFjee9ruS/oeaBr++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXNlbmQtcnBjJywgKGUpID0+IHsKICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1saW5rLXJwYycpLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflj5HpgIHlrozmiJDvvIzlj5HpgIHnu5Pmnpzop4HkuIrmlrnmjInpkq7vvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1vcGVuLXNldHRpbmcnLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNob3dTZXR0aW5nKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1ycGMtdGFzaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGxldCBycGMgPSBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgICAgICBwb3J0OiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JyksCiAgICAgICAgICAgICAgICB9KSwgdXJsID0gYCR7cGFuLmR9Lz9ycGM9JHtiYXNlLmUocnBjKX0jJHtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpfWA7CiAgICAgICAgICAgICAgICBHTV9vcGVuSW5UYWIodXJsLCB7YWN0aXZlOiB0cnVlfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFkZEJ1dHRvbigpIHsKICAgICAgICAgICAgaWYgKCFwdCkgcmV0dXJuOwogICAgICAgICAgICBsZXQgJHRvb2xXcmFwOwogICAgICAgICAgICBsZXQgJGJ1dHRvbiA9ICQoYDxkaXYgY2xhc3M9InF1YXJrLWJ1dHRvbiBwbC1idXR0b24iPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgc3Ryb2tlPSIjNTU1IiBzdHJva2Utd2lkdGg9IjIiPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgZD0iTTkgMTJsMiAyIDItMnoiLz48cGF0aCBkPSJNMTQgOGgxLjU1M2MuODUgMCAxLjE2LjA5MyAxLjQ3LjI2Ny4zMTEuMTc0LjU1Ni40My43MjIuNzU2LjE2Ni4zMjYuMjU1LjY1LjI1NSAxLjU0djQuODczYzAgLjg5Mi0uMDg5IDEuMjE1LS4yNTUgMS41NC0uMTY2LjMyNy0uNDEuNTgzLS43MjIuNzU3LS4zMS4xNzQtLjYyLjI2Ny0xLjQ3LjI2N0g2LjQ0N2MtLjg1IDAtMS4xNi0uMDkzLTEuNDctLjI2N2ExLjc3OCAxLjc3OCAwIDAxLS43MjItLjc1NmMtLjE2Ni0uMzI2LS4yNTUtLjY1LS4yNTUtMS41NHYtNC44NzNjMC0uODkyLjA4OS0xLjIxNS4yNTUtMS41NC4xNjYtLjMyNy40MS0uNTgzLjcyMi0uNzU3LjMxLS4xNzQuNjItLjI2NyAxLjQ3LS4yNjdIMTEiLz48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGQ9Ik0xMSAzdjEwIi8+PC9nPjwvc3ZnPjxiPuS4i+i9veWKqeaJizwvYj48dWwgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUiPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImFwaSI+QVBJ5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcmlhIiA+QXJpYeS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0icnBjIj5SUEPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImN1cmwiPmNVUkzkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9ImJjIiA+QkPkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIGxpc3RlbmVyLW9wZW4tc2V0dGluZyI+5Yqp5omL6K6+572uPC9saT4ke3Bhbi5jb2RlID09IDIwMCAmJiB2ZXJzaW9uIDwgcGFuLnZlcnNpb24gPyBwYW4ubmV3IDogJyd9PC91bD48L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpIHsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLmhvbWUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgewogICAgICAgICAgICAgICAgJGJ1dHRvbi5jc3MoeydtYXJnaW4tcmlnaHQnOiAnMTBweCd9KTsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLnNoYXJlLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLnNoYXJlKTsKICAgICAgICAgICAgICAgICAgICAkKCcucGwtYnV0dG9uJykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBhZGRJbml0QnV0dG9uKCkgewogICAgICAgICAgICBpZiAoIXB0KSByZXR1cm47CiAgICAgICAgICAgIGxldCAkdG9vbFdyYXA7CiAgICAgICAgICAgIGxldCAkYnV0dG9uID0gJChgPGRpdiBjbGFzcz0icXVhcmstYnV0dG9uIHBsLWJ1dHRvbi1pbml0Ij48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZT0iIzU1NSIgc3Ryb2tlLXdpZHRoPSIyIj48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIGQ9Ik05IDEybDIgMiAyLTJ6Ii8+PHBhdGggZD0iTTE0IDhoMS41NTNjLjg1IDAgMS4xNi4wOTMgMS40Ny4yNjcuMzExLjE3NC41NTYuNDMuNzIyLjc1Ni4xNjYuMzI2LjI1NS42NS4yNTUgMS41NHY0Ljg3M2MwIC44OTItLjA4OSAxLjIxNS0uMjU1IDEuNTQtLjE2Ni4zMjctLjQxLjU4My0uNzIyLjc1Ny0uMzEuMTc0LS42Mi4yNjctMS40Ny4yNjdINi40NDdjLS44NSAwLTEuMTYtLjA5My0xLjQ3LS4yNjdhMS43NzggMS43NzggMCAwMS0uNzIyLS43NTZjLS4xNjYtLjMyNi0uMjU1LS42NS0uMjU1LTEuNTR2LTQuODczYzAtLjg5Mi4wODktMS4yMTUuMjU1LTEuNTQuMTY2LS4zMjcuNDEtLjU4My43MjItLjc1Ny4zMS0uMTc0LjYyLS4yNjcgMS40Ny0uMjY3SDExIi8+PHBhdGggc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBkPSJNMTEgM3YxMCIvPjwvZz48L3N2Zz48Yj7kuIvovb3liqnmiYs8L2I+PC9kaXY+YCk7CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ2hvbWUnKSB7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5ob21lLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLmhvbWUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24taW5pdCcpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHB0ID09PSAnc2hhcmUnKSB7CiAgICAgICAgICAgICAgICAkYnV0dG9uLmNzcyh7J21hcmdpbi1yaWdodCc6ICcxMHB4J30pOwogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uc2hhcmUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24taW5pdCcpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGJ1dHRvbi5jbGljaygoKSA9PiBiYXNlLmluaXREaWFsb2coKSk7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZ2V0UENTTGluaygpIHsKICAgICAgICAgICAgc2VsZWN0TGlzdCA9IHRoaXMuZ2V0U2VsZWN0ZWRMaXN0KCk7CiAgICAgICAgICAgIGlmIChzZWxlY3RMaXN0Lmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UuZXJyb3IoJ+aPkOekuu+8muivt+WFiOWLvumAieimgeS4i+i9veeahOaWh+S7tu+8gScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh0aGlzLmlzT25seUZvbGRlcigpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35omT5byA5paH5Lu25aS55ZCO5Yu+6YCJ5paH5Lu277yBJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IGZpZHMgPSBbXTsKICAgICAgICAgICAgc2VsZWN0TGlzdC5mb3JFYWNoKHZhbCA9PiB7CiAgICAgICAgICAgICAgICBmaWRzLnB1c2godmFsLmZpZCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBpZiAocHQgPT09ICdob21lJykgewogICAgICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdChwYW4ucGNzWzBdLCB7CiAgICAgICAgICAgICAgICAgICAgImZpZHMiOiBmaWRzCiAgICAgICAgICAgICAgICB9LCB7ImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uO2NoYXJzZXQ9dXRmLTgiLCAidXNlci1hZ2VudCI6IHBhbi51YX0pOwogICAgICAgICAgICAgICAgaWYgKHJlcy5jb2RlID09PSAzMTAwMSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7flhYjnmbvlvZXnvZHnm5jvvIEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChyZXMuY29kZSAhPT0gMCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJrojrflj5bpk77mjqXlpLHotKXvvIEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGxldCBodG1sID0gdGhpcy5nZW5lcmF0ZURvbShyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICB0aGlzLnNob3dNYWluRGlhbG9nKHBhblttb2RlXVswXSwgaHRtbCwgcGFuW21vZGVdWzFdKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGxldCBkaWFsb2cgPSBhd2FpdCBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgICAgIHRvYXN0OiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvJywKICAgICAgICAgICAgICAgICAgICB0aXRsZTogYOaPkOekuu+8muivt+WwhuaWh+S7tjxzcGFuIGNsYXNzPSJ0YWctZGFuZ2VyIj5b5L+d5a2Y5Yiw572R55uYXTwvc3Bhbj7wn5GJ5YmN5b6APHNwYW4gY2xhc3M9InRhZy1kYW5nZXIiPlvmiJHnmoTnvZHnm5hdPC9zcGFuPuS4reS4i+i9ve+8gWAsCiAgICAgICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfngrnlh7vkv53lrZgnLAogICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgaWYgKGRpYWxvZy5pc0NvbmZpcm1lZCkgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWluZm9fcicpLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgZ2VuZXJhdGVEb20obGlzdCkgewogICAgICAgICAgICBsZXQgY29udGVudCA9ICc8ZGl2IGNsYXNzPSJwbC1tYWluIj4nOwogICAgICAgICAgICBsZXQgYWxpbmtBbGxUZXh0ID0gJyc7CiAgICAgICAgICAgIGxpc3QuZm9yRWFjaCgodiwgaSkgPT4gewogICAgICAgICAgICAgICAgaWYgKHYuZmlsZSA9PT0gZmFsc2UpIHJldHVybjsKICAgICAgICAgICAgICAgIGxldCBmaWxlbmFtZSA9IHYuZmlsZV9uYW1lOwogICAgICAgICAgICAgICAgbGV0IGZpZCA9IHYuZmlkOwogICAgICAgICAgICAgICAgbGV0IHNpemUgPSBiYXNlLnNpemVGb3JtYXQodi5zaXplKTsKICAgICAgICAgICAgICAgIGxldCBkbGluayA9IHYuZG93bmxvYWRfdXJsOwogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcGknKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcGkiIGRhdGEtZmlkPSIke2ZpZH0iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7ZGxpbmt9IiBkYXRhLWluZGV4PSIke2l9Ij4ke2RsaW5rfTwvYT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcmlhJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0FyaWEoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBhbGlua0FsbFRleHQgKz0gYWxpbmsgKyAnXHJcbic7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsgbGlzdGVuZXItbGluay1hcmlhIiBocmVmPSIke2FsaW5rfSIgdGl0bGU9IueCueWHu+WkjeWItmFyaWEyY+mTvuaOpSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ3JwYycpIHsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGJ1dHRvbiBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstcnBjIHBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1pbmZvIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2RsaW5rfSI+PGVtIGNsYXNzPSJpY29uIGljb24tZGV2aWNlIj48L2VtPjxzcGFuIHN0eWxlPSJtYXJnaW4tbGVmdDogNXB4OyI+5o6o6YCB5YiwIFJQQyDkuIvovb3lmag8L3NwYW4+PC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnY3VybCcpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9DdXJsKGRsaW5rLCBmaWxlbmFtZSwgbmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgICAgICAgICAgICAgICAgICAgYWxpbmtBbGxUZXh0ICs9IGFsaW5rICsgJ1xyXG4nOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstYXJpYSIgaHJlZj0iJHthbGlua30iIHRpdGxlPSLngrnlh7vlpI3liLZjdXJs6ZO+5o6lIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2FsaW5rfSI+JHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfTwvYT4gPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYmMnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQkMoZGxpbmssIGZpbGVuYW1lLCBuYXZpZ2F0b3IudXNlckFnZW50KTsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayIgaHJlZj0iJHtkZWNvZGVVUklDb21wb25lbnQoYWxpbmspfSIgdGl0bGU9IueCueWHu+eUqOavlOeJueW9l+aYn+S4i+i9vSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb250ZW50ICs9ICc8L2Rpdj4nOwogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2FyaWEnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdycGMnKSB7CiAgICAgICAgICAgICAgICBsZXQgcnBjID0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJykgKyAnOicgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JykgKyBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wYXRoJyk7CiAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1leHRyYSI+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgbGlzdGVuZXItc2VuZC1ycGMiPuWPkemAgeWFqOmDqOmTvuaOpTwvYnV0dG9uPjxidXR0b24gdGl0bGU9IiR7cnBjfSIgY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi13YXJuaW5nIGxpc3RlbmVyLW9wZW4tc2V0dGluZyIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4Ij7orr7nva4gUlBDIOWPguaVsO+8iOW9k+WJjeS4uu+8miR7cnBjfe+8iTwvYnV0dG9uPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi1zdWNjZXNzIGxpc3RlbmVyLXJwYy10YXNrIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7ZGlzcGxheTogbm9uZSI+5p+l55yL5LiL6L295Lu75YqhPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2N1cmwnKQogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLWNvcHktYWxsIiBkYXRhLWxpbms9IiR7YWxpbmtBbGxUZXh0fSI+5aSN5Yi25YWo6YOo6ZO+5o6lPC9idXR0b24+PGJ1dHRvbiBjbGFzcz0icGwtYnRuLXByaW1hcnkgcGwtYnRuLXdhcm5pbmcgbGlzdGVuZXItb3Blbi1zZXR0aW5nIiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDEwcHg7Ij7orr7nva7nu4jnq6/nsbvlnovvvIjlvZPliY3kuLrvvJoke3Rlcm1pbmFsVHlwZVtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnKV1977yJPC9idXR0b24+PC9kaXY+YDsKICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgc2VuZExpbmtUb1JQQyhmaWxlbmFtZSwgbGluaykgewogICAgICAgICAgICBsZXQgcnBjID0gewogICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgIHBvcnQ6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BvcnQnKSwKICAgICAgICAgICAgICAgIHBhdGg6IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX3BhdGgnKSwKICAgICAgICAgICAgICAgIHRva2VuOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpLAogICAgICAgICAgICAgICAgZGlyOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kaXInKSwKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIGxldCB1cmwgPSBgJHtycGMuZG9tYWlufToke3JwYy5wb3J0fSR7cnBjLnBhdGh9YDsKICAgICAgICAgICAgbGV0IHJwY0RhdGEgPSB7CiAgICAgICAgICAgICAgICBpZDogbmV3IERhdGUoKS5nZXRUaW1lKCksCiAgICAgICAgICAgICAgICBqc29ucnBjOiAnMi4wJywKICAgICAgICAgICAgICAgIG1ldGhvZDogJ2FyaWEyLmFkZFVyaScsCiAgICAgICAgICAgICAgICBwYXJhbXM6IFtgdG9rZW46JHtycGMudG9rZW59YCwgW2xpbmtdLCB7CiAgICAgICAgICAgICAgICAgICAgZGlyOiBycGMuZGlyLAogICAgICAgICAgICAgICAgICAgIG91dDogZmlsZW5hbWUsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyOiBbYENvb2tpZTogJHtkb2N1bWVudC5jb29raWV9YF0KICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0KHVybCwgcnBjRGF0YSwgeyJDb29raWUiOiBkb2N1bWVudC5jb29raWV9LCAnJyk7CiAgICAgICAgICAgICAgICBpZiAocmVzLnJlc3VsdCkgcmV0dXJuICdzdWNjZXNzJzsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiAnZmFpbCc7CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBnZXRTZWxlY3RlZExpc3QoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRMaXN0ID0gW107CiAgICAgICAgICAgICAgICBsZXQgcmVhY3REb20gPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdmaWxlLWxpc3QnKVswXTsKICAgICAgICAgICAgICAgIGxldCByZWFjdE9iaiA9IGJhc2UuZmluZFJlYWN0KHJlYWN0RG9tKTsKICAgICAgICAgICAgICAgIGxldCBwcm9wcyA9IHJlYWN0T2JqLnByb3BzOwogICAgICAgICAgICAgICAgaWYgKHByb3BzKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGZpbGVMaXN0ID0gcHJvcHMubGlzdCB8fCBbXTsKICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRLZXlzID0gcHJvcHMuc2VsZWN0ZWRSb3dLZXlzIHx8IFtdOwogICAgICAgICAgICAgICAgICAgIGZpbGVMaXN0LmZvckVhY2goKHZhbCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRLZXlzLmluY2x1ZGVzKHZhbC5maWQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZExpc3QucHVzaCh2YWwpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRMaXN0OwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBkZXRlY3RQYWdlKCkgewogICAgICAgICAgICBsZXQgcGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgICBpZiAoL15cLyhsaXN0KS8udGVzdChwYXRoKSkgcmV0dXJuICdob21lJzsKICAgICAgICAgICAgaWYgKC9eXC8oc3xzaGFyZSlcLy8udGVzdChwYXRoKSkgcmV0dXJuICdzaGFyZSc7CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9LAoKICAgICAgICBpc09ubHlGb2xkZXIoKSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0TGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKHNlbGVjdExpc3RbaV0uZmlsZSkgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0sCgogICAgICAgIHNob3dNYWluRGlhbG9nKHRpdGxlLCBodG1sLCBmb290ZXIpIHsKICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIHRpdGxlLAogICAgICAgICAgICAgICAgaHRtbCwKICAgICAgICAgICAgICAgIGZvb3RlciwKICAgICAgICAgICAgICAgIGFsbG93T3V0c2lkZUNsaWNrOiBmYWxzZSwKICAgICAgICAgICAgICAgIHNob3dDbG9zZUJ1dHRvbjogdHJ1ZSwKICAgICAgICAgICAgICAgIHNob3dDb25maXJtQnV0dG9uOiBmYWxzZSwKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICAgICAgICAgIHdpZHRoLAogICAgICAgICAgICAgICAgcGFkZGluZzogJzE1cHggMjBweCA1cHgnLAogICAgICAgICAgICAgICAgY3VzdG9tQ2xhc3MsCiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIGluaXRQYW5MaW5rZXIoKSB7CiAgICAgICAgICAgIGJhc2UuaW5pdERlZmF1bHRDb25maWcoKTsKICAgICAgICAgICAgYmFzZS5hZGRQYW5MaW5rZXJTdHlsZSgpOwogICAgICAgICAgICBwdCA9IHRoaXMuZGV0ZWN0UGFnZSgpOwogICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0CiAgICAgICAgICAgIChgaHR0cHM6Ly9hcGkueW91eGlhb2hvdS5jb20vY29uZmlnL3YyL3F1YXJrP3Zlcj0ke3ZlcnNpb259JmE9JHthdXRob3J9YCwge30sIHt9LCAndGV4dCcpOwogICAgICAgICAgICBwYW4gPSBKU09OLnBhcnNlKGJhc2UuZChyZXMpKTsKICAgICAgICAgICAgT2JqZWN0LmZyZWV6ZSAmJiBPYmplY3QuZnJlZXplKHBhbik7CiAgICAgICAgICAgIHBhbi5udW0gPT09IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfaW5pdF9jb2RlJykgfHwKICAgICAgICAgICAgcGFuLmxpY2Vuc2UgPT09IGJhc2UuZ2V0VmFsdWUoJ2xpY2Vuc2UnKSA/IHRoaXMuYWRkQnV0dG9uKCkgOiB0aGlzLmFkZEluaXRCdXR0b24oKTsKICAgICAgICAgICAgdGhpcy5hZGRQYWdlTGlzdGVuZXIoKTsKICAgICAgICAgICAgYmFzZS5jcmVhdGVUaXAoKTsKICAgICAgICAgICAgYmFzZS5jcmVhdGVEb3dubG9hZElmcmFtZSgpOwogICAgICAgICAgICBiYXNlLnJlZ2lzdGVyTWVudUNvbW1hbmQoKTsKICAgICAgICB9CiAgICB9OwoKICAgIGxldCB5aWRvbmcgPSB7CgogICAgICAgIGNvbnZlcnRMaW5rVG9BcmlhKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBmaWxlbmFtZSA9IGJhc2UuZml4RmlsZW5hbWUoZmlsZW5hbWUpOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBhcmlhMmMgIiR7bGlua30iIC0tb3V0ICIke2ZpbGVuYW1lfSJgKTsKICAgICAgICB9LAoKICAgICAgICBjb252ZXJ0TGlua1RvQkMobGluaywgZmlsZW5hbWUsIHVhKSB7CiAgICAgICAgICAgIGxldCBiYyA9IGBBQS8ke2VuY29kZVVSSUNvbXBvbmVudChmaWxlbmFtZSl9Lz91cmw9JHtlbmNvZGVVUklDb21wb25lbnQobGluayl9WlpgOwogICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KGBiYzovL2h0dHAvJHtiYXNlLmUoYmMpfWApOwogICAgICAgIH0sCgogICAgICAgIGNvbnZlcnRMaW5rVG9DdXJsKGxpbmssIGZpbGVuYW1lLCB1YSkgewogICAgICAgICAgICBsZXQgdGVybWluYWwgPSBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3Rlcm1pbmFsX3R5cGUnKTsKICAgICAgICAgICAgZmlsZW5hbWUgPSBiYXNlLmZpeEZpbGVuYW1lKGZpbGVuYW1lKTsKICAgICAgICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChgJHt0ZXJtaW5hbCAhPT0gJ3dwJyA/ICdjdXJsJyA6ICdjdXJsLmV4ZSd9IC1MIC1DIC0gIiR7bGlua30iIC1vICIke2ZpbGVuYW1lfSJgKTsKICAgICAgICB9LAoKICAgICAgICBhZGRQYWdlTGlzdGVuZXIoKSB7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLnBsLWJ1dHRvbi1tb2RlJywgKGUpID0+IHsKICAgICAgICAgICAgICAgIG1vZGUgPSBlLnRhcmdldC5kYXRhc2V0Lm1vZGU7CiAgICAgICAgICAgICAgICBTd2FsLnNob3dMb2FkaW5nKCk7CiAgICAgICAgICAgICAgICB0aGlzLmdldFBDU0xpbmsoKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLWxpbmstYXBpJywgYXN5bmMgKGUpID0+IHsKICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgICAgICAgICQoJyNkb3dubG9hZElmcmFtZScpLmF0dHIoJ3NyYycsIGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmxpbmspOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1hcmlhLCAubGlzdGVuZXItY29weS1hbGwnLCAoZSkgPT4gewogICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgYmFzZS5zZXRDbGlwYm9hcmQoZGVjb2RlVVJJQ29tcG9uZW50KGUudGFyZ2V0LmRhdGFzZXQubGluaykpOwogICAgICAgICAgICAgICAgJChlLnRhcmdldCkudGV4dCgn5aSN5Yi25oiQ5Yqf77yM5b+r5Y6757KY6LS05ZCn77yBJykuYW5pbWF0ZSh7b3BhY2l0eTogJzAuNSd9LCAic2xvdyIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZG9jLm9uKCdjbGljaycsICcubGlzdGVuZXItbGluay1ycGMnLCBhc3luYyAoZSkgPT4gewogICAgICAgICAgICAgICAgbGV0IHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTsKICAgICAgICAgICAgICAgIHRhcmdldC5maW5kKCcuaWNvbicpLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgdGFyZ2V0LmZpbmQoJy5wbC1sb2FkaW5nJykucmVtb3ZlKCk7CiAgICAgICAgICAgICAgICB0YXJnZXQucHJlcGVuZChiYXNlLmNyZWF0ZUxvYWRpbmcoKSk7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgdGhpcy5zZW5kTGlua1RvUlBDKGUuY3VycmVudFRhcmdldC5kYXRhc2V0LmZpbGVuYW1lLCBlLmN1cnJlbnRUYXJnZXQuZGF0YXNldC5saW5rKTsKICAgICAgICAgICAgICAgIGlmIChyZXMgPT09ICdzdWNjZXNzJykgewogICAgICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1ycGMtdGFzaycpLnNob3coKTsKICAgICAgICAgICAgICAgICAgICB0YXJnZXQucmVtb3ZlQ2xhc3MoJ3BsLWJ0bi1kYW5nZXInKS5odG1sKCflj5HpgIHmiJDlip/vvIzlv6vljrvnnIvnnIvlkKfvvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRhcmdldC5hZGRDbGFzcygncGwtYnRuLWRhbmdlcicpLnRleHQoJ+WPkemAgeWksei0pe+8jOivt+ajgOafpeaCqOeahFJQQ+mFjee9ruS/oeaBr++8gScpLmFuaW1hdGUoe29wYWNpdHk6ICcwLjUnfSwgInNsb3ciKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGRvYy5vbignY2xpY2snLCAnLmxpc3RlbmVyLXNlbmQtcnBjJywgKGUpID0+IHsKICAgICAgICAgICAgICAgICQoJy5saXN0ZW5lci1saW5rLXJwYycpLmNsaWNrKCk7CiAgICAgICAgICAgICAgICAkKGUudGFyZ2V0KS50ZXh0KCflj5HpgIHlrozmiJDvvIzlj5HpgIHnu5Pmnpzop4HkuIrmlrnmjInpkq7vvIEnKS5hbmltYXRlKHtvcGFjaXR5OiAnMC41J30sICJzbG93Iik7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1vcGVuLXNldHRpbmcnLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBiYXNlLnNob3dTZXR0aW5nKCk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2Mub24oJ2NsaWNrJywgJy5saXN0ZW5lci1ycGMtdGFzaycsICgpID0+IHsKICAgICAgICAgICAgICAgIGxldCBycGMgPSBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICAgICAgICAgICAgZG9tYWluOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19kb21haW4nKSwKICAgICAgICAgICAgICAgICAgICBwb3J0OiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JyksCiAgICAgICAgICAgICAgICB9KSwgdXJsID0gYCR7cGFuLmR9Lz9ycGM9JHtiYXNlLmUocnBjKX0jJHtiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY190b2tlbicpfWA7CiAgICAgICAgICAgICAgICBHTV9vcGVuSW5UYWIodXJsLCB7YWN0aXZlOiB0cnVlfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCgogICAgICAgIGFkZEJ1dHRvbigpIHsKICAgICAgICAgICAgaWYgKCFwdCkgcmV0dXJuOwogICAgICAgICAgICBsZXQgJHRvb2xXcmFwOwogICAgICAgICAgICBsZXQgJGJ1dHRvbiA9ICQoYDxkaXYgY2xhc3M9InlpZG9uZy1idXR0b24gcGwtYnV0dG9uIj7kuIvovb3liqnmiYs8dWwgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUiIHN0eWxlPSJ0b3A6IDM2cHg7Ij48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJhcGkiPkFQSeS4i+i9vTwvbGk+PGxpIGNsYXNzPSJwbC1kcm9wZG93bi1tZW51LWl0ZW0gcGwtYnV0dG9uLW1vZGUiIGRhdGEtbW9kZT0iYXJpYSIgPkFyaWHkuIvovb08L2xpPjxsaSBjbGFzcz0icGwtZHJvcGRvd24tbWVudS1pdGVtIHBsLWJ1dHRvbi1tb2RlIiBkYXRhLW1vZGU9InJwYyI+UlBD5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJjdXJsIj5jVVJM5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSIgZGF0YS1tb2RlPSJiYyIgPkJD5LiL6L29PC9saT48bGkgY2xhc3M9InBsLWRyb3Bkb3duLW1lbnUtaXRlbSBwbC1idXR0b24tbW9kZSBsaXN0ZW5lci1vcGVuLXNldHRpbmciPuWKqeaJi+iuvue9rjwvbGk+JHtwYW4uY29kZSA9PSAyMDAgJiYgdmVyc2lvbiA8IHBhbi52ZXJzaW9uID8gcGFuLm5ldyA6ICcnfTwvdWw+PC9kaXY+YCk7CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ2hvbWUnKSB7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5ob21lLCAoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgJHRvb2xXcmFwID0gJChwYW4uYnRuLmhvbWUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24nKS5sZW5ndGggPT09IDAgJiYgJHRvb2xXcmFwLnByZXBlbmQoJGJ1dHRvbik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChwdCA9PT0gJ3NoYXJlJykgewogICAgICAgICAgICAgICAgJGJ1dHRvbi5yZW1vdmVDbGFzcygneWlkb25nLWJ1dHRvbicpLmFkZENsYXNzKCd5aWRvbmctc2hhcmUtYnV0dG9uJyk7CiAgICAgICAgICAgICAgICBiYXNlLmxpc3RlbkVsZW1lbnQocGFuLmJ0bi5zaGFyZSwgKCkgPT4gewogICAgICAgICAgICAgICAgICAgICR0b29sV3JhcCA9ICQocGFuLmJ0bi5zaGFyZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbicpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgYmFzZS5jcmVhdGVEb3dubG9hZElmcmFtZSgpOwogICAgICAgICAgICB0aGlzLmFkZFBhZ2VMaXN0ZW5lcigpOwogICAgICAgIH0sCgogICAgICAgIGFkZEluaXRCdXR0b24oKSB7CiAgICAgICAgICAgIGlmICghcHQpIHJldHVybjsKICAgICAgICAgICAgbGV0ICR0b29sV3JhcDsKICAgICAgICAgICAgbGV0ICRidXR0b24gPSAkKGA8ZGl2IGNsYXNzPSJ5aWRvbmctYnV0dG9uIHBsLWJ1dHRvbi1pbml0Ij7kuIvovb3liqnmiYs8L2Rpdj5gKTsKICAgICAgICAgICAgaWYgKHB0ID09PSAnaG9tZScpIHsKICAgICAgICAgICAgICAgIGJhc2UubGlzdGVuRWxlbWVudChwYW4uYnRuLmhvbWUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uaG9tZSk7CiAgICAgICAgICAgICAgICAgICAgJCgnLnBsLWJ1dHRvbi1pbml0JykubGVuZ3RoID09PSAwICYmICR0b29sV3JhcC5wcmVwZW5kKCRidXR0b24pOwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAocHQgPT09ICdzaGFyZScpIHsKICAgICAgICAgICAgICAgICRidXR0b24ucmVtb3ZlQ2xhc3MoJ3lpZG9uZy1idXR0b24nKS5hZGRDbGFzcygneWlkb25nLXNoYXJlLWJ1dHRvbicpOwogICAgICAgICAgICAgICAgYmFzZS5saXN0ZW5FbGVtZW50KHBhbi5idG4uc2hhcmUsICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAkdG9vbFdyYXAgPSAkKHBhbi5idG4uc2hhcmUpOwogICAgICAgICAgICAgICAgICAgICQoJy5wbC1idXR0b24taW5pdCcpLmxlbmd0aCA9PT0gMCAmJiAkdG9vbFdyYXAucHJlcGVuZCgkYnV0dG9uKTsKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGJ1dHRvbi5jbGljaygoKSA9PiBiYXNlLmluaXREaWFsb2coKSk7CiAgICAgICAgfSwKCiAgICAgICAgZ2V0UmFuZG9tU3RyaW5nKGxlbikgewogICAgICAgICAgICBsZW4gPSBsZW4gfHwgMTY7CiAgICAgICAgICAgIGxldCAkY2hhcnMgPSAnQUJDREVGR0hKS01OUFFSU1RXWFlaYWJjZGVmaGlqa21ucHJzdHd4eXoyMzQ1Njc4JzsKICAgICAgICAgICAgbGV0IG1heFBvcyA9ICRjaGFycy5sZW5ndGg7CiAgICAgICAgICAgIGxldCBwd2QgPSAnJzsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgICAgICAgICAgcHdkICs9ICRjaGFycy5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogbWF4UG9zKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHB3ZDsKICAgICAgICB9LAoKICAgICAgICB1dG9iKHN0cikgewogICAgICAgICAgICBjb25zdCB1ID0gU3RyaW5nLmZyb21DaGFyQ29kZTsKICAgICAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9bXHVEODAwLVx1REJGRl1bXHVEQzAwLVx1REZGRkZdfFteXHgwMC1ceDdGXS9nLCAodCkgPT4gewogICAgICAgICAgICAgICAgaWYgKHQubGVuZ3RoIDwgMikgewogICAgICAgICAgICAgICAgICAgIGxldCBlID0gdC5jaGFyQ29kZUF0KDApOwogICAgICAgICAgICAgICAgICAgIHJldHVybiBlIDwgMTI4ID8gdCA6IGUgPCAyMDQ4ID8gdSgxOTIgfCBlID4+PiA2KSArIHUoMTI4IHwgNjMgJiBlKSA6IHUoMjI0IHwgZSA+Pj4gMTIgJiAxNSkgKyB1KDEyOCB8IGUgPj4+IDYgJiA2MykgKyB1KDEyOCB8IDYzICYgZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlID0gNjU1MzYgKyAxMDI0ICogKHQuY2hhckNvZGVBdCgwKSAtIDU1Mjk2KSArICh0LmNoYXJDb2RlQXQoMSkgLSA1NjMyMCk7CiAgICAgICAgICAgICAgICByZXR1cm4gdSgyNDAgfCBlID4+PiAxOCAmIDcpICsgdSgxMjggfCBlID4+PiAxMiAmIDYzKSArIHUoMTI4IHwgZSA+Pj4gNiAmIDYzKSArIHUoMTI4IHwgNjMgJiBlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKCiAgICAgICAgZ2V0U2lnbihlLCB0LCBhLCBuKSB7CiAgICAgICAgICAgIGxldCByID0gIiIsCiAgICAgICAgICAgICAgICBpID0gIiI7CiAgICAgICAgICAgIGlmICh0KSB7CiAgICAgICAgICAgICAgICBsZXQgcyA9IE9iamVjdC5hc3NpZ24oe30sIHQpOwogICAgICAgICAgICAgICAgaSA9IEpTT04uc3RyaW5naWZ5KHMpLAogICAgICAgICAgICAgICAgICAgIGkgPSBpLnJlcGxhY2UoL1xzKi9nLCAiIiksCiAgICAgICAgICAgICAgICAgICAgaSA9IGVuY29kZVVSSUNvbXBvbmVudChpKTsKICAgICAgICAgICAgICAgIGxldCBjID0gaS5zcGxpdCgiIiksCiAgICAgICAgICAgICAgICAgICAgdSA9IGMuc29ydCgpOwogICAgICAgICAgICAgICAgaSA9IHUuam9pbigiIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgbGV0IEEgPSBtZDUoYmFzZS5lKHRoaXMudXRvYihpKSkpOwogICAgICAgICAgICBsZXQgbCA9IG1kNShhICsgIjoiICsgbik7CiAgICAgICAgICAgIHJldHVybiBtZDUoQSArIGwpLnRvVXBwZXJDYXNlKCk7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgZ2V0RmlsZVVybEJ5T25jZShpdGVtLCBpbmRleCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYgKGl0ZW0uZG93bmxvYWRVcmwpIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgZG93bmxvYWRVcmw6IGl0ZW0uZG93bmxvYWRVcmwKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZXRlY3RQYWdlKCkgPT09ICdob21lJykgewogICAgICAgICAgICAgICAgICAgIGxldCBib2R5ID0gewogICAgICAgICAgICAgICAgICAgICAgICAiY29udGVudElEIjogaXRlbS5jb250ZW50SUQsCiAgICAgICAgICAgICAgICAgICAgICAgICJjb21tb25BY2NvdW50SW5mbyI6IHsiYWNjb3VudCI6IGl0ZW0ub3duZXIsICJhY2NvdW50VHlwZSI6IDF9LAogICAgICAgICAgICAgICAgICAgICAgICAib3BlcmF0aW9uIjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAiaW5saW5lIjogIjAiLAogICAgICAgICAgICAgICAgICAgICAgICAiZXh0SW5mbyI6IHsiaXNSZXR1cm5DZG5Eb3dubG9hZFVybCI6ICIxIn0KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGxldCB0aW1lID0gbmV3IERhdGUoK25ldyBEYXRlKCkgKyA4ICogMzYwMCAqIDEwMDApLnRvSlNPTigpLnN1YnN0cigwLCAxOSkucmVwbGFjZSgnVCcsICcgJyk7CiAgICAgICAgICAgICAgICAgICAgbGV0IGtleSA9IHRoaXMuZ2V0UmFuZG9tU3RyaW5nKDE2KTsKICAgICAgICAgICAgICAgICAgICBsZXQgc2lnbiA9IHRoaXMuZ2V0U2lnbih1bmRlZmluZWQsIGJvZHksIHRpbWUsIGtleSk7CgogICAgICAgICAgICAgICAgICAgIGxldCByZXMgPSBhd2FpdCBiYXNlLnBvc3QocGFuLnBjc1swXSwgYm9keSwgewogICAgICAgICAgICAgICAgICAgICAgICAnYXV0aG9yaXphdGlvbic6IGJhc2UuZ2V0Q29va2llKCdhdXRob3JpemF0aW9uJyksCiAgICAgICAgICAgICAgICAgICAgICAgICd4LWh1YXdlaS1jaGFubmVsU3JjJzogJzEwMDAwMDM0JywKICAgICAgICAgICAgICAgICAgICAgICAgJ3gtaW5uZXItbnR3ayc6ICcyJywKICAgICAgICAgICAgICAgICAgICAgICAgJ21jbG91ZC1jaGFubmVsJzogJzEwMDAxMDEnLAogICAgICAgICAgICAgICAgICAgICAgICAnbWNsb3VkLWNsaWVudCc6ICcxMDcwMScsCiAgICAgICAgICAgICAgICAgICAgICAgICdtY2xvdWQtc2lnbic6IHRpbWUgKyAiLCIgKyBrZXkgKyAiLCIgKyBzaWduLAogICAgICAgICAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOCIsCiAgICAgICAgICAgICAgICAgICAgICAgICdjYWxsZXInOiAnd2ViJywKICAgICAgICAgICAgICAgICAgICAgICAgJ0NNUy1ERVZJQ0UnOiAnZGVmYXVsdCcsCiAgICAgICAgICAgICAgICAgICAgICAgICd4LURldmljZUluZm8nOiAnfHw5fDcuMTIuMHxjaHJvbWV8MTE4LjAuMC4wfHx3aW5kb3dzIDEwfHx6aC1DTnx8fCcsCiAgICAgICAgICAgICAgICAgICAgICAgICd4LVN2Y1R5cGUnOiAnMScsCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiByZXMuZGF0YS5kb3dubG9hZFVSTAogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiAn6I635Y+W5LiL6L295Zyw5Z2A5aSx6LSl77yM6K+35Yi35paw6YeN6K+V77yBJwogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmRldGVjdFBhZ2UoKSA9PT0gJ3NoYXJlJykgewogICAgICAgICAgICAgICAgICAgIGxldCB2dWVEb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIubWFpbl9maWxlX2xpc3QiKS5fX3Z1ZV9fOwoKICAgICAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0KHBhbi5wY3NbMV0sIGBsaW5rSWQ9JHt2dWVEb20ubGlua0lEfSZjb250ZW50SWRzPSR7aXRlbS5wYXRofSZjYXRhbG9nSWRzPWAsIHsKICAgICAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnLAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIGlmIChyZXMuY29kZSA9PT0gMCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5kZXgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFVybDogcmVzLmRhdGEucmVkclVybAogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvd25sb2FkVXJsOiAn6I635Y+W5LiL6L295Zyw5Z2A5aSx6LSl77yM6K+35Yi35paw6YeN6K+V77yBJwogICAgICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgICAgICBpbmRleCwKICAgICAgICAgICAgICAgICAgICBkb3dubG9hZFVybDogJ+iOt+WPluS4i+i9veWcsOWdgOWksei0pe+8jOivt+WIt+aWsOmHjeivle+8gScKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRQQ1NMaW5rKCkgewogICAgICAgICAgICBzZWxlY3RMaXN0ID0gdGhpcy5nZXRTZWxlY3RlZExpc3QoKTsKICAgICAgICAgICAgaWYgKHNlbGVjdExpc3QubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gbWVzc2FnZS5lcnJvcign5o+Q56S677ya6K+35YWI5Yu+6YCJ6KaB5LiL6L2955qE5paH5Lu277yBJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHRoaXMuaXNPbmx5Rm9sZGVyKCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBtZXNzYWdlLmVycm9yKCfmj5DnpLrvvJror7fmiZPlvIDmlofku7blpLnlkI7li77pgInmlofku7bvvIEnKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbGV0IHF1ZXVlID0gW107CiAgICAgICAgICAgIHNlbGVjdExpc3QuZm9yRWFjaCgoaXRlbSwgaW5kZXgpID0+IHsKICAgICAgICAgICAgICAgIHF1ZXVlLnB1c2godGhpcy5nZXRGaWxlVXJsQnlPbmNlKGl0ZW0sIGluZGV4KSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgUHJvbWlzZS5hbGwocXVldWUpOwogICAgICAgICAgICByZXMuZm9yRWFjaCh2YWwgPT4gewogICAgICAgICAgICAgICAgc2VsZWN0TGlzdFt2YWwuaW5kZXhdLmRvd25sb2FkVXJsID0gdmFsLmRvd25sb2FkVXJsOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGxldCBodG1sID0gdGhpcy5nZW5lcmF0ZURvbShzZWxlY3RMaXN0KTsKICAgICAgICAgICAgdGhpcy5zaG93TWFpbkRpYWxvZyhwYW5bbW9kZV1bMF0sIGh0bWwsIHBhblttb2RlXVsxXSk7CiAgICAgICAgfSwKCiAgICAgICAgZ2VuZXJhdGVEb20obGlzdCkgewogICAgICAgICAgICBsZXQgY29udGVudCA9ICc8ZGl2IGNsYXNzPSJwbC1tYWluIj4nOwogICAgICAgICAgICBsZXQgYWxpbmtBbGxUZXh0ID0gJyc7CiAgICAgICAgICAgIGxpc3QuZm9yRWFjaCgodiwgaSkgPT4gewogICAgICAgICAgICAgICAgaWYgKHYuZGlyRXRhZyB8fCB2LmNhTmFtZSkgcmV0dXJuOwogICAgICAgICAgICAgICAgbGV0IGZpbGVuYW1lID0gdi5jb250ZW50TmFtZSB8fCB2LmNvTmFtZTsKICAgICAgICAgICAgICAgIGxldCBzaXplID0gYmFzZS5zaXplRm9ybWF0KHYuY29udGVudFNpemUgfHwgdi5jb1NpemUpOwogICAgICAgICAgICAgICAgbGV0IGRsaW5rID0gdi5kb3dubG9hZFVybDsKICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYXBpJykgewogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstYXBpIiBkYXRhLWZpbGVuYW1lPSIke2ZpbGVuYW1lfSIgZGF0YS1saW5rPSIke2RsaW5rfSIgZGF0YS1pbmRleD0iJHtpfSI+JHtkbGlua308L2E+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC9kaXY+YDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtb2RlID09PSAnYXJpYScpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgYWxpbmsgPSB0aGlzLmNvbnZlcnRMaW5rVG9BcmlhKGRsaW5rLCBmaWxlbmFtZSwgbmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgICAgICAgICAgICAgICAgICAgYWxpbmtBbGxUZXh0ICs9IGFsaW5rICsgJ1xyXG4nOwogICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWl0ZW0iPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InBsLWl0ZW0tbmFtZSBsaXN0ZW5lci10aXAiIGRhdGEtc2l6ZT0iJHtzaXplfSI+JHtmaWxlbmFtZX08L2Rpdj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8YSBjbGFzcz0icGwtaXRlbS1saW5rIGxpc3RlbmVyLWxpbmstYXJpYSIgaHJlZj0iJHthbGlua30iIHRpdGxlPSLngrnlh7vlpI3liLZhcmlhMmPpk77mjqUiIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdycGMnKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxidXR0b24gY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLXJwYyBwbC1idG4tcHJpbWFyeSBwbC1idG4taW5mbyIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHtkbGlua30iPjxlbSBjbGFzcz0iaWNvbiBpY29uLWRldmljZSI+PC9lbT48c3BhbiBzdHlsZT0ibWFyZ2luLWxlZnQ6IDVweDsiPuaOqOmAgeWIsCBSUEMg5LiL6L295ZmoPC9zcGFuPjwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2N1cmwnKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IGFsaW5rID0gdGhpcy5jb252ZXJ0TGlua1RvQ3VybChkbGluaywgZmlsZW5hbWUsIG5hdmlnYXRvci51c2VyQWdlbnQpOwogICAgICAgICAgICAgICAgICAgIGFsaW5rQWxsVGV4dCArPSBhbGluayArICdcclxuJzsKICAgICAgICAgICAgICAgICAgICBjb250ZW50ICs9IGA8ZGl2IGNsYXNzPSJwbC1pdGVtIj4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJwbC1pdGVtLW5hbWUgbGlzdGVuZXItdGlwIiBkYXRhLXNpemU9IiR7c2l6ZX0iPiR7ZmlsZW5hbWV9PC9kaXY+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGEgY2xhc3M9InBsLWl0ZW0tbGluayBsaXN0ZW5lci1saW5rLWFyaWEiIGhyZWY9IiR7YWxpbmt9IiB0aXRsZT0i54K55Ye75aSN5Yi2Y3VybOmTvuaOpSIgZGF0YS1maWxlbmFtZT0iJHtmaWxlbmFtZX0iIGRhdGEtbGluaz0iJHthbGlua30iPiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX08L2E+IDwvZGl2PmA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobW9kZSA9PT0gJ2JjJykgewogICAgICAgICAgICAgICAgICAgIGxldCBhbGluayA9IHRoaXMuY29udmVydExpbmtUb0JDKGRsaW5rLCBmaWxlbmFtZSwgbmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgICAgICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtaXRlbSI+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0icGwtaXRlbS1uYW1lIGxpc3RlbmVyLXRpcCIgZGF0YS1zaXplPSIke3NpemV9Ij4ke2ZpbGVuYW1lfTwvZGl2PgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxhIGNsYXNzPSJwbC1pdGVtLWxpbmsiIGhyZWY9IiR7ZGVjb2RlVVJJQ29tcG9uZW50KGFsaW5rKX0iIHRpdGxlPSLngrnlh7vnlKjmr5TnibnlvZfmmJ/kuIvovb0iIGRhdGEtZmlsZW5hbWU9IiR7ZmlsZW5hbWV9IiBkYXRhLWxpbms9IiR7YWxpbmt9Ij4ke2RlY29kZVVSSUNvbXBvbmVudChhbGluayl9PC9hPiA8L2Rpdj5gOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29udGVudCArPSAnPC9kaXY+JzsKICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdhcmlhJykKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1jb3B5LWFsbCIgZGF0YS1saW5rPSIke2FsaW5rQWxsVGV4dH0iPuWkjeWItuWFqOmDqOmTvuaOpTwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgIGlmIChtb2RlID09PSAncnBjJykgewogICAgICAgICAgICAgICAgbGV0IHJwYyA9IGJhc2UuZ2V0VmFsdWUoJ3NldHRpbmdfcnBjX2RvbWFpbicpICsgJzonICsgYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcG9ydCcpICsgYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfcGF0aCcpOwogICAgICAgICAgICAgICAgY29udGVudCArPSBgPGRpdiBjbGFzcz0icGwtZXh0cmEiPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IGxpc3RlbmVyLXNlbmQtcnBjIj7lj5HpgIHlhajpg6jpk77mjqU8L2J1dHRvbj48YnV0dG9uIHRpdGxlPSIke3JwY30iIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4td2FybmluZyBsaXN0ZW5lci1vcGVuLXNldHRpbmciIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweCI+6K6+572uIFJQQyDlj4LmlbDvvIjlvZPliY3kuLrvvJoke3JwY33vvIk8L2J1dHRvbj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBwbC1idG4tc3VjY2VzcyBsaXN0ZW5lci1ycGMtdGFzayIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4O2Rpc3BsYXk6IG5vbmUiPuafpeeci+S4i+i9veS7u+WKoTwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG1vZGUgPT09ICdjdXJsJykKICAgICAgICAgICAgICAgIGNvbnRlbnQgKz0gYDxkaXYgY2xhc3M9InBsLWV4dHJhIj48YnV0dG9uIGNsYXNzPSJwbC1idG4tcHJpbWFyeSBsaXN0ZW5lci1jb3B5LWFsbCIgZGF0YS1saW5rPSIke2FsaW5rQWxsVGV4dH0iPuWkjeWItuWFqOmDqOmTvuaOpTwvYnV0dG9uPjxidXR0b24gY2xhc3M9InBsLWJ0bi1wcmltYXJ5IHBsLWJ0bi13YXJuaW5nIGxpc3RlbmVyLW9wZW4tc2V0dGluZyIgc3R5bGU9Im1hcmdpbi1sZWZ0OiAxMHB4OyI+6K6+572u57uI56uv57G75Z6L77yI5b2T5YmN5Li677yaJHt0ZXJtaW5hbFR5cGVbYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ190ZXJtaW5hbF90eXBlJyldfe+8iTwvYnV0dG9uPjwvZGl2PmA7CiAgICAgICAgICAgIHJldHVybiBjb250ZW50OwogICAgICAgIH0sCgogICAgICAgIGFzeW5jIHNlbmRMaW5rVG9SUEMoZmlsZW5hbWUsIGxpbmspIHsKICAgICAgICAgICAgbGV0IHJwYyA9IHsKICAgICAgICAgICAgICAgIGRvbWFpbjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZG9tYWluJyksCiAgICAgICAgICAgICAgICBwb3J0OiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wb3J0JyksCiAgICAgICAgICAgICAgICBwYXRoOiBiYXNlLmdldFZhbHVlKCdzZXR0aW5nX3JwY19wYXRoJyksCiAgICAgICAgICAgICAgICB0b2tlbjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfdG9rZW4nKSwKICAgICAgICAgICAgICAgIGRpcjogYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19ycGNfZGlyJyksCiAgICAgICAgICAgIH07CgogICAgICAgICAgICBsZXQgdXJsID0gYCR7cnBjLmRvbWFpbn06JHtycGMucG9ydH0ke3JwYy5wYXRofWA7CiAgICAgICAgICAgIGxldCBycGNEYXRhID0gewogICAgICAgICAgICAgICAgaWQ6IG5ldyBEYXRlKCkuZ2V0VGltZSgpLAogICAgICAgICAgICAgICAganNvbnJwYzogJzIuMCcsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdhcmlhMi5hZGRVcmknLAogICAgICAgICAgICAgICAgcGFyYW1zOiBbYHRva2VuOiR7cnBjLnRva2VufWAsIFtsaW5rXSwgewogICAgICAgICAgICAgICAgICAgIGRpcjogcnBjLmRpciwKICAgICAgICAgICAgICAgICAgICBvdXQ6IGZpbGVuYW1lLAogICAgICAgICAgICAgICAgICAgIGhlYWRlcjogW10KICAgICAgICAgICAgICAgIH1dCiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBsZXQgcmVzID0gYXdhaXQgYmFzZS5wb3N0KHVybCwgcnBjRGF0YSwge30sICcnKTsKICAgICAgICAgICAgICAgIGlmIChyZXMucmVzdWx0KSByZXR1cm4gJ3N1Y2Nlc3MnOwogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgcmV0dXJuICdmYWlsJzsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGdldFNlbGVjdGVkTGlzdCgpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIHJldHVybiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIubWFpbl9maWxlX2xpc3QiKS5fX3Z1ZV9fLnNlbGVjdExpc3QubWFwKHZhbCA9PiB2YWwuaXRlbSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAgIGxldCB2dWVEb20gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuaG9tZS1wYWdlIikuX192dWVfXzsKICAgICAgICAgICAgICAgIGxldCBmaWxlTGlzdCA9IHZ1ZURvbS5fY29tcHV0ZWRXYXRjaGVycy5maWxlTGlzdC52YWx1ZTsKICAgICAgICAgICAgICAgIGxldCBkaXJMaXN0ID0gdnVlRG9tLl9jb21wdXRlZFdhdGNoZXJzLmRpckxpc3QudmFsdWU7CiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRGaWxlSW5kZXggPSB2dWVEb20uc2VsZWN0ZWRGaWxlOwogICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkRGlySW5kZXggPSB2dWVEb20uc2VsZWN0ZWREaXI7CiAgICAgICAgICAgICAgICBsZXQgc2VsZWN0RmlsZUxpc3QgPSBmaWxlTGlzdC5maWx0ZXIoKHYsIGkpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRGaWxlSW5kZXguaW5jbHVkZXMoaSk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGxldCBzZWxlY3REaXJMaXN0ID0gZGlyTGlzdC5maWx0ZXIoKHYsIGkpID0+IHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWREaXJJbmRleC5pbmNsdWRlcyhpKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIFsuLi5zZWxlY3RGaWxlTGlzdCwgLi4uc2VsZWN0RGlyTGlzdF07CiAgICAgICAgICAgIH0KICAgICAgICB9LAoKICAgICAgICBkZXRlY3RQYWdlKCkgewogICAgICAgICAgICBsZXQgcGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgICBpZiAoL15cL3cvLnRlc3QocGF0aCkpIHJldHVybiAnaG9tZSc7CiAgICAgICAgICAgIGlmICgvXlwvbGlua3xzaGFyZXdlYi8udGVzdChwYXRoKSkgcmV0dXJuICdzaGFyZSc7CiAgICAgICAgICAgIHJldHVybiAnJzsKICAgICAgICB9LAoKICAgICAgICBpc09ubHlGb2xkZXIoKSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0TGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgaWYgKHNlbGVjdExpc3RbaV0uZmlsZUV0YWcgfHwgc2VsZWN0TGlzdFtpXS5jb05hbWUpIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9LAoKICAgICAgICBzaG93TWFpbkRpYWxvZyh0aXRsZSwgaHRtbCwgZm9vdGVyKSB7CiAgICAgICAgICAgIFN3YWwuZmlyZSh7CiAgICAgICAgICAgICAgICB0aXRsZSwKICAgICAgICAgICAgICAgIGh0bWwsCiAgICAgICAgICAgICAgICBmb290ZXIsCiAgICAgICAgICAgICAgICBhbGxvd091dHNpZGVDbGljazogZmFsc2UsCiAgICAgICAgICAgICAgICBzaG93Q2xvc2VCdXR0b246IHRydWUsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcCcsCiAgICAgICAgICAgICAgICB3aWR0aCwKICAgICAgICAgICAgICAgIHBhZGRpbmc6ICcxNXB4IDIwcHggNXB4JywKICAgICAgICAgICAgICAgIGN1c3RvbUNsYXNzLAogICAgICAgICAgICB9KTsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBpbml0UGFuTGlua2VyKCkgewogICAgICAgICAgICBiYXNlLmluaXREZWZhdWx0Q29uZmlnKCk7CiAgICAgICAgICAgIGJhc2UuYWRkUGFuTGlua2VyU3R5bGUoKTsKICAgICAgICAgICAgcHQgPSB0aGlzLmRldGVjdFBhZ2UoKTsKICAgICAgICAgICAgbGV0IHJlcyA9IGF3YWl0IGJhc2UucG9zdAogICAgICAgICAgICAoYGh0dHBzOi8vYXBpLnlvdXhpYW9ob3UuY29tL2NvbmZpZy92Mi95aWRvbmc/dmVyPSR7dmVyc2lvbn0mYT0ke2F1dGhvcn1gLCB7fSwge30sICd0ZXh0Jyk7CiAgICAgICAgICAgIHBhbiA9IEpTT04ucGFyc2UoYmFzZS5kKHJlcykpOwogICAgICAgICAgICBPYmplY3QuZnJlZXplICYmIE9iamVjdC5mcmVlemUocGFuKTsKICAgICAgICAgICAgcGFuLm51bSA9PT0gYmFzZS5nZXRWYWx1ZSgnc2V0dGluZ19pbml0X2NvZGUnKSB8fAogICAgICAgICAgICBwYW4ubGljZW5zZSA9PT0gYmFzZS5nZXRWYWx1ZSgnbGljZW5zZScpID8gdGhpcy5hZGRCdXR0b24oKSA6IHRoaXMuYWRkSW5pdEJ1dHRvbigpOwogICAgICAgICAgICBiYXNlLmNyZWF0ZVRpcCgpOwogICAgICAgICAgICBiYXNlLnJlZ2lzdGVyTWVudUNvbW1hbmQoKTsKICAgICAgICB9CiAgICB9OwoKICAgIGxldCBtYWluID0gewogICAgICAgIGluaXQoKSB7CiAgICAgICAgICAgIGlmICgvKHBhbnx5dW4pLmJhaWR1LmNvbS8udGVzdChsb2NhdGlvbi5ob3N0KSkgewogICAgICAgICAgICAgICAgYmFpZHUuaW5pdFBhbkxpbmtlcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgvb3BlbmFwaS5iYWlkdS5jb21cL29hdXRoLy50ZXN0KGxvY2F0aW9uLmhyZWYpKSB7CiAgICAgICAgICAgICAgICBiYWlkdS5pbml0QXV0aG9yaXplKCkKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoL3d3dy4oYWxpeXVuZHJpdmV8YWxpcGFuKS5jb20vLnRlc3QobG9jYXRpb24uaG9zdCkpIHsKICAgICAgICAgICAgICAgIGFsaS5pbml0UGFuTGlua2VyKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKC9jbG91ZC4xODkuY24vLnRlc3QobG9jYXRpb24uaG9zdCkpIHsKICAgICAgICAgICAgICAgIHRpYW55aS5pbml0UGFuTGlua2VyKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKC9wYW4ueHVubGVpLmNvbS8udGVzdChsb2NhdGlvbi5ob3N0KSkgewogICAgICAgICAgICAgICAgeHVubGVpLmluaXRQYW5MaW5rZXIoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoL3Bhbi5xdWFyay5jbi8udGVzdChsb2NhdGlvbi5ob3N0KSkgewogICAgICAgICAgICAgICAgcXVhcmsuaW5pdFBhbkxpbmtlcigpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICgvKHl1bnxjYWl5dW4pLjEzOS5jb20vLnRlc3QobG9jYXRpb24uaG9zdCkpIHsKICAgICAgICAgICAgICAgIHlpZG9uZy5pbml0UGFuTGlua2VyKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9OwoKICAgIG1haW4uaW5pdCgpOwp9KSgpOwo=","requires":[{"meta":{"name":"jquery.min.js","url":"https://unpkg.com/jquery@3.7.0/dist/jquery.min.js","ts":1770963303577,"mimetype":"text/javascript"},"source":"LyohIGpRdWVyeSB2My43LjAgfCAoYykgT3BlbkpTIEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9ycyB8IGpxdWVyeS5vcmcvbGljZW5zZSAqLwohZnVuY3Rpb24oZSx0KXsidXNlIHN0cmljdCI7Im9iamVjdCI9PXR5cGVvZiBtb2R1bGUmJiJvYmplY3QiPT10eXBlb2YgbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9ZS5kb2N1bWVudD90KGUsITApOmZ1bmN0aW9uKGUpe2lmKCFlLmRvY3VtZW50KXRocm93IG5ldyBFcnJvcigialF1ZXJ5IHJlcXVpcmVzIGEgd2luZG93IHdpdGggYSBkb2N1bWVudCIpO3JldHVybiB0KGUpfTp0KGUpfSgidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdz93aW5kb3c6dGhpcyxmdW5jdGlvbihpZSxlKXsidXNlIHN0cmljdCI7dmFyIG9lPVtdLHI9T2JqZWN0LmdldFByb3RvdHlwZU9mLGFlPW9lLnNsaWNlLGc9b2UuZmxhdD9mdW5jdGlvbihlKXtyZXR1cm4gb2UuZmxhdC5jYWxsKGUpfTpmdW5jdGlvbihlKXtyZXR1cm4gb2UuY29uY2F0LmFwcGx5KFtdLGUpfSxzPW9lLnB1c2gsc2U9b2UuaW5kZXhPZixuPXt9LGk9bi50b1N0cmluZyx1ZT1uLmhhc093blByb3BlcnR5LG89dWUudG9TdHJpbmcsYT1vLmNhbGwoT2JqZWN0KSxsZT17fSx2PWZ1bmN0aW9uKGUpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBlJiYibnVtYmVyIiE9dHlwZW9mIGUubm9kZVR5cGUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlLml0ZW19LHk9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGwhPWUmJmU9PT1lLndpbmRvd30sQz1pZS5kb2N1bWVudCx1PXt0eXBlOiEwLHNyYzohMCxub25jZTohMCxub01vZHVsZTohMH07ZnVuY3Rpb24gbShlLHQsbil7dmFyIHIsaSxvPShuPW58fEMpLmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpO2lmKG8udGV4dD1lLHQpZm9yKHIgaW4gdSkoaT10W3JdfHx0LmdldEF0dHJpYnV0ZSYmdC5nZXRBdHRyaWJ1dGUocikpJiZvLnNldEF0dHJpYnV0ZShyLGkpO24uaGVhZC5hcHBlbmRDaGlsZChvKS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG8pfWZ1bmN0aW9uIHgoZSl7cmV0dXJuIG51bGw9PWU/ZSsiIjoib2JqZWN0Ij09dHlwZW9mIGV8fCJmdW5jdGlvbiI9PXR5cGVvZiBlP25baS5jYWxsKGUpXXx8Im9iamVjdCI6dHlwZW9mIGV9dmFyIHQ9IjMuNy4wIixsPS9IVE1MJC9pLGNlPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIG5ldyBjZS5mbi5pbml0KGUsdCl9O2Z1bmN0aW9uIGMoZSl7dmFyIHQ9ISFlJiYibGVuZ3RoImluIGUmJmUubGVuZ3RoLG49eChlKTtyZXR1cm4hdihlKSYmIXkoZSkmJigiYXJyYXkiPT09bnx8MD09PXR8fCJudW1iZXIiPT10eXBlb2YgdCYmMDx0JiZ0LTEgaW4gZSl9ZnVuY3Rpb24gZmUoZSx0KXtyZXR1cm4gZS5ub2RlTmFtZSYmZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09dC50b0xvd2VyQ2FzZSgpfWNlLmZuPWNlLnByb3RvdHlwZT17anF1ZXJ5OnQsY29uc3RydWN0b3I6Y2UsbGVuZ3RoOjAsdG9BcnJheTpmdW5jdGlvbigpe3JldHVybiBhZS5jYWxsKHRoaXMpfSxnZXQ6ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/YWUuY2FsbCh0aGlzKTplPDA/dGhpc1tlK3RoaXMubGVuZ3RoXTp0aGlzW2VdfSxwdXNoU3RhY2s6ZnVuY3Rpb24oZSl7dmFyIHQ9Y2UubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLGUpO3JldHVybiB0LnByZXZPYmplY3Q9dGhpcyx0fSxlYWNoOmZ1bmN0aW9uKGUpe3JldHVybiBjZS5lYWNoKHRoaXMsZSl9LG1hcDpmdW5jdGlvbihuKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soY2UubWFwKHRoaXMsZnVuY3Rpb24oZSx0KXtyZXR1cm4gbi5jYWxsKGUsdCxlKX0pKX0sc2xpY2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soYWUuYXBwbHkodGhpcyxhcmd1bWVudHMpKX0sZmlyc3Q6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5lcSgwKX0sbGFzdDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmVxKC0xKX0sZXZlbjpmdW5jdGlvbigpe3JldHVybiB0aGlzLnB1c2hTdGFjayhjZS5ncmVwKHRoaXMsZnVuY3Rpb24oZSx0KXtyZXR1cm4odCsxKSUyfSkpfSxvZGQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soY2UuZ3JlcCh0aGlzLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQlMn0pKX0sZXE6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5sZW5ndGgsbj0rZSsoZTwwP3Q6MCk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKDA8PW4mJm48dD9bdGhpc1tuXV06W10pfSxlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5wcmV2T2JqZWN0fHx0aGlzLmNvbnN0cnVjdG9yKCl9LHB1c2g6cyxzb3J0Om9lLnNvcnQsc3BsaWNlOm9lLnNwbGljZX0sY2UuZXh0ZW5kPWNlLmZuLmV4dGVuZD1mdW5jdGlvbigpe3ZhciBlLHQsbixyLGksbyxhPWFyZ3VtZW50c1swXXx8e30scz0xLHU9YXJndW1lbnRzLmxlbmd0aCxsPSExO2ZvcigiYm9vbGVhbiI9PXR5cGVvZiBhJiYobD1hLGE9YXJndW1lbnRzW3NdfHx7fSxzKyspLCJvYmplY3QiPT10eXBlb2YgYXx8dihhKXx8KGE9e30pLHM9PT11JiYoYT10aGlzLHMtLSk7czx1O3MrKylpZihudWxsIT0oZT1hcmd1bWVudHNbc10pKWZvcih0IGluIGUpcj1lW3RdLCJfX3Byb3RvX18iIT09dCYmYSE9PXImJihsJiZyJiYoY2UuaXNQbGFpbk9iamVjdChyKXx8KGk9QXJyYXkuaXNBcnJheShyKSkpPyhuPWFbdF0sbz1pJiYhQXJyYXkuaXNBcnJheShuKT9bXTppfHxjZS5pc1BsYWluT2JqZWN0KG4pP246e30saT0hMSxhW3RdPWNlLmV4dGVuZChsLG8scikpOnZvaWQgMCE9PXImJihhW3RdPXIpKTtyZXR1cm4gYX0sY2UuZXh0ZW5kKHtleHBhbmRvOiJqUXVlcnkiKyh0K01hdGgucmFuZG9tKCkpLnJlcGxhY2UoL1xEL2csIiIpLGlzUmVhZHk6ITAsZXJyb3I6ZnVuY3Rpb24oZSl7dGhyb3cgbmV3IEVycm9yKGUpfSxub29wOmZ1bmN0aW9uKCl7fSxpc1BsYWluT2JqZWN0OmZ1bmN0aW9uKGUpe3ZhciB0LG47cmV0dXJuISghZXx8IltvYmplY3QgT2JqZWN0XSIhPT1pLmNhbGwoZSkpJiYoISh0PXIoZSkpfHwiZnVuY3Rpb24iPT10eXBlb2Yobj11ZS5jYWxsKHQsImNvbnN0cnVjdG9yIikmJnQuY29uc3RydWN0b3IpJiZvLmNhbGwobik9PT1hKX0saXNFbXB0eU9iamVjdDpmdW5jdGlvbihlKXt2YXIgdDtmb3IodCBpbiBlKXJldHVybiExO3JldHVybiEwfSxnbG9iYWxFdmFsOmZ1bmN0aW9uKGUsdCxuKXttKGUse25vbmNlOnQmJnQubm9uY2V9LG4pfSxlYWNoOmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wO2lmKGMoZSkpe2ZvcihuPWUubGVuZ3RoO3I8bjtyKyspaWYoITE9PT10LmNhbGwoZVtyXSxyLGVbcl0pKWJyZWFrfWVsc2UgZm9yKHIgaW4gZSlpZighMT09PXQuY2FsbChlW3JdLHIsZVtyXSkpYnJlYWs7cmV0dXJuIGV9LHRleHQ6ZnVuY3Rpb24oZSl7dmFyIHQsbj0iIixyPTAsaT1lLm5vZGVUeXBlO2lmKGkpe2lmKDE9PT1pfHw5PT09aXx8MTE9PT1pKXJldHVybiBlLnRleHRDb250ZW50O2lmKDM9PT1pfHw0PT09aSlyZXR1cm4gZS5ub2RlVmFsdWV9ZWxzZSB3aGlsZSh0PWVbcisrXSluKz1jZS50ZXh0KHQpO3JldHVybiBufSxtYWtlQXJyYXk6ZnVuY3Rpb24oZSx0KXt2YXIgbj10fHxbXTtyZXR1cm4gbnVsbCE9ZSYmKGMoT2JqZWN0KGUpKT9jZS5tZXJnZShuLCJzdHJpbmciPT10eXBlb2YgZT9bZV06ZSk6cy5jYWxsKG4sZSkpLG59LGluQXJyYXk6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBudWxsPT10Py0xOnNlLmNhbGwodCxlLG4pfSxpc1hNTERvYzpmdW5jdGlvbihlKXt2YXIgdD1lJiZlLm5hbWVzcGFjZVVSSSxuPWUmJihlLm93bmVyRG9jdW1lbnR8fGUpLmRvY3VtZW50RWxlbWVudDtyZXR1cm4hbC50ZXN0KHR8fG4mJm4ubm9kZU5hbWV8fCJIVE1MIil9LG1lcmdlOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuPSt0Lmxlbmd0aCxyPTAsaT1lLmxlbmd0aDtyPG47cisrKWVbaSsrXT10W3JdO3JldHVybiBlLmxlbmd0aD1pLGV9LGdyZXA6ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj1bXSxpPTAsbz1lLmxlbmd0aCxhPSFuO2k8bztpKyspIXQoZVtpXSxpKSE9PWEmJnIucHVzaChlW2ldKTtyZXR1cm4gcn0sbWFwOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89MCxhPVtdO2lmKGMoZSkpZm9yKHI9ZS5sZW5ndGg7bzxyO28rKyludWxsIT0oaT10KGVbb10sbyxuKSkmJmEucHVzaChpKTtlbHNlIGZvcihvIGluIGUpbnVsbCE9KGk9dChlW29dLG8sbikpJiZhLnB1c2goaSk7cmV0dXJuIGcoYSl9LGd1aWQ6MSxzdXBwb3J0OmxlfSksImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmKGNlLmZuW1N5bWJvbC5pdGVyYXRvcl09b2VbU3ltYm9sLml0ZXJhdG9yXSksY2UuZWFjaCgiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvciBTeW1ib2wiLnNwbGl0KCIgIiksZnVuY3Rpb24oZSx0KXtuWyJbb2JqZWN0ICIrdCsiXSJdPXQudG9Mb3dlckNhc2UoKX0pO3ZhciBwZT1vZS5wb3AsZGU9b2Uuc29ydCxoZT1vZS5zcGxpY2UsZ2U9IltcXHgyMFxcdFxcclxcblxcZl0iLHZlPW5ldyBSZWdFeHAoIl4iK2dlKyIrfCgoPzpefFteXFxcXF0pKD86XFxcXC4pKikiK2dlKyIrJCIsImciKTtjZS5jb250YWlucz1mdW5jdGlvbihlLHQpe3ZhciBuPXQmJnQucGFyZW50Tm9kZTtyZXR1cm4gZT09PW58fCEoIW58fDEhPT1uLm5vZGVUeXBlfHwhKGUuY29udGFpbnM/ZS5jb250YWlucyhuKTplLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uJiYxNiZlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKG4pKSl9O3ZhciBmPS8oW1wwLVx4MWZceDdmXXxeLT9cZCl8Xi0kfFteXHg4MC1cdUZGRkZcdy1dL2c7ZnVuY3Rpb24gcChlLHQpe3JldHVybiB0PyJcMCI9PT1lPyJcdWZmZmQiOmUuc2xpY2UoMCwtMSkrIlxcIitlLmNoYXJDb2RlQXQoZS5sZW5ndGgtMSkudG9TdHJpbmcoMTYpKyIgIjoiXFwiK2V9Y2UuZXNjYXBlU2VsZWN0b3I9ZnVuY3Rpb24oZSl7cmV0dXJuKGUrIiIpLnJlcGxhY2UoZixwKX07dmFyIHllPUMsbWU9czshZnVuY3Rpb24oKXt2YXIgZSxiLHcsbyxhLFQscixDLGQsaSxrPW1lLFM9Y2UuZXhwYW5kbyxFPTAsbj0wLHM9VygpLGM9VygpLHU9VygpLGg9VygpLGw9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT09PXQmJihhPSEwKSwwfSxmPSJjaGVja2VkfHNlbGVjdGVkfGFzeW5jfGF1dG9mb2N1c3xhdXRvcGxheXxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58aXNtYXB8bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZCIsdD0iKD86XFxcXFtcXGRhLWZBLUZdezEsNn0iK2dlKyI/fFxcXFxbXlxcclxcblxcZl18W1xcdy1dfFteXDAtXFx4N2ZdKSsiLHA9IlxcWyIrZ2UrIiooIit0KyIpKD86IitnZSsiKihbKl4kfCF+XT89KSIrZ2UrIiooPzonKCg/OlxcXFwufFteXFxcXCddKSopJ3xcIigoPzpcXFxcLnxbXlxcXFxcIl0pKilcInwoIit0KyIpKXwpIitnZSsiKlxcXSIsZz0iOigiK3QrIikoPzpcXCgoKCcoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwiKXwoKD86XFxcXC58W15cXFxcKClbXFxdXXwiK3ArIikqKXwuKilcXCl8KSIsdj1uZXcgUmVnRXhwKGdlKyIrIiwiZyIpLHk9bmV3IFJlZ0V4cCgiXiIrZ2UrIiosIitnZSsiKiIpLG09bmV3IFJlZ0V4cCgiXiIrZ2UrIiooWz4rfl18IitnZSsiKSIrZ2UrIioiKSx4PW5ldyBSZWdFeHAoZ2UrInw+Iiksaj1uZXcgUmVnRXhwKGcpLEE9bmV3IFJlZ0V4cCgiXiIrdCsiJCIpLEQ9e0lEOm5ldyBSZWdFeHAoIl4jKCIrdCsiKSIpLENMQVNTOm5ldyBSZWdFeHAoIl5cXC4oIit0KyIpIiksVEFHOm5ldyBSZWdFeHAoIl4oIit0KyJ8WypdKSIpLEFUVFI6bmV3IFJlZ0V4cCgiXiIrcCksUFNFVURPOm5ldyBSZWdFeHAoIl4iK2cpLENISUxEOm5ldyBSZWdFeHAoIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcKCIrZ2UrIiooZXZlbnxvZGR8KChbKy1dfCkoXFxkKilufCkiK2dlKyIqKD86KFsrLV18KSIrZ2UrIiooXFxkKyl8KSkiK2dlKyIqXFwpfCkiLCJpIiksYm9vbDpuZXcgUmVnRXhwKCJeKD86IitmKyIpJCIsImkiKSxuZWVkc0NvbnRleHQ6bmV3IFJlZ0V4cCgiXiIrZ2UrIipbPit+XXw6KGV2ZW58b2RkfGVxfGd0fGx0fG50aHxmaXJzdHxsYXN0KSg/OlxcKCIrZ2UrIiooKD86LVxcZCk/XFxkKikiK2dlKyIqXFwpfCkoPz1bXi1dfCQpIiwiaSIpfSxOPS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2kscT0vXmhcZCQvaSxMPS9eKD86IyhbXHctXSspfChcdyspfFwuKFtcdy1dKykpJC8sSD0vWyt+XS8sTz1uZXcgUmVnRXhwKCJcXFxcW1xcZGEtZkEtRl17MSw2fSIrZ2UrIj98XFxcXChbXlxcclxcblxcZl0pIiwiZyIpLFA9ZnVuY3Rpb24oZSx0KXt2YXIgbj0iMHgiK2Uuc2xpY2UoMSktNjU1MzY7cmV0dXJuIHR8fChuPDA/U3RyaW5nLmZyb21DaGFyQ29kZShuKzY1NTM2KTpTdHJpbmcuZnJvbUNoYXJDb2RlKG4+PjEwfDU1Mjk2LDEwMjMmbnw1NjMyMCkpfSxSPWZ1bmN0aW9uKCl7VigpfSxNPUooZnVuY3Rpb24oZSl7cmV0dXJuITA9PT1lLmRpc2FibGVkJiZmZShlLCJmaWVsZHNldCIpfSx7ZGlyOiJwYXJlbnROb2RlIixuZXh0OiJsZWdlbmQifSk7dHJ5e2suYXBwbHkob2U9YWUuY2FsbCh5ZS5jaGlsZE5vZGVzKSx5ZS5jaGlsZE5vZGVzKSxvZVt5ZS5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGV9Y2F0Y2goZSl7az17YXBwbHk6ZnVuY3Rpb24oZSx0KXttZS5hcHBseShlLGFlLmNhbGwodCkpfSxjYWxsOmZ1bmN0aW9uKGUpe21lLmFwcGx5KGUsYWUuY2FsbChhcmd1bWVudHMsMSkpfX19ZnVuY3Rpb24gSSh0LGUsbixyKXt2YXIgaSxvLGEscyx1LGwsYyxmPWUmJmUub3duZXJEb2N1bWVudCxwPWU/ZS5ub2RlVHlwZTo5O2lmKG49bnx8W10sInN0cmluZyIhPXR5cGVvZiB0fHwhdHx8MSE9PXAmJjkhPT1wJiYxMSE9PXApcmV0dXJuIG47aWYoIXImJihWKGUpLGU9ZXx8VCxDKSl7aWYoMTEhPT1wJiYodT1MLmV4ZWModCkpKWlmKGk9dVsxXSl7aWYoOT09PXApe2lmKCEoYT1lLmdldEVsZW1lbnRCeUlkKGkpKSlyZXR1cm4gbjtpZihhLmlkPT09aSlyZXR1cm4gay5jYWxsKG4sYSksbn1lbHNlIGlmKGYmJihhPWYuZ2V0RWxlbWVudEJ5SWQoaSkpJiZJLmNvbnRhaW5zKGUsYSkmJmEuaWQ9PT1pKXJldHVybiBrLmNhbGwobixhKSxufWVsc2V7aWYodVsyXSlyZXR1cm4gay5hcHBseShuLGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUodCkpLG47aWYoKGk9dVszXSkmJmUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSlyZXR1cm4gay5hcHBseShuLGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShpKSksbn1pZighKGhbdCsiICJdfHxkJiZkLnRlc3QodCkpKXtpZihjPXQsZj1lLDE9PT1wJiYoeC50ZXN0KHQpfHxtLnRlc3QodCkpKXsoZj1ILnRlc3QodCkmJnooZS5wYXJlbnROb2RlKXx8ZSk9PWUmJmxlLnNjb3BlfHwoKHM9ZS5nZXRBdHRyaWJ1dGUoImlkIikpP3M9Y2UuZXNjYXBlU2VsZWN0b3Iocyk6ZS5zZXRBdHRyaWJ1dGUoImlkIixzPVMpKSxvPShsPVkodCkpLmxlbmd0aDt3aGlsZShvLS0pbFtvXT0ocz8iIyIrczoiOnNjb3BlIikrIiAiK1EobFtvXSk7Yz1sLmpvaW4oIiwiKX10cnl7cmV0dXJuIGsuYXBwbHkobixmLnF1ZXJ5U2VsZWN0b3JBbGwoYykpLG59Y2F0Y2goZSl7aCh0LCEwKX1maW5hbGx5e3M9PT1TJiZlLnJlbW92ZUF0dHJpYnV0ZSgiaWQiKX19fXJldHVybiByZSh0LnJlcGxhY2UodmUsIiQxIiksZSxuLHIpfWZ1bmN0aW9uIFcoKXt2YXIgcj1bXTtyZXR1cm4gZnVuY3Rpb24gZSh0LG4pe3JldHVybiByLnB1c2godCsiICIpPmIuY2FjaGVMZW5ndGgmJmRlbGV0ZSBlW3Iuc2hpZnQoKV0sZVt0KyIgIl09bn19ZnVuY3Rpb24gRihlKXtyZXR1cm4gZVtTXT0hMCxlfWZ1bmN0aW9uICQoZSl7dmFyIHQ9VC5jcmVhdGVFbGVtZW50KCJmaWVsZHNldCIpO3RyeXtyZXR1cm4hIWUodCl9Y2F0Y2goZSl7cmV0dXJuITF9ZmluYWxseXt0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSx0PW51bGx9fWZ1bmN0aW9uIEIodCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBmZShlLCJpbnB1dCIpJiZlLnR5cGU9PT10fX1mdW5jdGlvbiBfKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4oZmUoZSwiaW5wdXQiKXx8ZmUoZSwiYnV0dG9uIikpJiZlLnR5cGU9PT10fX1mdW5jdGlvbiBYKHQpe3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4iZm9ybSJpbiBlP2UucGFyZW50Tm9kZSYmITE9PT1lLmRpc2FibGVkPyJsYWJlbCJpbiBlPyJsYWJlbCJpbiBlLnBhcmVudE5vZGU/ZS5wYXJlbnROb2RlLmRpc2FibGVkPT09dDplLmRpc2FibGVkPT09dDplLmlzRGlzYWJsZWQ9PT10fHxlLmlzRGlzYWJsZWQhPT0hdCYmTShlKT09PXQ6ZS5kaXNhYmxlZD09PXQ6ImxhYmVsImluIGUmJmUuZGlzYWJsZWQ9PT10fX1mdW5jdGlvbiBVKGEpe3JldHVybiBGKGZ1bmN0aW9uKG8pe3JldHVybiBvPStvLEYoZnVuY3Rpb24oZSx0KXt2YXIgbixyPWEoW10sZS5sZW5ndGgsbyksaT1yLmxlbmd0aDt3aGlsZShpLS0pZVtuPXJbaV1dJiYoZVtuXT0hKHRbbl09ZVtuXSkpfSl9KX1mdW5jdGlvbiB6KGUpe3JldHVybiBlJiYidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUmJmV9ZnVuY3Rpb24gVihlKXt2YXIgdCxuPWU/ZS5vd25lckRvY3VtZW50fHxlOnllO3JldHVybiBuIT1UJiY5PT09bi5ub2RlVHlwZSYmbi5kb2N1bWVudEVsZW1lbnQmJihyPShUPW4pLmRvY3VtZW50RWxlbWVudCxDPSFjZS5pc1hNTERvYyhUKSxpPXIubWF0Y2hlc3x8ci53ZWJraXRNYXRjaGVzU2VsZWN0b3J8fHIubXNNYXRjaGVzU2VsZWN0b3IseWUhPVQmJih0PVQuZGVmYXVsdFZpZXcpJiZ0LnRvcCE9PXQmJnQuYWRkRXZlbnRMaXN0ZW5lcigidW5sb2FkIixSKSxsZS5nZXRCeUlkPSQoZnVuY3Rpb24oZSl7cmV0dXJuIHIuYXBwZW5kQ2hpbGQoZSkuaWQ9Y2UuZXhwYW5kbywhVC5nZXRFbGVtZW50c0J5TmFtZXx8IVQuZ2V0RWxlbWVudHNCeU5hbWUoY2UuZXhwYW5kbykubGVuZ3RofSksbGUuZGlzY29ubmVjdGVkTWF0Y2g9JChmdW5jdGlvbihlKXtyZXR1cm4gaS5jYWxsKGUsIioiKX0pLGxlLnNjb3BlPSQoZnVuY3Rpb24oKXtyZXR1cm4gVC5xdWVyeVNlbGVjdG9yQWxsKCI6c2NvcGUiKX0pLGxlLmNzc0hhcz0kKGZ1bmN0aW9uKCl7dHJ5e3JldHVybiBULnF1ZXJ5U2VsZWN0b3IoIjpoYXMoKiw6anFmYWtlKSIpLCExfWNhdGNoKGUpe3JldHVybiEwfX0pLGxlLmdldEJ5SWQ/KGIuZmlsdGVyLklEPWZ1bmN0aW9uKGUpe3ZhciB0PWUucmVwbGFjZShPLFApO3JldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXRBdHRyaWJ1dGUoImlkIik9PT10fX0sYi5maW5kLklEPWZ1bmN0aW9uKGUsdCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRCeUlkJiZDKXt2YXIgbj10LmdldEVsZW1lbnRCeUlkKGUpO3JldHVybiBuP1tuXTpbXX19KTooYi5maWx0ZXIuSUQ9ZnVuY3Rpb24oZSl7dmFyIG49ZS5yZXBsYWNlKE8sUCk7cmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciB0PSJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRBdHRyaWJ1dGVOb2RlJiZlLmdldEF0dHJpYnV0ZU5vZGUoImlkIik7cmV0dXJuIHQmJnQudmFsdWU9PT1ufX0sYi5maW5kLklEPWZ1bmN0aW9uKGUsdCl7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRCeUlkJiZDKXt2YXIgbixyLGksbz10LmdldEVsZW1lbnRCeUlkKGUpO2lmKG8pe2lmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXTtpPXQuZ2V0RWxlbWVudHNCeU5hbWUoZSkscj0wO3doaWxlKG89aVtyKytdKWlmKChuPW8uZ2V0QXR0cmlidXRlTm9kZSgiaWQiKSkmJm4udmFsdWU9PT1lKXJldHVybltvXX1yZXR1cm5bXX19KSxiLmZpbmQuVEFHPWZ1bmN0aW9uKGUsdCl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiB0LmdldEVsZW1lbnRzQnlUYWdOYW1lP3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZSk6dC5xdWVyeVNlbGVjdG9yQWxsKGUpfSxiLmZpbmQuQ0xBU1M9ZnVuY3Rpb24oZSx0KXtpZigidW5kZWZpbmVkIiE9dHlwZW9mIHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSYmQylyZXR1cm4gdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGUpfSxkPVtdLCQoZnVuY3Rpb24oZSl7dmFyIHQ7ci5hcHBlbmRDaGlsZChlKS5pbm5lckhUTUw9IjxhIGlkPSciK1MrIicgaHJlZj0nJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjwvYT48c2VsZWN0IGlkPSciK1MrIi1cclxcJyBkaXNhYmxlZD0nZGlzYWJsZWQnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IixlLnF1ZXJ5U2VsZWN0b3JBbGwoIltzZWxlY3RlZF0iKS5sZW5ndGh8fGQucHVzaCgiXFxbIitnZSsiKig/OnZhbHVlfCIrZisiKSIpLGUucXVlcnlTZWxlY3RvckFsbCgiW2lkfj0iK1MrIi1dIikubGVuZ3RofHxkLnB1c2goIn49IiksZS5xdWVyeVNlbGVjdG9yQWxsKCJhIyIrUysiKyoiKS5sZW5ndGh8fGQucHVzaCgiLiMuK1srfl0iKSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RofHxkLnB1c2goIjpjaGVja2VkIiksKHQ9VC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpKS5zZXRBdHRyaWJ1dGUoInR5cGUiLCJoaWRkZW4iKSxlLmFwcGVuZENoaWxkKHQpLnNldEF0dHJpYnV0ZSgibmFtZSIsIkQiKSxyLmFwcGVuZENoaWxkKGUpLmRpc2FibGVkPSEwLDIhPT1lLnF1ZXJ5U2VsZWN0b3JBbGwoIjpkaXNhYmxlZCIpLmxlbmd0aCYmZC5wdXNoKCI6ZW5hYmxlZCIsIjpkaXNhYmxlZCIpLCh0PVQuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSkuc2V0QXR0cmlidXRlKCJuYW1lIiwiIiksZS5hcHBlbmRDaGlsZCh0KSxlLnF1ZXJ5U2VsZWN0b3JBbGwoIltuYW1lPScnXSIpLmxlbmd0aHx8ZC5wdXNoKCJcXFsiK2dlKyIqbmFtZSIrZ2UrIio9IitnZSsiKig/OicnfFwiXCIpIil9KSxsZS5jc3NIYXN8fGQucHVzaCgiOmhhcyIpLGQ9ZC5sZW5ndGgmJm5ldyBSZWdFeHAoZC5qb2luKCJ8IikpLGw9ZnVuY3Rpb24oZSx0KXtpZihlPT09dClyZXR1cm4gYT0hMCwwO3ZhciBuPSFlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uLSF0LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uO3JldHVybiBufHwoMSYobj0oZS5vd25lckRvY3VtZW50fHxlKT09KHQub3duZXJEb2N1bWVudHx8dCk/ZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbih0KToxKXx8IWxlLnNvcnREZXRhY2hlZCYmdC5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihlKT09PW4/ZT09PVR8fGUub3duZXJEb2N1bWVudD09eWUmJkkuY29udGFpbnMoeWUsZSk/LTE6dD09PVR8fHQub3duZXJEb2N1bWVudD09eWUmJkkuY29udGFpbnMoeWUsdCk/MTpvP3NlLmNhbGwobyxlKS1zZS5jYWxsKG8sdCk6MDo0Jm4/LTE6MSl9KSxUfWZvcihlIGluIEkubWF0Y2hlcz1mdW5jdGlvbihlLHQpe3JldHVybiBJKGUsbnVsbCxudWxsLHQpfSxJLm1hdGNoZXNTZWxlY3Rvcj1mdW5jdGlvbihlLHQpe2lmKFYoZSksQyYmIWhbdCsiICJdJiYoIWR8fCFkLnRlc3QodCkpKXRyeXt2YXIgbj1pLmNhbGwoZSx0KTtpZihufHxsZS5kaXNjb25uZWN0ZWRNYXRjaHx8ZS5kb2N1bWVudCYmMTEhPT1lLmRvY3VtZW50Lm5vZGVUeXBlKXJldHVybiBufWNhdGNoKGUpe2godCwhMCl9cmV0dXJuIDA8SSh0LFQsbnVsbCxbZV0pLmxlbmd0aH0sSS5jb250YWlucz1mdW5jdGlvbihlLHQpe3JldHVybihlLm93bmVyRG9jdW1lbnR8fGUpIT1UJiZWKGUpLGNlLmNvbnRhaW5zKGUsdCl9LEkuYXR0cj1mdW5jdGlvbihlLHQpeyhlLm93bmVyRG9jdW1lbnR8fGUpIT1UJiZWKGUpO3ZhciBuPWIuYXR0ckhhbmRsZVt0LnRvTG93ZXJDYXNlKCldLHI9biYmdWUuY2FsbChiLmF0dHJIYW5kbGUsdC50b0xvd2VyQ2FzZSgpKT9uKGUsdCwhQyk6dm9pZCAwO3JldHVybiB2b2lkIDAhPT1yP3I6ZS5nZXRBdHRyaWJ1dGUodCl9LEkuZXJyb3I9ZnVuY3Rpb24oZSl7dGhyb3cgbmV3IEVycm9yKCJTeW50YXggZXJyb3IsIHVucmVjb2duaXplZCBleHByZXNzaW9uOiAiK2UpfSxjZS51bmlxdWVTb3J0PWZ1bmN0aW9uKGUpe3ZhciB0LG49W10scj0wLGk9MDtpZihhPSFsZS5zb3J0U3RhYmxlLG89IWxlLnNvcnRTdGFibGUmJmFlLmNhbGwoZSwwKSxkZS5jYWxsKGUsbCksYSl7d2hpbGUodD1lW2krK10pdD09PWVbaV0mJihyPW4ucHVzaChpKSk7d2hpbGUoci0tKWhlLmNhbGwoZSxuW3JdLDEpfXJldHVybiBvPW51bGwsZX0sY2UuZm4udW5pcXVlU29ydD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnB1c2hTdGFjayhjZS51bmlxdWVTb3J0KGFlLmFwcGx5KHRoaXMpKSl9LChiPWNlLmV4cHI9e2NhY2hlTGVuZ3RoOjUwLGNyZWF0ZVBzZXVkbzpGLG1hdGNoOkQsYXR0ckhhbmRsZTp7fSxmaW5kOnt9LHJlbGF0aXZlOnsiPiI6e2RpcjoicGFyZW50Tm9kZSIsZmlyc3Q6ITB9LCIgIjp7ZGlyOiJwYXJlbnROb2RlIn0sIisiOntkaXI6InByZXZpb3VzU2libGluZyIsZmlyc3Q6ITB9LCJ+Ijp7ZGlyOiJwcmV2aW91c1NpYmxpbmcifX0scHJlRmlsdGVyOntBVFRSOmZ1bmN0aW9uKGUpe3JldHVybiBlWzFdPWVbMV0ucmVwbGFjZShPLFApLGVbM109KGVbM118fGVbNF18fGVbNV18fCIiKS5yZXBsYWNlKE8sUCksIn49Ij09PWVbMl0mJihlWzNdPSIgIitlWzNdKyIgIiksZS5zbGljZSgwLDQpfSxDSElMRDpmdW5jdGlvbihlKXtyZXR1cm4gZVsxXT1lWzFdLnRvTG93ZXJDYXNlKCksIm50aCI9PT1lWzFdLnNsaWNlKDAsMyk/KGVbM118fEkuZXJyb3IoZVswXSksZVs0XT0rKGVbNF0/ZVs1XSsoZVs2XXx8MSk6MiooImV2ZW4iPT09ZVszXXx8Im9kZCI9PT1lWzNdKSksZVs1XT0rKGVbN10rZVs4XXx8Im9kZCI9PT1lWzNdKSk6ZVszXSYmSS5lcnJvcihlWzBdKSxlfSxQU0VVRE86ZnVuY3Rpb24oZSl7dmFyIHQsbj0hZVs2XSYmZVsyXTtyZXR1cm4gRC5DSElMRC50ZXN0KGVbMF0pP251bGw6KGVbM10/ZVsyXT1lWzRdfHxlWzVdfHwiIjpuJiZqLnRlc3QobikmJih0PVkobiwhMCkpJiYodD1uLmluZGV4T2YoIikiLG4ubGVuZ3RoLXQpLW4ubGVuZ3RoKSYmKGVbMF09ZVswXS5zbGljZSgwLHQpLGVbMl09bi5zbGljZSgwLHQpKSxlLnNsaWNlKDAsMykpfX0sZmlsdGVyOntUQUc6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5yZXBsYWNlKE8sUCkudG9Mb3dlckNhc2UoKTtyZXR1cm4iKiI9PT1lP2Z1bmN0aW9uKCl7cmV0dXJuITB9OmZ1bmN0aW9uKGUpe3JldHVybiBmZShlLHQpfX0sQ0xBU1M6ZnVuY3Rpb24oZSl7dmFyIHQ9c1tlKyIgIl07cmV0dXJuIHR8fCh0PW5ldyBSZWdFeHAoIihefCIrZ2UrIikiK2UrIigiK2dlKyJ8JCkiKSkmJnMoZSxmdW5jdGlvbihlKXtyZXR1cm4gdC50ZXN0KCJzdHJpbmciPT10eXBlb2YgZS5jbGFzc05hbWUmJmUuY2xhc3NOYW1lfHwidW5kZWZpbmVkIiE9dHlwZW9mIGUuZ2V0QXR0cmlidXRlJiZlLmdldEF0dHJpYnV0ZSgiY2xhc3MiKXx8IiIpfSl9LEFUVFI6ZnVuY3Rpb24obixyLGkpe3JldHVybiBmdW5jdGlvbihlKXt2YXIgdD1JLmF0dHIoZSxuKTtyZXR1cm4gbnVsbD09dD8iIT0iPT09cjohcnx8KHQrPSIiLCI9Ij09PXI/dD09PWk6IiE9Ij09PXI/dCE9PWk6Il49Ij09PXI/aSYmMD09PXQuaW5kZXhPZihpKToiKj0iPT09cj9pJiYtMTx0LmluZGV4T2YoaSk6IiQ9Ij09PXI/aSYmdC5zbGljZSgtaS5sZW5ndGgpPT09aToifj0iPT09cj8tMTwoIiAiK3QucmVwbGFjZSh2LCIgIikrIiAiKS5pbmRleE9mKGkpOiJ8PSI9PT1yJiYodD09PWl8fHQuc2xpY2UoMCxpLmxlbmd0aCsxKT09PWkrIi0iKSl9fSxDSElMRDpmdW5jdGlvbihkLGUsdCxoLGcpe3ZhciB2PSJudGgiIT09ZC5zbGljZSgwLDMpLHk9Imxhc3QiIT09ZC5zbGljZSgtNCksbT0ib2YtdHlwZSI9PT1lO3JldHVybiAxPT09aCYmMD09PWc/ZnVuY3Rpb24oZSl7cmV0dXJuISFlLnBhcmVudE5vZGV9OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzLHU9diE9PXk/Im5leHRTaWJsaW5nIjoicHJldmlvdXNTaWJsaW5nIixsPWUucGFyZW50Tm9kZSxjPW0mJmUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxmPSFuJiYhbSxwPSExO2lmKGwpe2lmKHYpe3doaWxlKHUpe289ZTt3aGlsZShvPW9bdV0paWYobT9mZShvLGMpOjE9PT1vLm5vZGVUeXBlKXJldHVybiExO3M9dT0ib25seSI9PT1kJiYhcyYmIm5leHRTaWJsaW5nIn1yZXR1cm4hMH1pZihzPVt5P2wuZmlyc3RDaGlsZDpsLmxhc3RDaGlsZF0seSYmZil7cD0oYT0ocj0oaT1sW1NdfHwobFtTXT17fSkpW2RdfHxbXSlbMF09PT1FJiZyWzFdKSYmclsyXSxvPWEmJmwuY2hpbGROb2Rlc1thXTt3aGlsZShvPSsrYSYmbyYmb1t1XXx8KHA9YT0wKXx8cy5wb3AoKSlpZigxPT09by5ub2RlVHlwZSYmKytwJiZvPT09ZSl7aVtkXT1bRSxhLHBdO2JyZWFrfX1lbHNlIGlmKGYmJihwPWE9KHI9KGk9ZVtTXXx8KGVbU109e30pKVtkXXx8W10pWzBdPT09RSYmclsxXSksITE9PT1wKXdoaWxlKG89KythJiZvJiZvW3VdfHwocD1hPTApfHxzLnBvcCgpKWlmKChtP2ZlKG8sYyk6MT09PW8ubm9kZVR5cGUpJiYrK3AmJihmJiYoKGk9b1tTXXx8KG9bU109e30pKVtkXT1bRSxwXSksbz09PWUpKWJyZWFrO3JldHVybihwLT1nKT09PWh8fHAlaD09MCYmMDw9cC9ofX19LFBTRVVETzpmdW5jdGlvbihlLG8pe3ZhciB0LGE9Yi5wc2V1ZG9zW2VdfHxiLnNldEZpbHRlcnNbZS50b0xvd2VyQ2FzZSgpXXx8SS5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiK2UpO3JldHVybiBhW1NdP2Eobyk6MTxhLmxlbmd0aD8odD1bZSxlLCIiLG9dLGIuc2V0RmlsdGVycy5oYXNPd25Qcm9wZXJ0eShlLnRvTG93ZXJDYXNlKCkpP0YoZnVuY3Rpb24oZSx0KXt2YXIgbixyPWEoZSxvKSxpPXIubGVuZ3RoO3doaWxlKGktLSllW249c2UuY2FsbChlLHJbaV0pXT0hKHRbbl09cltpXSl9KTpmdW5jdGlvbihlKXtyZXR1cm4gYShlLDAsdCl9KTphfX0scHNldWRvczp7bm90OkYoZnVuY3Rpb24oZSl7dmFyIHI9W10saT1bXSxzPW5lKGUucmVwbGFjZSh2ZSwiJDEiKSk7cmV0dXJuIHNbU10/RihmdW5jdGlvbihlLHQsbixyKXt2YXIgaSxvPXMoZSxudWxsLHIsW10pLGE9ZS5sZW5ndGg7d2hpbGUoYS0tKShpPW9bYV0pJiYoZVthXT0hKHRbYV09aSkpfSk6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiByWzBdPWUscyhyLG51bGwsbixpKSxyWzBdPW51bGwsIWkucG9wKCl9fSksaGFzOkYoZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiAwPEkodCxlKS5sZW5ndGh9fSksY29udGFpbnM6RihmdW5jdGlvbih0KXtyZXR1cm4gdD10LnJlcGxhY2UoTyxQKSxmdW5jdGlvbihlKXtyZXR1cm4tMTwoZS50ZXh0Q29udGVudHx8Y2UudGV4dChlKSkuaW5kZXhPZih0KX19KSxsYW5nOkYoZnVuY3Rpb24obil7cmV0dXJuIEEudGVzdChufHwiIil8fEkuZXJyb3IoInVuc3VwcG9ydGVkIGxhbmc6ICIrbiksbj1uLnJlcGxhY2UoTyxQKS50b0xvd2VyQ2FzZSgpLGZ1bmN0aW9uKGUpe3ZhciB0O2Rve2lmKHQ9Qz9lLmxhbmc6ZS5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIil8fGUuZ2V0QXR0cmlidXRlKCJsYW5nIikpcmV0dXJuKHQ9dC50b0xvd2VyQ2FzZSgpKT09PW58fDA9PT10LmluZGV4T2YobisiLSIpfXdoaWxlKChlPWUucGFyZW50Tm9kZSkmJjE9PT1lLm5vZGVUeXBlKTtyZXR1cm4hMX19KSx0YXJnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9aWUubG9jYXRpb24mJmllLmxvY2F0aW9uLmhhc2g7cmV0dXJuIHQmJnQuc2xpY2UoMSk9PT1lLmlkfSxyb290OmZ1bmN0aW9uKGUpe3JldHVybiBlPT09cn0sZm9jdXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1mdW5jdGlvbigpe3RyeXtyZXR1cm4gVC5hY3RpdmVFbGVtZW50fWNhdGNoKGUpe319KCkmJlQuaGFzRm9jdXMoKSYmISEoZS50eXBlfHxlLmhyZWZ8fH5lLnRhYkluZGV4KX0sZW5hYmxlZDpYKCExKSxkaXNhYmxlZDpYKCEwKSxjaGVja2VkOmZ1bmN0aW9uKGUpe3JldHVybiBmZShlLCJpbnB1dCIpJiYhIWUuY2hlY2tlZHx8ZmUoZSwib3B0aW9uIikmJiEhZS5zZWxlY3RlZH0sc2VsZWN0ZWQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGUucGFyZW50Tm9kZSYmZS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsITA9PT1lLnNlbGVjdGVkfSxlbXB0eTpmdW5jdGlvbihlKXtmb3IoZT1lLmZpcnN0Q2hpbGQ7ZTtlPWUubmV4dFNpYmxpbmcpaWYoZS5ub2RlVHlwZTw2KXJldHVybiExO3JldHVybiEwfSxwYXJlbnQ6ZnVuY3Rpb24oZSl7cmV0dXJuIWIucHNldWRvcy5lbXB0eShlKX0saGVhZGVyOmZ1bmN0aW9uKGUpe3JldHVybiBxLnRlc3QoZS5ub2RlTmFtZSl9LGlucHV0OmZ1bmN0aW9uKGUpe3JldHVybiBOLnRlc3QoZS5ub2RlTmFtZSl9LGJ1dHRvbjpmdW5jdGlvbihlKXtyZXR1cm4gZmUoZSwiaW5wdXQiKSYmImJ1dHRvbiI9PT1lLnR5cGV8fGZlKGUsImJ1dHRvbiIpfSx0ZXh0OmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiBmZShlLCJpbnB1dCIpJiYidGV4dCI9PT1lLnR5cGUmJihudWxsPT0odD1lLmdldEF0dHJpYnV0ZSgidHlwZSIpKXx8InRleHQiPT09dC50b0xvd2VyQ2FzZSgpKX0sZmlyc3Q6VShmdW5jdGlvbigpe3JldHVyblswXX0pLGxhc3Q6VShmdW5jdGlvbihlLHQpe3JldHVyblt0LTFdfSksZXE6VShmdW5jdGlvbihlLHQsbil7cmV0dXJuW248MD9uK3Q6bl19KSxldmVuOlUoZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49MDtuPHQ7bis9MillLnB1c2gobik7cmV0dXJuIGV9KSxvZGQ6VShmdW5jdGlvbihlLHQpe2Zvcih2YXIgbj0xO248dDtuKz0yKWUucHVzaChuKTtyZXR1cm4gZX0pLGx0OlUoZnVuY3Rpb24oZSx0LG4pe3ZhciByO2ZvcihyPW48MD9uK3Q6dDxuP3Q6bjswPD0tLXI7KWUucHVzaChyKTtyZXR1cm4gZX0pLGd0OlUoZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj1uPDA/bit0Om47KytyPHQ7KWUucHVzaChyKTtyZXR1cm4gZX0pfX0pLnBzZXVkb3MubnRoPWIucHNldWRvcy5lcSx7cmFkaW86ITAsY2hlY2tib3g6ITAsZmlsZTohMCxwYXNzd29yZDohMCxpbWFnZTohMH0pYi5wc2V1ZG9zW2VdPUIoZSk7Zm9yKGUgaW57c3VibWl0OiEwLHJlc2V0OiEwfSliLnBzZXVkb3NbZV09XyhlKTtmdW5jdGlvbiBHKCl7fWZ1bmN0aW9uIFkoZSx0KXt2YXIgbixyLGksbyxhLHMsdSxsPWNbZSsiICJdO2lmKGwpcmV0dXJuIHQ/MDpsLnNsaWNlKDApO2E9ZSxzPVtdLHU9Yi5wcmVGaWx0ZXI7d2hpbGUoYSl7Zm9yKG8gaW4gbiYmIShyPXkuZXhlYyhhKSl8fChyJiYoYT1hLnNsaWNlKHJbMF0ubGVuZ3RoKXx8YSkscy5wdXNoKGk9W10pKSxuPSExLChyPW0uZXhlYyhhKSkmJihuPXIuc2hpZnQoKSxpLnB1c2goe3ZhbHVlOm4sdHlwZTpyWzBdLnJlcGxhY2UodmUsIiAiKX0pLGE9YS5zbGljZShuLmxlbmd0aCkpLGIuZmlsdGVyKSEocj1EW29dLmV4ZWMoYSkpfHx1W29dJiYhKHI9dVtvXShyKSl8fChuPXIuc2hpZnQoKSxpLnB1c2goe3ZhbHVlOm4sdHlwZTpvLG1hdGNoZXM6cn0pLGE9YS5zbGljZShuLmxlbmd0aCkpO2lmKCFuKWJyZWFrfXJldHVybiB0P2EubGVuZ3RoOmE/SS5lcnJvcihlKTpjKGUscykuc2xpY2UoMCl9ZnVuY3Rpb24gUShlKXtmb3IodmFyIHQ9MCxuPWUubGVuZ3RoLHI9IiI7dDxuO3QrKylyKz1lW3RdLnZhbHVlO3JldHVybiByfWZ1bmN0aW9uIEooYSxlLHQpe3ZhciBzPWUuZGlyLHU9ZS5uZXh0LGw9dXx8cyxjPXQmJiJwYXJlbnROb2RlIj09PWwsZj1uKys7cmV0dXJuIGUuZmlyc3Q/ZnVuY3Rpb24oZSx0LG4pe3doaWxlKGU9ZVtzXSlpZigxPT09ZS5ub2RlVHlwZXx8YylyZXR1cm4gYShlLHQsbik7cmV0dXJuITF9OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89W0UsZl07aWYobil7d2hpbGUoZT1lW3NdKWlmKCgxPT09ZS5ub2RlVHlwZXx8YykmJmEoZSx0LG4pKXJldHVybiEwfWVsc2Ugd2hpbGUoZT1lW3NdKWlmKDE9PT1lLm5vZGVUeXBlfHxjKWlmKGk9ZVtTXXx8KGVbU109e30pLHUmJmZlKGUsdSkpZT1lW3NdfHxlO2Vsc2V7aWYoKHI9aVtsXSkmJnJbMF09PT1FJiZyWzFdPT09ZilyZXR1cm4gb1syXT1yWzJdO2lmKChpW2xdPW8pWzJdPWEoZSx0LG4pKXJldHVybiEwfXJldHVybiExfX1mdW5jdGlvbiBLKGkpe3JldHVybiAxPGkubGVuZ3RoP2Z1bmN0aW9uKGUsdCxuKXt2YXIgcj1pLmxlbmd0aDt3aGlsZShyLS0paWYoIWlbcl0oZSx0LG4pKXJldHVybiExO3JldHVybiEwfTppWzBdfWZ1bmN0aW9uIFooZSx0LG4scixpKXtmb3IodmFyIG8sYT1bXSxzPTAsdT1lLmxlbmd0aCxsPW51bGwhPXQ7czx1O3MrKykobz1lW3NdKSYmKG4mJiFuKG8scixpKXx8KGEucHVzaChvKSxsJiZ0LnB1c2gocykpKTtyZXR1cm4gYX1mdW5jdGlvbiBlZShkLGgsZyx2LHksZSl7cmV0dXJuIHYmJiF2W1NdJiYodj1lZSh2KSkseSYmIXlbU10mJih5PWVlKHksZSkpLEYoZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHMsdT1bXSxsPVtdLGM9dC5sZW5ndGgsZj1lfHxmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPTAsaT10Lmxlbmd0aDtyPGk7cisrKUkoZSx0W3JdLG4pO3JldHVybiBufShofHwiKiIsbi5ub2RlVHlwZT9bbl06bixbXSkscD0hZHx8IWUmJmg/ZjpaKGYsdSxkLG4scik7aWYoZz9nKHAscz15fHwoZT9kOmN8fHYpP1tdOnQsbixyKTpzPXAsdil7aT1aKHMsbCksdihpLFtdLG4sciksbz1pLmxlbmd0aDt3aGlsZShvLS0pKGE9aVtvXSkmJihzW2xbb11dPSEocFtsW29dXT1hKSl9aWYoZSl7aWYoeXx8ZCl7aWYoeSl7aT1bXSxvPXMubGVuZ3RoO3doaWxlKG8tLSkoYT1zW29dKSYmaS5wdXNoKHBbb109YSk7eShudWxsLHM9W10saSxyKX1vPXMubGVuZ3RoO3doaWxlKG8tLSkoYT1zW29dKSYmLTE8KGk9eT9zZS5jYWxsKGUsYSk6dVtvXSkmJihlW2ldPSEodFtpXT1hKSl9fWVsc2Ugcz1aKHM9PT10P3Muc3BsaWNlKGMscy5sZW5ndGgpOnMpLHk/eShudWxsLHQscyxyKTprLmFwcGx5KHQscyl9KX1mdW5jdGlvbiB0ZShlKXtmb3IodmFyIGksdCxuLHI9ZS5sZW5ndGgsbz1iLnJlbGF0aXZlW2VbMF0udHlwZV0sYT1vfHxiLnJlbGF0aXZlWyIgIl0scz1vPzE6MCx1PUooZnVuY3Rpb24oZSl7cmV0dXJuIGU9PT1pfSxhLCEwKSxsPUooZnVuY3Rpb24oZSl7cmV0dXJuLTE8c2UuY2FsbChpLGUpfSxhLCEwKSxjPVtmdW5jdGlvbihlLHQsbil7dmFyIHI9IW8mJihufHx0IT13KXx8KChpPXQpLm5vZGVUeXBlP3UoZSx0LG4pOmwoZSx0LG4pKTtyZXR1cm4gaT1udWxsLHJ9XTtzPHI7cysrKWlmKHQ9Yi5yZWxhdGl2ZVtlW3NdLnR5cGVdKWM9W0ooSyhjKSx0KV07ZWxzZXtpZigodD1iLmZpbHRlcltlW3NdLnR5cGVdLmFwcGx5KG51bGwsZVtzXS5tYXRjaGVzKSlbU10pe2ZvcihuPSsrcztuPHI7bisrKWlmKGIucmVsYXRpdmVbZVtuXS50eXBlXSlicmVhaztyZXR1cm4gZWUoMTxzJiZLKGMpLDE8cyYmUShlLnNsaWNlKDAscy0xKS5jb25jYXQoe3ZhbHVlOiIgIj09PWVbcy0yXS50eXBlPyIqIjoiIn0pKS5yZXBsYWNlKHZlLCIkMSIpLHQsczxuJiZ0ZShlLnNsaWNlKHMsbikpLG48ciYmdGUoZT1lLnNsaWNlKG4pKSxuPHImJlEoZSkpfWMucHVzaCh0KX1yZXR1cm4gSyhjKX1mdW5jdGlvbiBuZShlLHQpe3ZhciBuLHYseSxtLHgscixpPVtdLG89W10sYT11W2UrIiAiXTtpZighYSl7dHx8KHQ9WShlKSksbj10Lmxlbmd0aDt3aGlsZShuLS0pKGE9dGUodFtuXSkpW1NdP2kucHVzaChhKTpvLnB1c2goYSk7KGE9dShlLCh2PW8sbT0wPCh5PWkpLmxlbmd0aCx4PTA8di5sZW5ndGgscj1mdW5jdGlvbihlLHQsbixyLGkpe3ZhciBvLGEscyx1PTAsbD0iMCIsYz1lJiZbXSxmPVtdLHA9dyxkPWV8fHgmJmIuZmluZC5UQUcoIioiLGkpLGg9RSs9bnVsbD09cD8xOk1hdGgucmFuZG9tKCl8fC4xLGc9ZC5sZW5ndGg7Zm9yKGkmJih3PXQ9PVR8fHR8fGkpO2whPT1nJiZudWxsIT0obz1kW2xdKTtsKyspe2lmKHgmJm8pe2E9MCx0fHxvLm93bmVyRG9jdW1lbnQ9PVR8fChWKG8pLG49IUMpO3doaWxlKHM9dlthKytdKWlmKHMobyx0fHxULG4pKXtrLmNhbGwocixvKTticmVha31pJiYoRT1oKX1tJiYoKG89IXMmJm8pJiZ1LS0sZSYmYy5wdXNoKG8pKX1pZih1Kz1sLG0mJmwhPT11KXthPTA7d2hpbGUocz15W2ErK10pcyhjLGYsdCxuKTtpZihlKXtpZigwPHUpd2hpbGUobC0tKWNbbF18fGZbbF18fChmW2xdPXBlLmNhbGwocikpO2Y9WihmKX1rLmFwcGx5KHIsZiksaSYmIWUmJjA8Zi5sZW5ndGgmJjE8dSt5Lmxlbmd0aCYmY2UudW5pcXVlU29ydChyKX1yZXR1cm4gaSYmKEU9aCx3PXApLGN9LG0/RihyKTpyKSkpLnNlbGVjdG9yPWV9cmV0dXJuIGF9ZnVuY3Rpb24gcmUoZSx0LG4scil7dmFyIGksbyxhLHMsdSxsPSJmdW5jdGlvbiI9PXR5cGVvZiBlJiZlLGM9IXImJlkoZT1sLnNlbGVjdG9yfHxlKTtpZihuPW58fFtdLDE9PT1jLmxlbmd0aCl7aWYoMjwobz1jWzBdPWNbMF0uc2xpY2UoMCkpLmxlbmd0aCYmIklEIj09PShhPW9bMF0pLnR5cGUmJjk9PT10Lm5vZGVUeXBlJiZDJiZiLnJlbGF0aXZlW29bMV0udHlwZV0pe2lmKCEodD0oYi5maW5kLklEKGEubWF0Y2hlc1swXS5yZXBsYWNlKE8sUCksdCl8fFtdKVswXSkpcmV0dXJuIG47bCYmKHQ9dC5wYXJlbnROb2RlKSxlPWUuc2xpY2Uoby5zaGlmdCgpLnZhbHVlLmxlbmd0aCl9aT1ELm5lZWRzQ29udGV4dC50ZXN0KGUpPzA6by5sZW5ndGg7d2hpbGUoaS0tKXtpZihhPW9baV0sYi5yZWxhdGl2ZVtzPWEudHlwZV0pYnJlYWs7aWYoKHU9Yi5maW5kW3NdKSYmKHI9dShhLm1hdGNoZXNbMF0ucmVwbGFjZShPLFApLEgudGVzdChvWzBdLnR5cGUpJiZ6KHQucGFyZW50Tm9kZSl8fHQpKSl7aWYoby5zcGxpY2UoaSwxKSwhKGU9ci5sZW5ndGgmJlEobykpKXJldHVybiBrLmFwcGx5KG4sciksbjticmVha319fXJldHVybihsfHxuZShlLGMpKShyLHQsIUMsbiwhdHx8SC50ZXN0KGUpJiZ6KHQucGFyZW50Tm9kZSl8fHQpLG59Ry5wcm90b3R5cGU9Yi5maWx0ZXJzPWIucHNldWRvcyxiLnNldEZpbHRlcnM9bmV3IEcsbGUuc29ydFN0YWJsZT1TLnNwbGl0KCIiKS5zb3J0KGwpLmpvaW4oIiIpPT09UyxWKCksbGUuc29ydERldGFjaGVkPSQoZnVuY3Rpb24oZSl7cmV0dXJuIDEmZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihULmNyZWF0ZUVsZW1lbnQoImZpZWxkc2V0IikpfSksY2UuZmluZD1JLGNlLmV4cHJbIjoiXT1jZS5leHByLnBzZXVkb3MsY2UudW5pcXVlPWNlLnVuaXF1ZVNvcnQsSS5jb21waWxlPW5lLEkuc2VsZWN0PXJlLEkuc2V0RG9jdW1lbnQ9VixJLmVzY2FwZT1jZS5lc2NhcGVTZWxlY3RvcixJLmdldFRleHQ9Y2UudGV4dCxJLmlzWE1MPWNlLmlzWE1MRG9jLEkuc2VsZWN0b3JzPWNlLmV4cHIsSS5zdXBwb3J0PWNlLnN1cHBvcnQsSS51bmlxdWVTb3J0PWNlLnVuaXF1ZVNvcnR9KCk7dmFyIGQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPVtdLGk9dm9pZCAwIT09bjt3aGlsZSgoZT1lW3RdKSYmOSE9PWUubm9kZVR5cGUpaWYoMT09PWUubm9kZVR5cGUpe2lmKGkmJmNlKGUpLmlzKG4pKWJyZWFrO3IucHVzaChlKX1yZXR1cm4gcn0saD1mdW5jdGlvbihlLHQpe2Zvcih2YXIgbj1bXTtlO2U9ZS5uZXh0U2libGluZykxPT09ZS5ub2RlVHlwZSYmZSE9PXQmJm4ucHVzaChlKTtyZXR1cm4gbn0sYj1jZS5leHByLm1hdGNoLm5lZWRzQ29udGV4dCx3PS9ePChbYS16XVteXC9cMD46XHgyMFx0XHJcblxmXSopW1x4MjBcdFxyXG5cZl0qXC8/Pig/OjxcL1wxPnwpJC9pO2Z1bmN0aW9uIFQoZSxuLHIpe3JldHVybiB2KG4pP2NlLmdyZXAoZSxmdW5jdGlvbihlLHQpe3JldHVybiEhbi5jYWxsKGUsdCxlKSE9PXJ9KTpuLm5vZGVUeXBlP2NlLmdyZXAoZSxmdW5jdGlvbihlKXtyZXR1cm4gZT09PW4hPT1yfSk6InN0cmluZyIhPXR5cGVvZiBuP2NlLmdyZXAoZSxmdW5jdGlvbihlKXtyZXR1cm4tMTxzZS5jYWxsKG4sZSkhPT1yfSk6Y2UuZmlsdGVyKG4sZSxyKX1jZS5maWx0ZXI9ZnVuY3Rpb24oZSx0LG4pe3ZhciByPXRbMF07cmV0dXJuIG4mJihlPSI6bm90KCIrZSsiKSIpLDE9PT10Lmxlbmd0aCYmMT09PXIubm9kZVR5cGU/Y2UuZmluZC5tYXRjaGVzU2VsZWN0b3IocixlKT9bcl06W106Y2UuZmluZC5tYXRjaGVzKGUsY2UuZ3JlcCh0LGZ1bmN0aW9uKGUpe3JldHVybiAxPT09ZS5ub2RlVHlwZX0pKX0sY2UuZm4uZXh0ZW5kKHtmaW5kOmZ1bmN0aW9uKGUpe3ZhciB0LG4scj10aGlzLmxlbmd0aCxpPXRoaXM7aWYoInN0cmluZyIhPXR5cGVvZiBlKXJldHVybiB0aGlzLnB1c2hTdGFjayhjZShlKS5maWx0ZXIoZnVuY3Rpb24oKXtmb3IodD0wO3Q8cjt0KyspaWYoY2UuY29udGFpbnMoaVt0XSx0aGlzKSlyZXR1cm4hMH0pKTtmb3Iobj10aGlzLnB1c2hTdGFjayhbXSksdD0wO3Q8cjt0KyspY2UuZmluZChlLGlbdF0sbik7cmV0dXJuIDE8cj9jZS51bmlxdWVTb3J0KG4pOm59LGZpbHRlcjpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soVCh0aGlzLGV8fFtdLCExKSl9LG5vdDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wdXNoU3RhY2soVCh0aGlzLGV8fFtdLCEwKSl9LGlzOmZ1bmN0aW9uKGUpe3JldHVybiEhVCh0aGlzLCJzdHJpbmciPT10eXBlb2YgZSYmYi50ZXN0KGUpP2NlKGUpOmV8fFtdLCExKS5sZW5ndGh9fSk7dmFyIGssUz0vXig/OlxzKig8W1x3XFddKz4pW14+XSp8IyhbXHctXSspKSQvOyhjZS5mbi5pbml0PWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpO2lmKCFlKXJldHVybiB0aGlzO2lmKG49bnx8aywic3RyaW5nIj09dHlwZW9mIGUpe2lmKCEocj0iPCI9PT1lWzBdJiYiPiI9PT1lW2UubGVuZ3RoLTFdJiYzPD1lLmxlbmd0aD9bbnVsbCxlLG51bGxdOlMuZXhlYyhlKSl8fCFyWzFdJiZ0KXJldHVybiF0fHx0LmpxdWVyeT8odHx8bikuZmluZChlKTp0aGlzLmNvbnN0cnVjdG9yKHQpLmZpbmQoZSk7aWYoclsxXSl7aWYodD10IGluc3RhbmNlb2YgY2U/dFswXTp0LGNlLm1lcmdlKHRoaXMsY2UucGFyc2VIVE1MKHJbMV0sdCYmdC5ub2RlVHlwZT90Lm93bmVyRG9jdW1lbnR8fHQ6QywhMCkpLHcudGVzdChyWzFdKSYmY2UuaXNQbGFpbk9iamVjdCh0KSlmb3IociBpbiB0KXYodGhpc1tyXSk/dGhpc1tyXSh0W3JdKTp0aGlzLmF0dHIocix0W3JdKTtyZXR1cm4gdGhpc31yZXR1cm4oaT1DLmdldEVsZW1lbnRCeUlkKHJbMl0pKSYmKHRoaXNbMF09aSx0aGlzLmxlbmd0aD0xKSx0aGlzfXJldHVybiBlLm5vZGVUeXBlPyh0aGlzWzBdPWUsdGhpcy5sZW5ndGg9MSx0aGlzKTp2KGUpP3ZvaWQgMCE9PW4ucmVhZHk/bi5yZWFkeShlKTplKGNlKTpjZS5tYWtlQXJyYXkoZSx0aGlzKX0pLnByb3RvdHlwZT1jZS5mbixrPWNlKEMpO3ZhciBFPS9eKD86cGFyZW50c3xwcmV2KD86VW50aWx8QWxsKSkvLGo9e2NoaWxkcmVuOiEwLGNvbnRlbnRzOiEwLG5leHQ6ITAscHJldjohMH07ZnVuY3Rpb24gQShlLHQpe3doaWxlKChlPWVbdF0pJiYxIT09ZS5ub2RlVHlwZSk7cmV0dXJuIGV9Y2UuZm4uZXh0ZW5kKHtoYXM6ZnVuY3Rpb24oZSl7dmFyIHQ9Y2UoZSx0aGlzKSxuPXQubGVuZ3RoO3JldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbigpe2Zvcih2YXIgZT0wO2U8bjtlKyspaWYoY2UuY29udGFpbnModGhpcyx0W2VdKSlyZXR1cm4hMH0pfSxjbG9zZXN0OmZ1bmN0aW9uKGUsdCl7dmFyIG4scj0wLGk9dGhpcy5sZW5ndGgsbz1bXSxhPSJzdHJpbmciIT10eXBlb2YgZSYmY2UoZSk7aWYoIWIudGVzdChlKSlmb3IoO3I8aTtyKyspZm9yKG49dGhpc1tyXTtuJiZuIT09dDtuPW4ucGFyZW50Tm9kZSlpZihuLm5vZGVUeXBlPDExJiYoYT8tMTxhLmluZGV4KG4pOjE9PT1uLm5vZGVUeXBlJiZjZS5maW5kLm1hdGNoZXNTZWxlY3RvcihuLGUpKSl7by5wdXNoKG4pO2JyZWFrfXJldHVybiB0aGlzLnB1c2hTdGFjaygxPG8ubGVuZ3RoP2NlLnVuaXF1ZVNvcnQobyk6byl9LGluZGV4OmZ1bmN0aW9uKGUpe3JldHVybiBlPyJzdHJpbmciPT10eXBlb2YgZT9zZS5jYWxsKGNlKGUpLHRoaXNbMF0pOnNlLmNhbGwodGhpcyxlLmpxdWVyeT9lWzBdOmUpOnRoaXNbMF0mJnRoaXNbMF0ucGFyZW50Tm9kZT90aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aDotMX0sYWRkOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMucHVzaFN0YWNrKGNlLnVuaXF1ZVNvcnQoY2UubWVyZ2UodGhpcy5nZXQoKSxjZShlLHQpKSkpfSxhZGRCYWNrOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmFkZChudWxsPT1lP3RoaXMucHJldk9iamVjdDp0aGlzLnByZXZPYmplY3QuZmlsdGVyKGUpKX19KSxjZS5lYWNoKHtwYXJlbnQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3JldHVybiB0JiYxMSE9PXQubm9kZVR5cGU/dDpudWxsfSxwYXJlbnRzOmZ1bmN0aW9uKGUpe3JldHVybiBkKGUsInBhcmVudE5vZGUiKX0scGFyZW50c1VudGlsOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gZChlLCJwYXJlbnROb2RlIixuKX0sbmV4dDpmdW5jdGlvbihlKXtyZXR1cm4gQShlLCJuZXh0U2libGluZyIpfSxwcmV2OmZ1bmN0aW9uKGUpe3JldHVybiBBKGUsInByZXZpb3VzU2libGluZyIpfSxuZXh0QWxsOmZ1bmN0aW9uKGUpe3JldHVybiBkKGUsIm5leHRTaWJsaW5nIil9LHByZXZBbGw6ZnVuY3Rpb24oZSl7cmV0dXJuIGQoZSwicHJldmlvdXNTaWJsaW5nIil9LG5leHRVbnRpbDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGQoZSwibmV4dFNpYmxpbmciLG4pfSxwcmV2VW50aWw6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBkKGUsInByZXZpb3VzU2libGluZyIsbil9LHNpYmxpbmdzOmZ1bmN0aW9uKGUpe3JldHVybiBoKChlLnBhcmVudE5vZGV8fHt9KS5maXJzdENoaWxkLGUpfSxjaGlsZHJlbjpmdW5jdGlvbihlKXtyZXR1cm4gaChlLmZpcnN0Q2hpbGQpfSxjb250ZW50czpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZS5jb250ZW50RG9jdW1lbnQmJnIoZS5jb250ZW50RG9jdW1lbnQpP2UuY29udGVudERvY3VtZW50OihmZShlLCJ0ZW1wbGF0ZSIpJiYoZT1lLmNvbnRlbnR8fGUpLGNlLm1lcmdlKFtdLGUuY2hpbGROb2RlcykpfX0sZnVuY3Rpb24ocixpKXtjZS5mbltyXT1mdW5jdGlvbihlLHQpe3ZhciBuPWNlLm1hcCh0aGlzLGksZSk7cmV0dXJuIlVudGlsIiE9PXIuc2xpY2UoLTUpJiYodD1lKSx0JiYic3RyaW5nIj09dHlwZW9mIHQmJihuPWNlLmZpbHRlcih0LG4pKSwxPHRoaXMubGVuZ3RoJiYoaltyXXx8Y2UudW5pcXVlU29ydChuKSxFLnRlc3QocikmJm4ucmV2ZXJzZSgpKSx0aGlzLnB1c2hTdGFjayhuKX19KTt2YXIgRD0vW15ceDIwXHRcclxuXGZdKy9nO2Z1bmN0aW9uIE4oZSl7cmV0dXJuIGV9ZnVuY3Rpb24gcShlKXt0aHJvdyBlfWZ1bmN0aW9uIEwoZSx0LG4scil7dmFyIGk7dHJ5e2UmJnYoaT1lLnByb21pc2UpP2kuY2FsbChlKS5kb25lKHQpLmZhaWwobik6ZSYmdihpPWUudGhlbik/aS5jYWxsKGUsdCxuKTp0LmFwcGx5KHZvaWQgMCxbZV0uc2xpY2UocikpfWNhdGNoKGUpe24uYXBwbHkodm9pZCAwLFtlXSl9fWNlLkNhbGxiYWNrcz1mdW5jdGlvbihyKXt2YXIgZSxuO3I9InN0cmluZyI9PXR5cGVvZiByPyhlPXIsbj17fSxjZS5lYWNoKGUubWF0Y2goRCl8fFtdLGZ1bmN0aW9uKGUsdCl7blt0XT0hMH0pLG4pOmNlLmV4dGVuZCh7fSxyKTt2YXIgaSx0LG8sYSxzPVtdLHU9W10sbD0tMSxjPWZ1bmN0aW9uKCl7Zm9yKGE9YXx8ci5vbmNlLG89aT0hMDt1Lmxlbmd0aDtsPS0xKXt0PXUuc2hpZnQoKTt3aGlsZSgrK2w8cy5sZW5ndGgpITE9PT1zW2xdLmFwcGx5KHRbMF0sdFsxXSkmJnIuc3RvcE9uRmFsc2UmJihsPXMubGVuZ3RoLHQ9ITEpfXIubWVtb3J5fHwodD0hMSksaT0hMSxhJiYocz10P1tdOiIiKX0sZj17YWRkOmZ1bmN0aW9uKCl7cmV0dXJuIHMmJih0JiYhaSYmKGw9cy5sZW5ndGgtMSx1LnB1c2godCkpLGZ1bmN0aW9uIG4oZSl7Y2UuZWFjaChlLGZ1bmN0aW9uKGUsdCl7dih0KT9yLnVuaXF1ZSYmZi5oYXModCl8fHMucHVzaCh0KTp0JiZ0Lmxlbmd0aCYmInN0cmluZyIhPT14KHQpJiZuKHQpfSl9KGFyZ3VtZW50cyksdCYmIWkmJmMoKSksdGhpc30scmVtb3ZlOmZ1bmN0aW9uKCl7cmV0dXJuIGNlLmVhY2goYXJndW1lbnRzLGZ1bmN0aW9uKGUsdCl7dmFyIG47d2hpbGUoLTE8KG49Y2UuaW5BcnJheSh0LHMsbikpKXMuc3BsaWNlKG4sMSksbjw9bCYmbC0tfSksdGhpc30saGFzOmZ1bmN0aW9uKGUpe3JldHVybiBlPy0xPGNlLmluQXJyYXkoZSxzKTowPHMubGVuZ3RofSxlbXB0eTpmdW5jdGlvbigpe3JldHVybiBzJiYocz1bXSksdGhpc30sZGlzYWJsZTpmdW5jdGlvbigpe3JldHVybiBhPXU9W10scz10PSIiLHRoaXN9LGRpc2FibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIXN9LGxvY2s6ZnVuY3Rpb24oKXtyZXR1cm4gYT11PVtdLHR8fGl8fChzPXQ9IiIpLHRoaXN9LGxvY2tlZDpmdW5jdGlvbigpe3JldHVybiEhYX0sZmlyZVdpdGg6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gYXx8KHQ9W2UsKHQ9dHx8W10pLnNsaWNlP3Quc2xpY2UoKTp0XSx1LnB1c2godCksaXx8YygpKSx0aGlzfSxmaXJlOmZ1bmN0aW9uKCl7cmV0dXJuIGYuZmlyZVdpdGgodGhpcyxhcmd1bWVudHMpLHRoaXN9LGZpcmVkOmZ1bmN0aW9uKCl7cmV0dXJuISFvfX07cmV0dXJuIGZ9LGNlLmV4dGVuZCh7RGVmZXJyZWQ6ZnVuY3Rpb24oZSl7dmFyIG89W1sibm90aWZ5IiwicHJvZ3Jlc3MiLGNlLkNhbGxiYWNrcygibWVtb3J5IiksY2UuQ2FsbGJhY2tzKCJtZW1vcnkiKSwyXSxbInJlc29sdmUiLCJkb25lIixjZS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksY2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLDAsInJlc29sdmVkIl0sWyJyZWplY3QiLCJmYWlsIixjZS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IiksY2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLDEsInJlamVjdGVkIl1dLGk9InBlbmRpbmciLGE9e3N0YXRlOmZ1bmN0aW9uKCl7cmV0dXJuIGl9LGFsd2F5czpmdW5jdGlvbigpe3JldHVybiBzLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyksdGhpc30sImNhdGNoIjpmdW5jdGlvbihlKXtyZXR1cm4gYS50aGVuKG51bGwsZSl9LHBpcGU6ZnVuY3Rpb24oKXt2YXIgaT1hcmd1bWVudHM7cmV0dXJuIGNlLkRlZmVycmVkKGZ1bmN0aW9uKHIpe2NlLmVhY2gobyxmdW5jdGlvbihlLHQpe3ZhciBuPXYoaVt0WzRdXSkmJmlbdFs0XV07c1t0WzFdXShmdW5jdGlvbigpe3ZhciBlPW4mJm4uYXBwbHkodGhpcyxhcmd1bWVudHMpO2UmJnYoZS5wcm9taXNlKT9lLnByb21pc2UoKS5wcm9ncmVzcyhyLm5vdGlmeSkuZG9uZShyLnJlc29sdmUpLmZhaWwoci5yZWplY3QpOnJbdFswXSsiV2l0aCJdKHRoaXMsbj9bZV06YXJndW1lbnRzKX0pfSksaT1udWxsfSkucHJvbWlzZSgpfSx0aGVuOmZ1bmN0aW9uKHQsbixyKXt2YXIgdT0wO2Z1bmN0aW9uIGwoaSxvLGEscyl7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIG49dGhpcyxyPWFyZ3VtZW50cyxlPWZ1bmN0aW9uKCl7dmFyIGUsdDtpZighKGk8dSkpe2lmKChlPWEuYXBwbHkobixyKSk9PT1vLnByb21pc2UoKSl0aHJvdyBuZXcgVHlwZUVycm9yKCJUaGVuYWJsZSBzZWxmLXJlc29sdXRpb24iKTt0PWUmJigib2JqZWN0Ij09dHlwZW9mIGV8fCJmdW5jdGlvbiI9PXR5cGVvZiBlKSYmZS50aGVuLHYodCk/cz90LmNhbGwoZSxsKHUsbyxOLHMpLGwodSxvLHEscykpOih1KyssdC5jYWxsKGUsbCh1LG8sTixzKSxsKHUsbyxxLHMpLGwodSxvLE4sby5ub3RpZnlXaXRoKSkpOihhIT09TiYmKG49dm9pZCAwLHI9W2VdKSwoc3x8by5yZXNvbHZlV2l0aCkobixyKSl9fSx0PXM/ZTpmdW5jdGlvbigpe3RyeXtlKCl9Y2F0Y2goZSl7Y2UuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayYmY2UuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayhlLHQuZXJyb3IpLHU8PWkrMSYmKGEhPT1xJiYobj12b2lkIDAscj1bZV0pLG8ucmVqZWN0V2l0aChuLHIpKX19O2k/dCgpOihjZS5EZWZlcnJlZC5nZXRFcnJvckhvb2s/dC5lcnJvcj1jZS5EZWZlcnJlZC5nZXRFcnJvckhvb2soKTpjZS5EZWZlcnJlZC5nZXRTdGFja0hvb2smJih0LmVycm9yPWNlLkRlZmVycmVkLmdldFN0YWNrSG9vaygpKSxpZS5zZXRUaW1lb3V0KHQpKX19cmV0dXJuIGNlLkRlZmVycmVkKGZ1bmN0aW9uKGUpe29bMF1bM10uYWRkKGwoMCxlLHYocik/cjpOLGUubm90aWZ5V2l0aCkpLG9bMV1bM10uYWRkKGwoMCxlLHYodCk/dDpOKSksb1syXVszXS5hZGQobCgwLGUsdihuKT9uOnEpKX0pLnByb21pc2UoKX0scHJvbWlzZTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbCE9ZT9jZS5leHRlbmQoZSxhKTphfX0scz17fTtyZXR1cm4gY2UuZWFjaChvLGZ1bmN0aW9uKGUsdCl7dmFyIG49dFsyXSxyPXRbNV07YVt0WzFdXT1uLmFkZCxyJiZuLmFkZChmdW5jdGlvbigpe2k9cn0sb1szLWVdWzJdLmRpc2FibGUsb1szLWVdWzNdLmRpc2FibGUsb1swXVsyXS5sb2NrLG9bMF1bM10ubG9jayksbi5hZGQodFszXS5maXJlKSxzW3RbMF1dPWZ1bmN0aW9uKCl7cmV0dXJuIHNbdFswXSsiV2l0aCJdKHRoaXM9PT1zP3ZvaWQgMDp0aGlzLGFyZ3VtZW50cyksdGhpc30sc1t0WzBdKyJXaXRoIl09bi5maXJlV2l0aH0pLGEucHJvbWlzZShzKSxlJiZlLmNhbGwocyxzKSxzfSx3aGVuOmZ1bmN0aW9uKGUpe3ZhciBuPWFyZ3VtZW50cy5sZW5ndGgsdD1uLHI9QXJyYXkodCksaT1hZS5jYWxsKGFyZ3VtZW50cyksbz1jZS5EZWZlcnJlZCgpLGE9ZnVuY3Rpb24odCl7cmV0dXJuIGZ1bmN0aW9uKGUpe3JbdF09dGhpcyxpW3RdPTE8YXJndW1lbnRzLmxlbmd0aD9hZS5jYWxsKGFyZ3VtZW50cyk6ZSwtLW58fG8ucmVzb2x2ZVdpdGgocixpKX19O2lmKG48PTEmJihMKGUsby5kb25lKGEodCkpLnJlc29sdmUsby5yZWplY3QsIW4pLCJwZW5kaW5nIj09PW8uc3RhdGUoKXx8dihpW3RdJiZpW3RdLnRoZW4pKSlyZXR1cm4gby50aGVuKCk7d2hpbGUodC0tKUwoaVt0XSxhKHQpLG8ucmVqZWN0KTtyZXR1cm4gby5wcm9taXNlKCl9fSk7dmFyIEg9L14oRXZhbHxJbnRlcm5hbHxSYW5nZXxSZWZlcmVuY2V8U3ludGF4fFR5cGV8VVJJKUVycm9yJC87Y2UuRGVmZXJyZWQuZXhjZXB0aW9uSG9vaz1mdW5jdGlvbihlLHQpe2llLmNvbnNvbGUmJmllLmNvbnNvbGUud2FybiYmZSYmSC50ZXN0KGUubmFtZSkmJmllLmNvbnNvbGUud2FybigialF1ZXJ5LkRlZmVycmVkIGV4Y2VwdGlvbjogIitlLm1lc3NhZ2UsZS5zdGFjayx0KX0sY2UucmVhZHlFeGNlcHRpb249ZnVuY3Rpb24oZSl7aWUuc2V0VGltZW91dChmdW5jdGlvbigpe3Rocm93IGV9KX07dmFyIE89Y2UuRGVmZXJyZWQoKTtmdW5jdGlvbiBQKCl7Qy5yZW1vdmVFdmVudExpc3RlbmVyKCJET01Db250ZW50TG9hZGVkIixQKSxpZS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIixQKSxjZS5yZWFkeSgpfWNlLmZuLnJlYWR5PWZ1bmN0aW9uKGUpe3JldHVybiBPLnRoZW4oZSlbImNhdGNoIl0oZnVuY3Rpb24oZSl7Y2UucmVhZHlFeGNlcHRpb24oZSl9KSx0aGlzfSxjZS5leHRlbmQoe2lzUmVhZHk6ITEscmVhZHlXYWl0OjEscmVhZHk6ZnVuY3Rpb24oZSl7KCEwPT09ZT8tLWNlLnJlYWR5V2FpdDpjZS5pc1JlYWR5KXx8KGNlLmlzUmVhZHk9ITApIT09ZSYmMDwtLWNlLnJlYWR5V2FpdHx8Ty5yZXNvbHZlV2l0aChDLFtjZV0pfX0pLGNlLnJlYWR5LnRoZW49Ty50aGVuLCJjb21wbGV0ZSI9PT1DLnJlYWR5U3RhdGV8fCJsb2FkaW5nIiE9PUMucmVhZHlTdGF0ZSYmIUMuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsP2llLnNldFRpbWVvdXQoY2UucmVhZHkpOihDLmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLFApLGllLmFkZEV2ZW50TGlzdGVuZXIoImxvYWQiLFApKTt2YXIgUj1mdW5jdGlvbihlLHQsbixyLGksbyxhKXt2YXIgcz0wLHU9ZS5sZW5ndGgsbD1udWxsPT1uO2lmKCJvYmplY3QiPT09eChuKSlmb3IocyBpbiBpPSEwLG4pUihlLHQscyxuW3NdLCEwLG8sYSk7ZWxzZSBpZih2b2lkIDAhPT1yJiYoaT0hMCx2KHIpfHwoYT0hMCksbCYmKGE/KHQuY2FsbChlLHIpLHQ9bnVsbCk6KGw9dCx0PWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbC5jYWxsKGNlKGUpLG4pfSkpLHQpKWZvcig7czx1O3MrKyl0KGVbc10sbixhP3I6ci5jYWxsKGVbc10scyx0KGVbc10sbikpKTtyZXR1cm4gaT9lOmw/dC5jYWxsKGUpOnU/dChlWzBdLG4pOm99LE09L14tbXMtLyxJPS8tKFthLXpdKS9nO2Z1bmN0aW9uIFcoZSx0KXtyZXR1cm4gdC50b1VwcGVyQ2FzZSgpfWZ1bmN0aW9uIEYoZSl7cmV0dXJuIGUucmVwbGFjZShNLCJtcy0iKS5yZXBsYWNlKEksVyl9dmFyICQ9ZnVuY3Rpb24oZSl7cmV0dXJuIDE9PT1lLm5vZGVUeXBlfHw5PT09ZS5ub2RlVHlwZXx8IStlLm5vZGVUeXBlfTtmdW5jdGlvbiBCKCl7dGhpcy5leHBhbmRvPWNlLmV4cGFuZG8rQi51aWQrK31CLnVpZD0xLEIucHJvdG90eXBlPXtjYWNoZTpmdW5jdGlvbihlKXt2YXIgdD1lW3RoaXMuZXhwYW5kb107cmV0dXJuIHR8fCh0PXt9LCQoZSkmJihlLm5vZGVUeXBlP2VbdGhpcy5leHBhbmRvXT10Ok9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLHRoaXMuZXhwYW5kbyx7dmFsdWU6dCxjb25maWd1cmFibGU6ITB9KSkpLHR9LHNldDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaT10aGlzLmNhY2hlKGUpO2lmKCJzdHJpbmciPT10eXBlb2YgdClpW0YodCldPW47ZWxzZSBmb3IociBpbiB0KWlbRihyKV09dFtyXTtyZXR1cm4gaX0sZ2V0OmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQ/dGhpcy5jYWNoZShlKTplW3RoaXMuZXhwYW5kb10mJmVbdGhpcy5leHBhbmRvXVtGKHQpXX0sYWNjZXNzOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdm9pZCAwPT09dHx8dCYmInN0cmluZyI9PXR5cGVvZiB0JiZ2b2lkIDA9PT1uP3RoaXMuZ2V0KGUsdCk6KHRoaXMuc2V0KGUsdCxuKSx2b2lkIDAhPT1uP246dCl9LHJlbW92ZTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9ZVt0aGlzLmV4cGFuZG9dO2lmKHZvaWQgMCE9PXIpe2lmKHZvaWQgMCE9PXQpe249KHQ9QXJyYXkuaXNBcnJheSh0KT90Lm1hcChGKToodD1GKHQpKWluIHI/W3RdOnQubWF0Y2goRCl8fFtdKS5sZW5ndGg7d2hpbGUobi0tKWRlbGV0ZSByW3Rbbl1dfSh2b2lkIDA9PT10fHxjZS5pc0VtcHR5T2JqZWN0KHIpKSYmKGUubm9kZVR5cGU/ZVt0aGlzLmV4cGFuZG9dPXZvaWQgMDpkZWxldGUgZVt0aGlzLmV4cGFuZG9dKX19LGhhc0RhdGE6ZnVuY3Rpb24oZSl7dmFyIHQ9ZVt0aGlzLmV4cGFuZG9dO3JldHVybiB2b2lkIDAhPT10JiYhY2UuaXNFbXB0eU9iamVjdCh0KX19O3ZhciBfPW5ldyBCLFg9bmV3IEIsVT0vXig/Olx7W1x3XFddKlx9fFxbW1x3XFddKlxdKSQvLHo9L1tBLVpdL2c7ZnVuY3Rpb24gVihlLHQsbil7dmFyIHIsaTtpZih2b2lkIDA9PT1uJiYxPT09ZS5ub2RlVHlwZSlpZihyPSJkYXRhLSIrdC5yZXBsYWNlKHosIi0kJiIpLnRvTG93ZXJDYXNlKCksInN0cmluZyI9PXR5cGVvZihuPWUuZ2V0QXR0cmlidXRlKHIpKSl7dHJ5e249InRydWUiPT09KGk9bil8fCJmYWxzZSIhPT1pJiYoIm51bGwiPT09aT9udWxsOmk9PT0raSsiIj8raTpVLnRlc3QoaSk/SlNPTi5wYXJzZShpKTppKX1jYXRjaChlKXt9WC5zZXQoZSx0LG4pfWVsc2Ugbj12b2lkIDA7cmV0dXJuIG59Y2UuZXh0ZW5kKHtoYXNEYXRhOmZ1bmN0aW9uKGUpe3JldHVybiBYLmhhc0RhdGEoZSl8fF8uaGFzRGF0YShlKX0sZGF0YTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIFguYWNjZXNzKGUsdCxuKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihlLHQpe1gucmVtb3ZlKGUsdCl9LF9kYXRhOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gXy5hY2Nlc3MoZSx0LG4pfSxfcmVtb3ZlRGF0YTpmdW5jdGlvbihlLHQpe18ucmVtb3ZlKGUsdCl9fSksY2UuZm4uZXh0ZW5kKHtkYXRhOmZ1bmN0aW9uKG4sZSl7dmFyIHQscixpLG89dGhpc1swXSxhPW8mJm8uYXR0cmlidXRlcztpZih2b2lkIDA9PT1uKXtpZih0aGlzLmxlbmd0aCYmKGk9WC5nZXQobyksMT09PW8ubm9kZVR5cGUmJiFfLmdldChvLCJoYXNEYXRhQXR0cnMiKSkpe3Q9YS5sZW5ndGg7d2hpbGUodC0tKWFbdF0mJjA9PT0ocj1hW3RdLm5hbWUpLmluZGV4T2YoImRhdGEtIikmJihyPUYoci5zbGljZSg1KSksVihvLHIsaVtyXSkpO18uc2V0KG8sImhhc0RhdGFBdHRycyIsITApfXJldHVybiBpfXJldHVybiJvYmplY3QiPT10eXBlb2Ygbj90aGlzLmVhY2goZnVuY3Rpb24oKXtYLnNldCh0aGlzLG4pfSk6Uih0aGlzLGZ1bmN0aW9uKGUpe3ZhciB0O2lmKG8mJnZvaWQgMD09PWUpcmV0dXJuIHZvaWQgMCE9PSh0PVguZ2V0KG8sbikpP3Q6dm9pZCAwIT09KHQ9VihvLG4pKT90OnZvaWQgMDt0aGlzLmVhY2goZnVuY3Rpb24oKXtYLnNldCh0aGlzLG4sZSl9KX0sbnVsbCxlLDE8YXJndW1lbnRzLmxlbmd0aCxudWxsLCEwKX0scmVtb3ZlRGF0YTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7WC5yZW1vdmUodGhpcyxlKX0pfX0pLGNlLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByO2lmKGUpcmV0dXJuIHQ9KHR8fCJmeCIpKyJxdWV1ZSIscj1fLmdldChlLHQpLG4mJighcnx8QXJyYXkuaXNBcnJheShuKT9yPV8uYWNjZXNzKGUsdCxjZS5tYWtlQXJyYXkobikpOnIucHVzaChuKSkscnx8W119LGRlcXVldWU6ZnVuY3Rpb24oZSx0KXt0PXR8fCJmeCI7dmFyIG49Y2UucXVldWUoZSx0KSxyPW4ubGVuZ3RoLGk9bi5zaGlmdCgpLG89Y2UuX3F1ZXVlSG9va3MoZSx0KTsiaW5wcm9ncmVzcyI9PT1pJiYoaT1uLnNoaWZ0KCksci0tKSxpJiYoImZ4Ij09PXQmJm4udW5zaGlmdCgiaW5wcm9ncmVzcyIpLGRlbGV0ZSBvLnN0b3AsaS5jYWxsKGUsZnVuY3Rpb24oKXtjZS5kZXF1ZXVlKGUsdCl9LG8pKSwhciYmbyYmby5lbXB0eS5maXJlKCl9LF9xdWV1ZUhvb2tzOmZ1bmN0aW9uKGUsdCl7dmFyIG49dCsicXVldWVIb29rcyI7cmV0dXJuIF8uZ2V0KGUsbil8fF8uYWNjZXNzKGUsbix7ZW1wdHk6Y2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLmFkZChmdW5jdGlvbigpe18ucmVtb3ZlKGUsW3QrInF1ZXVlIixuXSl9KX0pfX0pLGNlLmZuLmV4dGVuZCh7cXVldWU6ZnVuY3Rpb24odCxuKXt2YXIgZT0yO3JldHVybiJzdHJpbmciIT10eXBlb2YgdCYmKG49dCx0PSJmeCIsZS0tKSxhcmd1bWVudHMubGVuZ3RoPGU/Y2UucXVldWUodGhpc1swXSx0KTp2b2lkIDA9PT1uP3RoaXM6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGU9Y2UucXVldWUodGhpcyx0LG4pO2NlLl9xdWV1ZUhvb2tzKHRoaXMsdCksImZ4Ij09PXQmJiJpbnByb2dyZXNzIiE9PWVbMF0mJmNlLmRlcXVldWUodGhpcyx0KX0pfSxkZXF1ZXVlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjZS5kZXF1ZXVlKHRoaXMsZSl9KX0sY2xlYXJRdWV1ZTpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5xdWV1ZShlfHwiZngiLFtdKX0scHJvbWlzZTpmdW5jdGlvbihlLHQpe3ZhciBuLHI9MSxpPWNlLkRlZmVycmVkKCksbz10aGlzLGE9dGhpcy5sZW5ndGgscz1mdW5jdGlvbigpey0tcnx8aS5yZXNvbHZlV2l0aChvLFtvXSl9OyJzdHJpbmciIT10eXBlb2YgZSYmKHQ9ZSxlPXZvaWQgMCksZT1lfHwiZngiO3doaWxlKGEtLSkobj1fLmdldChvW2FdLGUrInF1ZXVlSG9va3MiKSkmJm4uZW1wdHkmJihyKyssbi5lbXB0eS5hZGQocykpO3JldHVybiBzKCksaS5wcm9taXNlKHQpfX0pO3ZhciBHPS9bKy1dPyg/OlxkKlwufClcZCsoPzpbZUVdWystXT9cZCt8KS8uc291cmNlLFk9bmV3IFJlZ0V4cCgiXig/OihbKy1dKT18KSgiK0crIikoW2EteiVdKikkIiwiaSIpLFE9WyJUb3AiLCJSaWdodCIsIkJvdHRvbSIsIkxlZnQiXSxKPUMuZG9jdW1lbnRFbGVtZW50LEs9ZnVuY3Rpb24oZSl7cmV0dXJuIGNlLmNvbnRhaW5zKGUub3duZXJEb2N1bWVudCxlKX0sWj17Y29tcG9zZWQ6ITB9O0ouZ2V0Um9vdE5vZGUmJihLPWZ1bmN0aW9uKGUpe3JldHVybiBjZS5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsZSl8fGUuZ2V0Um9vdE5vZGUoWik9PT1lLm93bmVyRG9jdW1lbnR9KTt2YXIgZWU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4ibm9uZSI9PT0oZT10fHxlKS5zdHlsZS5kaXNwbGF5fHwiIj09PWUuc3R5bGUuZGlzcGxheSYmSyhlKSYmIm5vbmUiPT09Y2UuY3NzKGUsImRpc3BsYXkiKX07ZnVuY3Rpb24gdGUoZSx0LG4scil7dmFyIGksbyxhPTIwLHM9cj9mdW5jdGlvbigpe3JldHVybiByLmN1cigpfTpmdW5jdGlvbigpe3JldHVybiBjZS5jc3MoZSx0LCIiKX0sdT1zKCksbD1uJiZuWzNdfHwoY2UuY3NzTnVtYmVyW3RdPyIiOiJweCIpLGM9ZS5ub2RlVHlwZSYmKGNlLmNzc051bWJlclt0XXx8InB4IiE9PWwmJit1KSYmWS5leGVjKGNlLmNzcyhlLHQpKTtpZihjJiZjWzNdIT09bCl7dS89MixsPWx8fGNbM10sYz0rdXx8MTt3aGlsZShhLS0pY2Uuc3R5bGUoZSx0LGMrbCksKDEtbykqKDEtKG89cygpL3V8fC41KSk8PTAmJihhPTApLGMvPW87Yyo9MixjZS5zdHlsZShlLHQsYytsKSxuPW58fFtdfXJldHVybiBuJiYoYz0rY3x8K3V8fDAsaT1uWzFdP2MrKG5bMV0rMSkqblsyXTorblsyXSxyJiYoci51bml0PWwsci5zdGFydD1jLHIuZW5kPWkpKSxpfXZhciBuZT17fTtmdW5jdGlvbiByZShlLHQpe2Zvcih2YXIgbixyLGksbyxhLHMsdSxsPVtdLGM9MCxmPWUubGVuZ3RoO2M8ZjtjKyspKHI9ZVtjXSkuc3R5bGUmJihuPXIuc3R5bGUuZGlzcGxheSx0Pygibm9uZSI9PT1uJiYobFtjXT1fLmdldChyLCJkaXNwbGF5Iil8fG51bGwsbFtjXXx8KHIuc3R5bGUuZGlzcGxheT0iIikpLCIiPT09ci5zdHlsZS5kaXNwbGF5JiZlZShyKSYmKGxbY109KHU9YT1vPXZvaWQgMCxhPShpPXIpLm93bmVyRG9jdW1lbnQscz1pLm5vZGVOYW1lLCh1PW5lW3NdKXx8KG89YS5ib2R5LmFwcGVuZENoaWxkKGEuY3JlYXRlRWxlbWVudChzKSksdT1jZS5jc3MobywiZGlzcGxheSIpLG8ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChvKSwibm9uZSI9PT11JiYodT0iYmxvY2siKSxuZVtzXT11KSkpKToibm9uZSIhPT1uJiYobFtjXT0ibm9uZSIsXy5zZXQociwiZGlzcGxheSIsbikpKTtmb3IoYz0wO2M8ZjtjKyspbnVsbCE9bFtjXSYmKGVbY10uc3R5bGUuZGlzcGxheT1sW2NdKTtyZXR1cm4gZX1jZS5mbi5leHRlbmQoe3Nob3c6ZnVuY3Rpb24oKXtyZXR1cm4gcmUodGhpcywhMCl9LGhpZGU6ZnVuY3Rpb24oKXtyZXR1cm4gcmUodGhpcyl9LHRvZ2dsZTpmdW5jdGlvbihlKXtyZXR1cm4iYm9vbGVhbiI9PXR5cGVvZiBlP2U/dGhpcy5zaG93KCk6dGhpcy5oaWRlKCk6dGhpcy5lYWNoKGZ1bmN0aW9uKCl7ZWUodGhpcyk/Y2UodGhpcykuc2hvdygpOmNlKHRoaXMpLmhpZGUoKX0pfX0pO3ZhciB4ZSxiZSx3ZT0vXig/OmNoZWNrYm94fHJhZGlvKSQvaSxUZT0vPChbYS16XVteXC9cMD5ceDIwXHRcclxuXGZdKikvaSxDZT0vXiR8Xm1vZHVsZSR8XC8oPzpqYXZhfGVjbWEpc2NyaXB0L2k7eGU9Qy5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkuYXBwZW5kQ2hpbGQoQy5jcmVhdGVFbGVtZW50KCJkaXYiKSksKGJlPUMuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSkuc2V0QXR0cmlidXRlKCJ0eXBlIiwicmFkaW8iKSxiZS5zZXRBdHRyaWJ1dGUoImNoZWNrZWQiLCJjaGVja2VkIiksYmUuc2V0QXR0cmlidXRlKCJuYW1lIiwidCIpLHhlLmFwcGVuZENoaWxkKGJlKSxsZS5jaGVja0Nsb25lPXhlLmNsb25lTm9kZSghMCkuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuY2hlY2tlZCx4ZS5pbm5lckhUTUw9Ijx0ZXh0YXJlYT54PC90ZXh0YXJlYT4iLGxlLm5vQ2xvbmVDaGVja2VkPSEheGUuY2xvbmVOb2RlKCEwKS5sYXN0Q2hpbGQuZGVmYXVsdFZhbHVlLHhlLmlubmVySFRNTD0iPG9wdGlvbj48L29wdGlvbj4iLGxlLm9wdGlvbj0hIXhlLmxhc3RDaGlsZDt2YXIga2U9e3RoZWFkOlsxLCI8dGFibGU+IiwiPC90YWJsZT4iXSxjb2w6WzIsIjx0YWJsZT48Y29sZ3JvdXA+IiwiPC9jb2xncm91cD48L3RhYmxlPiJdLHRyOlsyLCI8dGFibGU+PHRib2R5PiIsIjwvdGJvZHk+PC90YWJsZT4iXSx0ZDpbMywiPHRhYmxlPjx0Ym9keT48dHI+IiwiPC90cj48L3Rib2R5PjwvdGFibGU+Il0sX2RlZmF1bHQ6WzAsIiIsIiJdfTtmdW5jdGlvbiBTZShlLHQpe3ZhciBuO3JldHVybiBuPSJ1bmRlZmluZWQiIT10eXBlb2YgZS5nZXRFbGVtZW50c0J5VGFnTmFtZT9lLmdldEVsZW1lbnRzQnlUYWdOYW1lKHR8fCIqIik6InVuZGVmaW5lZCIhPXR5cGVvZiBlLnF1ZXJ5U2VsZWN0b3JBbGw/ZS5xdWVyeVNlbGVjdG9yQWxsKHR8fCIqIik6W10sdm9pZCAwPT09dHx8dCYmZmUoZSx0KT9jZS5tZXJnZShbZV0sbik6bn1mdW5jdGlvbiBFZShlLHQpe2Zvcih2YXIgbj0wLHI9ZS5sZW5ndGg7bjxyO24rKylfLnNldChlW25dLCJnbG9iYWxFdmFsIiwhdHx8Xy5nZXQodFtuXSwiZ2xvYmFsRXZhbCIpKX1rZS50Ym9keT1rZS50Zm9vdD1rZS5jb2xncm91cD1rZS5jYXB0aW9uPWtlLnRoZWFkLGtlLnRoPWtlLnRkLGxlLm9wdGlvbnx8KGtlLm9wdGdyb3VwPWtlLm9wdGlvbj1bMSwiPHNlbGVjdCBtdWx0aXBsZT0nbXVsdGlwbGUnPiIsIjwvc2VsZWN0PiJdKTt2YXIgamU9Lzx8JiM/XHcrOy87ZnVuY3Rpb24gQWUoZSx0LG4scixpKXtmb3IodmFyIG8sYSxzLHUsbCxjLGY9dC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkscD1bXSxkPTAsaD1lLmxlbmd0aDtkPGg7ZCsrKWlmKChvPWVbZF0pfHwwPT09bylpZigib2JqZWN0Ij09PXgobykpY2UubWVyZ2UocCxvLm5vZGVUeXBlP1tvXTpvKTtlbHNlIGlmKGplLnRlc3Qobykpe2E9YXx8Zi5hcHBlbmRDaGlsZCh0LmNyZWF0ZUVsZW1lbnQoImRpdiIpKSxzPShUZS5leGVjKG8pfHxbIiIsIiJdKVsxXS50b0xvd2VyQ2FzZSgpLHU9a2Vbc118fGtlLl9kZWZhdWx0LGEuaW5uZXJIVE1MPXVbMV0rY2UuaHRtbFByZWZpbHRlcihvKSt1WzJdLGM9dVswXTt3aGlsZShjLS0pYT1hLmxhc3RDaGlsZDtjZS5tZXJnZShwLGEuY2hpbGROb2RlcyksKGE9Zi5maXJzdENoaWxkKS50ZXh0Q29udGVudD0iIn1lbHNlIHAucHVzaCh0LmNyZWF0ZVRleHROb2RlKG8pKTtmLnRleHRDb250ZW50PSIiLGQ9MDt3aGlsZShvPXBbZCsrXSlpZihyJiYtMTxjZS5pbkFycmF5KG8scikpaSYmaS5wdXNoKG8pO2Vsc2UgaWYobD1LKG8pLGE9U2UoZi5hcHBlbmRDaGlsZChvKSwic2NyaXB0IiksbCYmRWUoYSksbil7Yz0wO3doaWxlKG89YVtjKytdKUNlLnRlc3Qoby50eXBlfHwiIikmJm4ucHVzaChvKX1yZXR1cm4gZn12YXIgRGU9L14oW14uXSopKD86XC4oLispfCkvO2Z1bmN0aW9uIE5lKCl7cmV0dXJuITB9ZnVuY3Rpb24gcWUoKXtyZXR1cm4hMX1mdW5jdGlvbiBMZShlLHQsbixyLGksbyl7dmFyIGEscztpZigib2JqZWN0Ij09dHlwZW9mIHQpe2ZvcihzIGluInN0cmluZyIhPXR5cGVvZiBuJiYocj1yfHxuLG49dm9pZCAwKSx0KUxlKGUscyxuLHIsdFtzXSxvKTtyZXR1cm4gZX1pZihudWxsPT1yJiZudWxsPT1pPyhpPW4scj1uPXZvaWQgMCk6bnVsbD09aSYmKCJzdHJpbmciPT10eXBlb2Ygbj8oaT1yLHI9dm9pZCAwKTooaT1yLHI9bixuPXZvaWQgMCkpLCExPT09aSlpPXFlO2Vsc2UgaWYoIWkpcmV0dXJuIGU7cmV0dXJuIDE9PT1vJiYoYT1pLChpPWZ1bmN0aW9uKGUpe3JldHVybiBjZSgpLm9mZihlKSxhLmFwcGx5KHRoaXMsYXJndW1lbnRzKX0pLmd1aWQ9YS5ndWlkfHwoYS5ndWlkPWNlLmd1aWQrKykpLGUuZWFjaChmdW5jdGlvbigpe2NlLmV2ZW50LmFkZCh0aGlzLHQsaSxyLG4pfSl9ZnVuY3Rpb24gSGUoZSxyLHQpe3Q/KF8uc2V0KGUsciwhMSksY2UuZXZlbnQuYWRkKGUscix7bmFtZXNwYWNlOiExLGhhbmRsZXI6ZnVuY3Rpb24oZSl7dmFyIHQsbj1fLmdldCh0aGlzLHIpO2lmKDEmZS5pc1RyaWdnZXImJnRoaXNbcl0pe2lmKG4pKGNlLmV2ZW50LnNwZWNpYWxbcl18fHt9KS5kZWxlZ2F0ZVR5cGUmJmUuc3RvcFByb3BhZ2F0aW9uKCk7ZWxzZSBpZihuPWFlLmNhbGwoYXJndW1lbnRzKSxfLnNldCh0aGlzLHIsbiksdGhpc1tyXSgpLHQ9Xy5nZXQodGhpcyxyKSxfLnNldCh0aGlzLHIsITEpLG4hPT10KXJldHVybiBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLGUucHJldmVudERlZmF1bHQoKSx0fWVsc2UgbiYmKF8uc2V0KHRoaXMscixjZS5ldmVudC50cmlnZ2VyKG5bMF0sbi5zbGljZSgxKSx0aGlzKSksZS5zdG9wUHJvcGFnYXRpb24oKSxlLmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkPU5lKX19KSk6dm9pZCAwPT09Xy5nZXQoZSxyKSYmY2UuZXZlbnQuYWRkKGUscixOZSl9Y2UuZXZlbnQ9e2dsb2JhbDp7fSxhZGQ6ZnVuY3Rpb24odCxlLG4scixpKXt2YXIgbyxhLHMsdSxsLGMsZixwLGQsaCxnLHY9Xy5nZXQodCk7aWYoJCh0KSl7bi5oYW5kbGVyJiYobj0obz1uKS5oYW5kbGVyLGk9by5zZWxlY3RvciksaSYmY2UuZmluZC5tYXRjaGVzU2VsZWN0b3IoSixpKSxuLmd1aWR8fChuLmd1aWQ9Y2UuZ3VpZCsrKSwodT12LmV2ZW50cyl8fCh1PXYuZXZlbnRzPU9iamVjdC5jcmVhdGUobnVsbCkpLChhPXYuaGFuZGxlKXx8KGE9di5oYW5kbGU9ZnVuY3Rpb24oZSl7cmV0dXJuInVuZGVmaW5lZCIhPXR5cGVvZiBjZSYmY2UuZXZlbnQudHJpZ2dlcmVkIT09ZS50eXBlP2NlLmV2ZW50LmRpc3BhdGNoLmFwcGx5KHQsYXJndW1lbnRzKTp2b2lkIDB9KSxsPShlPShlfHwiIikubWF0Y2goRCl8fFsiIl0pLmxlbmd0aDt3aGlsZShsLS0pZD1nPShzPURlLmV4ZWMoZVtsXSl8fFtdKVsxXSxoPShzWzJdfHwiIikuc3BsaXQoIi4iKS5zb3J0KCksZCYmKGY9Y2UuZXZlbnQuc3BlY2lhbFtkXXx8e30sZD0oaT9mLmRlbGVnYXRlVHlwZTpmLmJpbmRUeXBlKXx8ZCxmPWNlLmV2ZW50LnNwZWNpYWxbZF18fHt9LGM9Y2UuZXh0ZW5kKHt0eXBlOmQsb3JpZ1R5cGU6ZyxkYXRhOnIsaGFuZGxlcjpuLGd1aWQ6bi5ndWlkLHNlbGVjdG9yOmksbmVlZHNDb250ZXh0OmkmJmNlLmV4cHIubWF0Y2gubmVlZHNDb250ZXh0LnRlc3QoaSksbmFtZXNwYWNlOmguam9pbigiLiIpfSxvKSwocD11W2RdKXx8KChwPXVbZF09W10pLmRlbGVnYXRlQ291bnQ9MCxmLnNldHVwJiYhMSE9PWYuc2V0dXAuY2FsbCh0LHIsaCxhKXx8dC5hZGRFdmVudExpc3RlbmVyJiZ0LmFkZEV2ZW50TGlzdGVuZXIoZCxhKSksZi5hZGQmJihmLmFkZC5jYWxsKHQsYyksYy5oYW5kbGVyLmd1aWR8fChjLmhhbmRsZXIuZ3VpZD1uLmd1aWQpKSxpP3Auc3BsaWNlKHAuZGVsZWdhdGVDb3VudCsrLDAsYyk6cC5wdXNoKGMpLGNlLmV2ZW50Lmdsb2JhbFtkXT0hMCl9fSxyZW1vdmU6ZnVuY3Rpb24oZSx0LG4scixpKXt2YXIgbyxhLHMsdSxsLGMsZixwLGQsaCxnLHY9Xy5oYXNEYXRhKGUpJiZfLmdldChlKTtpZih2JiYodT12LmV2ZW50cykpe2w9KHQ9KHR8fCIiKS5tYXRjaChEKXx8WyIiXSkubGVuZ3RoO3doaWxlKGwtLSlpZihkPWc9KHM9RGUuZXhlYyh0W2xdKXx8W10pWzFdLGg9KHNbMl18fCIiKS5zcGxpdCgiLiIpLnNvcnQoKSxkKXtmPWNlLmV2ZW50LnNwZWNpYWxbZF18fHt9LHA9dVtkPShyP2YuZGVsZWdhdGVUeXBlOmYuYmluZFR5cGUpfHxkXXx8W10scz1zWzJdJiZuZXcgUmVnRXhwKCIoXnxcXC4pIitoLmpvaW4oIlxcLig/Oi4qXFwufCkiKSsiKFxcLnwkKSIpLGE9bz1wLmxlbmd0aDt3aGlsZShvLS0pYz1wW29dLCFpJiZnIT09Yy5vcmlnVHlwZXx8biYmbi5ndWlkIT09Yy5ndWlkfHxzJiYhcy50ZXN0KGMubmFtZXNwYWNlKXx8ciYmciE9PWMuc2VsZWN0b3ImJigiKioiIT09cnx8IWMuc2VsZWN0b3IpfHwocC5zcGxpY2UobywxKSxjLnNlbGVjdG9yJiZwLmRlbGVnYXRlQ291bnQtLSxmLnJlbW92ZSYmZi5yZW1vdmUuY2FsbChlLGMpKTthJiYhcC5sZW5ndGgmJihmLnRlYXJkb3duJiYhMSE9PWYudGVhcmRvd24uY2FsbChlLGgsdi5oYW5kbGUpfHxjZS5yZW1vdmVFdmVudChlLGQsdi5oYW5kbGUpLGRlbGV0ZSB1W2RdKX1lbHNlIGZvcihkIGluIHUpY2UuZXZlbnQucmVtb3ZlKGUsZCt0W2xdLG4sciwhMCk7Y2UuaXNFbXB0eU9iamVjdCh1KSYmXy5yZW1vdmUoZSwiaGFuZGxlIGV2ZW50cyIpfX0sZGlzcGF0Y2g6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGksbyxhLHM9bmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpLHU9Y2UuZXZlbnQuZml4KGUpLGw9KF8uZ2V0KHRoaXMsImV2ZW50cyIpfHxPYmplY3QuY3JlYXRlKG51bGwpKVt1LnR5cGVdfHxbXSxjPWNlLmV2ZW50LnNwZWNpYWxbdS50eXBlXXx8e307Zm9yKHNbMF09dSx0PTE7dDxhcmd1bWVudHMubGVuZ3RoO3QrKylzW3RdPWFyZ3VtZW50c1t0XTtpZih1LmRlbGVnYXRlVGFyZ2V0PXRoaXMsIWMucHJlRGlzcGF0Y2h8fCExIT09Yy5wcmVEaXNwYXRjaC5jYWxsKHRoaXMsdSkpe2E9Y2UuZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLHUsbCksdD0wO3doaWxlKChpPWFbdCsrXSkmJiF1LmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpe3UuY3VycmVudFRhcmdldD1pLmVsZW0sbj0wO3doaWxlKChvPWkuaGFuZGxlcnNbbisrXSkmJiF1LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpdS5ybmFtZXNwYWNlJiYhMSE9PW8ubmFtZXNwYWNlJiYhdS5ybmFtZXNwYWNlLnRlc3Qoby5uYW1lc3BhY2UpfHwodS5oYW5kbGVPYmo9byx1LmRhdGE9by5kYXRhLHZvaWQgMCE9PShyPSgoY2UuZXZlbnQuc3BlY2lhbFtvLm9yaWdUeXBlXXx8e30pLmhhbmRsZXx8by5oYW5kbGVyKS5hcHBseShpLmVsZW0scykpJiYhMT09PSh1LnJlc3VsdD1yKSYmKHUucHJldmVudERlZmF1bHQoKSx1LnN0b3BQcm9wYWdhdGlvbigpKSl9cmV0dXJuIGMucG9zdERpc3BhdGNoJiZjLnBvc3REaXNwYXRjaC5jYWxsKHRoaXMsdSksdS5yZXN1bHR9fSxoYW5kbGVyczpmdW5jdGlvbihlLHQpe3ZhciBuLHIsaSxvLGEscz1bXSx1PXQuZGVsZWdhdGVDb3VudCxsPWUudGFyZ2V0O2lmKHUmJmwubm9kZVR5cGUmJiEoImNsaWNrIj09PWUudHlwZSYmMTw9ZS5idXR0b24pKWZvcig7bCE9PXRoaXM7bD1sLnBhcmVudE5vZGV8fHRoaXMpaWYoMT09PWwubm9kZVR5cGUmJigiY2xpY2siIT09ZS50eXBlfHwhMCE9PWwuZGlzYWJsZWQpKXtmb3Iobz1bXSxhPXt9LG49MDtuPHU7bisrKXZvaWQgMD09PWFbaT0ocj10W25dKS5zZWxlY3RvcisiICJdJiYoYVtpXT1yLm5lZWRzQ29udGV4dD8tMTxjZShpLHRoaXMpLmluZGV4KGwpOmNlLmZpbmQoaSx0aGlzLG51bGwsW2xdKS5sZW5ndGgpLGFbaV0mJm8ucHVzaChyKTtvLmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6b30pfXJldHVybiBsPXRoaXMsdTx0Lmxlbmd0aCYmcy5wdXNoKHtlbGVtOmwsaGFuZGxlcnM6dC5zbGljZSh1KX0pLHN9LGFkZFByb3A6ZnVuY3Rpb24odCxlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkoY2UuRXZlbnQucHJvdG90eXBlLHQse2VudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwLGdldDp2KGUpP2Z1bmN0aW9uKCl7aWYodGhpcy5vcmlnaW5hbEV2ZW50KXJldHVybiBlKHRoaXMub3JpZ2luYWxFdmVudCl9OmZ1bmN0aW9uKCl7aWYodGhpcy5vcmlnaW5hbEV2ZW50KXJldHVybiB0aGlzLm9yaWdpbmFsRXZlbnRbdF19LHNldDpmdW5jdGlvbihlKXtPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcyx0LHtlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMCx3cml0YWJsZTohMCx2YWx1ZTplfSl9fSl9LGZpeDpmdW5jdGlvbihlKXtyZXR1cm4gZVtjZS5leHBhbmRvXT9lOm5ldyBjZS5FdmVudChlKX0sc3BlY2lhbDp7bG9hZDp7bm9CdWJibGU6ITB9LGNsaWNrOntzZXR1cDpmdW5jdGlvbihlKXt2YXIgdD10aGlzfHxlO3JldHVybiB3ZS50ZXN0KHQudHlwZSkmJnQuY2xpY2smJmZlKHQsImlucHV0IikmJkhlKHQsImNsaWNrIiwhMCksITF9LHRyaWdnZXI6ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpc3x8ZTtyZXR1cm4gd2UudGVzdCh0LnR5cGUpJiZ0LmNsaWNrJiZmZSh0LCJpbnB1dCIpJiZIZSh0LCJjbGljayIpLCEwfSxfZGVmYXVsdDpmdW5jdGlvbihlKXt2YXIgdD1lLnRhcmdldDtyZXR1cm4gd2UudGVzdCh0LnR5cGUpJiZ0LmNsaWNrJiZmZSh0LCJpbnB1dCIpJiZfLmdldCh0LCJjbGljayIpfHxmZSh0LCJhIil9fSxiZWZvcmV1bmxvYWQ6e3Bvc3REaXNwYXRjaDpmdW5jdGlvbihlKXt2b2lkIDAhPT1lLnJlc3VsdCYmZS5vcmlnaW5hbEV2ZW50JiYoZS5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlPWUucmVzdWx0KX19fX0sY2UucmVtb3ZlRXZlbnQ9ZnVuY3Rpb24oZSx0LG4pe2UucmVtb3ZlRXZlbnRMaXN0ZW5lciYmZS5yZW1vdmVFdmVudExpc3RlbmVyKHQsbil9LGNlLkV2ZW50PWZ1bmN0aW9uKGUsdCl7aWYoISh0aGlzIGluc3RhbmNlb2YgY2UuRXZlbnQpKXJldHVybiBuZXcgY2UuRXZlbnQoZSx0KTtlJiZlLnR5cGU/KHRoaXMub3JpZ2luYWxFdmVudD1lLHRoaXMudHlwZT1lLnR5cGUsdGhpcy5pc0RlZmF1bHRQcmV2ZW50ZWQ9ZS5kZWZhdWx0UHJldmVudGVkfHx2b2lkIDA9PT1lLmRlZmF1bHRQcmV2ZW50ZWQmJiExPT09ZS5yZXR1cm5WYWx1ZT9OZTpxZSx0aGlzLnRhcmdldD1lLnRhcmdldCYmMz09PWUudGFyZ2V0Lm5vZGVUeXBlP2UudGFyZ2V0LnBhcmVudE5vZGU6ZS50YXJnZXQsdGhpcy5jdXJyZW50VGFyZ2V0PWUuY3VycmVudFRhcmdldCx0aGlzLnJlbGF0ZWRUYXJnZXQ9ZS5yZWxhdGVkVGFyZ2V0KTp0aGlzLnR5cGU9ZSx0JiZjZS5leHRlbmQodGhpcyx0KSx0aGlzLnRpbWVTdGFtcD1lJiZlLnRpbWVTdGFtcHx8RGF0ZS5ub3coKSx0aGlzW2NlLmV4cGFuZG9dPSEwfSxjZS5FdmVudC5wcm90b3R5cGU9e2NvbnN0cnVjdG9yOmNlLkV2ZW50LGlzRGVmYXVsdFByZXZlbnRlZDpxZSxpc1Byb3BhZ2F0aW9uU3RvcHBlZDpxZSxpc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZDpxZSxpc1NpbXVsYXRlZDohMSxwcmV2ZW50RGVmYXVsdDpmdW5jdGlvbigpe3ZhciBlPXRoaXMub3JpZ2luYWxFdmVudDt0aGlzLmlzRGVmYXVsdFByZXZlbnRlZD1OZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5wcmV2ZW50RGVmYXVsdCgpfSxzdG9wUHJvcGFnYXRpb246ZnVuY3Rpb24oKXt2YXIgZT10aGlzLm9yaWdpbmFsRXZlbnQ7dGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZD1OZSxlJiYhdGhpcy5pc1NpbXVsYXRlZCYmZS5zdG9wUHJvcGFnYXRpb24oKX0sc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vcmlnaW5hbEV2ZW50O3RoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ9TmUsZSYmIXRoaXMuaXNTaW11bGF0ZWQmJmUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksdGhpcy5zdG9wUHJvcGFnYXRpb24oKX19LGNlLmVhY2goe2FsdEtleTohMCxidWJibGVzOiEwLGNhbmNlbGFibGU6ITAsY2hhbmdlZFRvdWNoZXM6ITAsY3RybEtleTohMCxkZXRhaWw6ITAsZXZlbnRQaGFzZTohMCxtZXRhS2V5OiEwLHBhZ2VYOiEwLHBhZ2VZOiEwLHNoaWZ0S2V5OiEwLHZpZXc6ITAsImNoYXIiOiEwLGNvZGU6ITAsY2hhckNvZGU6ITAsa2V5OiEwLGtleUNvZGU6ITAsYnV0dG9uOiEwLGJ1dHRvbnM6ITAsY2xpZW50WDohMCxjbGllbnRZOiEwLG9mZnNldFg6ITAsb2Zmc2V0WTohMCxwb2ludGVySWQ6ITAscG9pbnRlclR5cGU6ITAsc2NyZWVuWDohMCxzY3JlZW5ZOiEwLHRhcmdldFRvdWNoZXM6ITAsdG9FbGVtZW50OiEwLHRvdWNoZXM6ITAsd2hpY2g6ITB9LGNlLmV2ZW50LmFkZFByb3ApLGNlLmVhY2goe2ZvY3VzOiJmb2N1c2luIixibHVyOiJmb2N1c291dCJ9LGZ1bmN0aW9uKHIsaSl7ZnVuY3Rpb24gbyhlKXtpZihDLmRvY3VtZW50TW9kZSl7dmFyIHQ9Xy5nZXQodGhpcywiaGFuZGxlIiksbj1jZS5ldmVudC5maXgoZSk7bi50eXBlPSJmb2N1c2luIj09PWUudHlwZT8iZm9jdXMiOiJibHVyIixuLmlzU2ltdWxhdGVkPSEwLHQoZSksbi50YXJnZXQ9PT1uLmN1cnJlbnRUYXJnZXQmJnQobil9ZWxzZSBjZS5ldmVudC5zaW11bGF0ZShpLGUudGFyZ2V0LGNlLmV2ZW50LmZpeChlKSl9Y2UuZXZlbnQuc3BlY2lhbFtyXT17c2V0dXA6ZnVuY3Rpb24oKXt2YXIgZTtpZihIZSh0aGlzLHIsITApLCFDLmRvY3VtZW50TW9kZSlyZXR1cm4hMTsoZT1fLmdldCh0aGlzLGkpKXx8dGhpcy5hZGRFdmVudExpc3RlbmVyKGksbyksXy5zZXQodGhpcyxpLChlfHwwKSsxKX0sdHJpZ2dlcjpmdW5jdGlvbigpe3JldHVybiBIZSh0aGlzLHIpLCEwfSx0ZWFyZG93bjpmdW5jdGlvbigpe3ZhciBlO2lmKCFDLmRvY3VtZW50TW9kZSlyZXR1cm4hMTsoZT1fLmdldCh0aGlzLGkpLTEpP18uc2V0KHRoaXMsaSxlKToodGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKGksbyksXy5yZW1vdmUodGhpcyxpKSl9LF9kZWZhdWx0OmZ1bmN0aW9uKGUpe3JldHVybiBfLmdldChlLnRhcmdldCxyKX0sZGVsZWdhdGVUeXBlOml9LGNlLmV2ZW50LnNwZWNpYWxbaV09e3NldHVwOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLmRvY3VtZW50fHx0aGlzLHQ9Qy5kb2N1bWVudE1vZGU/dGhpczplLG49Xy5nZXQodCxpKTtufHwoQy5kb2N1bWVudE1vZGU/dGhpcy5hZGRFdmVudExpc3RlbmVyKGksbyk6ZS5hZGRFdmVudExpc3RlbmVyKHIsbywhMCkpLF8uc2V0KHQsaSwobnx8MCkrMSl9LHRlYXJkb3duOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5vd25lckRvY3VtZW50fHx0aGlzLmRvY3VtZW50fHx0aGlzLHQ9Qy5kb2N1bWVudE1vZGU/dGhpczplLG49Xy5nZXQodCxpKS0xO24/Xy5zZXQodCxpLG4pOihDLmRvY3VtZW50TW9kZT90aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoaSxvKTplLnJlbW92ZUV2ZW50TGlzdGVuZXIocixvLCEwKSxfLnJlbW92ZSh0LGkpKX19fSksY2UuZWFjaCh7bW91c2VlbnRlcjoibW91c2VvdmVyIixtb3VzZWxlYXZlOiJtb3VzZW91dCIscG9pbnRlcmVudGVyOiJwb2ludGVyb3ZlciIscG9pbnRlcmxlYXZlOiJwb2ludGVyb3V0In0sZnVuY3Rpb24oZSxpKXtjZS5ldmVudC5zcGVjaWFsW2VdPXtkZWxlZ2F0ZVR5cGU6aSxiaW5kVHlwZTppLGhhbmRsZTpmdW5jdGlvbihlKXt2YXIgdCxuPWUucmVsYXRlZFRhcmdldCxyPWUuaGFuZGxlT2JqO3JldHVybiBuJiYobj09PXRoaXN8fGNlLmNvbnRhaW5zKHRoaXMsbikpfHwoZS50eXBlPXIub3JpZ1R5cGUsdD1yLmhhbmRsZXIuYXBwbHkodGhpcyxhcmd1bWVudHMpLGUudHlwZT1pKSx0fX19KSxjZS5mbi5leHRlbmQoe29uOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiBMZSh0aGlzLGUsdCxuLHIpfSxvbmU6ZnVuY3Rpb24oZSx0LG4scil7cmV0dXJuIExlKHRoaXMsZSx0LG4sciwxKX0sb2ZmOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpO2lmKGUmJmUucHJldmVudERlZmF1bHQmJmUuaGFuZGxlT2JqKXJldHVybiByPWUuaGFuZGxlT2JqLGNlKGUuZGVsZWdhdGVUYXJnZXQpLm9mZihyLm5hbWVzcGFjZT9yLm9yaWdUeXBlKyIuIityLm5hbWVzcGFjZTpyLm9yaWdUeXBlLHIuc2VsZWN0b3Isci5oYW5kbGVyKSx0aGlzO2lmKCJvYmplY3QiPT10eXBlb2YgZSl7Zm9yKGkgaW4gZSl0aGlzLm9mZihpLHQsZVtpXSk7cmV0dXJuIHRoaXN9cmV0dXJuITEhPT10JiYiZnVuY3Rpb24iIT10eXBlb2YgdHx8KG49dCx0PXZvaWQgMCksITE9PT1uJiYobj1xZSksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7Y2UuZXZlbnQucmVtb3ZlKHRoaXMsZSxuLHQpfSl9fSk7dmFyIE9lPS88c2NyaXB0fDxzdHlsZXw8bGluay9pLFBlPS9jaGVja2VkXHMqKD86W149XXw9XHMqLmNoZWNrZWQuKS9pLFJlPS9eXHMqPCFcW0NEQVRBXFt8XF1cXT5ccyokL2c7ZnVuY3Rpb24gTWUoZSx0KXtyZXR1cm4gZmUoZSwidGFibGUiKSYmZmUoMTEhPT10Lm5vZGVUeXBlP3Q6dC5maXJzdENoaWxkLCJ0ciIpJiZjZShlKS5jaGlsZHJlbigidGJvZHkiKVswXXx8ZX1mdW5jdGlvbiBJZShlKXtyZXR1cm4gZS50eXBlPShudWxsIT09ZS5nZXRBdHRyaWJ1dGUoInR5cGUiKSkrIi8iK2UudHlwZSxlfWZ1bmN0aW9uIFdlKGUpe3JldHVybiJ0cnVlLyI9PT0oZS50eXBlfHwiIikuc2xpY2UoMCw1KT9lLnR5cGU9ZS50eXBlLnNsaWNlKDUpOmUucmVtb3ZlQXR0cmlidXRlKCJ0eXBlIiksZX1mdW5jdGlvbiBGZShlLHQpe3ZhciBuLHIsaSxvLGEscztpZigxPT09dC5ub2RlVHlwZSl7aWYoXy5oYXNEYXRhKGUpJiYocz1fLmdldChlKS5ldmVudHMpKWZvcihpIGluIF8ucmVtb3ZlKHQsImhhbmRsZSBldmVudHMiKSxzKWZvcihuPTAscj1zW2ldLmxlbmd0aDtuPHI7bisrKWNlLmV2ZW50LmFkZCh0LGksc1tpXVtuXSk7WC5oYXNEYXRhKGUpJiYobz1YLmFjY2VzcyhlKSxhPWNlLmV4dGVuZCh7fSxvKSxYLnNldCh0LGEpKX19ZnVuY3Rpb24gJGUobixyLGksbyl7cj1nKHIpO3ZhciBlLHQsYSxzLHUsbCxjPTAsZj1uLmxlbmd0aCxwPWYtMSxkPXJbMF0saD12KGQpO2lmKGh8fDE8ZiYmInN0cmluZyI9PXR5cGVvZiBkJiYhbGUuY2hlY2tDbG9uZSYmUGUudGVzdChkKSlyZXR1cm4gbi5lYWNoKGZ1bmN0aW9uKGUpe3ZhciB0PW4uZXEoZSk7aCYmKHJbMF09ZC5jYWxsKHRoaXMsZSx0Lmh0bWwoKSkpLCRlKHQscixpLG8pfSk7aWYoZiYmKHQ9KGU9QWUocixuWzBdLm93bmVyRG9jdW1lbnQsITEsbixvKSkuZmlyc3RDaGlsZCwxPT09ZS5jaGlsZE5vZGVzLmxlbmd0aCYmKGU9dCksdHx8bykpe2ZvcihzPShhPWNlLm1hcChTZShlLCJzY3JpcHQiKSxJZSkpLmxlbmd0aDtjPGY7YysrKXU9ZSxjIT09cCYmKHU9Y2UuY2xvbmUodSwhMCwhMCkscyYmY2UubWVyZ2UoYSxTZSh1LCJzY3JpcHQiKSkpLGkuY2FsbChuW2NdLHUsYyk7aWYocylmb3IobD1hW2EubGVuZ3RoLTFdLm93bmVyRG9jdW1lbnQsY2UubWFwKGEsV2UpLGM9MDtjPHM7YysrKXU9YVtjXSxDZS50ZXN0KHUudHlwZXx8IiIpJiYhXy5hY2Nlc3ModSwiZ2xvYmFsRXZhbCIpJiZjZS5jb250YWlucyhsLHUpJiYodS5zcmMmJiJtb2R1bGUiIT09KHUudHlwZXx8IiIpLnRvTG93ZXJDYXNlKCk/Y2UuX2V2YWxVcmwmJiF1Lm5vTW9kdWxlJiZjZS5fZXZhbFVybCh1LnNyYyx7bm9uY2U6dS5ub25jZXx8dS5nZXRBdHRyaWJ1dGUoIm5vbmNlIil9LGwpOm0odS50ZXh0Q29udGVudC5yZXBsYWNlKFJlLCIiKSx1LGwpKX1yZXR1cm4gbn1mdW5jdGlvbiBCZShlLHQsbil7Zm9yKHZhciByLGk9dD9jZS5maWx0ZXIodCxlKTplLG89MDtudWxsIT0ocj1pW29dKTtvKyspbnx8MSE9PXIubm9kZVR5cGV8fGNlLmNsZWFuRGF0YShTZShyKSksci5wYXJlbnROb2RlJiYobiYmSyhyKSYmRWUoU2Uociwic2NyaXB0IikpLHIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChyKSk7cmV0dXJuIGV9Y2UuZXh0ZW5kKHtodG1sUHJlZmlsdGVyOmZ1bmN0aW9uKGUpe3JldHVybiBlfSxjbG9uZTpmdW5jdGlvbihlLHQsbil7dmFyIHIsaSxvLGEscyx1LGwsYz1lLmNsb25lTm9kZSghMCksZj1LKGUpO2lmKCEobGUubm9DbG9uZUNoZWNrZWR8fDEhPT1lLm5vZGVUeXBlJiYxMSE9PWUubm9kZVR5cGV8fGNlLmlzWE1MRG9jKGUpKSlmb3IoYT1TZShjKSxyPTAsaT0obz1TZShlKSkubGVuZ3RoO3I8aTtyKyspcz1vW3JdLHU9YVtyXSx2b2lkIDAsImlucHV0Ij09PShsPXUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkmJndlLnRlc3Qocy50eXBlKT91LmNoZWNrZWQ9cy5jaGVja2VkOiJpbnB1dCIhPT1sJiYidGV4dGFyZWEiIT09bHx8KHUuZGVmYXVsdFZhbHVlPXMuZGVmYXVsdFZhbHVlKTtpZih0KWlmKG4pZm9yKG89b3x8U2UoZSksYT1hfHxTZShjKSxyPTAsaT1vLmxlbmd0aDtyPGk7cisrKUZlKG9bcl0sYVtyXSk7ZWxzZSBGZShlLGMpO3JldHVybiAwPChhPVNlKGMsInNjcmlwdCIpKS5sZW5ndGgmJkVlKGEsIWYmJlNlKGUsInNjcmlwdCIpKSxjfSxjbGVhbkRhdGE6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG4scixpPWNlLmV2ZW50LnNwZWNpYWwsbz0wO3ZvaWQgMCE9PShuPWVbb10pO28rKylpZigkKG4pKXtpZih0PW5bXy5leHBhbmRvXSl7aWYodC5ldmVudHMpZm9yKHIgaW4gdC5ldmVudHMpaVtyXT9jZS5ldmVudC5yZW1vdmUobixyKTpjZS5yZW1vdmVFdmVudChuLHIsdC5oYW5kbGUpO25bXy5leHBhbmRvXT12b2lkIDB9bltYLmV4cGFuZG9dJiYobltYLmV4cGFuZG9dPXZvaWQgMCl9fX0pLGNlLmZuLmV4dGVuZCh7ZGV0YWNoOmZ1bmN0aW9uKGUpe3JldHVybiBCZSh0aGlzLGUsITApfSxyZW1vdmU6ZnVuY3Rpb24oZSl7cmV0dXJuIEJlKHRoaXMsZSl9LHRleHQ6ZnVuY3Rpb24oZSl7cmV0dXJuIFIodGhpcyxmdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZT9jZS50ZXh0KHRoaXMpOnRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uKCl7MSE9PXRoaXMubm9kZVR5cGUmJjExIT09dGhpcy5ub2RlVHlwZSYmOSE9PXRoaXMubm9kZVR5cGV8fCh0aGlzLnRleHRDb250ZW50PWUpfSl9LG51bGwsZSxhcmd1bWVudHMubGVuZ3RoKX0sYXBwZW5kOmZ1bmN0aW9uKCl7cmV0dXJuICRlKHRoaXMsYXJndW1lbnRzLGZ1bmN0aW9uKGUpezEhPT10aGlzLm5vZGVUeXBlJiYxMSE9PXRoaXMubm9kZVR5cGUmJjkhPT10aGlzLm5vZGVUeXBlfHxNZSh0aGlzLGUpLmFwcGVuZENoaWxkKGUpfSl9LHByZXBlbmQ6ZnVuY3Rpb24oKXtyZXR1cm4gJGUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7aWYoMT09PXRoaXMubm9kZVR5cGV8fDExPT09dGhpcy5ub2RlVHlwZXx8OT09PXRoaXMubm9kZVR5cGUpe3ZhciB0PU1lKHRoaXMsZSk7dC5pbnNlcnRCZWZvcmUoZSx0LmZpcnN0Q2hpbGQpfX0pfSxiZWZvcmU6ZnVuY3Rpb24oKXtyZXR1cm4gJGUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGUsdGhpcyl9KX0sYWZ0ZXI6ZnVuY3Rpb24oKXtyZXR1cm4gJGUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7dGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGUsdGhpcy5uZXh0U2libGluZyl9KX0sZW1wdHk6ZnVuY3Rpb24oKXtmb3IodmFyIGUsdD0wO251bGwhPShlPXRoaXNbdF0pO3QrKykxPT09ZS5ub2RlVHlwZSYmKGNlLmNsZWFuRGF0YShTZShlLCExKSksZS50ZXh0Q29udGVudD0iIik7cmV0dXJuIHRoaXN9LGNsb25lOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9bnVsbCE9ZSYmZSx0PW51bGw9PXQ/ZTp0LHRoaXMubWFwKGZ1bmN0aW9uKCl7cmV0dXJuIGNlLmNsb25lKHRoaXMsZSx0KX0pfSxodG1sOmZ1bmN0aW9uKGUpe3JldHVybiBSKHRoaXMsZnVuY3Rpb24oZSl7dmFyIHQ9dGhpc1swXXx8e30sbj0wLHI9dGhpcy5sZW5ndGg7aWYodm9pZCAwPT09ZSYmMT09PXQubm9kZVR5cGUpcmV0dXJuIHQuaW5uZXJIVE1MO2lmKCJzdHJpbmciPT10eXBlb2YgZSYmIU9lLnRlc3QoZSkmJiFrZVsoVGUuZXhlYyhlKXx8WyIiLCIiXSlbMV0udG9Mb3dlckNhc2UoKV0pe2U9Y2UuaHRtbFByZWZpbHRlcihlKTt0cnl7Zm9yKDtuPHI7bisrKTE9PT0odD10aGlzW25dfHx7fSkubm9kZVR5cGUmJihjZS5jbGVhbkRhdGEoU2UodCwhMSkpLHQuaW5uZXJIVE1MPWUpO3Q9MH1jYXRjaChlKXt9fXQmJnRoaXMuZW1wdHkoKS5hcHBlbmQoZSl9LG51bGwsZSxhcmd1bWVudHMubGVuZ3RoKX0scmVwbGFjZVdpdGg6ZnVuY3Rpb24oKXt2YXIgbj1bXTtyZXR1cm4gJGUodGhpcyxhcmd1bWVudHMsZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5wYXJlbnROb2RlO2NlLmluQXJyYXkodGhpcyxuKTwwJiYoY2UuY2xlYW5EYXRhKFNlKHRoaXMpKSx0JiZ0LnJlcGxhY2VDaGlsZChlLHRoaXMpKX0sbil9fSksY2UuZWFjaCh7YXBwZW5kVG86ImFwcGVuZCIscHJlcGVuZFRvOiJwcmVwZW5kIixpbnNlcnRCZWZvcmU6ImJlZm9yZSIsaW5zZXJ0QWZ0ZXI6ImFmdGVyIixyZXBsYWNlQWxsOiJyZXBsYWNlV2l0aCJ9LGZ1bmN0aW9uKGUsYSl7Y2UuZm5bZV09ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG49W10scj1jZShlKSxpPXIubGVuZ3RoLTEsbz0wO288PWk7bysrKXQ9bz09PWk/dGhpczp0aGlzLmNsb25lKCEwKSxjZShyW29dKVthXSh0KSxzLmFwcGx5KG4sdC5nZXQoKSk7cmV0dXJuIHRoaXMucHVzaFN0YWNrKG4pfX0pO3ZhciBfZT1uZXcgUmVnRXhwKCJeKCIrRysiKSg/IXB4KVthLXolXSskIiwiaSIpLFhlPS9eLS0vLFVlPWZ1bmN0aW9uKGUpe3ZhciB0PWUub3duZXJEb2N1bWVudC5kZWZhdWx0VmlldztyZXR1cm4gdCYmdC5vcGVuZXJ8fCh0PWllKSx0LmdldENvbXB1dGVkU3R5bGUoZSl9LHplPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89e307Zm9yKGkgaW4gdClvW2ldPWUuc3R5bGVbaV0sZS5zdHlsZVtpXT10W2ldO2ZvcihpIGluIHI9bi5jYWxsKGUpLHQpZS5zdHlsZVtpXT1vW2ldO3JldHVybiByfSxWZT1uZXcgUmVnRXhwKFEuam9pbigifCIpLCJpIik7ZnVuY3Rpb24gR2UoZSx0LG4pe3ZhciByLGksbyxhLHM9WGUudGVzdCh0KSx1PWUuc3R5bGU7cmV0dXJuKG49bnx8VWUoZSkpJiYoYT1uLmdldFByb3BlcnR5VmFsdWUodCl8fG5bdF0scyYmYSYmKGE9YS5yZXBsYWNlKHZlLCIkMSIpfHx2b2lkIDApLCIiIT09YXx8SyhlKXx8KGE9Y2Uuc3R5bGUoZSx0KSksIWxlLnBpeGVsQm94U3R5bGVzKCkmJl9lLnRlc3QoYSkmJlZlLnRlc3QodCkmJihyPXUud2lkdGgsaT11Lm1pbldpZHRoLG89dS5tYXhXaWR0aCx1Lm1pbldpZHRoPXUubWF4V2lkdGg9dS53aWR0aD1hLGE9bi53aWR0aCx1LndpZHRoPXIsdS5taW5XaWR0aD1pLHUubWF4V2lkdGg9bykpLHZvaWQgMCE9PWE/YSsiIjphfWZ1bmN0aW9uIFllKGUsdCl7cmV0dXJue2dldDpmdW5jdGlvbigpe2lmKCFlKCkpcmV0dXJuKHRoaXMuZ2V0PXQpLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtkZWxldGUgdGhpcy5nZXR9fX0hZnVuY3Rpb24oKXtmdW5jdGlvbiBlKCl7aWYobCl7dS5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0xMTExMXB4O3dpZHRoOjYwcHg7bWFyZ2luLXRvcDoxcHg7cGFkZGluZzowO2JvcmRlcjowIixsLnN0eWxlLmNzc1RleHQ9InBvc2l0aW9uOnJlbGF0aXZlO2Rpc3BsYXk6YmxvY2s7Ym94LXNpemluZzpib3JkZXItYm94O292ZXJmbG93OnNjcm9sbDttYXJnaW46YXV0bztib3JkZXI6MXB4O3BhZGRpbmc6MXB4O3dpZHRoOjYwJTt0b3A6MSUiLEouYXBwZW5kQ2hpbGQodSkuYXBwZW5kQ2hpbGQobCk7dmFyIGU9aWUuZ2V0Q29tcHV0ZWRTdHlsZShsKTtuPSIxJSIhPT1lLnRvcCxzPTEyPT09dChlLm1hcmdpbkxlZnQpLGwuc3R5bGUucmlnaHQ9IjYwJSIsbz0zNj09PXQoZS5yaWdodCkscj0zNj09PXQoZS53aWR0aCksbC5zdHlsZS5wb3NpdGlvbj0iYWJzb2x1dGUiLGk9MTI9PT10KGwub2Zmc2V0V2lkdGgvMyksSi5yZW1vdmVDaGlsZCh1KSxsPW51bGx9fWZ1bmN0aW9uIHQoZSl7cmV0dXJuIE1hdGgucm91bmQocGFyc2VGbG9hdChlKSl9dmFyIG4scixpLG8sYSxzLHU9Qy5jcmVhdGVFbGVtZW50KCJkaXYiKSxsPUMuY3JlYXRlRWxlbWVudCgiZGl2Iik7bC5zdHlsZSYmKGwuc3R5bGUuYmFja2dyb3VuZENsaXA9ImNvbnRlbnQtYm94IixsLmNsb25lTm9kZSghMCkuc3R5bGUuYmFja2dyb3VuZENsaXA9IiIsbGUuY2xlYXJDbG9uZVN0eWxlPSJjb250ZW50LWJveCI9PT1sLnN0eWxlLmJhY2tncm91bmRDbGlwLGNlLmV4dGVuZChsZSx7Ym94U2l6aW5nUmVsaWFibGU6ZnVuY3Rpb24oKXtyZXR1cm4gZSgpLHJ9LHBpeGVsQm94U3R5bGVzOmZ1bmN0aW9uKCl7cmV0dXJuIGUoKSxvfSxwaXhlbFBvc2l0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGUoKSxufSxyZWxpYWJsZU1hcmdpbkxlZnQ6ZnVuY3Rpb24oKXtyZXR1cm4gZSgpLHN9LHNjcm9sbGJveFNpemU6ZnVuY3Rpb24oKXtyZXR1cm4gZSgpLGl9LHJlbGlhYmxlVHJEaW1lbnNpb25zOmZ1bmN0aW9uKCl7dmFyIGUsdCxuLHI7cmV0dXJuIG51bGw9PWEmJihlPUMuY3JlYXRlRWxlbWVudCgidGFibGUiKSx0PUMuY3JlYXRlRWxlbWVudCgidHIiKSxuPUMuY3JlYXRlRWxlbWVudCgiZGl2IiksZS5zdHlsZS5jc3NUZXh0PSJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0xMTExMXB4O2JvcmRlci1jb2xsYXBzZTpzZXBhcmF0ZSIsdC5zdHlsZS5jc3NUZXh0PSJib3JkZXI6MXB4IHNvbGlkIix0LnN0eWxlLmhlaWdodD0iMXB4IixuLnN0eWxlLmhlaWdodD0iOXB4IixuLnN0eWxlLmRpc3BsYXk9ImJsb2NrIixKLmFwcGVuZENoaWxkKGUpLmFwcGVuZENoaWxkKHQpLmFwcGVuZENoaWxkKG4pLHI9aWUuZ2V0Q29tcHV0ZWRTdHlsZSh0KSxhPXBhcnNlSW50KHIuaGVpZ2h0LDEwKStwYXJzZUludChyLmJvcmRlclRvcFdpZHRoLDEwKStwYXJzZUludChyLmJvcmRlckJvdHRvbVdpZHRoLDEwKT09PXQub2Zmc2V0SGVpZ2h0LEoucmVtb3ZlQ2hpbGQoZSkpLGF9fSkpfSgpO3ZhciBRZT1bIldlYmtpdCIsIk1veiIsIm1zIl0sSmU9Qy5jcmVhdGVFbGVtZW50KCJkaXYiKS5zdHlsZSxLZT17fTtmdW5jdGlvbiBaZShlKXt2YXIgdD1jZS5jc3NQcm9wc1tlXXx8S2VbZV07cmV0dXJuIHR8fChlIGluIEplP2U6S2VbZV09ZnVuY3Rpb24oZSl7dmFyIHQ9ZVswXS50b1VwcGVyQ2FzZSgpK2Uuc2xpY2UoMSksbj1RZS5sZW5ndGg7d2hpbGUobi0tKWlmKChlPVFlW25dK3QpaW4gSmUpcmV0dXJuIGV9KGUpfHxlKX12YXIgZXQ9L14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLHR0PXtwb3NpdGlvbjoiYWJzb2x1dGUiLHZpc2liaWxpdHk6ImhpZGRlbiIsZGlzcGxheToiYmxvY2sifSxudD17bGV0dGVyU3BhY2luZzoiMCIsZm9udFdlaWdodDoiNDAwIn07ZnVuY3Rpb24gcnQoZSx0LG4pe3ZhciByPVkuZXhlYyh0KTtyZXR1cm4gcj9NYXRoLm1heCgwLHJbMl0tKG58fDApKSsoclszXXx8InB4Iik6dH1mdW5jdGlvbiBpdChlLHQsbixyLGksbyl7dmFyIGE9IndpZHRoIj09PXQ/MTowLHM9MCx1PTAsbD0wO2lmKG49PT0ocj8iYm9yZGVyIjoiY29udGVudCIpKXJldHVybiAwO2Zvcig7YTw0O2ErPTIpIm1hcmdpbiI9PT1uJiYobCs9Y2UuY3NzKGUsbitRW2FdLCEwLGkpKSxyPygiY29udGVudCI9PT1uJiYodS09Y2UuY3NzKGUsInBhZGRpbmciK1FbYV0sITAsaSkpLCJtYXJnaW4iIT09biYmKHUtPWNlLmNzcyhlLCJib3JkZXIiK1FbYV0rIldpZHRoIiwhMCxpKSkpOih1Kz1jZS5jc3MoZSwicGFkZGluZyIrUVthXSwhMCxpKSwicGFkZGluZyIhPT1uP3UrPWNlLmNzcyhlLCJib3JkZXIiK1FbYV0rIldpZHRoIiwhMCxpKTpzKz1jZS5jc3MoZSwiYm9yZGVyIitRW2FdKyJXaWR0aCIsITAsaSkpO3JldHVybiFyJiYwPD1vJiYodSs9TWF0aC5tYXgoMCxNYXRoLmNlaWwoZVsib2Zmc2V0Iit0WzBdLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKV0tby11LXMtLjUpKXx8MCksdStsfWZ1bmN0aW9uIG90KGUsdCxuKXt2YXIgcj1VZShlKSxpPSghbGUuYm94U2l6aW5nUmVsaWFibGUoKXx8bikmJiJib3JkZXItYm94Ij09PWNlLmNzcyhlLCJib3hTaXppbmciLCExLHIpLG89aSxhPUdlKGUsdCxyKSxzPSJvZmZzZXQiK3RbMF0udG9VcHBlckNhc2UoKSt0LnNsaWNlKDEpO2lmKF9lLnRlc3QoYSkpe2lmKCFuKXJldHVybiBhO2E9ImF1dG8ifXJldHVybighbGUuYm94U2l6aW5nUmVsaWFibGUoKSYmaXx8IWxlLnJlbGlhYmxlVHJEaW1lbnNpb25zKCkmJmZlKGUsInRyIil8fCJhdXRvIj09PWF8fCFwYXJzZUZsb2F0KGEpJiYiaW5saW5lIj09PWNlLmNzcyhlLCJkaXNwbGF5IiwhMSxyKSkmJmUuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgmJihpPSJib3JkZXItYm94Ij09PWNlLmNzcyhlLCJib3hTaXppbmciLCExLHIpLChvPXMgaW4gZSkmJihhPWVbc10pKSwoYT1wYXJzZUZsb2F0KGEpfHwwKStpdChlLHQsbnx8KGk/ImJvcmRlciI6ImNvbnRlbnQiKSxvLHIsYSkrInB4In1mdW5jdGlvbiBhdChlLHQsbixyLGkpe3JldHVybiBuZXcgYXQucHJvdG90eXBlLmluaXQoZSx0LG4scixpKX1jZS5leHRlbmQoe2Nzc0hvb2tzOntvcGFjaXR5OntnZXQ6ZnVuY3Rpb24oZSx0KXtpZih0KXt2YXIgbj1HZShlLCJvcGFjaXR5Iik7cmV0dXJuIiI9PT1uPyIxIjpufX19fSxjc3NOdW1iZXI6e2FuaW1hdGlvbkl0ZXJhdGlvbkNvdW50OiEwLGFzcGVjdFJhdGlvOiEwLGJvcmRlckltYWdlU2xpY2U6ITAsY29sdW1uQ291bnQ6ITAsZmxleEdyb3c6ITAsZmxleFNocmluazohMCxmb250V2VpZ2h0OiEwLGdyaWRBcmVhOiEwLGdyaWRDb2x1bW46ITAsZ3JpZENvbHVtbkVuZDohMCxncmlkQ29sdW1uU3RhcnQ6ITAsZ3JpZFJvdzohMCxncmlkUm93RW5kOiEwLGdyaWRSb3dTdGFydDohMCxsaW5lSGVpZ2h0OiEwLG9wYWNpdHk6ITAsb3JkZXI6ITAsb3JwaGFuczohMCxzY2FsZTohMCx3aWRvd3M6ITAsekluZGV4OiEwLHpvb206ITAsZmlsbE9wYWNpdHk6ITAsZmxvb2RPcGFjaXR5OiEwLHN0b3BPcGFjaXR5OiEwLHN0cm9rZU1pdGVybGltaXQ6ITAsc3Ryb2tlT3BhY2l0eTohMH0sY3NzUHJvcHM6e30sc3R5bGU6ZnVuY3Rpb24oZSx0LG4scil7aWYoZSYmMyE9PWUubm9kZVR5cGUmJjghPT1lLm5vZGVUeXBlJiZlLnN0eWxlKXt2YXIgaSxvLGEscz1GKHQpLHU9WGUudGVzdCh0KSxsPWUuc3R5bGU7aWYodXx8KHQ9WmUocykpLGE9Y2UuY3NzSG9va3NbdF18fGNlLmNzc0hvb2tzW3NdLHZvaWQgMD09PW4pcmV0dXJuIGEmJiJnZXQiaW4gYSYmdm9pZCAwIT09KGk9YS5nZXQoZSwhMSxyKSk/aTpsW3RdOyJzdHJpbmciPT09KG89dHlwZW9mIG4pJiYoaT1ZLmV4ZWMobikpJiZpWzFdJiYobj10ZShlLHQsaSksbz0ibnVtYmVyIiksbnVsbCE9biYmbj09biYmKCJudW1iZXIiIT09b3x8dXx8KG4rPWkmJmlbM118fChjZS5jc3NOdW1iZXJbc10/IiI6InB4IikpLGxlLmNsZWFyQ2xvbmVTdHlsZXx8IiIhPT1ufHwwIT09dC5pbmRleE9mKCJiYWNrZ3JvdW5kIil8fChsW3RdPSJpbmhlcml0IiksYSYmInNldCJpbiBhJiZ2b2lkIDA9PT0obj1hLnNldChlLG4scikpfHwodT9sLnNldFByb3BlcnR5KHQsbik6bFt0XT1uKSl9fSxjc3M6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHM9Rih0KTtyZXR1cm4gWGUudGVzdCh0KXx8KHQ9WmUocykpLChhPWNlLmNzc0hvb2tzW3RdfHxjZS5jc3NIb29rc1tzXSkmJiJnZXQiaW4gYSYmKGk9YS5nZXQoZSwhMCxuKSksdm9pZCAwPT09aSYmKGk9R2UoZSx0LHIpKSwibm9ybWFsIj09PWkmJnQgaW4gbnQmJihpPW50W3RdKSwiIj09PW58fG4/KG89cGFyc2VGbG9hdChpKSwhMD09PW58fGlzRmluaXRlKG8pP298fDA6aSk6aX19KSxjZS5lYWNoKFsiaGVpZ2h0Iiwid2lkdGgiXSxmdW5jdGlvbihlLHUpe2NlLmNzc0hvb2tzW3VdPXtnZXQ6ZnVuY3Rpb24oZSx0LG4pe2lmKHQpcmV0dXJuIWV0LnRlc3QoY2UuY3NzKGUsImRpc3BsYXkiKSl8fGUuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGgmJmUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGg/b3QoZSx1LG4pOnplKGUsdHQsZnVuY3Rpb24oKXtyZXR1cm4gb3QoZSx1LG4pfSl9LHNldDpmdW5jdGlvbihlLHQsbil7dmFyIHIsaT1VZShlKSxvPSFsZS5zY3JvbGxib3hTaXplKCkmJiJhYnNvbHV0ZSI9PT1pLnBvc2l0aW9uLGE9KG98fG4pJiYiYm9yZGVyLWJveCI9PT1jZS5jc3MoZSwiYm94U2l6aW5nIiwhMSxpKSxzPW4/aXQoZSx1LG4sYSxpKTowO3JldHVybiBhJiZvJiYocy09TWF0aC5jZWlsKGVbIm9mZnNldCIrdVswXS50b1VwcGVyQ2FzZSgpK3Uuc2xpY2UoMSldLXBhcnNlRmxvYXQoaVt1XSktaXQoZSx1LCJib3JkZXIiLCExLGkpLS41KSkscyYmKHI9WS5leGVjKHQpKSYmInB4IiE9PShyWzNdfHwicHgiKSYmKGUuc3R5bGVbdV09dCx0PWNlLmNzcyhlLHUpKSxydCgwLHQscyl9fX0pLGNlLmNzc0hvb2tzLm1hcmdpbkxlZnQ9WWUobGUucmVsaWFibGVNYXJnaW5MZWZ0LGZ1bmN0aW9uKGUsdCl7aWYodClyZXR1cm4ocGFyc2VGbG9hdChHZShlLCJtYXJnaW5MZWZ0IikpfHxlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQtemUoZSx7bWFyZ2luTGVmdDowfSxmdW5jdGlvbigpe3JldHVybiBlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnR9KSkrInB4In0pLGNlLmVhY2goe21hcmdpbjoiIixwYWRkaW5nOiIiLGJvcmRlcjoiV2lkdGgifSxmdW5jdGlvbihpLG8pe2NlLmNzc0hvb2tzW2krb109e2V4cGFuZDpmdW5jdGlvbihlKXtmb3IodmFyIHQ9MCxuPXt9LHI9InN0cmluZyI9PXR5cGVvZiBlP2Uuc3BsaXQoIiAiKTpbZV07dDw0O3QrKyluW2krUVt0XStvXT1yW3RdfHxyW3QtMl18fHJbMF07cmV0dXJuIG59fSwibWFyZ2luIiE9PWkmJihjZS5jc3NIb29rc1tpK29dLnNldD1ydCl9KSxjZS5mbi5leHRlbmQoe2NzczpmdW5jdGlvbihlLHQpe3JldHVybiBSKHRoaXMsZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz17fSxhPTA7aWYoQXJyYXkuaXNBcnJheSh0KSl7Zm9yKHI9VWUoZSksaT10Lmxlbmd0aDthPGk7YSsrKW9bdFthXV09Y2UuY3NzKGUsdFthXSwhMSxyKTtyZXR1cm4gb31yZXR1cm4gdm9pZCAwIT09bj9jZS5zdHlsZShlLHQsbik6Y2UuY3NzKGUsdCl9LGUsdCwxPGFyZ3VtZW50cy5sZW5ndGgpfX0pLCgoY2UuVHdlZW49YXQpLnByb3RvdHlwZT17Y29uc3RydWN0b3I6YXQsaW5pdDpmdW5jdGlvbihlLHQsbixyLGksbyl7dGhpcy5lbGVtPWUsdGhpcy5wcm9wPW4sdGhpcy5lYXNpbmc9aXx8Y2UuZWFzaW5nLl9kZWZhdWx0LHRoaXMub3B0aW9ucz10LHRoaXMuc3RhcnQ9dGhpcy5ub3c9dGhpcy5jdXIoKSx0aGlzLmVuZD1yLHRoaXMudW5pdD1vfHwoY2UuY3NzTnVtYmVyW25dPyIiOiJweCIpfSxjdXI6ZnVuY3Rpb24oKXt2YXIgZT1hdC5wcm9wSG9va3NbdGhpcy5wcm9wXTtyZXR1cm4gZSYmZS5nZXQ/ZS5nZXQodGhpcyk6YXQucHJvcEhvb2tzLl9kZWZhdWx0LmdldCh0aGlzKX0scnVuOmZ1bmN0aW9uKGUpe3ZhciB0LG49YXQucHJvcEhvb2tzW3RoaXMucHJvcF07cmV0dXJuIHRoaXMub3B0aW9ucy5kdXJhdGlvbj90aGlzLnBvcz10PWNlLmVhc2luZ1t0aGlzLmVhc2luZ10oZSx0aGlzLm9wdGlvbnMuZHVyYXRpb24qZSwwLDEsdGhpcy5vcHRpb25zLmR1cmF0aW9uKTp0aGlzLnBvcz10PWUsdGhpcy5ub3c9KHRoaXMuZW5kLXRoaXMuc3RhcnQpKnQrdGhpcy5zdGFydCx0aGlzLm9wdGlvbnMuc3RlcCYmdGhpcy5vcHRpb25zLnN0ZXAuY2FsbCh0aGlzLmVsZW0sdGhpcy5ub3csdGhpcyksbiYmbi5zZXQ/bi5zZXQodGhpcyk6YXQucHJvcEhvb2tzLl9kZWZhdWx0LnNldCh0aGlzKSx0aGlzfX0pLmluaXQucHJvdG90eXBlPWF0LnByb3RvdHlwZSwoYXQucHJvcEhvb2tzPXtfZGVmYXVsdDp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiAxIT09ZS5lbGVtLm5vZGVUeXBlfHxudWxsIT1lLmVsZW1bZS5wcm9wXSYmbnVsbD09ZS5lbGVtLnN0eWxlW2UucHJvcF0/ZS5lbGVtW2UucHJvcF06KHQ9Y2UuY3NzKGUuZWxlbSxlLnByb3AsIiIpKSYmImF1dG8iIT09dD90OjB9LHNldDpmdW5jdGlvbihlKXtjZS5meC5zdGVwW2UucHJvcF0/Y2UuZnguc3RlcFtlLnByb3BdKGUpOjEhPT1lLmVsZW0ubm9kZVR5cGV8fCFjZS5jc3NIb29rc1tlLnByb3BdJiZudWxsPT1lLmVsZW0uc3R5bGVbWmUoZS5wcm9wKV0/ZS5lbGVtW2UucHJvcF09ZS5ub3c6Y2Uuc3R5bGUoZS5lbGVtLGUucHJvcCxlLm5vdytlLnVuaXQpfX19KS5zY3JvbGxUb3A9YXQucHJvcEhvb2tzLnNjcm9sbExlZnQ9e3NldDpmdW5jdGlvbihlKXtlLmVsZW0ubm9kZVR5cGUmJmUuZWxlbS5wYXJlbnROb2RlJiYoZS5lbGVtW2UucHJvcF09ZS5ub3cpfX0sY2UuZWFzaW5nPXtsaW5lYXI6ZnVuY3Rpb24oZSl7cmV0dXJuIGV9LHN3aW5nOmZ1bmN0aW9uKGUpe3JldHVybi41LU1hdGguY29zKGUqTWF0aC5QSSkvMn0sX2RlZmF1bHQ6InN3aW5nIn0sY2UuZng9YXQucHJvdG90eXBlLmluaXQsY2UuZnguc3RlcD17fTt2YXIgc3QsdXQsbHQsY3QsZnQ9L14oPzp0b2dnbGV8c2hvd3xoaWRlKSQvLHB0PS9xdWV1ZUhvb2tzJC87ZnVuY3Rpb24gZHQoKXt1dCYmKCExPT09Qy5oaWRkZW4mJmllLnJlcXVlc3RBbmltYXRpb25GcmFtZT9pZS5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoZHQpOmllLnNldFRpbWVvdXQoZHQsY2UuZnguaW50ZXJ2YWwpLGNlLmZ4LnRpY2soKSl9ZnVuY3Rpb24gaHQoKXtyZXR1cm4gaWUuc2V0VGltZW91dChmdW5jdGlvbigpe3N0PXZvaWQgMH0pLHN0PURhdGUubm93KCl9ZnVuY3Rpb24gZ3QoZSx0KXt2YXIgbixyPTAsaT17aGVpZ2h0OmV9O2Zvcih0PXQ/MTowO3I8NDtyKz0yLXQpaVsibWFyZ2luIisobj1RW3JdKV09aVsicGFkZGluZyIrbl09ZTtyZXR1cm4gdCYmKGkub3BhY2l0eT1pLndpZHRoPWUpLGl9ZnVuY3Rpb24gdnQoZSx0LG4pe2Zvcih2YXIgcixpPSh5dC50d2VlbmVyc1t0XXx8W10pLmNvbmNhdCh5dC50d2VlbmVyc1siKiJdKSxvPTAsYT1pLmxlbmd0aDtvPGE7bysrKWlmKHI9aVtvXS5jYWxsKG4sdCxlKSlyZXR1cm4gcn1mdW5jdGlvbiB5dChvLGUsdCl7dmFyIG4sYSxyPTAsaT15dC5wcmVmaWx0ZXJzLmxlbmd0aCxzPWNlLkRlZmVycmVkKCkuYWx3YXlzKGZ1bmN0aW9uKCl7ZGVsZXRlIHUuZWxlbX0pLHU9ZnVuY3Rpb24oKXtpZihhKXJldHVybiExO2Zvcih2YXIgZT1zdHx8aHQoKSx0PU1hdGgubWF4KDAsbC5zdGFydFRpbWUrbC5kdXJhdGlvbi1lKSxuPTEtKHQvbC5kdXJhdGlvbnx8MCkscj0wLGk9bC50d2VlbnMubGVuZ3RoO3I8aTtyKyspbC50d2VlbnNbcl0ucnVuKG4pO3JldHVybiBzLm5vdGlmeVdpdGgobyxbbCxuLHRdKSxuPDEmJmk/dDooaXx8cy5ub3RpZnlXaXRoKG8sW2wsMSwwXSkscy5yZXNvbHZlV2l0aChvLFtsXSksITEpfSxsPXMucHJvbWlzZSh7ZWxlbTpvLHByb3BzOmNlLmV4dGVuZCh7fSxlKSxvcHRzOmNlLmV4dGVuZCghMCx7c3BlY2lhbEVhc2luZzp7fSxlYXNpbmc6Y2UuZWFzaW5nLl9kZWZhdWx0fSx0KSxvcmlnaW5hbFByb3BlcnRpZXM6ZSxvcmlnaW5hbE9wdGlvbnM6dCxzdGFydFRpbWU6c3R8fGh0KCksZHVyYXRpb246dC5kdXJhdGlvbix0d2VlbnM6W10sY3JlYXRlVHdlZW46ZnVuY3Rpb24oZSx0KXt2YXIgbj1jZS5Ud2VlbihvLGwub3B0cyxlLHQsbC5vcHRzLnNwZWNpYWxFYXNpbmdbZV18fGwub3B0cy5lYXNpbmcpO3JldHVybiBsLnR3ZWVucy5wdXNoKG4pLG59LHN0b3A6ZnVuY3Rpb24oZSl7dmFyIHQ9MCxuPWU/bC50d2VlbnMubGVuZ3RoOjA7aWYoYSlyZXR1cm4gdGhpcztmb3IoYT0hMDt0PG47dCsrKWwudHdlZW5zW3RdLnJ1bigxKTtyZXR1cm4gZT8ocy5ub3RpZnlXaXRoKG8sW2wsMSwwXSkscy5yZXNvbHZlV2l0aChvLFtsLGVdKSk6cy5yZWplY3RXaXRoKG8sW2wsZV0pLHRoaXN9fSksYz1sLnByb3BzO2ZvcighZnVuY3Rpb24oZSx0KXt2YXIgbixyLGksbyxhO2ZvcihuIGluIGUpaWYoaT10W3I9RihuKV0sbz1lW25dLEFycmF5LmlzQXJyYXkobykmJihpPW9bMV0sbz1lW25dPW9bMF0pLG4hPT1yJiYoZVtyXT1vLGRlbGV0ZSBlW25dKSwoYT1jZS5jc3NIb29rc1tyXSkmJiJleHBhbmQiaW4gYSlmb3IobiBpbiBvPWEuZXhwYW5kKG8pLGRlbGV0ZSBlW3JdLG8pbiBpbiBlfHwoZVtuXT1vW25dLHRbbl09aSk7ZWxzZSB0W3JdPWl9KGMsbC5vcHRzLnNwZWNpYWxFYXNpbmcpO3I8aTtyKyspaWYobj15dC5wcmVmaWx0ZXJzW3JdLmNhbGwobCxvLGMsbC5vcHRzKSlyZXR1cm4gdihuLnN0b3ApJiYoY2UuX3F1ZXVlSG9va3MobC5lbGVtLGwub3B0cy5xdWV1ZSkuc3RvcD1uLnN0b3AuYmluZChuKSksbjtyZXR1cm4gY2UubWFwKGMsdnQsbCksdihsLm9wdHMuc3RhcnQpJiZsLm9wdHMuc3RhcnQuY2FsbChvLGwpLGwucHJvZ3Jlc3MobC5vcHRzLnByb2dyZXNzKS5kb25lKGwub3B0cy5kb25lLGwub3B0cy5jb21wbGV0ZSkuZmFpbChsLm9wdHMuZmFpbCkuYWx3YXlzKGwub3B0cy5hbHdheXMpLGNlLmZ4LnRpbWVyKGNlLmV4dGVuZCh1LHtlbGVtOm8sYW5pbTpsLHF1ZXVlOmwub3B0cy5xdWV1ZX0pKSxsfWNlLkFuaW1hdGlvbj1jZS5leHRlbmQoeXQse3R3ZWVuZXJzOnsiKiI6W2Z1bmN0aW9uKGUsdCl7dmFyIG49dGhpcy5jcmVhdGVUd2VlbihlLHQpO3JldHVybiB0ZShuLmVsZW0sZSxZLmV4ZWModCksbiksbn1dfSx0d2VlbmVyOmZ1bmN0aW9uKGUsdCl7dihlKT8odD1lLGU9WyIqIl0pOmU9ZS5tYXRjaChEKTtmb3IodmFyIG4scj0wLGk9ZS5sZW5ndGg7cjxpO3IrKyluPWVbcl0seXQudHdlZW5lcnNbbl09eXQudHdlZW5lcnNbbl18fFtdLHl0LnR3ZWVuZXJzW25dLnVuc2hpZnQodCl9LHByZWZpbHRlcnM6W2Z1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzLHUsbCxjLGY9IndpZHRoImluIHR8fCJoZWlnaHQiaW4gdCxwPXRoaXMsZD17fSxoPWUuc3R5bGUsZz1lLm5vZGVUeXBlJiZlZShlKSx2PV8uZ2V0KGUsImZ4c2hvdyIpO2ZvcihyIGluIG4ucXVldWV8fChudWxsPT0oYT1jZS5fcXVldWVIb29rcyhlLCJmeCIpKS51bnF1ZXVlZCYmKGEudW5xdWV1ZWQ9MCxzPWEuZW1wdHkuZmlyZSxhLmVtcHR5LmZpcmU9ZnVuY3Rpb24oKXthLnVucXVldWVkfHxzKCl9KSxhLnVucXVldWVkKysscC5hbHdheXMoZnVuY3Rpb24oKXtwLmFsd2F5cyhmdW5jdGlvbigpe2EudW5xdWV1ZWQtLSxjZS5xdWV1ZShlLCJmeCIpLmxlbmd0aHx8YS5lbXB0eS5maXJlKCl9KX0pKSx0KWlmKGk9dFtyXSxmdC50ZXN0KGkpKXtpZihkZWxldGUgdFtyXSxvPW98fCJ0b2dnbGUiPT09aSxpPT09KGc/ImhpZGUiOiJzaG93Iikpe2lmKCJzaG93IiE9PWl8fCF2fHx2b2lkIDA9PT12W3JdKWNvbnRpbnVlO2c9ITB9ZFtyXT12JiZ2W3JdfHxjZS5zdHlsZShlLHIpfWlmKCh1PSFjZS5pc0VtcHR5T2JqZWN0KHQpKXx8IWNlLmlzRW1wdHlPYmplY3QoZCkpZm9yKHIgaW4gZiYmMT09PWUubm9kZVR5cGUmJihuLm92ZXJmbG93PVtoLm92ZXJmbG93LGgub3ZlcmZsb3dYLGgub3ZlcmZsb3dZXSxudWxsPT0obD12JiZ2LmRpc3BsYXkpJiYobD1fLmdldChlLCJkaXNwbGF5IikpLCJub25lIj09PShjPWNlLmNzcyhlLCJkaXNwbGF5IikpJiYobD9jPWw6KHJlKFtlXSwhMCksbD1lLnN0eWxlLmRpc3BsYXl8fGwsYz1jZS5jc3MoZSwiZGlzcGxheSIpLHJlKFtlXSkpKSwoImlubGluZSI9PT1jfHwiaW5saW5lLWJsb2NrIj09PWMmJm51bGwhPWwpJiYibm9uZSI9PT1jZS5jc3MoZSwiZmxvYXQiKSYmKHV8fChwLmRvbmUoZnVuY3Rpb24oKXtoLmRpc3BsYXk9bH0pLG51bGw9PWwmJihjPWguZGlzcGxheSxsPSJub25lIj09PWM/IiI6YykpLGguZGlzcGxheT0iaW5saW5lLWJsb2NrIikpLG4ub3ZlcmZsb3cmJihoLm92ZXJmbG93PSJoaWRkZW4iLHAuYWx3YXlzKGZ1bmN0aW9uKCl7aC5vdmVyZmxvdz1uLm92ZXJmbG93WzBdLGgub3ZlcmZsb3dYPW4ub3ZlcmZsb3dbMV0saC5vdmVyZmxvd1k9bi5vdmVyZmxvd1syXX0pKSx1PSExLGQpdXx8KHY/ImhpZGRlbiJpbiB2JiYoZz12LmhpZGRlbik6dj1fLmFjY2VzcyhlLCJmeHNob3ciLHtkaXNwbGF5Omx9KSxvJiYodi5oaWRkZW49IWcpLGcmJnJlKFtlXSwhMCkscC5kb25lKGZ1bmN0aW9uKCl7Zm9yKHIgaW4gZ3x8cmUoW2VdKSxfLnJlbW92ZShlLCJmeHNob3ciKSxkKWNlLnN0eWxlKGUscixkW3JdKX0pKSx1PXZ0KGc/dltyXTowLHIscCksciBpbiB2fHwodltyXT11LnN0YXJ0LGcmJih1LmVuZD11LnN0YXJ0LHUuc3RhcnQ9MCkpfV0scHJlZmlsdGVyOmZ1bmN0aW9uKGUsdCl7dD95dC5wcmVmaWx0ZXJzLnVuc2hpZnQoZSk6eXQucHJlZmlsdGVycy5wdXNoKGUpfX0pLGNlLnNwZWVkPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcj1lJiYib2JqZWN0Ij09dHlwZW9mIGU/Y2UuZXh0ZW5kKHt9LGUpOntjb21wbGV0ZTpufHwhbiYmdHx8dihlKSYmZSxkdXJhdGlvbjplLGVhc2luZzpuJiZ0fHx0JiYhdih0KSYmdH07cmV0dXJuIGNlLmZ4Lm9mZj9yLmR1cmF0aW9uPTA6Im51bWJlciIhPXR5cGVvZiByLmR1cmF0aW9uJiYoci5kdXJhdGlvbiBpbiBjZS5meC5zcGVlZHM/ci5kdXJhdGlvbj1jZS5meC5zcGVlZHNbci5kdXJhdGlvbl06ci5kdXJhdGlvbj1jZS5meC5zcGVlZHMuX2RlZmF1bHQpLG51bGwhPXIucXVldWUmJiEwIT09ci5xdWV1ZXx8KHIucXVldWU9ImZ4Iiksci5vbGQ9ci5jb21wbGV0ZSxyLmNvbXBsZXRlPWZ1bmN0aW9uKCl7dihyLm9sZCkmJnIub2xkLmNhbGwodGhpcyksci5xdWV1ZSYmY2UuZGVxdWV1ZSh0aGlzLHIucXVldWUpfSxyfSxjZS5mbi5leHRlbmQoe2ZhZGVUbzpmdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gdGhpcy5maWx0ZXIoZWUpLmNzcygib3BhY2l0eSIsMCkuc2hvdygpLmVuZCgpLmFuaW1hdGUoe29wYWNpdHk6dH0sZSxuLHIpfSxhbmltYXRlOmZ1bmN0aW9uKHQsZSxuLHIpe3ZhciBpPWNlLmlzRW1wdHlPYmplY3QodCksbz1jZS5zcGVlZChlLG4sciksYT1mdW5jdGlvbigpe3ZhciBlPXl0KHRoaXMsY2UuZXh0ZW5kKHt9LHQpLG8pOyhpfHxfLmdldCh0aGlzLCJmaW5pc2giKSkmJmUuc3RvcCghMCl9O3JldHVybiBhLmZpbmlzaD1hLGl8fCExPT09by5xdWV1ZT90aGlzLmVhY2goYSk6dGhpcy5xdWV1ZShvLnF1ZXVlLGEpfSxzdG9wOmZ1bmN0aW9uKGksZSxvKXt2YXIgYT1mdW5jdGlvbihlKXt2YXIgdD1lLnN0b3A7ZGVsZXRlIGUuc3RvcCx0KG8pfTtyZXR1cm4ic3RyaW5nIiE9dHlwZW9mIGkmJihvPWUsZT1pLGk9dm9pZCAwKSxlJiZ0aGlzLnF1ZXVlKGl8fCJmeCIsW10pLHRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBlPSEwLHQ9bnVsbCE9aSYmaSsicXVldWVIb29rcyIsbj1jZS50aW1lcnMscj1fLmdldCh0aGlzKTtpZih0KXJbdF0mJnJbdF0uc3RvcCYmYShyW3RdKTtlbHNlIGZvcih0IGluIHIpclt0XSYmclt0XS5zdG9wJiZwdC50ZXN0KHQpJiZhKHJbdF0pO2Zvcih0PW4ubGVuZ3RoO3QtLTspblt0XS5lbGVtIT09dGhpc3x8bnVsbCE9aSYmblt0XS5xdWV1ZSE9PWl8fChuW3RdLmFuaW0uc3RvcChvKSxlPSExLG4uc3BsaWNlKHQsMSkpOyFlJiZvfHxjZS5kZXF1ZXVlKHRoaXMsaSl9KX0sZmluaXNoOmZ1bmN0aW9uKGEpe3JldHVybiExIT09YSYmKGE9YXx8ImZ4IiksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7dmFyIGUsdD1fLmdldCh0aGlzKSxuPXRbYSsicXVldWUiXSxyPXRbYSsicXVldWVIb29rcyJdLGk9Y2UudGltZXJzLG89bj9uLmxlbmd0aDowO2Zvcih0LmZpbmlzaD0hMCxjZS5xdWV1ZSh0aGlzLGEsW10pLHImJnIuc3RvcCYmci5zdG9wLmNhbGwodGhpcywhMCksZT1pLmxlbmd0aDtlLS07KWlbZV0uZWxlbT09PXRoaXMmJmlbZV0ucXVldWU9PT1hJiYoaVtlXS5hbmltLnN0b3AoITApLGkuc3BsaWNlKGUsMSkpO2ZvcihlPTA7ZTxvO2UrKyluW2VdJiZuW2VdLmZpbmlzaCYmbltlXS5maW5pc2guY2FsbCh0aGlzKTtkZWxldGUgdC5maW5pc2h9KX19KSxjZS5lYWNoKFsidG9nZ2xlIiwic2hvdyIsImhpZGUiXSxmdW5jdGlvbihlLHIpe3ZhciBpPWNlLmZuW3JdO2NlLmZuW3JdPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gbnVsbD09ZXx8ImJvb2xlYW4iPT10eXBlb2YgZT9pLmFwcGx5KHRoaXMsYXJndW1lbnRzKTp0aGlzLmFuaW1hdGUoZ3QociwhMCksZSx0LG4pfX0pLGNlLmVhY2goe3NsaWRlRG93bjpndCgic2hvdyIpLHNsaWRlVXA6Z3QoImhpZGUiKSxzbGlkZVRvZ2dsZTpndCgidG9nZ2xlIiksZmFkZUluOntvcGFjaXR5OiJzaG93In0sZmFkZU91dDp7b3BhY2l0eToiaGlkZSJ9LGZhZGVUb2dnbGU6e29wYWNpdHk6InRvZ2dsZSJ9fSxmdW5jdGlvbihlLHIpe2NlLmZuW2VdPWZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gdGhpcy5hbmltYXRlKHIsZSx0LG4pfX0pLGNlLnRpbWVycz1bXSxjZS5meC50aWNrPWZ1bmN0aW9uKCl7dmFyIGUsdD0wLG49Y2UudGltZXJzO2ZvcihzdD1EYXRlLm5vdygpO3Q8bi5sZW5ndGg7dCsrKShlPW5bdF0pKCl8fG5bdF0hPT1lfHxuLnNwbGljZSh0LS0sMSk7bi5sZW5ndGh8fGNlLmZ4LnN0b3AoKSxzdD12b2lkIDB9LGNlLmZ4LnRpbWVyPWZ1bmN0aW9uKGUpe2NlLnRpbWVycy5wdXNoKGUpLGNlLmZ4LnN0YXJ0KCl9LGNlLmZ4LmludGVydmFsPTEzLGNlLmZ4LnN0YXJ0PWZ1bmN0aW9uKCl7dXR8fCh1dD0hMCxkdCgpKX0sY2UuZnguc3RvcD1mdW5jdGlvbigpe3V0PW51bGx9LGNlLmZ4LnNwZWVkcz17c2xvdzo2MDAsZmFzdDoyMDAsX2RlZmF1bHQ6NDAwfSxjZS5mbi5kZWxheT1mdW5jdGlvbihyLGUpe3JldHVybiByPWNlLmZ4JiZjZS5meC5zcGVlZHNbcl18fHIsZT1lfHwiZngiLHRoaXMucXVldWUoZSxmdW5jdGlvbihlLHQpe3ZhciBuPWllLnNldFRpbWVvdXQoZSxyKTt0LnN0b3A9ZnVuY3Rpb24oKXtpZS5jbGVhclRpbWVvdXQobil9fSl9LGx0PUMuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSxjdD1DLmNyZWF0ZUVsZW1lbnQoInNlbGVjdCIpLmFwcGVuZENoaWxkKEMuY3JlYXRlRWxlbWVudCgib3B0aW9uIikpLGx0LnR5cGU9ImNoZWNrYm94IixsZS5jaGVja09uPSIiIT09bHQudmFsdWUsbGUub3B0U2VsZWN0ZWQ9Y3Quc2VsZWN0ZWQsKGx0PUMuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSkudmFsdWU9InQiLGx0LnR5cGU9InJhZGlvIixsZS5yYWRpb1ZhbHVlPSJ0Ij09PWx0LnZhbHVlO3ZhciBtdCx4dD1jZS5leHByLmF0dHJIYW5kbGU7Y2UuZm4uZXh0ZW5kKHthdHRyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIFIodGhpcyxjZS5hdHRyLGUsdCwxPGFyZ3VtZW50cy5sZW5ndGgpfSxyZW1vdmVBdHRyOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtjZS5yZW1vdmVBdHRyKHRoaXMsZSl9KX19KSxjZS5leHRlbmQoe2F0dHI6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbz1lLm5vZGVUeXBlO2lmKDMhPT1vJiY4IT09byYmMiE9PW8pcmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiBlLmdldEF0dHJpYnV0ZT9jZS5wcm9wKGUsdCxuKTooMT09PW8mJmNlLmlzWE1MRG9jKGUpfHwoaT1jZS5hdHRySG9va3NbdC50b0xvd2VyQ2FzZSgpXXx8KGNlLmV4cHIubWF0Y2guYm9vbC50ZXN0KHQpP210OnZvaWQgMCkpLHZvaWQgMCE9PW4/bnVsbD09PW4/dm9pZCBjZS5yZW1vdmVBdHRyKGUsdCk6aSYmInNldCJpbiBpJiZ2b2lkIDAhPT0ocj1pLnNldChlLG4sdCkpP3I6KGUuc2V0QXR0cmlidXRlKHQsbisiIiksbik6aSYmImdldCJpbiBpJiZudWxsIT09KHI9aS5nZXQoZSx0KSk/cjpudWxsPT0ocj1jZS5maW5kLmF0dHIoZSx0KSk/dm9pZCAwOnIpfSxhdHRySG9va3M6e3R5cGU6e3NldDpmdW5jdGlvbihlLHQpe2lmKCFsZS5yYWRpb1ZhbHVlJiYicmFkaW8iPT09dCYmZmUoZSwiaW5wdXQiKSl7dmFyIG49ZS52YWx1ZTtyZXR1cm4gZS5zZXRBdHRyaWJ1dGUoInR5cGUiLHQpLG4mJihlLnZhbHVlPW4pLHR9fX19LHJlbW92ZUF0dHI6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPTAsaT10JiZ0Lm1hdGNoKEQpO2lmKGkmJjE9PT1lLm5vZGVUeXBlKXdoaWxlKG49aVtyKytdKWUucmVtb3ZlQXR0cmlidXRlKG4pfX0pLG10PXtzZXQ6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiExPT09dD9jZS5yZW1vdmVBdHRyKGUsbik6ZS5zZXRBdHRyaWJ1dGUobixuKSxufX0sY2UuZWFjaChjZS5leHByLm1hdGNoLmJvb2wuc291cmNlLm1hdGNoKC9cdysvZyksZnVuY3Rpb24oZSx0KXt2YXIgYT14dFt0XXx8Y2UuZmluZC5hdHRyO3h0W3RdPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89dC50b0xvd2VyQ2FzZSgpO3JldHVybiBufHwoaT14dFtvXSx4dFtvXT1yLHI9bnVsbCE9YShlLHQsbik/bzpudWxsLHh0W29dPWkpLHJ9fSk7dmFyIGJ0PS9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksd3Q9L14oPzphfGFyZWEpJC9pO2Z1bmN0aW9uIFR0KGUpe3JldHVybihlLm1hdGNoKEQpfHxbXSkuam9pbigiICIpfWZ1bmN0aW9uIEN0KGUpe3JldHVybiBlLmdldEF0dHJpYnV0ZSYmZS5nZXRBdHRyaWJ1dGUoImNsYXNzIil8fCIifWZ1bmN0aW9uIGt0KGUpe3JldHVybiBBcnJheS5pc0FycmF5KGUpP2U6InN0cmluZyI9PXR5cGVvZiBlJiZlLm1hdGNoKEQpfHxbXX1jZS5mbi5leHRlbmQoe3Byb3A6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gUih0aGlzLGNlLnByb3AsZSx0LDE8YXJndW1lbnRzLmxlbmd0aCl9LHJlbW92ZVByb3A6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2RlbGV0ZSB0aGlzW2NlLnByb3BGaXhbZV18fGVdfSl9fSksY2UuZXh0ZW5kKHtwcm9wOmZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG89ZS5ub2RlVHlwZTtpZigzIT09byYmOCE9PW8mJjIhPT1vKXJldHVybiAxPT09byYmY2UuaXNYTUxEb2MoZSl8fCh0PWNlLnByb3BGaXhbdF18fHQsaT1jZS5wcm9wSG9va3NbdF0pLHZvaWQgMCE9PW4/aSYmInNldCJpbiBpJiZ2b2lkIDAhPT0ocj1pLnNldChlLG4sdCkpP3I6ZVt0XT1uOmkmJiJnZXQiaW4gaSYmbnVsbCE9PShyPWkuZ2V0KGUsdCkpP3I6ZVt0XX0scHJvcEhvb2tzOnt0YWJJbmRleDp7Z2V0OmZ1bmN0aW9uKGUpe3ZhciB0PWNlLmZpbmQuYXR0cihlLCJ0YWJpbmRleCIpO3JldHVybiB0P3BhcnNlSW50KHQsMTApOmJ0LnRlc3QoZS5ub2RlTmFtZSl8fHd0LnRlc3QoZS5ub2RlTmFtZSkmJmUuaHJlZj8wOi0xfX19LHByb3BGaXg6eyJmb3IiOiJodG1sRm9yIiwiY2xhc3MiOiJjbGFzc05hbWUifX0pLGxlLm9wdFNlbGVjdGVkfHwoY2UucHJvcEhvb2tzLnNlbGVjdGVkPXtnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJlbnROb2RlO3JldHVybiB0JiZ0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4LG51bGx9LHNldDpmdW5jdGlvbihlKXt2YXIgdD1lLnBhcmVudE5vZGU7dCYmKHQuc2VsZWN0ZWRJbmRleCx0LnBhcmVudE5vZGUmJnQucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4KX19KSxjZS5lYWNoKFsidGFiSW5kZXgiLCJyZWFkT25seSIsIm1heExlbmd0aCIsImNlbGxTcGFjaW5nIiwiY2VsbFBhZGRpbmciLCJyb3dTcGFuIiwiY29sU3BhbiIsInVzZU1hcCIsImZyYW1lQm9yZGVyIiwiY29udGVudEVkaXRhYmxlIl0sZnVuY3Rpb24oKXtjZS5wcm9wRml4W3RoaXMudG9Mb3dlckNhc2UoKV09dGhpc30pLGNlLmZuLmV4dGVuZCh7YWRkQ2xhc3M6ZnVuY3Rpb24odCl7dmFyIGUsbixyLGksbyxhO3JldHVybiB2KHQpP3RoaXMuZWFjaChmdW5jdGlvbihlKXtjZSh0aGlzKS5hZGRDbGFzcyh0LmNhbGwodGhpcyxlLEN0KHRoaXMpKSl9KTooZT1rdCh0KSkubGVuZ3RoP3RoaXMuZWFjaChmdW5jdGlvbigpe2lmKHI9Q3QodGhpcyksbj0xPT09dGhpcy5ub2RlVHlwZSYmIiAiK1R0KHIpKyIgIil7Zm9yKG89MDtvPGUubGVuZ3RoO28rKylpPWVbb10sbi5pbmRleE9mKCIgIitpKyIgIik8MCYmKG4rPWkrIiAiKTthPVR0KG4pLHIhPT1hJiZ0aGlzLnNldEF0dHJpYnV0ZSgiY2xhc3MiLGEpfX0pOnRoaXN9LHJlbW92ZUNsYXNzOmZ1bmN0aW9uKHQpe3ZhciBlLG4scixpLG8sYTtyZXR1cm4gdih0KT90aGlzLmVhY2goZnVuY3Rpb24oZSl7Y2UodGhpcykucmVtb3ZlQ2xhc3ModC5jYWxsKHRoaXMsZSxDdCh0aGlzKSkpfSk6YXJndW1lbnRzLmxlbmd0aD8oZT1rdCh0KSkubGVuZ3RoP3RoaXMuZWFjaChmdW5jdGlvbigpe2lmKHI9Q3QodGhpcyksbj0xPT09dGhpcy5ub2RlVHlwZSYmIiAiK1R0KHIpKyIgIil7Zm9yKG89MDtvPGUubGVuZ3RoO28rKyl7aT1lW29dO3doaWxlKC0xPG4uaW5kZXhPZigiICIraSsiICIpKW49bi5yZXBsYWNlKCIgIitpKyIgIiwiICIpfWE9VHQobiksciE9PWEmJnRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIsYSl9fSk6dGhpczp0aGlzLmF0dHIoImNsYXNzIiwiIil9LHRvZ2dsZUNsYXNzOmZ1bmN0aW9uKHQsbil7dmFyIGUscixpLG8sYT10eXBlb2YgdCxzPSJzdHJpbmciPT09YXx8QXJyYXkuaXNBcnJheSh0KTtyZXR1cm4gdih0KT90aGlzLmVhY2goZnVuY3Rpb24oZSl7Y2UodGhpcykudG9nZ2xlQ2xhc3ModC5jYWxsKHRoaXMsZSxDdCh0aGlzKSxuKSxuKX0pOiJib29sZWFuIj09dHlwZW9mIG4mJnM/bj90aGlzLmFkZENsYXNzKHQpOnRoaXMucmVtb3ZlQ2xhc3ModCk6KGU9a3QodCksdGhpcy5lYWNoKGZ1bmN0aW9uKCl7aWYocylmb3Iobz1jZSh0aGlzKSxpPTA7aTxlLmxlbmd0aDtpKyspcj1lW2ldLG8uaGFzQ2xhc3Mocik/by5yZW1vdmVDbGFzcyhyKTpvLmFkZENsYXNzKHIpO2Vsc2Ugdm9pZCAwIT09dCYmImJvb2xlYW4iIT09YXx8KChyPUN0KHRoaXMpKSYmXy5zZXQodGhpcywiX19jbGFzc05hbWVfXyIsciksdGhpcy5zZXRBdHRyaWJ1dGUmJnRoaXMuc2V0QXR0cmlidXRlKCJjbGFzcyIscnx8ITE9PT10PyIiOl8uZ2V0KHRoaXMsIl9fY2xhc3NOYW1lX18iKXx8IiIpKX0pKX0saGFzQ2xhc3M6ZnVuY3Rpb24oZSl7dmFyIHQsbixyPTA7dD0iICIrZSsiICI7d2hpbGUobj10aGlzW3IrK10paWYoMT09PW4ubm9kZVR5cGUmJi0xPCgiICIrVHQoQ3QobikpKyIgIikuaW5kZXhPZih0KSlyZXR1cm4hMDtyZXR1cm4hMX19KTt2YXIgU3Q9L1xyL2c7Y2UuZm4uZXh0ZW5kKHt2YWw6ZnVuY3Rpb24obil7dmFyIHIsZSxpLHQ9dGhpc1swXTtyZXR1cm4gYXJndW1lbnRzLmxlbmd0aD8oaT12KG4pLHRoaXMuZWFjaChmdW5jdGlvbihlKXt2YXIgdDsxPT09dGhpcy5ub2RlVHlwZSYmKG51bGw9PSh0PWk/bi5jYWxsKHRoaXMsZSxjZSh0aGlzKS52YWwoKSk6bik/dD0iIjoibnVtYmVyIj09dHlwZW9mIHQ/dCs9IiI6QXJyYXkuaXNBcnJheSh0KSYmKHQ9Y2UubWFwKHQsZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/IiI6ZSsiIn0pKSwocj1jZS52YWxIb29rc1t0aGlzLnR5cGVdfHxjZS52YWxIb29rc1t0aGlzLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSYmInNldCJpbiByJiZ2b2lkIDAhPT1yLnNldCh0aGlzLHQsInZhbHVlIil8fCh0aGlzLnZhbHVlPXQpKX0pKTp0PyhyPWNlLnZhbEhvb2tzW3QudHlwZV18fGNlLnZhbEhvb2tzW3Qubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pJiYiZ2V0ImluIHImJnZvaWQgMCE9PShlPXIuZ2V0KHQsInZhbHVlIikpP2U6InN0cmluZyI9PXR5cGVvZihlPXQudmFsdWUpP2UucmVwbGFjZShTdCwiIik6bnVsbD09ZT8iIjplOnZvaWQgMH19KSxjZS5leHRlbmQoe3ZhbEhvb2tzOntvcHRpb246e2dldDpmdW5jdGlvbihlKXt2YXIgdD1jZS5maW5kLmF0dHIoZSwidmFsdWUiKTtyZXR1cm4gbnVsbCE9dD90OlR0KGNlLnRleHQoZSkpfX0sc2VsZWN0OntnZXQ6ZnVuY3Rpb24oZSl7dmFyIHQsbixyLGk9ZS5vcHRpb25zLG89ZS5zZWxlY3RlZEluZGV4LGE9InNlbGVjdC1vbmUiPT09ZS50eXBlLHM9YT9udWxsOltdLHU9YT9vKzE6aS5sZW5ndGg7Zm9yKHI9bzwwP3U6YT9vOjA7cjx1O3IrKylpZigoKG49aVtyXSkuc2VsZWN0ZWR8fHI9PT1vKSYmIW4uZGlzYWJsZWQmJighbi5wYXJlbnROb2RlLmRpc2FibGVkfHwhZmUobi5wYXJlbnROb2RlLCJvcHRncm91cCIpKSl7aWYodD1jZShuKS52YWwoKSxhKXJldHVybiB0O3MucHVzaCh0KX1yZXR1cm4gc30sc2V0OmZ1bmN0aW9uKGUsdCl7dmFyIG4scixpPWUub3B0aW9ucyxvPWNlLm1ha2VBcnJheSh0KSxhPWkubGVuZ3RoO3doaWxlKGEtLSkoKHI9aVthXSkuc2VsZWN0ZWQ9LTE8Y2UuaW5BcnJheShjZS52YWxIb29rcy5vcHRpb24uZ2V0KHIpLG8pKSYmKG49ITApO3JldHVybiBufHwoZS5zZWxlY3RlZEluZGV4PS0xKSxvfX19fSksY2UuZWFjaChbInJhZGlvIiwiY2hlY2tib3giXSxmdW5jdGlvbigpe2NlLnZhbEhvb2tzW3RoaXNdPXtzZXQ6ZnVuY3Rpb24oZSx0KXtpZihBcnJheS5pc0FycmF5KHQpKXJldHVybiBlLmNoZWNrZWQ9LTE8Y2UuaW5BcnJheShjZShlKS52YWwoKSx0KX19LGxlLmNoZWNrT258fChjZS52YWxIb29rc1t0aGlzXS5nZXQ9ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PT1lLmdldEF0dHJpYnV0ZSgidmFsdWUiKT8ib24iOmUudmFsdWV9KX0pO3ZhciBFdD1pZS5sb2NhdGlvbixqdD17Z3VpZDpEYXRlLm5vdygpfSxBdD0vXD8vO2NlLnBhcnNlWE1MPWZ1bmN0aW9uKGUpe3ZhciB0LG47aWYoIWV8fCJzdHJpbmciIT10eXBlb2YgZSlyZXR1cm4gbnVsbDt0cnl7dD0obmV3IGllLkRPTVBhcnNlcikucGFyc2VGcm9tU3RyaW5nKGUsInRleHQveG1sIil9Y2F0Y2goZSl7fXJldHVybiBuPXQmJnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInBhcnNlcmVycm9yIilbMF0sdCYmIW58fGNlLmVycm9yKCJJbnZhbGlkIFhNTDogIisobj9jZS5tYXAobi5jaGlsZE5vZGVzLGZ1bmN0aW9uKGUpe3JldHVybiBlLnRleHRDb250ZW50fSkuam9pbigiXG4iKTplKSksdH07dmFyIER0PS9eKD86Zm9jdXNpbmZvY3VzfGZvY3Vzb3V0Ymx1cikkLyxOdD1mdW5jdGlvbihlKXtlLnN0b3BQcm9wYWdhdGlvbigpfTtjZS5leHRlbmQoY2UuZXZlbnQse3RyaWdnZXI6ZnVuY3Rpb24oZSx0LG4scil7dmFyIGksbyxhLHMsdSxsLGMsZixwPVtufHxDXSxkPXVlLmNhbGwoZSwidHlwZSIpP2UudHlwZTplLGg9dWUuY2FsbChlLCJuYW1lc3BhY2UiKT9lLm5hbWVzcGFjZS5zcGxpdCgiLiIpOltdO2lmKG89Zj1hPW49bnx8QywzIT09bi5ub2RlVHlwZSYmOCE9PW4ubm9kZVR5cGUmJiFEdC50ZXN0KGQrY2UuZXZlbnQudHJpZ2dlcmVkKSYmKC0xPGQuaW5kZXhPZigiLiIpJiYoZD0oaD1kLnNwbGl0KCIuIikpLnNoaWZ0KCksaC5zb3J0KCkpLHU9ZC5pbmRleE9mKCI6Iik8MCYmIm9uIitkLChlPWVbY2UuZXhwYW5kb10/ZTpuZXcgY2UuRXZlbnQoZCwib2JqZWN0Ij09dHlwZW9mIGUmJmUpKS5pc1RyaWdnZXI9cj8yOjMsZS5uYW1lc3BhY2U9aC5qb2luKCIuIiksZS5ybmFtZXNwYWNlPWUubmFtZXNwYWNlP25ldyBSZWdFeHAoIihefFxcLikiK2guam9pbigiXFwuKD86LipcXC58KSIpKyIoXFwufCQpIik6bnVsbCxlLnJlc3VsdD12b2lkIDAsZS50YXJnZXR8fChlLnRhcmdldD1uKSx0PW51bGw9PXQ/W2VdOmNlLm1ha2VBcnJheSh0LFtlXSksYz1jZS5ldmVudC5zcGVjaWFsW2RdfHx7fSxyfHwhYy50cmlnZ2VyfHwhMSE9PWMudHJpZ2dlci5hcHBseShuLHQpKSl7aWYoIXImJiFjLm5vQnViYmxlJiYheShuKSl7Zm9yKHM9Yy5kZWxlZ2F0ZVR5cGV8fGQsRHQudGVzdChzK2QpfHwobz1vLnBhcmVudE5vZGUpO287bz1vLnBhcmVudE5vZGUpcC5wdXNoKG8pLGE9bzthPT09KG4ub3duZXJEb2N1bWVudHx8QykmJnAucHVzaChhLmRlZmF1bHRWaWV3fHxhLnBhcmVudFdpbmRvd3x8aWUpfWk9MDt3aGlsZSgobz1wW2krK10pJiYhZS5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKWY9byxlLnR5cGU9MTxpP3M6Yy5iaW5kVHlwZXx8ZCwobD0oXy5nZXQobywiZXZlbnRzIil8fE9iamVjdC5jcmVhdGUobnVsbCkpW2UudHlwZV0mJl8uZ2V0KG8sImhhbmRsZSIpKSYmbC5hcHBseShvLHQpLChsPXUmJm9bdV0pJiZsLmFwcGx5JiYkKG8pJiYoZS5yZXN1bHQ9bC5hcHBseShvLHQpLCExPT09ZS5yZXN1bHQmJmUucHJldmVudERlZmF1bHQoKSk7cmV0dXJuIGUudHlwZT1kLHJ8fGUuaXNEZWZhdWx0UHJldmVudGVkKCl8fGMuX2RlZmF1bHQmJiExIT09Yy5fZGVmYXVsdC5hcHBseShwLnBvcCgpLHQpfHwhJChuKXx8dSYmdihuW2RdKSYmIXkobikmJigoYT1uW3VdKSYmKG5bdV09bnVsbCksY2UuZXZlbnQudHJpZ2dlcmVkPWQsZS5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpJiZmLmFkZEV2ZW50TGlzdGVuZXIoZCxOdCksbltkXSgpLGUuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSYmZi5yZW1vdmVFdmVudExpc3RlbmVyKGQsTnQpLGNlLmV2ZW50LnRyaWdnZXJlZD12b2lkIDAsYSYmKG5bdV09YSkpLGUucmVzdWx0fX0sc2ltdWxhdGU6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPWNlLmV4dGVuZChuZXcgY2UuRXZlbnQsbix7dHlwZTplLGlzU2ltdWxhdGVkOiEwfSk7Y2UuZXZlbnQudHJpZ2dlcihyLG51bGwsdCl9fSksY2UuZm4uZXh0ZW5kKHt0cmlnZ2VyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe2NlLmV2ZW50LnRyaWdnZXIoZSx0LHRoaXMpfSl9LHRyaWdnZXJIYW5kbGVyOmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpc1swXTtpZihuKXJldHVybiBjZS5ldmVudC50cmlnZ2VyKGUsdCxuLCEwKX19KTt2YXIgcXQ9L1xbXF0kLyxMdD0vXHI/XG4vZyxIdD0vXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksT3Q9L14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pO2Z1bmN0aW9uIFB0KG4sZSxyLGkpe3ZhciB0O2lmKEFycmF5LmlzQXJyYXkoZSkpY2UuZWFjaChlLGZ1bmN0aW9uKGUsdCl7cnx8cXQudGVzdChuKT9pKG4sdCk6UHQobisiWyIrKCJvYmplY3QiPT10eXBlb2YgdCYmbnVsbCE9dD9lOiIiKSsiXSIsdCxyLGkpfSk7ZWxzZSBpZihyfHwib2JqZWN0IiE9PXgoZSkpaShuLGUpO2Vsc2UgZm9yKHQgaW4gZSlQdChuKyJbIit0KyJdIixlW3RdLHIsaSl9Y2UucGFyYW09ZnVuY3Rpb24oZSx0KXt2YXIgbixyPVtdLGk9ZnVuY3Rpb24oZSx0KXt2YXIgbj12KHQpP3QoKTp0O3Jbci5sZW5ndGhdPWVuY29kZVVSSUNvbXBvbmVudChlKSsiPSIrZW5jb2RlVVJJQ29tcG9uZW50KG51bGw9PW4/IiI6bil9O2lmKG51bGw9PWUpcmV0dXJuIiI7aWYoQXJyYXkuaXNBcnJheShlKXx8ZS5qcXVlcnkmJiFjZS5pc1BsYWluT2JqZWN0KGUpKWNlLmVhY2goZSxmdW5jdGlvbigpe2kodGhpcy5uYW1lLHRoaXMudmFsdWUpfSk7ZWxzZSBmb3IobiBpbiBlKVB0KG4sZVtuXSx0LGkpO3JldHVybiByLmpvaW4oIiYiKX0sY2UuZm4uZXh0ZW5kKHtzZXJpYWxpemU6ZnVuY3Rpb24oKXtyZXR1cm4gY2UucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKX0sc2VyaWFsaXplQXJyYXk6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oKXt2YXIgZT1jZS5wcm9wKHRoaXMsImVsZW1lbnRzIik7cmV0dXJuIGU/Y2UubWFrZUFycmF5KGUpOnRoaXN9KS5maWx0ZXIoZnVuY3Rpb24oKXt2YXIgZT10aGlzLnR5cGU7cmV0dXJuIHRoaXMubmFtZSYmIWNlKHRoaXMpLmlzKCI6ZGlzYWJsZWQiKSYmT3QudGVzdCh0aGlzLm5vZGVOYW1lKSYmIUh0LnRlc3QoZSkmJih0aGlzLmNoZWNrZWR8fCF3ZS50ZXN0KGUpKX0pLm1hcChmdW5jdGlvbihlLHQpe3ZhciBuPWNlKHRoaXMpLnZhbCgpO3JldHVybiBudWxsPT1uP251bGw6QXJyYXkuaXNBcnJheShuKT9jZS5tYXAobixmdW5jdGlvbihlKXtyZXR1cm57bmFtZTp0Lm5hbWUsdmFsdWU6ZS5yZXBsYWNlKEx0LCJcclxuIil9fSk6e25hbWU6dC5uYW1lLHZhbHVlOm4ucmVwbGFjZShMdCwiXHJcbiIpfX0pLmdldCgpfX0pO3ZhciBSdD0vJTIwL2csTXQ9LyMuKiQvLEl0PS8oWz8mXSlfPVteJl0qLyxXdD0vXiguKj8pOlsgXHRdKihbXlxyXG5dKikkL2dtLEZ0PS9eKD86R0VUfEhFQUQpJC8sJHQ9L15cL1wvLyxCdD17fSxfdD17fSxYdD0iKi8iLmNvbmNhdCgiKiIpLFV0PUMuY3JlYXRlRWxlbWVudCgiYSIpO2Z1bmN0aW9uIHp0KG8pe3JldHVybiBmdW5jdGlvbihlLHQpeyJzdHJpbmciIT10eXBlb2YgZSYmKHQ9ZSxlPSIqIik7dmFyIG4scj0wLGk9ZS50b0xvd2VyQ2FzZSgpLm1hdGNoKEQpfHxbXTtpZih2KHQpKXdoaWxlKG49aVtyKytdKSIrIj09PW5bMF0/KG49bi5zbGljZSgxKXx8IioiLChvW25dPW9bbl18fFtdKS51bnNoaWZ0KHQpKToob1tuXT1vW25dfHxbXSkucHVzaCh0KX19ZnVuY3Rpb24gVnQodCxpLG8sYSl7dmFyIHM9e30sdT10PT09X3Q7ZnVuY3Rpb24gbChlKXt2YXIgcjtyZXR1cm4gc1tlXT0hMCxjZS5lYWNoKHRbZV18fFtdLGZ1bmN0aW9uKGUsdCl7dmFyIG49dChpLG8sYSk7cmV0dXJuInN0cmluZyIhPXR5cGVvZiBufHx1fHxzW25dP3U/IShyPW4pOnZvaWQgMDooaS5kYXRhVHlwZXMudW5zaGlmdChuKSxsKG4pLCExKX0pLHJ9cmV0dXJuIGwoaS5kYXRhVHlwZXNbMF0pfHwhc1siKiJdJiZsKCIqIil9ZnVuY3Rpb24gR3QoZSx0KXt2YXIgbixyLGk9Y2UuYWpheFNldHRpbmdzLmZsYXRPcHRpb25zfHx7fTtmb3IobiBpbiB0KXZvaWQgMCE9PXRbbl0mJigoaVtuXT9lOnJ8fChyPXt9KSlbbl09dFtuXSk7cmV0dXJuIHImJmNlLmV4dGVuZCghMCxlLHIpLGV9VXQuaHJlZj1FdC5ocmVmLGNlLmV4dGVuZCh7YWN0aXZlOjAsbGFzdE1vZGlmaWVkOnt9LGV0YWc6e30sYWpheFNldHRpbmdzOnt1cmw6RXQuaHJlZix0eXBlOiJHRVQiLGlzTG9jYWw6L14oPzphYm91dHxhcHB8YXBwLXN0b3JhZ2V8ListZXh0ZW5zaW9ufGZpbGV8cmVzfHdpZGdldCk6JC8udGVzdChFdC5wcm90b2NvbCksZ2xvYmFsOiEwLHByb2Nlc3NEYXRhOiEwLGFzeW5jOiEwLGNvbnRlbnRUeXBlOiJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgiLGFjY2VwdHM6eyIqIjpYdCx0ZXh0OiJ0ZXh0L3BsYWluIixodG1sOiJ0ZXh0L2h0bWwiLHhtbDoiYXBwbGljYXRpb24veG1sLCB0ZXh0L3htbCIsanNvbjoiYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0In0sY29udGVudHM6e3htbDovXGJ4bWxcYi8saHRtbDovXGJodG1sLyxqc29uOi9cYmpzb25cYi99LHJlc3BvbnNlRmllbGRzOnt4bWw6InJlc3BvbnNlWE1MIix0ZXh0OiJyZXNwb25zZVRleHQiLGpzb246InJlc3BvbnNlSlNPTiJ9LGNvbnZlcnRlcnM6eyIqIHRleHQiOlN0cmluZywidGV4dCBodG1sIjohMCwidGV4dCBqc29uIjpKU09OLnBhcnNlLCJ0ZXh0IHhtbCI6Y2UucGFyc2VYTUx9LGZsYXRPcHRpb25zOnt1cmw6ITAsY29udGV4dDohMH19LGFqYXhTZXR1cDpmdW5jdGlvbihlLHQpe3JldHVybiB0P0d0KEd0KGUsY2UuYWpheFNldHRpbmdzKSx0KTpHdChjZS5hamF4U2V0dGluZ3MsZSl9LGFqYXhQcmVmaWx0ZXI6enQoQnQpLGFqYXhUcmFuc3BvcnQ6enQoX3QpLGFqYXg6ZnVuY3Rpb24oZSx0KXsib2JqZWN0Ij09dHlwZW9mIGUmJih0PWUsZT12b2lkIDApLHQ9dHx8e307dmFyIGMsZixwLG4sZCxyLGgsZyxpLG8sdj1jZS5hamF4U2V0dXAoe30sdCkseT12LmNvbnRleHR8fHYsbT12LmNvbnRleHQmJih5Lm5vZGVUeXBlfHx5LmpxdWVyeSk/Y2UoeSk6Y2UuZXZlbnQseD1jZS5EZWZlcnJlZCgpLGI9Y2UuQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLHc9di5zdGF0dXNDb2RlfHx7fSxhPXt9LHM9e30sdT0iY2FuY2VsZWQiLFQ9e3JlYWR5U3RhdGU6MCxnZXRSZXNwb25zZUhlYWRlcjpmdW5jdGlvbihlKXt2YXIgdDtpZihoKXtpZighbil7bj17fTt3aGlsZSh0PVd0LmV4ZWMocCkpblt0WzFdLnRvTG93ZXJDYXNlKCkrIiAiXT0oblt0WzFdLnRvTG93ZXJDYXNlKCkrIiAiXXx8W10pLmNvbmNhdCh0WzJdKX10PW5bZS50b0xvd2VyQ2FzZSgpKyIgIl19cmV0dXJuIG51bGw9PXQ/bnVsbDp0LmpvaW4oIiwgIil9LGdldEFsbFJlc3BvbnNlSGVhZGVyczpmdW5jdGlvbigpe3JldHVybiBoP3A6bnVsbH0sc2V0UmVxdWVzdEhlYWRlcjpmdW5jdGlvbihlLHQpe3JldHVybiBudWxsPT1oJiYoZT1zW2UudG9Mb3dlckNhc2UoKV09c1tlLnRvTG93ZXJDYXNlKCldfHxlLGFbZV09dCksdGhpc30sb3ZlcnJpZGVNaW1lVHlwZTpmdW5jdGlvbihlKXtyZXR1cm4gbnVsbD09aCYmKHYubWltZVR5cGU9ZSksdGhpc30sc3RhdHVzQ29kZTpmdW5jdGlvbihlKXt2YXIgdDtpZihlKWlmKGgpVC5hbHdheXMoZVtULnN0YXR1c10pO2Vsc2UgZm9yKHQgaW4gZSl3W3RdPVt3W3RdLGVbdF1dO3JldHVybiB0aGlzfSxhYm9ydDpmdW5jdGlvbihlKXt2YXIgdD1lfHx1O3JldHVybiBjJiZjLmFib3J0KHQpLGwoMCx0KSx0aGlzfX07aWYoeC5wcm9taXNlKFQpLHYudXJsPSgoZXx8di51cmx8fEV0LmhyZWYpKyIiKS5yZXBsYWNlKCR0LEV0LnByb3RvY29sKyIvLyIpLHYudHlwZT10Lm1ldGhvZHx8dC50eXBlfHx2Lm1ldGhvZHx8di50eXBlLHYuZGF0YVR5cGVzPSh2LmRhdGFUeXBlfHwiKiIpLnRvTG93ZXJDYXNlKCkubWF0Y2goRCl8fFsiIl0sbnVsbD09di5jcm9zc0RvbWFpbil7cj1DLmNyZWF0ZUVsZW1lbnQoImEiKTt0cnl7ci5ocmVmPXYudXJsLHIuaHJlZj1yLmhyZWYsdi5jcm9zc0RvbWFpbj1VdC5wcm90b2NvbCsiLy8iK1V0Lmhvc3QhPXIucHJvdG9jb2wrIi8vIityLmhvc3R9Y2F0Y2goZSl7di5jcm9zc0RvbWFpbj0hMH19aWYodi5kYXRhJiZ2LnByb2Nlc3NEYXRhJiYic3RyaW5nIiE9dHlwZW9mIHYuZGF0YSYmKHYuZGF0YT1jZS5wYXJhbSh2LmRhdGEsdi50cmFkaXRpb25hbCkpLFZ0KEJ0LHYsdCxUKSxoKXJldHVybiBUO2ZvcihpIGluKGc9Y2UuZXZlbnQmJnYuZ2xvYmFsKSYmMD09Y2UuYWN0aXZlKysmJmNlLmV2ZW50LnRyaWdnZXIoImFqYXhTdGFydCIpLHYudHlwZT12LnR5cGUudG9VcHBlckNhc2UoKSx2Lmhhc0NvbnRlbnQ9IUZ0LnRlc3Qodi50eXBlKSxmPXYudXJsLnJlcGxhY2UoTXQsIiIpLHYuaGFzQ29udGVudD92LmRhdGEmJnYucHJvY2Vzc0RhdGEmJjA9PT0odi5jb250ZW50VHlwZXx8IiIpLmluZGV4T2YoImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIpJiYodi5kYXRhPXYuZGF0YS5yZXBsYWNlKFJ0LCIrIikpOihvPXYudXJsLnNsaWNlKGYubGVuZ3RoKSx2LmRhdGEmJih2LnByb2Nlc3NEYXRhfHwic3RyaW5nIj09dHlwZW9mIHYuZGF0YSkmJihmKz0oQXQudGVzdChmKT8iJiI6Ij8iKSt2LmRhdGEsZGVsZXRlIHYuZGF0YSksITE9PT12LmNhY2hlJiYoZj1mLnJlcGxhY2UoSXQsIiQxIiksbz0oQXQudGVzdChmKT8iJiI6Ij8iKSsiXz0iK2p0Lmd1aWQrKytvKSx2LnVybD1mK28pLHYuaWZNb2RpZmllZCYmKGNlLmxhc3RNb2RpZmllZFtmXSYmVC5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Nb2RpZmllZC1TaW5jZSIsY2UubGFzdE1vZGlmaWVkW2ZdKSxjZS5ldGFnW2ZdJiZULnNldFJlcXVlc3RIZWFkZXIoIklmLU5vbmUtTWF0Y2giLGNlLmV0YWdbZl0pKSwodi5kYXRhJiZ2Lmhhc0NvbnRlbnQmJiExIT09di5jb250ZW50VHlwZXx8dC5jb250ZW50VHlwZSkmJlQuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIix2LmNvbnRlbnRUeXBlKSxULnNldFJlcXVlc3RIZWFkZXIoIkFjY2VwdCIsdi5kYXRhVHlwZXNbMF0mJnYuYWNjZXB0c1t2LmRhdGFUeXBlc1swXV0/di5hY2NlcHRzW3YuZGF0YVR5cGVzWzBdXSsoIioiIT09di5kYXRhVHlwZXNbMF0/IiwgIitYdCsiOyBxPTAuMDEiOiIiKTp2LmFjY2VwdHNbIioiXSksdi5oZWFkZXJzKVQuc2V0UmVxdWVzdEhlYWRlcihpLHYuaGVhZGVyc1tpXSk7aWYodi5iZWZvcmVTZW5kJiYoITE9PT12LmJlZm9yZVNlbmQuY2FsbCh5LFQsdil8fGgpKXJldHVybiBULmFib3J0KCk7aWYodT0iYWJvcnQiLGIuYWRkKHYuY29tcGxldGUpLFQuZG9uZSh2LnN1Y2Nlc3MpLFQuZmFpbCh2LmVycm9yKSxjPVZ0KF90LHYsdCxUKSl7aWYoVC5yZWFkeVN0YXRlPTEsZyYmbS50cmlnZ2VyKCJhamF4U2VuZCIsW1Qsdl0pLGgpcmV0dXJuIFQ7di5hc3luYyYmMDx2LnRpbWVvdXQmJihkPWllLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtULmFib3J0KCJ0aW1lb3V0Iil9LHYudGltZW91dCkpO3RyeXtoPSExLGMuc2VuZChhLGwpfWNhdGNoKGUpe2lmKGgpdGhyb3cgZTtsKC0xLGUpfX1lbHNlIGwoLTEsIk5vIFRyYW5zcG9ydCIpO2Z1bmN0aW9uIGwoZSx0LG4scil7dmFyIGksbyxhLHMsdSxsPXQ7aHx8KGg9ITAsZCYmaWUuY2xlYXJUaW1lb3V0KGQpLGM9dm9pZCAwLHA9cnx8IiIsVC5yZWFkeVN0YXRlPTA8ZT80OjAsaT0yMDA8PWUmJmU8MzAwfHwzMDQ9PT1lLG4mJihzPWZ1bmN0aW9uKGUsdCxuKXt2YXIgcixpLG8sYSxzPWUuY29udGVudHMsdT1lLmRhdGFUeXBlczt3aGlsZSgiKiI9PT11WzBdKXUuc2hpZnQoKSx2b2lkIDA9PT1yJiYocj1lLm1pbWVUeXBlfHx0LmdldFJlc3BvbnNlSGVhZGVyKCJDb250ZW50LVR5cGUiKSk7aWYocilmb3IoaSBpbiBzKWlmKHNbaV0mJnNbaV0udGVzdChyKSl7dS51bnNoaWZ0KGkpO2JyZWFrfWlmKHVbMF1pbiBuKW89dVswXTtlbHNle2ZvcihpIGluIG4pe2lmKCF1WzBdfHxlLmNvbnZlcnRlcnNbaSsiICIrdVswXV0pe289aTticmVha31hfHwoYT1pKX1vPW98fGF9aWYobylyZXR1cm4gbyE9PXVbMF0mJnUudW5zaGlmdChvKSxuW29dfSh2LFQsbikpLCFpJiYtMTxjZS5pbkFycmF5KCJzY3JpcHQiLHYuZGF0YVR5cGVzKSYmY2UuaW5BcnJheSgianNvbiIsdi5kYXRhVHlwZXMpPDAmJih2LmNvbnZlcnRlcnNbInRleHQgc2NyaXB0Il09ZnVuY3Rpb24oKXt9KSxzPWZ1bmN0aW9uKGUsdCxuLHIpe3ZhciBpLG8sYSxzLHUsbD17fSxjPWUuZGF0YVR5cGVzLnNsaWNlKCk7aWYoY1sxXSlmb3IoYSBpbiBlLmNvbnZlcnRlcnMpbFthLnRvTG93ZXJDYXNlKCldPWUuY29udmVydGVyc1thXTtvPWMuc2hpZnQoKTt3aGlsZShvKWlmKGUucmVzcG9uc2VGaWVsZHNbb10mJihuW2UucmVzcG9uc2VGaWVsZHNbb11dPXQpLCF1JiZyJiZlLmRhdGFGaWx0ZXImJih0PWUuZGF0YUZpbHRlcih0LGUuZGF0YVR5cGUpKSx1PW8sbz1jLnNoaWZ0KCkpaWYoIioiPT09bylvPXU7ZWxzZSBpZigiKiIhPT11JiZ1IT09byl7aWYoIShhPWxbdSsiICIrb118fGxbIiogIitvXSkpZm9yKGkgaW4gbClpZigocz1pLnNwbGl0KCIgIikpWzFdPT09byYmKGE9bFt1KyIgIitzWzBdXXx8bFsiKiAiK3NbMF1dKSl7ITA9PT1hP2E9bFtpXTohMCE9PWxbaV0mJihvPXNbMF0sYy51bnNoaWZ0KHNbMV0pKTticmVha31pZighMCE9PWEpaWYoYSYmZVsidGhyb3dzIl0pdD1hKHQpO2Vsc2UgdHJ5e3Q9YSh0KX1jYXRjaChlKXtyZXR1cm57c3RhdGU6InBhcnNlcmVycm9yIixlcnJvcjphP2U6Ik5vIGNvbnZlcnNpb24gZnJvbSAiK3UrIiB0byAiK299fX1yZXR1cm57c3RhdGU6InN1Y2Nlc3MiLGRhdGE6dH19KHYscyxULGkpLGk/KHYuaWZNb2RpZmllZCYmKCh1PVQuZ2V0UmVzcG9uc2VIZWFkZXIoIkxhc3QtTW9kaWZpZWQiKSkmJihjZS5sYXN0TW9kaWZpZWRbZl09dSksKHU9VC5nZXRSZXNwb25zZUhlYWRlcigiZXRhZyIpKSYmKGNlLmV0YWdbZl09dSkpLDIwND09PWV8fCJIRUFEIj09PXYudHlwZT9sPSJub2NvbnRlbnQiOjMwND09PWU/bD0ibm90bW9kaWZpZWQiOihsPXMuc3RhdGUsbz1zLmRhdGEsaT0hKGE9cy5lcnJvcikpKTooYT1sLCFlJiZsfHwobD0iZXJyb3IiLGU8MCYmKGU9MCkpKSxULnN0YXR1cz1lLFQuc3RhdHVzVGV4dD0odHx8bCkrIiIsaT94LnJlc29sdmVXaXRoKHksW28sbCxUXSk6eC5yZWplY3RXaXRoKHksW1QsbCxhXSksVC5zdGF0dXNDb2RlKHcpLHc9dm9pZCAwLGcmJm0udHJpZ2dlcihpPyJhamF4U3VjY2VzcyI6ImFqYXhFcnJvciIsW1QsdixpP286YV0pLGIuZmlyZVdpdGgoeSxbVCxsXSksZyYmKG0udHJpZ2dlcigiYWpheENvbXBsZXRlIixbVCx2XSksLS1jZS5hY3RpdmV8fGNlLmV2ZW50LnRyaWdnZXIoImFqYXhTdG9wIikpKX1yZXR1cm4gVH0sZ2V0SlNPTjpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGNlLmdldChlLHQsbiwianNvbiIpfSxnZXRTY3JpcHQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gY2UuZ2V0KGUsdm9pZCAwLHQsInNjcmlwdCIpfX0pLGNlLmVhY2goWyJnZXQiLCJwb3N0Il0sZnVuY3Rpb24oZSxpKXtjZVtpXT1mdW5jdGlvbihlLHQsbixyKXtyZXR1cm4gdih0KSYmKHI9cnx8bixuPXQsdD12b2lkIDApLGNlLmFqYXgoY2UuZXh0ZW5kKHt1cmw6ZSx0eXBlOmksZGF0YVR5cGU6cixkYXRhOnQsc3VjY2VzczpufSxjZS5pc1BsYWluT2JqZWN0KGUpJiZlKSl9fSksY2UuYWpheFByZWZpbHRlcihmdW5jdGlvbihlKXt2YXIgdDtmb3IodCBpbiBlLmhlYWRlcnMpImNvbnRlbnQtdHlwZSI9PT10LnRvTG93ZXJDYXNlKCkmJihlLmNvbnRlbnRUeXBlPWUuaGVhZGVyc1t0XXx8IiIpfSksY2UuX2V2YWxVcmw9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiBjZS5hamF4KHt1cmw6ZSx0eXBlOiJHRVQiLGRhdGFUeXBlOiJzY3JpcHQiLGNhY2hlOiEwLGFzeW5jOiExLGdsb2JhbDohMSxjb252ZXJ0ZXJzOnsidGV4dCBzY3JpcHQiOmZ1bmN0aW9uKCl7fX0sZGF0YUZpbHRlcjpmdW5jdGlvbihlKXtjZS5nbG9iYWxFdmFsKGUsdCxuKX19KX0sY2UuZm4uZXh0ZW5kKHt3cmFwQWxsOmZ1bmN0aW9uKGUpe3ZhciB0O3JldHVybiB0aGlzWzBdJiYodihlKSYmKGU9ZS5jYWxsKHRoaXNbMF0pKSx0PWNlKGUsdGhpc1swXS5vd25lckRvY3VtZW50KS5lcSgwKS5jbG9uZSghMCksdGhpc1swXS5wYXJlbnROb2RlJiZ0Lmluc2VydEJlZm9yZSh0aGlzWzBdKSx0Lm1hcChmdW5jdGlvbigpe3ZhciBlPXRoaXM7d2hpbGUoZS5maXJzdEVsZW1lbnRDaGlsZCllPWUuZmlyc3RFbGVtZW50Q2hpbGQ7cmV0dXJuIGV9KS5hcHBlbmQodGhpcykpLHRoaXN9LHdyYXBJbm5lcjpmdW5jdGlvbihuKXtyZXR1cm4gdihuKT90aGlzLmVhY2goZnVuY3Rpb24oZSl7Y2UodGhpcykud3JhcElubmVyKG4uY2FsbCh0aGlzLGUpKX0pOnRoaXMuZWFjaChmdW5jdGlvbigpe3ZhciBlPWNlKHRoaXMpLHQ9ZS5jb250ZW50cygpO3QubGVuZ3RoP3Qud3JhcEFsbChuKTplLmFwcGVuZChuKX0pfSx3cmFwOmZ1bmN0aW9uKHQpe3ZhciBuPXYodCk7cmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihlKXtjZSh0aGlzKS53cmFwQWxsKG4/dC5jYWxsKHRoaXMsZSk6dCl9KX0sdW53cmFwOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnBhcmVudChlKS5ub3QoImJvZHkiKS5lYWNoKGZ1bmN0aW9uKCl7Y2UodGhpcykucmVwbGFjZVdpdGgodGhpcy5jaGlsZE5vZGVzKX0pLHRoaXN9fSksY2UuZXhwci5wc2V1ZG9zLmhpZGRlbj1mdW5jdGlvbihlKXtyZXR1cm4hY2UuZXhwci5wc2V1ZG9zLnZpc2libGUoZSl9LGNlLmV4cHIucHNldWRvcy52aXNpYmxlPWZ1bmN0aW9uKGUpe3JldHVybiEhKGUub2Zmc2V0V2lkdGh8fGUub2Zmc2V0SGVpZ2h0fHxlLmdldENsaWVudFJlY3RzKCkubGVuZ3RoKX0sY2UuYWpheFNldHRpbmdzLnhocj1mdW5jdGlvbigpe3RyeXtyZXR1cm4gbmV3IGllLlhNTEh0dHBSZXF1ZXN0fWNhdGNoKGUpe319O3ZhciBZdD17MDoyMDAsMTIyMzoyMDR9LFF0PWNlLmFqYXhTZXR0aW5ncy54aHIoKTtsZS5jb3JzPSEhUXQmJiJ3aXRoQ3JlZGVudGlhbHMiaW4gUXQsbGUuYWpheD1RdD0hIVF0LGNlLmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24oaSl7dmFyIG8sYTtpZihsZS5jb3JzfHxRdCYmIWkuY3Jvc3NEb21haW4pcmV0dXJue3NlbmQ6ZnVuY3Rpb24oZSx0KXt2YXIgbixyPWkueGhyKCk7aWYoci5vcGVuKGkudHlwZSxpLnVybCxpLmFzeW5jLGkudXNlcm5hbWUsaS5wYXNzd29yZCksaS54aHJGaWVsZHMpZm9yKG4gaW4gaS54aHJGaWVsZHMpcltuXT1pLnhockZpZWxkc1tuXTtmb3IobiBpbiBpLm1pbWVUeXBlJiZyLm92ZXJyaWRlTWltZVR5cGUmJnIub3ZlcnJpZGVNaW1lVHlwZShpLm1pbWVUeXBlKSxpLmNyb3NzRG9tYWlufHxlWyJYLVJlcXVlc3RlZC1XaXRoIl18fChlWyJYLVJlcXVlc3RlZC1XaXRoIl09IlhNTEh0dHBSZXF1ZXN0IiksZSlyLnNldFJlcXVlc3RIZWFkZXIobixlW25dKTtvPWZ1bmN0aW9uKGUpe3JldHVybiBmdW5jdGlvbigpe28mJihvPWE9ci5vbmxvYWQ9ci5vbmVycm9yPXIub25hYm9ydD1yLm9udGltZW91dD1yLm9ucmVhZHlzdGF0ZWNoYW5nZT1udWxsLCJhYm9ydCI9PT1lP3IuYWJvcnQoKToiZXJyb3IiPT09ZT8ibnVtYmVyIiE9dHlwZW9mIHIuc3RhdHVzP3QoMCwiZXJyb3IiKTp0KHIuc3RhdHVzLHIuc3RhdHVzVGV4dCk6dChZdFtyLnN0YXR1c118fHIuc3RhdHVzLHIuc3RhdHVzVGV4dCwidGV4dCIhPT0oci5yZXNwb25zZVR5cGV8fCJ0ZXh0Iil8fCJzdHJpbmciIT10eXBlb2Ygci5yZXNwb25zZVRleHQ/e2JpbmFyeTpyLnJlc3BvbnNlfTp7dGV4dDpyLnJlc3BvbnNlVGV4dH0sci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKSkpfX0sci5vbmxvYWQ9bygpLGE9ci5vbmVycm9yPXIub250aW1lb3V0PW8oImVycm9yIiksdm9pZCAwIT09ci5vbmFib3J0P3Iub25hYm9ydD1hOnIub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7ND09PXIucmVhZHlTdGF0ZSYmaWUuc2V0VGltZW91dChmdW5jdGlvbigpe28mJmEoKX0pfSxvPW8oImFib3J0Iik7dHJ5e3Iuc2VuZChpLmhhc0NvbnRlbnQmJmkuZGF0YXx8bnVsbCl9Y2F0Y2goZSl7aWYobyl0aHJvdyBlfX0sYWJvcnQ6ZnVuY3Rpb24oKXtvJiZvKCl9fX0pLGNlLmFqYXhQcmVmaWx0ZXIoZnVuY3Rpb24oZSl7ZS5jcm9zc0RvbWFpbiYmKGUuY29udGVudHMuc2NyaXB0PSExKX0pLGNlLmFqYXhTZXR1cCh7YWNjZXB0czp7c2NyaXB0OiJ0ZXh0L2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2phdmFzY3JpcHQsIGFwcGxpY2F0aW9uL2VjbWFzY3JpcHQsIGFwcGxpY2F0aW9uL3gtZWNtYXNjcmlwdCJ9LGNvbnRlbnRzOntzY3JpcHQ6L1xiKD86amF2YXxlY21hKXNjcmlwdFxiL30sY29udmVydGVyczp7InRleHQgc2NyaXB0IjpmdW5jdGlvbihlKXtyZXR1cm4gY2UuZ2xvYmFsRXZhbChlKSxlfX19KSxjZS5hamF4UHJlZmlsdGVyKCJzY3JpcHQiLGZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUuY2FjaGUmJihlLmNhY2hlPSExKSxlLmNyb3NzRG9tYWluJiYoZS50eXBlPSJHRVQiKX0pLGNlLmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsZnVuY3Rpb24obil7dmFyIHIsaTtpZihuLmNyb3NzRG9tYWlufHxuLnNjcmlwdEF0dHJzKXJldHVybntzZW5kOmZ1bmN0aW9uKGUsdCl7cj1jZSgiPHNjcmlwdD4iKS5hdHRyKG4uc2NyaXB0QXR0cnN8fHt9KS5wcm9wKHtjaGFyc2V0Om4uc2NyaXB0Q2hhcnNldCxzcmM6bi51cmx9KS5vbigibG9hZCBlcnJvciIsaT1mdW5jdGlvbihlKXtyLnJlbW92ZSgpLGk9bnVsbCxlJiZ0KCJlcnJvciI9PT1lLnR5cGU/NDA0OjIwMCxlLnR5cGUpfSksQy5oZWFkLmFwcGVuZENoaWxkKHJbMF0pfSxhYm9ydDpmdW5jdGlvbigpe2kmJmkoKX19fSk7dmFyIEp0LEt0PVtdLFp0PS8oPSlcPyg/PSZ8JCl8XD9cPy87Y2UuYWpheFNldHVwKHtqc29ucDoiY2FsbGJhY2siLGpzb25wQ2FsbGJhY2s6ZnVuY3Rpb24oKXt2YXIgZT1LdC5wb3AoKXx8Y2UuZXhwYW5kbysiXyIranQuZ3VpZCsrO3JldHVybiB0aGlzW2VdPSEwLGV9fSksY2UuYWpheFByZWZpbHRlcigianNvbiBqc29ucCIsZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhPSExIT09ZS5qc29ucCYmKFp0LnRlc3QoZS51cmwpPyJ1cmwiOiJzdHJpbmciPT10eXBlb2YgZS5kYXRhJiYwPT09KGUuY29udGVudFR5cGV8fCIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSYmWnQudGVzdChlLmRhdGEpJiYiZGF0YSIpO2lmKGF8fCJqc29ucCI9PT1lLmRhdGFUeXBlc1swXSlyZXR1cm4gcj1lLmpzb25wQ2FsbGJhY2s9dihlLmpzb25wQ2FsbGJhY2spP2UuanNvbnBDYWxsYmFjaygpOmUuanNvbnBDYWxsYmFjayxhP2VbYV09ZVthXS5yZXBsYWNlKFp0LCIkMSIrcik6ITEhPT1lLmpzb25wJiYoZS51cmwrPShBdC50ZXN0KGUudXJsKT8iJiI6Ij8iKStlLmpzb25wKyI9IityKSxlLmNvbnZlcnRlcnNbInNjcmlwdCBqc29uIl09ZnVuY3Rpb24oKXtyZXR1cm4gb3x8Y2UuZXJyb3IocisiIHdhcyBub3QgY2FsbGVkIiksb1swXX0sZS5kYXRhVHlwZXNbMF09Impzb24iLGk9aWVbcl0saWVbcl09ZnVuY3Rpb24oKXtvPWFyZ3VtZW50c30sbi5hbHdheXMoZnVuY3Rpb24oKXt2b2lkIDA9PT1pP2NlKGllKS5yZW1vdmVQcm9wKHIpOmllW3JdPWksZVtyXSYmKGUuanNvbnBDYWxsYmFjaz10Lmpzb25wQ2FsbGJhY2ssS3QucHVzaChyKSksbyYmdihpKSYmaShvWzBdKSxvPWk9dm9pZCAwfSksInNjcmlwdCJ9KSxsZS5jcmVhdGVIVE1MRG9jdW1lbnQ9KChKdD1DLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikuYm9keSkuaW5uZXJIVE1MPSI8Zm9ybT48L2Zvcm0+PGZvcm0+PC9mb3JtPiIsMj09PUp0LmNoaWxkTm9kZXMubGVuZ3RoKSxjZS5wYXJzZUhUTUw9ZnVuY3Rpb24oZSx0LG4pe3JldHVybiJzdHJpbmciIT10eXBlb2YgZT9bXTooImJvb2xlYW4iPT10eXBlb2YgdCYmKG49dCx0PSExKSx0fHwobGUuY3JlYXRlSFRNTERvY3VtZW50Pygocj0odD1DLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudCgiIikpLmNyZWF0ZUVsZW1lbnQoImJhc2UiKSkuaHJlZj1DLmxvY2F0aW9uLmhyZWYsdC5oZWFkLmFwcGVuZENoaWxkKHIpKTp0PUMpLG89IW4mJltdLChpPXcuZXhlYyhlKSk/W3QuY3JlYXRlRWxlbWVudChpWzFdKV06KGk9QWUoW2VdLHQsbyksbyYmby5sZW5ndGgmJmNlKG8pLnJlbW92ZSgpLGNlLm1lcmdlKFtdLGkuY2hpbGROb2RlcykpKTt2YXIgcixpLG99LGNlLmZuLmxvYWQ9ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhPXRoaXMscz1lLmluZGV4T2YoIiAiKTtyZXR1cm4tMTxzJiYocj1UdChlLnNsaWNlKHMpKSxlPWUuc2xpY2UoMCxzKSksdih0KT8obj10LHQ9dm9pZCAwKTp0JiYib2JqZWN0Ij09dHlwZW9mIHQmJihpPSJQT1NUIiksMDxhLmxlbmd0aCYmY2UuYWpheCh7dXJsOmUsdHlwZTppfHwiR0VUIixkYXRhVHlwZToiaHRtbCIsZGF0YTp0fSkuZG9uZShmdW5jdGlvbihlKXtvPWFyZ3VtZW50cyxhLmh0bWwocj9jZSgiPGRpdj4iKS5hcHBlbmQoY2UucGFyc2VIVE1MKGUpKS5maW5kKHIpOmUpfSkuYWx3YXlzKG4mJmZ1bmN0aW9uKGUsdCl7YS5lYWNoKGZ1bmN0aW9uKCl7bi5hcHBseSh0aGlzLG98fFtlLnJlc3BvbnNlVGV4dCx0LGVdKX0pfSksdGhpc30sY2UuZXhwci5wc2V1ZG9zLmFuaW1hdGVkPWZ1bmN0aW9uKHQpe3JldHVybiBjZS5ncmVwKGNlLnRpbWVycyxmdW5jdGlvbihlKXtyZXR1cm4gdD09PWUuZWxlbX0pLmxlbmd0aH0sY2Uub2Zmc2V0PXtzZXRPZmZzZXQ6ZnVuY3Rpb24oZSx0LG4pe3ZhciByLGksbyxhLHMsdSxsPWNlLmNzcyhlLCJwb3NpdGlvbiIpLGM9Y2UoZSksZj17fTsic3RhdGljIj09PWwmJihlLnN0eWxlLnBvc2l0aW9uPSJyZWxhdGl2ZSIpLHM9Yy5vZmZzZXQoKSxvPWNlLmNzcyhlLCJ0b3AiKSx1PWNlLmNzcyhlLCJsZWZ0IiksKCJhYnNvbHV0ZSI9PT1sfHwiZml4ZWQiPT09bCkmJi0xPChvK3UpLmluZGV4T2YoImF1dG8iKT8oYT0ocj1jLnBvc2l0aW9uKCkpLnRvcCxpPXIubGVmdCk6KGE9cGFyc2VGbG9hdChvKXx8MCxpPXBhcnNlRmxvYXQodSl8fDApLHYodCkmJih0PXQuY2FsbChlLG4sY2UuZXh0ZW5kKHt9LHMpKSksbnVsbCE9dC50b3AmJihmLnRvcD10LnRvcC1zLnRvcCthKSxudWxsIT10LmxlZnQmJihmLmxlZnQ9dC5sZWZ0LXMubGVmdCtpKSwidXNpbmciaW4gdD90LnVzaW5nLmNhbGwoZSxmKTpjLmNzcyhmKX19LGNlLmZuLmV4dGVuZCh7b2Zmc2V0OmZ1bmN0aW9uKHQpe2lmKGFyZ3VtZW50cy5sZW5ndGgpcmV0dXJuIHZvaWQgMD09PXQ/dGhpczp0aGlzLmVhY2goZnVuY3Rpb24oZSl7Y2Uub2Zmc2V0LnNldE9mZnNldCh0aGlzLHQsZSl9KTt2YXIgZSxuLHI9dGhpc1swXTtyZXR1cm4gcj9yLmdldENsaWVudFJlY3RzKCkubGVuZ3RoPyhlPXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksbj1yLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcse3RvcDplLnRvcCtuLnBhZ2VZT2Zmc2V0LGxlZnQ6ZS5sZWZ0K24ucGFnZVhPZmZzZXR9KTp7dG9wOjAsbGVmdDowfTp2b2lkIDB9LHBvc2l0aW9uOmZ1bmN0aW9uKCl7aWYodGhpc1swXSl7dmFyIGUsdCxuLHI9dGhpc1swXSxpPXt0b3A6MCxsZWZ0OjB9O2lmKCJmaXhlZCI9PT1jZS5jc3MociwicG9zaXRpb24iKSl0PXIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7ZWxzZXt0PXRoaXMub2Zmc2V0KCksbj1yLm93bmVyRG9jdW1lbnQsZT1yLm9mZnNldFBhcmVudHx8bi5kb2N1bWVudEVsZW1lbnQ7d2hpbGUoZSYmKGU9PT1uLmJvZHl8fGU9PT1uLmRvY3VtZW50RWxlbWVudCkmJiJzdGF0aWMiPT09Y2UuY3NzKGUsInBvc2l0aW9uIikpZT1lLnBhcmVudE5vZGU7ZSYmZSE9PXImJjE9PT1lLm5vZGVUeXBlJiYoKGk9Y2UoZSkub2Zmc2V0KCkpLnRvcCs9Y2UuY3NzKGUsImJvcmRlclRvcFdpZHRoIiwhMCksaS5sZWZ0Kz1jZS5jc3MoZSwiYm9yZGVyTGVmdFdpZHRoIiwhMCkpfXJldHVybnt0b3A6dC50b3AtaS50b3AtY2UuY3NzKHIsIm1hcmdpblRvcCIsITApLGxlZnQ6dC5sZWZ0LWkubGVmdC1jZS5jc3MociwibWFyZ2luTGVmdCIsITApfX19LG9mZnNldFBhcmVudDpmdW5jdGlvbigpe3JldHVybiB0aGlzLm1hcChmdW5jdGlvbigpe3ZhciBlPXRoaXMub2Zmc2V0UGFyZW50O3doaWxlKGUmJiJzdGF0aWMiPT09Y2UuY3NzKGUsInBvc2l0aW9uIikpZT1lLm9mZnNldFBhcmVudDtyZXR1cm4gZXx8Sn0pfX0pLGNlLmVhY2goe3Njcm9sbExlZnQ6InBhZ2VYT2Zmc2V0IixzY3JvbGxUb3A6InBhZ2VZT2Zmc2V0In0sZnVuY3Rpb24odCxpKXt2YXIgbz0icGFnZVlPZmZzZXQiPT09aTtjZS5mblt0XT1mdW5jdGlvbihlKXtyZXR1cm4gUih0aGlzLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtpZih5KGUpP3I9ZTo5PT09ZS5ub2RlVHlwZSYmKHI9ZS5kZWZhdWx0Vmlldyksdm9pZCAwPT09bilyZXR1cm4gcj9yW2ldOmVbdF07cj9yLnNjcm9sbFRvKG8/ci5wYWdlWE9mZnNldDpuLG8/bjpyLnBhZ2VZT2Zmc2V0KTplW3RdPW59LHQsZSxhcmd1bWVudHMubGVuZ3RoKX19KSxjZS5lYWNoKFsidG9wIiwibGVmdCJdLGZ1bmN0aW9uKGUsbil7Y2UuY3NzSG9va3Nbbl09WWUobGUucGl4ZWxQb3NpdGlvbixmdW5jdGlvbihlLHQpe2lmKHQpcmV0dXJuIHQ9R2UoZSxuKSxfZS50ZXN0KHQpP2NlKGUpLnBvc2l0aW9uKClbbl0rInB4Ijp0fSl9KSxjZS5lYWNoKHtIZWlnaHQ6ImhlaWdodCIsV2lkdGg6IndpZHRoIn0sZnVuY3Rpb24oYSxzKXtjZS5lYWNoKHtwYWRkaW5nOiJpbm5lciIrYSxjb250ZW50OnMsIiI6Im91dGVyIithfSxmdW5jdGlvbihyLG8pe2NlLmZuW29dPWZ1bmN0aW9uKGUsdCl7dmFyIG49YXJndW1lbnRzLmxlbmd0aCYmKHJ8fCJib29sZWFuIiE9dHlwZW9mIGUpLGk9cnx8KCEwPT09ZXx8ITA9PT10PyJtYXJnaW4iOiJib3JkZXIiKTtyZXR1cm4gUih0aGlzLGZ1bmN0aW9uKGUsdCxuKXt2YXIgcjtyZXR1cm4geShlKT8wPT09by5pbmRleE9mKCJvdXRlciIpP2VbImlubmVyIithXTplLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudFsiY2xpZW50IithXTo5PT09ZS5ub2RlVHlwZT8ocj1lLmRvY3VtZW50RWxlbWVudCxNYXRoLm1heChlLmJvZHlbInNjcm9sbCIrYV0sclsic2Nyb2xsIithXSxlLmJvZHlbIm9mZnNldCIrYV0sclsib2Zmc2V0IithXSxyWyJjbGllbnQiK2FdKSk6dm9pZCAwPT09bj9jZS5jc3MoZSx0LGkpOmNlLnN0eWxlKGUsdCxuLGkpfSxzLG4/ZTp2b2lkIDAsbil9fSl9KSxjZS5lYWNoKFsiYWpheFN0YXJ0IiwiYWpheFN0b3AiLCJhamF4Q29tcGxldGUiLCJhamF4RXJyb3IiLCJhamF4U3VjY2VzcyIsImFqYXhTZW5kIl0sZnVuY3Rpb24oZSx0KXtjZS5mblt0XT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5vbih0LGUpfX0pLGNlLmZuLmV4dGVuZCh7YmluZDpmdW5jdGlvbihlLHQsbil7cmV0dXJuIHRoaXMub24oZSxudWxsLHQsbil9LHVuYmluZDpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLm9mZihlLG51bGwsdCl9LGRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiB0aGlzLm9uKHQsZSxuLHIpfSx1bmRlbGVnYXRlOmZ1bmN0aW9uKGUsdCxuKXtyZXR1cm4gMT09PWFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vZmYoZSwiKioiKTp0aGlzLm9mZih0LGV8fCIqKiIsbil9LGhvdmVyOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHRoaXMubW91c2VlbnRlcihlKS5tb3VzZWxlYXZlKHR8fGUpfX0pLGNlLmVhY2goImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCByZXNpemUgc2Nyb2xsIGNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlIGNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgY29udGV4dG1lbnUiLnNwbGl0KCIgIiksZnVuY3Rpb24oZSxuKXtjZS5mbltuXT1mdW5jdGlvbihlLHQpe3JldHVybiAwPGFyZ3VtZW50cy5sZW5ndGg/dGhpcy5vbihuLG51bGwsZSx0KTp0aGlzLnRyaWdnZXIobil9fSk7dmFyIGVuPS9eW1xzXHVGRUZGXHhBMF0rfChbXlxzXHVGRUZGXHhBMF0pW1xzXHVGRUZGXHhBMF0rJC9nO2NlLnByb3h5PWZ1bmN0aW9uKGUsdCl7dmFyIG4scixpO2lmKCJzdHJpbmciPT10eXBlb2YgdCYmKG49ZVt0XSx0PWUsZT1uKSx2KGUpKXJldHVybiByPWFlLmNhbGwoYXJndW1lbnRzLDIpLChpPWZ1bmN0aW9uKCl7cmV0dXJuIGUuYXBwbHkodHx8dGhpcyxyLmNvbmNhdChhZS5jYWxsKGFyZ3VtZW50cykpKX0pLmd1aWQ9ZS5ndWlkPWUuZ3VpZHx8Y2UuZ3VpZCsrLGl9LGNlLmhvbGRSZWFkeT1mdW5jdGlvbihlKXtlP2NlLnJlYWR5V2FpdCsrOmNlLnJlYWR5KCEwKX0sY2UuaXNBcnJheT1BcnJheS5pc0FycmF5LGNlLnBhcnNlSlNPTj1KU09OLnBhcnNlLGNlLm5vZGVOYW1lPWZlLGNlLmlzRnVuY3Rpb249dixjZS5pc1dpbmRvdz15LGNlLmNhbWVsQ2FzZT1GLGNlLnR5cGU9eCxjZS5ub3c9RGF0ZS5ub3csY2UuaXNOdW1lcmljPWZ1bmN0aW9uKGUpe3ZhciB0PWNlLnR5cGUoZSk7cmV0dXJuKCJudW1iZXIiPT09dHx8InN0cmluZyI9PT10KSYmIWlzTmFOKGUtcGFyc2VGbG9hdChlKSl9LGNlLnRyaW09ZnVuY3Rpb24oZSl7cmV0dXJuIG51bGw9PWU/IiI6KGUrIiIpLnJlcGxhY2UoZW4sIiQxIil9LCJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQmJmRlZmluZSgianF1ZXJ5IixbXSxmdW5jdGlvbigpe3JldHVybiBjZX0pO3ZhciB0bj1pZS5qUXVlcnksbm49aWUuJDtyZXR1cm4gY2Uubm9Db25mbGljdD1mdW5jdGlvbihlKXtyZXR1cm4gaWUuJD09PWNlJiYoaWUuJD1ubiksZSYmaWUualF1ZXJ5PT09Y2UmJihpZS5qUXVlcnk9dG4pLGNlfSwidW5kZWZpbmVkIj09dHlwZW9mIGUmJihpZS5qUXVlcnk9aWUuJD1jZSksY2V9KTsK"},{"meta":{"name":"sweetalert2.all.min.js","url":"https://unpkg.com/sweetalert2@10.16.6/dist/sweetalert2.all.min.js","ts":1770963303579,"mimetype":"text/javascript"},"source":"IWZ1bmN0aW9uKHQsZSl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYidW5kZWZpbmVkIiE9dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1lKCk6ImZ1bmN0aW9uIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoZSk6KHQ9dHx8c2VsZikuU3dlZXRhbGVydDI9ZSgpfSh0aGlzLGZ1bmN0aW9uKCl7InVzZSBzdHJpY3QiO2Z1bmN0aW9uIHIodCl7cmV0dXJuKHI9ImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmInN5bWJvbCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIFN5bWJvbCYmdC5jb25zdHJ1Y3Rvcj09PVN5bWJvbCYmdCE9PVN5bWJvbC5wcm90b3R5cGU/InN5bWJvbCI6dHlwZW9mIHR9KSh0KX1mdW5jdGlvbiBhKHQsZSl7aWYoISh0IGluc3RhbmNlb2YgZSkpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIil9ZnVuY3Rpb24gbyh0LGUpe2Zvcih2YXIgbj0wO248ZS5sZW5ndGg7bisrKXt2YXIgbz1lW25dO28uZW51bWVyYWJsZT1vLmVudW1lcmFibGV8fCExLG8uY29uZmlndXJhYmxlPSEwLCJ2YWx1ZSJpbiBvJiYoby53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsby5rZXksbyl9fWZ1bmN0aW9uIHModCxlLG4pe3JldHVybiBlJiZvKHQucHJvdG90eXBlLGUpLG4mJm8odCxuKSx0fWZ1bmN0aW9uIHUoKXtyZXR1cm4odT1PYmplY3QuYXNzaWdufHxmdW5jdGlvbih0KXtmb3IodmFyIGU9MTtlPGFyZ3VtZW50cy5sZW5ndGg7ZSsrKXt2YXIgbixvPWFyZ3VtZW50c1tlXTtmb3IobiBpbiBvKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvLG4pJiYodFtuXT1vW25dKX1yZXR1cm4gdH0pLmFwcGx5KHRoaXMsYXJndW1lbnRzKX1mdW5jdGlvbiBjKHQpe3JldHVybihjPU9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3QuZ2V0UHJvdG90eXBlT2Y6ZnVuY3Rpb24odCl7cmV0dXJuIHQuX19wcm90b19ffHxPYmplY3QuZ2V0UHJvdG90eXBlT2YodCl9KSh0KX1mdW5jdGlvbiBsKHQsZSl7cmV0dXJuKGw9T2JqZWN0LnNldFByb3RvdHlwZU9mfHxmdW5jdGlvbih0LGUpe3JldHVybiB0Ll9fcHJvdG9fXz1lLHR9KSh0LGUpfWZ1bmN0aW9uIGQoKXtpZigidW5kZWZpbmVkIj09dHlwZW9mIFJlZmxlY3R8fCFSZWZsZWN0LmNvbnN0cnVjdClyZXR1cm4hMTtpZihSZWZsZWN0LmNvbnN0cnVjdC5zaGFtKXJldHVybiExO2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBQcm94eSlyZXR1cm4hMDt0cnl7cmV0dXJuIEJvb2xlYW4ucHJvdG90eXBlLnZhbHVlT2YuY2FsbChSZWZsZWN0LmNvbnN0cnVjdChCb29sZWFuLFtdLGZ1bmN0aW9uKCl7fSkpLCEwfWNhdGNoKHQpe3JldHVybiExfX1mdW5jdGlvbiBpKHQsZSxuKXtyZXR1cm4oaT1kKCk/UmVmbGVjdC5jb25zdHJ1Y3Q6ZnVuY3Rpb24odCxlLG4pe3ZhciBvPVtudWxsXTtvLnB1c2guYXBwbHkobyxlKTtvPW5ldyhGdW5jdGlvbi5iaW5kLmFwcGx5KHQsbykpO3JldHVybiBuJiZsKG8sbi5wcm90b3R5cGUpLG99KS5hcHBseShudWxsLGFyZ3VtZW50cyl9ZnVuY3Rpb24gcCh0LGUpe3JldHVybiFlfHwib2JqZWN0IiE9dHlwZW9mIGUmJiJmdW5jdGlvbiIhPXR5cGVvZiBlP2Z1bmN0aW9uKHQpe2lmKHZvaWQgMD09PXQpdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWQiKTtyZXR1cm4gdH0odCk6ZX1mdW5jdGlvbiBmKHQsZSxuKXtyZXR1cm4oZj0idW5kZWZpbmVkIiE9dHlwZW9mIFJlZmxlY3QmJlJlZmxlY3QuZ2V0P1JlZmxlY3QuZ2V0OmZ1bmN0aW9uKHQsZSxuKXt0PWZ1bmN0aW9uKHQsZSl7Zm9yKDshT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQsZSkmJm51bGwhPT0odD1jKHQpKTspO3JldHVybiB0fSh0LGUpO2lmKHQpe2U9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0LGUpO3JldHVybiBlLmdldD9lLmdldC5jYWxsKG4pOmUudmFsdWV9fSkodCxlLG58fHQpfWZ1bmN0aW9uIG0odCl7cmV0dXJuIHQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkrdC5zbGljZSgxKX1mdW5jdGlvbiBoKGUpe3JldHVybiBPYmplY3Qua2V5cyhlKS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIGVbdF19KX1mdW5jdGlvbiBnKHQpe3JldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0KX1mdW5jdGlvbiB2KHQsZSl7ZT0nIicuY29uY2F0KHQsJyIgaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UuIFBsZWFzZSB1c2UgIicpLmNvbmNhdChlLCciIGluc3RlYWQuJyksLTE9PT1ZLmluZGV4T2YoZSkmJihZLnB1c2goZSksVyhlKSl9ZnVuY3Rpb24gYih0KXtyZXR1cm4gdCYmImZ1bmN0aW9uIj09dHlwZW9mIHQudG9Qcm9taXNlfWZ1bmN0aW9uIHkodCl7cmV0dXJuIGIodCk/dC50b1Byb21pc2UoKTpQcm9taXNlLnJlc29sdmUodCl9ZnVuY3Rpb24gdyh0KXtyZXR1cm4gdCYmUHJvbWlzZS5yZXNvbHZlKHQpPT09dH1mdW5jdGlvbiBDKHQpe3JldHVybiB0IGluc3RhbmNlb2YgRWxlbWVudHx8Im9iamVjdCI9PT1yKHQ9dCkmJnQuanF1ZXJ5fWZ1bmN0aW9uIGsoKXtyZXR1cm4gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQoJC5jb250YWluZXIpKX1mdW5jdGlvbiBlKHQpe3ZhciBlPWsoKTtyZXR1cm4gZT9lLnF1ZXJ5U2VsZWN0b3IodCk6bnVsbH1mdW5jdGlvbiB0KHQpe3JldHVybiBlKCIuIi5jb25jYXQodCkpfWZ1bmN0aW9uIEEoKXtyZXR1cm4gdCgkLnBvcHVwKX1mdW5jdGlvbiB4KCl7cmV0dXJuIHQoJC5pY29uKX1mdW5jdGlvbiBCKCl7cmV0dXJuIHQoJC50aXRsZSl9ZnVuY3Rpb24gUCgpe3JldHVybiB0KCQuY29udGVudCl9ZnVuY3Rpb24gTygpe3JldHVybiB0KCRbImh0bWwtY29udGFpbmVyIl0pfWZ1bmN0aW9uIEUoKXtyZXR1cm4gdCgkLmltYWdlKX1mdW5jdGlvbiBuKCl7cmV0dXJuIHQoJFsicHJvZ3Jlc3Mtc3RlcHMiXSl9ZnVuY3Rpb24gUygpe3JldHVybiB0KCRbInZhbGlkYXRpb24tbWVzc2FnZSJdKX1mdW5jdGlvbiBUKCl7cmV0dXJuIGUoIi4iLmNvbmNhdCgkLmFjdGlvbnMsIiAuIikuY29uY2F0KCQuY29uZmlybSkpfWZ1bmN0aW9uIEwoKXtyZXR1cm4gZSgiLiIuY29uY2F0KCQuYWN0aW9ucywiIC4iKS5jb25jYXQoJC5kZW55KSl9ZnVuY3Rpb24gRCgpe3JldHVybiBlKCIuIi5jb25jYXQoJC5sb2FkZXIpKX1mdW5jdGlvbiBxKCl7cmV0dXJuIGUoIi4iLmNvbmNhdCgkLmFjdGlvbnMsIiAuIikuY29uY2F0KCQuY2FuY2VsKSl9ZnVuY3Rpb24gaigpe3JldHVybiB0KCQuYWN0aW9ucyl9ZnVuY3Rpb24gTSgpe3JldHVybiB0KCQuaGVhZGVyKX1mdW5jdGlvbiBJKCl7cmV0dXJuIHQoJC5mb290ZXIpfWZ1bmN0aW9uIEgoKXtyZXR1cm4gdCgkWyJ0aW1lci1wcm9ncmVzcy1iYXIiXSl9ZnVuY3Rpb24gVigpe3JldHVybiB0KCQuY2xvc2UpfWZ1bmN0aW9uIFIoKXt2YXIgdD1nKEEoKS5xdWVyeVNlbGVjdG9yQWxsKCdbdGFiaW5kZXhdOm5vdChbdGFiaW5kZXg9Ii0xIl0pOm5vdChbdGFiaW5kZXg9IjAiXSknKSkuc29ydChmdW5jdGlvbih0LGUpe3JldHVybiB0PXBhcnNlSW50KHQuZ2V0QXR0cmlidXRlKCJ0YWJpbmRleCIpKSwoZT1wYXJzZUludChlLmdldEF0dHJpYnV0ZSgidGFiaW5kZXgiKSkpPHQ/MTp0PGU/LTE6MH0pLGU9ZyhBKCkucXVlcnlTZWxlY3RvckFsbCgnXG4gIGFbaHJlZl0sXG4gIGFyZWFbaHJlZl0sXG4gIGlucHV0Om5vdChbZGlzYWJsZWRdKSxcbiAgc2VsZWN0Om5vdChbZGlzYWJsZWRdKSxcbiAgdGV4dGFyZWE6bm90KFtkaXNhYmxlZF0pLFxuICBidXR0b246bm90KFtkaXNhYmxlZF0pLFxuICBpZnJhbWUsXG4gIG9iamVjdCxcbiAgZW1iZWQsXG4gIFt0YWJpbmRleD0iMCJdLFxuICBbY29udGVudGVkaXRhYmxlXSxcbiAgYXVkaW9bY29udHJvbHNdLFxuICB2aWRlb1tjb250cm9sc10sXG4gIHN1bW1hcnlcbicpKS5maWx0ZXIoZnVuY3Rpb24odCl7cmV0dXJuIi0xIiE9PXQuZ2V0QXR0cmlidXRlKCJ0YWJpbmRleCIpfSk7cmV0dXJuIGZ1bmN0aW9uKHQpe2Zvcih2YXIgZT1bXSxuPTA7bjx0Lmxlbmd0aDtuKyspLTE9PT1lLmluZGV4T2YodFtuXSkmJmUucHVzaCh0W25dKTtyZXR1cm4gZX0odC5jb25jYXQoZSkpLmZpbHRlcihmdW5jdGlvbih0KXtyZXR1cm4gd3QodCl9KX1mdW5jdGlvbiBOKCl7cmV0dXJuIUcoKSYmIWRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKCRbIm5vLWJhY2tkcm9wIl0pfWZ1bmN0aW9uIFUoZSx0KXtlLnRleHRDb250ZW50PSIiLHQmJih0PShuZXcgRE9NUGFyc2VyKS5wYXJzZUZyb21TdHJpbmcodCwidGV4dC9odG1sIiksZyh0LnF1ZXJ5U2VsZWN0b3IoImhlYWQiKS5jaGlsZE5vZGVzKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2UuYXBwZW5kQ2hpbGQodCl9KSxnKHQucXVlcnlTZWxlY3RvcigiYm9keSIpLmNoaWxkTm9kZXMpLmZvckVhY2goZnVuY3Rpb24odCl7ZS5hcHBlbmRDaGlsZCh0KX0pKX1mdW5jdGlvbiBGKHQsZSl7aWYoZSl7Zm9yKHZhciBuPWUuc3BsaXQoL1xzKy8pLG89MDtvPG4ubGVuZ3RoO28rKylpZighdC5jbGFzc0xpc3QuY29udGFpbnMobltvXSkpcmV0dXJuO3JldHVybiAxfX1mdW5jdGlvbiBfKHQsZSxuKXt2YXIgbyxpO2lmKGk9ZSxnKChvPXQpLmNsYXNzTGlzdCkuZm9yRWFjaChmdW5jdGlvbih0KXstMT09PWgoJCkuaW5kZXhPZih0KSYmLTE9PT1oKFgpLmluZGV4T2YodCkmJi0xPT09aChpLnNob3dDbGFzcykuaW5kZXhPZih0KSYmby5jbGFzc0xpc3QucmVtb3ZlKHQpfSksZS5jdXN0b21DbGFzcyYmZS5jdXN0b21DbGFzc1tuXSl7aWYoInN0cmluZyIhPXR5cGVvZiBlLmN1c3RvbUNsYXNzW25dJiYhZS5jdXN0b21DbGFzc1tuXS5mb3JFYWNoKXJldHVybiBXKCJJbnZhbGlkIHR5cGUgb2YgY3VzdG9tQ2xhc3MuIi5jb25jYXQobiwnISBFeHBlY3RlZCBzdHJpbmcgb3IgaXRlcmFibGUgb2JqZWN0LCBnb3QgIicpLmNvbmNhdChyKGUuY3VzdG9tQ2xhc3Nbbl0pLCciJykpO3Z0KHQsZS5jdXN0b21DbGFzc1tuXSl9fXZhciB6PSJTd2VldEFsZXJ0MjoiLFc9ZnVuY3Rpb24odCl7Y29uc29sZS53YXJuKCIiLmNvbmNhdCh6LCIgIikuY29uY2F0KCJvYmplY3QiPT09cih0KT90LmpvaW4oIiAiKTp0KSl9LEs9ZnVuY3Rpb24odCl7Y29uc29sZS5lcnJvcigiIi5jb25jYXQoeiwiICIpLmNvbmNhdCh0KSl9LFk9W10sWj1mdW5jdGlvbih0KXtyZXR1cm4iZnVuY3Rpb24iPT10eXBlb2YgdD90KCk6dH0sUT1PYmplY3QuZnJlZXplKHtjYW5jZWw6ImNhbmNlbCIsYmFja2Ryb3A6ImJhY2tkcm9wIixjbG9zZToiY2xvc2UiLGVzYzoiZXNjIix0aW1lcjoidGltZXIifSksSj1mdW5jdGlvbih0KXt2YXIgZSxuPXt9O2ZvcihlIGluIHQpblt0W2VdXT0ic3dhbDItIit0W2VdO3JldHVybiBufSwkPUooWyJjb250YWluZXIiLCJzaG93biIsImhlaWdodC1hdXRvIiwiaW9zZml4IiwicG9wdXAiLCJtb2RhbCIsIm5vLWJhY2tkcm9wIiwibm8tdHJhbnNpdGlvbiIsInRvYXN0IiwidG9hc3Qtc2hvd24iLCJzaG93IiwiaGlkZSIsImNsb3NlIiwidGl0bGUiLCJoZWFkZXIiLCJjb250ZW50IiwiaHRtbC1jb250YWluZXIiLCJhY3Rpb25zIiwiY29uZmlybSIsImRlbnkiLCJjYW5jZWwiLCJmb290ZXIiLCJpY29uIiwiaWNvbi1jb250ZW50IiwiaW1hZ2UiLCJpbnB1dCIsImZpbGUiLCJyYW5nZSIsInNlbGVjdCIsInJhZGlvIiwiY2hlY2tib3giLCJsYWJlbCIsInRleHRhcmVhIiwiaW5wdXRlcnJvciIsImlucHV0LWxhYmVsIiwidmFsaWRhdGlvbi1tZXNzYWdlIiwicHJvZ3Jlc3Mtc3RlcHMiLCJhY3RpdmUtcHJvZ3Jlc3Mtc3RlcCIsInByb2dyZXNzLXN0ZXAiLCJwcm9ncmVzcy1zdGVwLWxpbmUiLCJsb2FkZXIiLCJsb2FkaW5nIiwic3R5bGVkIiwidG9wIiwidG9wLXN0YXJ0IiwidG9wLWVuZCIsInRvcC1sZWZ0IiwidG9wLXJpZ2h0IiwiY2VudGVyIiwiY2VudGVyLXN0YXJ0IiwiY2VudGVyLWVuZCIsImNlbnRlci1sZWZ0IiwiY2VudGVyLXJpZ2h0IiwiYm90dG9tIiwiYm90dG9tLXN0YXJ0IiwiYm90dG9tLWVuZCIsImJvdHRvbS1sZWZ0IiwiYm90dG9tLXJpZ2h0IiwiZ3Jvdy1yb3ciLCJncm93LWNvbHVtbiIsImdyb3ctZnVsbHNjcmVlbiIsInJ0bCIsInRpbWVyLXByb2dyZXNzLWJhciIsInRpbWVyLXByb2dyZXNzLWJhci1jb250YWluZXIiLCJzY3JvbGxiYXItbWVhc3VyZSIsImljb24tc3VjY2VzcyIsImljb24td2FybmluZyIsImljb24taW5mbyIsImljb24tcXVlc3Rpb24iLCJpY29uLWVycm9yIl0pLFg9SihbInN1Y2Nlc3MiLCJ3YXJuaW5nIiwiaW5mbyIsInF1ZXN0aW9uIiwiZXJyb3IiXSksRz1mdW5jdGlvbigpe3JldHVybiBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5jb250YWlucygkWyJ0b2FzdC1zaG93biJdKX0sdHQ9e3ByZXZpb3VzQm9keVBhZGRpbmc6bnVsbH07ZnVuY3Rpb24gZXQodCxlKXtpZighZSlyZXR1cm4gbnVsbDtzd2l0Y2goZSl7Y2FzZSJzZWxlY3QiOmNhc2UidGV4dGFyZWEiOmNhc2UiZmlsZSI6cmV0dXJuIHl0KHQsJFtlXSk7Y2FzZSJjaGVja2JveCI6cmV0dXJuIHQucXVlcnlTZWxlY3RvcigiLiIuY29uY2F0KCQuY2hlY2tib3gsIiBpbnB1dCIpKTtjYXNlInJhZGlvIjpyZXR1cm4gdC5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQoJC5yYWRpbywiIGlucHV0OmNoZWNrZWQiKSl8fHQucXVlcnlTZWxlY3RvcigiLiIuY29uY2F0KCQucmFkaW8sIiBpbnB1dDpmaXJzdC1jaGlsZCIpKTtjYXNlInJhbmdlIjpyZXR1cm4gdC5xdWVyeVNlbGVjdG9yKCIuIi5jb25jYXQoJC5yYW5nZSwiIGlucHV0IikpO2RlZmF1bHQ6cmV0dXJuIHl0KHQsJC5pbnB1dCl9fWZ1bmN0aW9uIG50KHQpe3ZhciBlO3QuZm9jdXMoKSwiZmlsZSIhPT10LnR5cGUmJihlPXQudmFsdWUsdC52YWx1ZT0iIix0LnZhbHVlPWUpfWZ1bmN0aW9uIG90KHQsZSxuKXt0JiZlJiYoZT0ic3RyaW5nIj09dHlwZW9mIGU/ZS5zcGxpdCgvXHMrLykuZmlsdGVyKEJvb2xlYW4pOmUpLmZvckVhY2goZnVuY3Rpb24oZSl7dC5mb3JFYWNoP3QuZm9yRWFjaChmdW5jdGlvbih0KXtuP3QuY2xhc3NMaXN0LmFkZChlKTp0LmNsYXNzTGlzdC5yZW1vdmUoZSl9KTpuP3QuY2xhc3NMaXN0LmFkZChlKTp0LmNsYXNzTGlzdC5yZW1vdmUoZSl9KX1mdW5jdGlvbiBpdCh0LGUsbil7KG49bj09PSIiLmNvbmNhdChwYXJzZUludChuKSk/cGFyc2VJbnQobik6bil8fDA9PT1wYXJzZUludChuKT90LnN0eWxlW2VdPSJudW1iZXIiPT10eXBlb2Ygbj8iIi5jb25jYXQobiwicHgiKTpuOnQuc3R5bGUucmVtb3ZlUHJvcGVydHkoZSl9ZnVuY3Rpb24gcnQodCl7dC5zdHlsZS5kaXNwbGF5PTE8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzFdP2FyZ3VtZW50c1sxXToiZmxleCJ9ZnVuY3Rpb24gYXQodCl7dC5zdHlsZS5kaXNwbGF5PSJub25lIn1mdW5jdGlvbiBzdCh0LGUsbixvKXsoZT10LnF1ZXJ5U2VsZWN0b3IoZSkpJiYoZS5zdHlsZVtuXT1vKX1mdW5jdGlvbiB1dCh0LGUsbil7ZT9ydCh0LG4pOmF0KHQpfWZ1bmN0aW9uIGN0KHQpe3JldHVybiEhKHQuc2Nyb2xsSGVpZ2h0PnQuY2xpZW50SGVpZ2h0KX1mdW5jdGlvbiBsdCh0KXt2YXIgZT13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KSx0PXBhcnNlRmxvYXQoZS5nZXRQcm9wZXJ0eVZhbHVlKCJhbmltYXRpb24tZHVyYXRpb24iKXx8IjAiKSxlPXBhcnNlRmxvYXQoZS5nZXRQcm9wZXJ0eVZhbHVlKCJ0cmFuc2l0aW9uLWR1cmF0aW9uIil8fCIwIik7cmV0dXJuIDA8dHx8MDxlfWZ1bmN0aW9uIGR0KHQpe3ZhciBlPTE8YXJndW1lbnRzLmxlbmd0aCYmdm9pZCAwIT09YXJndW1lbnRzWzFdJiZhcmd1bWVudHNbMV0sbj1IKCk7d3QobikmJihlJiYobi5zdHlsZS50cmFuc2l0aW9uPSJub25lIixuLnN0eWxlLndpZHRoPSIxMDAlIiksc2V0VGltZW91dChmdW5jdGlvbigpe24uc3R5bGUudHJhbnNpdGlvbj0id2lkdGggIi5jb25jYXQodC8xZTMsInMgbGluZWFyIiksbi5zdHlsZS53aWR0aD0iMCUifSwxMCkpfWZ1bmN0aW9uIHB0KCl7cmV0dXJuInVuZGVmaW5lZCI9PXR5cGVvZiB3aW5kb3d8fCJ1bmRlZmluZWQiPT10eXBlb2YgZG9jdW1lbnR9ZnVuY3Rpb24gZnQodCl7TW4uaXNWaXNpYmxlKCkmJmd0IT09dC50YXJnZXQudmFsdWUmJk1uLnJlc2V0VmFsaWRhdGlvbk1lc3NhZ2UoKSxndD10LnRhcmdldC52YWx1ZX1mdW5jdGlvbiBtdCh0LGUpe3QgaW5zdGFuY2VvZiBIVE1MRWxlbWVudD9lLmFwcGVuZENoaWxkKHQpOiJvYmplY3QiPT09cih0KT9BdCh0LGUpOnQmJlUoZSx0KX1mdW5jdGlvbiBodCh0LGUpe3ZhciBuPWooKSxvPUQoKSxpPVQoKSxyPUwoKSxhPXEoKTtlLnNob3dDb25maXJtQnV0dG9ufHxlLnNob3dEZW55QnV0dG9ufHxlLnNob3dDYW5jZWxCdXR0b258fGF0KG4pLF8obixlLCJhY3Rpb25zIiksUHQoaSwiY29uZmlybSIsZSksUHQociwiZGVueSIsZSksUHQoYSwiY2FuY2VsIixlKSxmdW5jdGlvbih0LGUsbixvKXtpZighby5idXR0b25zU3R5bGluZylyZXR1cm4gYnQoW3QsZSxuXSwkLnN0eWxlZCk7dnQoW3QsZSxuXSwkLnN0eWxlZCksby5jb25maXJtQnV0dG9uQ29sb3ImJih0LnN0eWxlLmJhY2tncm91bmRDb2xvcj1vLmNvbmZpcm1CdXR0b25Db2xvcik7by5kZW55QnV0dG9uQ29sb3ImJihlLnN0eWxlLmJhY2tncm91bmRDb2xvcj1vLmRlbnlCdXR0b25Db2xvcik7by5jYW5jZWxCdXR0b25Db2xvciYmKG4uc3R5bGUuYmFja2dyb3VuZENvbG9yPW8uY2FuY2VsQnV0dG9uQ29sb3IpfShpLHIsYSxlKSxlLnJldmVyc2VCdXR0b25zJiYobi5pbnNlcnRCZWZvcmUoYSxvKSxuLmluc2VydEJlZm9yZShyLG8pLG4uaW5zZXJ0QmVmb3JlKGksbykpLFUobyxlLmxvYWRlckh0bWwpLF8obyxlLCJsb2FkZXIiKX12YXIgZ3QsdnQ9ZnVuY3Rpb24odCxlKXtvdCh0LGUsITApfSxidD1mdW5jdGlvbih0LGUpe290KHQsZSwhMSl9LHl0PWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBuPTA7bjx0LmNoaWxkTm9kZXMubGVuZ3RoO24rKylpZihGKHQuY2hpbGROb2Rlc1tuXSxlKSlyZXR1cm4gdC5jaGlsZE5vZGVzW25dfSx3dD1mdW5jdGlvbih0KXtyZXR1cm4hKCF0fHwhKHQub2Zmc2V0V2lkdGh8fHQub2Zmc2V0SGVpZ2h0fHx0LmdldENsaWVudFJlY3RzKCkubGVuZ3RoKSl9LEN0PSdcbiA8ZGl2IGFyaWEtbGFiZWxsZWRieT0iJy5jb25jYXQoJC50aXRsZSwnIiBhcmlhLWRlc2NyaWJlZGJ5PSInKS5jb25jYXQoJC5jb250ZW50LCciIGNsYXNzPSInKS5jb25jYXQoJC5wb3B1cCwnIiB0YWJpbmRleD0iLTEiPlxuICAgPGRpdiBjbGFzcz0iJykuY29uY2F0KCQuaGVhZGVyLCciPlxuICAgICA8dWwgY2xhc3M9IicpLmNvbmNhdCgkWyJwcm9ncmVzcy1zdGVwcyJdLCciPjwvdWw+XG4gICAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkLmljb24sJyI+PC9kaXY+XG4gICAgIDxpbWcgY2xhc3M9IicpLmNvbmNhdCgkLmltYWdlLCciIC8+XG4gICAgIDxoMiBjbGFzcz0iJykuY29uY2F0KCQudGl0bGUsJyIgaWQ9IicpLmNvbmNhdCgkLnRpdGxlLCciPjwvaDI+XG4gICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iJykuY29uY2F0KCQuY2xvc2UsJyI+PC9idXR0b24+XG4gICA8L2Rpdj5cbiAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkLmNvbnRlbnQsJyI+XG4gICAgIDxkaXYgaWQ9IicpLmNvbmNhdCgkLmNvbnRlbnQsJyIgY2xhc3M9IicpLmNvbmNhdCgkWyJodG1sLWNvbnRhaW5lciJdLCciPjwvZGl2PlxuICAgICA8aW5wdXQgY2xhc3M9IicpLmNvbmNhdCgkLmlucHV0LCciIC8+XG4gICAgIDxpbnB1dCB0eXBlPSJmaWxlIiBjbGFzcz0iJykuY29uY2F0KCQuZmlsZSwnIiAvPlxuICAgICA8ZGl2IGNsYXNzPSInKS5jb25jYXQoJC5yYW5nZSwnIj5cbiAgICAgICA8aW5wdXQgdHlwZT0icmFuZ2UiIC8+XG4gICAgICAgPG91dHB1dD48L291dHB1dD5cbiAgICAgPC9kaXY+XG4gICAgIDxzZWxlY3QgY2xhc3M9IicpLmNvbmNhdCgkLnNlbGVjdCwnIj48L3NlbGVjdD5cbiAgICAgPGRpdiBjbGFzcz0iJykuY29uY2F0KCQucmFkaW8sJyI+PC9kaXY+XG4gICAgIDxsYWJlbCBmb3I9IicpLmNvbmNhdCgkLmNoZWNrYm94LCciIGNsYXNzPSInKS5jb25jYXQoJC5jaGVja2JveCwnIj5cbiAgICAgICA8aW5wdXQgdHlwZT0iY2hlY2tib3giIC8+XG4gICAgICAgPHNwYW4gY2xhc3M9IicpLmNvbmNhdCgkLmxhYmVsLCciPjwvc3Bhbj5cbiAgICAgPC9sYWJlbD5cbiAgICAgPHRleHRhcmVhIGNsYXNzPSInKS5jb25jYXQoJC50ZXh0YXJlYSwnIj48L3RleHRhcmVhPlxuICAgICA8ZGl2IGNsYXNzPSInKS5jb25jYXQoJFsidmFsaWRhdGlvbi1tZXNzYWdlIl0sJyIgaWQ9IicpLmNvbmNhdCgkWyJ2YWxpZGF0aW9uLW1lc3NhZ2UiXSwnIj48L2Rpdj5cbiAgIDwvZGl2PlxuICAgPGRpdiBjbGFzcz0iJykuY29uY2F0KCQuYWN0aW9ucywnIj5cbiAgICAgPGRpdiBjbGFzcz0iJykuY29uY2F0KCQubG9hZGVyLCciPjwvZGl2PlxuICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9IicpLmNvbmNhdCgkLmNvbmZpcm0sJyI+PC9idXR0b24+XG4gICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBjbGFzcz0iJykuY29uY2F0KCQuZGVueSwnIj48L2J1dHRvbj5cbiAgICAgPGJ1dHRvbiB0eXBlPSJidXR0b24iIGNsYXNzPSInKS5jb25jYXQoJC5jYW5jZWwsJyI+PC9idXR0b24+XG4gICA8L2Rpdj5cbiAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkLmZvb3RlciwnIj48L2Rpdj5cbiAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkWyJ0aW1lci1wcm9ncmVzcy1iYXItY29udGFpbmVyIl0sJyI+XG4gICAgIDxkaXYgY2xhc3M9IicpLmNvbmNhdCgkWyJ0aW1lci1wcm9ncmVzcy1iYXIiXSwnIj48L2Rpdj5cbiAgIDwvZGl2PlxuIDwvZGl2PlxuJykucmVwbGFjZSgvKF58XG4pXHMqL2csIiIpLGt0PWZ1bmN0aW9uKHQpe3ZhciBlLG4sbyxpLHIsYT0hIShpPWsoKSkmJihpLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaSksYnQoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5XSxbJFsibm8tYmFja2Ryb3AiXSwkWyJ0b2FzdC1zaG93biJdLCRbImhhcy1jb2x1bW4iXV0pLCEwKTtwdCgpP0soIlN3ZWV0QWxlcnQyIHJlcXVpcmVzIGRvY3VtZW50IHRvIGluaXRpYWxpemUiKTooKHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikpLmNsYXNzTmFtZT0kLmNvbnRhaW5lcixhJiZ2dChyLCRbIm5vLXRyYW5zaXRpb24iXSksVShyLEN0KSwoaT0ic3RyaW5nIj09dHlwZW9mKGU9dC50YXJnZXQpP2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZSk6ZSkuYXBwZW5kQ2hpbGQociksYT10LChlPUEoKSkuc2V0QXR0cmlidXRlKCJyb2xlIixhLnRvYXN0PyJhbGVydCI6ImRpYWxvZyIpLGUuc2V0QXR0cmlidXRlKCJhcmlhLWxpdmUiLGEudG9hc3Q/InBvbGl0ZSI6ImFzc2VydGl2ZSIpLGEudG9hc3R8fGUuc2V0QXR0cmlidXRlKCJhcmlhLW1vZGFsIiwidHJ1ZSIpLHI9aSwicnRsIj09PXdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHIpLmRpcmVjdGlvbiYmdnQoaygpLCQucnRsKSx0PVAoKSxhPXl0KHQsJC5pbnB1dCksZT15dCh0LCQuZmlsZSksbj10LnF1ZXJ5U2VsZWN0b3IoIi4iLmNvbmNhdCgkLnJhbmdlLCIgaW5wdXQiKSksbz10LnF1ZXJ5U2VsZWN0b3IoIi4iLmNvbmNhdCgkLnJhbmdlLCIgb3V0cHV0IikpLGk9eXQodCwkLnNlbGVjdCkscj10LnF1ZXJ5U2VsZWN0b3IoIi4iLmNvbmNhdCgkLmNoZWNrYm94LCIgaW5wdXQiKSksdD15dCh0LCQudGV4dGFyZWEpLGEub25pbnB1dD1mdCxlLm9uY2hhbmdlPWZ0LGkub25jaGFuZ2U9ZnQsci5vbmNoYW5nZT1mdCx0Lm9uaW5wdXQ9ZnQsbi5vbmlucHV0PWZ1bmN0aW9uKHQpe2Z0KHQpLG8udmFsdWU9bi52YWx1ZX0sbi5vbmNoYW5nZT1mdW5jdGlvbih0KXtmdCh0KSxuLm5leHRTaWJsaW5nLnZhbHVlPW4udmFsdWV9KX0sQXQ9ZnVuY3Rpb24odCxlKXt0LmpxdWVyeT94dChlLHQpOlUoZSx0LnRvU3RyaW5nKCkpfSx4dD1mdW5jdGlvbih0LGUpe2lmKHQudGV4dENvbnRlbnQ9IiIsMCBpbiBlKWZvcih2YXIgbj0wO24gaW4gZTtuKyspdC5hcHBlbmRDaGlsZChlW25dLmNsb25lTm9kZSghMCkpO2Vsc2UgdC5hcHBlbmRDaGlsZChlLmNsb25lTm9kZSghMCkpfSxCdD1mdW5jdGlvbigpe2lmKHB0KCkpcmV0dXJuITE7dmFyIHQsZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSxuPXtXZWJraXRBbmltYXRpb246IndlYmtpdEFuaW1hdGlvbkVuZCIsT0FuaW1hdGlvbjoib0FuaW1hdGlvbkVuZCBvYW5pbWF0aW9uZW5kIixhbmltYXRpb246ImFuaW1hdGlvbmVuZCJ9O2Zvcih0IGluIG4paWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG4sdCkmJnZvaWQgMCE9PWUuc3R5bGVbdF0pcmV0dXJuIG5bdF07cmV0dXJuITF9KCk7ZnVuY3Rpb24gUHQodCxlLG4pe3V0KHQsblsic2hvdyIuY29uY2F0KG0oZSksIkJ1dHRvbiIpXSwiaW5saW5lLWJsb2NrIiksVSh0LG5bIiIuY29uY2F0KGUsIkJ1dHRvblRleHQiKV0pLHQuc2V0QXR0cmlidXRlKCJhcmlhLWxhYmVsIixuWyIiLmNvbmNhdChlLCJCdXR0b25BcmlhTGFiZWwiKV0pLHQuY2xhc3NOYW1lPSRbZV0sXyh0LG4sIiIuY29uY2F0KGUsIkJ1dHRvbiIpKSx2dCh0LG5bIiIuY29uY2F0KGUsIkJ1dHRvbkNsYXNzIildKX1mdW5jdGlvbiBPdCh0LGUpe3ZhciBuLG8saT1rKCk7aSYmKG89aSwic3RyaW5nIj09dHlwZW9mKG49ZS5iYWNrZHJvcCk/by5zdHlsZS5iYWNrZ3JvdW5kPW46bnx8dnQoW2RvY3VtZW50LmRvY3VtZW50RWxlbWVudCxkb2N1bWVudC5ib2R5XSwkWyJuby1iYWNrZHJvcCJdKSwhZS5iYWNrZHJvcCYmZS5hbGxvd091dHNpZGVDbGljayYmVygnImFsbG93T3V0c2lkZUNsaWNrIiBwYXJhbWV0ZXIgcmVxdWlyZXMgYGJhY2tkcm9wYCBwYXJhbWV0ZXIgdG8gYmUgc2V0IHRvIGB0cnVlYCcpLG89aSwobj1lLnBvc2l0aW9uKWluICQ/dnQobywkW25dKTooVygnVGhlICJwb3NpdGlvbiIgcGFyYW1ldGVyIGlzIG5vdCB2YWxpZCwgZGVmYXVsdGluZyB0byAiY2VudGVyIicpLHZ0KG8sJC5jZW50ZXIpKSxuPWksIShvPWUuZ3Jvdyl8fCJzdHJpbmciIT10eXBlb2Ygb3x8KG89Imdyb3ctIi5jb25jYXQobykpaW4gJCYmdnQobiwkW29dKSxfKGksZSwiY29udGFpbmVyIiksKGU9ZG9jdW1lbnQuYm9keS5nZXRBdHRyaWJ1dGUoImRhdGEtc3dhbDItcXVldWUtc3RlcCIpKSYmKGkuc2V0QXR0cmlidXRlKCJkYXRhLXF1ZXVlLXN0ZXAiLGUpLGRvY3VtZW50LmJvZHkucmVtb3ZlQXR0cmlidXRlKCJkYXRhLXN3YWwyLXF1ZXVlLXN0ZXAiKSkpfWZ1bmN0aW9uIEV0KHQsZSl7dC5wbGFjZWhvbGRlciYmIWUuaW5wdXRQbGFjZWhvbGRlcnx8KHQucGxhY2Vob2xkZXI9ZS5pbnB1dFBsYWNlaG9sZGVyKX1mdW5jdGlvbiBTdCh0LGUsbil7dmFyIG8saTtuLmlucHV0TGFiZWwmJih0LmlkPSQuaW5wdXQsbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJsYWJlbCIpLGk9JFsiaW5wdXQtbGFiZWwiXSxvLnNldEF0dHJpYnV0ZSgiZm9yIix0LmlkKSxvLmNsYXNzTmFtZT1pLHZ0KG8sbi5jdXN0b21DbGFzcy5pbnB1dExhYmVsKSxvLmlubmVyVGV4dD1uLmlucHV0TGFiZWwsZS5pbnNlcnRBZGphY2VudEVsZW1lbnQoImJlZm9yZWJlZ2luIixvKSl9dmFyIFR0PXtwcm9taXNlOm5ldyBXZWFrTWFwLGlubmVyUGFyYW1zOm5ldyBXZWFrTWFwLGRvbUNhY2hlOm5ldyBXZWFrTWFwfSxMdD1bImlucHV0IiwiZmlsZSIsInJhbmdlIiwic2VsZWN0IiwicmFkaW8iLCJjaGVja2JveCIsInRleHRhcmVhIl0sRHQ9ZnVuY3Rpb24odCl7aWYoIUl0W3QuaW5wdXRdKXJldHVybiBLKCdVbmV4cGVjdGVkIHR5cGUgb2YgaW5wdXQhIEV4cGVjdGVkICJ0ZXh0IiwgImVtYWlsIiwgInBhc3N3b3JkIiwgIm51bWJlciIsICJ0ZWwiLCAic2VsZWN0IiwgInJhZGlvIiwgImNoZWNrYm94IiwgInRleHRhcmVhIiwgImZpbGUiIG9yICJ1cmwiLCBnb3QgIicuY29uY2F0KHQuaW5wdXQsJyInKSk7dmFyIGU9TXQodC5pbnB1dCksbj1JdFt0LmlucHV0XShlLHQpO3J0KG4pLHNldFRpbWVvdXQoZnVuY3Rpb24oKXtudChuKX0pfSxxdD1mdW5jdGlvbih0LGUpe3ZhciBuPWV0KFAoKSx0KTtpZihuKWZvcih2YXIgbyBpbiFmdW5jdGlvbih0KXtmb3IodmFyIGU9MDtlPHQuYXR0cmlidXRlcy5sZW5ndGg7ZSsrKXt2YXIgbj10LmF0dHJpYnV0ZXNbZV0ubmFtZTstMT09PVsidHlwZSIsInZhbHVlIiwic3R5bGUiXS5pbmRleE9mKG4pJiZ0LnJlbW92ZUF0dHJpYnV0ZShuKX19KG4pLGUpInJhbmdlIj09PXQmJiJwbGFjZWhvbGRlciI9PT1vfHxuLnNldEF0dHJpYnV0ZShvLGVbb10pfSxqdD1mdW5jdGlvbih0KXt2YXIgZT1NdCh0LmlucHV0KTt0LmN1c3RvbUNsYXNzJiZ2dChlLHQuY3VzdG9tQ2xhc3MuaW5wdXQpfSxNdD1mdW5jdGlvbih0KXt0PSRbdF18fCQuaW5wdXQ7cmV0dXJuIHl0KFAoKSx0KX0sSXQ9e307SXQudGV4dD1JdC5lbWFpbD1JdC5wYXNzd29yZD1JdC5udW1iZXI9SXQudGVsPUl0LnVybD1mdW5jdGlvbih0LGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZS5pbnB1dFZhbHVlfHwibnVtYmVyIj09dHlwZW9mIGUuaW5wdXRWYWx1ZT90LnZhbHVlPWUuaW5wdXRWYWx1ZTp3KGUuaW5wdXRWYWx1ZSl8fFcoJ1VuZXhwZWN0ZWQgdHlwZSBvZiBpbnB1dFZhbHVlISBFeHBlY3RlZCAic3RyaW5nIiwgIm51bWJlciIgb3IgIlByb21pc2UiLCBnb3QgIicuY29uY2F0KHIoZS5pbnB1dFZhbHVlKSwnIicpKSxTdCh0LHQsZSksRXQodCxlKSx0LnR5cGU9ZS5pbnB1dCx0fSxJdC5maWxlPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIFN0KHQsdCxlKSxFdCh0LGUpLHR9LEl0LnJhbmdlPWZ1bmN0aW9uKHQsZSl7dmFyIG49dC5xdWVyeVNlbGVjdG9yKCJpbnB1dCIpLG89dC5xdWVyeVNlbGVjdG9yKCJvdXRwdXQiKTtyZXR1cm4gbi52YWx1ZT1lLmlucHV0VmFsdWUsbi50eXBlPWUuaW5wdXQsby52YWx1ZT1lLmlucHV0VmFsdWUsU3Qobix0LGUpLHR9LEl0LnNlbGVjdD1mdW5jdGlvbih0LGUpe3ZhciBuO3JldHVybiB0LnRleHRDb250ZW50PSIiLGUuaW5wdXRQbGFjZWhvbGRlciYmKG49ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgib3B0aW9uIiksVShuLGUuaW5wdXRQbGFjZWhvbGRlciksbi52YWx1ZT0iIixuLmRpc2FibGVkPSEwLG4uc2VsZWN0ZWQ9ITAsdC5hcHBlbmRDaGlsZChuKSksU3QodCx0LGUpLHR9LEl0LnJhZGlvPWZ1bmN0aW9uKHQpe3JldHVybiB0LnRleHRDb250ZW50PSIiLHR9LEl0LmNoZWNrYm94PWZ1bmN0aW9uKHQsZSl7dmFyIG49ZXQoUCgpLCJjaGVja2JveCIpO24udmFsdWU9MSxuLmlkPSQuY2hlY2tib3gsbi5jaGVja2VkPUJvb2xlYW4oZS5pbnB1dFZhbHVlKTtuPXQucXVlcnlTZWxlY3Rvcigic3BhbiIpO3JldHVybiBVKG4sZS5pbnB1dFBsYWNlaG9sZGVyKSx0fSxJdC50ZXh0YXJlYT1mdW5jdGlvbihlLHQpe2UudmFsdWU9dC5pbnB1dFZhbHVlLEV0KGUsdCksU3QoZSxlLHQpO2Z1bmN0aW9uIG4odCl7cmV0dXJuIHBhcnNlSW50KHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHQpLnBhZGRpbmdMZWZ0KStwYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KS5wYWRkaW5nUmlnaHQpfXZhciBvO3JldHVybiJNdXRhdGlvbk9ic2VydmVyImluIHdpbmRvdyYmKG89cGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUoQSgpKS53aWR0aCksbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24oKXt2YXIgdD1lLm9mZnNldFdpZHRoK24oQSgpKStuKFAoKSk7QSgpLnN0eWxlLndpZHRoPW88dD8iIi5jb25jYXQodCwicHgiKTpudWxsfSkub2JzZXJ2ZShlLHthdHRyaWJ1dGVzOiEwLGF0dHJpYnV0ZUZpbHRlcjpbInN0eWxlIl19KSksZX07ZnVuY3Rpb24gSHQodCxlKXt2YXIgbyxpLHIsbj1PKCk7XyhuLGUsImh0bWxDb250YWluZXIiKSxlLmh0bWw/KG10KGUuaHRtbCxuKSxydChuLCJibG9jayIpKTplLnRleHQ/KG4udGV4dENvbnRlbnQ9ZS50ZXh0LHJ0KG4sImJsb2NrIikpOmF0KG4pLHQ9dCxvPWUsaT1QKCksdD1UdC5pbm5lclBhcmFtcy5nZXQodCkscj0hdHx8by5pbnB1dCE9PXQuaW5wdXQsTHQuZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgZT0kW3RdLG49eXQoaSxlKTtxdCh0LG8uaW5wdXRBdHRyaWJ1dGVzKSxuLmNsYXNzTmFtZT1lLHImJmF0KG4pfSksby5pbnB1dCYmKHImJkR0KG8pLGp0KG8pKSxfKFAoKSxlLCJjb250ZW50Iil9ZnVuY3Rpb24gVnQoKXtyZXR1cm4gaygpJiZrKCkuZ2V0QXR0cmlidXRlKCJkYXRhLXF1ZXVlLXN0ZXAiKX1mdW5jdGlvbiBSdCh0LG8pe3ZhciBpPW4oKTtpZighby5wcm9ncmVzc1N0ZXBzfHwwPT09by5wcm9ncmVzc1N0ZXBzLmxlbmd0aClyZXR1cm4gYXQoaSksMDtydChpKSxpLnRleHRDb250ZW50PSIiO3ZhciByPXBhcnNlSW50KHZvaWQgMD09PW8uY3VycmVudFByb2dyZXNzU3RlcD9WdCgpOm8uY3VycmVudFByb2dyZXNzU3RlcCk7cj49by5wcm9ncmVzc1N0ZXBzLmxlbmd0aCYmVygiSW52YWxpZCBjdXJyZW50UHJvZ3Jlc3NTdGVwIHBhcmFtZXRlciwgaXQgc2hvdWxkIGJlIGxlc3MgdGhhbiBwcm9ncmVzc1N0ZXBzLmxlbmd0aCAoY3VycmVudFByb2dyZXNzU3RlcCBsaWtlIEpTIGFycmF5cyBzdGFydHMgZnJvbSAwKSIpLG8ucHJvZ3Jlc3NTdGVwcy5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7dmFyIG4sdD0obj10LHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGkiKSx2dCh0LCRbInByb2dyZXNzLXN0ZXAiXSksVSh0LG4pLHQpO2kuYXBwZW5kQ2hpbGQodCksZT09PXImJnZ0KHQsJFsiYWN0aXZlLXByb2dyZXNzLXN0ZXAiXSksZSE9PW8ucHJvZ3Jlc3NTdGVwcy5sZW5ndGgtMSYmKHQ9byxlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImxpIiksdnQoZSwkWyJwcm9ncmVzcy1zdGVwLWxpbmUiXSksdC5wcm9ncmVzc1N0ZXBzRGlzdGFuY2UmJihlLnN0eWxlLndpZHRoPXQucHJvZ3Jlc3NTdGVwc0Rpc3RhbmNlKSxpLmFwcGVuZENoaWxkKGUpKX0pfWZ1bmN0aW9uIE50KHQsZSl7dmFyIG4sbz1NKCk7XyhvLGUsImhlYWRlciIpLFJ0KDAsZSksbj10LG89ZSx0PVR0LmlubmVyUGFyYW1zLmdldChuKSxuPXgoKSx0JiZvLmljb249PT10Lmljb24/KFd0KG4sbyksX3QobixvKSk6by5pY29ufHxvLmljb25IdG1sP28uaWNvbiYmLTE9PT1PYmplY3Qua2V5cyhYKS5pbmRleE9mKG8uaWNvbik/KEsoJ1Vua25vd24gaWNvbiEgRXhwZWN0ZWQgInN1Y2Nlc3MiLCAiZXJyb3IiLCAid2FybmluZyIsICJpbmZvIiBvciAicXVlc3Rpb24iLCBnb3QgIicuY29uY2F0KG8uaWNvbiwnIicpKSxhdChuKSk6KHJ0KG4pLFd0KG4sbyksX3QobixvKSx2dChuLG8uc2hvd0NsYXNzLmljb24pKTphdChuKSxmdW5jdGlvbih0KXt2YXIgZT1FKCk7aWYoIXQuaW1hZ2VVcmwpcmV0dXJuIGF0KGUpO3J0KGUsIiIpLGUuc2V0QXR0cmlidXRlKCJzcmMiLHQuaW1hZ2VVcmwpLGUuc2V0QXR0cmlidXRlKCJhbHQiLHQuaW1hZ2VBbHQpLGl0KGUsIndpZHRoIix0LmltYWdlV2lkdGgpLGl0KGUsImhlaWdodCIsdC5pbWFnZUhlaWdodCksZS5jbGFzc05hbWU9JC5pbWFnZSxfKGUsdCwiaW1hZ2UiKX0oZSksbz1lLG49QigpLHV0KG4sby50aXRsZXx8by50aXRsZVRleHQsImJsb2NrIiksby50aXRsZSYmbXQoby50aXRsZSxuKSxvLnRpdGxlVGV4dCYmKG4uaW5uZXJUZXh0PW8udGl0bGVUZXh0KSxfKG4sbywidGl0bGUiKSxvPWUsZT1WKCksVShlLG8uY2xvc2VCdXR0b25IdG1sKSxfKGUsbywiY2xvc2VCdXR0b24iKSx1dChlLG8uc2hvd0Nsb3NlQnV0dG9uKSxlLnNldEF0dHJpYnV0ZSgiYXJpYS1sYWJlbCIsby5jbG9zZUJ1dHRvbkFyaWFMYWJlbCl9ZnVuY3Rpb24gVXQodCxlKXt2YXIgbixvLGk7aT1lLG49aygpLG89QSgpLGkudG9hc3Q/KGl0KG4sIndpZHRoIixpLndpZHRoKSxvLnN0eWxlLndpZHRoPSIxMDAlIik6aXQobywid2lkdGgiLGkud2lkdGgpLGl0KG8sInBhZGRpbmciLGkucGFkZGluZyksaS5iYWNrZ3JvdW5kJiYoby5zdHlsZS5iYWNrZ3JvdW5kPWkuYmFja2dyb3VuZCksYXQoUygpKSxRdChvLGkpLE90KDAsZSksTnQodCxlKSxIdCh0LGUpLGh0KDAsZSksaT1lLHQ9SSgpLHV0KHQsaS5mb290ZXIpLGkuZm9vdGVyJiZtdChpLmZvb3Rlcix0KSxfKHQsaSwiZm9vdGVyIiksImZ1bmN0aW9uIj09dHlwZW9mIGUuZGlkUmVuZGVyP2UuZGlkUmVuZGVyKEEoKSk6ImZ1bmN0aW9uIj09dHlwZW9mIGUub25SZW5kZXImJmUub25SZW5kZXIoQSgpKX1mdW5jdGlvbiBGdCgpe3JldHVybiBUKCkmJlQoKS5jbGljaygpfXZhciBfdD1mdW5jdGlvbih0LGUpe2Zvcih2YXIgbiBpbiBYKWUuaWNvbiE9PW4mJmJ0KHQsWFtuXSk7dnQodCxYW2UuaWNvbl0pLEt0KHQsZSksenQoKSxfKHQsZSwiaWNvbiIpfSx6dD1mdW5jdGlvbigpe2Zvcih2YXIgdD1BKCksZT13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KS5nZXRQcm9wZXJ0eVZhbHVlKCJiYWNrZ3JvdW5kLWNvbG9yIiksbj10LnF1ZXJ5U2VsZWN0b3JBbGwoIltjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXSwgLnN3YWwyLXN1Y2Nlc3MtZml4Iiksbz0wO288bi5sZW5ndGg7bysrKW5bb10uc3R5bGUuYmFja2dyb3VuZENvbG9yPWV9LFd0PWZ1bmN0aW9uKHQsZSl7dC50ZXh0Q29udGVudD0iIixlLmljb25IdG1sP1UodCxZdChlLmljb25IdG1sKSk6InN1Y2Nlc3MiPT09ZS5pY29uP1UodCwnXG4gICAgICA8ZGl2IGNsYXNzPSJzd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmUtbGVmdCI+PC9kaXY+XG4gICAgICA8c3BhbiBjbGFzcz0ic3dhbDItc3VjY2Vzcy1saW5lLXRpcCI+PC9zcGFuPiA8c3BhbiBjbGFzcz0ic3dhbDItc3VjY2Vzcy1saW5lLWxvbmciPjwvc3Bhbj5cbiAgICAgIDxkaXYgY2xhc3M9InN3YWwyLXN1Y2Nlc3MtcmluZyI+PC9kaXY+IDxkaXYgY2xhc3M9InN3YWwyLXN1Y2Nlc3MtZml4Ij48L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9InN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZS1yaWdodCI+PC9kaXY+XG4gICAgJyk6ImVycm9yIj09PWUuaWNvbj9VKHQsJ1xuICAgICAgPHNwYW4gY2xhc3M9InN3YWwyLXgtbWFyayI+XG4gICAgICAgIDxzcGFuIGNsYXNzPSJzd2FsMi14LW1hcmstbGluZS1sZWZ0Ij48L3NwYW4+XG4gICAgICAgIDxzcGFuIGNsYXNzPSJzd2FsMi14LW1hcmstbGluZS1yaWdodCI+PC9zcGFuPlxuICAgICAgPC9zcGFuPlxuICAgICcpOlUodCxZdCh7cXVlc3Rpb246Ij8iLHdhcm5pbmc6IiEiLGluZm86ImkifVtlLmljb25dKSl9LEt0PWZ1bmN0aW9uKHQsZSl7aWYoZS5pY29uQ29sb3Ipe3Quc3R5bGUuY29sb3I9ZS5pY29uQ29sb3IsdC5zdHlsZS5ib3JkZXJDb2xvcj1lLmljb25Db2xvcjtmb3IodmFyIG49MCxvPVsiLnN3YWwyLXN1Y2Nlc3MtbGluZS10aXAiLCIuc3dhbDItc3VjY2Vzcy1saW5lLWxvbmciLCIuc3dhbDIteC1tYXJrLWxpbmUtbGVmdCIsIi5zd2FsMi14LW1hcmstbGluZS1yaWdodCJdO248by5sZW5ndGg7bisrKXN0KHQsb1tuXSwiYmFja2dyb3VuZENvbG9yIixlLmljb25Db2xvcik7c3QodCwiLnN3YWwyLXN1Y2Nlc3MtcmluZyIsImJvcmRlckNvbG9yIixlLmljb25Db2xvcil9fSxZdD1mdW5jdGlvbih0KXtyZXR1cm4nPGRpdiBjbGFzcz0iJy5jb25jYXQoJFsiaWNvbi1jb250ZW50Il0sJyI+JykuY29uY2F0KHQsIjwvZGl2PiIpfSxadD1bXSxRdD1mdW5jdGlvbih0LGUpe3QuY2xhc3NOYW1lPSIiLmNvbmNhdCgkLnBvcHVwLCIgIikuY29uY2F0KHd0KHQpP2Uuc2hvd0NsYXNzLnBvcHVwOiIiKSxlLnRvYXN0Pyh2dChbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGRvY3VtZW50LmJvZHldLCRbInRvYXN0LXNob3duIl0pLHZ0KHQsJC50b2FzdCkpOnZ0KHQsJC5tb2RhbCksXyh0LGUsInBvcHVwIiksInN0cmluZyI9PXR5cGVvZiBlLmN1c3RvbUNsYXNzJiZ2dCh0LGUuY3VzdG9tQ2xhc3MpLGUuaWNvbiYmdnQodCwkWyJpY29uLSIuY29uY2F0KGUuaWNvbildKX07ZnVuY3Rpb24gSnQodCl7KGU9QSgpKXx8TW4uZmlyZSgpO3ZhciBlPUEoKSxuPWooKSxvPUQoKTshdCYmd3QoVCgpKSYmKHQ9VCgpKSxydChuKSx0JiYoYXQodCksby5zZXRBdHRyaWJ1dGUoImRhdGEtYnV0dG9uLXRvLXJlcGxhY2UiLHQuY2xhc3NOYW1lKSksby5wYXJlbnROb2RlLmluc2VydEJlZm9yZShvLHQpLHZ0KFtlLG5dLCQubG9hZGluZykscnQobyksZS5zZXRBdHRyaWJ1dGUoImRhdGEtbG9hZGluZyIsITApLGUuc2V0QXR0cmlidXRlKCJhcmlhLWJ1c3kiLCEwKSxlLmZvY3VzKCl9ZnVuY3Rpb24gJHQobyl7cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHQpe2lmKCFvKXJldHVybiB0KCk7dmFyIGU9d2luZG93LnNjcm9sbFgsbj13aW5kb3cuc2Nyb2xsWTt0ZS5yZXN0b3JlRm9jdXNUaW1lb3V0PXNldFRpbWVvdXQoZnVuY3Rpb24oKXt0ZS5wcmV2aW91c0FjdGl2ZUVsZW1lbnQmJnRlLnByZXZpb3VzQWN0aXZlRWxlbWVudC5mb2N1cz8odGUucHJldmlvdXNBY3RpdmVFbGVtZW50LmZvY3VzKCksdGUucHJldmlvdXNBY3RpdmVFbGVtZW50PW51bGwpOmRvY3VtZW50LmJvZHkmJmRvY3VtZW50LmJvZHkuZm9jdXMoKSx0KCl9LDEwMCksdm9pZCAwIT09ZSYmdm9pZCAwIT09biYmd2luZG93LnNjcm9sbFRvKGUsbil9KX1mdW5jdGlvbiBYdCgpe2lmKHRlLnRpbWVvdXQpcmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHQ9SCgpLGU9cGFyc2VJbnQod2luZG93LmdldENvbXB1dGVkU3R5bGUodCkud2lkdGgpO3Quc3R5bGUucmVtb3ZlUHJvcGVydHkoInRyYW5zaXRpb24iKSx0LnN0eWxlLndpZHRoPSIxMDAlIjt2YXIgbj1wYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSh0KS53aWR0aCksbj1wYXJzZUludChlL24qMTAwKTt0LnN0eWxlLnJlbW92ZVByb3BlcnR5KCJ0cmFuc2l0aW9uIiksdC5zdHlsZS53aWR0aD0iIi5jb25jYXQobiwiJSIpfSgpLHRlLnRpbWVvdXQuc3RvcCgpfWZ1bmN0aW9uIEd0KCl7aWYodGUudGltZW91dCl7dmFyIHQ9dGUudGltZW91dC5zdGFydCgpO3JldHVybiBkdCh0KSx0fX12YXIgdGU9e30sZWU9ITEsbmU9e307ZnVuY3Rpb24gb2UodCl7Zm9yKHZhciBlPXQudGFyZ2V0O2UmJmUhPT1kb2N1bWVudDtlPWUucGFyZW50Tm9kZSlmb3IodmFyIG4gaW4gbmUpe3ZhciBvPWUuZ2V0QXR0cmlidXRlKG4pO2lmKG8pcmV0dXJuIHZvaWQgbmVbbl0uZmlyZSh7dGVtcGxhdGU6b30pfX1mdW5jdGlvbiBpZSh0KXtyZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNlLHQpfWZ1bmN0aW9uIHJlKHQpe3JldHVybiBjZVt0XX1mdW5jdGlvbiBhZSh0KXtmb3IodmFyIGUgaW4gdClpZShuPWUpfHxXKCdVbmtub3duIHBhcmFtZXRlciAiJy5jb25jYXQobiwnIicpKSx0LnRvYXN0JiYobj1lLC0xIT09bGUuaW5kZXhPZihuKSYmVygnVGhlIHBhcmFtZXRlciAiJy5jb25jYXQobiwnIiBpcyBpbmNvbXBhdGlibGUgd2l0aCB0b2FzdHMnKSkpLHJlKGU9ZSkmJnYoZSxyZShlKSk7dmFyIG59dmFyIHNlPXt0aXRsZToiIix0aXRsZVRleHQ6IiIsdGV4dDoiIixodG1sOiIiLGZvb3RlcjoiIixpY29uOnZvaWQgMCxpY29uQ29sb3I6dm9pZCAwLGljb25IdG1sOnZvaWQgMCx0ZW1wbGF0ZTp2b2lkIDAsdG9hc3Q6ITEsYW5pbWF0aW9uOiEwLHNob3dDbGFzczp7cG9wdXA6InN3YWwyLXNob3ciLGJhY2tkcm9wOiJzd2FsMi1iYWNrZHJvcC1zaG93IixpY29uOiJzd2FsMi1pY29uLXNob3cifSxoaWRlQ2xhc3M6e3BvcHVwOiJzd2FsMi1oaWRlIixiYWNrZHJvcDoic3dhbDItYmFja2Ryb3AtaGlkZSIsaWNvbjoic3dhbDItaWNvbi1oaWRlIn0sY3VzdG9tQ2xhc3M6e30sdGFyZ2V0OiJib2R5IixiYWNrZHJvcDohMCxoZWlnaHRBdXRvOiEwLGFsbG93T3V0c2lkZUNsaWNrOiEwLGFsbG93RXNjYXBlS2V5OiEwLGFsbG93RW50ZXJLZXk6ITAsc3RvcEtleWRvd25Qcm9wYWdhdGlvbjohMCxrZXlkb3duTGlzdGVuZXJDYXB0dXJlOiExLHNob3dDb25maXJtQnV0dG9uOiEwLHNob3dEZW55QnV0dG9uOiExLHNob3dDYW5jZWxCdXR0b246ITEscHJlQ29uZmlybTp2b2lkIDAscHJlRGVueTp2b2lkIDAsY29uZmlybUJ1dHRvblRleHQ6Ik9LIixjb25maXJtQnV0dG9uQXJpYUxhYmVsOiIiLGNvbmZpcm1CdXR0b25Db2xvcjp2b2lkIDAsZGVueUJ1dHRvblRleHQ6Ik5vIixkZW55QnV0dG9uQXJpYUxhYmVsOiIiLGRlbnlCdXR0b25Db2xvcjp2b2lkIDAsY2FuY2VsQnV0dG9uVGV4dDoiQ2FuY2VsIixjYW5jZWxCdXR0b25BcmlhTGFiZWw6IiIsY2FuY2VsQnV0dG9uQ29sb3I6dm9pZCAwLGJ1dHRvbnNTdHlsaW5nOiEwLHJldmVyc2VCdXR0b25zOiExLGZvY3VzQ29uZmlybTohMCxmb2N1c0Rlbnk6ITEsZm9jdXNDYW5jZWw6ITEscmV0dXJuRm9jdXM6ITAsc2hvd0Nsb3NlQnV0dG9uOiExLGNsb3NlQnV0dG9uSHRtbDoiJnRpbWVzOyIsY2xvc2VCdXR0b25BcmlhTGFiZWw6IkNsb3NlIHRoaXMgZGlhbG9nIixsb2FkZXJIdG1sOiIiLHNob3dMb2FkZXJPbkNvbmZpcm06ITEsc2hvd0xvYWRlck9uRGVueTohMSxpbWFnZVVybDp2b2lkIDAsaW1hZ2VXaWR0aDp2b2lkIDAsaW1hZ2VIZWlnaHQ6dm9pZCAwLGltYWdlQWx0OiIiLHRpbWVyOnZvaWQgMCx0aW1lclByb2dyZXNzQmFyOiExLHdpZHRoOnZvaWQgMCxwYWRkaW5nOnZvaWQgMCxiYWNrZ3JvdW5kOnZvaWQgMCxpbnB1dDp2b2lkIDAsaW5wdXRQbGFjZWhvbGRlcjoiIixpbnB1dExhYmVsOiIiLGlucHV0VmFsdWU6IiIsaW5wdXRPcHRpb25zOnt9LGlucHV0QXV0b1RyaW06ITAsaW5wdXRBdHRyaWJ1dGVzOnt9LGlucHV0VmFsaWRhdG9yOnZvaWQgMCxyZXR1cm5JbnB1dFZhbHVlT25EZW55OiExLHZhbGlkYXRpb25NZXNzYWdlOnZvaWQgMCxncm93OiExLHBvc2l0aW9uOiJjZW50ZXIiLHByb2dyZXNzU3RlcHM6W10sY3VycmVudFByb2dyZXNzU3RlcDp2b2lkIDAscHJvZ3Jlc3NTdGVwc0Rpc3RhbmNlOnZvaWQgMCxvbkJlZm9yZU9wZW46dm9pZCAwLG9uT3Blbjp2b2lkIDAsd2lsbE9wZW46dm9pZCAwLGRpZE9wZW46dm9pZCAwLG9uUmVuZGVyOnZvaWQgMCxkaWRSZW5kZXI6dm9pZCAwLG9uQ2xvc2U6dm9pZCAwLG9uQWZ0ZXJDbG9zZTp2b2lkIDAsd2lsbENsb3NlOnZvaWQgMCxkaWRDbG9zZTp2b2lkIDAsb25EZXN0cm95OnZvaWQgMCxkaWREZXN0cm95OnZvaWQgMCxzY3JvbGxiYXJQYWRkaW5nOiEwfSx1ZT1bImFsbG93RXNjYXBlS2V5IiwiYWxsb3dPdXRzaWRlQ2xpY2siLCJiYWNrZ3JvdW5kIiwiYnV0dG9uc1N0eWxpbmciLCJjYW5jZWxCdXR0b25BcmlhTGFiZWwiLCJjYW5jZWxCdXR0b25Db2xvciIsImNhbmNlbEJ1dHRvblRleHQiLCJjbG9zZUJ1dHRvbkFyaWFMYWJlbCIsImNsb3NlQnV0dG9uSHRtbCIsImNvbmZpcm1CdXR0b25BcmlhTGFiZWwiLCJjb25maXJtQnV0dG9uQ29sb3IiLCJjb25maXJtQnV0dG9uVGV4dCIsImN1cnJlbnRQcm9ncmVzc1N0ZXAiLCJjdXN0b21DbGFzcyIsImRlbnlCdXR0b25BcmlhTGFiZWwiLCJkZW55QnV0dG9uQ29sb3IiLCJkZW55QnV0dG9uVGV4dCIsImRpZENsb3NlIiwiZGlkRGVzdHJveSIsImZvb3RlciIsImhpZGVDbGFzcyIsImh0bWwiLCJpY29uIiwiaWNvbkNvbG9yIiwiaWNvbkh0bWwiLCJpbWFnZUFsdCIsImltYWdlSGVpZ2h0IiwiaW1hZ2VVcmwiLCJpbWFnZVdpZHRoIiwib25BZnRlckNsb3NlIiwib25DbG9zZSIsIm9uRGVzdHJveSIsInByb2dyZXNzU3RlcHMiLCJyZXR1cm5Gb2N1cyIsInJldmVyc2VCdXR0b25zIiwic2hvd0NhbmNlbEJ1dHRvbiIsInNob3dDbG9zZUJ1dHRvbiIsInNob3dDb25maXJtQnV0dG9uIiwic2hvd0RlbnlCdXR0b24iLCJ0ZXh0IiwidGl0bGUiLCJ0aXRsZVRleHQiLCJ3aWxsQ2xvc2UiXSxjZT17YW5pbWF0aW9uOidzaG93Q2xhc3MiIGFuZCAiaGlkZUNsYXNzJyxvbkJlZm9yZU9wZW46IndpbGxPcGVuIixvbk9wZW46ImRpZE9wZW4iLG9uUmVuZGVyOiJkaWRSZW5kZXIiLG9uQ2xvc2U6IndpbGxDbG9zZSIsb25BZnRlckNsb3NlOiJkaWRDbG9zZSIsb25EZXN0cm95OiJkaWREZXN0cm95In0sbGU9WyJhbGxvd091dHNpZGVDbGljayIsImFsbG93RW50ZXJLZXkiLCJiYWNrZHJvcCIsImZvY3VzQ29uZmlybSIsImZvY3VzRGVueSIsImZvY3VzQ2FuY2VsIiwicmV0dXJuRm9jdXMiLCJoZWlnaHRBdXRvIiwia2V5ZG93bkxpc3RlbmVyQ2FwdHVyZSJdLGRlPU9iamVjdC5mcmVlemUoe2lzVmFsaWRQYXJhbWV0ZXI6aWUsaXNVcGRhdGFibGVQYXJhbWV0ZXI6ZnVuY3Rpb24odCl7cmV0dXJuLTEhPT11ZS5pbmRleE9mKHQpfSxpc0RlcHJlY2F0ZWRQYXJhbWV0ZXI6cmUsYXJnc1RvUGFyYW1zOmZ1bmN0aW9uKG4pe3ZhciBvPXt9O3JldHVybiJvYmplY3QiIT09cihuWzBdKXx8QyhuWzBdKT9bInRpdGxlIiwiaHRtbCIsImljb24iXS5mb3JFYWNoKGZ1bmN0aW9uKHQsZSl7ZT1uW2VdOyJzdHJpbmciPT10eXBlb2YgZXx8QyhlKT9vW3RdPWU6dm9pZCAwIT09ZSYmSygiVW5leHBlY3RlZCB0eXBlIG9mICIuY29uY2F0KHQsJyEgRXhwZWN0ZWQgInN0cmluZyIgb3IgIkVsZW1lbnQiLCBnb3QgJykuY29uY2F0KHIoZSkpKX0pOnUobyxuWzBdKSxvfSxpc1Zpc2libGU6ZnVuY3Rpb24oKXtyZXR1cm4gd3QoQSgpKX0sY2xpY2tDb25maXJtOkZ0LGNsaWNrRGVueTpmdW5jdGlvbigpe3JldHVybiBMKCkmJkwoKS5jbGljaygpfSxjbGlja0NhbmNlbDpmdW5jdGlvbigpe3JldHVybiBxKCkmJnEoKS5jbGljaygpfSxnZXRDb250YWluZXI6ayxnZXRQb3B1cDpBLGdldFRpdGxlOkIsZ2V0Q29udGVudDpQLGdldEh0bWxDb250YWluZXI6TyxnZXRJbWFnZTpFLGdldEljb246eCxnZXRJbnB1dExhYmVsOmZ1bmN0aW9uKCl7cmV0dXJuIHQoJFsiaW5wdXQtbGFiZWwiXSl9LGdldENsb3NlQnV0dG9uOlYsZ2V0QWN0aW9uczpqLGdldENvbmZpcm1CdXR0b246VCxnZXREZW55QnV0dG9uOkwsZ2V0Q2FuY2VsQnV0dG9uOnEsZ2V0TG9hZGVyOkQsZ2V0SGVhZGVyOk0sZ2V0Rm9vdGVyOkksZ2V0VGltZXJQcm9ncmVzc0JhcjpILGdldEZvY3VzYWJsZUVsZW1lbnRzOlIsZ2V0VmFsaWRhdGlvbk1lc3NhZ2U6Uyxpc0xvYWRpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gQSgpLmhhc0F0dHJpYnV0ZSgiZGF0YS1sb2FkaW5nIil9LGZpcmU6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9YXJndW1lbnRzLmxlbmd0aCxlPW5ldyBBcnJheSh0KSxuPTA7bjx0O24rKyllW25dPWFyZ3VtZW50c1tuXTtyZXR1cm4gaSh0aGlzLGUpfSxtaXhpbjpmdW5jdGlvbihyKXtyZXR1cm4gZnVuY3Rpb24odCl7IWZ1bmN0aW9uKHQsZSl7aWYoImZ1bmN0aW9uIiE9dHlwZW9mIGUmJm51bGwhPT1lKXRocm93IG5ldyBUeXBlRXJyb3IoIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uIik7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShlJiZlLnByb3RvdHlwZSx7Y29uc3RydWN0b3I6e3ZhbHVlOnQsd3JpdGFibGU6ITAsY29uZmlndXJhYmxlOiEwfX0pLGUmJmwodCxlKX0oaSx0KTt2YXIgbixvLGU9KG49aSxvPWQoKSxmdW5jdGlvbigpe3ZhciB0LGU9YyhuKTtyZXR1cm4gcCh0aGlzLG8/KHQ9Yyh0aGlzKS5jb25zdHJ1Y3RvcixSZWZsZWN0LmNvbnN0cnVjdChlLGFyZ3VtZW50cyx0KSk6ZS5hcHBseSh0aGlzLGFyZ3VtZW50cykpfSk7ZnVuY3Rpb24gaSgpe3JldHVybiBhKHRoaXMsaSksZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9cmV0dXJuIHMoaSxbe2tleToiX21haW4iLHZhbHVlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuIGYoYyhpLnByb3RvdHlwZSksIl9tYWluIix0aGlzKS5jYWxsKHRoaXMsdCx1KHt9LHIsZSkpfX1dKSxpfSh0aGlzKX0scXVldWU6ZnVuY3Rpb24odCl7dmFyIHI9dGhpcztadD10O2Z1bmN0aW9uIGEodCxlKXtadD1bXSx0KGUpfXZhciBzPVtdO3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihpKXshZnVuY3Rpb24gZShuLG8pe248WnQubGVuZ3RoPyhkb2N1bWVudC5ib2R5LnNldEF0dHJpYnV0ZSgiZGF0YS1zd2FsMi1xdWV1ZS1zdGVwIixuKSxyLmZpcmUoWnRbbl0pLnRoZW4oZnVuY3Rpb24odCl7dm9pZCAwIT09dC52YWx1ZT8ocy5wdXNoKHQudmFsdWUpLGUobisxLG8pKTphKGkse2Rpc21pc3M6dC5kaXNtaXNzfSl9KSk6YShpLHt2YWx1ZTpzfSl9KDApfSl9LGdldFF1ZXVlU3RlcDpWdCxpbnNlcnRRdWV1ZVN0ZXA6ZnVuY3Rpb24odCxlKXtyZXR1cm4gZSYmZTxadC5sZW5ndGg/WnQuc3BsaWNlKGUsMCx0KTpadC5wdXNoKHQpfSxkZWxldGVRdWV1ZVN0ZXA6ZnVuY3Rpb24odCl7dm9pZCAwIT09WnRbdF0mJlp0LnNwbGljZSh0LDEpfSxzaG93TG9hZGluZzpKdCxlbmFibGVMb2FkaW5nOkp0LGdldFRpbWVyTGVmdDpmdW5jdGlvbigpe3JldHVybiB0ZS50aW1lb3V0JiZ0ZS50aW1lb3V0LmdldFRpbWVyTGVmdCgpfSxzdG9wVGltZXI6WHQscmVzdW1lVGltZXI6R3QsdG9nZ2xlVGltZXI6ZnVuY3Rpb24oKXt2YXIgdD10ZS50aW1lb3V0O3JldHVybiB0JiYodC5ydW5uaW5nP1h0Okd0KSgpfSxpbmNyZWFzZVRpbWVyOmZ1bmN0aW9uKHQpe2lmKHRlLnRpbWVvdXQpe3Q9dGUudGltZW91dC5pbmNyZWFzZSh0KTtyZXR1cm4gZHQodCwhMCksdH19LGlzVGltZXJSdW5uaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRlLnRpbWVvdXQmJnRlLnRpbWVvdXQuaXNSdW5uaW5nKCl9LGJpbmRDbGlja0hhbmRsZXI6ZnVuY3Rpb24oKXtuZVswPGFyZ3VtZW50cy5sZW5ndGgmJnZvaWQgMCE9PWFyZ3VtZW50c1swXT9hcmd1bWVudHNbMF06ImRhdGEtc3dhbC10ZW1wbGF0ZSJdPXRoaXMsZWV8fChkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIixvZSksZWU9ITApfX0pO2Z1bmN0aW9uIHBlKCl7dmFyIHQsZTtUdC5pbm5lclBhcmFtcy5nZXQodGhpcykmJih0PVR0LmRvbUNhY2hlLmdldCh0aGlzKSxhdCh0LmxvYWRlciksKGU9dC5wb3B1cC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHQubG9hZGVyLmdldEF0dHJpYnV0ZSgiZGF0YS1idXR0b24tdG8tcmVwbGFjZSIpKSkubGVuZ3RoP3J0KGVbMF0sImlubGluZS1ibG9jayIpOnd0KFQoKSl8fHd0KEwoKSl8fHd0KHEoKSl8fGF0KHQuYWN0aW9ucyksYnQoW3QucG9wdXAsdC5hY3Rpb25zXSwkLmxvYWRpbmcpLHQucG9wdXAucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWJ1c3kiKSx0LnBvcHVwLnJlbW92ZUF0dHJpYnV0ZSgiZGF0YS1sb2FkaW5nIiksdC5jb25maXJtQnV0dG9uLmRpc2FibGVkPSExLHQuZGVueUJ1dHRvbi5kaXNhYmxlZD0hMSx0LmNhbmNlbEJ1dHRvbi5kaXNhYmxlZD0hMSl9ZnVuY3Rpb24gZmUoKXtudWxsPT09dHQucHJldmlvdXNCb2R5UGFkZGluZyYmZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQ+d2luZG93LmlubmVySGVpZ2h0JiYodHQucHJldmlvdXNCb2R5UGFkZGluZz1wYXJzZUludCh3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKCJwYWRkaW5nLXJpZ2h0IikpLGRvY3VtZW50LmJvZHkuc3R5bGUucGFkZGluZ1JpZ2h0PSIiLmNvbmNhdCh0dC5wcmV2aW91c0JvZHlQYWRkaW5nK2Z1bmN0aW9uKCl7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7dC5jbGFzc05hbWU9JFsic2Nyb2xsYmFyLW1lYXN1cmUiXSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHQpO3ZhciBlPXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkud2lkdGgtdC5jbGllbnRXaWR0aDtyZXR1cm4gZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0KSxlfSgpLCJweCIpKX1mdW5jdGlvbiBtZSgpe3JldHVybiEhd2luZG93Lk1TSW5wdXRNZXRob2RDb250ZXh0JiYhIWRvY3VtZW50LmRvY3VtZW50TW9kZX1mdW5jdGlvbiBoZSgpe3ZhciB0PWsoKSxlPUEoKTt0LnN0eWxlLnJlbW92ZVByb3BlcnR5KCJhbGlnbi1pdGVtcyIpLGUub2Zmc2V0VG9wPDAmJih0LnN0eWxlLmFsaWduSXRlbXM9ImZsZXgtc3RhcnQiKX12YXIgZ2U9ZnVuY3Rpb24oKXtuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC8oQ3JpT1N8RnhpT1N8RWRnaU9TfFlhQnJvd3NlcnxVQ0Jyb3dzZXIpL2kpfHxBKCkuc2Nyb2xsSGVpZ2h0PndpbmRvdy5pbm5lckhlaWdodC00NCYmKGsoKS5zdHlsZS5wYWRkaW5nQm90dG9tPSIiLmNvbmNhdCg0NCwicHgiKSl9LHZlPWZ1bmN0aW9uKCl7dmFyIGUsdD1rKCk7dC5vbnRvdWNoc3RhcnQ9ZnVuY3Rpb24odCl7ZT1iZSh0KX0sdC5vbnRvdWNobW92ZT1mdW5jdGlvbih0KXtlJiYodC5wcmV2ZW50RGVmYXVsdCgpLHQuc3RvcFByb3BhZ2F0aW9uKCkpfX0sYmU9ZnVuY3Rpb24odCl7dmFyIGU9dC50YXJnZXQsbj1rKCk7cmV0dXJuIXllKHQpJiYhd2UodCkmJihlPT09bnx8IShjdChuKXx8IklOUFVUIj09PWUudGFnTmFtZXx8Y3QoUCgpKSYmUCgpLmNvbnRhaW5zKGUpKSl9LHllPWZ1bmN0aW9uKHQpe3JldHVybiB0LnRvdWNoZXMmJnQudG91Y2hlcy5sZW5ndGgmJiJzdHlsdXMiPT09dC50b3VjaGVzWzBdLnRvdWNoVHlwZX0sd2U9ZnVuY3Rpb24odCl7cmV0dXJuIHQudG91Y2hlcyYmMTx0LnRvdWNoZXMubGVuZ3RofSxDZT17c3dhbFByb21pc2VSZXNvbHZlOm5ldyBXZWFrTWFwfTtmdW5jdGlvbiBrZSh0LGUsbixvKXtHKCk/RWUodCxvKTooJHQobikudGhlbihmdW5jdGlvbigpe3JldHVybiBFZSh0LG8pfSksdGUua2V5ZG93blRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIix0ZS5rZXlkb3duSGFuZGxlcix7Y2FwdHVyZTp0ZS5rZXlkb3duTGlzdGVuZXJDYXB0dXJlfSksdGUua2V5ZG93bkhhbmRsZXJBZGRlZD0hMSksZS5wYXJlbnROb2RlJiYhZG9jdW1lbnQuYm9keS5nZXRBdHRyaWJ1dGUoImRhdGEtc3dhbDItcXVldWUtc3RlcCIpJiZlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZSksTigpJiYobnVsbCE9PXR0LnByZXZpb3VzQm9keVBhZGRpbmcmJihkb2N1bWVudC5ib2R5LnN0eWxlLnBhZGRpbmdSaWdodD0iIi5jb25jYXQodHQucHJldmlvdXNCb2R5UGFkZGluZywicHgiKSx0dC5wcmV2aW91c0JvZHlQYWRkaW5nPW51bGwpLEYoZG9jdW1lbnQuYm9keSwkLmlvc2ZpeCkmJihlPXBhcnNlSW50KGRvY3VtZW50LmJvZHkuc3R5bGUudG9wLDEwKSxidChkb2N1bWVudC5ib2R5LCQuaW9zZml4KSxkb2N1bWVudC5ib2R5LnN0eWxlLnRvcD0iIixkb2N1bWVudC5ib2R5LnNjcm9sbFRvcD0tMSplKSwidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmbWUoKSYmd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoInJlc2l6ZSIsaGUpLGcoZG9jdW1lbnQuYm9keS5jaGlsZHJlbikuZm9yRWFjaChmdW5jdGlvbih0KXt0Lmhhc0F0dHJpYnV0ZSgiZGF0YS1wcmV2aW91cy1hcmlhLWhpZGRlbiIpPyh0LnNldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iLHQuZ2V0QXR0cmlidXRlKCJkYXRhLXByZXZpb3VzLWFyaWEtaGlkZGVuIikpLHQucmVtb3ZlQXR0cmlidXRlKCJkYXRhLXByZXZpb3VzLWFyaWEtaGlkZGVuIikpOnQucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWhpZGRlbiIpfSkpLGJ0KFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZG9jdW1lbnQuYm9keV0sWyQuc2hvd24sJFsiaGVpZ2h0LWF1dG8iXSwkWyJuby1iYWNrZHJvcCJdLCRbInRvYXN0LXNob3duIl1dKX1mdW5jdGlvbiBBZSh0KXt2YXIgZSxuLG8saT1BKCk7aSYmKHQ9eGUodCksKGU9VHQuaW5uZXJQYXJhbXMuZ2V0KHRoaXMpKSYmIUYoaSxlLmhpZGVDbGFzcy5wb3B1cCkmJihuPUNlLnN3YWxQcm9taXNlUmVzb2x2ZS5nZXQodGhpcyksYnQoaSxlLnNob3dDbGFzcy5wb3B1cCksdnQoaSxlLmhpZGVDbGFzcy5wb3B1cCksbz1rKCksYnQobyxlLnNob3dDbGFzcy5iYWNrZHJvcCksdnQobyxlLmhpZGVDbGFzcy5iYWNrZHJvcCksQmUodGhpcyxpLGUpLG4odCkpKX1mdW5jdGlvbiB4ZSh0KXtyZXR1cm4gdm9pZCAwPT09dD97aXNDb25maXJtZWQ6ITEsaXNEZW5pZWQ6ITEsaXNEaXNtaXNzZWQ6ITB9OnUoe2lzQ29uZmlybWVkOiExLGlzRGVuaWVkOiExLGlzRGlzbWlzc2VkOiExfSx0KX1mdW5jdGlvbiBCZSh0LGUsbil7dmFyIG89aygpLGk9QnQmJmx0KGUpLHI9bi5vbkNsb3NlLGE9bi5vbkFmdGVyQ2xvc2Uscz1uLndpbGxDbG9zZSx1PW4uZGlkQ2xvc2U7UGUoZSxzLHIpLGk/T2UodCxlLG8sbi5yZXR1cm5Gb2N1cyx1fHxhKTprZSh0LG8sbi5yZXR1cm5Gb2N1cyx1fHxhKX12YXIgUGU9ZnVuY3Rpb24odCxlLG4pe251bGwhPT1lJiYiZnVuY3Rpb24iPT10eXBlb2YgZT9lKHQpOm51bGwhPT1uJiYiZnVuY3Rpb24iPT10eXBlb2YgbiYmbih0KX0sT2U9ZnVuY3Rpb24odCxlLG4sbyxpKXt0ZS5zd2FsQ2xvc2VFdmVudEZpbmlzaGVkQ2FsbGJhY2s9a2UuYmluZChudWxsLHQsbixvLGkpLGUuYWRkRXZlbnRMaXN0ZW5lcihCdCxmdW5jdGlvbih0KXt0LnRhcmdldD09PWUmJih0ZS5zd2FsQ2xvc2VFdmVudEZpbmlzaGVkQ2FsbGJhY2soKSxkZWxldGUgdGUuc3dhbENsb3NlRXZlbnRGaW5pc2hlZENhbGxiYWNrKX0pfSxFZT1mdW5jdGlvbih0LGUpe3NldFRpbWVvdXQoZnVuY3Rpb24oKXsiZnVuY3Rpb24iPT10eXBlb2YgZSYmZSgpLHQuX2Rlc3Ryb3koKX0pfTtmdW5jdGlvbiBTZSh0LGUsbil7dmFyIG89VHQuZG9tQ2FjaGUuZ2V0KHQpO2UuZm9yRWFjaChmdW5jdGlvbih0KXtvW3RdLmRpc2FibGVkPW59KX1mdW5jdGlvbiBUZSh0LGUpe2lmKCF0KXJldHVybiExO2lmKCJyYWRpbyI9PT10LnR5cGUpZm9yKHZhciBuPXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoImlucHV0Iiksbz0wO288bi5sZW5ndGg7bysrKW5bb10uZGlzYWJsZWQ9ZTtlbHNlIHQuZGlzYWJsZWQ9ZX12YXIgTGU9ZnVuY3Rpb24oKXtmdW5jdGlvbiBuKHQsZSl7YSh0aGlzLG4pLHRoaXMuY2FsbGJhY2s9dCx0aGlzLnJlbWFpbmluZz1lLHRoaXMucnVubmluZz0hMSx0aGlzLnN0YXJ0KCl9cmV0dXJuIHMobixbe2tleToic3RhcnQiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucnVubmluZ3x8KHRoaXMucnVubmluZz0hMCx0aGlzLnN0YXJ0ZWQ9bmV3IERhdGUsdGhpcy5pZD1zZXRUaW1lb3V0KHRoaXMuY2FsbGJhY2ssdGhpcy5yZW1haW5pbmcpKSx0aGlzLnJlbWFpbmluZ319LHtrZXk6InN0b3AiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucnVubmluZyYmKHRoaXMucnVubmluZz0hMSxjbGVhclRpbWVvdXQodGhpcy5pZCksdGhpcy5yZW1haW5pbmctPW5ldyBEYXRlLXRoaXMuc3RhcnRlZCksdGhpcy5yZW1haW5pbmd9fSx7a2V5OiJpbmNyZWFzZSIsdmFsdWU6ZnVuY3Rpb24odCl7dmFyIGU9dGhpcy5ydW5uaW5nO3JldHVybiBlJiZ0aGlzLnN0b3AoKSx0aGlzLnJlbWFpbmluZys9dCxlJiZ0aGlzLnN0YXJ0KCksdGhpcy5yZW1haW5pbmd9fSx7a2V5OiJnZXRUaW1lckxlZnQiLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucnVubmluZyYmKHRoaXMuc3RvcCgpLHRoaXMuc3RhcnQoKSksdGhpcy5yZW1haW5pbmd9fSx7a2V5OiJpc1J1bm5pbmciLHZhbHVlOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMucnVubmluZ319XSksbn0oKSxEZT17ZW1haWw6ZnVuY3Rpb24odCxlKXtyZXR1cm4vXlthLXpBLVowLTkuK18tXStAW2EtekEtWjAtOS4tXStcLlthLXpBLVowLTktXXsyLDI0fSQvLnRlc3QodCk/UHJvbWlzZS5yZXNvbHZlKCk6UHJvbWlzZS5yZXNvbHZlKGV8fCJJbnZhbGlkIGVtYWlsIGFkZHJlc3MiKX0sdXJsOmZ1bmN0aW9uKHQsZSl7cmV0dXJuL15odHRwcz86XC9cLyh3d3dcLik/Wy1hLXpBLVowLTlAOiUuXyt+Iz1dezEsMjU2fVwuW2Etel17Miw2M31cYihbLWEtekEtWjAtOUA6JV8rLn4jPyYvPV0qKSQvLnRlc3QodCk/UHJvbWlzZS5yZXNvbHZlKCk6UHJvbWlzZS5yZXNvbHZlKGV8fCJJbnZhbGlkIFVSTCIpfX07ZnVuY3Rpb24gcWUodCl7dmFyIGUsbjsoZT10KS5pbnB1dFZhbGlkYXRvcnx8T2JqZWN0LmtleXMoRGUpLmZvckVhY2goZnVuY3Rpb24odCl7ZS5pbnB1dD09PXQmJihlLmlucHV0VmFsaWRhdG9yPURlW3RdKX0pLHQuc2hvd0xvYWRlck9uQ29uZmlybSYmIXQucHJlQ29uZmlybSYmVygic2hvd0xvYWRlck9uQ29uZmlybSBpcyBzZXQgdG8gdHJ1ZSwgYnV0IHByZUNvbmZpcm0gaXMgbm90IGRlZmluZWQuXG5zaG93TG9hZGVyT25Db25maXJtIHNob3VsZCBiZSB1c2VkIHRvZ2V0aGVyIHdpdGggcHJlQ29uZmlybSwgc2VlIHVzYWdlIGV4YW1wbGU6XG5odHRwczovL3N3ZWV0YWxlcnQyLmdpdGh1Yi5pby8jYWpheC1yZXF1ZXN0IiksdC5hbmltYXRpb249Wih0LmFuaW1hdGlvbiksKG49dCkudGFyZ2V0JiYoInN0cmluZyIhPXR5cGVvZiBuLnRhcmdldHx8ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuLnRhcmdldCkpJiYoInN0cmluZyI9PXR5cGVvZiBuLnRhcmdldHx8bi50YXJnZXQuYXBwZW5kQ2hpbGQpfHwoVygnVGFyZ2V0IHBhcmFtZXRlciBpcyBub3QgdmFsaWQsIGRlZmF1bHRpbmcgdG8gImJvZHkiJyksbi50YXJnZXQ9ImJvZHkiKSwic3RyaW5nIj09dHlwZW9mIHQudGl0bGUmJih0LnRpdGxlPXQudGl0bGUuc3BsaXQoIlxuIikuam9pbigiPGJyIC8+IikpLGt0KHQpfWZ1bmN0aW9uIGplKHQpe3ZhciBlPWsoKSxuPUEoKTsiZnVuY3Rpb24iPT10eXBlb2YgdC53aWxsT3Blbj90LndpbGxPcGVuKG4pOiJmdW5jdGlvbiI9PXR5cGVvZiB0Lm9uQmVmb3JlT3BlbiYmdC5vbkJlZm9yZU9wZW4obik7dmFyIG89d2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkub3ZlcmZsb3dZO0plKGUsbix0KSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7WmUoZSxuKX0sMTApLE4oKSYmKFFlKGUsdC5zY3JvbGxiYXJQYWRkaW5nLG8pLGcoZG9jdW1lbnQuYm9keS5jaGlsZHJlbikuZm9yRWFjaChmdW5jdGlvbih0KXt0PT09aygpfHxmdW5jdGlvbih0LGUpe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiB0LmNvbnRhaW5zKXJldHVybiB0LmNvbnRhaW5zKGUpfSh0LGsoKSl8fCh0Lmhhc0F0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iKSYmdC5zZXRBdHRyaWJ1dGUoImRhdGEtcHJldmlvdXMtYXJpYS1oaWRkZW4iLHQuZ2V0QXR0cmlidXRlKCJhcmlhLWhpZGRlbiIpKSx0LnNldEF0dHJpYnV0ZSgiYXJpYS1oaWRkZW4iLCJ0cnVlIikpfSkpLEcoKXx8dGUucHJldmlvdXNBY3RpdmVFbGVtZW50fHwodGUucHJldmlvdXNBY3RpdmVFbGVtZW50PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpLFllKG4sdCksYnQoZSwkWyJuby10cmFuc2l0aW9uIl0pfWZ1bmN0aW9uIE1lKHQpe3ZhciBlPUEoKTt0LnRhcmdldD09PWUmJih0PWsoKSxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoQnQsTWUpLHQuc3R5bGUub3ZlcmZsb3dZPSJhdXRvIil9ZnVuY3Rpb24gSWUodCxlKXt0LmNsb3NlUG9wdXAoe2lzQ29uZmlybWVkOiEwLHZhbHVlOmV9KX1mdW5jdGlvbiBIZSh0LGUsbil7dmFyIG89UigpO2lmKG8ubGVuZ3RoKXJldHVybihlKz1uKT09PW8ubGVuZ3RoP2U9MDotMT09PWUmJihlPW8ubGVuZ3RoLTEpLG9bZV0uZm9jdXMoKTtBKCkuZm9jdXMoKX12YXIgVmU9WyJzd2FsLXRpdGxlIiwic3dhbC1odG1sIiwic3dhbC1mb290ZXIiXSxSZT1mdW5jdGlvbih0KXt2YXIgbj17fTtyZXR1cm4gZyh0LnF1ZXJ5U2VsZWN0b3JBbGwoInN3YWwtcGFyYW0iKSkuZm9yRWFjaChmdW5jdGlvbih0KXtLZSh0LFsibmFtZSIsInZhbHVlIl0pO3ZhciBlPXQuZ2V0QXR0cmlidXRlKCJuYW1lIiksdD10LmdldEF0dHJpYnV0ZSgidmFsdWUiKTsiYm9vbGVhbiI9PXR5cGVvZiBzZVtlXSYmImZhbHNlIj09PXQmJih0PSExKSwib2JqZWN0Ij09PXIoc2VbZV0pJiYodD1KU09OLnBhcnNlKHQpKSxuW2VdPXR9KSxufSxOZT1mdW5jdGlvbih0KXt2YXIgbj17fTtyZXR1cm4gZyh0LnF1ZXJ5U2VsZWN0b3JBbGwoInN3YWwtYnV0dG9uIikpLmZvckVhY2goZnVuY3Rpb24odCl7S2UodCxbInR5cGUiLCJjb2xvciIsImFyaWEtbGFiZWwiXSk7dmFyIGU9dC5nZXRBdHRyaWJ1dGUoInR5cGUiKTtuWyIiLmNvbmNhdChlLCJCdXR0b25UZXh0IildPXQuaW5uZXJIVE1MLG5bInNob3ciLmNvbmNhdChtKGUpLCJCdXR0b24iKV09ITAsdC5oYXNBdHRyaWJ1dGUoImNvbG9yIikmJihuWyIiLmNvbmNhdChlLCJCdXR0b25Db2xvciIpXT10LmdldEF0dHJpYnV0ZSgiY29sb3IiKSksdC5oYXNBdHRyaWJ1dGUoImFyaWEtbGFiZWwiKSYmKG5bIiIuY29uY2F0KGUsIkJ1dHRvbkFyaWFMYWJlbCIpXT10LmdldEF0dHJpYnV0ZSgiYXJpYS1sYWJlbCIpKX0pLG59LFVlPWZ1bmN0aW9uKHQpe3ZhciBlPXt9LHQ9dC5xdWVyeVNlbGVjdG9yKCJzd2FsLWltYWdlIik7cmV0dXJuIHQmJihLZSh0LFsic3JjIiwid2lkdGgiLCJoZWlnaHQiLCJhbHQiXSksdC5oYXNBdHRyaWJ1dGUoInNyYyIpJiYoZS5pbWFnZVVybD10LmdldEF0dHJpYnV0ZSgic3JjIikpLHQuaGFzQXR0cmlidXRlKCJ3aWR0aCIpJiYoZS5pbWFnZVdpZHRoPXQuZ2V0QXR0cmlidXRlKCJ3aWR0aCIpKSx0Lmhhc0F0dHJpYnV0ZSgiaGVpZ2h0IikmJihlLmltYWdlSGVpZ2h0PXQuZ2V0QXR0cmlidXRlKCJoZWlnaHQiKSksdC5oYXNBdHRyaWJ1dGUoImFsdCIpJiYoZS5pbWFnZUFsdD10LmdldEF0dHJpYnV0ZSgiYWx0IikpKSxlfSxGZT1mdW5jdGlvbih0KXt2YXIgZT17fSx0PXQucXVlcnlTZWxlY3Rvcigic3dhbC1pY29uIik7cmV0dXJuIHQmJihLZSh0LFsidHlwZSIsImNvbG9yIl0pLHQuaGFzQXR0cmlidXRlKCJ0eXBlIikmJihlLmljb249dC5nZXRBdHRyaWJ1dGUoInR5cGUiKSksdC5oYXNBdHRyaWJ1dGUoImNvbG9yIikmJihlLmljb25Db2xvcj10LmdldEF0dHJpYnV0ZSgiY29sb3IiKSksZS5pY29uSHRtbD10LmlubmVySFRNTCksZX0sX2U9ZnVuY3Rpb24odCl7dmFyIG49e30sZT10LnF1ZXJ5U2VsZWN0b3IoInN3YWwtaW5wdXQiKTtlJiYoS2UoZSxbInR5cGUiLCJsYWJlbCIsInBsYWNlaG9sZGVyIiwidmFsdWUiXSksbi5pbnB1dD1lLmdldEF0dHJpYnV0ZSgidHlwZSIpfHwidGV4dCIsZS5oYXNBdHRyaWJ1dGUoImxhYmVsIikmJihuLmlucHV0TGFiZWw9ZS5nZXRBdHRyaWJ1dGUoImxhYmVsIikpLGUuaGFzQXR0cmlidXRlKCJwbGFjZWhvbGRlciIpJiYobi5pbnB1dFBsYWNlaG9sZGVyPWUuZ2V0QXR0cmlidXRlKCJwbGFjZWhvbGRlciIpKSxlLmhhc0F0dHJpYnV0ZSgidmFsdWUiKSYmKG4uaW5wdXRWYWx1ZT1lLmdldEF0dHJpYnV0ZSgidmFsdWUiKSkpO3Q9dC5xdWVyeVNlbGVjdG9yQWxsKCJzd2FsLWlucHV0LW9wdGlvbiIpO3JldHVybiB0Lmxlbmd0aCYmKG4uaW5wdXRPcHRpb25zPXt9LGcodCkuZm9yRWFjaChmdW5jdGlvbih0KXtLZSh0LFsidmFsdWUiXSk7dmFyIGU9dC5nZXRBdHRyaWJ1dGUoInZhbHVlIiksdD10LmlubmVySFRNTDtuLmlucHV0T3B0aW9uc1tlXT10fSkpLG59LHplPWZ1bmN0aW9uKHQsZSl7dmFyIG4sbz17fTtmb3IobiBpbiBlKXt2YXIgaT1lW25dLHI9dC5xdWVyeVNlbGVjdG9yKGkpO3ImJihLZShyLFtdKSxvW2kucmVwbGFjZSgvXnN3YWwtLywiIildPXIuaW5uZXJIVE1MLnRyaW0oKSl9cmV0dXJuIG99LFdlPWZ1bmN0aW9uKGUpe3ZhciBuPVZlLmNvbmNhdChbInN3YWwtcGFyYW0iLCJzd2FsLWJ1dHRvbiIsInN3YWwtaW1hZ2UiLCJzd2FsLWljb24iLCJzd2FsLWlucHV0Iiwic3dhbC1pbnB1dC1vcHRpb24iXSk7ZyhlLnF1ZXJ5U2VsZWN0b3JBbGwoIioiKSkuZm9yRWFjaChmdW5jdGlvbih0KXt0LnBhcmVudE5vZGU9PT1lJiYodD10LnRhZ05hbWUudG9Mb3dlckNhc2UoKSwtMT09PW4uaW5kZXhPZih0KSYmVygiVW5yZWNvZ25pemVkIGVsZW1lbnQgPCIuY29uY2F0KHQsIj4iKSkpfSl9LEtlPWZ1bmN0aW9uKGUsbil7ZyhlLmF0dHJpYnV0ZXMpLmZvckVhY2goZnVuY3Rpb24odCl7LTE9PT1uLmluZGV4T2YodC5uYW1lKSYmVyhbJ1VucmVjb2duaXplZCBhdHRyaWJ1dGUgIicuY29uY2F0KHQubmFtZSwnIiBvbiA8JykuY29uY2F0KGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpLCI+LiIpLCIiLmNvbmNhdChuLmxlbmd0aD8iQWxsb3dlZCBhdHRyaWJ1dGVzIGFyZTogIi5jb25jYXQobi5qb2luKCIsICIpKToiVG8gc2V0IHRoZSB2YWx1ZSwgdXNlIEhUTUwgd2l0aGluIHRoZSBlbGVtZW50LiIpXSl9KX0sWWU9ZnVuY3Rpb24odCxlKXsiZnVuY3Rpb24iPT10eXBlb2YgZS5kaWRPcGVuP3NldFRpbWVvdXQoZnVuY3Rpb24oKXtyZXR1cm4gZS5kaWRPcGVuKHQpfSk6ImZ1bmN0aW9uIj09dHlwZW9mIGUub25PcGVuJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cmV0dXJuIGUub25PcGVuKHQpfSl9LFplPWZ1bmN0aW9uKHQsZSl7QnQmJmx0KGUpPyh0LnN0eWxlLm92ZXJmbG93WT0iaGlkZGVuIixlLmFkZEV2ZW50TGlzdGVuZXIoQnQsTWUpKTp0LnN0eWxlLm92ZXJmbG93WT0iYXV0byJ9LFFlPWZ1bmN0aW9uKHQsZSxuKXt2YXIgbzsoL2lQYWR8aVBob25lfGlQb2QvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkmJiF3aW5kb3cuTVNTdHJlYW18fCJNYWNJbnRlbCI9PT1uYXZpZ2F0b3IucGxhdGZvcm0mJjE8bmF2aWdhdG9yLm1heFRvdWNoUG9pbnRzKSYmIUYoZG9jdW1lbnQuYm9keSwkLmlvc2ZpeCkmJihvPWRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wLGRvY3VtZW50LmJvZHkuc3R5bGUudG9wPSIiLmNvbmNhdCgtMSpvLCJweCIpLHZ0KGRvY3VtZW50LmJvZHksJC5pb3NmaXgpLHZlKCksZ2UoKSksInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJm1lKCkmJihoZSgpLHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJyZXNpemUiLGhlKSksZSYmImhpZGRlbiIhPT1uJiZmZSgpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0LnNjcm9sbFRvcD0wfSl9LEplPWZ1bmN0aW9uKHQsZSxuKXt2dCh0LG4uc2hvd0NsYXNzLmJhY2tkcm9wKSxlLnN0eWxlLnNldFByb3BlcnR5KCJvcGFjaXR5IiwiMCIsImltcG9ydGFudCIpLHJ0KGUpLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt2dChlLG4uc2hvd0NsYXNzLnBvcHVwKSxlLnN0eWxlLnJlbW92ZVByb3BlcnR5KCJvcGFjaXR5Iil9LDEwKSx2dChbZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LGRvY3VtZW50LmJvZHldLCQuc2hvd24pLG4uaGVpZ2h0QXV0byYmbi5iYWNrZHJvcCYmIW4udG9hc3QmJnZ0KFtkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZG9jdW1lbnQuYm9keV0sJFsiaGVpZ2h0LWF1dG8iXSl9LCRlPWZ1bmN0aW9uKHQpe3JldHVybiB0LmNoZWNrZWQ/MTowfSxYZT1mdW5jdGlvbih0KXtyZXR1cm4gdC5jaGVja2VkP3QudmFsdWU6bnVsbH0sR2U9ZnVuY3Rpb24odCl7cmV0dXJuIHQuZmlsZXMubGVuZ3RoP251bGwhPT10LmdldEF0dHJpYnV0ZSgibXVsdGlwbGUiKT90LmZpbGVzOnQuZmlsZXNbMF06bnVsbH0sdG49ZnVuY3Rpb24oZSxuKXtmdW5jdGlvbiBvKHQpe3JldHVybiBubltuLmlucHV0XShpLG9uKHQpLG4pfXZhciBpPVAoKTtiKG4uaW5wdXRPcHRpb25zKXx8dyhuLmlucHV0T3B0aW9ucyk/KEp0KFQoKSkseShuLmlucHV0T3B0aW9ucykudGhlbihmdW5jdGlvbih0KXtlLmhpZGVMb2FkaW5nKCksbyh0KX0pKToib2JqZWN0Ij09PXIobi5pbnB1dE9wdGlvbnMpP28obi5pbnB1dE9wdGlvbnMpOksoIlVuZXhwZWN0ZWQgdHlwZSBvZiBpbnB1dE9wdGlvbnMhIEV4cGVjdGVkIG9iamVjdCwgTWFwIG9yIFByb21pc2UsIGdvdCAiLmNvbmNhdChyKG4uaW5wdXRPcHRpb25zKSkpfSxlbj1mdW5jdGlvbihlLG4pe3ZhciBvPWUuZ2V0SW5wdXQoKTthdChvKSx5KG4uaW5wdXRWYWx1ZSkudGhlbihmdW5jdGlvbih0KXtvLnZhbHVlPSJudW1iZXIiPT09bi5pbnB1dD9wYXJzZUZsb2F0KHQpfHwwOiIiLmNvbmNhdCh0KSxydChvKSxvLmZvY3VzKCksZS5oaWRlTG9hZGluZygpfSkuY2F0Y2goZnVuY3Rpb24odCl7SygiRXJyb3IgaW4gaW5wdXRWYWx1ZSBwcm9taXNlOiAiLmNvbmNhdCh0KSksby52YWx1ZT0iIixydChvKSxvLmZvY3VzKCksZS5oaWRlTG9hZGluZygpfSl9LG5uPXtzZWxlY3Q6ZnVuY3Rpb24odCxlLGkpe2Z1bmN0aW9uIG8odCxlLG4pe3ZhciBvPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIm9wdGlvbiIpO28udmFsdWU9bixVKG8sZSksby5zZWxlY3RlZD1ybihuLGkuaW5wdXRWYWx1ZSksdC5hcHBlbmRDaGlsZChvKX12YXIgcj15dCh0LCQuc2VsZWN0KTtlLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGUsbj10WzBdLHQ9dFsxXTtBcnJheS5pc0FycmF5KHQpPygoZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJvcHRncm91cCIpKS5sYWJlbD1uLGUuZGlzYWJsZWQ9ITEsci5hcHBlbmRDaGlsZChlKSx0LmZvckVhY2goZnVuY3Rpb24odCl7cmV0dXJuIG8oZSx0WzFdLHRbMF0pfSkpOm8ocix0LG4pfSksci5mb2N1cygpfSxyYWRpbzpmdW5jdGlvbih0LGUsaSl7dmFyIHI9eXQodCwkLnJhZGlvKTtlLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGU9dFswXSxuPXRbMV0sbz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnB1dCIpLHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGFiZWwiKTtvLnR5cGU9InJhZGlvIixvLm5hbWU9JC5yYWRpbyxvLnZhbHVlPWUscm4oZSxpLmlucHV0VmFsdWUpJiYoby5jaGVja2VkPSEwKTtlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNwYW4iKTtVKGUsbiksZS5jbGFzc05hbWU9JC5sYWJlbCx0LmFwcGVuZENoaWxkKG8pLHQuYXBwZW5kQ2hpbGQoZSksci5hcHBlbmRDaGlsZCh0KX0pO2U9ci5xdWVyeVNlbGVjdG9yQWxsKCJpbnB1dCIpO2UubGVuZ3RoJiZlWzBdLmZvY3VzKCl9fSxvbj1mdW5jdGlvbiBuKG8pe3ZhciBpPVtdO3JldHVybiJ1bmRlZmluZWQiIT10eXBlb2YgTWFwJiZvIGluc3RhbmNlb2YgTWFwP28uZm9yRWFjaChmdW5jdGlvbih0LGUpeyJvYmplY3QiPT09cih0KSYmKHQ9bih0KSksaS5wdXNoKFtlLHRdKX0pOk9iamVjdC5rZXlzKG8pLmZvckVhY2goZnVuY3Rpb24odCl7dmFyIGU9b1t0XTsib2JqZWN0Ij09PXIoZSkmJihlPW4oZSkpLGkucHVzaChbdCxlXSl9KSxpfSxybj1mdW5jdGlvbih0LGUpe3JldHVybiBlJiZlLnRvU3RyaW5nKCk9PT10LnRvU3RyaW5nKCl9LGFuPWZ1bmN0aW9uKHQsZSxuKXt2YXIgbz1mdW5jdGlvbih0LGUpe3ZhciBuPXQuZ2V0SW5wdXQoKTtpZighbilyZXR1cm4gbnVsbDtzd2l0Y2goZS5pbnB1dCl7Y2FzZSJjaGVja2JveCI6cmV0dXJuICRlKG4pO2Nhc2UicmFkaW8iOnJldHVybiBYZShuKTtjYXNlImZpbGUiOnJldHVybiBHZShuKTtkZWZhdWx0OnJldHVybiBlLmlucHV0QXV0b1RyaW0/bi52YWx1ZS50cmltKCk6bi52YWx1ZX19KHQsZSk7ZS5pbnB1dFZhbGlkYXRvcj9zbih0LGUsbyk6dC5nZXRJbnB1dCgpLmNoZWNrVmFsaWRpdHkoKT8oImRlbnkiPT09bj91bjpjbikodCxlLG8pOih0LmVuYWJsZUJ1dHRvbnMoKSx0LnNob3dWYWxpZGF0aW9uTWVzc2FnZShlLnZhbGlkYXRpb25NZXNzYWdlKSl9LHNuPWZ1bmN0aW9uKGUsbixvKXtlLmRpc2FibGVJbnB1dCgpLFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4geShuLmlucHV0VmFsaWRhdG9yKG8sbi52YWxpZGF0aW9uTWVzc2FnZSkpfSkudGhlbihmdW5jdGlvbih0KXtlLmVuYWJsZUJ1dHRvbnMoKSxlLmVuYWJsZUlucHV0KCksdD9lLnNob3dWYWxpZGF0aW9uTWVzc2FnZSh0KTpjbihlLG4sbyl9KX0sdW49ZnVuY3Rpb24oZSx0LG4pe3Quc2hvd0xvYWRlck9uRGVueSYmSnQoTCgpKSx0LnByZURlbnk/UHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe3JldHVybiB5KHQucHJlRGVueShuLHQudmFsaWRhdGlvbk1lc3NhZ2UpKX0pLnRoZW4oZnVuY3Rpb24odCl7ITE9PT10P2UuaGlkZUxvYWRpbmcoKTplLmNsb3NlUG9wdXAoe2lzRGVuaWVkOiEwLHZhbHVlOnZvaWQgMD09PXQ/bjp0fSl9KTplLmNsb3NlUG9wdXAoe2lzRGVuaWVkOiEwLHZhbHVlOm59KX0sY249ZnVuY3Rpb24oZSx0LG4pe3Quc2hvd0xvYWRlck9uQ29uZmlybSYmSnQoKSx0LnByZUNvbmZpcm0/KGUucmVzZXRWYWxpZGF0aW9uTWVzc2FnZSgpLFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKXtyZXR1cm4geSh0LnByZUNvbmZpcm0obix0LnZhbGlkYXRpb25NZXNzYWdlKSl9KS50aGVuKGZ1bmN0aW9uKHQpe3d0KFMoKSl8fCExPT09dD9lLmhpZGVMb2FkaW5nKCk6SWUoZSx2b2lkIDA9PT10P246dCl9KSk6SWUoZSxuKX0sbG49WyJBcnJvd1JpZ2h0IiwiQXJyb3dEb3duIiwiUmlnaHQiLCJEb3duIl0sZG49WyJBcnJvd0xlZnQiLCJBcnJvd1VwIiwiTGVmdCIsIlVwIl0scG49WyJFc2NhcGUiLCJFc2MiXSxmbj1mdW5jdGlvbih0LGUsbil7dmFyIG89VHQuaW5uZXJQYXJhbXMuZ2V0KHQpO28mJihvLnN0b3BLZXlkb3duUHJvcGFnYXRpb24mJmUuc3RvcFByb3BhZ2F0aW9uKCksIkVudGVyIj09PWUua2V5P21uKHQsZSxvKToiVGFiIj09PWUua2V5P2huKGUsbyk6LTEhPT1bXS5jb25jYXQobG4sZG4pLmluZGV4T2YoZS5rZXkpP2duKGUua2V5KTotMSE9PXBuLmluZGV4T2YoZS5rZXkpJiZ2bihlLG8sbikpfSxtbj1mdW5jdGlvbih0LGUsbil7ZS5pc0NvbXBvc2luZ3x8ZS50YXJnZXQmJnQuZ2V0SW5wdXQoKSYmZS50YXJnZXQub3V0ZXJIVE1MPT09dC5nZXRJbnB1dCgpLm91dGVySFRNTCYmLTE9PT1bInRleHRhcmVhIiwiZmlsZSJdLmluZGV4T2Yobi5pbnB1dCkmJihGdCgpLGUucHJldmVudERlZmF1bHQoKSl9LGhuPWZ1bmN0aW9uKHQsZSl7Zm9yKHZhciBuPXQudGFyZ2V0LG89UigpLGk9LTEscj0wO3I8by5sZW5ndGg7cisrKWlmKG49PT1vW3JdKXtpPXI7YnJlYWt9dC5zaGlmdEtleT9IZSgwLGksLTEpOkhlKDAsaSwxKSx0LnN0b3BQcm9wYWdhdGlvbigpLHQucHJldmVudERlZmF1bHQoKX0sZ249ZnVuY3Rpb24odCl7LTEhPT1bVCgpLEwoKSxxKCldLmluZGV4T2YoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkmJih0PS0xIT09bG4uaW5kZXhPZih0KT8ibmV4dEVsZW1lbnRTaWJsaW5nIjoicHJldmlvdXNFbGVtZW50U2libGluZyIsKHQ9ZG9jdW1lbnQuYWN0aXZlRWxlbWVudFt0XSkmJnQuZm9jdXMoKSl9LHZuPWZ1bmN0aW9uKHQsZSxuKXtaKGUuYWxsb3dFc2NhcGVLZXkpJiYodC5wcmV2ZW50RGVmYXVsdCgpLG4oUS5lc2MpKX0sYm49ZnVuY3Rpb24oZSx0LG4pe3QucG9wdXAub25jbGljaz1mdW5jdGlvbigpe3ZhciB0PVR0LmlubmVyUGFyYW1zLmdldChlKTt0LnNob3dDb25maXJtQnV0dG9ufHx0LnNob3dEZW55QnV0dG9ufHx0LnNob3dDYW5jZWxCdXR0b258fHQuc2hvd0Nsb3NlQnV0dG9ufHx0LnRpbWVyfHx0LmlucHV0fHxuKFEuY2xvc2UpfX0seW49ITEsd249ZnVuY3Rpb24oZSl7ZS5wb3B1cC5vbm1vdXNlZG93bj1mdW5jdGlvbigpe2UuY29udGFpbmVyLm9ubW91c2V1cD1mdW5jdGlvbih0KXtlLmNvbnRhaW5lci5vbm1vdXNldXA9dm9pZCAwLHQudGFyZ2V0PT09ZS5jb250YWluZXImJih5bj0hMCl9fX0sQ249ZnVuY3Rpb24oZSl7ZS5jb250YWluZXIub25tb3VzZWRvd249ZnVuY3Rpb24oKXtlLnBvcHVwLm9ubW91c2V1cD1mdW5jdGlvbih0KXtlLnBvcHVwLm9ubW91c2V1cD12b2lkIDAsdC50YXJnZXQhPT1lLnBvcHVwJiYhZS5wb3B1cC5jb250YWlucyh0LnRhcmdldCl8fCh5bj0hMCl9fX0sa249ZnVuY3Rpb24obixvLGkpe28uY29udGFpbmVyLm9uY2xpY2s9ZnVuY3Rpb24odCl7dmFyIGU9VHQuaW5uZXJQYXJhbXMuZ2V0KG4pO3luP3luPSExOnQudGFyZ2V0PT09by5jb250YWluZXImJlooZS5hbGxvd091dHNpZGVDbGljaykmJmkoUS5iYWNrZHJvcCl9fTtmdW5jdGlvbiBBbih0LGUpe3ZhciBuPWZ1bmN0aW9uKHQpe3Q9InN0cmluZyI9PXR5cGVvZiB0LnRlbXBsYXRlP2RvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodC50ZW1wbGF0ZSk6dC50ZW1wbGF0ZTtpZighdClyZXR1cm57fTt0PXQuY29udGVudHx8dDtyZXR1cm4gV2UodCksdShSZSh0KSxOZSh0KSxVZSh0KSxGZSh0KSxfZSh0KSx6ZSh0LFZlKSl9KHQpO3JldHVybihuPXUoe30sc2UsZSxuLHQpKS5zaG93Q2xhc3M9dSh7fSxzZS5zaG93Q2xhc3Msbi5zaG93Q2xhc3MpLG4uaGlkZUNsYXNzPXUoe30sc2UuaGlkZUNsYXNzLG4uaGlkZUNsYXNzKSwhMT09PXQuYW5pbWF0aW9uJiYobi5zaG93Q2xhc3M9e3BvcHVwOiJzd2FsMi1ub2FuaW1hdGlvbiIsYmFja2Ryb3A6InN3YWwyLW5vYW5pbWF0aW9uIn0sbi5oaWRlQ2xhc3M9e30pLG59ZnVuY3Rpb24geG4oYSxzLHUpe3JldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbih0KXtmdW5jdGlvbiBlKHQpe2EuY2xvc2VQb3B1cCh7aXNEaXNtaXNzZWQ6ITAsZGlzbWlzczp0fSl9dmFyIG4sbyxpLHI7Q2Uuc3dhbFByb21pc2VSZXNvbHZlLnNldChhLHQpLHMuY29uZmlybUJ1dHRvbi5vbmNsaWNrPWZ1bmN0aW9uKCl7cmV0dXJuIGU9dSwodD1hKS5kaXNhYmxlQnV0dG9ucygpLHZvaWQoZS5pbnB1dD9hbih0LGUsImNvbmZpcm0iKTpjbih0LGUsITApKTt2YXIgdCxlfSxzLmRlbnlCdXR0b24ub25jbGljaz1mdW5jdGlvbigpe3JldHVybiBlPXUsKHQ9YSkuZGlzYWJsZUJ1dHRvbnMoKSx2b2lkKGUucmV0dXJuSW5wdXRWYWx1ZU9uRGVueT9hbih0LGUsImRlbnkiKTp1bih0LGUsITEpKTt2YXIgdCxlfSxzLmNhbmNlbEJ1dHRvbi5vbmNsaWNrPWZ1bmN0aW9uKCl7cmV0dXJuIHQ9ZSxhLmRpc2FibGVCdXR0b25zKCksdm9pZCB0KFEuY2FuY2VsKTt2YXIgdH0scy5jbG9zZUJ1dHRvbi5vbmNsaWNrPWZ1bmN0aW9uKCl7cmV0dXJuIGUoUS5jbG9zZSl9LG49YSxyPXMsdD1lLFR0LmlubmVyUGFyYW1zLmdldChuKS50b2FzdD9ibihuLHIsdCk6KHduKHIpLENuKHIpLGtuKG4scix0KSksbz1hLHI9dSxpPWUsKHQ9dGUpLmtleWRvd25UYXJnZXQmJnQua2V5ZG93bkhhbmRsZXJBZGRlZCYmKHQua2V5ZG93blRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCJrZXlkb3duIix0LmtleWRvd25IYW5kbGVyLHtjYXB0dXJlOnQua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZX0pLHQua2V5ZG93bkhhbmRsZXJBZGRlZD0hMSksci50b2FzdHx8KHQua2V5ZG93bkhhbmRsZXI9ZnVuY3Rpb24odCl7cmV0dXJuIGZuKG8sdCxpKX0sdC5rZXlkb3duVGFyZ2V0PXIua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZT93aW5kb3c6QSgpLHQua2V5ZG93bkxpc3RlbmVyQ2FwdHVyZT1yLmtleWRvd25MaXN0ZW5lckNhcHR1cmUsdC5rZXlkb3duVGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoImtleWRvd24iLHQua2V5ZG93bkhhbmRsZXIse2NhcHR1cmU6dC5rZXlkb3duTGlzdGVuZXJDYXB0dXJlfSksdC5rZXlkb3duSGFuZGxlckFkZGVkPSEwKSxyPWEsInNlbGVjdCI9PT0odD11KS5pbnB1dHx8InJhZGlvIj09PXQuaW5wdXQ/dG4ocix0KTotMSE9PVsidGV4dCIsImVtYWlsIiwibnVtYmVyIiwidGVsIiwidGV4dGFyZWEiXS5pbmRleE9mKHQuaW5wdXQpJiYoYih0LmlucHV0VmFsdWUpfHx3KHQuaW5wdXRWYWx1ZSkpJiZlbihyLHQpLGplKHUpLFBuKHRlLHUsZSksT24ocyx1KSxzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7cy5jb250YWluZXIuc2Nyb2xsVG9wPTB9KX0pfWZ1bmN0aW9uIEJuKHQpe3ZhciBlPXtwb3B1cDpBKCksY29udGFpbmVyOmsoKSxjb250ZW50OlAoKSxhY3Rpb25zOmooKSxjb25maXJtQnV0dG9uOlQoKSxkZW55QnV0dG9uOkwoKSxjYW5jZWxCdXR0b246cSgpLGxvYWRlcjpEKCksY2xvc2VCdXR0b246VigpLHZhbGlkYXRpb25NZXNzYWdlOlMoKSxwcm9ncmVzc1N0ZXBzOm4oKX07cmV0dXJuIFR0LmRvbUNhY2hlLnNldCh0LGUpLGV9dmFyIFBuPWZ1bmN0aW9uKHQsZSxuKXt2YXIgbz1IKCk7YXQobyksZS50aW1lciYmKHQudGltZW91dD1uZXcgTGUoZnVuY3Rpb24oKXtuKCJ0aW1lciIpLGRlbGV0ZSB0LnRpbWVvdXR9LGUudGltZXIpLGUudGltZXJQcm9ncmVzc0JhciYmKHJ0KG8pLHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0LnRpbWVvdXQmJnQudGltZW91dC5ydW5uaW5nJiZkdChlLnRpbWVyKX0pKSl9LE9uPWZ1bmN0aW9uKHQsZSl7aWYoIWUudG9hc3QpcmV0dXJuIFooZS5hbGxvd0VudGVyS2V5KT92b2lkKEVuKHQsZSl8fEhlKDAsLTEsMSkpOlNuKCl9LEVuPWZ1bmN0aW9uKHQsZSl7cmV0dXJuIGUuZm9jdXNEZW55JiZ3dCh0LmRlbnlCdXR0b24pPyh0LmRlbnlCdXR0b24uZm9jdXMoKSwhMCk6ZS5mb2N1c0NhbmNlbCYmd3QodC5jYW5jZWxCdXR0b24pPyh0LmNhbmNlbEJ1dHRvbi5mb2N1cygpLCEwKTohKCFlLmZvY3VzQ29uZmlybXx8IXd0KHQuY29uZmlybUJ1dHRvbikpJiYodC5jb25maXJtQnV0dG9uLmZvY3VzKCksITApfSxTbj1mdW5jdGlvbigpe2RvY3VtZW50LmFjdGl2ZUVsZW1lbnQmJiJmdW5jdGlvbiI9PXR5cGVvZiBkb2N1bWVudC5hY3RpdmVFbGVtZW50LmJsdXImJmRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuYmx1cigpfTtmdW5jdGlvbiBUbih0KXsiZnVuY3Rpb24iPT10eXBlb2YgdC5kaWREZXN0cm95P3QuZGlkRGVzdHJveSgpOiJmdW5jdGlvbiI9PXR5cGVvZiB0Lm9uRGVzdHJveSYmdC5vbkRlc3Ryb3koKX1mdW5jdGlvbiBMbih0KXtkZWxldGUgdC5wYXJhbXMsZGVsZXRlIHRlLmtleWRvd25IYW5kbGVyLGRlbGV0ZSB0ZS5rZXlkb3duVGFyZ2V0LHFuKFR0KSxxbihDZSl9dmFyIERuLHFuPWZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXRbZV09bmV3IFdlYWtNYXB9LEo9T2JqZWN0LmZyZWV6ZSh7aGlkZUxvYWRpbmc6cGUsZGlzYWJsZUxvYWRpbmc6cGUsZ2V0SW5wdXQ6ZnVuY3Rpb24odCl7dmFyIGU9VHQuaW5uZXJQYXJhbXMuZ2V0KHR8fHRoaXMpO3JldHVybih0PVR0LmRvbUNhY2hlLmdldCh0fHx0aGlzKSk/ZXQodC5jb250ZW50LGUuaW5wdXQpOm51bGx9LGNsb3NlOkFlLGNsb3NlUG9wdXA6QWUsY2xvc2VNb2RhbDpBZSxjbG9zZVRvYXN0OkFlLGVuYWJsZUJ1dHRvbnM6ZnVuY3Rpb24oKXtTZSh0aGlzLFsiY29uZmlybUJ1dHRvbiIsImRlbnlCdXR0b24iLCJjYW5jZWxCdXR0b24iXSwhMSl9LGRpc2FibGVCdXR0b25zOmZ1bmN0aW9uKCl7U2UodGhpcyxbImNvbmZpcm1CdXR0b24iLCJkZW55QnV0dG9uIiwiY2FuY2VsQnV0dG9uIl0sITApfSxlbmFibGVJbnB1dDpmdW5jdGlvbigpe3JldHVybiBUZSh0aGlzLmdldElucHV0KCksITEpfSxkaXNhYmxlSW5wdXQ6ZnVuY3Rpb24oKXtyZXR1cm4gVGUodGhpcy5nZXRJbnB1dCgpLCEwKX0sc2hvd1ZhbGlkYXRpb25NZXNzYWdlOmZ1bmN0aW9uKHQpe3ZhciBlPVR0LmRvbUNhY2hlLmdldCh0aGlzKSxuPVR0LmlubmVyUGFyYW1zLmdldCh0aGlzKTtVKGUudmFsaWRhdGlvbk1lc3NhZ2UsdCksZS52YWxpZGF0aW9uTWVzc2FnZS5jbGFzc05hbWU9JFsidmFsaWRhdGlvbi1tZXNzYWdlIl0sbi5jdXN0b21DbGFzcyYmbi5jdXN0b21DbGFzcy52YWxpZGF0aW9uTWVzc2FnZSYmdnQoZS52YWxpZGF0aW9uTWVzc2FnZSxuLmN1c3RvbUNsYXNzLnZhbGlkYXRpb25NZXNzYWdlKSxydChlLnZhbGlkYXRpb25NZXNzYWdlKSwoZT10aGlzLmdldElucHV0KCkpJiYoZS5zZXRBdHRyaWJ1dGUoImFyaWEtaW52YWxpZCIsITApLGUuc2V0QXR0cmlidXRlKCJhcmlhLWRlc2NyaWJlZEJ5IiwkWyJ2YWxpZGF0aW9uLW1lc3NhZ2UiXSksbnQoZSksdnQoZSwkLmlucHV0ZXJyb3IpKX0scmVzZXRWYWxpZGF0aW9uTWVzc2FnZTpmdW5jdGlvbigpe3ZhciB0PVR0LmRvbUNhY2hlLmdldCh0aGlzKTt0LnZhbGlkYXRpb25NZXNzYWdlJiZhdCh0LnZhbGlkYXRpb25NZXNzYWdlKSwodD10aGlzLmdldElucHV0KCkpJiYodC5yZW1vdmVBdHRyaWJ1dGUoImFyaWEtaW52YWxpZCIpLHQucmVtb3ZlQXR0cmlidXRlKCJhcmlhLWRlc2NyaWJlZEJ5IiksYnQodCwkLmlucHV0ZXJyb3IpKX0sZ2V0UHJvZ3Jlc3NTdGVwczpmdW5jdGlvbigpe3JldHVybiBUdC5kb21DYWNoZS5nZXQodGhpcykucHJvZ3Jlc3NTdGVwc30sX21haW46ZnVuY3Rpb24odCl7dmFyIGU9MTxhcmd1bWVudHMubGVuZ3RoJiZ2b2lkIDAhPT1hcmd1bWVudHNbMV0/YXJndW1lbnRzWzFdOnt9O3JldHVybiBhZSh1KHt9LGUsdCkpLHRlLmN1cnJlbnRJbnN0YW5jZSYmdGUuY3VycmVudEluc3RhbmNlLl9kZXN0cm95KCksdGUuY3VycmVudEluc3RhbmNlPXRoaXMscWUodD1Bbih0LGUpKSxPYmplY3QuZnJlZXplKHQpLHRlLnRpbWVvdXQmJih0ZS50aW1lb3V0LnN0b3AoKSxkZWxldGUgdGUudGltZW91dCksY2xlYXJUaW1lb3V0KHRlLnJlc3RvcmVGb2N1c1RpbWVvdXQpLGU9Qm4odGhpcyksVXQodGhpcyx0KSxUdC5pbm5lclBhcmFtcy5zZXQodGhpcyx0KSx4bih0aGlzLGUsdCl9LHVwZGF0ZTpmdW5jdGlvbihlKXt2YXIgdD1BKCksbj1UdC5pbm5lclBhcmFtcy5nZXQodGhpcyk7aWYoIXR8fEYodCxuLmhpZGVDbGFzcy5wb3B1cCkpcmV0dXJuIFcoIllvdSdyZSB0cnlpbmcgdG8gdXBkYXRlIHRoZSBjbG9zZWQgb3IgY2xvc2luZyBwb3B1cCwgdGhhdCB3b24ndCB3b3JrLiBVc2UgdGhlIHVwZGF0ZSgpIG1ldGhvZCBpbiBwcmVDb25maXJtIHBhcmFtZXRlciBvciBzaG93IGEgbmV3IHBvcHVwLiIpO3ZhciBvPXt9O09iamVjdC5rZXlzKGUpLmZvckVhY2goZnVuY3Rpb24odCl7TW4uaXNVcGRhdGFibGVQYXJhbWV0ZXIodCk/b1t0XT1lW3RdOlcoJ0ludmFsaWQgcGFyYW1ldGVyIHRvIHVwZGF0ZTogIicuY29uY2F0KHQsJyIuIFVwZGF0YWJsZSBwYXJhbXMgYXJlIGxpc3RlZCBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vc3dlZXRhbGVydDIvc3dlZXRhbGVydDIvYmxvYi9tYXN0ZXIvc3JjL3V0aWxzL3BhcmFtcy5qc1xuXG5JZiB5b3UgdGhpbmsgdGhpcyBwYXJhbWV0ZXIgc2hvdWxkIGJlIHVwZGF0YWJsZSwgcmVxdWVzdCBpdCBoZXJlOiBodHRwczovL2dpdGh1Yi5jb20vc3dlZXRhbGVydDIvc3dlZXRhbGVydDIvaXNzdWVzL25ldz90ZW1wbGF0ZT0wMl9mZWF0dXJlX3JlcXVlc3QubWQnKSl9KSxuPXUoe30sbixvKSxVdCh0aGlzLG4pLFR0LmlubmVyUGFyYW1zLnNldCh0aGlzLG4pLE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRoaXMse3BhcmFtczp7dmFsdWU6dSh7fSx0aGlzLnBhcmFtcyxlKSx3cml0YWJsZTohMSxlbnVtZXJhYmxlOiEwfX0pfSxfZGVzdHJveTpmdW5jdGlvbigpe3ZhciB0PVR0LmRvbUNhY2hlLmdldCh0aGlzKSxlPVR0LmlubmVyUGFyYW1zLmdldCh0aGlzKTtlJiYodC5wb3B1cCYmdGUuc3dhbENsb3NlRXZlbnRGaW5pc2hlZENhbGxiYWNrJiYodGUuc3dhbENsb3NlRXZlbnRGaW5pc2hlZENhbGxiYWNrKCksZGVsZXRlIHRlLnN3YWxDbG9zZUV2ZW50RmluaXNoZWRDYWxsYmFjayksdGUuZGVmZXJEaXNwb3NhbFRpbWVyJiYoY2xlYXJUaW1lb3V0KHRlLmRlZmVyRGlzcG9zYWxUaW1lciksZGVsZXRlIHRlLmRlZmVyRGlzcG9zYWxUaW1lciksVG4oZSksTG4odGhpcykpfX0pLGpuPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gaSgpe2lmKGEodGhpcyxpKSwidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyl7InVuZGVmaW5lZCI9PXR5cGVvZiBQcm9taXNlJiZLKCJUaGlzIHBhY2thZ2UgcmVxdWlyZXMgYSBQcm9taXNlIGxpYnJhcnksIHBsZWFzZSBpbmNsdWRlIGEgc2hpbSB0byBlbmFibGUgaXQgaW4gdGhpcyBicm93c2VyIChTZWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9zd2VldGFsZXJ0Mi9zd2VldGFsZXJ0Mi93aWtpL01pZ3JhdGlvbi1mcm9tLVN3ZWV0QWxlcnQtdG8tU3dlZXRBbGVydDIjMS1pZS1zdXBwb3J0KSIpLERuPXRoaXM7Zm9yKHZhciB0PWFyZ3VtZW50cy5sZW5ndGgsZT1uZXcgQXJyYXkodCksbj0wO248dDtuKyspZVtuXT1hcmd1bWVudHNbbl07dmFyIG89T2JqZWN0LmZyZWV6ZSh0aGlzLmNvbnN0cnVjdG9yLmFyZ3NUb1BhcmFtcyhlKSk7T2JqZWN0LmRlZmluZVByb3BlcnRpZXModGhpcyx7cGFyYW1zOnt2YWx1ZTpvLHdyaXRhYmxlOiExLGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfX0pO289dGhpcy5fbWFpbih0aGlzLnBhcmFtcyk7VHQucHJvbWlzZS5zZXQodGhpcyxvKX19cmV0dXJuIHMoaSxbe2tleToidGhlbiIsdmFsdWU6ZnVuY3Rpb24odCl7cmV0dXJuIFR0LnByb21pc2UuZ2V0KHRoaXMpLnRoZW4odCl9fSx7a2V5OiJmaW5hbGx5Iix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gVHQucHJvbWlzZS5nZXQodGhpcykuZmluYWxseSh0KX19XSksaX0oKTt1KGpuLnByb3RvdHlwZSxKKSx1KGpuLGRlKSxPYmplY3Qua2V5cyhKKS5mb3JFYWNoKGZ1bmN0aW9uKHQpe2puW3RdPWZ1bmN0aW9uKCl7aWYoRG4pcmV0dXJuIERuW3RdLmFwcGx5KERuLGFyZ3VtZW50cyl9fSksam4uRGlzbWlzc1JlYXNvbj1RLGpuLnZlcnNpb249IjEwLjE2LjYiO3ZhciBNbj1qbjtyZXR1cm4gTW4uZGVmYXVsdD1Nbn0pLHZvaWQgMCE9PXRoaXMmJnRoaXMuU3dlZXRhbGVydDImJih0aGlzLnN3YWw9dGhpcy5zd2VldEFsZXJ0PXRoaXMuU3dhbD10aGlzLlN3ZWV0QWxlcnQ9dGhpcy5Td2VldGFsZXJ0Mik7CiJ1bmRlZmluZWQiIT10eXBlb2YgZG9jdW1lbnQmJmZ1bmN0aW9uKGUsdCl7dmFyIG49ZS5jcmVhdGVFbGVtZW50KCJzdHlsZSIpO2lmKGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXS5hcHBlbmRDaGlsZChuKSxuLnN0eWxlU2hlZXQpbi5zdHlsZVNoZWV0LmRpc2FibGVkfHwobi5zdHlsZVNoZWV0LmNzc1RleHQ9dCk7ZWxzZSB0cnl7bi5pbm5lckhUTUw9dH1jYXRjaChlKXtuLmlubmVyVGV4dD10fX0oZG9jdW1lbnQsIi5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdHtmbGV4LWRpcmVjdGlvbjpjb2x1bW47YWxpZ24taXRlbXM6c3RyZXRjaDt3aWR0aDphdXRvO3BhZGRpbmc6MS4yNWVtO292ZXJmbG93LXk6aGlkZGVuO2JhY2tncm91bmQ6I2ZmZjtib3gtc2hhZG93OjAgMCAuNjI1ZW0gI2Q5ZDlkOX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWhlYWRlcntmbGV4LWRpcmVjdGlvbjpyb3c7cGFkZGluZzowfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItdGl0bGV7ZmxleC1ncm93OjE7anVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnQ7bWFyZ2luOjAgLjYyNWVtO2ZvbnQtc2l6ZToxZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1sb2FkaW5ne2p1c3RpZnktY29udGVudDpjZW50ZXJ9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1pbnB1dHtoZWlnaHQ6MmVtO21hcmdpbjouMzEyNWVtIGF1dG87Zm9udC1zaXplOjFlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLXZhbGlkYXRpb24tbWVzc2FnZXtmb250LXNpemU6MWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItZm9vdGVye21hcmdpbjouNWVtIDAgMDtwYWRkaW5nOi41ZW0gMCAwO2ZvbnQtc2l6ZTouOGVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItY2xvc2V7cG9zaXRpb246c3RhdGljO3dpZHRoOi44ZW07aGVpZ2h0Oi44ZW07bGluZS1oZWlnaHQ6Ljh9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1jb250ZW50e2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0O21hcmdpbjowIC42MjVlbTtwYWRkaW5nOjA7Zm9udC1zaXplOjFlbTt0ZXh0LWFsaWduOmluaXRpYWx9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1odG1sLWNvbnRhaW5lcntwYWRkaW5nOi42MjVlbSAwIDB9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1odG1sLWNvbnRhaW5lcjplbXB0eXtwYWRkaW5nOjB9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1pY29ue3dpZHRoOjJlbTttaW4td2lkdGg6MmVtO2hlaWdodDoyZW07bWFyZ2luOjAgLjVlbSAwIDB9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1pY29uIC5zd2FsMi1pY29uLWNvbnRlbnR7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtmb250LXNpemU6MS44ZW07Zm9udC13ZWlnaHQ6NzAwfUBtZWRpYSBhbGwgYW5kICgtbXMtaGlnaC1jb250cmFzdDpub25lKSwoLW1zLWhpZ2gtY29udHJhc3Q6YWN0aXZlKXsuc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWljb24gLnN3YWwyLWljb24tY29udGVudHtmb250LXNpemU6LjI1ZW19fS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzIC5zd2FsMi1zdWNjZXNzLXJpbmd7d2lkdGg6MmVtO2hlaWdodDoyZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1pY29uLnN3YWwyLWVycm9yIFtjbGFzc149c3dhbDIteC1tYXJrLWxpbmVde3RvcDouODc1ZW07d2lkdGg6MS4zNzVlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWljb24uc3dhbDItZXJyb3IgW2NsYXNzXj1zd2FsMi14LW1hcmstbGluZV1bY2xhc3MkPWxlZnRde2xlZnQ6LjMxMjVlbX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLWljb24uc3dhbDItZXJyb3IgW2NsYXNzXj1zd2FsMi14LW1hcmstbGluZV1bY2xhc3MkPXJpZ2h0XXtyaWdodDouMzEyNWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItYWN0aW9uc3tmbGV4OjE7ZmxleC1iYXNpczphdXRvIWltcG9ydGFudDthbGlnbi1zZWxmOnN0cmV0Y2g7d2lkdGg6YXV0bztoZWlnaHQ6Mi4yZW07aGVpZ2h0OmF1dG87bWFyZ2luOjAgLjMxMjVlbTttYXJnaW4tdG9wOi4zMTI1ZW07cGFkZGluZzowfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3R5bGVke21hcmdpbjouMTI1ZW0gLjMxMjVlbTtwYWRkaW5nOi4zMTI1ZW0gLjYyNWVtO2ZvbnQtc2l6ZToxZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdHlsZWQ6Zm9jdXN7Ym94LXNoYWRvdzowIDAgMCAxcHggI2ZmZiwwIDAgMCAzcHggcmdiYSgxMDAsMTUwLDIwMCwuNSl9LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdWNjZXNze2JvcmRlci1jb2xvcjojYTVkYzg2fS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtY2lyY3VsYXItbGluZV17cG9zaXRpb246YWJzb2x1dGU7d2lkdGg6MS42ZW07aGVpZ2h0OjNlbTt0cmFuc2Zvcm06cm90YXRlKDQ1ZGVnKTtib3JkZXItcmFkaXVzOjUwJX0uc3dhbDItcG9wdXAuc3dhbDItdG9hc3QgLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmVdW2NsYXNzJD1sZWZ0XXt0b3A6LS44ZW07bGVmdDotLjVlbTt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyk7dHJhbnNmb3JtLW9yaWdpbjoyZW0gMmVtO2JvcmRlci1yYWRpdXM6NGVtIDAgMCA0ZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXVtjbGFzcyQ9cmlnaHRde3RvcDotLjI1ZW07bGVmdDouOTM3NWVtO3RyYW5zZm9ybS1vcmlnaW46MCAxLjVlbTtib3JkZXItcmFkaXVzOjAgNGVtIDRlbSAwfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyAuc3dhbDItc3VjY2Vzcy1yaW5ne3dpZHRoOjJlbTtoZWlnaHQ6MmVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyAuc3dhbDItc3VjY2Vzcy1maXh7dG9wOjA7bGVmdDouNDM3NWVtO3dpZHRoOi40Mzc1ZW07aGVpZ2h0OjIuNjg3NWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtbGluZV17aGVpZ2h0Oi4zMTI1ZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1saW5lXVtjbGFzcyQ9dGlwXXt0b3A6MS4xMjVlbTtsZWZ0Oi4xODc1ZW07d2lkdGg6Ljc1ZW19LnN3YWwyLXBvcHVwLnN3YWwyLXRvYXN0IC5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1saW5lXVtjbGFzcyQ9bG9uZ117dG9wOi45Mzc1ZW07cmlnaHQ6LjE4NzVlbTt3aWR0aDoxLjM3NWVtfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2Vzcy5zd2FsMi1pY29uLXNob3cgLnN3YWwyLXN1Y2Nlc3MtbGluZS10aXB7LXdlYmtpdC1hbmltYXRpb246c3dhbDItdG9hc3QtYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwIC43NXM7YW5pbWF0aW9uOnN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLXRpcCAuNzVzfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdCAuc3dhbDItc3VjY2Vzcy5zd2FsMi1pY29uLXNob3cgLnN3YWwyLXN1Y2Nlc3MtbGluZS1sb25ney13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmcgLjc1czthbmltYXRpb246c3dhbDItdG9hc3QtYW5pbWF0ZS1zdWNjZXNzLWxpbmUtbG9uZyAuNzVzfS5zd2FsMi1wb3B1cC5zd2FsMi10b2FzdC5zd2FsMi1zaG93ey13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLXRvYXN0LXNob3cgLjVzO2FuaW1hdGlvbjpzd2FsMi10b2FzdC1zaG93IC41c30uc3dhbDItcG9wdXAuc3dhbDItdG9hc3Quc3dhbDItaGlkZXstd2Via2l0LWFuaW1hdGlvbjpzd2FsMi10b2FzdC1oaWRlIC4xcyBmb3J3YXJkczthbmltYXRpb246c3dhbDItdG9hc3QtaGlkZSAuMXMgZm9yd2FyZHN9LnN3YWwyLWNvbnRhaW5lcntkaXNwbGF5OmZsZXg7cG9zaXRpb246Zml4ZWQ7ei1pbmRleDoxMDYwO3RvcDowO3JpZ2h0OjA7Ym90dG9tOjA7bGVmdDowO2ZsZXgtZGlyZWN0aW9uOnJvdzthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtwYWRkaW5nOi42MjVlbTtvdmVyZmxvdy14OmhpZGRlbjt0cmFuc2l0aW9uOmJhY2tncm91bmQtY29sb3IgLjFzOy13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOnRvdWNofS5zd2FsMi1jb250YWluZXIuc3dhbDItYmFja2Ryb3Atc2hvdywuc3dhbDItY29udGFpbmVyLnN3YWwyLW5vYW5pbWF0aW9ue2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuNCl9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1iYWNrZHJvcC1oaWRle2JhY2tncm91bmQ6MCAwIWltcG9ydGFudH0uc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcHthbGlnbi1pdGVtczpmbGV4LXN0YXJ0fS5zd2FsMi1jb250YWluZXIuc3dhbDItdG9wLWxlZnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3Atc3RhcnR7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1zdGFydH0uc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1lbmQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3AtcmlnaHR7YWxpZ24taXRlbXM6ZmxleC1zdGFydDtqdXN0aWZ5LWNvbnRlbnQ6ZmxleC1lbmR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXJ7YWxpZ24taXRlbXM6Y2VudGVyfS5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLWxlZnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItc3RhcnR7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpmbGV4LXN0YXJ0fS5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLWVuZCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWNlbnRlci1yaWdodHthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmZsZXgtZW5kfS5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9te2FsaWduLWl0ZW1zOmZsZXgtZW5kfS5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLWxlZnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tc3RhcnR7YWxpZ24taXRlbXM6ZmxleC1lbmQ7anVzdGlmeS1jb250ZW50OmZsZXgtc3RhcnR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tZW5kLC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLXJpZ2h0e2FsaWduLWl0ZW1zOmZsZXgtZW5kO2p1c3RpZnktY29udGVudDpmbGV4LWVuZH0uc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1lbmQ+OmZpcnN0LWNoaWxkLC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLWxlZnQ+OmZpcnN0LWNoaWxkLC5zd2FsMi1jb250YWluZXIuc3dhbDItYm90dG9tLXJpZ2h0PjpmaXJzdC1jaGlsZCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1zdGFydD46Zmlyc3QtY2hpbGQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20+OmZpcnN0LWNoaWxke21hcmdpbi10b3A6YXV0b30uc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctZnVsbHNjcmVlbj4uc3dhbDItbW9kYWx7ZGlzcGxheTpmbGV4IWltcG9ydGFudDtmbGV4OjE7YWxpZ24tc2VsZjpzdHJldGNoO2p1c3RpZnktY29udGVudDpjZW50ZXJ9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LXJvdz4uc3dhbDItbW9kYWx7ZGlzcGxheTpmbGV4IWltcG9ydGFudDtmbGV4OjE7YWxpZ24tY29udGVudDpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1ue2ZsZXg6MTtmbGV4LWRpcmVjdGlvbjpjb2x1bW59LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1ib3R0b20sLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1jZW50ZXIsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi10b3B7YWxpZ24taXRlbXM6Y2VudGVyfS5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItYm90dG9tLWxlZnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1ib3R0b20tc3RhcnQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1jZW50ZXItbGVmdCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLWNlbnRlci1zdGFydCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLXRvcC1sZWZ0LC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItdG9wLXN0YXJ0e2FsaWduLWl0ZW1zOmZsZXgtc3RhcnR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi1ib3R0b20tZW5kLC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItYm90dG9tLXJpZ2h0LC5zd2FsMi1jb250YWluZXIuc3dhbDItZ3Jvdy1jb2x1bW4uc3dhbDItY2VudGVyLWVuZCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLWNlbnRlci1yaWdodCwuc3dhbDItY29udGFpbmVyLnN3YWwyLWdyb3ctY29sdW1uLnN3YWwyLXRvcC1lbmQsLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbi5zd2FsMi10b3AtcmlnaHR7YWxpZ24taXRlbXM6ZmxleC1lbmR9LnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ncm93LWNvbHVtbj4uc3dhbDItbW9kYWx7ZGlzcGxheTpmbGV4IWltcG9ydGFudDtmbGV4OjE7YWxpZ24tY29udGVudDpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0uc3dhbDItY29udGFpbmVyLnN3YWwyLW5vLXRyYW5zaXRpb257dHJhbnNpdGlvbjpub25lIWltcG9ydGFudH0uc3dhbDItY29udGFpbmVyOm5vdCguc3dhbDItdG9wKTpub3QoLnN3YWwyLXRvcC1zdGFydCk6bm90KC5zd2FsMi10b3AtZW5kKTpub3QoLnN3YWwyLXRvcC1sZWZ0KTpub3QoLnN3YWwyLXRvcC1yaWdodCk6bm90KC5zd2FsMi1jZW50ZXItc3RhcnQpOm5vdCguc3dhbDItY2VudGVyLWVuZCk6bm90KC5zd2FsMi1jZW50ZXItbGVmdCk6bm90KC5zd2FsMi1jZW50ZXItcmlnaHQpOm5vdCguc3dhbDItYm90dG9tKTpub3QoLnN3YWwyLWJvdHRvbS1zdGFydCk6bm90KC5zd2FsMi1ib3R0b20tZW5kKTpub3QoLnN3YWwyLWJvdHRvbS1sZWZ0KTpub3QoLnN3YWwyLWJvdHRvbS1yaWdodCk6bm90KC5zd2FsMi1ncm93LWZ1bGxzY3JlZW4pPi5zd2FsMi1tb2RhbHttYXJnaW46YXV0b31AbWVkaWEgYWxsIGFuZCAoLW1zLWhpZ2gtY29udHJhc3Q6bm9uZSksKC1tcy1oaWdoLWNvbnRyYXN0OmFjdGl2ZSl7LnN3YWwyLWNvbnRhaW5lciAuc3dhbDItbW9kYWx7bWFyZ2luOjAhaW1wb3J0YW50fX0uc3dhbDItcG9wdXB7ZGlzcGxheTpub25lO3Bvc2l0aW9uOnJlbGF0aXZlO2JveC1zaXppbmc6Ym9yZGVyLWJveDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47anVzdGlmeS1jb250ZW50OmNlbnRlcjt3aWR0aDozMmVtO21heC13aWR0aDoxMDAlO3BhZGRpbmc6MS4yNWVtO2JvcmRlcjpub25lO2JvcmRlci1yYWRpdXM6NXB4O2JhY2tncm91bmQ6I2ZmZjtmb250LWZhbWlseTppbmhlcml0O2ZvbnQtc2l6ZToxcmVtfS5zd2FsMi1wb3B1cDpmb2N1c3tvdXRsaW5lOjB9LnN3YWwyLXBvcHVwLnN3YWwyLWxvYWRpbmd7b3ZlcmZsb3cteTpoaWRkZW59LnN3YWwyLWhlYWRlcntkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2FsaWduLWl0ZW1zOmNlbnRlcjtwYWRkaW5nOjAgMS44ZW19LnN3YWwyLXRpdGxle3Bvc2l0aW9uOnJlbGF0aXZlO21heC13aWR0aDoxMDAlO21hcmdpbjowIDAgLjRlbTtwYWRkaW5nOjA7Y29sb3I6IzU5NTk1OTtmb250LXNpemU6MS44NzVlbTtmb250LXdlaWdodDo2MDA7dGV4dC1hbGlnbjpjZW50ZXI7dGV4dC10cmFuc2Zvcm06bm9uZTt3b3JkLXdyYXA6YnJlYWstd29yZH0uc3dhbDItYWN0aW9uc3tkaXNwbGF5OmZsZXg7ei1pbmRleDoxO2JveC1zaXppbmc6Ym9yZGVyLWJveDtmbGV4LXdyYXA6d3JhcDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt3aWR0aDoxMDAlO21hcmdpbjoxLjI1ZW0gYXV0byAwO3BhZGRpbmc6MH0uc3dhbDItYWN0aW9uczpub3QoLnN3YWwyLWxvYWRpbmcpIC5zd2FsMi1zdHlsZWRbZGlzYWJsZWRde29wYWNpdHk6LjR9LnN3YWwyLWFjdGlvbnM6bm90KC5zd2FsMi1sb2FkaW5nKSAuc3dhbDItc3R5bGVkOmhvdmVye2JhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KHJnYmEoMCwwLDAsLjEpLHJnYmEoMCwwLDAsLjEpKX0uc3dhbDItYWN0aW9uczpub3QoLnN3YWwyLWxvYWRpbmcpIC5zd2FsMi1zdHlsZWQ6YWN0aXZle2JhY2tncm91bmQtaW1hZ2U6bGluZWFyLWdyYWRpZW50KHJnYmEoMCwwLDAsLjIpLHJnYmEoMCwwLDAsLjIpKX0uc3dhbDItbG9hZGVye2Rpc3BsYXk6bm9uZTthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjt3aWR0aDoyLjJlbTtoZWlnaHQ6Mi4yZW07bWFyZ2luOjAgMS44NzVlbTstd2Via2l0LWFuaW1hdGlvbjpzd2FsMi1yb3RhdGUtbG9hZGluZyAxLjVzIGxpbmVhciAwcyBpbmZpbml0ZSBub3JtYWw7YW5pbWF0aW9uOnN3YWwyLXJvdGF0ZS1sb2FkaW5nIDEuNXMgbGluZWFyIDBzIGluZmluaXRlIG5vcm1hbDtib3JkZXItd2lkdGg6LjI1ZW07Ym9yZGVyLXN0eWxlOnNvbGlkO2JvcmRlci1yYWRpdXM6MTAwJTtib3JkZXItY29sb3I6IzI3NzhjNCB0cmFuc3BhcmVudCAjMjc3OGM0IHRyYW5zcGFyZW50fS5zd2FsMi1zdHlsZWR7bWFyZ2luOi4zMTI1ZW07cGFkZGluZzouNjI1ZW0gMS4xZW07Ym94LXNoYWRvdzpub25lO2ZvbnQtd2VpZ2h0OjUwMH0uc3dhbDItc3R5bGVkOm5vdChbZGlzYWJsZWRdKXtjdXJzb3I6cG9pbnRlcn0uc3dhbDItc3R5bGVkLnN3YWwyLWNvbmZpcm17Ym9yZGVyOjA7Ym9yZGVyLXJhZGl1czouMjVlbTtiYWNrZ3JvdW5kOmluaXRpYWw7YmFja2dyb3VuZC1jb2xvcjojMjc3OGM0O2NvbG9yOiNmZmY7Zm9udC1zaXplOjFlbX0uc3dhbDItc3R5bGVkLnN3YWwyLWRlbnl7Ym9yZGVyOjA7Ym9yZGVyLXJhZGl1czouMjVlbTtiYWNrZ3JvdW5kOmluaXRpYWw7YmFja2dyb3VuZC1jb2xvcjojZDE0NTI5O2NvbG9yOiNmZmY7Zm9udC1zaXplOjFlbX0uc3dhbDItc3R5bGVkLnN3YWwyLWNhbmNlbHtib3JkZXI6MDtib3JkZXItcmFkaXVzOi4yNWVtO2JhY2tncm91bmQ6aW5pdGlhbDtiYWNrZ3JvdW5kLWNvbG9yOiM3NTc1NzU7Y29sb3I6I2ZmZjtmb250LXNpemU6MWVtfS5zd2FsMi1zdHlsZWQ6Zm9jdXN7b3V0bGluZTowO2JveC1zaGFkb3c6MCAwIDAgM3B4IHJnYmEoMTAwLDE1MCwyMDAsLjUpfS5zd2FsMi1zdHlsZWQ6Oi1tb3otZm9jdXMtaW5uZXJ7Ym9yZGVyOjB9LnN3YWwyLWZvb3RlcntqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO21hcmdpbjoxLjI1ZW0gMCAwO3BhZGRpbmc6MWVtIDAgMDtib3JkZXItdG9wOjFweCBzb2xpZCAjZWVlO2NvbG9yOiM1NDU0NTQ7Zm9udC1zaXplOjFlbX0uc3dhbDItdGltZXItcHJvZ3Jlc3MtYmFyLWNvbnRhaW5lcntwb3NpdGlvbjphYnNvbHV0ZTtyaWdodDowO2JvdHRvbTowO2xlZnQ6MDtoZWlnaHQ6LjI1ZW07b3ZlcmZsb3c6aGlkZGVuO2JvcmRlci1ib3R0b20tcmlnaHQtcmFkaXVzOjVweDtib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOjVweH0uc3dhbDItdGltZXItcHJvZ3Jlc3MtYmFye3dpZHRoOjEwMCU7aGVpZ2h0Oi4yNWVtO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwuMil9LnN3YWwyLWltYWdle21heC13aWR0aDoxMDAlO21hcmdpbjoxLjI1ZW0gYXV0b30uc3dhbDItY2xvc2V7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoyO3RvcDowO3JpZ2h0OjA7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7d2lkdGg6MS4yZW07aGVpZ2h0OjEuMmVtO3BhZGRpbmc6MDtvdmVyZmxvdzpoaWRkZW47dHJhbnNpdGlvbjpjb2xvciAuMXMgZWFzZS1vdXQ7Ym9yZGVyOm5vbmU7Ym9yZGVyLXJhZGl1czo1cHg7YmFja2dyb3VuZDowIDA7Y29sb3I6I2NjYztmb250LWZhbWlseTpzZXJpZjtmb250LXNpemU6Mi41ZW07bGluZS1oZWlnaHQ6MS4yO2N1cnNvcjpwb2ludGVyfS5zd2FsMi1jbG9zZTpob3Zlcnt0cmFuc2Zvcm06bm9uZTtiYWNrZ3JvdW5kOjAgMDtjb2xvcjojZjI3NDc0fS5zd2FsMi1jbG9zZTpmb2N1c3tvdXRsaW5lOjA7Ym94LXNoYWRvdzppbnNldCAwIDAgMCAzcHggcmdiYSgxMDAsMTUwLDIwMCwuNSl9LnN3YWwyLWNsb3NlOjotbW96LWZvY3VzLWlubmVye2JvcmRlcjowfS5zd2FsMi1jb250ZW50e3otaW5kZXg6MTtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO21hcmdpbjowO3BhZGRpbmc6MCAxLjZlbTtjb2xvcjojNTQ1NDU0O2ZvbnQtc2l6ZToxLjEyNWVtO2ZvbnQtd2VpZ2h0OjQwMDtsaW5lLWhlaWdodDpub3JtYWw7dGV4dC1hbGlnbjpjZW50ZXI7d29yZC13cmFwOmJyZWFrLXdvcmR9LnN3YWwyLWNoZWNrYm94LC5zd2FsMi1maWxlLC5zd2FsMi1pbnB1dCwuc3dhbDItcmFkaW8sLnN3YWwyLXNlbGVjdCwuc3dhbDItdGV4dGFyZWF7bWFyZ2luOjFlbSBhdXRvfS5zd2FsMi1maWxlLC5zd2FsMi1pbnB1dCwuc3dhbDItdGV4dGFyZWF7Ym94LXNpemluZzpib3JkZXItYm94O3dpZHRoOjEwMCU7dHJhbnNpdGlvbjpib3JkZXItY29sb3IgLjNzLGJveC1zaGFkb3cgLjNzO2JvcmRlcjoxcHggc29saWQgI2Q5ZDlkOTtib3JkZXItcmFkaXVzOi4xODc1ZW07YmFja2dyb3VuZDppbmhlcml0O2JveC1zaGFkb3c6aW5zZXQgMCAxcHggMXB4IHJnYmEoMCwwLDAsLjA2KTtjb2xvcjppbmhlcml0O2ZvbnQtc2l6ZToxLjEyNWVtfS5zd2FsMi1maWxlLnN3YWwyLWlucHV0ZXJyb3IsLnN3YWwyLWlucHV0LnN3YWwyLWlucHV0ZXJyb3IsLnN3YWwyLXRleHRhcmVhLnN3YWwyLWlucHV0ZXJyb3J7Ym9yZGVyLWNvbG9yOiNmMjc0NzQhaW1wb3J0YW50O2JveC1zaGFkb3c6MCAwIDJweCAjZjI3NDc0IWltcG9ydGFudH0uc3dhbDItZmlsZTpmb2N1cywuc3dhbDItaW5wdXQ6Zm9jdXMsLnN3YWwyLXRleHRhcmVhOmZvY3Vze2JvcmRlcjoxcHggc29saWQgI2I0ZGJlZDtvdXRsaW5lOjA7Ym94LXNoYWRvdzowIDAgMCAzcHggcmdiYSgxMDAsMTUwLDIwMCwuNSl9LnN3YWwyLWZpbGU6Oi1tb3otcGxhY2Vob2xkZXIsLnN3YWwyLWlucHV0OjotbW96LXBsYWNlaG9sZGVyLC5zd2FsMi10ZXh0YXJlYTo6LW1vei1wbGFjZWhvbGRlcntjb2xvcjojY2NjfS5zd2FsMi1maWxlOi1tcy1pbnB1dC1wbGFjZWhvbGRlciwuc3dhbDItaW5wdXQ6LW1zLWlucHV0LXBsYWNlaG9sZGVyLC5zd2FsMi10ZXh0YXJlYTotbXMtaW5wdXQtcGxhY2Vob2xkZXJ7Y29sb3I6I2NjY30uc3dhbDItZmlsZTo6cGxhY2Vob2xkZXIsLnN3YWwyLWlucHV0OjpwbGFjZWhvbGRlciwuc3dhbDItdGV4dGFyZWE6OnBsYWNlaG9sZGVye2NvbG9yOiNjY2N9LnN3YWwyLXJhbmdle21hcmdpbjoxZW0gYXV0bztiYWNrZ3JvdW5kOiNmZmZ9LnN3YWwyLXJhbmdlIGlucHV0e3dpZHRoOjgwJX0uc3dhbDItcmFuZ2Ugb3V0cHV0e3dpZHRoOjIwJTtjb2xvcjppbmhlcml0O2ZvbnQtd2VpZ2h0OjYwMDt0ZXh0LWFsaWduOmNlbnRlcn0uc3dhbDItcmFuZ2UgaW5wdXQsLnN3YWwyLXJhbmdlIG91dHB1dHtoZWlnaHQ6Mi42MjVlbTtwYWRkaW5nOjA7Zm9udC1zaXplOjEuMTI1ZW07bGluZS1oZWlnaHQ6Mi42MjVlbX0uc3dhbDItaW5wdXR7aGVpZ2h0OjIuNjI1ZW07cGFkZGluZzowIC43NWVtfS5zd2FsMi1pbnB1dFt0eXBlPW51bWJlcl17bWF4LXdpZHRoOjEwZW19LnN3YWwyLWZpbGV7YmFja2dyb3VuZDppbmhlcml0O2ZvbnQtc2l6ZToxLjEyNWVtfS5zd2FsMi10ZXh0YXJlYXtoZWlnaHQ6Ni43NWVtO3BhZGRpbmc6Ljc1ZW19LnN3YWwyLXNlbGVjdHttaW4td2lkdGg6NTAlO21heC13aWR0aDoxMDAlO3BhZGRpbmc6LjM3NWVtIC42MjVlbTtiYWNrZ3JvdW5kOmluaGVyaXQ7Y29sb3I6aW5oZXJpdDtmb250LXNpemU6MS4xMjVlbX0uc3dhbDItY2hlY2tib3gsLnN3YWwyLXJhZGlve2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2JhY2tncm91bmQ6I2ZmZjtjb2xvcjppbmhlcml0fS5zd2FsMi1jaGVja2JveCBsYWJlbCwuc3dhbDItcmFkaW8gbGFiZWx7bWFyZ2luOjAgLjZlbTtmb250LXNpemU6MS4xMjVlbX0uc3dhbDItY2hlY2tib3ggaW5wdXQsLnN3YWwyLXJhZGlvIGlucHV0e2ZsZXgtc2hyaW5rOjA7bWFyZ2luOjAgLjRlbX0uc3dhbDItaW5wdXQtbGFiZWx7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpjZW50ZXI7bWFyZ2luOjFlbSBhdXRvfS5zd2FsMi12YWxpZGF0aW9uLW1lc3NhZ2V7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7bWFyZ2luOjAgLTIuN2VtO3BhZGRpbmc6LjYyNWVtO292ZXJmbG93OmhpZGRlbjtiYWNrZ3JvdW5kOiNmMGYwZjA7Y29sb3I6IzY2Njtmb250LXNpemU6MWVtO2ZvbnQtd2VpZ2h0OjMwMH0uc3dhbDItdmFsaWRhdGlvbi1tZXNzYWdlOjpiZWZvcmV7Y29udGVudDpcIiFcIjtkaXNwbGF5OmlubGluZS1ibG9jazt3aWR0aDoxLjVlbTttaW4td2lkdGg6MS41ZW07aGVpZ2h0OjEuNWVtO21hcmdpbjowIC42MjVlbTtib3JkZXItcmFkaXVzOjUwJTtiYWNrZ3JvdW5kLWNvbG9yOiNmMjc0NzQ7Y29sb3I6I2ZmZjtmb250LXdlaWdodDo2MDA7bGluZS1oZWlnaHQ6MS41ZW07dGV4dC1hbGlnbjpjZW50ZXJ9LnN3YWwyLWljb257cG9zaXRpb246cmVsYXRpdmU7Ym94LXNpemluZzpjb250ZW50LWJveDtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3dpZHRoOjVlbTtoZWlnaHQ6NWVtO21hcmdpbjoxLjI1ZW0gYXV0byAxLjg3NWVtO2JvcmRlcjouMjVlbSBzb2xpZCB0cmFuc3BhcmVudDtib3JkZXItcmFkaXVzOjUwJTtib3JkZXItY29sb3I6IzAwMDtmb250LWZhbWlseTppbmhlcml0O2xpbmUtaGVpZ2h0OjVlbTtjdXJzb3I6ZGVmYXVsdDstd2Via2l0LXVzZXItc2VsZWN0Om5vbmU7LW1vei11c2VyLXNlbGVjdDpub25lOy1tcy11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmV9LnN3YWwyLWljb24gLnN3YWwyLWljb24tY29udGVudHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2ZvbnQtc2l6ZTozLjc1ZW19LnN3YWwyLWljb24uc3dhbDItZXJyb3J7Ym9yZGVyLWNvbG9yOiNmMjc0NzQ7Y29sb3I6I2YyNzQ3NH0uc3dhbDItaWNvbi5zd2FsMi1lcnJvciAuc3dhbDIteC1tYXJre3Bvc2l0aW9uOnJlbGF0aXZlO2ZsZXgtZ3JvdzoxfS5zd2FsMi1pY29uLnN3YWwyLWVycm9yIFtjbGFzc149c3dhbDIteC1tYXJrLWxpbmVde2Rpc3BsYXk6YmxvY2s7cG9zaXRpb246YWJzb2x1dGU7dG9wOjIuMzEyNWVtO3dpZHRoOjIuOTM3NWVtO2hlaWdodDouMzEyNWVtO2JvcmRlci1yYWRpdXM6LjEyNWVtO2JhY2tncm91bmQtY29sb3I6I2YyNzQ3NH0uc3dhbDItaWNvbi5zd2FsMi1lcnJvciBbY2xhc3NePXN3YWwyLXgtbWFyay1saW5lXVtjbGFzcyQ9bGVmdF17bGVmdDoxLjA2MjVlbTt0cmFuc2Zvcm06cm90YXRlKDQ1ZGVnKX0uc3dhbDItaWNvbi5zd2FsMi1lcnJvciBbY2xhc3NePXN3YWwyLXgtbWFyay1saW5lXVtjbGFzcyQ9cmlnaHRde3JpZ2h0OjFlbTt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyl9LnN3YWwyLWljb24uc3dhbDItZXJyb3Iuc3dhbDItaWNvbi1zaG93ey13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLWFuaW1hdGUtZXJyb3ItaWNvbiAuNXM7YW5pbWF0aW9uOnN3YWwyLWFuaW1hdGUtZXJyb3ItaWNvbiAuNXN9LnN3YWwyLWljb24uc3dhbDItZXJyb3Iuc3dhbDItaWNvbi1zaG93IC5zd2FsMi14LW1hcmt7LXdlYmtpdC1hbmltYXRpb246c3dhbDItYW5pbWF0ZS1lcnJvci14LW1hcmsgLjVzO2FuaW1hdGlvbjpzd2FsMi1hbmltYXRlLWVycm9yLXgtbWFyayAuNXN9LnN3YWwyLWljb24uc3dhbDItd2FybmluZ3tib3JkZXItY29sb3I6I2ZhY2VhODtjb2xvcjojZjhiYjg2fS5zd2FsMi1pY29uLnN3YWwyLWluZm97Ym9yZGVyLWNvbG9yOiM5ZGUwZjY7Y29sb3I6IzNmYzNlZX0uc3dhbDItaWNvbi5zd2FsMi1xdWVzdGlvbntib3JkZXItY29sb3I6I2M5ZGFlMTtjb2xvcjojODdhZGJkfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3N7Ym9yZGVyLWNvbG9yOiNhNWRjODY7Y29sb3I6I2E1ZGM4Nn0uc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXXtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDozLjc1ZW07aGVpZ2h0OjcuNWVtO3RyYW5zZm9ybTpyb3RhdGUoNDVkZWcpO2JvcmRlci1yYWRpdXM6NTAlfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmVdW2NsYXNzJD1sZWZ0XXt0b3A6LS40Mzc1ZW07bGVmdDotMi4wNjM1ZW07dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpO3RyYW5zZm9ybS1vcmlnaW46My43NWVtIDMuNzVlbTtib3JkZXItcmFkaXVzOjcuNWVtIDAgMCA3LjVlbX0uc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1jaXJjdWxhci1saW5lXVtjbGFzcyQ9cmlnaHRde3RvcDotLjY4NzVlbTtsZWZ0OjEuODc1ZW07dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpO3RyYW5zZm9ybS1vcmlnaW46MCAzLjc1ZW07Ym9yZGVyLXJhZGl1czowIDcuNWVtIDcuNWVtIDB9LnN3YWwyLWljb24uc3dhbDItc3VjY2VzcyAuc3dhbDItc3VjY2Vzcy1yaW5ne3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6Mjt0b3A6LS4yNWVtO2xlZnQ6LS4yNWVtO2JveC1zaXppbmc6Y29udGVudC1ib3g7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtib3JkZXI6LjI1ZW0gc29saWQgcmdiYSgxNjUsMjIwLDEzNCwuMyk7Ym9yZGVyLXJhZGl1czo1MCV9LnN3YWwyLWljb24uc3dhbDItc3VjY2VzcyAuc3dhbDItc3VjY2Vzcy1maXh7cG9zaXRpb246YWJzb2x1dGU7ei1pbmRleDoxO3RvcDouNWVtO2xlZnQ6MS42MjVlbTt3aWR0aDouNDM3NWVtO2hlaWdodDo1LjYyNWVtO3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKX0uc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzIFtjbGFzc149c3dhbDItc3VjY2Vzcy1saW5lXXtkaXNwbGF5OmJsb2NrO3Bvc2l0aW9uOmFic29sdXRlO3otaW5kZXg6MjtoZWlnaHQ6LjMxMjVlbTtib3JkZXItcmFkaXVzOi4xMjVlbTtiYWNrZ3JvdW5kLWNvbG9yOiNhNWRjODZ9LnN3YWwyLWljb24uc3dhbDItc3VjY2VzcyBbY2xhc3NePXN3YWwyLXN1Y2Nlc3MtbGluZV1bY2xhc3MkPXRpcF17dG9wOjIuODc1ZW07bGVmdDouODEyNWVtO3dpZHRoOjEuNTYyNWVtO3RyYW5zZm9ybTpyb3RhdGUoNDVkZWcpfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3MgW2NsYXNzXj1zd2FsMi1zdWNjZXNzLWxpbmVdW2NsYXNzJD1sb25nXXt0b3A6Mi4zNzVlbTtyaWdodDouNWVtO3dpZHRoOjIuOTM3NWVtO3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKX0uc3dhbDItaWNvbi5zd2FsMi1zdWNjZXNzLnN3YWwyLWljb24tc2hvdyAuc3dhbDItc3VjY2Vzcy1saW5lLXRpcHstd2Via2l0LWFuaW1hdGlvbjpzd2FsMi1hbmltYXRlLXN1Y2Nlc3MtbGluZS10aXAgLjc1czthbmltYXRpb246c3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwIC43NXN9LnN3YWwyLWljb24uc3dhbDItc3VjY2Vzcy5zd2FsMi1pY29uLXNob3cgLnN3YWwyLXN1Y2Nlc3MtbGluZS1sb25ney13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmcgLjc1czthbmltYXRpb246c3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtbG9uZyAuNzVzfS5zd2FsMi1pY29uLnN3YWwyLXN1Y2Nlc3Muc3dhbDItaWNvbi1zaG93IC5zd2FsMi1zdWNjZXNzLWNpcmN1bGFyLWxpbmUtcmlnaHR7LXdlYmtpdC1hbmltYXRpb246c3dhbDItcm90YXRlLXN1Y2Nlc3MtY2lyY3VsYXItbGluZSA0LjI1cyBlYXNlLWluO2FuaW1hdGlvbjpzd2FsMi1yb3RhdGUtc3VjY2Vzcy1jaXJjdWxhci1saW5lIDQuMjVzIGVhc2UtaW59LnN3YWwyLXByb2dyZXNzLXN0ZXBze2ZsZXgtd3JhcDp3cmFwO2FsaWduLWl0ZW1zOmNlbnRlcjttYXgtd2lkdGg6MTAwJTttYXJnaW46MCAwIDEuMjVlbTtwYWRkaW5nOjA7YmFja2dyb3VuZDppbmhlcml0O2ZvbnQtd2VpZ2h0OjYwMH0uc3dhbDItcHJvZ3Jlc3Mtc3RlcHMgbGl7ZGlzcGxheTppbmxpbmUtYmxvY2s7cG9zaXRpb246cmVsYXRpdmV9LnN3YWwyLXByb2dyZXNzLXN0ZXBzIC5zd2FsMi1wcm9ncmVzcy1zdGVwe3otaW5kZXg6MjA7ZmxleC1zaHJpbms6MDt3aWR0aDoyZW07aGVpZ2h0OjJlbTtib3JkZXItcmFkaXVzOjJlbTtiYWNrZ3JvdW5kOiMyNzc4YzQ7Y29sb3I6I2ZmZjtsaW5lLWhlaWdodDoyZW07dGV4dC1hbGlnbjpjZW50ZXJ9LnN3YWwyLXByb2dyZXNzLXN0ZXBzIC5zd2FsMi1wcm9ncmVzcy1zdGVwLnN3YWwyLWFjdGl2ZS1wcm9ncmVzcy1zdGVwe2JhY2tncm91bmQ6IzI3NzhjNH0uc3dhbDItcHJvZ3Jlc3Mtc3RlcHMgLnN3YWwyLXByb2dyZXNzLXN0ZXAuc3dhbDItYWN0aXZlLXByb2dyZXNzLXN0ZXB+LnN3YWwyLXByb2dyZXNzLXN0ZXB7YmFja2dyb3VuZDojYWRkOGU2O2NvbG9yOiNmZmZ9LnN3YWwyLXByb2dyZXNzLXN0ZXBzIC5zd2FsMi1wcm9ncmVzcy1zdGVwLnN3YWwyLWFjdGl2ZS1wcm9ncmVzcy1zdGVwfi5zd2FsMi1wcm9ncmVzcy1zdGVwLWxpbmV7YmFja2dyb3VuZDojYWRkOGU2fS5zd2FsMi1wcm9ncmVzcy1zdGVwcyAuc3dhbDItcHJvZ3Jlc3Mtc3RlcC1saW5le3otaW5kZXg6MTA7ZmxleC1zaHJpbms6MDt3aWR0aDoyLjVlbTtoZWlnaHQ6LjRlbTttYXJnaW46MCAtMXB4O2JhY2tncm91bmQ6IzI3NzhjNH1bY2xhc3NePXN3YWwyXXstd2Via2l0LXRhcC1oaWdobGlnaHQtY29sb3I6dHJhbnNwYXJlbnR9LnN3YWwyLXNob3d7LXdlYmtpdC1hbmltYXRpb246c3dhbDItc2hvdyAuM3M7YW5pbWF0aW9uOnN3YWwyLXNob3cgLjNzfS5zd2FsMi1oaWRley13ZWJraXQtYW5pbWF0aW9uOnN3YWwyLWhpZGUgLjE1cyBmb3J3YXJkczthbmltYXRpb246c3dhbDItaGlkZSAuMTVzIGZvcndhcmRzfS5zd2FsMi1ub2FuaW1hdGlvbnt0cmFuc2l0aW9uOm5vbmV9LnN3YWwyLXNjcm9sbGJhci1tZWFzdXJle3Bvc2l0aW9uOmFic29sdXRlO3RvcDotOTk5OXB4O3dpZHRoOjUwcHg7aGVpZ2h0OjUwcHg7b3ZlcmZsb3c6c2Nyb2xsfS5zd2FsMi1ydGwgLnN3YWwyLWNsb3Nle3JpZ2h0OmF1dG87bGVmdDowfS5zd2FsMi1ydGwgLnN3YWwyLXRpbWVyLXByb2dyZXNzLWJhcntyaWdodDowO2xlZnQ6YXV0b31Ac3VwcG9ydHMgKC1tcy1hY2NlbGVyYXRvcjp0cnVlKXsuc3dhbDItcmFuZ2UgaW5wdXR7d2lkdGg6MTAwJSFpbXBvcnRhbnR9LnN3YWwyLXJhbmdlIG91dHB1dHtkaXNwbGF5Om5vbmV9fUBtZWRpYSBhbGwgYW5kICgtbXMtaGlnaC1jb250cmFzdDpub25lKSwoLW1zLWhpZ2gtY29udHJhc3Q6YWN0aXZlKXsuc3dhbDItcmFuZ2UgaW5wdXR7d2lkdGg6MTAwJSFpbXBvcnRhbnR9LnN3YWwyLXJhbmdlIG91dHB1dHtkaXNwbGF5Om5vbmV9fUAtd2Via2l0LWtleWZyYW1lcyBzd2FsMi10b2FzdC1zaG93ezAle3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0uNjI1ZW0pIHJvdGF0ZVooMmRlZyl9MzMle3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApIHJvdGF0ZVooLTJkZWcpfTY2JXt0cmFuc2Zvcm06dHJhbnNsYXRlWSguMzEyNWVtKSByb3RhdGVaKDJkZWcpfTEwMCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCkgcm90YXRlWigwKX19QGtleWZyYW1lcyBzd2FsMi10b2FzdC1zaG93ezAle3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0uNjI1ZW0pIHJvdGF0ZVooMmRlZyl9MzMle3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApIHJvdGF0ZVooLTJkZWcpfTY2JXt0cmFuc2Zvcm06dHJhbnNsYXRlWSguMzEyNWVtKSByb3RhdGVaKDJkZWcpfTEwMCV7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCkgcm90YXRlWigwKX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWhpZGV7MTAwJXt0cmFuc2Zvcm06cm90YXRlWigxZGVnKTtvcGFjaXR5OjB9fUBrZXlmcmFtZXMgc3dhbDItdG9hc3QtaGlkZXsxMDAle3RyYW5zZm9ybTpyb3RhdGVaKDFkZWcpO29wYWNpdHk6MH19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLXRpcHswJXt0b3A6LjU2MjVlbTtsZWZ0Oi4wNjI1ZW07d2lkdGg6MH01NCV7dG9wOi4xMjVlbTtsZWZ0Oi4xMjVlbTt3aWR0aDowfTcwJXt0b3A6LjYyNWVtO2xlZnQ6LS4yNWVtO3dpZHRoOjEuNjI1ZW19ODQle3RvcDoxLjA2MjVlbTtsZWZ0Oi43NWVtO3dpZHRoOi41ZW19MTAwJXt0b3A6MS4xMjVlbTtsZWZ0Oi4xODc1ZW07d2lkdGg6Ljc1ZW19fUBrZXlmcmFtZXMgc3dhbDItdG9hc3QtYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwezAle3RvcDouNTYyNWVtO2xlZnQ6LjA2MjVlbTt3aWR0aDowfTU0JXt0b3A6LjEyNWVtO2xlZnQ6LjEyNWVtO3dpZHRoOjB9NzAle3RvcDouNjI1ZW07bGVmdDotLjI1ZW07d2lkdGg6MS42MjVlbX04NCV7dG9wOjEuMDYyNWVtO2xlZnQ6Ljc1ZW07d2lkdGg6LjVlbX0xMDAle3RvcDoxLjEyNWVtO2xlZnQ6LjE4NzVlbTt3aWR0aDouNzVlbX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmd7MCV7dG9wOjEuNjI1ZW07cmlnaHQ6MS4zNzVlbTt3aWR0aDowfTY1JXt0b3A6MS4yNWVtO3JpZ2h0Oi45Mzc1ZW07d2lkdGg6MH04NCV7dG9wOi45Mzc1ZW07cmlnaHQ6MDt3aWR0aDoxLjEyNWVtfTEwMCV7dG9wOi45Mzc1ZW07cmlnaHQ6LjE4NzVlbTt3aWR0aDoxLjM3NWVtfX1Aa2V5ZnJhbWVzIHN3YWwyLXRvYXN0LWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmd7MCV7dG9wOjEuNjI1ZW07cmlnaHQ6MS4zNzVlbTt3aWR0aDowfTY1JXt0b3A6MS4yNWVtO3JpZ2h0Oi45Mzc1ZW07d2lkdGg6MH04NCV7dG9wOi45Mzc1ZW07cmlnaHQ6MDt3aWR0aDoxLjEyNWVtfTEwMCV7dG9wOi45Mzc1ZW07cmlnaHQ6LjE4NzVlbTt3aWR0aDoxLjM3NWVtfX1ALXdlYmtpdC1rZXlmcmFtZXMgc3dhbDItc2hvd3swJXt0cmFuc2Zvcm06c2NhbGUoLjcpfTQ1JXt0cmFuc2Zvcm06c2NhbGUoMS4wNSl9ODAle3RyYW5zZm9ybTpzY2FsZSguOTUpfTEwMCV7dHJhbnNmb3JtOnNjYWxlKDEpfX1Aa2V5ZnJhbWVzIHN3YWwyLXNob3d7MCV7dHJhbnNmb3JtOnNjYWxlKC43KX00NSV7dHJhbnNmb3JtOnNjYWxlKDEuMDUpfTgwJXt0cmFuc2Zvcm06c2NhbGUoLjk1KX0xMDAle3RyYW5zZm9ybTpzY2FsZSgxKX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLWhpZGV7MCV7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MX0xMDAle3RyYW5zZm9ybTpzY2FsZSguNSk7b3BhY2l0eTowfX1Aa2V5ZnJhbWVzIHN3YWwyLWhpZGV7MCV7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MX0xMDAle3RyYW5zZm9ybTpzY2FsZSguNSk7b3BhY2l0eTowfX1ALXdlYmtpdC1rZXlmcmFtZXMgc3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtdGlwezAle3RvcDoxLjE4NzVlbTtsZWZ0Oi4wNjI1ZW07d2lkdGg6MH01NCV7dG9wOjEuMDYyNWVtO2xlZnQ6LjEyNWVtO3dpZHRoOjB9NzAle3RvcDoyLjE4NzVlbTtsZWZ0Oi0uMzc1ZW07d2lkdGg6My4xMjVlbX04NCV7dG9wOjNlbTtsZWZ0OjEuMzEyNWVtO3dpZHRoOjEuMDYyNWVtfTEwMCV7dG9wOjIuODEyNWVtO2xlZnQ6LjgxMjVlbTt3aWR0aDoxLjU2MjVlbX19QGtleWZyYW1lcyBzd2FsMi1hbmltYXRlLXN1Y2Nlc3MtbGluZS10aXB7MCV7dG9wOjEuMTg3NWVtO2xlZnQ6LjA2MjVlbTt3aWR0aDowfTU0JXt0b3A6MS4wNjI1ZW07bGVmdDouMTI1ZW07d2lkdGg6MH03MCV7dG9wOjIuMTg3NWVtO2xlZnQ6LS4zNzVlbTt3aWR0aDozLjEyNWVtfTg0JXt0b3A6M2VtO2xlZnQ6MS4zMTI1ZW07d2lkdGg6MS4wNjI1ZW19MTAwJXt0b3A6Mi44MTI1ZW07bGVmdDouODEyNWVtO3dpZHRoOjEuNTYyNWVtfX1ALXdlYmtpdC1rZXlmcmFtZXMgc3dhbDItYW5pbWF0ZS1zdWNjZXNzLWxpbmUtbG9uZ3swJXt0b3A6My4zNzVlbTtyaWdodDoyLjg3NWVtO3dpZHRoOjB9NjUle3RvcDozLjM3NWVtO3JpZ2h0OjIuODc1ZW07d2lkdGg6MH04NCV7dG9wOjIuMTg3NWVtO3JpZ2h0OjA7d2lkdGg6My40Mzc1ZW19MTAwJXt0b3A6Mi4zNzVlbTtyaWdodDouNWVtO3dpZHRoOjIuOTM3NWVtfX1Aa2V5ZnJhbWVzIHN3YWwyLWFuaW1hdGUtc3VjY2Vzcy1saW5lLWxvbmd7MCV7dG9wOjMuMzc1ZW07cmlnaHQ6Mi44NzVlbTt3aWR0aDowfTY1JXt0b3A6My4zNzVlbTtyaWdodDoyLjg3NWVtO3dpZHRoOjB9ODQle3RvcDoyLjE4NzVlbTtyaWdodDowO3dpZHRoOjMuNDM3NWVtfTEwMCV7dG9wOjIuMzc1ZW07cmlnaHQ6LjVlbTt3aWR0aDoyLjkzNzVlbX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLXJvdGF0ZS1zdWNjZXNzLWNpcmN1bGFyLWxpbmV7MCV7dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpfTUle3RyYW5zZm9ybTpyb3RhdGUoLTQ1ZGVnKX0xMiV7dHJhbnNmb3JtOnJvdGF0ZSgtNDA1ZGVnKX0xMDAle3RyYW5zZm9ybTpyb3RhdGUoLTQwNWRlZyl9fUBrZXlmcmFtZXMgc3dhbDItcm90YXRlLXN1Y2Nlc3MtY2lyY3VsYXItbGluZXswJXt0cmFuc2Zvcm06cm90YXRlKC00NWRlZyl9NSV7dHJhbnNmb3JtOnJvdGF0ZSgtNDVkZWcpfTEyJXt0cmFuc2Zvcm06cm90YXRlKC00MDVkZWcpfTEwMCV7dHJhbnNmb3JtOnJvdGF0ZSgtNDA1ZGVnKX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLWFuaW1hdGUtZXJyb3IteC1tYXJrezAle21hcmdpbi10b3A6MS42MjVlbTt0cmFuc2Zvcm06c2NhbGUoLjQpO29wYWNpdHk6MH01MCV7bWFyZ2luLXRvcDoxLjYyNWVtO3RyYW5zZm9ybTpzY2FsZSguNCk7b3BhY2l0eTowfTgwJXttYXJnaW4tdG9wOi0uMzc1ZW07dHJhbnNmb3JtOnNjYWxlKDEuMTUpfTEwMCV7bWFyZ2luLXRvcDowO3RyYW5zZm9ybTpzY2FsZSgxKTtvcGFjaXR5OjF9fUBrZXlmcmFtZXMgc3dhbDItYW5pbWF0ZS1lcnJvci14LW1hcmt7MCV7bWFyZ2luLXRvcDoxLjYyNWVtO3RyYW5zZm9ybTpzY2FsZSguNCk7b3BhY2l0eTowfTUwJXttYXJnaW4tdG9wOjEuNjI1ZW07dHJhbnNmb3JtOnNjYWxlKC40KTtvcGFjaXR5OjB9ODAle21hcmdpbi10b3A6LS4zNzVlbTt0cmFuc2Zvcm06c2NhbGUoMS4xNSl9MTAwJXttYXJnaW4tdG9wOjA7dHJhbnNmb3JtOnNjYWxlKDEpO29wYWNpdHk6MX19QC13ZWJraXQta2V5ZnJhbWVzIHN3YWwyLWFuaW1hdGUtZXJyb3ItaWNvbnswJXt0cmFuc2Zvcm06cm90YXRlWCgxMDBkZWcpO29wYWNpdHk6MH0xMDAle3RyYW5zZm9ybTpyb3RhdGVYKDApO29wYWNpdHk6MX19QGtleWZyYW1lcyBzd2FsMi1hbmltYXRlLWVycm9yLWljb257MCV7dHJhbnNmb3JtOnJvdGF0ZVgoMTAwZGVnKTtvcGFjaXR5OjB9MTAwJXt0cmFuc2Zvcm06cm90YXRlWCgwKTtvcGFjaXR5OjF9fUAtd2Via2l0LWtleWZyYW1lcyBzd2FsMi1yb3RhdGUtbG9hZGluZ3swJXt0cmFuc2Zvcm06cm90YXRlKDApfTEwMCV7dHJhbnNmb3JtOnJvdGF0ZSgzNjBkZWcpfX1Aa2V5ZnJhbWVzIHN3YWwyLXJvdGF0ZS1sb2FkaW5nezAle3RyYW5zZm9ybTpyb3RhdGUoMCl9MTAwJXt0cmFuc2Zvcm06cm90YXRlKDM2MGRlZyl9fWJvZHkuc3dhbDItc2hvd246bm90KC5zd2FsMi1uby1iYWNrZHJvcCk6bm90KC5zd2FsMi10b2FzdC1zaG93bil7b3ZlcmZsb3c6aGlkZGVufWJvZHkuc3dhbDItaGVpZ2h0LWF1dG97aGVpZ2h0OmF1dG8haW1wb3J0YW50fWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lcnt0b3A6YXV0bztyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6YXV0bzttYXgtd2lkdGg6Y2FsYygxMDAlIC0gLjYyNWVtICogMik7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudCFpbXBvcnRhbnR9Ym9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItY29udGFpbmVyPi5zd2FsMi1tb2RhbHtib3gtc2hhZG93OjAgMCAxMHB4IHJnYmEoMCwwLDAsLjQpfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3B7dG9wOjA7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSl9Ym9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1sZWZ0LGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3Atc3RhcnR7dG9wOjA7bGVmdDowfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3AtZW5kLGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi10b3AtcmlnaHR7dG9wOjA7cmlnaHQ6MH1ib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVye3RvcDo1MCU7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtNTAlLC01MCUpfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItbGVmdCxib2R5LnN3YWwyLW5vLWJhY2tkcm9wIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLXN0YXJ0e3RvcDo1MCU7bGVmdDowO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItZW5kLGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXItcmlnaHR7dG9wOjUwJTtyaWdodDowO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b217Ym90dG9tOjA7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSl9Ym9keS5zd2FsMi1uby1iYWNrZHJvcCAuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1sZWZ0LGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tc3RhcnR7Ym90dG9tOjA7bGVmdDowfWJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tZW5kLGJvZHkuc3dhbDItbm8tYmFja2Ryb3AgLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tcmlnaHR7cmlnaHQ6MDtib3R0b206MH1AbWVkaWEgcHJpbnR7Ym9keS5zd2FsMi1zaG93bjpub3QoLnN3YWwyLW5vLWJhY2tkcm9wKTpub3QoLnN3YWwyLXRvYXN0LXNob3duKXtvdmVyZmxvdy15OnNjcm9sbCFpbXBvcnRhbnR9Ym9keS5zd2FsMi1zaG93bjpub3QoLnN3YWwyLW5vLWJhY2tkcm9wKTpub3QoLnN3YWwyLXRvYXN0LXNob3duKT5bYXJpYS1oaWRkZW49dHJ1ZV17ZGlzcGxheTpub25lfWJvZHkuc3dhbDItc2hvd246bm90KC5zd2FsMi1uby1iYWNrZHJvcCk6bm90KC5zd2FsMi10b2FzdC1zaG93bikgLnN3YWwyLWNvbnRhaW5lcntwb3NpdGlvbjpzdGF0aWMhaW1wb3J0YW50fX1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXJ7YmFja2dyb3VuZC1jb2xvcjp0cmFuc3BhcmVudH1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItdG9we3RvcDowO3JpZ2h0OmF1dG87Ym90dG9tOmF1dG87bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSl9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1lbmQsYm9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1yaWdodHt0b3A6MDtyaWdodDowO2JvdHRvbTphdXRvO2xlZnQ6YXV0b31ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItdG9wLWxlZnQsYm9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLXRvcC1zdGFydHt0b3A6MDtyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6MH1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLWxlZnQsYm9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLWNlbnRlci1zdGFydHt0b3A6NTAlO3JpZ2h0OmF1dG87Ym90dG9tOmF1dG87bGVmdDowO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01MCUpfWJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1jZW50ZXJ7dG9wOjUwJTtyaWdodDphdXRvO2JvdHRvbTphdXRvO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwtNTAlKX1ib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLWVuZCxib2R5LnN3YWwyLXRvYXN0LXNob3duIC5zd2FsMi1jb250YWluZXIuc3dhbDItY2VudGVyLXJpZ2h0e3RvcDo1MCU7cmlnaHQ6MDtib3R0b206YXV0bztsZWZ0OmF1dG87dHJhbnNmb3JtOnRyYW5zbGF0ZVkoLTUwJSl9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbS1sZWZ0LGJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tc3RhcnR7dG9wOmF1dG87cmlnaHQ6YXV0bztib3R0b206MDtsZWZ0OjB9Ym9keS5zd2FsMi10b2FzdC1zaG93biAuc3dhbDItY29udGFpbmVyLnN3YWwyLWJvdHRvbXt0b3A6YXV0bztyaWdodDphdXRvO2JvdHRvbTowO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGVYKC01MCUpfWJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tZW5kLGJvZHkuc3dhbDItdG9hc3Qtc2hvd24gLnN3YWwyLWNvbnRhaW5lci5zd2FsMi1ib3R0b20tcmlnaHR7dG9wOmF1dG87cmlnaHQ6MDtib3R0b206MDtsZWZ0OmF1dG99Iik7"},{"meta":{"name":"md5.min.js","url":"https://unpkg.com/js-md5@0.7.3/build/md5.min.js","ts":1770963303579,"mimetype":"text/javascript"},"source":"LyoqCiAqIFtqcy1tZDVde0BsaW5rIGh0dHBzOi8vZ2l0aHViLmNvbS9lbW4xNzgvanMtbWQ1fQogKgogKiBAbmFtZXNwYWNlIG1kNQogKiBAdmVyc2lvbiAwLjcuMwogKiBAYXV0aG9yIENoZW4sIFlpLUN5dWFuIFtlbW4xNzhAZ21haWwuY29tXQogKiBAY29weXJpZ2h0IENoZW4sIFlpLUN5dWFuIDIwMTQtMjAxNwogKiBAbGljZW5zZSBNSVQKICovCiFmdW5jdGlvbigpeyJ1c2Ugc3RyaWN0IjtmdW5jdGlvbiB0KHQpe2lmKHQpZFswXT1kWzE2XT1kWzFdPWRbMl09ZFszXT1kWzRdPWRbNV09ZFs2XT1kWzddPWRbOF09ZFs5XT1kWzEwXT1kWzExXT1kWzEyXT1kWzEzXT1kWzE0XT1kWzE1XT0wLHRoaXMuYmxvY2tzPWQsdGhpcy5idWZmZXI4PWw7ZWxzZSBpZihhKXt2YXIgcj1uZXcgQXJyYXlCdWZmZXIoNjgpO3RoaXMuYnVmZmVyOD1uZXcgVWludDhBcnJheShyKSx0aGlzLmJsb2Nrcz1uZXcgVWludDMyQXJyYXkocil9ZWxzZSB0aGlzLmJsb2Nrcz1bMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwXTt0aGlzLmgwPXRoaXMuaDE9dGhpcy5oMj10aGlzLmgzPXRoaXMuc3RhcnQ9dGhpcy5ieXRlcz10aGlzLmhCeXRlcz0wLHRoaXMuZmluYWxpemVkPXRoaXMuaGFzaGVkPSExLHRoaXMuZmlyc3Q9ITB9dmFyIHI9ImlucHV0IGlzIGludmFsaWQgdHlwZSIsZT0ib2JqZWN0Ij09dHlwZW9mIHdpbmRvdyxpPWU/d2luZG93Ont9O2kuSlNfTUQ1X05PX1dJTkRPVyYmKGU9ITEpO3ZhciBzPSFlJiYib2JqZWN0Ij09dHlwZW9mIHNlbGYsaD0haS5KU19NRDVfTk9fTk9ERV9KUyYmIm9iamVjdCI9PXR5cGVvZiBwcm9jZXNzJiZwcm9jZXNzLnZlcnNpb25zJiZwcm9jZXNzLnZlcnNpb25zLm5vZGU7aD9pPWdsb2JhbDpzJiYoaT1zZWxmKTt2YXIgZj0haS5KU19NRDVfTk9fQ09NTU9OX0pTJiYib2JqZWN0Ij09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHMsbz0iZnVuY3Rpb24iPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kLGE9IWkuSlNfTUQ1X05PX0FSUkFZX0JVRkZFUiYmInVuZGVmaW5lZCIhPXR5cGVvZiBBcnJheUJ1ZmZlcixuPSIwMTIzNDU2Nzg5YWJjZGVmIi5zcGxpdCgiIiksdT1bMTI4LDMyNzY4LDgzODg2MDgsLTIxNDc0ODM2NDhdLHk9WzAsOCwxNiwyNF0sYz1bImhleCIsImFycmF5IiwiZGlnZXN0IiwiYnVmZmVyIiwiYXJyYXlCdWZmZXIiLCJiYXNlNjQiXSxwPSJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvIi5zcGxpdCgiIiksZD1bXSxsO2lmKGEpe3ZhciBBPW5ldyBBcnJheUJ1ZmZlcig2OCk7bD1uZXcgVWludDhBcnJheShBKSxkPW5ldyBVaW50MzJBcnJheShBKX0haS5KU19NRDVfTk9fTk9ERV9KUyYmQXJyYXkuaXNBcnJheXx8KEFycmF5LmlzQXJyYXk9ZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0pLCFhfHwhaS5KU19NRDVfTk9fQVJSQVlfQlVGRkVSX0lTX1ZJRVcmJkFycmF5QnVmZmVyLmlzVmlld3x8KEFycmF5QnVmZmVyLmlzVmlldz1mdW5jdGlvbih0KXtyZXR1cm4ib2JqZWN0Ij09dHlwZW9mIHQmJnQuYnVmZmVyJiZ0LmJ1ZmZlci5jb25zdHJ1Y3Rvcj09PUFycmF5QnVmZmVyfSk7dmFyIGI9ZnVuY3Rpb24ocil7cmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBuZXcgdCghMCkudXBkYXRlKGUpW3JdKCl9fSx2PWZ1bmN0aW9uKCl7dmFyIHI9YigiaGV4Iik7aCYmKHI9dyhyKSksci5jcmVhdGU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IHR9LHIudXBkYXRlPWZ1bmN0aW9uKHQpe3JldHVybiByLmNyZWF0ZSgpLnVwZGF0ZSh0KX07Zm9yKHZhciBlPTA7ZTxjLmxlbmd0aDsrK2Upe3ZhciBpPWNbZV07cltpXT1iKGkpfXJldHVybiByfSx3PWZ1bmN0aW9uKHQpe3ZhciBlPWV2YWwoInJlcXVpcmUoJ2NyeXB0bycpIiksaT1ldmFsKCJyZXF1aXJlKCdidWZmZXInKS5CdWZmZXIiKSxzPWZ1bmN0aW9uKHMpe2lmKCJzdHJpbmciPT10eXBlb2YgcylyZXR1cm4gZS5jcmVhdGVIYXNoKCJtZDUiKS51cGRhdGUocywidXRmOCIpLmRpZ2VzdCgiaGV4Iik7aWYobnVsbD09PXN8fHZvaWQgMD09PXMpdGhyb3cgcjtyZXR1cm4gcy5jb25zdHJ1Y3Rvcj09PUFycmF5QnVmZmVyJiYocz1uZXcgVWludDhBcnJheShzKSksQXJyYXkuaXNBcnJheShzKXx8QXJyYXlCdWZmZXIuaXNWaWV3KHMpfHxzLmNvbnN0cnVjdG9yPT09aT9lLmNyZWF0ZUhhc2goIm1kNSIpLnVwZGF0ZShuZXcgaShzKSkuZGlnZXN0KCJoZXgiKTp0KHMpfTtyZXR1cm4gc307dC5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKHQpe2lmKCF0aGlzLmZpbmFsaXplZCl7dmFyIGUsaT10eXBlb2YgdDtpZigic3RyaW5nIiE9PWkpe2lmKCJvYmplY3QiIT09aSl0aHJvdyByO2lmKG51bGw9PT10KXRocm93IHI7aWYoYSYmdC5jb25zdHJ1Y3Rvcj09PUFycmF5QnVmZmVyKXQ9bmV3IFVpbnQ4QXJyYXkodCk7ZWxzZSBpZighKEFycmF5LmlzQXJyYXkodCl8fGEmJkFycmF5QnVmZmVyLmlzVmlldyh0KSkpdGhyb3cgcjtlPSEwfWZvcih2YXIgcyxoLGY9MCxvPXQubGVuZ3RoLG49dGhpcy5ibG9ja3MsdT10aGlzLmJ1ZmZlcjg7ZjxvOyl7aWYodGhpcy5oYXNoZWQmJih0aGlzLmhhc2hlZD0hMSxuWzBdPW5bMTZdLG5bMTZdPW5bMV09blsyXT1uWzNdPW5bNF09bls1XT1uWzZdPW5bN109bls4XT1uWzldPW5bMTBdPW5bMTFdPW5bMTJdPW5bMTNdPW5bMTRdPW5bMTVdPTApLGUpaWYoYSlmb3IoaD10aGlzLnN0YXJ0O2Y8byYmaDw2NDsrK2YpdVtoKytdPXRbZl07ZWxzZSBmb3IoaD10aGlzLnN0YXJ0O2Y8byYmaDw2NDsrK2YpbltoPj4yXXw9dFtmXTw8eVszJmgrK107ZWxzZSBpZihhKWZvcihoPXRoaXMuc3RhcnQ7ZjxvJiZoPDY0OysrZikocz10LmNoYXJDb2RlQXQoZikpPDEyOD91W2grK109czpzPDIwNDg/KHVbaCsrXT0xOTJ8cz4+Nix1W2grK109MTI4fDYzJnMpOnM8NTUyOTZ8fHM+PTU3MzQ0Pyh1W2grK109MjI0fHM+PjEyLHVbaCsrXT0xMjh8cz4+NiY2Myx1W2grK109MTI4fDYzJnMpOihzPTY1NTM2KygoMTAyMyZzKTw8MTB8MTAyMyZ0LmNoYXJDb2RlQXQoKytmKSksdVtoKytdPTI0MHxzPj4xOCx1W2grK109MTI4fHM+PjEyJjYzLHVbaCsrXT0xMjh8cz4+NiY2Myx1W2grK109MTI4fDYzJnMpO2Vsc2UgZm9yKGg9dGhpcy5zdGFydDtmPG8mJmg8NjQ7KytmKShzPXQuY2hhckNvZGVBdChmKSk8MTI4P25baD4+Ml18PXM8PHlbMyZoKytdOnM8MjA0OD8obltoPj4yXXw9KDE5MnxzPj42KTw8eVszJmgrK10sbltoPj4yXXw9KDEyOHw2MyZzKTw8eVszJmgrK10pOnM8NTUyOTZ8fHM+PTU3MzQ0PyhuW2g+PjJdfD0oMjI0fHM+PjEyKTw8eVszJmgrK10sbltoPj4yXXw9KDEyOHxzPj42JjYzKTw8eVszJmgrK10sbltoPj4yXXw9KDEyOHw2MyZzKTw8eVszJmgrK10pOihzPTY1NTM2KygoMTAyMyZzKTw8MTB8MTAyMyZ0LmNoYXJDb2RlQXQoKytmKSksbltoPj4yXXw9KDI0MHxzPj4xOCk8PHlbMyZoKytdLG5baD4+Ml18PSgxMjh8cz4+MTImNjMpPDx5WzMmaCsrXSxuW2g+PjJdfD0oMTI4fHM+PjYmNjMpPDx5WzMmaCsrXSxuW2g+PjJdfD0oMTI4fDYzJnMpPDx5WzMmaCsrXSk7dGhpcy5sYXN0Qnl0ZUluZGV4PWgsdGhpcy5ieXRlcys9aC10aGlzLnN0YXJ0LGg+PTY0Pyh0aGlzLnN0YXJ0PWgtNjQsdGhpcy5oYXNoKCksdGhpcy5oYXNoZWQ9ITApOnRoaXMuc3RhcnQ9aH1yZXR1cm4gdGhpcy5ieXRlcz40Mjk0OTY3Mjk1JiYodGhpcy5oQnl0ZXMrPXRoaXMuYnl0ZXMvNDI5NDk2NzI5Njw8MCx0aGlzLmJ5dGVzPXRoaXMuYnl0ZXMlNDI5NDk2NzI5NiksdGhpc319LHQucHJvdG90eXBlLmZpbmFsaXplPWZ1bmN0aW9uKCl7aWYoIXRoaXMuZmluYWxpemVkKXt0aGlzLmZpbmFsaXplZD0hMDt2YXIgdD10aGlzLmJsb2NrcyxyPXRoaXMubGFzdEJ5dGVJbmRleDt0W3I+PjJdfD11WzMmcl0scj49NTYmJih0aGlzLmhhc2hlZHx8dGhpcy5oYXNoKCksdFswXT10WzE2XSx0WzE2XT10WzFdPXRbMl09dFszXT10WzRdPXRbNV09dFs2XT10WzddPXRbOF09dFs5XT10WzEwXT10WzExXT10WzEyXT10WzEzXT10WzE0XT10WzE1XT0wKSx0WzE0XT10aGlzLmJ5dGVzPDwzLHRbMTVdPXRoaXMuaEJ5dGVzPDwzfHRoaXMuYnl0ZXM+Pj4yOSx0aGlzLmhhc2goKX19LHQucHJvdG90eXBlLmhhc2g9ZnVuY3Rpb24oKXt2YXIgdCxyLGUsaSxzLGgsZj10aGlzLmJsb2Nrczt0aGlzLmZpcnN0P3I9KChyPSgodD0oKHQ9ZlswXS02ODA4NzY5MzcpPDw3fHQ+Pj4yNSktMjcxNzMzODc5PDwwKV4oZT0oKGU9KC0yNzE3MzM4NzleKGk9KChpPSgtMTczMjU4NDE5NF4yMDA0MzE4MDcxJnQpK2ZbMV0tMTE3ODMwNzA4KTw8MTJ8aT4+PjIwKSt0PDwwKSYoLTI3MTczMzg3OV50KSkrZlsyXS0xMTI2NDc4Mzc1KTw8MTd8ZT4+PjE1KStpPDwwKSYoaV50KSkrZlszXS0xMzE2MjU5MjA5KTw8MjJ8cj4+PjEwKStlPDwwOih0PXRoaXMuaDAscj10aGlzLmgxLGU9dGhpcy5oMixyPSgocis9KCh0PSgodCs9KChpPXRoaXMuaDMpXnImKGVeaSkpK2ZbMF0tNjgwODc2OTM2KTw8N3x0Pj4+MjUpK3I8PDApXihlPSgoZSs9KHJeKGk9KChpKz0oZV50JihyXmUpKStmWzFdLTM4OTU2NDU4Nik8PDEyfGk+Pj4yMCkrdDw8MCkmKHRecikpK2ZbMl0rNjA2MTA1ODE5KTw8MTd8ZT4+PjE1KStpPDwwKSYoaV50KSkrZlszXS0xMDQ0NTI1MzMwKTw8MjJ8cj4+PjEwKStlPDwwKSxyPSgocis9KCh0PSgodCs9KGleciYoZV5pKSkrZls0XS0xNzY0MTg4OTcpPDw3fHQ+Pj4yNSkrcjw8MCleKGU9KChlKz0ocl4oaT0oKGkrPShlXnQmKHJeZSkpK2ZbNV0rMTIwMDA4MDQyNik8PDEyfGk+Pj4yMCkrdDw8MCkmKHRecikpK2ZbNl0tMTQ3MzIzMTM0MSk8PDE3fGU+Pj4xNSkraTw8MCkmKGledCkpK2ZbN10tNDU3MDU5ODMpPDwyMnxyPj4+MTApK2U8PDAscj0oKHIrPSgodD0oKHQrPShpXnImKGVeaSkpK2ZbOF0rMTc3MDAzNTQxNik8PDd8dD4+PjI1KStyPDwwKV4oZT0oKGUrPShyXihpPSgoaSs9KGVedCYocl5lKSkrZls5XS0xOTU4NDE0NDE3KTw8MTJ8aT4+PjIwKSt0PDwwKSYodF5yKSkrZlsxMF0tNDIwNjMpPDwxN3xlPj4+MTUpK2k8PDApJihpXnQpKStmWzExXS0xOTkwNDA0MTYyKTw8MjJ8cj4+PjEwKStlPDwwLHI9KChyKz0oKHQ9KCh0Kz0oaV5yJihlXmkpKStmWzEyXSsxODA0NjAzNjgyKTw8N3x0Pj4+MjUpK3I8PDApXihlPSgoZSs9KHJeKGk9KChpKz0oZV50JihyXmUpKStmWzEzXS00MDM0MTEwMSk8PDEyfGk+Pj4yMCkrdDw8MCkmKHRecikpK2ZbMTRdLTE1MDIwMDIyOTApPDwxN3xlPj4+MTUpK2k8PDApJihpXnQpKStmWzE1XSsxMjM2NTM1MzI5KTw8MjJ8cj4+PjEwKStlPDwwLHI9KChyKz0oKGk9KChpKz0ocl5lJigodD0oKHQrPShlXmkmKHJeZSkpK2ZbMV0tMTY1Nzk2NTEwKTw8NXx0Pj4+MjcpK3I8PDApXnIpKStmWzZdLTEwNjk1MDE2MzIpPDw5fGk+Pj4yMykrdDw8MCledCYoKGU9KChlKz0odF5yJihpXnQpKStmWzExXSs2NDM3MTc3MTMpPDwxNHxlPj4+MTgpK2k8PDApXmkpKStmWzBdLTM3Mzg5NzMwMik8PDIwfHI+Pj4xMikrZTw8MCxyPSgocis9KChpPSgoaSs9KHJeZSYoKHQ9KCh0Kz0oZV5pJihyXmUpKStmWzVdLTcwMTU1ODY5MSk8PDV8dD4+PjI3KStyPDwwKV5yKSkrZlsxMF0rMzgwMTYwODMpPDw5fGk+Pj4yMykrdDw8MCledCYoKGU9KChlKz0odF5yJihpXnQpKStmWzE1XS02NjA0NzgzMzUpPDwxNHxlPj4+MTgpK2k8PDApXmkpKStmWzRdLTQwNTUzNzg0OCk8PDIwfHI+Pj4xMikrZTw8MCxyPSgocis9KChpPSgoaSs9KHJeZSYoKHQ9KCh0Kz0oZV5pJihyXmUpKStmWzldKzU2ODQ0NjQzOCk8PDV8dD4+PjI3KStyPDwwKV5yKSkrZlsxNF0tMTAxOTgwMzY5MCk8PDl8aT4+PjIzKSt0PDwwKV50JigoZT0oKGUrPSh0XnImKGledCkpK2ZbM10tMTg3MzYzOTYxKTw8MTR8ZT4+PjE4KStpPDwwKV5pKSkrZls4XSsxMTYzNTMxNTAxKTw8MjB8cj4+PjEyKStlPDwwLHI9KChyKz0oKGk9KChpKz0ocl5lJigodD0oKHQrPShlXmkmKHJeZSkpK2ZbMTNdLTE0NDQ2ODE0NjcpPDw1fHQ+Pj4yNykrcjw8MClecikpK2ZbMl0tNTE0MDM3ODQpPDw5fGk+Pj4yMykrdDw8MCledCYoKGU9KChlKz0odF5yJihpXnQpKStmWzddKzE3MzUzMjg0NzMpPDwxNHxlPj4+MTgpK2k8PDApXmkpKStmWzEyXS0xOTI2NjA3NzM0KTw8MjB8cj4+PjEyKStlPDwwLHI9KChyKz0oKGg9KGk9KChpKz0oKHM9cl5lKV4odD0oKHQrPShzXmkpK2ZbNV0tMzc4NTU4KTw8NHx0Pj4+MjgpK3I8PDApKStmWzhdLTIwMjI1NzQ0NjMpPDwxMXxpPj4+MjEpK3Q8PDApXnQpXihlPSgoZSs9KGhecikrZlsxMV0rMTgzOTAzMDU2Mik8PDE2fGU+Pj4xNikraTw8MCkpK2ZbMTRdLTM1MzA5NTU2KTw8MjN8cj4+PjkpK2U8PDAscj0oKHIrPSgoaD0oaT0oKGkrPSgocz1yXmUpXih0PSgodCs9KHNeaSkrZlsxXS0xNTMwOTkyMDYwKTw8NHx0Pj4+MjgpK3I8PDApKStmWzRdKzEyNzI4OTMzNTMpPDwxMXxpPj4+MjEpK3Q8PDApXnQpXihlPSgoZSs9KGhecikrZls3XS0xNTU0OTc2MzIpPDwxNnxlPj4+MTYpK2k8PDApKStmWzEwXS0xMDk0NzMwNjQwKTw8MjN8cj4+PjkpK2U8PDAscj0oKHIrPSgoaD0oaT0oKGkrPSgocz1yXmUpXih0PSgodCs9KHNeaSkrZlsxM10rNjgxMjc5MTc0KTw8NHx0Pj4+MjgpK3I8PDApKStmWzBdLTM1ODUzNzIyMik8PDExfGk+Pj4yMSkrdDw8MCledCleKGU9KChlKz0oaF5yKStmWzNdLTcyMjUyMTk3OSk8PDE2fGU+Pj4xNikraTw8MCkpK2ZbNl0rNzYwMjkxODkpPDwyM3xyPj4+OSkrZTw8MCxyPSgocis9KChoPShpPSgoaSs9KChzPXJeZSleKHQ9KCh0Kz0oc15pKStmWzldLTY0MDM2NDQ4Nyk8PDR8dD4+PjI4KStyPDwwKSkrZlsxMl0tNDIxODE1ODM1KTw8MTF8aT4+PjIxKSt0PDwwKV50KV4oZT0oKGUrPShoXnIpK2ZbMTVdKzUzMDc0MjUyMCk8PDE2fGU+Pj4xNikraTw8MCkpK2ZbMl0tOTk1MzM4NjUxKTw8MjN8cj4+PjkpK2U8PDAscj0oKHIrPSgoaT0oKGkrPShyXigodD0oKHQrPShlXihyfH5pKSkrZlswXS0xOTg2MzA4NDQpPDw2fHQ+Pj4yNikrcjw8MCl8fmUpKStmWzddKzExMjY4OTE0MTUpPDwxMHxpPj4+MjIpK3Q8PDApXigoZT0oKGUrPSh0XihpfH5yKSkrZlsxNF0tMTQxNjM1NDkwNSk8PDE1fGU+Pj4xNykraTw8MCl8fnQpKStmWzVdLTU3NDM0MDU1KTw8MjF8cj4+PjExKStlPDwwLHI9KChyKz0oKGk9KChpKz0ocl4oKHQ9KCh0Kz0oZV4ocnx+aSkpK2ZbMTJdKzE3MDA0ODU1NzEpPDw2fHQ+Pj4yNikrcjw8MCl8fmUpKStmWzNdLTE4OTQ5ODY2MDYpPDwxMHxpPj4+MjIpK3Q8PDApXigoZT0oKGUrPSh0XihpfH5yKSkrZlsxMF0tMTA1MTUyMyk8PDE1fGU+Pj4xNykraTw8MCl8fnQpKStmWzFdLTIwNTQ5MjI3OTkpPDwyMXxyPj4+MTEpK2U8PDAscj0oKHIrPSgoaT0oKGkrPShyXigodD0oKHQrPShlXihyfH5pKSkrZls4XSsxODczMzEzMzU5KTw8Nnx0Pj4+MjYpK3I8PDApfH5lKSkrZlsxNV0tMzA2MTE3NDQpPDwxMHxpPj4+MjIpK3Q8PDApXigoZT0oKGUrPSh0XihpfH5yKSkrZls2XS0xNTYwMTk4MzgwKTw8MTV8ZT4+PjE3KStpPDwwKXx+dCkpK2ZbMTNdKzEzMDkxNTE2NDkpPDwyMXxyPj4+MTEpK2U8PDAscj0oKHIrPSgoaT0oKGkrPShyXigodD0oKHQrPShlXihyfH5pKSkrZls0XS0xNDU1MjMwNzApPDw2fHQ+Pj4yNikrcjw8MCl8fmUpKStmWzExXS0xMTIwMjEwMzc5KTw8MTB8aT4+PjIyKSt0PDwwKV4oKGU9KChlKz0odF4oaXx+cikpK2ZbMl0rNzE4Nzg3MjU5KTw8MTV8ZT4+PjE3KStpPDwwKXx+dCkpK2ZbOV0tMzQzNDg1NTUxKTw8MjF8cj4+PjExKStlPDwwLHRoaXMuZmlyc3Q/KHRoaXMuaDA9dCsxNzMyNTg0MTkzPDwwLHRoaXMuaDE9ci0yNzE3MzM4Nzk8PDAsdGhpcy5oMj1lLTE3MzI1ODQxOTQ8PDAsdGhpcy5oMz1pKzI3MTczMzg3ODw8MCx0aGlzLmZpcnN0PSExKToodGhpcy5oMD10aGlzLmgwK3Q8PDAsdGhpcy5oMT10aGlzLmgxK3I8PDAsdGhpcy5oMj10aGlzLmgyK2U8PDAsdGhpcy5oMz10aGlzLmgzK2k8PDApfSx0LnByb3RvdHlwZS5oZXg9ZnVuY3Rpb24oKXt0aGlzLmZpbmFsaXplKCk7dmFyIHQ9dGhpcy5oMCxyPXRoaXMuaDEsZT10aGlzLmgyLGk9dGhpcy5oMztyZXR1cm4gblt0Pj40JjE1XStuWzE1JnRdK25bdD4+MTImMTVdK25bdD4+OCYxNV0rblt0Pj4yMCYxNV0rblt0Pj4xNiYxNV0rblt0Pj4yOCYxNV0rblt0Pj4yNCYxNV0rbltyPj40JjE1XStuWzE1JnJdK25bcj4+MTImMTVdK25bcj4+OCYxNV0rbltyPj4yMCYxNV0rbltyPj4xNiYxNV0rbltyPj4yOCYxNV0rbltyPj4yNCYxNV0rbltlPj40JjE1XStuWzE1JmVdK25bZT4+MTImMTVdK25bZT4+OCYxNV0rbltlPj4yMCYxNV0rbltlPj4xNiYxNV0rbltlPj4yOCYxNV0rbltlPj4yNCYxNV0rbltpPj40JjE1XStuWzE1JmldK25baT4+MTImMTVdK25baT4+OCYxNV0rbltpPj4yMCYxNV0rbltpPj4xNiYxNV0rbltpPj4yOCYxNV0rbltpPj4yNCYxNV19LHQucHJvdG90eXBlLnRvU3RyaW5nPXQucHJvdG90eXBlLmhleCx0LnByb3RvdHlwZS5kaWdlc3Q9ZnVuY3Rpb24oKXt0aGlzLmZpbmFsaXplKCk7dmFyIHQ9dGhpcy5oMCxyPXRoaXMuaDEsZT10aGlzLmgyLGk9dGhpcy5oMztyZXR1cm5bMjU1JnQsdD4+OCYyNTUsdD4+MTYmMjU1LHQ+PjI0JjI1NSwyNTUmcixyPj44JjI1NSxyPj4xNiYyNTUscj4+MjQmMjU1LDI1NSZlLGU+PjgmMjU1LGU+PjE2JjI1NSxlPj4yNCYyNTUsMjU1JmksaT4+OCYyNTUsaT4+MTYmMjU1LGk+PjI0JjI1NV19LHQucHJvdG90eXBlLmFycmF5PXQucHJvdG90eXBlLmRpZ2VzdCx0LnByb3RvdHlwZS5hcnJheUJ1ZmZlcj1mdW5jdGlvbigpe3RoaXMuZmluYWxpemUoKTt2YXIgdD1uZXcgQXJyYXlCdWZmZXIoMTYpLHI9bmV3IFVpbnQzMkFycmF5KHQpO3JldHVybiByWzBdPXRoaXMuaDAsclsxXT10aGlzLmgxLHJbMl09dGhpcy5oMixyWzNdPXRoaXMuaDMsdH0sdC5wcm90b3R5cGUuYnVmZmVyPXQucHJvdG90eXBlLmFycmF5QnVmZmVyLHQucHJvdG90eXBlLmJhc2U2ND1mdW5jdGlvbigpe2Zvcih2YXIgdCxyLGUsaT0iIixzPXRoaXMuYXJyYXkoKSxoPTA7aDwxNTspdD1zW2grK10scj1zW2grK10sZT1zW2grK10saSs9cFt0Pj4+Ml0rcFs2MyYodDw8NHxyPj4+NCldK3BbNjMmKHI8PDJ8ZT4+PjYpXStwWzYzJmVdO3JldHVybiB0PXNbaF0saSs9cFt0Pj4+Ml0rcFt0PDw0JjYzXSsiPT0ifTt2YXIgXz12KCk7Zj9tb2R1bGUuZXhwb3J0cz1fOihpLm1kNT1fLG8mJmRlZmluZShmdW5jdGlvbigpe3JldHVybiBffSkpfSgpOw=="}]},{"name":"VikACG  ()","options":{"check_for_updates":true,"user_modified":1771401184991,"comment":null,"compatopts_for_requires":true,"compat_wrappedjsobject":false,"compat_metadata":false,"compat_foreach":false,"compat_powerful_this":null,"sandbox":null,"noframes":null,"unwrap":null,"run_at":null,"run_in":null,"tags":[],"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://www.vikacg.com/p/*"],"orig_noframes":null,"orig_run_at":"document-start","orig_run_in":[],"orig_tags":[],"use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]}},"storage":{"ts":1771399389221,"data":{}},"enabled":true,"position":5,"uuid":"5b6bd846-f841-4857-99e3-f8fc8ad2c3f2","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBWaWtBQ0cg6ZO+5o6l5o+Q5Y+W5ZmoICjnu4jmnoHkv67lpI3niYgpCi8vIEBuYW1lc3BhY2UgICAgaHR0cDovL3RhbXBlcm1vbmtleS5uZXQvCi8vIEB2ZXJzaW9uICAgICAgMi45LjAKLy8gQGRlc2NyaXB0aW9uICDmj5Dlj5bmiYDmnInpk77mjqXvvIhjb250ZW50L2hpZGRlbl9jb250ZW50L2Rvd25sb2Fkc++8ie+8jOaUr+aMgSBHRVQg6K+35rGC77yM6Ieq5Yqo6YeN57uY5YiX6KGo77yM5oyJ6ZKu5Y+v6Z2g5Ye6546wCi8vIEBhdXRob3IgICAgICAgLi4uCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly93d3cudmlrYWNnLmNvbS9wLyoKLy8gQHJ1bi1hdCAgICAgICBkb2N1bWVudC1zdGFydAovLyBAcmVxdWlyZSAgICAgIGh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2NyeXB0by1qcy80LjEuMS9jcnlwdG8tanMubWluLmpzCi8vIEBncmFudCAgICAgICAgbm9uZQovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbigpIHsKICAgICd1c2Ugc3RyaWN0JzsKCiAgICAvLyA9PT09PT09PT09IOino+WvhumFjee9riA9PT09PT09PT09CiAgICBjb25zdCBERUNSWVBUX0tFWSA9IENyeXB0b0pTLmVuYy5VdGY4LnBhcnNlKCI3Ujc1UjNKWkUyUFpVVEhIIik7CiAgICBjb25zdCBERUNSWVBUX0lWICA9IENyeXB0b0pTLmVuYy5VdGY4LnBhcnNlKCJYV083Nk5DVlpNMlgxVUNVIik7CgogICAgZnVuY3Rpb24gZGVjcnlwdExpbmsoZW5jcnlwdGVkSGV4KSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgaGV4V29yZEFycmF5ID0gQ3J5cHRvSlMuZW5jLkhleC5wYXJzZShlbmNyeXB0ZWRIZXgpOwogICAgICAgICAgICBjb25zdCBiYXNlNjQgPSBDcnlwdG9KUy5lbmMuQmFzZTY0LnN0cmluZ2lmeShoZXhXb3JkQXJyYXkpOwogICAgICAgICAgICByZXR1cm4gQ3J5cHRvSlMuQUVTLmRlY3J5cHQoYmFzZTY0LCBERUNSWVBUX0tFWSwgewogICAgICAgICAgICAgICAgaXY6IERFQ1JZUFRfSVYsCiAgICAgICAgICAgICAgICBtb2RlOiBDcnlwdG9KUy5tb2RlLkNCQywKICAgICAgICAgICAgICAgIHBhZGRpbmc6IENyeXB0b0pTLnBhZC5Qa2NzNwogICAgICAgICAgICB9KS50b1N0cmluZyhDcnlwdG9KUy5lbmMuVXRmOCk7CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdbVmlrQUNHXSDop6Plr4blpLHotKU6JywgZSk7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tIOWFqOWxgOmTvuaOpembhu+8iOiHquWKqOWOu+mHje+8jOaMieaPkuWFpemhuuW6j++8iS0tLS0tLS0tLS0KICAgIGNvbnN0IGxpbmtTZXQgPSBuZXcgU2V0KCk7CgogICAgLy8gLS0tLS0tLS0tLSDmgqzmta7nqpflhYPntKAgLS0tLS0tLS0tLQogICAgbGV0IGZsb2F0V2luZG93ID0gbnVsbDsKICAgIGxldCBsaW5rQ29udGFpbmVyID0gbnVsbDsKICAgIGxldCBsb2dDb250YWluZXIgPSBudWxsOwogICAgbGV0IGxvZ1Zpc2libGUgPSBmYWxzZTsKCiAgICBmdW5jdGlvbiBjcmVhdGVGbG9hdFdpbmRvdygpIHsKICAgICAgICBpZiAoZmxvYXRXaW5kb3cpIHJldHVybjsKCiAgICAgICAgZmxvYXRXaW5kb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBmbG9hdFdpbmRvdy5pZCA9ICd2aWthY2ctZmxvYXQtd2luZG93JzsKICAgICAgICBmbG9hdFdpbmRvdy5zdHlsZS5jc3NUZXh0ID0gYAogICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICAgICAgICAgIGJvdHRvbTogMjBweDsKICAgICAgICAgICAgcmlnaHQ6IDIwcHg7CiAgICAgICAgICAgIHdpZHRoOiA1MDBweDsKICAgICAgICAgICAgbWF4LXdpZHRoOiA5NXZ3OwogICAgICAgICAgICBtYXgtaGVpZ2h0OiA4MHZoOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMDAwOwogICAgICAgICAgICBjb2xvcjogI2ZmZjsKICAgICAgICAgICAgYm9yZGVyOiAycHggc29saWQgIzQ0NDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogOHB4OwogICAgICAgICAgICBib3gtc2hhZG93OiAwIDRweCAyMHB4IHJnYmEoMCwwLDAsMC43KTsKICAgICAgICAgICAgei1pbmRleDogOTk5OTk5OwogICAgICAgICAgICBmb250LWZhbWlseTogJ1NlZ29lIFVJJywgVGFob21hLCBHZW5ldmEsIFZlcmRhbmEsIHNhbnMtc2VyaWY7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgICAgIHJlc2l6ZTogYm90aDsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgICAgY3Vyc29yOiBkZWZhdWx0OwogICAgICAgICAgICB1c2VyLXNlbGVjdDogdGV4dDsKICAgICAgICBgOwoKICAgICAgICBjb25zdCB0aXRsZUJhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIHRpdGxlQmFyLnN0eWxlLmNzc1RleHQgPSBgCiAgICAgICAgICAgIHBhZGRpbmc6IDhweCAxMnB4OwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMjIyOwogICAgICAgICAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgIzQ0NDsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgICAgY3Vyc29yOiBtb3ZlOwogICAgICAgIGA7CiAgICAgICAgdGl0bGVCYXIuaW5uZXJIVE1MID0gJzxzcGFuPvCfk44g5o+Q5Y+W5Yiw55qE6ZO+5o6lPC9zcGFuPjxzcGFuIHN0eWxlPSJjb2xvcjojODg4OyBmb250LXNpemU6MTJweDsiPijlj6/mi5bliqgpPC9zcGFuPic7CiAgICAgICAgZmxvYXRXaW5kb3cuYXBwZW5kQ2hpbGQodGl0bGVCYXIpOwoKICAgICAgICBsaW5rQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICAgICAgbGlua0NvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gYAogICAgICAgICAgICBwYWRkaW5nOiAxMHB4OwogICAgICAgICAgICBvdmVyZmxvdy15OiBhdXRvOwogICAgICAgICAgICBtYXgtaGVpZ2h0OiAzMDBweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzBhMGEwYTsKICAgICAgICBgOwogICAgICAgIGZsb2F0V2luZG93LmFwcGVuZENoaWxkKGxpbmtDb250YWluZXIpOwoKICAgICAgICBsb2dDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBsb2dDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9IGAKICAgICAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICMzMzM7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICMxMTE7CiAgICAgICAgICAgIGZvbnQtZmFtaWx5OiBtb25vc3BhY2U7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICAgICAgbWF4LWhlaWdodDogMjAwcHg7CiAgICAgICAgICAgIG92ZXJmbG93LXk6IGF1dG87CiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgICAgIHBhZGRpbmc6IDVweDsKICAgICAgICBgOwogICAgICAgIGZsb2F0V2luZG93LmFwcGVuZENoaWxkKGxvZ0NvbnRhaW5lcik7CgogICAgICAgIGNvbnN0IGJ1dHRvbkJhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGJ1dHRvbkJhci5zdHlsZS5jc3NUZXh0ID0gYAogICAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgIzMzMzsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzFhMWExYTsKICAgICAgICBgOwoKICAgICAgICBjb25zdCB0b2dnbGVMb2dCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICB0b2dnbGVMb2dCdG4udGV4dENvbnRlbnQgPSAn8J+TiyDmmL7npLrml6Xlv5cnOwogICAgICAgIHRvZ2dsZUxvZ0J0bi5zdHlsZS5jc3NUZXh0ID0gYAogICAgICAgICAgICBmbGV4OiAxOwogICAgICAgICAgICBiYWNrZ3JvdW5kOiAjMzMzOwogICAgICAgICAgICBjb2xvcjogI2NjYzsKICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgICAgICBwYWRkaW5nOiA2cHg7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICAgIGA7CiAgICAgICAgdG9nZ2xlTG9nQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICBsb2dWaXNpYmxlID0gIWxvZ1Zpc2libGU7CiAgICAgICAgICAgIGxvZ0NvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gbG9nVmlzaWJsZSA/ICdibG9jaycgOiAnbm9uZSc7CiAgICAgICAgICAgIHRvZ2dsZUxvZ0J0bi50ZXh0Q29udGVudCA9IGxvZ1Zpc2libGUgPyAn8J+TiyDpmpDol4/ml6Xlv5cnIDogJ/Cfk4sg5pi+56S65pel5b+XJzsKICAgICAgICB9KTsKCiAgICAgICAgY29uc3QgY2xlYXJCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICBjbGVhckJ0bi50ZXh0Q29udGVudCA9ICfwn5eR77iPIOa4heepuic7CiAgICAgICAgY2xlYXJCdG4uc3R5bGUuY3NzVGV4dCA9IGAKICAgICAgICAgICAgZmxleDogMTsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzMzMzsKICAgICAgICAgICAgY29sb3I6ICNjY2M7CiAgICAgICAgICAgIGJvcmRlcjogbm9uZTsKICAgICAgICAgICAgcGFkZGluZzogNnB4OwogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMTJweDsKICAgICAgICBgOwogICAgICAgIGNsZWFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICBsaW5rU2V0LmNsZWFyKCk7CiAgICAgICAgICAgIHJlbmRlckxpbmtzKCk7CiAgICAgICAgICAgIGFkZExvZygn8J+Xke+4jyDlt7LmuIXnqbrmiYDmnInpk77mjqUnKTsKICAgICAgICB9KTsKCiAgICAgICAgYnV0dG9uQmFyLmFwcGVuZENoaWxkKHRvZ2dsZUxvZ0J0bik7CiAgICAgICAgYnV0dG9uQmFyLmFwcGVuZENoaWxkKGNsZWFyQnRuKTsKICAgICAgICBmbG9hdFdpbmRvdy5hcHBlbmRDaGlsZChidXR0b25CYXIpOwoKICAgICAgICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKICAgICAgICBjbG9zZUJ0bi5pbm5lckhUTUwgPSAn4pyVJzsKICAgICAgICBjbG9zZUJ0bi5zdHlsZS5jc3NUZXh0ID0gYAogICAgICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgICAgIGNvbG9yOiAjYWFhOwogICAgICAgICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiAxMHB4OwogICAgICAgIGA7CiAgICAgICAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICAgICAgICBmbG9hdFdpbmRvdy5zdHlsZS5kaXNwbGF5ID0gZmxvYXRXaW5kb3cuc3R5bGUuZGlzcGxheSA9PT0gJ25vbmUnID8gJ2ZsZXgnIDogJ25vbmUnOwogICAgICAgIH0pOwogICAgICAgIHRpdGxlQmFyLmFwcGVuZENoaWxkKGNsb3NlQnRuKTsKCiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChmbG9hdFdpbmRvdyk7CgogICAgICAgIC8vIOaLluaLvQogICAgICAgIGxldCBvZmZzZXRYLCBvZmZzZXRZOwogICAgICAgIHRpdGxlQmFyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7CiAgICAgICAgICAgIGlmIChlLnRhcmdldCA9PT0gY2xvc2VCdG4pIHJldHVybjsKICAgICAgICAgICAgb2Zmc2V0WCA9IGUuY2xpZW50WCAtIGZsb2F0V2luZG93Lm9mZnNldExlZnQ7CiAgICAgICAgICAgIG9mZnNldFkgPSBlLmNsaWVudFkgLSBmbG9hdFdpbmRvdy5vZmZzZXRUb3A7CiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlKTsKICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VVcCk7CiAgICAgICAgfSk7CgogICAgICAgIGZ1bmN0aW9uIG9uTW91c2VNb3ZlKGUpIHsKICAgICAgICAgICAgZmxvYXRXaW5kb3cuc3R5bGUubGVmdCA9IChlLmNsaWVudFggLSBvZmZzZXRYKSArICdweCc7CiAgICAgICAgICAgIGZsb2F0V2luZG93LnN0eWxlLnRvcCA9IChlLmNsaWVudFkgLSBvZmZzZXRZKSArICdweCc7CiAgICAgICAgICAgIGZsb2F0V2luZG93LnN0eWxlLnJpZ2h0ID0gJ2F1dG8nOwogICAgICAgICAgICBmbG9hdFdpbmRvdy5zdHlsZS5ib3R0b20gPSAnYXV0byc7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBvbk1vdXNlVXAoKSB7CiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIG9uTW91c2VNb3ZlKTsKICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIG9uTW91c2VVcCk7CiAgICAgICAgfQoKICAgICAgICBhZGRMb2coJ+KchSBVSSDliJ3lp4vljJblrozmiJAnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBhZGRMb2cobWVzc2FnZSkgewogICAgICAgIGlmICghbG9nQ29udGFpbmVyKSByZXR1cm47CiAgICAgICAgY29uc3QgbGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIGxpbmUuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW46IDJweCAwOyBjb2xvcjogIzBmMDsnOwogICAgICAgIGxpbmUudGV4dENvbnRlbnQgPSBgWyR7bmV3IERhdGUoKS50b0xvY2FsZVRpbWVTdHJpbmcoKX1dICR7bWVzc2FnZX1gOwogICAgICAgIGxvZ0NvbnRhaW5lci5hcHBlbmRDaGlsZChsaW5lKTsKICAgICAgICBsb2dDb250YWluZXIuc2Nyb2xsVG9wID0gbG9nQ29udGFpbmVyLnNjcm9sbEhlaWdodDsKICAgIH0KCiAgICBmdW5jdGlvbiByZW5kZXJMaW5rcygpIHsKICAgICAgICBpZiAoIWxpbmtDb250YWluZXIpIHJldHVybjsKICAgICAgICBsaW5rQ29udGFpbmVyLmlubmVySFRNTCA9ICcnOwogICAgICAgIGlmIChsaW5rU2V0LnNpemUgPT09IDApIHsKICAgICAgICAgICAgbGlua0NvbnRhaW5lci5pbm5lckhUTUwgPSAnPGRpdiBzdHlsZT0iY29sb3I6Izg4ODsgcGFkZGluZzoxMHB4OyB0ZXh0LWFsaWduOmNlbnRlcjsiPuaaguaXoOmTvuaOpTwvZGl2Pic7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgbGlua1NldC5mb3JFYWNoKGxpbmsgPT4gewogICAgICAgICAgICBjb25zdCBlbnRyeSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgICAgICBlbnRyeS5zdHlsZS5jc3NUZXh0ID0gYAogICAgICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogOHB4OwogICAgICAgICAgICAgICAgcGFkZGluZzogNnB4OwogICAgICAgICAgICAgICAgYmFja2dyb3VuZDogIzExMTsKICAgICAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDRweDsKICAgICAgICAgICAgICAgIHdvcmQtYnJlYWs6IGJyZWFrLWFsbDsKICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgICAgICAgICAgZ2FwOiA4cHg7CiAgICAgICAgICAgIGA7CgogICAgICAgICAgICBjb25zdCBsaW5rRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgICAgIGxpbmtFbC5ocmVmID0gbGluazsKICAgICAgICAgICAgbGlua0VsLnRhcmdldCA9ICdfYmxhbmsnOwogICAgICAgICAgICBsaW5rRWwuc3R5bGUuY3NzVGV4dCA9ICdjb2xvcjogIzRDQUY1MDsgdGV4dC1kZWNvcmF0aW9uOiBub25lOyBmbGV4OjE7IGZvbnQtc2l6ZToxM3B4Oyc7CiAgICAgICAgICAgIGxpbmtFbC50ZXh0Q29udGVudCA9IGxpbms7CgogICAgICAgICAgICBjb25zdCBjb3B5QnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgICAgIGNvcHlCdG4udGV4dENvbnRlbnQgPSAn5aSN5Yi2JzsKICAgICAgICAgICAgY29weUJ0bi5zdHlsZS5jc3NUZXh0ID0gJ3BhZGRpbmc6IDRweCA4cHg7IGJhY2tncm91bmQ6IzRDQUY1MDsgY29sb3I6d2hpdGU7IGJvcmRlcjpub25lOyBib3JkZXItcmFkaXVzOjNweDsgY3Vyc29yOnBvaW50ZXI7IGZvbnQtc2l6ZToxMnB4Oyc7CiAgICAgICAgICAgIGNvcHlCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgICAgICAgICAgICBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChsaW5rKS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICBjb3B5QnRuLnRleHRDb250ZW50ID0gJ+Kckyc7CiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiBjb3B5QnRuLnRleHRDb250ZW50ID0gJ+WkjeWIticsIDE1MDApOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgZW50cnkuYXBwZW5kQ2hpbGQobGlua0VsKTsKICAgICAgICAgICAgZW50cnkuYXBwZW5kQ2hpbGQoY29weUJ0bik7CiAgICAgICAgICAgIGxpbmtDb250YWluZXIuYXBwZW5kQ2hpbGQoZW50cnkpOwogICAgICAgIH0pOwogICAgICAgIGxpbmtDb250YWluZXIuc2Nyb2xsVG9wID0gbGlua0NvbnRhaW5lci5zY3JvbGxIZWlnaHQ7CiAgICB9CgogICAgLy8gLS0tLS0tLS0tLSDmj5Dlj5bpgLvovpEgLS0tLS0tLS0tLQogICAgY29uc3QgdXJsUmVnZXggPSAvaHR0cHM/OlwvXC9bXlxzPD4ie318XFxeYFtcXV0rL2k7CiAgICBjb25zdCBlUGFyYW1SZWdleCA9IC9bPyZdZT0oW14mXSspLzsKCiAgICBmdW5jdGlvbiBwcm9jZXNzUmF3VXJsKHJhd1VybCkgewogICAgICAgIGFkZExvZyhgICDlpITnkIZVUkw6ICR7cmF3VXJsfWApOwoKICAgICAgICBsZXQgZmluYWxVcmwgPSByYXdVcmw7CiAgICAgICAgY29uc3QgbWF0Y2ggPSByYXdVcmwubWF0Y2goZVBhcmFtUmVnZXgpOwogICAgICAgIGlmIChtYXRjaCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgdXJsT2JqID0gbmV3IFVSTChyYXdVcmwpOwogICAgICAgICAgICAgICAgaWYgKHVybE9iai5ob3N0bmFtZSA9PT0gJ3d3dy52aWthY2cuY29tJyB8fCB1cmxPYmouaG9zdG5hbWUuZW5kc1dpdGgoJy52aWthY2cuY29tJykpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmNyeXB0ZWQgPSBtYXRjaFsxXTsKICAgICAgICAgICAgICAgICAgICBhZGRMb2coYCAg5Yqg5a+G5Y+C5pWwIGU9JHtlbmNyeXB0ZWR9ICjmnKznq5npk77mjqUpYCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVjcnlwdGVkID0gZGVjcnlwdExpbmsoZW5jcnlwdGVkKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZGVjcnlwdGVkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFkZExvZyhgICDinIUg6Kej5a+G5oiQ5YqfOiAke2RlY3J5cHRlZH1gKTsKICAgICAgICAgICAgICAgICAgICAgICAgZmluYWxVcmwgPSBkZWNyeXB0ZWQ7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWRkTG9nKGAgIOKdjCDop6Plr4blpLHotKXvvIzkv53nlZnljp/lp4vpk77mjqVgKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGFkZExvZyhgICDlpJbpg6jpk77mjqXvvIzkuI3lsJ3or5Xop6Plr4ZgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgICAgYWRkTG9nKGAgIOKaoO+4jyBVUkzop6PmnpDlpLHotKXvvIzkuI3lsJ3or5Xop6Plr4ZgKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFkZExvZyhgICDmma7pgJrpk77mjqXvvIzml6DpnIDop6Plr4ZgKTsKICAgICAgICB9CgogICAgICAgIGlmICghbGlua1NldC5oYXMoZmluYWxVcmwpKSB7CiAgICAgICAgICAgIGxpbmtTZXQuYWRkKGZpbmFsVXJsKTsKICAgICAgICAgICAgYWRkTG9nKGAgIOKelSDmt7vliqDliLDliJfooahgKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhZGRMb2coYCAg4o+t77iPIOmTvuaOpeW3suWtmOWcqO+8jOi3s+i/h2ApOwogICAgICAgIH0KICAgICAgICAvLyDms6jmhI/vvJrov5nph4zkuI3nm7TmjqXosIPnlKggcmVuZGVyTGlua3PvvIzogIzmmK/lnKjmibnph4/lpITnkIblrozlkI7nu5/kuIDosIPnlKgKICAgIH0KCiAgICBmdW5jdGlvbiBleHRyYWN0TGlua3NGcm9tSFRNTChodG1sLCBzb3VyY2VIaW50ID0gJycpIHsKICAgICAgICBpZiAoIWh0bWwpIHJldHVybjsKICAgICAgICBhZGRMb2coYPCfk6Ug5q2j5Zyo6Kej5p6QIEhUTUwgKOadpea6kDogJHtzb3VyY2VIaW50fSnvvIzplb/luqYgJHtodG1sLmxlbmd0aH1gKTsKICAgICAgICBjb25zdCBwYXJzZXIgPSBuZXcgRE9NUGFyc2VyKCk7CiAgICAgICAgY29uc3QgZG9jID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhodG1sLCAndGV4dC9odG1sJyk7CgogICAgICAgIC8vIDEuIOS7juaWh+acrOiKgueCueaPkOWPlgogICAgICAgIGNvbnN0IHdhbGtlciA9IGRvY3VtZW50LmNyZWF0ZVRyZWVXYWxrZXIoZG9jLmJvZHksIE5vZGVGaWx0ZXIuU0hPV19URVhULCBudWxsKTsKICAgICAgICBsZXQgbm9kZTsKICAgICAgICBsZXQgdGV4dENvdW50ID0gMDsKICAgICAgICB3aGlsZSAobm9kZSA9IHdhbGtlci5uZXh0Tm9kZSgpKSB7CiAgICAgICAgICAgIGNvbnN0IHRleHQgPSBub2RlLm5vZGVWYWx1ZTsKICAgICAgICAgICAgdGV4dENvdW50Kys7CiAgICAgICAgICAgIGNvbnN0IHVybHMgPSB0ZXh0Lm1hdGNoKG5ldyBSZWdFeHAodXJsUmVnZXguc291cmNlLCAnZ2knKSk7CiAgICAgICAgICAgIGlmICh1cmxzKSB7CiAgICAgICAgICAgICAgICBhZGRMb2coYOaWh+acrOiKgueCuSAke3RleHRDb3VudH06ICIke3RleHQuc3Vic3RyaW5nKDAsIDUwKX0ke3RleHQubGVuZ3RoPjUwPycuLi4nOicnfSJgKTsKICAgICAgICAgICAgICAgIHVybHMuZm9yRWFjaChyYXdVcmwgPT4gcHJvY2Vzc1Jhd1VybChyYXdVcmwpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gMi4g5LuO5omA5pyJ5YWD57Sg55qE5bGe5oCn5Lit5o+Q5Y+WIFVSTAogICAgICAgIGxldCBhdHRyQ291bnQgPSAwOwogICAgICAgIGNvbnN0IGFsbEVsZW1lbnRzID0gZG9jLmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJyonKTsKICAgICAgICBmb3IgKGxldCBlbCBvZiBhbGxFbGVtZW50cykgewogICAgICAgICAgICBmb3IgKGxldCBhdHRyIG9mIGVsLmF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gYXR0ci52YWx1ZTsKICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXJscyA9IHZhbHVlLm1hdGNoKG5ldyBSZWdFeHAodXJsUmVnZXguc291cmNlLCAnZ2knKSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVybHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgYXR0ckNvdW50ICs9IHVybHMubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICB1cmxzLmZvckVhY2godXJsID0+IHByb2Nlc3NSYXdVcmwodXJsKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGFkZExvZyhg4pyFIOWujOaIkOino+aekO+8jOWFseWkhOeQhiAke3RleHRDb3VudH0g5Liq5paH5pys6IqC54K577yM5qOA5p+lICR7YXR0ckNvdW50fSDkuKrlsZ7mgKflgLxgKTsKICAgIH0KCiAgICBmdW5jdGlvbiBwcm9jZXNzQ29udGVudChkYXRhLCBzb3VyY2UpIHsKICAgICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgIGV4dHJhY3RMaW5rc0Zyb21IVE1MKGRhdGEsIHNvdXJjZSk7CiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGRhdGEpKSB7CiAgICAgICAgICAgIGFkZExvZyhg8J+TpiDlpITnkIbmlbDnu4TvvIzplb/luqYgJHtkYXRhLmxlbmd0aH1gKTsKICAgICAgICAgICAgZGF0YS5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4gcHJvY2Vzc0NvbnRlbnQoaXRlbSwgYCR7c291cmNlfVske2luZGV4fV1gKSk7CiAgICAgICAgfSBlbHNlIGlmIChkYXRhICYmIHR5cGVvZiBkYXRhID09PSAnb2JqZWN0JykgewogICAgICAgICAgICBhZGRMb2coYPCfk6Yg5aSE55CG5a+56LGh77yM6ZSuOiAke09iamVjdC5rZXlzKGRhdGEpLmpvaW4oJywgJyl9YCk7CiAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKGRhdGEpLmZvckVhY2goKFtrZXksIHZhbF0pID0+IHByb2Nlc3NDb250ZW50KHZhbCwgYCR7c291cmNlfS4ke2tleX1gKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIC0tLS0tLS0tLS0g57uf5LiA55qE5ZON5bqU5aSE55CG5Ye95pWwIC0tLS0tLS0tLS0KICAgIGZ1bmN0aW9uIGhhbmRsZVJlc3BvbnNlKHJlc3BvbnNlVGV4dCwgdXJsKSB7CiAgICAgICAgYWRkTG9nKGDwn4yQIOaLpuaIquWIsOivt+axgjogJHt1cmx9YCk7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IEpTT04ucGFyc2UocmVzcG9uc2VUZXh0KTsKICAgICAgICAgICAgYWRkTG9nKGDwn5OKIOWTjeW6lOeKtuaAgeeggTogJHtkYXRhLmNvZGV9LCBtZXNzYWdlOiAke2RhdGEubWVzc2FnZX1gKTsKICAgICAgICAgICAgaWYgKGRhdGEuY29kZSA9PT0gMjAwICYmIGRhdGEuZGF0YSkgewogICAgICAgICAgICAgICAgYWRkTG9nKGDwn5OEIOW8gOWni+WkhOeQhiBkYXRhLmNvbnRlbnRgKTsKICAgICAgICAgICAgICAgIHByb2Nlc3NDb250ZW50KGRhdGEuZGF0YS5jb250ZW50LCAnY29udGVudCcpOwogICAgICAgICAgICAgICAgaWYgKGRhdGEuZGF0YS5oaWRkZW5fY29udGVudCkgewogICAgICAgICAgICAgICAgICAgIGFkZExvZyhg8J+UkiDlj5HnjrAgaGlkZGVuX2NvbnRlbnRgKTsKICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5kYXRhLmhpZGRlbl9jb250ZW50LmxvY2tlZCkgewogICAgICAgICAgICAgICAgICAgICAgICBhZGRMb2coYPCflJIgaGlkZGVuX2NvbnRlbnQg6KKr6ZSB5a6a77yM5Y+v6IO96ZyA6KaB6K+E6K665ZCO5Yi35pawYCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHByb2Nlc3NDb250ZW50KGRhdGEuZGF0YS5oaWRkZW5fY29udGVudC5jb250ZW50LCAnaGlkZGVuX2NvbnRlbnQnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChkYXRhLmRhdGEuZG93bmxvYWRzKSB7CiAgICAgICAgICAgICAgICAgICAgYWRkTG9nKGDwn5OmIOWkhOeQhiBkb3dubG9hZHNgKTsKICAgICAgICAgICAgICAgICAgICBwcm9jZXNzQ29udGVudChkYXRhLmRhdGEuZG93bmxvYWRzLCAnZG93bmxvYWRzJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhZGRMb2coYOKaoO+4jyDlk43lupTlvILluLg6IGNvZGU9JHtkYXRhLmNvZGV9YCk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgIGFkZExvZyhg4p2MIOino+aekOWTjeW6lOWksei0pTogJHtlLm1lc3NhZ2V9YCk7CiAgICAgICAgfQogICAgICAgIC8vIOaXoOiuuuaYr+WQpuacieaWsOmTvuaOpe+8jOmDveWIt+aWsOaYvuekugogICAgICAgIHJlbmRlckxpbmtzKCk7CiAgICB9CgogICAgLy8gLS0tLS0tLS0tLSBIb29rIFhNTEh0dHBSZXF1ZXN0IC0tLS0tLS0tLS0KICAgIGNvbnN0IG9yaWdPcGVuID0gWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLm9wZW47CiAgICBYTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uKG1ldGhvZCwgdXJsKSB7CiAgICAgICAgdGhpcy5fdXJsID0gdXJsOwogICAgICAgIHJldHVybiBvcmlnT3Blbi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgfTsKCiAgICBjb25zdCBvcmlnU2VuZCA9IFhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5zZW5kOwogICAgWE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnNlbmQgPSBmdW5jdGlvbihib2R5KSB7CiAgICAgICAgY29uc3QgeGhyID0gdGhpczsKICAgICAgICBjb25zdCBvcmlnT25yZWFkeXN0YXRlY2hhbmdlID0geGhyLm9ucmVhZHlzdGF0ZWNoYW5nZTsKCiAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDQgJiYgeGhyLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICBpZiAoeGhyLl91cmwgJiYgKHhoci5fdXJsLmluY2x1ZGVzKCcvZ2V0UG9zdCcpIHx8IHhoci5fdXJsLmluY2x1ZGVzKCcvZ2V0UG9zdEhpZGRlbkNvbnRlbnQnKSkpIHsKICAgICAgICAgICAgICAgICAgICBoYW5kbGVSZXNwb25zZSh4aHIucmVzcG9uc2VUZXh0LCB4aHIuX3VybCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKG9yaWdPbnJlYWR5c3RhdGVjaGFuZ2UpIG9yaWdPbnJlYWR5c3RhdGVjaGFuZ2UuYXBwbHkoeGhyLCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgICAgcmV0dXJuIG9yaWdTZW5kLmFwcGx5KHhociwgYXJndW1lbnRzKTsKICAgIH07CgogICAgLy8gLS0tLS0tLS0tLSBIb29rIGZldGNoIC0tLS0tLS0tLS0KICAgIGNvbnN0IG9yaWdpbmFsRmV0Y2ggPSB3aW5kb3cuZmV0Y2g7CiAgICB3aW5kb3cuZmV0Y2ggPSBmdW5jdGlvbihpbnB1dCwgaW5pdCkgewogICAgICAgIGNvbnN0IHVybCA9IHR5cGVvZiBpbnB1dCA9PT0gJ3N0cmluZycgPyBpbnB1dCA6IGlucHV0LnVybDsKICAgICAgICByZXR1cm4gb3JpZ2luYWxGZXRjaC5jYWxsKHRoaXMsIGlucHV0LCBpbml0KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICAgICAgaWYgKHVybCAmJiAodXJsLmluY2x1ZGVzKCcvZ2V0UG9zdCcpIHx8IHVybC5pbmNsdWRlcygnL2dldFBvc3RIaWRkZW5Db250ZW50JykpKSB7CiAgICAgICAgICAgICAgICByZXNwb25zZS5jbG9uZSgpLnRleHQoKS50aGVuKHRleHQgPT4gaGFuZGxlUmVzcG9uc2UodGV4dCwgdXJsKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgICAgIH0pOwogICAgfTsKCiAgICAvLyAtLS0tLS0tLS0tIOaJi+WKqOaPkOWPluaMiemSru+8iEdFVCDmlrnlvI/vvIktLS0tLS0tLS0tCiAgICBmdW5jdGlvbiBhZGRNYW51YWxGZXRjaEJ1dHRvbigpIHsKICAgICAgICBjb25zdCBidG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICBidG4udGV4dENvbnRlbnQgPSAn4pyLIOaJi+WKqOaPkOWPliAoR0VUKSc7CiAgICAgICAgYnRuLnN0eWxlLmNzc1RleHQgPSBgCiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgICAgICAgICAgdG9wOiAxODBweDsKICAgICAgICAgICAgcmlnaHQ6IDIwcHg7CiAgICAgICAgICAgIHotaW5kZXg6IDEwMDAwMDA7CiAgICAgICAgICAgIHBhZGRpbmc6IDEwcHggMTZweDsKICAgICAgICAgICAgYmFja2dyb3VuZDogIzljMjdiMDsKICAgICAgICAgICAgY29sb3I6IHdoaXRlOwogICAgICAgICAgICBib3JkZXI6IG5vbmU7CiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDVweDsKICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgICAgICAgYm94LXNoYWRvdzogMCAycHggNXB4IHJnYmEoMCwwLDAsMC4zKTsKICAgICAgICBgOwogICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHsKICAgICAgICAgICAgY29uc3QgcG9zdElkID0gbG9jYXRpb24ucGF0aG5hbWUubWF0Y2goL1wvcFwvKFxkKykvKT8uWzFdOwogICAgICAgICAgICBpZiAoIXBvc3RJZCkgewogICAgICAgICAgICAgICAgYWRkTG9nKCfinYwg5peg5rOV5LuOVVJM5o+Q5Y+W5biW5a2QSUQnKTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBhcGlVcmwgPSBgaHR0cHM6Ly93d3cudmlrYWNnLmNvbS9hcGkvdmlrYWNnL3YxL2dldFBvc3Q/aWQ9JHtwb3N0SWR9YDsKICAgICAgICAgICAgYWRkTG9nKGDwn5SNIOaJi+WKqEdFVOivt+axgjogJHthcGlVcmx9YCk7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGFwaVVybCwgewogICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICAnYWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKicsCiAgICAgICAgICAgICAgICAgICAgICAgICd4LWNsaWVudC1uYW1lJzogJ1Zpa0FDRyBNb29ubGlnaHQnCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBjcmVkZW50aWFsczogJ2luY2x1ZGUnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7CiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uub2spIHsKICAgICAgICAgICAgICAgICAgICBhZGRMb2coYOKchSDor7fmsYLmiJDlip/vvIxIVFRQICR7cmVzcG9uc2Uuc3RhdHVzfWApOwogICAgICAgICAgICAgICAgICAgIGhhbmRsZVJlc3BvbnNlKHRleHQsIGFwaVVybCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGFkZExvZyhg4p2MIOivt+axguWksei0pe+8jEhUVFAgJHtyZXNwb25zZS5zdGF0dXN9YCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgYWRkTG9nKGDinYwg6K+35rGC5byC5bi4OiAke2Vyci5tZXNzYWdlfWApOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChidG4pOwogICAgICAgIGFkZExvZygn4p6VIOaJi+WKqOaPkOWPluaMiemSruW3sua3u+WKoCcpOwogICAgfQoKICAgIC8vIC0tLS0tLS0tLS0g5Yi35paw6aG16Z2i5oyJ6ZKuIC0tLS0tLS0tLS0KICAgIGZ1bmN0aW9uIGFkZFJlZnJlc2hCdXR0b24oKSB7CiAgICAgICAgY29uc3QgYnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICAgICAgYnRuLnRleHRDb250ZW50ID0gJ/CflIQg5Yi35paw6aG16Z2iJzsKICAgICAgICBidG4uc3R5bGUuY3NzVGV4dCA9IGAKICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkOwogICAgICAgICAgICB0b3A6IDgwcHg7CiAgICAgICAgICAgIHJpZ2h0OiAyMHB4OwogICAgICAgICAgICB6LWluZGV4OiAxMDAwMDAwOwogICAgICAgICAgICBwYWRkaW5nOiAxMHB4IDE2cHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmZjk4MDA7CiAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTsKICAgICAgICAgICAgYm9yZGVyOiBub25lOwogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1cHg7CiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgICAgICAgZm9udC13ZWlnaHQ6IGJvbGQ7CiAgICAgICAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDVweCByZ2JhKDAsMCwwLDAuMyk7CiAgICAgICAgYDsKICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBsb2NhdGlvbi5yZWxvYWQoKSk7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChidG4pOwogICAgICAgIGFkZExvZygn4p6VIOWIt+aWsOaMiemSruW3sua3u+WKoCcpOwogICAgfQoKICAgIC8vIC0tLS0tLS0tLS0g56Gu5L+d5oyJ6ZKu6KKr5o+S5YWl77yI55uR5ZCsIGJvZHnvvIktLS0tLS0tLS0tCiAgICBmdW5jdGlvbiBlbnN1cmVCdXR0b25zKCkgewogICAgICAgIGlmIChkb2N1bWVudC5ib2R5KSB7CiAgICAgICAgICAgIGNyZWF0ZUZsb2F0V2luZG93KCk7CiAgICAgICAgICAgIGFkZFJlZnJlc2hCdXR0b24oKTsKICAgICAgICAgICAgYWRkTWFudWFsRmV0Y2hCdXR0b24oKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDlpoLmnpwgYm9keSDov5jkuI3lrZjlnKjvvIznrYnlvoUKICAgICAgICAgICAgY29uc3Qgb2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoZG9jdW1lbnQuYm9keSkgewogICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmRpc2Nvbm5lY3QoKTsKICAgICAgICAgICAgICAgICAgICBjcmVhdGVGbG9hdFdpbmRvdygpOwogICAgICAgICAgICAgICAgICAgIGFkZFJlZnJlc2hCdXR0b24oKTsKICAgICAgICAgICAgICAgICAgICBhZGRNYW51YWxGZXRjaEJ1dHRvbigpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgb2JzZXJ2ZXIub2JzZXJ2ZShkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsIHsgY2hpbGRMaXN0OiB0cnVlLCBzdWJ0cmVlOiB0cnVlIH0pOwogICAgICAgIH0KICAgIH0KCiAgICAvLyAtLS0tLS0tLS0tIOWQr+WKqCAtLS0tLS0tLS0tCiAgICBlbnN1cmVCdXR0b25zKCk7CiAgICBhZGRMb2coJ/CfmoAg6ISa5pys5ZCv5Yqo77yM562J5b6F5oum5oiq6K+35rGCLi4uJyk7Cn0pKCk7","requires":[{"meta":{"name":"crypto-js.min.js","url":"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js","ts":1771401185223,"mimetype":"text/javascript"},"source":"IWZ1bmN0aW9uKHQsZSl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzP21vZHVsZS5leHBvcnRzPWV4cG9ydHM9ZSgpOiJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFtdLGUpOnQuQ3J5cHRvSlM9ZSgpfSh0aGlzLGZ1bmN0aW9uKCl7dmFyIG4sbyxzLGEsaCx0LGUsbCxyLGksYyxmLGQsdSxwLFMseCxiLEEsSCx6LF8sdixnLHksQix3LGssbSxDLEQsRSxSLE0sRixQLFcsTyxJLFU9VXx8ZnVuY3Rpb24oaCl7dmFyIGk7aWYoInVuZGVmaW5lZCIhPXR5cGVvZiB3aW5kb3cmJndpbmRvdy5jcnlwdG8mJihpPXdpbmRvdy5jcnlwdG8pLCJ1bmRlZmluZWQiIT10eXBlb2Ygc2VsZiYmc2VsZi5jcnlwdG8mJihpPXNlbGYuY3J5cHRvKSwhKGk9IShpPSEoaT0idW5kZWZpbmVkIiE9dHlwZW9mIGdsb2JhbFRoaXMmJmdsb2JhbFRoaXMuY3J5cHRvP2dsb2JhbFRoaXMuY3J5cHRvOmkpJiYidW5kZWZpbmVkIiE9dHlwZW9mIHdpbmRvdyYmd2luZG93Lm1zQ3J5cHRvP3dpbmRvdy5tc0NyeXB0bzppKSYmInVuZGVmaW5lZCIhPXR5cGVvZiBnbG9iYWwmJmdsb2JhbC5jcnlwdG8/Z2xvYmFsLmNyeXB0bzppKSYmImZ1bmN0aW9uIj09dHlwZW9mIHJlcXVpcmUpdHJ5e2k9cmVxdWlyZSgiY3J5cHRvIil9Y2F0Y2godCl7fXZhciByPU9iamVjdC5jcmVhdGV8fGZ1bmN0aW9uKHQpe3JldHVybiBlLnByb3RvdHlwZT10LHQ9bmV3IGUsZS5wcm90b3R5cGU9bnVsbCx0fTtmdW5jdGlvbiBlKCl7fXZhciB0PXt9LG49dC5saWI9e30sbz1uLkJhc2U9e2V4dGVuZDpmdW5jdGlvbih0KXt2YXIgZT1yKHRoaXMpO3JldHVybiB0JiZlLm1peEluKHQpLGUuaGFzT3duUHJvcGVydHkoImluaXQiKSYmdGhpcy5pbml0IT09ZS5pbml0fHwoZS5pbml0PWZ1bmN0aW9uKCl7ZS4kc3VwZXIuaW5pdC5hcHBseSh0aGlzLGFyZ3VtZW50cyl9KSwoZS5pbml0LnByb3RvdHlwZT1lKS4kc3VwZXI9dGhpcyxlfSxjcmVhdGU6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLmV4dGVuZCgpO3JldHVybiB0LmluaXQuYXBwbHkodCxhcmd1bWVudHMpLHR9LGluaXQ6ZnVuY3Rpb24oKXt9LG1peEluOmZ1bmN0aW9uKHQpe2Zvcih2YXIgZSBpbiB0KXQuaGFzT3duUHJvcGVydHkoZSkmJih0aGlzW2VdPXRbZV0pO3QuaGFzT3duUHJvcGVydHkoInRvU3RyaW5nIikmJih0aGlzLnRvU3RyaW5nPXQudG9TdHJpbmcpfSxjbG9uZTpmdW5jdGlvbigpe3JldHVybiB0aGlzLmluaXQucHJvdG90eXBlLmV4dGVuZCh0aGlzKX19LGw9bi5Xb3JkQXJyYXk9by5leHRlbmQoe2luaXQ6ZnVuY3Rpb24odCxlKXt0PXRoaXMud29yZHM9dHx8W10sdGhpcy5zaWdCeXRlcz1udWxsIT1lP2U6NCp0Lmxlbmd0aH0sdG9TdHJpbmc6ZnVuY3Rpb24odCl7cmV0dXJuKHR8fGMpLnN0cmluZ2lmeSh0aGlzKX0sY29uY2F0OmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMud29yZHMscj10LndvcmRzLGk9dGhpcy5zaWdCeXRlcyxuPXQuc2lnQnl0ZXM7aWYodGhpcy5jbGFtcCgpLGklNClmb3IodmFyIG89MDtvPG47bysrKXt2YXIgcz1yW28+Pj4yXT4+PjI0LW8lNCo4JjI1NTtlW2krbz4+PjJdfD1zPDwyNC0oaStvKSU0Kjh9ZWxzZSBmb3IodmFyIGM9MDtjPG47Yys9NCllW2krYz4+PjJdPXJbYz4+PjJdO3JldHVybiB0aGlzLnNpZ0J5dGVzKz1uLHRoaXN9LGNsYW1wOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy53b3JkcyxlPXRoaXMuc2lnQnl0ZXM7dFtlPj4+Ml0mPTQyOTQ5NjcyOTU8PDMyLWUlNCo4LHQubGVuZ3RoPWguY2VpbChlLzQpfSxjbG9uZTpmdW5jdGlvbigpe3ZhciB0PW8uY2xvbmUuY2FsbCh0aGlzKTtyZXR1cm4gdC53b3Jkcz10aGlzLndvcmRzLnNsaWNlKDApLHR9LHJhbmRvbTpmdW5jdGlvbih0KXtmb3IodmFyIGU9W10scj0wO3I8dDtyKz00KWUucHVzaChmdW5jdGlvbigpe2lmKGkpe2lmKCJmdW5jdGlvbiI9PXR5cGVvZiBpLmdldFJhbmRvbVZhbHVlcyl0cnl7cmV0dXJuIGkuZ2V0UmFuZG9tVmFsdWVzKG5ldyBVaW50MzJBcnJheSgxKSlbMF19Y2F0Y2godCl7fWlmKCJmdW5jdGlvbiI9PXR5cGVvZiBpLnJhbmRvbUJ5dGVzKXRyeXtyZXR1cm4gaS5yYW5kb21CeXRlcyg0KS5yZWFkSW50MzJMRSgpfWNhdGNoKHQpe319dGhyb3cgbmV3IEVycm9yKCJOYXRpdmUgY3J5cHRvIG1vZHVsZSBjb3VsZCBub3QgYmUgdXNlZCB0byBnZXQgc2VjdXJlIHJhbmRvbSBudW1iZXIuIil9KCkpO3JldHVybiBuZXcgbC5pbml0KGUsdCl9fSkscz10LmVuYz17fSxjPXMuSGV4PXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXQud29yZHMscj10LnNpZ0J5dGVzLGk9W10sbj0wO248cjtuKyspe3ZhciBvPWVbbj4+PjJdPj4+MjQtbiU0KjgmMjU1O2kucHVzaCgobz4+PjQpLnRvU3RyaW5nKDE2KSksaS5wdXNoKCgxNSZvKS50b1N0cmluZygxNikpfXJldHVybiBpLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC5sZW5ndGgscj1bXSxpPTA7aTxlO2krPTIpcltpPj4+M118PXBhcnNlSW50KHQuc3Vic3RyKGksMiksMTYpPDwyNC1pJTgqNDtyZXR1cm4gbmV3IGwuaW5pdChyLGUvMil9fSxhPXMuTGF0aW4xPXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXQud29yZHMscj10LnNpZ0J5dGVzLGk9W10sbj0wO248cjtuKyspe3ZhciBvPWVbbj4+PjJdPj4+MjQtbiU0KjgmMjU1O2kucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKG8pKX1yZXR1cm4gaS5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXQubGVuZ3RoLHI9W10saT0wO2k8ZTtpKyspcltpPj4+Ml18PSgyNTUmdC5jaGFyQ29kZUF0KGkpKTw8MjQtaSU0Kjg7cmV0dXJuIG5ldyBsLmluaXQocixlKX19LGY9cy5VdGY4PXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7dHJ5e3JldHVybiBkZWNvZGVVUklDb21wb25lbnQoZXNjYXBlKGEuc3RyaW5naWZ5KHQpKSl9Y2F0Y2godCl7dGhyb3cgbmV3IEVycm9yKCJNYWxmb3JtZWQgVVRGLTggZGF0YSIpfX0scGFyc2U6ZnVuY3Rpb24odCl7cmV0dXJuIGEucGFyc2UodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHQpKSl9fSxkPW4uQnVmZmVyZWRCbG9ja0FsZ29yaXRobT1vLmV4dGVuZCh7cmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9kYXRhPW5ldyBsLmluaXQsdGhpcy5fbkRhdGFCeXRlcz0wfSxfYXBwZW5kOmZ1bmN0aW9uKHQpeyJzdHJpbmciPT10eXBlb2YgdCYmKHQ9Zi5wYXJzZSh0KSksdGhpcy5fZGF0YS5jb25jYXQodCksdGhpcy5fbkRhdGFCeXRlcys9dC5zaWdCeXRlc30sX3Byb2Nlc3M6ZnVuY3Rpb24odCl7dmFyIGUscj10aGlzLl9kYXRhLGk9ci53b3JkcyxuPXIuc2lnQnl0ZXMsbz10aGlzLmJsb2NrU2l6ZSxzPW4vKDQqbyksYz0ocz10P2guY2VpbChzKTpoLm1heCgoMHxzKS10aGlzLl9taW5CdWZmZXJTaXplLDApKSpvLG49aC5taW4oNCpjLG4pO2lmKGMpe2Zvcih2YXIgYT0wO2E8YzthKz1vKXRoaXMuX2RvUHJvY2Vzc0Jsb2NrKGksYSk7ZT1pLnNwbGljZSgwLGMpLHIuc2lnQnl0ZXMtPW59cmV0dXJuIG5ldyBsLmluaXQoZSxuKX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgdD1vLmNsb25lLmNhbGwodGhpcyk7cmV0dXJuIHQuX2RhdGE9dGhpcy5fZGF0YS5jbG9uZSgpLHR9LF9taW5CdWZmZXJTaXplOjB9KSx1PShuLkhhc2hlcj1kLmV4dGVuZCh7Y2ZnOm8uZXh0ZW5kKCksaW5pdDpmdW5jdGlvbih0KXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQodCksdGhpcy5yZXNldCgpfSxyZXNldDpmdW5jdGlvbigpe2QucmVzZXQuY2FsbCh0aGlzKSx0aGlzLl9kb1Jlc2V0KCl9LHVwZGF0ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5fYXBwZW5kKHQpLHRoaXMuX3Byb2Nlc3MoKSx0aGlzfSxmaW5hbGl6ZTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdGhpcy5fYXBwZW5kKHQpLHRoaXMuX2RvRmluYWxpemUoKX0sYmxvY2tTaXplOjE2LF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24ocil7cmV0dXJuIGZ1bmN0aW9uKHQsZSl7cmV0dXJuIG5ldyByLmluaXQoZSkuZmluYWxpemUodCl9fSxfY3JlYXRlSG1hY0hlbHBlcjpmdW5jdGlvbihyKXtyZXR1cm4gZnVuY3Rpb24odCxlKXtyZXR1cm4gbmV3IHUuSE1BQy5pbml0KHIsZSkuZmluYWxpemUodCl9fX0pLHQuYWxnbz17fSk7cmV0dXJuIHR9KE1hdGgpO2Z1bmN0aW9uIEsodCxlLHIpe3JldHVybiB0JmV8fnQmcn1mdW5jdGlvbiBYKHQsZSxyKXtyZXR1cm4gdCZyfGUmfnJ9ZnVuY3Rpb24gTCh0LGUpe3JldHVybiB0PDxlfHQ+Pj4zMi1lfWZ1bmN0aW9uIGoodCxlLHIsaSl7dmFyIG4sbz10aGlzLl9pdjtvPyhuPW8uc2xpY2UoMCksdGhpcy5faXY9dm9pZCAwKTpuPXRoaXMuX3ByZXZCbG9jayxpLmVuY3J5cHRCbG9jayhuLDApO2Zvcih2YXIgcz0wO3M8cjtzKyspdFtlK3NdXj1uW3NdfWZ1bmN0aW9uIFQodCl7dmFyIGUscixpO3JldHVybiAyNTU9PSh0Pj4yNCYyNTUpPyhyPXQ+PjgmMjU1LGk9MjU1JnQsMjU1PT09KGU9dD4+MTYmMjU1KT8oZT0wLDI1NT09PXI/KHI9MCwyNTU9PT1pP2k9MDorK2kpOisrcik6KytlLHQ9MCx0Kz1lPDwxNix0Kz1yPDw4LHQrPWkpOnQrPTE8PDI0LHR9ZnVuY3Rpb24gTigpe2Zvcih2YXIgdD10aGlzLl9YLGU9dGhpcy5fQyxyPTA7cjw4O3IrKylFW3JdPWVbcl07ZVswXT1lWzBdKzEyOTUzMDc1OTcrdGhpcy5fYnwwLGVbMV09ZVsxXSszNTQ1MDUyMzcxKyhlWzBdPj4+MDxFWzBdPj4+MD8xOjApfDAsZVsyXT1lWzJdKzg4NjI2MzA5MisoZVsxXT4+PjA8RVsxXT4+PjA/MTowKXwwLGVbM109ZVszXSsxMjk1MzA3NTk3KyhlWzJdPj4+MDxFWzJdPj4+MD8xOjApfDAsZVs0XT1lWzRdKzM1NDUwNTIzNzErKGVbM10+Pj4wPEVbM10+Pj4wPzE6MCl8MCxlWzVdPWVbNV0rODg2MjYzMDkyKyhlWzRdPj4+MDxFWzRdPj4+MD8xOjApfDAsZVs2XT1lWzZdKzEyOTUzMDc1OTcrKGVbNV0+Pj4wPEVbNV0+Pj4wPzE6MCl8MCxlWzddPWVbN10rMzU0NTA1MjM3MSsoZVs2XT4+PjA8RVs2XT4+PjA/MTowKXwwLHRoaXMuX2I9ZVs3XT4+PjA8RVs3XT4+PjA/MTowO2ZvcihyPTA7cjw4O3IrKyl7dmFyIGk9dFtyXStlW3JdLG49NjU1MzUmaSxvPWk+Pj4xNjtSW3JdPSgobipuPj4+MTcpK24qbz4+PjE1KStvKm9eKCg0Mjk0OTAxNzYwJmkpKml8MCkrKCg2NTUzNSZpKSppfDApfXRbMF09UlswXSsoUls3XTw8MTZ8Uls3XT4+PjE2KSsoUls2XTw8MTZ8Uls2XT4+PjE2KXwwLHRbMV09UlsxXSsoUlswXTw8OHxSWzBdPj4+MjQpK1JbN118MCx0WzJdPVJbMl0rKFJbMV08PDE2fFJbMV0+Pj4xNikrKFJbMF08PDE2fFJbMF0+Pj4xNil8MCx0WzNdPVJbM10rKFJbMl08PDh8UlsyXT4+PjI0KStSWzFdfDAsdFs0XT1SWzRdKyhSWzNdPDwxNnxSWzNdPj4+MTYpKyhSWzJdPDwxNnxSWzJdPj4+MTYpfDAsdFs1XT1SWzVdKyhSWzRdPDw4fFJbNF0+Pj4yNCkrUlszXXwwLHRbNl09Uls2XSsoUls1XTw8MTZ8Uls1XT4+PjE2KSsoUls0XTw8MTZ8Uls0XT4+PjE2KXwwLHRbN109Uls3XSsoUls2XTw8OHxSWzZdPj4+MjQpK1JbNV18MH1mdW5jdGlvbiBxKCl7Zm9yKHZhciB0PXRoaXMuX1gsZT10aGlzLl9DLHI9MDtyPDg7cisrKU9bcl09ZVtyXTtlWzBdPWVbMF0rMTI5NTMwNzU5Nyt0aGlzLl9ifDAsZVsxXT1lWzFdKzM1NDUwNTIzNzErKGVbMF0+Pj4wPE9bMF0+Pj4wPzE6MCl8MCxlWzJdPWVbMl0rODg2MjYzMDkyKyhlWzFdPj4+MDxPWzFdPj4+MD8xOjApfDAsZVszXT1lWzNdKzEyOTUzMDc1OTcrKGVbMl0+Pj4wPE9bMl0+Pj4wPzE6MCl8MCxlWzRdPWVbNF0rMzU0NTA1MjM3MSsoZVszXT4+PjA8T1szXT4+PjA/MTowKXwwLGVbNV09ZVs1XSs4ODYyNjMwOTIrKGVbNF0+Pj4wPE9bNF0+Pj4wPzE6MCl8MCxlWzZdPWVbNl0rMTI5NTMwNzU5NysoZVs1XT4+PjA8T1s1XT4+PjA/MTowKXwwLGVbN109ZVs3XSszNTQ1MDUyMzcxKyhlWzZdPj4+MDxPWzZdPj4+MD8xOjApfDAsdGhpcy5fYj1lWzddPj4+MDxPWzddPj4+MD8xOjA7Zm9yKHI9MDtyPDg7cisrKXt2YXIgaT10W3JdK2Vbcl0sbj02NTUzNSZpLG89aT4+PjE2O0lbcl09KChuKm4+Pj4xNykrbipvPj4+MTUpK28qb14oKDQyOTQ5MDE3NjAmaSkqaXwwKSsoKDY1NTM1JmkpKml8MCl9dFswXT1JWzBdKyhJWzddPDwxNnxJWzddPj4+MTYpKyhJWzZdPDwxNnxJWzZdPj4+MTYpfDAsdFsxXT1JWzFdKyhJWzBdPDw4fElbMF0+Pj4yNCkrSVs3XXwwLHRbMl09SVsyXSsoSVsxXTw8MTZ8SVsxXT4+PjE2KSsoSVswXTw8MTZ8SVswXT4+PjE2KXwwLHRbM109SVszXSsoSVsyXTw8OHxJWzJdPj4+MjQpK0lbMV18MCx0WzRdPUlbNF0rKElbM108PDE2fElbM10+Pj4xNikrKElbMl08PDE2fElbMl0+Pj4xNil8MCx0WzVdPUlbNV0rKElbNF08PDh8SVs0XT4+PjI0KStJWzNdfDAsdFs2XT1JWzZdKyhJWzVdPDwxNnxJWzVdPj4+MTYpKyhJWzRdPDwxNnxJWzRdPj4+MTYpfDAsdFs3XT1JWzddKyhJWzZdPDw4fElbNl0+Pj4yNCkrSVs1XXwwfXJldHVybiBGPShNPVUpLmxpYixuPUYuQmFzZSxvPUYuV29yZEFycmF5LChNPU0ueDY0PXt9KS5Xb3JkPW4uZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHQsZSl7dGhpcy5oaWdoPXQsdGhpcy5sb3c9ZX19KSxNLldvcmRBcnJheT1uLmV4dGVuZCh7aW5pdDpmdW5jdGlvbih0LGUpe3Q9dGhpcy53b3Jkcz10fHxbXSx0aGlzLnNpZ0J5dGVzPW51bGwhPWU/ZTo4KnQubGVuZ3RofSx0b1gzMjpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLndvcmRzLGU9dC5sZW5ndGgscj1bXSxpPTA7aTxlO2krKyl7dmFyIG49dFtpXTtyLnB1c2gobi5oaWdoKSxyLnB1c2gobi5sb3cpfXJldHVybiBvLmNyZWF0ZShyLHRoaXMuc2lnQnl0ZXMpfSxjbG9uZTpmdW5jdGlvbigpe2Zvcih2YXIgdD1uLmNsb25lLmNhbGwodGhpcyksZT10LndvcmRzPXRoaXMud29yZHMuc2xpY2UoMCkscj1lLmxlbmd0aCxpPTA7aTxyO2krKyllW2ldPWVbaV0uY2xvbmUoKTtyZXR1cm4gdH19KSwiZnVuY3Rpb24iPT10eXBlb2YgQXJyYXlCdWZmZXImJihQPVUubGliLldvcmRBcnJheSxzPVAuaW5pdCwoUC5pbml0PWZ1bmN0aW9uKHQpe2lmKCh0PSh0PXQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcj9uZXcgVWludDhBcnJheSh0KTp0KWluc3RhbmNlb2YgSW50OEFycmF5fHwidW5kZWZpbmVkIiE9dHlwZW9mIFVpbnQ4Q2xhbXBlZEFycmF5JiZ0IGluc3RhbmNlb2YgVWludDhDbGFtcGVkQXJyYXl8fHQgaW5zdGFuY2VvZiBJbnQxNkFycmF5fHx0IGluc3RhbmNlb2YgVWludDE2QXJyYXl8fHQgaW5zdGFuY2VvZiBJbnQzMkFycmF5fHx0IGluc3RhbmNlb2YgVWludDMyQXJyYXl8fHQgaW5zdGFuY2VvZiBGbG9hdDMyQXJyYXl8fHQgaW5zdGFuY2VvZiBGbG9hdDY0QXJyYXk/bmV3IFVpbnQ4QXJyYXkodC5idWZmZXIsdC5ieXRlT2Zmc2V0LHQuYnl0ZUxlbmd0aCk6dClpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpe2Zvcih2YXIgZT10LmJ5dGVMZW5ndGgscj1bXSxpPTA7aTxlO2krKylyW2k+Pj4yXXw9dFtpXTw8MjQtaSU0Kjg7cy5jYWxsKHRoaXMscixlKX1lbHNlIHMuYXBwbHkodGhpcyxhcmd1bWVudHMpfSkucHJvdG90eXBlPVApLGZ1bmN0aW9uKCl7dmFyIHQ9VSxuPXQubGliLldvcmRBcnJheSx0PXQuZW5jO3QuVXRmMTY9dC5VdGYxNkJFPXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXQud29yZHMscj10LnNpZ0J5dGVzLGk9W10sbj0wO248cjtuKz0yKXt2YXIgbz1lW24+Pj4yXT4+PjE2LW4lNCo4JjY1NTM1O2kucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKG8pKX1yZXR1cm4gaS5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXQubGVuZ3RoLHI9W10saT0wO2k8ZTtpKyspcltpPj4+MV18PXQuY2hhckNvZGVBdChpKTw8MTYtaSUyKjE2O3JldHVybiBuLmNyZWF0ZShyLDIqZSl9fTtmdW5jdGlvbiBzKHQpe3JldHVybiB0PDw4JjQyNzgyNTUzNjB8dD4+PjgmMTY3MTE5MzV9dC5VdGYxNkxFPXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXQud29yZHMscj10LnNpZ0J5dGVzLGk9W10sbj0wO248cjtuKz0yKXt2YXIgbz1zKGVbbj4+PjJdPj4+MTYtbiU0KjgmNjU1MzUpO2kucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKG8pKX1yZXR1cm4gaS5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24odCl7Zm9yKHZhciBlPXQubGVuZ3RoLHI9W10saT0wO2k8ZTtpKyspcltpPj4+MV18PXModC5jaGFyQ29kZUF0KGkpPDwxNi1pJTIqMTYpO3JldHVybiBuLmNyZWF0ZShyLDIqZSl9fX0oKSxhPSh3PVUpLmxpYi5Xb3JkQXJyYXksdy5lbmMuQmFzZTY0PXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7dmFyIGU9dC53b3JkcyxyPXQuc2lnQnl0ZXMsaT10aGlzLl9tYXA7dC5jbGFtcCgpO2Zvcih2YXIgbj1bXSxvPTA7bzxyO28rPTMpZm9yKHZhciBzPShlW28+Pj4yXT4+PjI0LW8lNCo4JjI1NSk8PDE2fChlW28rMT4+PjJdPj4+MjQtKG8rMSklNCo4JjI1NSk8PDh8ZVtvKzI+Pj4yXT4+PjI0LShvKzIpJTQqOCYyNTUsYz0wO2M8NCYmbysuNzUqYzxyO2MrKyluLnB1c2goaS5jaGFyQXQocz4+PjYqKDMtYykmNjMpKTt2YXIgYT1pLmNoYXJBdCg2NCk7aWYoYSlmb3IoO24ubGVuZ3RoJTQ7KW4ucHVzaChhKTtyZXR1cm4gbi5qb2luKCIiKX0scGFyc2U6ZnVuY3Rpb24odCl7dmFyIGU9dC5sZW5ndGgscj10aGlzLl9tYXA7aWYoIShpPXRoaXMuX3JldmVyc2VNYXApKWZvcih2YXIgaT10aGlzLl9yZXZlcnNlTWFwPVtdLG49MDtuPHIubGVuZ3RoO24rKylpW3IuY2hhckNvZGVBdChuKV09bjt2YXIgbz1yLmNoYXJBdCg2NCk7cmV0dXJuIW98fC0xIT09KG89dC5pbmRleE9mKG8pKSYmKGU9byksZnVuY3Rpb24odCxlLHIpe2Zvcih2YXIgaT1bXSxuPTAsbz0wO288ZTtvKyspe3ZhciBzLGM7byU0JiYocz1yW3QuY2hhckNvZGVBdChvLTEpXTw8byU0KjIsYz1yW3QuY2hhckNvZGVBdChvKV0+Pj42LW8lNCoyLGM9c3xjLGlbbj4+PjJdfD1jPDwyNC1uJTQqOCxuKyspfXJldHVybiBhLmNyZWF0ZShpLG4pfSh0LGUsaSl9LF9tYXA6IkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89In0saD0oRj1VKS5saWIuV29yZEFycmF5LEYuZW5jLkJhc2U2NHVybD17c3RyaW5naWZ5OmZ1bmN0aW9uKHQsZT0hMCl7dmFyIHI9dC53b3JkcyxpPXQuc2lnQnl0ZXMsbj1lP3RoaXMuX3NhZmVfbWFwOnRoaXMuX21hcDt0LmNsYW1wKCk7Zm9yKHZhciBvPVtdLHM9MDtzPGk7cys9Mylmb3IodmFyIGM9KHJbcz4+PjJdPj4+MjQtcyU0KjgmMjU1KTw8MTZ8KHJbcysxPj4+Ml0+Pj4yNC0ocysxKSU0KjgmMjU1KTw8OHxyW3MrMj4+PjJdPj4+MjQtKHMrMiklNCo4JjI1NSxhPTA7YTw0JiZzKy43NSphPGk7YSsrKW8ucHVzaChuLmNoYXJBdChjPj4+NiooMy1hKSY2MykpO3ZhciBoPW4uY2hhckF0KDY0KTtpZihoKWZvcig7by5sZW5ndGglNDspby5wdXNoKGgpO3JldHVybiBvLmpvaW4oIiIpfSxwYXJzZTpmdW5jdGlvbih0LGU9ITApe3ZhciByPXQubGVuZ3RoLGk9ZT90aGlzLl9zYWZlX21hcDp0aGlzLl9tYXA7aWYoIShuPXRoaXMuX3JldmVyc2VNYXApKWZvcih2YXIgbj10aGlzLl9yZXZlcnNlTWFwPVtdLG89MDtvPGkubGVuZ3RoO28rKyluW2kuY2hhckNvZGVBdChvKV09bztlPWkuY2hhckF0KDY0KTtyZXR1cm4hZXx8LTEhPT0oZT10LmluZGV4T2YoZSkpJiYocj1lKSxmdW5jdGlvbih0LGUscil7Zm9yKHZhciBpPVtdLG49MCxvPTA7bzxlO28rKyl7dmFyIHMsYztvJTQmJihzPXJbdC5jaGFyQ29kZUF0KG8tMSldPDxvJTQqMixjPXJbdC5jaGFyQ29kZUF0KG8pXT4+PjYtbyU0KjIsYz1zfGMsaVtuPj4+Ml18PWM8PDI0LW4lNCo4LG4rKyl9cmV0dXJuIGguY3JlYXRlKGksbil9KHQscixuKX0sX21hcDoiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0iLF9zYWZlX21hcDoiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODktXyJ9LGZ1bmN0aW9uKGEpe3ZhciB0PVUsZT10LmxpYixyPWUuV29yZEFycmF5LGk9ZS5IYXNoZXIsZT10LmFsZ28sQT1bXTshZnVuY3Rpb24oKXtmb3IodmFyIHQ9MDt0PDY0O3QrKylBW3RdPTQyOTQ5NjcyOTYqYS5hYnMoYS5zaW4odCsxKSl8MH0oKTtlPWUuTUQ1PWkuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe3RoaXMuX2hhc2g9bmV3IHIuaW5pdChbMTczMjU4NDE5Myw0MDIzMjMzNDE3LDI1NjIzODMxMDIsMjcxNzMzODc4XSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe2Zvcih2YXIgcj0wO3I8MTY7cisrKXt2YXIgaT1lK3Isbj10W2ldO3RbaV09MTY3MTE5MzUmKG48PDh8bj4+PjI0KXw0Mjc4MjU1MzYwJihuPDwyNHxuPj4+OCl9dmFyIG89dGhpcy5faGFzaC53b3JkcyxzPXRbZSswXSxjPXRbZSsxXSxhPXRbZSsyXSxoPXRbZSszXSxsPXRbZSs0XSxmPXRbZSs1XSxkPXRbZSs2XSx1PXRbZSs3XSxwPXRbZSs4XSxfPXRbZSs5XSx5PXRbZSsxMF0sdj10W2UrMTFdLGc9dFtlKzEyXSxCPXRbZSsxM10sdz10W2UrMTRdLGs9dFtlKzE1XSxtPUgobT1vWzBdLGI9b1sxXSx4PW9bMl0sUz1vWzNdLHMsNyxBWzBdKSxTPUgoUyxtLGIseCxjLDEyLEFbMV0pLHg9SCh4LFMsbSxiLGEsMTcsQVsyXSksYj1IKGIseCxTLG0saCwyMixBWzNdKTttPUgobSxiLHgsUyxsLDcsQVs0XSksUz1IKFMsbSxiLHgsZiwxMixBWzVdKSx4PUgoeCxTLG0sYixkLDE3LEFbNl0pLGI9SChiLHgsUyxtLHUsMjIsQVs3XSksbT1IKG0sYix4LFMscCw3LEFbOF0pLFM9SChTLG0sYix4LF8sMTIsQVs5XSkseD1IKHgsUyxtLGIseSwxNyxBWzEwXSksYj1IKGIseCxTLG0sdiwyMixBWzExXSksbT1IKG0sYix4LFMsZyw3LEFbMTJdKSxTPUgoUyxtLGIseCxCLDEyLEFbMTNdKSx4PUgoeCxTLG0sYix3LDE3LEFbMTRdKSxtPXoobSxiPUgoYix4LFMsbSxrLDIyLEFbMTVdKSx4LFMsYyw1LEFbMTZdKSxTPXooUyxtLGIseCxkLDksQVsxN10pLHg9eih4LFMsbSxiLHYsMTQsQVsxOF0pLGI9eihiLHgsUyxtLHMsMjAsQVsxOV0pLG09eihtLGIseCxTLGYsNSxBWzIwXSksUz16KFMsbSxiLHgseSw5LEFbMjFdKSx4PXooeCxTLG0sYixrLDE0LEFbMjJdKSxiPXooYix4LFMsbSxsLDIwLEFbMjNdKSxtPXoobSxiLHgsUyxfLDUsQVsyNF0pLFM9eihTLG0sYix4LHcsOSxBWzI1XSkseD16KHgsUyxtLGIsaCwxNCxBWzI2XSksYj16KGIseCxTLG0scCwyMCxBWzI3XSksbT16KG0sYix4LFMsQiw1LEFbMjhdKSxTPXooUyxtLGIseCxhLDksQVsyOV0pLHg9eih4LFMsbSxiLHUsMTQsQVszMF0pLG09QyhtLGI9eihiLHgsUyxtLGcsMjAsQVszMV0pLHgsUyxmLDQsQVszMl0pLFM9QyhTLG0sYix4LHAsMTEsQVszM10pLHg9Qyh4LFMsbSxiLHYsMTYsQVszNF0pLGI9QyhiLHgsUyxtLHcsMjMsQVszNV0pLG09QyhtLGIseCxTLGMsNCxBWzM2XSksUz1DKFMsbSxiLHgsbCwxMSxBWzM3XSkseD1DKHgsUyxtLGIsdSwxNixBWzM4XSksYj1DKGIseCxTLG0seSwyMyxBWzM5XSksbT1DKG0sYix4LFMsQiw0LEFbNDBdKSxTPUMoUyxtLGIseCxzLDExLEFbNDFdKSx4PUMoeCxTLG0sYixoLDE2LEFbNDJdKSxiPUMoYix4LFMsbSxkLDIzLEFbNDNdKSxtPUMobSxiLHgsUyxfLDQsQVs0NF0pLFM9QyhTLG0sYix4LGcsMTEsQVs0NV0pLHg9Qyh4LFMsbSxiLGssMTYsQVs0Nl0pLG09RChtLGI9QyhiLHgsUyxtLGEsMjMsQVs0N10pLHgsUyxzLDYsQVs0OF0pLFM9RChTLG0sYix4LHUsMTAsQVs0OV0pLHg9RCh4LFMsbSxiLHcsMTUsQVs1MF0pLGI9RChiLHgsUyxtLGYsMjEsQVs1MV0pLG09RChtLGIseCxTLGcsNixBWzUyXSksUz1EKFMsbSxiLHgsaCwxMCxBWzUzXSkseD1EKHgsUyxtLGIseSwxNSxBWzU0XSksYj1EKGIseCxTLG0sYywyMSxBWzU1XSksbT1EKG0sYix4LFMscCw2LEFbNTZdKSxTPUQoUyxtLGIseCxrLDEwLEFbNTddKSx4PUQoeCxTLG0sYixkLDE1LEFbNThdKSxiPUQoYix4LFMsbSxCLDIxLEFbNTldKSxtPUQobSxiLHgsUyxsLDYsQVs2MF0pLFM9RChTLG0sYix4LHYsMTAsQVs2MV0pLHg9RCh4LFMsbSxiLGEsMTUsQVs2Ml0pLGI9RChiLHgsUyxtLF8sMjEsQVs2M10pLG9bMF09b1swXSttfDAsb1sxXT1vWzFdK2J8MCxvWzJdPW9bMl0reHwwLG9bM109b1szXStTfDB9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZGF0YSxlPXQud29yZHMscj04KnRoaXMuX25EYXRhQnl0ZXMsaT04KnQuc2lnQnl0ZXM7ZVtpPj4+NV18PTEyODw8MjQtaSUzMjt2YXIgbj1hLmZsb29yKHIvNDI5NDk2NzI5Nikscj1yO2VbMTUrKDY0K2k+Pj45PDw0KV09MTY3MTE5MzUmKG48PDh8bj4+PjI0KXw0Mjc4MjU1MzYwJihuPDwyNHxuPj4+OCksZVsxNCsoNjQraT4+Pjk8PDQpXT0xNjcxMTkzNSYocjw8OHxyPj4+MjQpfDQyNzgyNTUzNjAmKHI8PDI0fHI+Pj44KSx0LnNpZ0J5dGVzPTQqKGUubGVuZ3RoKzEpLHRoaXMuX3Byb2Nlc3MoKTtmb3IodmFyIGU9dGhpcy5faGFzaCxvPWUud29yZHMscz0wO3M8NDtzKyspe3ZhciBjPW9bc107b1tzXT0xNjcxMTkzNSYoYzw8OHxjPj4+MjQpfDQyNzgyNTUzNjAmKGM8PDI0fGM+Pj44KX1yZXR1cm4gZX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgdD1pLmNsb25lLmNhbGwodGhpcyk7cmV0dXJuIHQuX2hhc2g9dGhpcy5faGFzaC5jbG9uZSgpLHR9fSk7ZnVuY3Rpb24gSCh0LGUscixpLG4sbyxzKXtzPXQrKGUmcnx+ZSZpKStuK3M7cmV0dXJuKHM8PG98cz4+PjMyLW8pK2V9ZnVuY3Rpb24geih0LGUscixpLG4sbyxzKXtzPXQrKGUmaXxyJn5pKStuK3M7cmV0dXJuKHM8PG98cz4+PjMyLW8pK2V9ZnVuY3Rpb24gQyh0LGUscixpLG4sbyxzKXtzPXQrKGVecl5pKStuK3M7cmV0dXJuKHM8PG98cz4+PjMyLW8pK2V9ZnVuY3Rpb24gRCh0LGUscixpLG4sbyxzKXtzPXQrKHJeKGV8fmkpKStuK3M7cmV0dXJuKHM8PG98cz4+PjMyLW8pK2V9dC5NRDU9aS5fY3JlYXRlSGVscGVyKGUpLHQuSG1hY01ENT1pLl9jcmVhdGVIbWFjSGVscGVyKGUpfShNYXRoKSxQPShNPVUpLmxpYix0PVAuV29yZEFycmF5LGU9UC5IYXNoZXIsUD1NLmFsZ28sbD1bXSxQPVAuU0hBMT1lLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyB0LmluaXQoWzE3MzI1ODQxOTMsNDAyMzIzMzQxNywyNTYyMzgzMTAyLDI3MTczMzg3OCwzMjg1Mzc3NTIwXSl9LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe2Zvcih2YXIgcj10aGlzLl9oYXNoLndvcmRzLGk9clswXSxuPXJbMV0sbz1yWzJdLHM9clszXSxjPXJbNF0sYT0wO2E8ODA7YSsrKXthPDE2P2xbYV09MHx0W2UrYV06KGg9bFthLTNdXmxbYS04XV5sW2EtMTRdXmxbYS0xNl0sbFthXT1oPDwxfGg+Pj4zMSk7dmFyIGg9KGk8PDV8aT4+PjI3KStjK2xbYV07aCs9YTwyMD8xNTE4NTAwMjQ5KyhuJm98fm4mcyk6YTw0MD8xODU5Nzc1MzkzKyhuXm9ecyk6YTw2MD8obiZvfG4mc3xvJnMpLTE4OTQwMDc1ODg6KG5eb15zKS04OTk0OTc1MTQsYz1zLHM9byxvPW48PDMwfG4+Pj4yLG49aSxpPWh9clswXT1yWzBdK2l8MCxyWzFdPXJbMV0rbnwwLHJbMl09clsyXStvfDAsclszXT1yWzNdK3N8MCxyWzRdPXJbNF0rY3wwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2RhdGEsZT10LndvcmRzLHI9OCp0aGlzLl9uRGF0YUJ5dGVzLGk9OCp0LnNpZ0J5dGVzO3JldHVybiBlW2k+Pj41XXw9MTI4PDwyNC1pJTMyLGVbMTQrKDY0K2k+Pj45PDw0KV09TWF0aC5mbG9vcihyLzQyOTQ5NjcyOTYpLGVbMTUrKDY0K2k+Pj45PDw0KV09cix0LnNpZ0J5dGVzPTQqZS5sZW5ndGgsdGhpcy5fcHJvY2VzcygpLHRoaXMuX2hhc2h9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIHQ9ZS5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiB0Ll9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKSx0fX0pLE0uU0hBMT1lLl9jcmVhdGVIZWxwZXIoUCksTS5IbWFjU0hBMT1lLl9jcmVhdGVIbWFjSGVscGVyKFApLGZ1bmN0aW9uKG4pe3ZhciB0PVUsZT10LmxpYixyPWUuV29yZEFycmF5LGk9ZS5IYXNoZXIsZT10LmFsZ28sbz1bXSxwPVtdOyFmdW5jdGlvbigpe2Z1bmN0aW9uIHQodCl7cmV0dXJuIDQyOTQ5NjcyOTYqKHQtKDB8dCkpfDB9Zm9yKHZhciBlPTIscj0wO3I8NjQ7KSFmdW5jdGlvbih0KXtmb3IodmFyIGU9bi5zcXJ0KHQpLHI9MjtyPD1lO3IrKylpZighKHQlcikpcmV0dXJuO3JldHVybiAxfShlKXx8KHI8OCYmKG9bcl09dChuLnBvdyhlLC41KSkpLHBbcl09dChuLnBvdyhlLDEvMykpLHIrKyksZSsrfSgpO3ZhciBfPVtdLGU9ZS5TSEEyNTY9aS5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgci5pbml0KG8uc2xpY2UoMCkpfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9dGhpcy5faGFzaC53b3JkcyxpPXJbMF0sbj1yWzFdLG89clsyXSxzPXJbM10sYz1yWzRdLGE9cls1XSxoPXJbNl0sbD1yWzddLGY9MDtmPDY0O2YrKyl7ZjwxNj9fW2ZdPTB8dFtlK2ZdOihkPV9bZi0xNV0sdT1fW2YtMl0sX1tmXT0oKGQ8PDI1fGQ+Pj43KV4oZDw8MTR8ZD4+PjE4KV5kPj4+MykrX1tmLTddKygodTw8MTV8dT4+PjE3KV4odTw8MTN8dT4+PjE5KV51Pj4+MTApK19bZi0xNl0pO3ZhciBkPWkmbl5pJm9ebiZvLHU9bCsoKGM8PDI2fGM+Pj42KV4oYzw8MjF8Yz4+PjExKV4oYzw8N3xjPj4+MjUpKSsoYyZhXn5jJmgpK3BbZl0rX1tmXSxsPWgsaD1hLGE9YyxjPXMrdXwwLHM9byxvPW4sbj1pLGk9dSsoKChpPDwzMHxpPj4+MileKGk8PDE5fGk+Pj4xMyleKGk8PDEwfGk+Pj4yMikpK2QpfDB9clswXT1yWzBdK2l8MCxyWzFdPXJbMV0rbnwwLHJbMl09clsyXStvfDAsclszXT1yWzNdK3N8MCxyWzRdPXJbNF0rY3wwLHJbNV09cls1XSthfDAscls2XT1yWzZdK2h8MCxyWzddPXJbN10rbHwwfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2RhdGEsZT10LndvcmRzLHI9OCp0aGlzLl9uRGF0YUJ5dGVzLGk9OCp0LnNpZ0J5dGVzO3JldHVybiBlW2k+Pj41XXw9MTI4PDwyNC1pJTMyLGVbMTQrKDY0K2k+Pj45PDw0KV09bi5mbG9vcihyLzQyOTQ5NjcyOTYpLGVbMTUrKDY0K2k+Pj45PDw0KV09cix0LnNpZ0J5dGVzPTQqZS5sZW5ndGgsdGhpcy5fcHJvY2VzcygpLHRoaXMuX2hhc2h9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIHQ9aS5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiB0Ll9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKSx0fX0pO3QuU0hBMjU2PWkuX2NyZWF0ZUhlbHBlcihlKSx0LkhtYWNTSEEyNTY9aS5fY3JlYXRlSG1hY0hlbHBlcihlKX0oTWF0aCkscj0odz1VKS5saWIuV29yZEFycmF5LEY9dy5hbGdvLGk9Ri5TSEEyNTYsRj1GLlNIQTIyND1pLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyByLmluaXQoWzMyMzgzNzEwMzIsOTE0MTUwNjYzLDgxMjcwMjk5OSw0MTQ0OTEyNjk3LDQyOTA3NzU4NTcsMTc1MDYwMzAyNSwxNjk0MDc2ODM5LDMyMDQwNzU0MjhdKX0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgdD1pLl9kb0ZpbmFsaXplLmNhbGwodGhpcyk7cmV0dXJuIHQuc2lnQnl0ZXMtPTQsdH19KSx3LlNIQTIyND1pLl9jcmVhdGVIZWxwZXIoRiksdy5IbWFjU0hBMjI0PWkuX2NyZWF0ZUhtYWNIZWxwZXIoRiksZnVuY3Rpb24oKXt2YXIgdD1VLGU9dC5saWIuSGFzaGVyLHI9dC54NjQsaT1yLldvcmQsbj1yLldvcmRBcnJheSxyPXQuYWxnbztmdW5jdGlvbiBvKCl7cmV0dXJuIGkuY3JlYXRlLmFwcGx5KGksYXJndW1lbnRzKX12YXIgdDE9W28oMTExNjM1MjQwOCwzNjA5NzY3NDU4KSxvKDE4OTk0NDc0NDEsNjAyODkxNzI1KSxvKDMwNDkzMjM0NzEsMzk2NDQ4NDM5OSksbygzOTIxMDA5NTczLDIxNzMyOTU1NDgpLG8oOTYxOTg3MTYzLDQwODE2Mjg0NzIpLG8oMTUwODk3MDk5MywzMDUzODM0MjY1KSxvKDI0NTM2MzU3NDgsMjkzNzY3MTU3OSksbygyODcwNzYzMjIxLDM2NjQ2MDk1NjApLG8oMzYyNDM4MTA4MCwyNzM0ODgzMzk0KSxvKDMxMDU5ODQwMSwxMTY0OTk2NTQyKSxvKDYwNzIyNTI3OCwxMzIzNjEwNzY0KSxvKDE0MjY4ODE5ODcsMzU5MDMwNDk5NCksbygxOTI1MDc4Mzg4LDQwNjgxODIzODMpLG8oMjE2MjA3ODIwNiw5OTEzMzYxMTMpLG8oMjYxNDg4ODEwMyw2MzM4MDMzMTcpLG8oMzI0ODIyMjU4MCwzNDc5Nzc0ODY4KSxvKDM4MzUzOTA0MDEsMjY2NjYxMzQ1OCksbyg0MDIyMjI0Nzc0LDk0NDcxMTEzOSksbygyNjQzNDcwNzgsMjM0MTI2Mjc3Myksbyg2MDQ4MDc2MjgsMjAwNzgwMDkzMyksbyg3NzAyNTU5ODMsMTQ5NTk5MDkwMSksbygxMjQ5MTUwMTIyLDE4NTY0MzEyMzUpLG8oMTU1NTA4MTY5MiwzMTc1MjE4MTMyKSxvKDE5OTYwNjQ5ODYsMjE5ODk1MDgzNyksbygyNTU0MjIwODgyLDM5OTk3MTkzMzkpLG8oMjgyMTgzNDM0OSw3NjY3ODQwMTYpLG8oMjk1Mjk5NjgwOCwyNTY2NTk0ODc5KSxvKDMyMTAzMTM2NzEsMzIwMzMzNzk1NiksbygzMzM2NTcxODkxLDEwMzQ0NTcwMjYpLG8oMzU4NDUyODcxMSwyNDY2OTQ4OTAxKSxvKDExMzkyNjk5MywzNzU4MzI2MzgzKSxvKDMzODI0MTg5NSwxNjg3MTc5MzYpLG8oNjY2MzA3MjA1LDExODgxNzk5NjQpLG8oNzczNTI5OTEyLDE1NDYwNDU3MzQpLG8oMTI5NDc1NzM3MiwxNTIyODA1NDg1KSxvKDEzOTYxODIyOTEsMjY0MzgzMzgyMyksbygxNjk1MTgzNzAwLDIzNDM1MjczOTApLG8oMTk4NjY2MTA1MSwxMDE0NDc3NDgwKSxvKDIxNzcwMjYzNTAsMTIwNjc1OTE0MiksbygyNDU2OTU2MDM3LDM0NDA3NzYyNyksbygyNzMwNDg1OTIxLDEyOTA4NjM0NjApLG8oMjgyMDMwMjQxMSwzMTU4NDU0MjczKSxvKDMyNTk3MzA4MDAsMzUwNTk1MjY1NyksbygzMzQ1NzY0NzcxLDEwNjIxNzAwOCksbygzNTE2MDY1ODE3LDM2MDYwMDgzNDQpLG8oMzYwMDM1MjgwNCwxNDMyNzI1Nzc2KSxvKDQwOTQ1NzE5MDksMTQ2NzAzMTU5NCksbygyNzU0MjMzNDQsODUxMTY5NzIwKSxvKDQzMDIyNzczNCwzMTAwODIzNzUyKSxvKDUwNjk0ODYxNiwxMzYzMjU4MTk1KSxvKDY1OTA2MDU1NiwzNzUwNjg1NTkzKSxvKDg4Mzk5Nzg3NywzNzg1MDUwMjgwKSxvKDk1ODEzOTU3MSwzMzE4MzA3NDI3KSxvKDEzMjI4MjIyMTgsMzgxMjcyMzQwMyksbygxNTM3MDAyMDYzLDIwMDMwMzQ5OTUpLG8oMTc0Nzg3Mzc3OSwzNjAyMDM2ODk5KSxvKDE5NTU1NjIyMjIsMTU3NTk5MDAxMiksbygyMDI0MTA0ODE1LDExMjU1OTI5MjgpLG8oMjIyNzczMDQ1MiwyNzE2OTA0MzA2KSxvKDIzNjE4NTI0MjQsNDQyNzc2MDQ0KSxvKDI0Mjg0MzY0NzQsNTkzNjk4MzQ0KSxvKDI3NTY3MzQxODcsMzczMzExMDI0OSksbygzMjA0MDMxNDc5LDI5OTkzNTE1NzMpLG8oMzMyOTMyNTI5OCwzODE1OTIwNDI3KSxvKDMzOTE1Njk2MTQsMzkyODM4MzkwMCksbygzNTE1MjY3MjcxLDU2NjI4MDcxMSksbygzOTQwMTg3NjA2LDM0NTQwNjk1MzQpLG8oNDExODYzMDI3MSw0MDAwMjM5OTkyKSxvKDExNjQxODQ3NCwxOTE0MTM4NTU0KSxvKDE3NDI5MjQyMSwyNzMxMDU1MjcwKSxvKDI4OTM4MDM1NiwzMjAzOTkzMDA2KSxvKDQ2MDM5MzI2OSwzMjA2MjAzMTUpLG8oNjg1NDcxNzMzLDU4NzQ5NjgzNiksbyg4NTIxNDI5NzEsMTA4Njc5Mjg1MSksbygxMDE3MDM2Mjk4LDM2NTU0MzEwMCksbygxMTI2MDAwNTgwLDI2MTgyOTc2NzYpLG8oMTI4ODAzMzQ3MCwzNDA5ODU1MTU4KSxvKDE1MDE1MDU5NDgsNDIzNDUwOTg2NiksbygxNjA3MTY3OTE1LDk4NzE2NzQ2OCksbygxODE2NDAyMzE2LDEyNDYxODk1OTEpXSxlMT1bXTshZnVuY3Rpb24oKXtmb3IodmFyIHQ9MDt0PDgwO3QrKyllMVt0XT1vKCl9KCk7cj1yLlNIQTUxMj1lLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPW5ldyBuLmluaXQoW25ldyBpLmluaXQoMTc3OTAzMzcwMyw0MDg5MjM1NzIwKSxuZXcgaS5pbml0KDMxNDQxMzQyNzcsMjIyNzg3MzU5NSksbmV3IGkuaW5pdCgxMDEzOTA0MjQyLDQyNzExNzU3MjMpLG5ldyBpLmluaXQoMjc3MzQ4MDc2MiwxNTk1NzUwMTI5KSxuZXcgaS5pbml0KDEzNTk4OTMxMTksMjkxNzU2NTEzNyksbmV3IGkuaW5pdCgyNjAwODIyOTI0LDcyNTUxMTE5OSksbmV3IGkuaW5pdCg1Mjg3MzQ2MzUsNDIxNTM4OTU0NyksbmV3IGkuaW5pdCgxNTQxNDU5MjI1LDMyNzAzMzIwOSldKX0sX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByPXRoaXMuX2hhc2gud29yZHMsaT1yWzBdLG49clsxXSxvPXJbMl0scz1yWzNdLGM9cls0XSxhPXJbNV0saD1yWzZdLGw9cls3XSxmPWkuaGlnaCxkPWkubG93LHU9bi5oaWdoLHA9bi5sb3csXz1vLmhpZ2gseT1vLmxvdyx2PXMuaGlnaCxnPXMubG93LEI9Yy5oaWdoLHc9Yy5sb3csaz1hLmhpZ2gsbT1hLmxvdyxTPWguaGlnaCx4PWgubG93LGI9bC5oaWdoLHI9bC5sb3csQT1mLEg9ZCx6PXUsQz1wLEQ9XyxFPXksUj12LE09ZyxGPUIsUD13LFc9ayxPPW0sST1TLFU9eCxLPWIsWD1yLEw9MDtMPDgwO0wrKyl7dmFyIGosVCxOPWUxW0xdO0w8MTY/KFQ9Ti5oaWdoPTB8dFtlKzIqTF0saj1OLmxvdz0wfHRbZSsyKkwrMV0pOigkPShxPWUxW0wtMTVdKS5oaWdoLEo9cS5sb3csRz0oUT1lMVtMLTJdKS5oaWdoLFY9US5sb3csWj0oWT1lMVtMLTddKS5oaWdoLHE9WS5sb3csWT0oUT1lMVtMLTE2XSkuaGlnaCxUPShUPSgoJD4+PjF8Sjw8MzEpXigkPj4+OHxKPDwyNCleJD4+PjcpK1orKChqPShaPShKPj4+MXwkPDwzMSleKEo+Pj44fCQ8PDI0KV4oSj4+Pjd8JDw8MjUpKStxKT4+PjA8Wj4+PjA/MTowKSkrKChHPj4+MTl8Vjw8MTMpXihHPDwzfFY+Pj4yOSleRz4+PjYpKygoais9Sj0oVj4+PjE5fEc8PDEzKV4oVjw8M3xHPj4+MjkpXihWPj4+NnxHPDwyNikpPj4+MDxKPj4+MD8xOjApLGorPSQ9US5sb3csTi5oaWdoPVQ9VCtZKyhqPj4+MDwkPj4+MD8xOjApLE4ubG93PWopO3ZhciBxPUYmV15+RiZJLFo9UCZPXn5QJlUsVj1BJnpeQSZEXnomRCxHPShIPj4+Mjh8QTw8NCleKEg8PDMwfEE+Pj4yKV4oSDw8MjV8QT4+PjcpLEo9dDFbTF0sUT1KLmhpZ2gsWT1KLmxvdywkPVgrKChQPj4+MTR8Rjw8MTgpXihQPj4+MTh8Rjw8MTQpXihQPDwyM3xGPj4+OSkpLE49SysoKEY+Pj4xNHxQPDwxOCleKEY+Pj4xOHxQPDwxNCleKEY8PDIzfFA+Pj45KSkrKCQ+Pj4wPFg+Pj4wPzE6MCksSj1HKyhIJkNeSCZFXkMmRSksSz1JLFg9VSxJPVcsVT1PLFc9RixPPVAsRj1SKyhOPShOPShOPU4rcSsoKCQ9JCtaKT4+PjA8Wj4+PjA/MTowKSkrUSsoKCQ9JCtZKT4+PjA8WT4+PjA/MTowKSkrVCsoKCQ9JCtqKT4+PjA8aj4+PjA/MTowKSkrKChQPU0rJHwwKT4+PjA8TT4+PjA/MTowKXwwLFI9RCxNPUUsRD16LEU9Qyx6PUEsQz1ILEE9TisoKChBPj4+Mjh8SDw8NCleKEE8PDMwfEg+Pj4yKV4oQTw8MjV8SD4+PjcpKStWKyhKPj4+MDxHPj4+MD8xOjApKSsoKEg9JCtKfDApPj4+MDwkPj4+MD8xOjApfDB9ZD1pLmxvdz1kK0gsaS5oaWdoPWYrQSsoZD4+PjA8SD4+PjA/MTowKSxwPW4ubG93PXArQyxuLmhpZ2g9dSt6KyhwPj4+MDxDPj4+MD8xOjApLHk9by5sb3c9eStFLG8uaGlnaD1fK0QrKHk+Pj4wPEU+Pj4wPzE6MCksZz1zLmxvdz1nK00scy5oaWdoPXYrUisoZz4+PjA8TT4+PjA/MTowKSx3PWMubG93PXcrUCxjLmhpZ2g9QitGKyh3Pj4+MDxQPj4+MD8xOjApLG09YS5sb3c9bStPLGEuaGlnaD1rK1crKG0+Pj4wPE8+Pj4wPzE6MCkseD1oLmxvdz14K1UsaC5oaWdoPVMrSSsoeD4+PjA8VT4+PjA/MTowKSxyPWwubG93PXIrWCxsLmhpZ2g9YitLKyhyPj4+MDxYPj4+MD8xOjApfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2RhdGEsZT10LndvcmRzLHI9OCp0aGlzLl9uRGF0YUJ5dGVzLGk9OCp0LnNpZ0J5dGVzO3JldHVybiBlW2k+Pj41XXw9MTI4PDwyNC1pJTMyLGVbMzArKDEyOCtpPj4+MTA8PDUpXT1NYXRoLmZsb29yKHIvNDI5NDk2NzI5NiksZVszMSsoMTI4K2k+Pj4xMDw8NSldPXIsdC5zaWdCeXRlcz00KmUubGVuZ3RoLHRoaXMuX3Byb2Nlc3MoKSx0aGlzLl9oYXNoLnRvWDMyKCl9LGNsb25lOmZ1bmN0aW9uKCl7dmFyIHQ9ZS5jbG9uZS5jYWxsKHRoaXMpO3JldHVybiB0Ll9oYXNoPXRoaXMuX2hhc2guY2xvbmUoKSx0fSxibG9ja1NpemU6MzJ9KTt0LlNIQTUxMj1lLl9jcmVhdGVIZWxwZXIociksdC5IbWFjU0hBNTEyPWUuX2NyZWF0ZUhtYWNIZWxwZXIocil9KCksUD0oTT1VKS54NjQsYz1QLldvcmQsZj1QLldvcmRBcnJheSxQPU0uYWxnbyxkPVAuU0hBNTEyLFA9UC5TSEEzODQ9ZC5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7dGhpcy5faGFzaD1uZXcgZi5pbml0KFtuZXcgYy5pbml0KDM0MTgwNzAzNjUsMzIzODM3MTAzMiksbmV3IGMuaW5pdCgxNjU0MjcwMjUwLDkxNDE1MDY2MyksbmV3IGMuaW5pdCgyNDM4NTI5MzcwLDgxMjcwMjk5OSksbmV3IGMuaW5pdCgzNTU0NjIzNjAsNDE0NDkxMjY5NyksbmV3IGMuaW5pdCgxNzMxNDA1NDE1LDQyOTA3NzU4NTcpLG5ldyBjLmluaXQoMjM5NDE4MDIzMSwxNzUwNjAzMDI1KSxuZXcgYy5pbml0KDM2NzUwMDg1MjUsMTY5NDA3NjgzOSksbmV3IGMuaW5pdCgxMjAzMDYyODEzLDMyMDQwNzU0MjgpXSl9LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9ZC5fZG9GaW5hbGl6ZS5jYWxsKHRoaXMpO3JldHVybiB0LnNpZ0J5dGVzLT0xNix0fX0pLE0uU0hBMzg0PWQuX2NyZWF0ZUhlbHBlcihQKSxNLkhtYWNTSEEzODQ9ZC5fY3JlYXRlSG1hY0hlbHBlcihQKSxmdW5jdGlvbihsKXt2YXIgdD1VLGU9dC5saWIsZj1lLldvcmRBcnJheSxpPWUuSGFzaGVyLGQ9dC54NjQuV29yZCxlPXQuYWxnbyxBPVtdLEg9W10sej1bXTshZnVuY3Rpb24oKXtmb3IodmFyIHQ9MSxlPTAscj0wO3I8MjQ7cisrKXtBW3QrNSplXT0ocisxKSoocisyKS8yJTY0O3ZhciBpPSgyKnQrMyplKSU1O3Q9ZSU1LGU9aX1mb3IodD0wO3Q8NTt0KyspZm9yKGU9MDtlPDU7ZSsrKUhbdCs1KmVdPWUrKDIqdCszKmUpJTUqNTtmb3IodmFyIG49MSxvPTA7bzwyNDtvKyspe2Zvcih2YXIgcyxjPTAsYT0wLGg9MDtoPDc7aCsrKTEmbiYmKChzPSgxPDxoKS0xKTwzMj9hXj0xPDxzOmNePTE8PHMtMzIpLDEyOCZuP249bjw8MV4xMTM6bjw8PTE7eltvXT1kLmNyZWF0ZShjLGEpfX0oKTt2YXIgQz1bXTshZnVuY3Rpb24oKXtmb3IodmFyIHQ9MDt0PDI1O3QrKylDW3RdPWQuY3JlYXRlKCl9KCk7ZT1lLlNIQTM9aS5leHRlbmQoe2NmZzppLmNmZy5leHRlbmQoe291dHB1dExlbmd0aDo1MTJ9KSxfZG9SZXNldDpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLl9zdGF0ZT1bXSxlPTA7ZTwyNTtlKyspdFtlXT1uZXcgZC5pbml0O3RoaXMuYmxvY2tTaXplPSgxNjAwLTIqdGhpcy5jZmcub3V0cHV0TGVuZ3RoKS8zMn0sX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByPXRoaXMuX3N0YXRlLGk9dGhpcy5ibG9ja1NpemUvMixuPTA7bjxpO24rKyl7dmFyIG89dFtlKzIqbl0scz10W2UrMipuKzFdLG89MTY3MTE5MzUmKG88PDh8bz4+PjI0KXw0Mjc4MjU1MzYwJihvPDwyNHxvPj4+OCk7KG09cltuXSkuaGlnaF49cz0xNjcxMTkzNSYoczw8OHxzPj4+MjQpfDQyNzgyNTUzNjAmKHM8PDI0fHM+Pj44KSxtLmxvd149b31mb3IodmFyIGM9MDtjPDI0O2MrKyl7Zm9yKHZhciBhPTA7YTw1O2ErKyl7Zm9yKHZhciBoPTAsbD0wLGY9MDtmPDU7ZisrKWhePShtPXJbYSs1KmZdKS5oaWdoLGxePW0ubG93O3ZhciBkPUNbYV07ZC5oaWdoPWgsZC5sb3c9bH1mb3IoYT0wO2E8NTthKyspZm9yKHZhciB1PUNbKGErNCklNV0scD1DWyhhKzEpJTVdLF89cC5oaWdoLHA9cC5sb3csaD11LmhpZ2heKF88PDF8cD4+PjMxKSxsPXUubG93XihwPDwxfF8+Pj4zMSksZj0wO2Y8NTtmKyspKG09clthKzUqZl0pLmhpZ2hePWgsbS5sb3dePWw7Zm9yKHZhciB5PTE7eTwyNTt5Kyspe3ZhciB2PShtPXJbeV0pLmhpZ2gsZz1tLmxvdyxCPUFbeV07bD1CPDMyPyhoPXY8PEJ8Zz4+PjMyLUIsZzw8Qnx2Pj4+MzItQik6KGg9Zzw8Qi0zMnx2Pj4+NjQtQix2PDxCLTMyfGc+Pj42NC1CKTtCPUNbSFt5XV07Qi5oaWdoPWgsQi5sb3c9bH12YXIgdz1DWzBdLGs9clswXTt3LmhpZ2g9ay5oaWdoLHcubG93PWsubG93O2ZvcihhPTA7YTw1O2ErKylmb3IoZj0wO2Y8NTtmKyspe3ZhciBtPXJbeT1hKzUqZl0sUz1DW3ldLHg9Q1soYSsxKSU1KzUqZl0sYj1DWyhhKzIpJTUrNSpmXTttLmhpZ2g9Uy5oaWdoXn54LmhpZ2gmYi5oaWdoLG0ubG93PVMubG93Xn54LmxvdyZiLmxvd31tPXJbMF0saz16W2NdO20uaGlnaF49ay5oaWdoLG0ubG93Xj1rLmxvd319LF9kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5fZGF0YSxlPXQud29yZHMscj0odGhpcy5fbkRhdGFCeXRlcyw4KnQuc2lnQnl0ZXMpLGk9MzIqdGhpcy5ibG9ja1NpemU7ZVtyPj4+NV18PTE8PDI0LXIlMzIsZVsobC5jZWlsKCgxK3IpL2kpKmk+Pj41KS0xXXw9MTI4LHQuc2lnQnl0ZXM9NCplLmxlbmd0aCx0aGlzLl9wcm9jZXNzKCk7Zm9yKHZhciBuPXRoaXMuX3N0YXRlLGU9dGhpcy5jZmcub3V0cHV0TGVuZ3RoLzgsbz1lLzgscz1bXSxjPTA7YzxvO2MrKyl7dmFyIGE9bltjXSxoPWEuaGlnaCxhPWEubG93LGg9MTY3MTE5MzUmKGg8PDh8aD4+PjI0KXw0Mjc4MjU1MzYwJihoPDwyNHxoPj4+OCk7cy5wdXNoKGE9MTY3MTE5MzUmKGE8PDh8YT4+PjI0KXw0Mjc4MjU1MzYwJihhPDwyNHxhPj4+OCkpLHMucHVzaChoKX1yZXR1cm4gbmV3IGYuaW5pdChzLGUpfSxjbG9uZTpmdW5jdGlvbigpe2Zvcih2YXIgdD1pLmNsb25lLmNhbGwodGhpcyksZT10Ll9zdGF0ZT10aGlzLl9zdGF0ZS5zbGljZSgwKSxyPTA7cjwyNTtyKyspZVtyXT1lW3JdLmNsb25lKCk7cmV0dXJuIHR9fSk7dC5TSEEzPWkuX2NyZWF0ZUhlbHBlcihlKSx0LkhtYWNTSEEzPWkuX2NyZWF0ZUhtYWNIZWxwZXIoZSl9KE1hdGgpLE1hdGgsRj0odz1VKS5saWIsdT1GLldvcmRBcnJheSxwPUYuSGFzaGVyLEY9dy5hbGdvLFM9dS5jcmVhdGUoWzAsMSwyLDMsNCw1LDYsNyw4LDksMTAsMTEsMTIsMTMsMTQsMTUsNyw0LDEzLDEsMTAsNiwxNSwzLDEyLDAsOSw1LDIsMTQsMTEsOCwzLDEwLDE0LDQsOSwxNSw4LDEsMiw3LDAsNiwxMywxMSw1LDEyLDEsOSwxMSwxMCwwLDgsMTIsNCwxMywzLDcsMTUsMTQsNSw2LDIsNCwwLDUsOSw3LDEyLDIsMTAsMTQsMSwzLDgsMTEsNiwxNSwxM10pLHg9dS5jcmVhdGUoWzUsMTQsNywwLDksMiwxMSw0LDEzLDYsMTUsOCwxLDEwLDMsMTIsNiwxMSwzLDcsMCwxMyw1LDEwLDE0LDE1LDgsMTIsNCw5LDEsMiwxNSw1LDEsMyw3LDE0LDYsOSwxMSw4LDEyLDIsMTAsMCw0LDEzLDgsNiw0LDEsMywxMSwxNSwwLDUsMTIsMiwxMyw5LDcsMTAsMTQsMTIsMTUsMTAsNCwxLDUsOCw3LDYsMiwxMywxNCwwLDMsOSwxMV0pLGI9dS5jcmVhdGUoWzExLDE0LDE1LDEyLDUsOCw3LDksMTEsMTMsMTQsMTUsNiw3LDksOCw3LDYsOCwxMywxMSw5LDcsMTUsNywxMiwxNSw5LDExLDcsMTMsMTIsMTEsMTMsNiw3LDE0LDksMTMsMTUsMTQsOCwxMyw2LDUsMTIsNyw1LDExLDEyLDE0LDE1LDE0LDE1LDksOCw5LDE0LDUsNiw4LDYsNSwxMiw5LDE1LDUsMTEsNiw4LDEzLDEyLDUsMTIsMTMsMTQsMTEsOCw1LDZdKSxBPXUuY3JlYXRlKFs4LDksOSwxMSwxMywxNSwxNSw1LDcsNyw4LDExLDE0LDE0LDEyLDYsOSwxMywxNSw3LDEyLDgsOSwxMSw3LDcsMTIsNyw2LDE1LDEzLDExLDksNywxNSwxMSw4LDYsNiwxNCwxMiwxMyw1LDE0LDEzLDEzLDcsNSwxNSw1LDgsMTEsMTQsMTQsNiwxNCw2LDksMTIsOSwxMiw1LDE1LDgsOCw1LDEyLDksMTIsNSwxNCw2LDgsMTMsNiw1LDE1LDEzLDExLDExXSksSD11LmNyZWF0ZShbMCwxNTE4NTAwMjQ5LDE4NTk3NzUzOTMsMjQwMDk1OTcwOCwyODQwODUzODM4XSksej11LmNyZWF0ZShbMTM1MjgyOTkyNiwxNTQ4NjAzNjg0LDE4MzYwNzI2OTEsMjA1Mzk5NDIxNywwXSksRj1GLlJJUEVNRDE2MD1wLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt0aGlzLl9oYXNoPXUuY3JlYXRlKFsxNzMyNTg0MTkzLDQwMjMyMzM0MTcsMjU2MjM4MzEwMiwyNzE3MzM4NzgsMzI4NTM3NzUyMF0pfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9MDtyPDE2O3IrKyl7dmFyIGk9ZStyLG49dFtpXTt0W2ldPTE2NzExOTM1JihuPDw4fG4+Pj4yNCl8NDI3ODI1NTM2MCYobjw8MjR8bj4+PjgpfWZvcih2YXIgbyxzLGMsYSxoLGwsZj10aGlzLl9oYXNoLndvcmRzLGQ9SC53b3Jkcyx1PXoud29yZHMscD1TLndvcmRzLF89eC53b3Jkcyx5PWIud29yZHMsdj1BLndvcmRzLGc9bz1mWzBdLEI9cz1mWzFdLHc9Yz1mWzJdLGs9YT1mWzNdLG09aD1mWzRdLHI9MDtyPDgwO3IrPTEpbD1vK3RbZStwW3JdXXwwLGwrPXI8MTY/KHNeY15hKStkWzBdOnI8MzI/SyhzLGMsYSkrZFsxXTpyPDQ4Pygoc3x+YyleYSkrZFsyXTpyPDY0P1gocyxjLGEpK2RbM106KHNeKGN8fmEpKStkWzRdLGw9KGw9TChsfD0wLHlbcl0pKStofDAsbz1oLGg9YSxhPUwoYywxMCksYz1zLHM9bCxsPWcrdFtlK19bcl1dfDAsbCs9cjwxNj8oQl4od3x+aykpK3VbMF06cjwzMj9YKEIsdyxrKSt1WzFdOnI8NDg/KChCfH53KV5rKSt1WzJdOnI8NjQ/SyhCLHcsaykrdVszXTooQl53XmspK3VbNF0sbD0obD1MKGx8PTAsdltyXSkpK218MCxnPW0sbT1rLGs9TCh3LDEwKSx3PUIsQj1sO2w9ZlsxXStjK2t8MCxmWzFdPWZbMl0rYSttfDAsZlsyXT1mWzNdK2grZ3wwLGZbM109Zls0XStvK0J8MCxmWzRdPWZbMF0rcyt3fDAsZlswXT1sfSxfZG9GaW5hbGl6ZTpmdW5jdGlvbigpe3ZhciB0PXRoaXMuX2RhdGEsZT10LndvcmRzLHI9OCp0aGlzLl9uRGF0YUJ5dGVzLGk9OCp0LnNpZ0J5dGVzO2VbaT4+PjVdfD0xMjg8PDI0LWklMzIsZVsxNCsoNjQraT4+Pjk8PDQpXT0xNjcxMTkzNSYocjw8OHxyPj4+MjQpfDQyNzgyNTUzNjAmKHI8PDI0fHI+Pj44KSx0LnNpZ0J5dGVzPTQqKGUubGVuZ3RoKzEpLHRoaXMuX3Byb2Nlc3MoKTtmb3IodmFyIGU9dGhpcy5faGFzaCxuPWUud29yZHMsbz0wO288NTtvKyspe3ZhciBzPW5bb107bltvXT0xNjcxMTkzNSYoczw8OHxzPj4+MjQpfDQyNzgyNTUzNjAmKHM8PDI0fHM+Pj44KX1yZXR1cm4gZX0sY2xvbmU6ZnVuY3Rpb24oKXt2YXIgdD1wLmNsb25lLmNhbGwodGhpcyk7cmV0dXJuIHQuX2hhc2g9dGhpcy5faGFzaC5jbG9uZSgpLHR9fSksdy5SSVBFTUQxNjA9cC5fY3JlYXRlSGVscGVyKEYpLHcuSG1hY1JJUEVNRDE2MD1wLl9jcmVhdGVIbWFjSGVscGVyKEYpLFA9KE09VSkubGliLkJhc2UsXz1NLmVuYy5VdGY4LE0uYWxnby5ITUFDPVAuZXh0ZW5kKHtpbml0OmZ1bmN0aW9uKHQsZSl7dD10aGlzLl9oYXNoZXI9bmV3IHQuaW5pdCwic3RyaW5nIj09dHlwZW9mIGUmJihlPV8ucGFyc2UoZSkpO3ZhciByPXQuYmxvY2tTaXplLGk9NCpyOyhlPWUuc2lnQnl0ZXM+aT90LmZpbmFsaXplKGUpOmUpLmNsYW1wKCk7Zm9yKHZhciB0PXRoaXMuX29LZXk9ZS5jbG9uZSgpLGU9dGhpcy5faUtleT1lLmNsb25lKCksbj10LndvcmRzLG89ZS53b3JkcyxzPTA7czxyO3MrKyluW3NdXj0xNTQ5NTU2ODI4LG9bc11ePTkwOTUyMjQ4Njt0LnNpZ0J5dGVzPWUuc2lnQnl0ZXM9aSx0aGlzLnJlc2V0KCl9LHJlc2V0OmZ1bmN0aW9uKCl7dmFyIHQ9dGhpcy5faGFzaGVyO3QucmVzZXQoKSx0LnVwZGF0ZSh0aGlzLl9pS2V5KX0sdXBkYXRlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9oYXNoZXIudXBkYXRlKHQpLHRoaXN9LGZpbmFsaXplOmZ1bmN0aW9uKHQpe3ZhciBlPXRoaXMuX2hhc2hlcix0PWUuZmluYWxpemUodCk7cmV0dXJuIGUucmVzZXQoKSxlLmZpbmFsaXplKHRoaXMuX29LZXkuY2xvbmUoKS5jb25jYXQodCkpfX0pLEY9KHc9VSkubGliLE09Ri5CYXNlLHY9Ri5Xb3JkQXJyYXksUD13LmFsZ28sRj1QLlNIQTEsZz1QLkhNQUMseT1QLlBCS0RGMj1NLmV4dGVuZCh7Y2ZnOk0uZXh0ZW5kKHtrZXlTaXplOjQsaGFzaGVyOkYsaXRlcmF0aW9uczoxfSksaW5pdDpmdW5jdGlvbih0KXt0aGlzLmNmZz10aGlzLmNmZy5leHRlbmQodCl9LGNvbXB1dGU6ZnVuY3Rpb24odCxlKXtmb3IodmFyIHI9dGhpcy5jZmcsaT1nLmNyZWF0ZShyLmhhc2hlcix0KSxuPXYuY3JlYXRlKCksbz12LmNyZWF0ZShbMV0pLHM9bi53b3JkcyxjPW8ud29yZHMsYT1yLmtleVNpemUsaD1yLml0ZXJhdGlvbnM7cy5sZW5ndGg8YTspe3ZhciBsPWkudXBkYXRlKGUpLmZpbmFsaXplKG8pO2kucmVzZXQoKTtmb3IodmFyIGY9bC53b3JkcyxkPWYubGVuZ3RoLHU9bCxwPTE7cDxoO3ArKyl7dT1pLmZpbmFsaXplKHUpLGkucmVzZXQoKTtmb3IodmFyIF89dS53b3Jkcyx5PTA7eTxkO3krKylmW3ldXj1fW3ldfW4uY29uY2F0KGwpLGNbMF0rK31yZXR1cm4gbi5zaWdCeXRlcz00KmEsbn19KSx3LlBCS0RGMj1mdW5jdGlvbih0LGUscil7cmV0dXJuIHkuY3JlYXRlKHIpLmNvbXB1dGUodCxlKX0sTT0oUD1VKS5saWIsRj1NLkJhc2UsQj1NLldvcmRBcnJheSx3PVAuYWxnbyxNPXcuTUQ1LGs9dy5FdnBLREY9Ri5leHRlbmQoe2NmZzpGLmV4dGVuZCh7a2V5U2l6ZTo0LGhhc2hlcjpNLGl0ZXJhdGlvbnM6MX0pLGluaXQ6ZnVuY3Rpb24odCl7dGhpcy5jZmc9dGhpcy5jZmcuZXh0ZW5kKHQpfSxjb21wdXRlOmZ1bmN0aW9uKHQsZSl7Zm9yKHZhciByLGk9dGhpcy5jZmcsbj1pLmhhc2hlci5jcmVhdGUoKSxvPUIuY3JlYXRlKCkscz1vLndvcmRzLGM9aS5rZXlTaXplLGE9aS5pdGVyYXRpb25zO3MubGVuZ3RoPGM7KXtyJiZuLnVwZGF0ZShyKSxyPW4udXBkYXRlKHQpLmZpbmFsaXplKGUpLG4ucmVzZXQoKTtmb3IodmFyIGg9MTtoPGE7aCsrKXI9bi5maW5hbGl6ZShyKSxuLnJlc2V0KCk7by5jb25jYXQocil9cmV0dXJuIG8uc2lnQnl0ZXM9NCpjLG99fSksUC5FdnBLREY9ZnVuY3Rpb24odCxlLHIpe3JldHVybiBrLmNyZWF0ZShyKS5jb21wdXRlKHQsZSl9LFUubGliLkNpcGhlcnx8ZnVuY3Rpb24oKXt2YXIgdD1VLGU9dC5saWIscj1lLkJhc2Uscz1lLldvcmRBcnJheSxpPWUuQnVmZmVyZWRCbG9ja0FsZ29yaXRobSxuPXQuZW5jLG89KG4uVXRmOCxuLkJhc2U2NCksYz10LmFsZ28uRXZwS0RGLGE9ZS5DaXBoZXI9aS5leHRlbmQoe2NmZzpyLmV4dGVuZCgpLGNyZWF0ZUVuY3J5cHRvcjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLmNyZWF0ZSh0aGlzLl9FTkNfWEZPUk1fTU9ERSx0LGUpfSxjcmVhdGVEZWNyeXB0b3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5jcmVhdGUodGhpcy5fREVDX1hGT1JNX01PREUsdCxlKX0saW5pdDpmdW5jdGlvbih0LGUscil7dGhpcy5jZmc9dGhpcy5jZmcuZXh0ZW5kKHIpLHRoaXMuX3hmb3JtTW9kZT10LHRoaXMuX2tleT1lLHRoaXMucmVzZXQoKX0scmVzZXQ6ZnVuY3Rpb24oKXtpLnJlc2V0LmNhbGwodGhpcyksdGhpcy5fZG9SZXNldCgpfSxwcm9jZXNzOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLl9hcHBlbmQodCksdGhpcy5fcHJvY2VzcygpfSxmaW5hbGl6ZTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmdGhpcy5fYXBwZW5kKHQpLHRoaXMuX2RvRmluYWxpemUoKX0sa2V5U2l6ZTo0LGl2U2l6ZTo0LF9FTkNfWEZPUk1fTU9ERToxLF9ERUNfWEZPUk1fTU9ERToyLF9jcmVhdGVIZWxwZXI6ZnVuY3Rpb24oaSl7cmV0dXJue2VuY3J5cHQ6ZnVuY3Rpb24odCxlLHIpe3JldHVybiBoKGUpLmVuY3J5cHQoaSx0LGUscil9LGRlY3J5cHQ6ZnVuY3Rpb24odCxlLHIpe3JldHVybiBoKGUpLmRlY3J5cHQoaSx0LGUscil9fX19KTtmdW5jdGlvbiBoKHQpe3JldHVybiJzdHJpbmciPT10eXBlb2YgdD9wOnV9ZS5TdHJlYW1DaXBoZXI9YS5leHRlbmQoe19kb0ZpbmFsaXplOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX3Byb2Nlc3MoITApfSxibG9ja1NpemU6MX0pO3ZhciBsPXQubW9kZT17fSxuPWUuQmxvY2tDaXBoZXJNb2RlPXIuZXh0ZW5kKHtjcmVhdGVFbmNyeXB0b3I6ZnVuY3Rpb24odCxlKXtyZXR1cm4gdGhpcy5FbmNyeXB0b3IuY3JlYXRlKHQsZSl9LGNyZWF0ZURlY3J5cHRvcjpmdW5jdGlvbih0LGUpe3JldHVybiB0aGlzLkRlY3J5cHRvci5jcmVhdGUodCxlKX0saW5pdDpmdW5jdGlvbih0LGUpe3RoaXMuX2NpcGhlcj10LHRoaXMuX2l2PWV9fSksbj1sLkNCQz0oKGw9bi5leHRlbmQoKSkuRW5jcnlwdG9yPWwuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24odCxlKXt2YXIgcj10aGlzLl9jaXBoZXIsaT1yLmJsb2NrU2l6ZTtmLmNhbGwodGhpcyx0LGUsaSksci5lbmNyeXB0QmxvY2sodCxlKSx0aGlzLl9wcmV2QmxvY2s9dC5zbGljZShlLGUraSl9fSksbC5EZWNyeXB0b3I9bC5leHRlbmQoe3Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX2NpcGhlcixpPXIuYmxvY2tTaXplLG49dC5zbGljZShlLGUraSk7ci5kZWNyeXB0QmxvY2sodCxlKSxmLmNhbGwodGhpcyx0LGUsaSksdGhpcy5fcHJldkJsb2NrPW59fSksbCk7ZnVuY3Rpb24gZih0LGUscil7dmFyIGksbj10aGlzLl9pdjtuPyhpPW4sdGhpcy5faXY9dm9pZCAwKTppPXRoaXMuX3ByZXZCbG9jaztmb3IodmFyIG89MDtvPHI7bysrKXRbZStvXV49aVtvXX12YXIgbD0odC5wYWQ9e30pLlBrY3M3PXtwYWQ6ZnVuY3Rpb24odCxlKXtmb3IodmFyIGU9NCplLHI9ZS10LnNpZ0J5dGVzJWUsaT1yPDwyNHxyPDwxNnxyPDw4fHIsbj1bXSxvPTA7bzxyO28rPTQpbi5wdXNoKGkpO2U9cy5jcmVhdGUobixyKTt0LmNvbmNhdChlKX0sdW5wYWQ6ZnVuY3Rpb24odCl7dmFyIGU9MjU1JnQud29yZHNbdC5zaWdCeXRlcy0xPj4+Ml07dC5zaWdCeXRlcy09ZX19LGQ9KGUuQmxvY2tDaXBoZXI9YS5leHRlbmQoe2NmZzphLmNmZy5leHRlbmQoe21vZGU6bixwYWRkaW5nOmx9KSxyZXNldDpmdW5jdGlvbigpe3ZhciB0O2EucmVzZXQuY2FsbCh0aGlzKTt2YXIgZT10aGlzLmNmZyxyPWUuaXYsZT1lLm1vZGU7dGhpcy5feGZvcm1Nb2RlPT10aGlzLl9FTkNfWEZPUk1fTU9ERT90PWUuY3JlYXRlRW5jcnlwdG9yOih0PWUuY3JlYXRlRGVjcnlwdG9yLHRoaXMuX21pbkJ1ZmZlclNpemU9MSksdGhpcy5fbW9kZSYmdGhpcy5fbW9kZS5fX2NyZWF0b3I9PXQ/dGhpcy5fbW9kZS5pbml0KHRoaXMsciYmci53b3Jkcyk6KHRoaXMuX21vZGU9dC5jYWxsKGUsdGhpcyxyJiZyLndvcmRzKSx0aGlzLl9tb2RlLl9fY3JlYXRvcj10KX0sX2RvUHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7dGhpcy5fbW9kZS5wcm9jZXNzQmxvY2sodCxlKX0sX2RvRmluYWxpemU6ZnVuY3Rpb24oKXt2YXIgdCxlPXRoaXMuY2ZnLnBhZGRpbmc7cmV0dXJuIHRoaXMuX3hmb3JtTW9kZT09dGhpcy5fRU5DX1hGT1JNX01PREU/KGUucGFkKHRoaXMuX2RhdGEsdGhpcy5ibG9ja1NpemUpLHQ9dGhpcy5fcHJvY2VzcyghMCkpOih0PXRoaXMuX3Byb2Nlc3MoITApLGUudW5wYWQodCkpLHR9LGJsb2NrU2l6ZTo0fSksZS5DaXBoZXJQYXJhbXM9ci5leHRlbmQoe2luaXQ6ZnVuY3Rpb24odCl7dGhpcy5taXhJbih0KX0sdG9TdHJpbmc6ZnVuY3Rpb24odCl7cmV0dXJuKHR8fHRoaXMuZm9ybWF0dGVyKS5zdHJpbmdpZnkodGhpcyl9fSkpLGw9KHQuZm9ybWF0PXt9KS5PcGVuU1NMPXtzdHJpbmdpZnk6ZnVuY3Rpb24odCl7dmFyIGU9dC5jaXBoZXJ0ZXh0LHQ9dC5zYWx0LGU9dD9zLmNyZWF0ZShbMTM5ODg5MzY4NCwxNzAxMDc2ODMxXSkuY29uY2F0KHQpLmNvbmNhdChlKTplO3JldHVybiBlLnRvU3RyaW5nKG8pfSxwYXJzZTpmdW5jdGlvbih0KXt2YXIgZSxyPW8ucGFyc2UodCksdD1yLndvcmRzO3JldHVybiAxMzk4ODkzNjg0PT10WzBdJiYxNzAxMDc2ODMxPT10WzFdJiYoZT1zLmNyZWF0ZSh0LnNsaWNlKDIsNCkpLHQuc3BsaWNlKDAsNCksci5zaWdCeXRlcy09MTYpLGQuY3JlYXRlKHtjaXBoZXJ0ZXh0OnIsc2FsdDplfSl9fSx1PWUuU2VyaWFsaXphYmxlQ2lwaGVyPXIuZXh0ZW5kKHtjZmc6ci5leHRlbmQoe2Zvcm1hdDpsfSksZW5jcnlwdDpmdW5jdGlvbih0LGUscixpKXtpPXRoaXMuY2ZnLmV4dGVuZChpKTt2YXIgbj10LmNyZWF0ZUVuY3J5cHRvcihyLGkpLGU9bi5maW5hbGl6ZShlKSxuPW4uY2ZnO3JldHVybiBkLmNyZWF0ZSh7Y2lwaGVydGV4dDplLGtleTpyLGl2Om4uaXYsYWxnb3JpdGhtOnQsbW9kZTpuLm1vZGUscGFkZGluZzpuLnBhZGRpbmcsYmxvY2tTaXplOnQuYmxvY2tTaXplLGZvcm1hdHRlcjppLmZvcm1hdH0pfSxkZWNyeXB0OmZ1bmN0aW9uKHQsZSxyLGkpe3JldHVybiBpPXRoaXMuY2ZnLmV4dGVuZChpKSxlPXRoaXMuX3BhcnNlKGUsaS5mb3JtYXQpLHQuY3JlYXRlRGVjcnlwdG9yKHIsaSkuZmluYWxpemUoZS5jaXBoZXJ0ZXh0KX0sX3BhcnNlOmZ1bmN0aW9uKHQsZSl7cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0P2UucGFyc2UodCx0aGlzKTp0fX0pLHQ9KHQua2RmPXt9KS5PcGVuU1NMPXtleGVjdXRlOmZ1bmN0aW9uKHQsZSxyLGkpe2k9aXx8cy5yYW5kb20oOCk7dD1jLmNyZWF0ZSh7a2V5U2l6ZTplK3J9KS5jb21wdXRlKHQsaSkscj1zLmNyZWF0ZSh0LndvcmRzLnNsaWNlKGUpLDQqcik7cmV0dXJuIHQuc2lnQnl0ZXM9NCplLGQuY3JlYXRlKHtrZXk6dCxpdjpyLHNhbHQ6aX0pfX0scD1lLlBhc3N3b3JkQmFzZWRDaXBoZXI9dS5leHRlbmQoe2NmZzp1LmNmZy5leHRlbmQoe2tkZjp0fSksZW5jcnlwdDpmdW5jdGlvbih0LGUscixpKXtyPShpPXRoaXMuY2ZnLmV4dGVuZChpKSkua2RmLmV4ZWN1dGUocix0LmtleVNpemUsdC5pdlNpemUpO2kuaXY9ci5pdjtpPXUuZW5jcnlwdC5jYWxsKHRoaXMsdCxlLHIua2V5LGkpO3JldHVybiBpLm1peEluKHIpLGl9LGRlY3J5cHQ6ZnVuY3Rpb24odCxlLHIsaSl7aT10aGlzLmNmZy5leHRlbmQoaSksZT10aGlzLl9wYXJzZShlLGkuZm9ybWF0KTtyPWkua2RmLmV4ZWN1dGUocix0LmtleVNpemUsdC5pdlNpemUsZS5zYWx0KTtyZXR1cm4gaS5pdj1yLml2LHUuZGVjcnlwdC5jYWxsKHRoaXMsdCxlLHIua2V5LGkpfX0pfSgpLFUubW9kZS5DRkI9KChGPVUubGliLkJsb2NrQ2lwaGVyTW9kZS5leHRlbmQoKSkuRW5jcnlwdG9yPUYuZXh0ZW5kKHtwcm9jZXNzQmxvY2s6ZnVuY3Rpb24odCxlKXt2YXIgcj10aGlzLl9jaXBoZXIsaT1yLmJsb2NrU2l6ZTtqLmNhbGwodGhpcyx0LGUsaSxyKSx0aGlzLl9wcmV2QmxvY2s9dC5zbGljZShlLGUraSl9fSksRi5EZWNyeXB0b3I9Ri5leHRlbmQoe3Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX2NpcGhlcixpPXIuYmxvY2tTaXplLG49dC5zbGljZShlLGUraSk7ai5jYWxsKHRoaXMsdCxlLGksciksdGhpcy5fcHJldkJsb2NrPW59fSksRiksVS5tb2RlLkNUUj0oTT1VLmxpYi5CbG9ja0NpcGhlck1vZGUuZXh0ZW5kKCksUD1NLkVuY3J5cHRvcj1NLmV4dGVuZCh7cHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7dmFyIHI9dGhpcy5fY2lwaGVyLGk9ci5ibG9ja1NpemUsbj10aGlzLl9pdixvPXRoaXMuX2NvdW50ZXI7biYmKG89dGhpcy5fY291bnRlcj1uLnNsaWNlKDApLHRoaXMuX2l2PXZvaWQgMCk7dmFyIHM9by5zbGljZSgwKTtyLmVuY3J5cHRCbG9jayhzLDApLG9baS0xXT1vW2ktMV0rMXwwO2Zvcih2YXIgYz0wO2M8aTtjKyspdFtlK2NdXj1zW2NdfX0pLE0uRGVjcnlwdG9yPVAsTSksVS5tb2RlLkNUUkdsYWRtYW49KEY9VS5saWIuQmxvY2tDaXBoZXJNb2RlLmV4dGVuZCgpLFA9Ri5FbmNyeXB0b3I9Ri5leHRlbmQoe3Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX2NpcGhlcixpPXIuYmxvY2tTaXplLG49dGhpcy5faXYsbz10aGlzLl9jb3VudGVyO24mJihvPXRoaXMuX2NvdW50ZXI9bi5zbGljZSgwKSx0aGlzLl9pdj12b2lkIDApLDA9PT0oKG49bylbMF09VChuWzBdKSkmJihuWzFdPVQoblsxXSkpO3ZhciBzPW8uc2xpY2UoMCk7ci5lbmNyeXB0QmxvY2socywwKTtmb3IodmFyIGM9MDtjPGk7YysrKXRbZStjXV49c1tjXX19KSxGLkRlY3J5cHRvcj1QLEYpLFUubW9kZS5PRkI9KE09VS5saWIuQmxvY2tDaXBoZXJNb2RlLmV4dGVuZCgpLFA9TS5FbmNyeXB0b3I9TS5leHRlbmQoe3Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX2NpcGhlcixpPXIuYmxvY2tTaXplLG49dGhpcy5faXYsbz10aGlzLl9rZXlzdHJlYW07biYmKG89dGhpcy5fa2V5c3RyZWFtPW4uc2xpY2UoMCksdGhpcy5faXY9dm9pZCAwKSxyLmVuY3J5cHRCbG9jayhvLDApO2Zvcih2YXIgcz0wO3M8aTtzKyspdFtlK3NdXj1vW3NdfX0pLE0uRGVjcnlwdG9yPVAsTSksVS5tb2RlLkVDQj0oKEY9VS5saWIuQmxvY2tDaXBoZXJNb2RlLmV4dGVuZCgpKS5FbmNyeXB0b3I9Ri5leHRlbmQoe3Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe3RoaXMuX2NpcGhlci5lbmNyeXB0QmxvY2sodCxlKX19KSxGLkRlY3J5cHRvcj1GLmV4dGVuZCh7cHJvY2Vzc0Jsb2NrOmZ1bmN0aW9uKHQsZSl7dGhpcy5fY2lwaGVyLmRlY3J5cHRCbG9jayh0LGUpfX0pLEYpLFUucGFkLkFuc2lYOTIzPXtwYWQ6ZnVuY3Rpb24odCxlKXt2YXIgcj10LnNpZ0J5dGVzLGU9NCplLGU9ZS1yJWUscj1yK2UtMTt0LmNsYW1wKCksdC53b3Jkc1tyPj4+Ml18PWU8PDI0LXIlNCo4LHQuc2lnQnl0ZXMrPWV9LHVucGFkOmZ1bmN0aW9uKHQpe3ZhciBlPTI1NSZ0LndvcmRzW3Quc2lnQnl0ZXMtMT4+PjJdO3Quc2lnQnl0ZXMtPWV9fSxVLnBhZC5Jc28xMDEyNj17cGFkOmZ1bmN0aW9uKHQsZSl7ZSo9NCxlLT10LnNpZ0J5dGVzJWU7dC5jb25jYXQoVS5saWIuV29yZEFycmF5LnJhbmRvbShlLTEpKS5jb25jYXQoVS5saWIuV29yZEFycmF5LmNyZWF0ZShbZTw8MjRdLDEpKX0sdW5wYWQ6ZnVuY3Rpb24odCl7dmFyIGU9MjU1JnQud29yZHNbdC5zaWdCeXRlcy0xPj4+Ml07dC5zaWdCeXRlcy09ZX19LFUucGFkLklzbzk3OTcxPXtwYWQ6ZnVuY3Rpb24odCxlKXt0LmNvbmNhdChVLmxpYi5Xb3JkQXJyYXkuY3JlYXRlKFsyMTQ3NDgzNjQ4XSwxKSksVS5wYWQuWmVyb1BhZGRpbmcucGFkKHQsZSl9LHVucGFkOmZ1bmN0aW9uKHQpe1UucGFkLlplcm9QYWRkaW5nLnVucGFkKHQpLHQuc2lnQnl0ZXMtLX19LFUucGFkLlplcm9QYWRkaW5nPXtwYWQ6ZnVuY3Rpb24odCxlKXtlKj00O3QuY2xhbXAoKSx0LnNpZ0J5dGVzKz1lLSh0LnNpZ0J5dGVzJWV8fGUpfSx1bnBhZDpmdW5jdGlvbih0KXtmb3IodmFyIGU9dC53b3JkcyxyPXQuc2lnQnl0ZXMtMSxyPXQuc2lnQnl0ZXMtMTswPD1yO3ItLSlpZihlW3I+Pj4yXT4+PjI0LXIlNCo4JjI1NSl7dC5zaWdCeXRlcz1yKzE7YnJlYWt9fX0sVS5wYWQuTm9QYWRkaW5nPXtwYWQ6ZnVuY3Rpb24oKXt9LHVucGFkOmZ1bmN0aW9uKCl7fX0sbT0oUD1VKS5saWIuQ2lwaGVyUGFyYW1zLEM9UC5lbmMuSGV4LFAuZm9ybWF0LkhleD17c3RyaW5naWZ5OmZ1bmN0aW9uKHQpe3JldHVybiB0LmNpcGhlcnRleHQudG9TdHJpbmcoQyl9LHBhcnNlOmZ1bmN0aW9uKHQpe3Q9Qy5wYXJzZSh0KTtyZXR1cm4gbS5jcmVhdGUoe2NpcGhlcnRleHQ6dH0pfX0sZnVuY3Rpb24oKXt2YXIgdD1VLGU9dC5saWIuQmxvY2tDaXBoZXIscj10LmFsZ28saD1bXSxsPVtdLGY9W10sZD1bXSx1PVtdLHA9W10sXz1bXSx5PVtdLHY9W10sZz1bXTshZnVuY3Rpb24oKXtmb3IodmFyIHQ9W10sZT0wO2U8MjU2O2UrKyl0W2VdPWU8MTI4P2U8PDE6ZTw8MV4yODM7Zm9yKHZhciByPTAsaT0wLGU9MDtlPDI1NjtlKyspe3ZhciBuPWleaTw8MV5pPDwyXmk8PDNeaTw8NDtoW3JdPW49bj4+PjheMjU1Jm5eOTk7dmFyIG89dFtsW25dPXJdLHM9dFtvXSxjPXRbc10sYT0yNTcqdFtuXV4xNjg0MzAwOCpuO2Zbcl09YTw8MjR8YT4+PjgsZFtyXT1hPDwxNnxhPj4+MTYsdVtyXT1hPDw4fGE+Pj4yNCxwW3JdPWEsX1tuXT0oYT0xNjg0MzAwOSpjXjY1NTM3KnNeMjU3Km9eMTY4NDMwMDgqcik8PDI0fGE+Pj44LHlbbl09YTw8MTZ8YT4+PjE2LHZbbl09YTw8OHxhPj4+MjQsZ1tuXT1hLHI/KHI9b150W3RbdFtjXm9dXV0saV49dFt0W2ldXSk6cj1pPTF9fSgpO3ZhciBCPVswLDEsMiw0LDgsMTYsMzIsNjQsMTI4LDI3LDU0XSxyPXIuQUVTPWUuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe2lmKCF0aGlzLl9uUm91bmRzfHx0aGlzLl9rZXlQcmlvclJlc2V0IT09dGhpcy5fa2V5KXtmb3IodmFyIHQ9dGhpcy5fa2V5UHJpb3JSZXNldD10aGlzLl9rZXksZT10LndvcmRzLHI9dC5zaWdCeXRlcy80LGk9NCooMSsodGhpcy5fblJvdW5kcz02K3IpKSxuPXRoaXMuX2tleVNjaGVkdWxlPVtdLG89MDtvPGk7bysrKW88cj9uW29dPWVbb106KGE9bltvLTFdLG8lcj82PHImJm8lcj09NCYmKGE9aFthPj4+MjRdPDwyNHxoW2E+Pj4xNiYyNTVdPDwxNnxoW2E+Pj44JjI1NV08PDh8aFsyNTUmYV0pOihhPWhbKGE9YTw8OHxhPj4+MjQpPj4+MjRdPDwyNHxoW2E+Pj4xNiYyNTVdPDwxNnxoW2E+Pj44JjI1NV08PDh8aFsyNTUmYV0sYV49QltvL3J8MF08PDI0KSxuW29dPW5bby1yXV5hKTtmb3IodmFyIHM9dGhpcy5faW52S2V5U2NoZWR1bGU9W10sYz0wO2M8aTtjKyspe3ZhciBhLG89aS1jO2E9YyU0P25bb106bltvLTRdLHNbY109Yzw0fHxvPD00P2E6X1toW2E+Pj4yNF1dXnlbaFthPj4+MTYmMjU1XV1edltoW2E+Pj44JjI1NV1dXmdbaFsyNTUmYV1dfX19LGVuY3J5cHRCbG9jazpmdW5jdGlvbih0LGUpe3RoaXMuX2RvQ3J5cHRCbG9jayh0LGUsdGhpcy5fa2V5U2NoZWR1bGUsZixkLHUscCxoKX0sZGVjcnlwdEJsb2NrOmZ1bmN0aW9uKHQsZSl7dmFyIHI9dFtlKzFdO3RbZSsxXT10W2UrM10sdFtlKzNdPXIsdGhpcy5fZG9DcnlwdEJsb2NrKHQsZSx0aGlzLl9pbnZLZXlTY2hlZHVsZSxfLHksdixnLGwpO3I9dFtlKzFdO3RbZSsxXT10W2UrM10sdFtlKzNdPXJ9LF9kb0NyeXB0QmxvY2s6ZnVuY3Rpb24odCxlLHIsaSxuLG8scyxjKXtmb3IodmFyIGE9dGhpcy5fblJvdW5kcyxoPXRbZV1eclswXSxsPXRbZSsxXV5yWzFdLGY9dFtlKzJdXnJbMl0sZD10W2UrM11eclszXSx1PTQscD0xO3A8YTtwKyspdmFyIF89aVtoPj4+MjRdXm5bbD4+PjE2JjI1NV1eb1tmPj4+OCYyNTVdXnNbMjU1JmRdXnJbdSsrXSx5PWlbbD4+PjI0XV5uW2Y+Pj4xNiYyNTVdXm9bZD4+PjgmMjU1XV5zWzI1NSZoXV5yW3UrK10sdj1pW2Y+Pj4yNF1ebltkPj4+MTYmMjU1XV5vW2g+Pj44JjI1NV1ec1syNTUmbF1eclt1KytdLGc9aVtkPj4+MjRdXm5baD4+PjE2JjI1NV1eb1tsPj4+OCYyNTVdXnNbMjU1JmZdXnJbdSsrXSxoPV8sbD15LGY9dixkPWc7Xz0oY1toPj4+MjRdPDwyNHxjW2w+Pj4xNiYyNTVdPDwxNnxjW2Y+Pj44JjI1NV08PDh8Y1syNTUmZF0pXnJbdSsrXSx5PShjW2w+Pj4yNF08PDI0fGNbZj4+PjE2JjI1NV08PDE2fGNbZD4+PjgmMjU1XTw8OHxjWzI1NSZoXSleclt1KytdLHY9KGNbZj4+PjI0XTw8MjR8Y1tkPj4+MTYmMjU1XTw8MTZ8Y1toPj4+OCYyNTVdPDw4fGNbMjU1JmxdKV5yW3UrK10sZz0oY1tkPj4+MjRdPDwyNHxjW2g+Pj4xNiYyNTVdPDwxNnxjW2w+Pj44JjI1NV08PDh8Y1syNTUmZl0pXnJbdSsrXTt0W2VdPV8sdFtlKzFdPXksdFtlKzJdPXYsdFtlKzNdPWd9LGtleVNpemU6OH0pO3QuQUVTPWUuX2NyZWF0ZUhlbHBlcihyKX0oKSxmdW5jdGlvbigpe3ZhciB0PVUsZT10LmxpYixpPWUuV29yZEFycmF5LHI9ZS5CbG9ja0NpcGhlcixlPXQuYWxnbyxoPVs1Nyw0OSw0MSwzMywyNSwxNyw5LDEsNTgsNTAsNDIsMzQsMjYsMTgsMTAsMiw1OSw1MSw0MywzNSwyNywxOSwxMSwzLDYwLDUyLDQ0LDM2LDYzLDU1LDQ3LDM5LDMxLDIzLDE1LDcsNjIsNTQsNDYsMzgsMzAsMjIsMTQsNiw2MSw1Myw0NSwzNywyOSwyMSwxMyw1LDI4LDIwLDEyLDRdLGw9WzE0LDE3LDExLDI0LDEsNSwzLDI4LDE1LDYsMjEsMTAsMjMsMTksMTIsNCwyNiw4LDE2LDcsMjcsMjAsMTMsMiw0MSw1MiwzMSwzNyw0Nyw1NSwzMCw0MCw1MSw0NSwzMyw0OCw0NCw0OSwzOSw1NiwzNCw1Myw0Niw0Miw1MCwzNiwyOSwzMl0sZj1bMSwyLDQsNiw4LDEwLDEyLDE0LDE1LDE3LDE5LDIxLDIzLDI1LDI3LDI4XSxkPVt7MDo4NDIxODg4LDI2ODQzNTQ1NjozMjc2OCw1MzY4NzA5MTI6ODQyMTM3OCw4MDUzMDYzNjg6MiwxMDczNzQxODI0OjUxMiwxMzQyMTc3MjgwOjg0MjE4OTAsMTYxMDYxMjczNjo4Mzg5MTIyLDE4NzkwNDgxOTI6ODM4ODYwOCwyMTQ3NDgzNjQ4OjUxNCwyNDE1OTE5MTA0OjgzODkxMjAsMjY4NDM1NDU2MDozMzI4MCwyOTUyNzkwMDE2Ojg0MjEzNzYsMzIyMTIyNTQ3MjozMjc3MCwzNDg5NjYwOTI4OjgzODg2MTAsMzc1ODA5NjM4NDowLDQwMjY1MzE4NDA6MzMyODIsMTM0MjE3NzI4OjAsNDAyNjUzMTg0Ojg0MjE4OTAsNjcxMDg4NjQwOjMzMjgyLDkzOTUyNDA5NjozMjc2OCwxMjA3OTU5NTUyOjg0MjE4ODgsMTQ3NjM5NTAwODo1MTIsMTc0NDgzMDQ2NDo4NDIxMzc4LDIwMTMyNjU5MjA6MiwyMjgxNzAxMzc2OjgzODkxMjAsMjU1MDEzNjgzMjozMzI4MCwyODE4NTcyMjg4Ojg0MjEzNzYsMzA4NzAwNzc0NDo4Mzg5MTIyLDMzNTU0NDMyMDA6ODM4ODYxMCwzNjIzODc4NjU2OjMyNzcwLDM4OTIzMTQxMTI6NTE0LDQxNjA3NDk1Njg6ODM4ODYwOCwxOjMyNzY4LDI2ODQzNTQ1NzoyLDUzNjg3MDkxMzo4NDIxODg4LDgwNTMwNjM2OTo4Mzg4NjA4LDEwNzM3NDE4MjU6ODQyMTM3OCwxMzQyMTc3MjgxOjMzMjgwLDE2MTA2MTI3Mzc6NTEyLDE4NzkwNDgxOTM6ODM4OTEyMiwyMTQ3NDgzNjQ5Ojg0MjE4OTAsMjQxNTkxOTEwNTo4NDIxMzc2LDI2ODQzNTQ1NjE6ODM4ODYxMCwyOTUyNzkwMDE3OjMzMjgyLDMyMjEyMjU0NzM6NTE0LDM0ODk2NjA5Mjk6ODM4OTEyMCwzNzU4MDk2Mzg1OjMyNzcwLDQwMjY1MzE4NDE6MCwxMzQyMTc3Mjk6ODQyMTg5MCw0MDI2NTMxODU6ODQyMTM3Niw2NzEwODg2NDE6ODM4ODYwOCw5Mzk1MjQwOTc6NTEyLDEyMDc5NTk1NTM6MzI3NjgsMTQ3NjM5NTAwOTo4Mzg4NjEwLDE3NDQ4MzA0NjU6MiwyMDEzMjY1OTIxOjMzMjgyLDIyODE3MDEzNzc6MzI3NzAsMjU1MDEzNjgzMzo4Mzg5MTIyLDI4MTg1NzIyODk6NTE0LDMwODcwMDc3NDU6ODQyMTg4OCwzMzU1NDQzMjAxOjgzODkxMjAsMzYyMzg3ODY1NzowLDM4OTIzMTQxMTM6MzMyODAsNDE2MDc0OTU2OTo4NDIxMzc4fSx7MDoxMDc0MjgyNTEyLDE2Nzc3MjE2OjE2Mzg0LDMzNTU0NDMyOjUyNDI4OCw1MDMzMTY0ODoxMDc0MjY2MTI4LDY3MTA4ODY0OjEwNzM3NDE4NDAsODM4ODYwODA6MTA3NDI4MjQ5NiwxMDA2NjMyOTY6MTA3Mzc1ODIwOCwxMTc0NDA1MTI6MTYsMTM0MjE3NzI4OjU0MDY3MiwxNTA5OTQ5NDQ6MTA3Mzc1ODIyNCwxNjc3NzIxNjA6MTA3Mzc0MTgyNCwxODQ1NDkzNzY6NTQwNjg4LDIwMTMyNjU5Mjo1MjQzMDQsMjE4MTAzODA4OjAsMjM0ODgxMDI0OjE2NDAwLDI1MTY1ODI0MDoxMDc0MjY2MTEyLDgzODg2MDg6MTA3Mzc1ODIwOCwyNTE2NTgyNDo1NDA2ODgsNDE5NDMwNDA6MTYsNTg3MjAyNTY6MTA3Mzc1ODIyNCw3NTQ5NzQ3MjoxMDc0MjgyNTEyLDkyMjc0Njg4OjEwNzM3NDE4MjQsMTA5MDUxOTA0OjUyNDI4OCwxMjU4MjkxMjA6MTA3NDI2NjEyOCwxNDI2MDYzMzY6NTI0MzA0LDE1OTM4MzU1MjowLDE3NjE2MDc2ODoxNjM4NCwxOTI5Mzc5ODQ6MTA3NDI2NjExMiwyMDk3MTUyMDA6MTA3Mzc0MTg0MCwyMjY0OTI0MTY6NTQwNjcyLDI0MzI2OTYzMjoxMDc0MjgyNDk2LDI2MDA0Njg0ODoxNjQwMCwyNjg0MzU0NTY6MCwyODUyMTI2NzI6MTA3NDI2NjEyOCwzMDE5ODk4ODg6MTA3Mzc1ODIyNCwzMTg3NjcxMDQ6MTA3NDI4MjQ5NiwzMzU1NDQzMjA6MTA3NDI2NjExMiwzNTIzMjE1MzY6MTYsMzY5MDk4NzUyOjU0MDY4OCwzODU4NzU5Njg6MTYzODQsNDAyNjUzMTg0OjE2NDAwLDQxOTQzMDQwMDo1MjQyODgsNDM2MjA3NjE2OjUyNDMwNCw0NTI5ODQ4MzI6MTA3Mzc0MTg0MCw0Njk3NjIwNDg6NTQwNjcyLDQ4NjUzOTI2NDoxMDczNzU4MjA4LDUwMzMxNjQ4MDoxMDczNzQxODI0LDUyMDA5MzY5NjoxMDc0MjgyNTEyLDI3NjgyNDA2NDo1NDA2ODgsMjkzNjAxMjgwOjUyNDI4OCwzMTAzNzg0OTY6MTA3NDI2NjExMiwzMjcxNTU3MTI6MTYzODQsMzQzOTMyOTI4OjEwNzM3NTgyMDgsMzYwNzEwMTQ0OjEwNzQyODI1MTIsMzc3NDg3MzYwOjE2LDM5NDI2NDU3NjoxMDczNzQxODI0LDQxMTA0MTc5MjoxMDc0MjgyNDk2LDQyNzgxOTAwODoxMDczNzQxODQwLDQ0NDU5NjIyNDoxMDczNzU4MjI0LDQ2MTM3MzQ0MDo1MjQzMDQsNDc4MTUwNjU2OjAsNDk0OTI3ODcyOjE2NDAwLDUxMTcwNTA4ODoxMDc0MjY2MTI4LDUyODQ4MjMwNDo1NDA2NzJ9LHswOjI2MCwxMDQ4NTc2OjAsMjA5NzE1Mjo2NzEwOTEyMCwzMTQ1NzI4OjY1Nzk2LDQxOTQzMDQ6NjU1NDAsNTI0Mjg4MDo2NzEwODg2OCw2MjkxNDU2OjY3MTc0NjYwLDczNDAwMzI6NjcxNzQ0MDAsODM4ODYwODo2NzEwODg2NCw5NDM3MTg0OjY3MTc0NjU2LDEwNDg1NzYwOjY1NzkyLDExNTM0MzM2OjY3MTc0NDA0LDEyNTgyOTEyOjY3MTA5MTI0LDEzNjMxNDg4OjY1NTM2LDE0NjgwMDY0OjQsMTU3Mjg2NDA6MjU2LDUyNDI4ODo2NzE3NDY1NiwxNTcyODY0OjY3MTc0NDA0LDI2MjE0NDA6MCwzNjcwMDE2OjY3MTA5MTIwLDQ3MTg1OTI6NjcxMDg4NjgsNTc2NzE2ODo2NTUzNiw2ODE1NzQ0OjY1NTQwLDc4NjQzMjA6MjYwLDg5MTI4OTY6NCw5OTYxNDcyOjI1NiwxMTAxMDA0ODo2NzE3NDQwMCwxMjA1ODYyNDo2NTc5NiwxMzEwNzIwMDo2NTc5MiwxNDE1NTc3Njo2NzEwOTEyNCwxNTIwNDM1Mjo2NzE3NDY2MCwxNjI1MjkyODo2NzEwODg2NCwxNjc3NzIxNjo2NzE3NDY1NiwxNzgyNTc5Mjo2NTU0MCwxODg3NDM2ODo2NTUzNiwxOTkyMjk0NDo2NzEwOTEyMCwyMDk3MTUyMDoyNTYsMjIwMjAwOTY6NjcxNzQ2NjAsMjMwNjg2NzI6NjcxMDg4NjgsMjQxMTcyNDg6MCwyNTE2NTgyNDo2NzEwOTEyNCwyNjIxNDQwMDo2NzEwODg2NCwyNzI2Mjk3Njo0LDI4MzExNTUyOjY1NzkyLDI5MzYwMTI4OjY3MTc0NDAwLDMwNDA4NzA0OjI2MCwzMTQ1NzI4MDo2NTc5NiwzMjUwNTg1Njo2NzE3NDQwNCwxNzMwMTUwNDo2NzEwODg2NCwxODM1MDA4MDoyNjAsMTkzOTg2NTY6NjcxNzQ2NTYsMjA0NDcyMzI6MCwyMTQ5NTgwODo2NTU0MCwyMjU0NDM4NDo2NzEwOTEyMCwyMzU5Mjk2MDoyNTYsMjQ2NDE1MzY6NjcxNzQ0MDQsMjU2OTAxMTI6NjU1MzYsMjY3Mzg2ODg6NjcxNzQ2NjAsMjc3ODcyNjQ6NjU3OTYsMjg4MzU4NDA6NjcxMDg4NjgsMjk4ODQ0MTY6NjcxMDkxMjQsMzA5MzI5OTI6NjcxNzQ0MDAsMzE5ODE1Njg6NCwzMzAzMDE0NDo2NTc5Mn0sezA6MjE1MTY4MjA0OCw2NTUzNjoyMTQ3NDg3ODA4LDEzMTA3Mjo0MTk4NDY0LDE5NjYwODoyMTUxNjc3OTUyLDI2MjE0NDowLDMyNzY4MDo0MTk4NDAwLDM5MzIxNjoyMTQ3NDgzNzEyLDQ1ODc1Mjo0MTk0MzY4LDUyNDI4ODoyMTQ3NDgzNjQ4LDU4OTgyNDo0MTk0MzA0LDY1NTM2MDo2NCw3MjA4OTY6MjE0NzQ4Nzc0NCw3ODY0MzI6MjE1MTY3ODAxNiw4NTE5Njg6NDE2MCw5MTc1MDQ6NDA5Niw5ODMwNDA6MjE1MTY4MjExMiwzMjc2ODoyMTQ3NDg3ODA4LDk4MzA0OjY0LDE2Mzg0MDoyMTUxNjc4MDE2LDIyOTM3NjoyMTQ3NDg3NzQ0LDI5NDkxMjo0MTk4NDAwLDM2MDQ0ODoyMTUxNjgyMTEyLDQyNTk4NDowLDQ5MTUyMDoyMTUxNjc3OTUyLDU1NzA1Njo0MDk2LDYyMjU5MjoyMTUxNjgyMDQ4LDY4ODEyODo0MTk0MzA0LDc1MzY2NDo0MTYwLDgxOTIwMDoyMTQ3NDgzNjQ4LDg4NDczNjo0MTk0MzY4LDk1MDI3Mjo0MTk4NDY0LDEwMTU4MDg6MjE0NzQ4MzcxMiwxMDQ4NTc2OjQxOTQzNjgsMTExNDExMjo0MTk4NDAwLDExNzk2NDg6MjE0NzQ4MzcxMiwxMjQ1MTg0OjAsMTMxMDcyMDo0MTYwLDEzNzYyNTY6MjE1MTY3ODAxNiwxNDQxNzkyOjIxNTE2ODIwNDgsMTUwNzMyODoyMTQ3NDg3ODA4LDE1NzI4NjQ6MjE1MTY4MjExMiwxNjM4NDAwOjIxNDc0ODM2NDgsMTcwMzkzNjoyMTUxNjc3OTUyLDE3Njk0NzI6NDE5ODQ2NCwxODM1MDA4OjIxNDc0ODc3NDQsMTkwMDU0NDo0MTk0MzA0LDE5NjYwODA6NjQsMjAzMTYxNjo0MDk2LDEwODEzNDQ6MjE1MTY3Nzk1MiwxMTQ2ODgwOjIxNTE2ODIxMTIsMTIxMjQxNjowLDEyNzc5NTI6NDE5ODQwMCwxMzQzNDg4OjQxOTQzNjgsMTQwOTAyNDoyMTQ3NDgzNjQ4LDE0NzQ1NjA6MjE0NzQ4NzgwOCwxNTQwMDk2OjY0LDE2MDU2MzI6MjE0NzQ4MzcxMiwxNjcxMTY4OjQwOTYsMTczNjcwNDoyMTQ3NDg3NzQ0LDE4MDIyNDA6MjE1MTY3ODAxNiwxODY3Nzc2OjQxNjAsMTkzMzMxMjoyMTUxNjgyMDQ4LDE5OTg4NDg6NDE5NDMwNCwyMDY0Mzg0OjQxOTg0NjR9LHswOjEyOCw0MDk2OjE3MDM5MzYwLDgxOTI6MjYyMTQ0LDEyMjg4OjUzNjg3MDkxMiwxNjM4NDo1MzcxMzMxODQsMjA0ODA6MTY3NzczNDQsMjQ1NzY6NTUzNjQ4MjU2LDI4NjcyOjI2MjI3MiwzMjc2ODoxNjc3NzIxNiwzNjg2NDo1MzcxMzMwNTYsNDA5NjA6NTM2ODcxMDQwLDQ1MDU2OjU1MzkxMDQwMCw0OTE1Mjo1NTM5MTAyNzIsNTMyNDg6MCw1NzM0NDoxNzAzOTQ4OCw2MTQ0MDo1NTM2NDgxMjgsMjA0ODoxNzAzOTQ4OCw2MTQ0OjU1MzY0ODI1NiwxMDI0MDoxMjgsMTQzMzY6MTcwMzkzNjAsMTg0MzI6MjYyMTQ0LDIyNTI4OjUzNzEzMzE4NCwyNjYyNDo1NTM5MTAyNzIsMzA3MjA6NTM2ODcwOTEyLDM0ODE2OjUzNzEzMzA1NiwzODkxMjowLDQzMDA4OjU1MzkxMDQwMCw0NzEwNDoxNjc3NzM0NCw1MTIwMDo1MzY4NzEwNDAsNTUyOTY6NTUzNjQ4MTI4LDU5MzkyOjE2Nzc3MjE2LDYzNDg4OjI2MjI3Miw2NTUzNjoyNjIxNDQsNjk2MzI6MTI4LDczNzI4OjUzNjg3MDkxMiw3NzgyNDo1NTM2NDgyNTYsODE5MjA6MTY3NzczNDQsODYwMTY6NTUzOTEwMjcyLDkwMTEyOjUzNzEzMzE4NCw5NDIwODoxNjc3NzIxNiw5ODMwNDo1NTM5MTA0MDAsMTAyNDAwOjU1MzY0ODEyOCwxMDY0OTY6MTcwMzkzNjAsMTEwNTkyOjUzNzEzMzA1NiwxMTQ2ODg6MjYyMjcyLDExODc4NDo1MzY4NzEwNDAsMTIyODgwOjAsMTI2OTc2OjE3MDM5NDg4LDY3NTg0OjU1MzY0ODI1Niw3MTY4MDoxNjc3NzIxNiw3NTc3NjoxNzAzOTM2MCw3OTg3Mjo1MzcxMzMxODQsODM5Njg6NTM2ODcwOTEyLDg4MDY0OjE3MDM5NDg4LDkyMTYwOjEyOCw5NjI1Njo1NTM5MTAyNzIsMTAwMzUyOjI2MjI3MiwxMDQ0NDg6NTUzOTEwNDAwLDEwODU0NDowLDExMjY0MDo1NTM2NDgxMjgsMTE2NzM2OjE2Nzc3MzQ0LDEyMDgzMjoyNjIxNDQsMTI0OTI4OjUzNzEzMzA1NiwxMjkwMjQ6NTM2ODcxMDQwfSx7MDoyNjg0MzU0NjQsMjU2OjgxOTIsNTEyOjI3MDUzMjYwOCw3Njg6MjcwNTQwODA4LDEwMjQ6MjY4NDQzNjQ4LDEyODA6MjA5NzE1MiwxNTM2OjIwOTcxNjAsMTc5MjoyNjg0MzU0NTYsMjA0ODowLDIzMDQ6MjY4NDQzNjU2LDI1NjA6MjEwNTM0NCwyODE2OjgsMzA3MjoyNzA1MzI2MTYsMzMyODoyMTA1MzUyLDM1ODQ6ODIwMCwzODQwOjI3MDU0MDgwMCwxMjg6MjcwNTMyNjA4LDM4NDoyNzA1NDA4MDgsNjQwOjgsODk2OjIwOTcxNTIsMTE1MjoyMTA1MzUyLDE0MDg6MjY4NDM1NDY0LDE2NjQ6MjY4NDQzNjQ4LDE5MjA6ODIwMCwyMTc2OjIwOTcxNjAsMjQzMjo4MTkyLDI2ODg6MjY4NDQzNjU2LDI5NDQ6MjcwNTMyNjE2LDMyMDA6MCwzNDU2OjI3MDU0MDgwMCwzNzEyOjIxMDUzNDQsMzk2ODoyNjg0MzU0NTYsNDA5NjoyNjg0NDM2NDgsNDM1MjoyNzA1MzI2MTYsNDYwODoyNzA1NDA4MDgsNDg2NDo4MjAwLDUxMjA6MjA5NzE1Miw1Mzc2OjI2ODQzNTQ1Niw1NjMyOjI2ODQzNTQ2NCw1ODg4OjIxMDUzNDQsNjE0NDoyMTA1MzUyLDY0MDA6MCw2NjU2OjgsNjkxMjoyNzA1MzI2MDgsNzE2ODo4MTkyLDc0MjQ6MjY4NDQzNjU2LDc2ODA6MjcwNTQwODAwLDc5MzY6MjA5NzE2MCw0MjI0OjgsNDQ4MDoyMTA1MzQ0LDQ3MzY6MjA5NzE1Miw0OTkyOjI2ODQzNTQ2NCw1MjQ4OjI2ODQ0MzY0OCw1NTA0OjgyMDAsNTc2MDoyNzA1NDA4MDgsNjAxNjoyNzA1MzI2MDgsNjI3MjoyNzA1NDA4MDAsNjUyODoyNzA1MzI2MTYsNjc4NDo4MTkyLDcwNDA6MjEwNTM1Miw3Mjk2OjIwOTcxNjAsNzU1MjowLDc4MDg6MjY4NDM1NDU2LDgwNjQ6MjY4NDQzNjU2fSx7MDoxMDQ4NTc2LDE2OjMzNTU1NDU3LDMyOjEwMjQsNDg6MTA0OTYwMSw2NDozNDYwNDAzMyw4MDowLDk2OjEsMTEyOjM0NjAzMDA5LDEyODozMzU1NTQ1NiwxNDQ6MTA0ODU3NywxNjA6MzM1NTQ0MzMsMTc2OjM0NjA0MDMyLDE5MjozNDYwMzAwOCwyMDg6MTAyNSwyMjQ6MTA0OTYwMCwyNDA6MzM1NTQ0MzIsODozNDYwMzAwOSwyNDowLDQwOjMzNTU1NDU3LDU2OjM0NjA0MDMyLDcyOjEwNDg1NzYsODg6MzM1NTQ0MzMsMTA0OjMzNTU0NDMyLDEyMDoxMDI1LDEzNjoxMDQ5NjAxLDE1MjozMzU1NTQ1NiwxNjg6MzQ2MDMwMDgsMTg0OjEwNDg1NzcsMjAwOjEwMjQsMjE2OjM0NjA0MDMzLDIzMjoxLDI0ODoxMDQ5NjAwLDI1NjozMzU1NDQzMiwyNzI6MTA0ODU3NiwyODg6MzM1NTU0NTcsMzA0OjM0NjAzMDA5LDMyMDoxMDQ4NTc3LDMzNjozMzU1NTQ1NiwzNTI6MzQ2MDQwMzIsMzY4OjEwNDk2MDEsMzg0OjEwMjUsNDAwOjM0NjA0MDMzLDQxNjoxMDQ5NjAwLDQzMjoxLDQ0ODowLDQ2NDozNDYwMzAwOCw0ODA6MzM1NTQ0MzMsNDk2OjEwMjQsMjY0OjEwNDk2MDAsMjgwOjMzNTU1NDU3LDI5NjozNDYwMzAwOSwzMTI6MSwzMjg6MzM1NTQ0MzIsMzQ0OjEwNDg1NzYsMzYwOjEwMjUsMzc2OjM0NjA0MDMyLDM5MjozMzU1NDQzMyw0MDg6MzQ2MDMwMDgsNDI0OjAsNDQwOjM0NjA0MDMzLDQ1NjoxMDQ5NjAxLDQ3MjoxMDI0LDQ4ODozMzU1NTQ1Niw1MDQ6MTA0ODU3N30sezA6MTM0MjE5ODA4LDE6MTMxMDcyLDI6MTM0MjE3NzI4LDM6MzIsNDoxMzExMDQsNToxMzQzNTA4ODAsNjoxMzQzNTA4NDgsNzoyMDQ4LDg6MTM0MzQ4ODAwLDk6MTM0MjE5Nzc2LDEwOjEzMzEyMCwxMToxMzQzNDg4MzIsMTI6MjA4MCwxMzowLDE0OjEzNDIxNzc2MCwxNToxMzMxNTIsMjE0NzQ4MzY0ODoyMDQ4LDIxNDc0ODM2NDk6MTM0MzUwODgwLDIxNDc0ODM2NTA6MTM0MjE5ODA4LDIxNDc0ODM2NTE6MTM0MjE3NzI4LDIxNDc0ODM2NTI6MTM0MzQ4ODAwLDIxNDc0ODM2NTM6MTMzMTIwLDIxNDc0ODM2NTQ6MTMzMTUyLDIxNDc0ODM2NTU6MzIsMjE0NzQ4MzY1NjoxMzQyMTc3NjAsMjE0NzQ4MzY1NzoyMDgwLDIxNDc0ODM2NTg6MTMxMTA0LDIxNDc0ODM2NTk6MTM0MzUwODQ4LDIxNDc0ODM2NjA6MCwyMTQ3NDgzNjYxOjEzNDM0ODgzMiwyMTQ3NDgzNjYyOjEzNDIxOTc3NiwyMTQ3NDgzNjYzOjEzMTA3MiwxNjoxMzMxNTIsMTc6MTM0MzUwODQ4LDE4OjMyLDE5OjIwNDgsMjA6MTM0MjE5Nzc2LDIxOjEzNDIxNzc2MCwyMjoxMzQzNDg4MzIsMjM6MTMxMDcyLDI0OjAsMjU6MTMxMTA0LDI2OjEzNDM0ODgwMCwyNzoxMzQyMTk4MDgsMjg6MTM0MzUwODgwLDI5OjEzMzEyMCwzMDoyMDgwLDMxOjEzNDIxNzcyOCwyMTQ3NDgzNjY0OjEzMTA3MiwyMTQ3NDgzNjY1OjIwNDgsMjE0NzQ4MzY2NjoxMzQzNDg4MzIsMjE0NzQ4MzY2NzoxMzMxNTIsMjE0NzQ4MzY2ODozMiwyMTQ3NDgzNjY5OjEzNDM0ODgwMCwyMTQ3NDgzNjcwOjEzNDIxNzcyOCwyMTQ3NDgzNjcxOjEzNDIxOTgwOCwyMTQ3NDgzNjcyOjEzNDM1MDg4MCwyMTQ3NDgzNjczOjEzNDIxNzc2MCwyMTQ3NDgzNjc0OjEzNDIxOTc3NiwyMTQ3NDgzNjc1OjAsMjE0NzQ4MzY3NjoxMzMxMjAsMjE0NzQ4MzY3NzoyMDgwLDIxNDc0ODM2Nzg6MTMxMTA0LDIxNDc0ODM2Nzk6MTM0MzUwODQ4fV0sdT1bNDE2MDc0OTU2OSw1Mjg0ODIzMDQsMzMwMzAxNDQsMjA2NDM4NCwxMjkwMjQsODA2NCw1MDQsMjE0NzQ4MzY3OV0sbj1lLkRFUz1yLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9dGhpcy5fa2V5LndvcmRzLGU9W10scj0wO3I8NTY7cisrKXt2YXIgaT1oW3JdLTE7ZVtyXT10W2k+Pj41XT4+PjMxLWklMzImMX1mb3IodmFyIG49dGhpcy5fc3ViS2V5cz1bXSxvPTA7bzwxNjtvKyspe2Zvcih2YXIgcz1uW29dPVtdLGM9ZltvXSxyPTA7cjwyNDtyKyspc1tyLzZ8MF18PWVbKGxbcl0tMStjKSUyOF08PDMxLXIlNixzWzQrKHIvNnwwKV18PWVbMjgrKGxbcisyNF0tMStjKSUyOF08PDMxLXIlNjtzWzBdPXNbMF08PDF8c1swXT4+PjMxO2ZvcihyPTE7cjw3O3IrKylzW3JdPXNbcl0+Pj40KihyLTEpKzM7c1s3XT1zWzddPDw1fHNbN10+Pj4yN31mb3IodmFyIGE9dGhpcy5faW52U3ViS2V5cz1bXSxyPTA7cjwxNjtyKyspYVtyXT1uWzE1LXJdfSxlbmNyeXB0QmxvY2s6ZnVuY3Rpb24odCxlKXt0aGlzLl9kb0NyeXB0QmxvY2sodCxlLHRoaXMuX3N1YktleXMpfSxkZWNyeXB0QmxvY2s6ZnVuY3Rpb24odCxlKXt0aGlzLl9kb0NyeXB0QmxvY2sodCxlLHRoaXMuX2ludlN1YktleXMpfSxfZG9DcnlwdEJsb2NrOmZ1bmN0aW9uKHQsZSxyKXt0aGlzLl9sQmxvY2s9dFtlXSx0aGlzLl9yQmxvY2s9dFtlKzFdLHAuY2FsbCh0aGlzLDQsMjUyNjQ1MTM1KSxwLmNhbGwodGhpcywxNiw2NTUzNSksXy5jYWxsKHRoaXMsMiw4NTg5OTM0NTkpLF8uY2FsbCh0aGlzLDgsMTY3MTE5MzUpLHAuY2FsbCh0aGlzLDEsMTQzMTY1NTc2NSk7Zm9yKHZhciBpPTA7aTwxNjtpKyspe2Zvcih2YXIgbj1yW2ldLG89dGhpcy5fbEJsb2NrLHM9dGhpcy5fckJsb2NrLGM9MCxhPTA7YTw4O2ErKyljfD1kW2FdWygoc15uW2FdKSZ1W2FdKT4+PjBdO3RoaXMuX2xCbG9jaz1zLHRoaXMuX3JCbG9jaz1vXmN9dmFyIGg9dGhpcy5fbEJsb2NrO3RoaXMuX2xCbG9jaz10aGlzLl9yQmxvY2ssdGhpcy5fckJsb2NrPWgscC5jYWxsKHRoaXMsMSwxNDMxNjU1NzY1KSxfLmNhbGwodGhpcyw4LDE2NzExOTM1KSxfLmNhbGwodGhpcywyLDg1ODk5MzQ1OSkscC5jYWxsKHRoaXMsMTYsNjU1MzUpLHAuY2FsbCh0aGlzLDQsMjUyNjQ1MTM1KSx0W2VdPXRoaXMuX2xCbG9jayx0W2UrMV09dGhpcy5fckJsb2NrfSxrZXlTaXplOjIsaXZTaXplOjIsYmxvY2tTaXplOjJ9KTtmdW5jdGlvbiBwKHQsZSl7ZT0odGhpcy5fbEJsb2NrPj4+dF50aGlzLl9yQmxvY2spJmU7dGhpcy5fckJsb2NrXj1lLHRoaXMuX2xCbG9ja149ZTw8dH1mdW5jdGlvbiBfKHQsZSl7ZT0odGhpcy5fckJsb2NrPj4+dF50aGlzLl9sQmxvY2spJmU7dGhpcy5fbEJsb2NrXj1lLHRoaXMuX3JCbG9ja149ZTw8dH10LkRFUz1yLl9jcmVhdGVIZWxwZXIobik7ZT1lLlRyaXBsZURFUz1yLmV4dGVuZCh7X2RvUmVzZXQ6ZnVuY3Rpb24oKXt2YXIgdD10aGlzLl9rZXkud29yZHM7aWYoMiE9PXQubGVuZ3RoJiY0IT09dC5sZW5ndGgmJnQubGVuZ3RoPDYpdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGtleSBsZW5ndGggLSAzREVTIHJlcXVpcmVzIHRoZSBrZXkgbGVuZ3RoIHRvIGJlIDY0LCAxMjgsIDE5MiBvciA+MTkyLiIpO3ZhciBlPXQuc2xpY2UoMCwyKSxyPXQubGVuZ3RoPDQ/dC5zbGljZSgwLDIpOnQuc2xpY2UoMiw0KSx0PXQubGVuZ3RoPDY/dC5zbGljZSgwLDIpOnQuc2xpY2UoNCw2KTt0aGlzLl9kZXMxPW4uY3JlYXRlRW5jcnlwdG9yKGkuY3JlYXRlKGUpKSx0aGlzLl9kZXMyPW4uY3JlYXRlRW5jcnlwdG9yKGkuY3JlYXRlKHIpKSx0aGlzLl9kZXMzPW4uY3JlYXRlRW5jcnlwdG9yKGkuY3JlYXRlKHQpKX0sZW5jcnlwdEJsb2NrOmZ1bmN0aW9uKHQsZSl7dGhpcy5fZGVzMS5lbmNyeXB0QmxvY2sodCxlKSx0aGlzLl9kZXMyLmRlY3J5cHRCbG9jayh0LGUpLHRoaXMuX2RlczMuZW5jcnlwdEJsb2NrKHQsZSl9LGRlY3J5cHRCbG9jazpmdW5jdGlvbih0LGUpe3RoaXMuX2RlczMuZGVjcnlwdEJsb2NrKHQsZSksdGhpcy5fZGVzMi5lbmNyeXB0QmxvY2sodCxlKSx0aGlzLl9kZXMxLmRlY3J5cHRCbG9jayh0LGUpfSxrZXlTaXplOjYsaXZTaXplOjIsYmxvY2tTaXplOjJ9KTt0LlRyaXBsZURFUz1yLl9jcmVhdGVIZWxwZXIoZSl9KCksZnVuY3Rpb24oKXt2YXIgdD1VLGU9dC5saWIuU3RyZWFtQ2lwaGVyLHI9dC5hbGdvLGk9ci5SQzQ9ZS5leHRlbmQoe19kb1Jlc2V0OmZ1bmN0aW9uKCl7Zm9yKHZhciB0PXRoaXMuX2tleSxlPXQud29yZHMscj10LnNpZ0J5dGVzLGk9dGhpcy5fUz1bXSxuPTA7bjwyNTY7bisrKWlbbl09bjtmb3IodmFyIG49MCxvPTA7bjwyNTY7bisrKXt2YXIgcz1uJXIscz1lW3M+Pj4yXT4+PjI0LXMlNCo4JjI1NSxvPShvK2lbbl0rcyklMjU2LHM9aVtuXTtpW25dPWlbb10saVtvXT1zfXRoaXMuX2k9dGhpcy5faj0wfSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24odCxlKXt0W2VdXj1uLmNhbGwodGhpcyl9LGtleVNpemU6OCxpdlNpemU6MH0pO2Z1bmN0aW9uIG4oKXtmb3IodmFyIHQ9dGhpcy5fUyxlPXRoaXMuX2kscj10aGlzLl9qLGk9MCxuPTA7bjw0O24rKyl7dmFyIHI9KHIrdFtlPShlKzEpJTI1Nl0pJTI1NixvPXRbZV07dFtlXT10W3JdLHRbcl09byxpfD10Wyh0W2VdK3Rbcl0pJTI1Nl08PDI0LTgqbn1yZXR1cm4gdGhpcy5faT1lLHRoaXMuX2o9cixpfXQuUkM0PWUuX2NyZWF0ZUhlbHBlcihpKTtyPXIuUkM0RHJvcD1pLmV4dGVuZCh7Y2ZnOmkuY2ZnLmV4dGVuZCh7ZHJvcDoxOTJ9KSxfZG9SZXNldDpmdW5jdGlvbigpe2kuX2RvUmVzZXQuY2FsbCh0aGlzKTtmb3IodmFyIHQ9dGhpcy5jZmcuZHJvcDswPHQ7dC0tKW4uY2FsbCh0aGlzKX19KTt0LlJDNERyb3A9ZS5fY3JlYXRlSGVscGVyKHIpfSgpLEY9KE09VSkubGliLlN0cmVhbUNpcGhlcixQPU0uYWxnbyxEPVtdLEU9W10sUj1bXSxQPVAuUmFiYml0PUYuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLl9rZXkud29yZHMsZT10aGlzLmNmZy5pdixyPTA7cjw0O3IrKyl0W3JdPTE2NzExOTM1Jih0W3JdPDw4fHRbcl0+Pj4yNCl8NDI3ODI1NTM2MCYodFtyXTw8MjR8dFtyXT4+PjgpO2Zvcih2YXIgaT10aGlzLl9YPVt0WzBdLHRbM108PDE2fHRbMl0+Pj4xNix0WzFdLHRbMF08PDE2fHRbM10+Pj4xNix0WzJdLHRbMV08PDE2fHRbMF0+Pj4xNix0WzNdLHRbMl08PDE2fHRbMV0+Pj4xNl0sbj10aGlzLl9DPVt0WzJdPDwxNnx0WzJdPj4+MTYsNDI5NDkwMTc2MCZ0WzBdfDY1NTM1JnRbMV0sdFszXTw8MTZ8dFszXT4+PjE2LDQyOTQ5MDE3NjAmdFsxXXw2NTUzNSZ0WzJdLHRbMF08PDE2fHRbMF0+Pj4xNiw0Mjk0OTAxNzYwJnRbMl18NjU1MzUmdFszXSx0WzFdPDwxNnx0WzFdPj4+MTYsNDI5NDkwMTc2MCZ0WzNdfDY1NTM1JnRbMF1dLHI9dGhpcy5fYj0wO3I8NDtyKyspTi5jYWxsKHRoaXMpO2ZvcihyPTA7cjw4O3IrKyluW3JdXj1pW3IrNCY3XTtpZihlKXt2YXIgbz1lLndvcmRzLHM9b1swXSxjPW9bMV0sZT0xNjcxMTkzNSYoczw8OHxzPj4+MjQpfDQyNzgyNTUzNjAmKHM8PDI0fHM+Pj44KSxvPTE2NzExOTM1JihjPDw4fGM+Pj4yNCl8NDI3ODI1NTM2MCYoYzw8MjR8Yz4+PjgpLHM9ZT4+PjE2fDQyOTQ5MDE3NjAmbyxjPW88PDE2fDY1NTM1JmU7blswXV49ZSxuWzFdXj1zLG5bMl1ePW8sblszXV49YyxuWzRdXj1lLG5bNV1ePXMsbls2XV49byxuWzddXj1jO2ZvcihyPTA7cjw0O3IrKylOLmNhbGwodGhpcyl9fSxfZG9Qcm9jZXNzQmxvY2s6ZnVuY3Rpb24odCxlKXt2YXIgcj10aGlzLl9YO04uY2FsbCh0aGlzKSxEWzBdPXJbMF1ecls1XT4+PjE2XnJbM108PDE2LERbMV09clsyXV5yWzddPj4+MTZecls1XTw8MTYsRFsyXT1yWzRdXnJbMV0+Pj4xNl5yWzddPDwxNixEWzNdPXJbNl1eclszXT4+PjE2XnJbMV08PDE2O2Zvcih2YXIgaT0wO2k8NDtpKyspRFtpXT0xNjcxMTkzNSYoRFtpXTw8OHxEW2ldPj4+MjQpfDQyNzgyNTUzNjAmKERbaV08PDI0fERbaV0+Pj44KSx0W2UraV1ePURbaV19LGJsb2NrU2l6ZTo0LGl2U2l6ZToyfSksTS5SYWJiaXQ9Ri5fY3JlYXRlSGVscGVyKFApLEY9KE09VSkubGliLlN0cmVhbUNpcGhlcixQPU0uYWxnbyxXPVtdLE89W10sST1bXSxQPVAuUmFiYml0TGVnYWN5PUYuZXh0ZW5kKHtfZG9SZXNldDpmdW5jdGlvbigpe2Zvcih2YXIgdD10aGlzLl9rZXkud29yZHMsZT10aGlzLmNmZy5pdixyPXRoaXMuX1g9W3RbMF0sdFszXTw8MTZ8dFsyXT4+PjE2LHRbMV0sdFswXTw8MTZ8dFszXT4+PjE2LHRbMl0sdFsxXTw8MTZ8dFswXT4+PjE2LHRbM10sdFsyXTw8MTZ8dFsxXT4+PjE2XSxpPXRoaXMuX0M9W3RbMl08PDE2fHRbMl0+Pj4xNiw0Mjk0OTAxNzYwJnRbMF18NjU1MzUmdFsxXSx0WzNdPDwxNnx0WzNdPj4+MTYsNDI5NDkwMTc2MCZ0WzFdfDY1NTM1JnRbMl0sdFswXTw8MTZ8dFswXT4+PjE2LDQyOTQ5MDE3NjAmdFsyXXw2NTUzNSZ0WzNdLHRbMV08PDE2fHRbMV0+Pj4xNiw0Mjk0OTAxNzYwJnRbM118NjU1MzUmdFswXV0sbj10aGlzLl9iPTA7bjw0O24rKylxLmNhbGwodGhpcyk7Zm9yKG49MDtuPDg7bisrKWlbbl1ePXJbbis0JjddO2lmKGUpe3ZhciBvPWUud29yZHMscz1vWzBdLHQ9b1sxXSxlPTE2NzExOTM1JihzPDw4fHM+Pj4yNCl8NDI3ODI1NTM2MCYoczw8MjR8cz4+PjgpLG89MTY3MTE5MzUmKHQ8PDh8dD4+PjI0KXw0Mjc4MjU1MzYwJih0PDwyNHx0Pj4+OCkscz1lPj4+MTZ8NDI5NDkwMTc2MCZvLHQ9bzw8MTZ8NjU1MzUmZTtpWzBdXj1lLGlbMV1ePXMsaVsyXV49byxpWzNdXj10LGlbNF1ePWUsaVs1XV49cyxpWzZdXj1vLGlbN11ePXQ7Zm9yKG49MDtuPDQ7bisrKXEuY2FsbCh0aGlzKX19LF9kb1Byb2Nlc3NCbG9jazpmdW5jdGlvbih0LGUpe3ZhciByPXRoaXMuX1g7cS5jYWxsKHRoaXMpLFdbMF09clswXV5yWzVdPj4+MTZeclszXTw8MTYsV1sxXT1yWzJdXnJbN10+Pj4xNl5yWzVdPDwxNixXWzJdPXJbNF1eclsxXT4+PjE2XnJbN108PDE2LFdbM109cls2XV5yWzNdPj4+MTZeclsxXTw8MTY7Zm9yKHZhciBpPTA7aTw0O2krKylXW2ldPTE2NzExOTM1JihXW2ldPDw4fFdbaV0+Pj4yNCl8NDI3ODI1NTM2MCYoV1tpXTw8MjR8V1tpXT4+PjgpLHRbZStpXV49V1tpXX0sYmxvY2tTaXplOjQsaXZTaXplOjJ9KSxNLlJhYmJpdExlZ2FjeT1GLl9jcmVhdGVIZWxwZXIoUCksVX0pOw=="}]}]}